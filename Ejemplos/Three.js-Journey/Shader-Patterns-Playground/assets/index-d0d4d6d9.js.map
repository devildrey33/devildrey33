{"version":3,"file":"index-d0d4d6d9.js","sources":["../../node_modules/@codemirror/state/dist/index.js","../../node_modules/style-mod/src/style-mod.js","../../node_modules/w3c-keyname/index.es.js","../../node_modules/@codemirror/view/dist/index.js","../../node_modules/@lezer/common/dist/index.js","../../node_modules/@lezer/highlight/dist/index.js","../../node_modules/@codemirror/language/dist/index.js","../../node_modules/@codemirror/commands/dist/index.js","../../node_modules/@lezer/lr/dist/index.js","../../node_modules/@lezer/cpp/dist/index.es.js","../../node_modules/@codemirror/lang-cpp/dist/index.js","../../src/FragmentList.js","../../src/Editor.js","../../node_modules/three/build/three.module.js","../../node_modules/three/examples/jsm/controls/OrbitControls.js","../../src/View.js","../../src/Main.js","../../src/script.js"],"sourcesContent":["/**\nThe data structure for documents. @nonabstract\n*/\nclass Text {\n    /**\n    @internal\n    */\n    constructor() { }\n    /**\n    Get the line description around the given position.\n    */\n    lineAt(pos) {\n        if (pos < 0 || pos > this.length)\n            throw new RangeError(`Invalid position ${pos} in document of length ${this.length}`);\n        return this.lineInner(pos, false, 1, 0);\n    }\n    /**\n    Get the description for the given (1-based) line number.\n    */\n    line(n) {\n        if (n < 1 || n > this.lines)\n            throw new RangeError(`Invalid line number ${n} in ${this.lines}-line document`);\n        return this.lineInner(n, true, 1, 0);\n    }\n    /**\n    Replace a range of the text with the given content.\n    */\n    replace(from, to, text) {\n        let parts = [];\n        this.decompose(0, from, parts, 2 /* Open.To */);\n        if (text.length)\n            text.decompose(0, text.length, parts, 1 /* Open.From */ | 2 /* Open.To */);\n        this.decompose(to, this.length, parts, 1 /* Open.From */);\n        return TextNode.from(parts, this.length - (to - from) + text.length);\n    }\n    /**\n    Append another document to this one.\n    */\n    append(other) {\n        return this.replace(this.length, this.length, other);\n    }\n    /**\n    Retrieve the text between the given points.\n    */\n    slice(from, to = this.length) {\n        let parts = [];\n        this.decompose(from, to, parts, 0);\n        return TextNode.from(parts, to - from);\n    }\n    /**\n    Test whether this text is equal to another instance.\n    */\n    eq(other) {\n        if (other == this)\n            return true;\n        if (other.length != this.length || other.lines != this.lines)\n            return false;\n        let start = this.scanIdentical(other, 1), end = this.length - this.scanIdentical(other, -1);\n        let a = new RawTextCursor(this), b = new RawTextCursor(other);\n        for (let skip = start, pos = start;;) {\n            a.next(skip);\n            b.next(skip);\n            skip = 0;\n            if (a.lineBreak != b.lineBreak || a.done != b.done || a.value != b.value)\n                return false;\n            pos += a.value.length;\n            if (a.done || pos >= end)\n                return true;\n        }\n    }\n    /**\n    Iterate over the text. When `dir` is `-1`, iteration happens\n    from end to start. This will return lines and the breaks between\n    them as separate strings.\n    */\n    iter(dir = 1) { return new RawTextCursor(this, dir); }\n    /**\n    Iterate over a range of the text. When `from` > `to`, the\n    iterator will run in reverse.\n    */\n    iterRange(from, to = this.length) { return new PartialTextCursor(this, from, to); }\n    /**\n    Return a cursor that iterates over the given range of lines,\n    _without_ returning the line breaks between, and yielding empty\n    strings for empty lines.\n    \n    When `from` and `to` are given, they should be 1-based line numbers.\n    */\n    iterLines(from, to) {\n        let inner;\n        if (from == null) {\n            inner = this.iter();\n        }\n        else {\n            if (to == null)\n                to = this.lines + 1;\n            let start = this.line(from).from;\n            inner = this.iterRange(start, Math.max(start, to == this.lines + 1 ? this.length : to <= 1 ? 0 : this.line(to - 1).to));\n        }\n        return new LineCursor(inner);\n    }\n    /**\n    @internal\n    */\n    toString() { return this.sliceString(0); }\n    /**\n    Convert the document to an array of lines (which can be\n    deserialized again via [`Text.of`](https://codemirror.net/6/docs/ref/#state.Text^of)).\n    */\n    toJSON() {\n        let lines = [];\n        this.flatten(lines);\n        return lines;\n    }\n    /**\n    Create a `Text` instance for the given array of lines.\n    */\n    static of(text) {\n        if (text.length == 0)\n            throw new RangeError(\"A document must have at least one line\");\n        if (text.length == 1 && !text[0])\n            return Text.empty;\n        return text.length <= 32 /* Tree.Branch */ ? new TextLeaf(text) : TextNode.from(TextLeaf.split(text, []));\n    }\n}\n// Leaves store an array of line strings. There are always line breaks\n// between these strings. Leaves are limited in size and have to be\n// contained in TextNode instances for bigger documents.\nclass TextLeaf extends Text {\n    constructor(text, length = textLength(text)) {\n        super();\n        this.text = text;\n        this.length = length;\n    }\n    get lines() { return this.text.length; }\n    get children() { return null; }\n    lineInner(target, isLine, line, offset) {\n        for (let i = 0;; i++) {\n            let string = this.text[i], end = offset + string.length;\n            if ((isLine ? line : end) >= target)\n                return new Line(offset, end, line, string);\n            offset = end + 1;\n            line++;\n        }\n    }\n    decompose(from, to, target, open) {\n        let text = from <= 0 && to >= this.length ? this\n            : new TextLeaf(sliceText(this.text, from, to), Math.min(to, this.length) - Math.max(0, from));\n        if (open & 1 /* Open.From */) {\n            let prev = target.pop();\n            let joined = appendText(text.text, prev.text.slice(), 0, text.length);\n            if (joined.length <= 32 /* Tree.Branch */) {\n                target.push(new TextLeaf(joined, prev.length + text.length));\n            }\n            else {\n                let mid = joined.length >> 1;\n                target.push(new TextLeaf(joined.slice(0, mid)), new TextLeaf(joined.slice(mid)));\n            }\n        }\n        else {\n            target.push(text);\n        }\n    }\n    replace(from, to, text) {\n        if (!(text instanceof TextLeaf))\n            return super.replace(from, to, text);\n        let lines = appendText(this.text, appendText(text.text, sliceText(this.text, 0, from)), to);\n        let newLen = this.length + text.length - (to - from);\n        if (lines.length <= 32 /* Tree.Branch */)\n            return new TextLeaf(lines, newLen);\n        return TextNode.from(TextLeaf.split(lines, []), newLen);\n    }\n    sliceString(from, to = this.length, lineSep = \"\\n\") {\n        let result = \"\";\n        for (let pos = 0, i = 0; pos <= to && i < this.text.length; i++) {\n            let line = this.text[i], end = pos + line.length;\n            if (pos > from && i)\n                result += lineSep;\n            if (from < end && to > pos)\n                result += line.slice(Math.max(0, from - pos), to - pos);\n            pos = end + 1;\n        }\n        return result;\n    }\n    flatten(target) {\n        for (let line of this.text)\n            target.push(line);\n    }\n    scanIdentical() { return 0; }\n    static split(text, target) {\n        let part = [], len = -1;\n        for (let line of text) {\n            part.push(line);\n            len += line.length + 1;\n            if (part.length == 32 /* Tree.Branch */) {\n                target.push(new TextLeaf(part, len));\n                part = [];\n                len = -1;\n            }\n        }\n        if (len > -1)\n            target.push(new TextLeaf(part, len));\n        return target;\n    }\n}\n// Nodes provide the tree structure of the `Text` type. They store a\n// number of other nodes or leaves, taking care to balance themselves\n// on changes. There are implied line breaks _between_ the children of\n// a node (but not before the first or after the last child).\nclass TextNode extends Text {\n    constructor(children, length) {\n        super();\n        this.children = children;\n        this.length = length;\n        this.lines = 0;\n        for (let child of children)\n            this.lines += child.lines;\n    }\n    lineInner(target, isLine, line, offset) {\n        for (let i = 0;; i++) {\n            let child = this.children[i], end = offset + child.length, endLine = line + child.lines - 1;\n            if ((isLine ? endLine : end) >= target)\n                return child.lineInner(target, isLine, line, offset);\n            offset = end + 1;\n            line = endLine + 1;\n        }\n    }\n    decompose(from, to, target, open) {\n        for (let i = 0, pos = 0; pos <= to && i < this.children.length; i++) {\n            let child = this.children[i], end = pos + child.length;\n            if (from <= end && to >= pos) {\n                let childOpen = open & ((pos <= from ? 1 /* Open.From */ : 0) | (end >= to ? 2 /* Open.To */ : 0));\n                if (pos >= from && end <= to && !childOpen)\n                    target.push(child);\n                else\n                    child.decompose(from - pos, to - pos, target, childOpen);\n            }\n            pos = end + 1;\n        }\n    }\n    replace(from, to, text) {\n        if (text.lines < this.lines)\n            for (let i = 0, pos = 0; i < this.children.length; i++) {\n                let child = this.children[i], end = pos + child.length;\n                // Fast path: if the change only affects one child and the\n                // child's size remains in the acceptable range, only update\n                // that child\n                if (from >= pos && to <= end) {\n                    let updated = child.replace(from - pos, to - pos, text);\n                    let totalLines = this.lines - child.lines + updated.lines;\n                    if (updated.lines < (totalLines >> (5 /* Tree.BranchShift */ - 1)) &&\n                        updated.lines > (totalLines >> (5 /* Tree.BranchShift */ + 1))) {\n                        let copy = this.children.slice();\n                        copy[i] = updated;\n                        return new TextNode(copy, this.length - (to - from) + text.length);\n                    }\n                    return super.replace(pos, end, updated);\n                }\n                pos = end + 1;\n            }\n        return super.replace(from, to, text);\n    }\n    sliceString(from, to = this.length, lineSep = \"\\n\") {\n        let result = \"\";\n        for (let i = 0, pos = 0; i < this.children.length && pos <= to; i++) {\n            let child = this.children[i], end = pos + child.length;\n            if (pos > from && i)\n                result += lineSep;\n            if (from < end && to > pos)\n                result += child.sliceString(from - pos, to - pos, lineSep);\n            pos = end + 1;\n        }\n        return result;\n    }\n    flatten(target) {\n        for (let child of this.children)\n            child.flatten(target);\n    }\n    scanIdentical(other, dir) {\n        if (!(other instanceof TextNode))\n            return 0;\n        let length = 0;\n        let [iA, iB, eA, eB] = dir > 0 ? [0, 0, this.children.length, other.children.length]\n            : [this.children.length - 1, other.children.length - 1, -1, -1];\n        for (;; iA += dir, iB += dir) {\n            if (iA == eA || iB == eB)\n                return length;\n            let chA = this.children[iA], chB = other.children[iB];\n            if (chA != chB)\n                return length + chA.scanIdentical(chB, dir);\n            length += chA.length + 1;\n        }\n    }\n    static from(children, length = children.reduce((l, ch) => l + ch.length + 1, -1)) {\n        let lines = 0;\n        for (let ch of children)\n            lines += ch.lines;\n        if (lines < 32 /* Tree.Branch */) {\n            let flat = [];\n            for (let ch of children)\n                ch.flatten(flat);\n            return new TextLeaf(flat, length);\n        }\n        let chunk = Math.max(32 /* Tree.Branch */, lines >> 5 /* Tree.BranchShift */), maxChunk = chunk << 1, minChunk = chunk >> 1;\n        let chunked = [], currentLines = 0, currentLen = -1, currentChunk = [];\n        function add(child) {\n            let last;\n            if (child.lines > maxChunk && child instanceof TextNode) {\n                for (let node of child.children)\n                    add(node);\n            }\n            else if (child.lines > minChunk && (currentLines > minChunk || !currentLines)) {\n                flush();\n                chunked.push(child);\n            }\n            else if (child instanceof TextLeaf && currentLines &&\n                (last = currentChunk[currentChunk.length - 1]) instanceof TextLeaf &&\n                child.lines + last.lines <= 32 /* Tree.Branch */) {\n                currentLines += child.lines;\n                currentLen += child.length + 1;\n                currentChunk[currentChunk.length - 1] = new TextLeaf(last.text.concat(child.text), last.length + 1 + child.length);\n            }\n            else {\n                if (currentLines + child.lines > chunk)\n                    flush();\n                currentLines += child.lines;\n                currentLen += child.length + 1;\n                currentChunk.push(child);\n            }\n        }\n        function flush() {\n            if (currentLines == 0)\n                return;\n            chunked.push(currentChunk.length == 1 ? currentChunk[0] : TextNode.from(currentChunk, currentLen));\n            currentLen = -1;\n            currentLines = currentChunk.length = 0;\n        }\n        for (let child of children)\n            add(child);\n        flush();\n        return chunked.length == 1 ? chunked[0] : new TextNode(chunked, length);\n    }\n}\nText.empty = /*@__PURE__*/new TextLeaf([\"\"], 0);\nfunction textLength(text) {\n    let length = -1;\n    for (let line of text)\n        length += line.length + 1;\n    return length;\n}\nfunction appendText(text, target, from = 0, to = 1e9) {\n    for (let pos = 0, i = 0, first = true; i < text.length && pos <= to; i++) {\n        let line = text[i], end = pos + line.length;\n        if (end >= from) {\n            if (end > to)\n                line = line.slice(0, to - pos);\n            if (pos < from)\n                line = line.slice(from - pos);\n            if (first) {\n                target[target.length - 1] += line;\n                first = false;\n            }\n            else\n                target.push(line);\n        }\n        pos = end + 1;\n    }\n    return target;\n}\nfunction sliceText(text, from, to) {\n    return appendText(text, [\"\"], from, to);\n}\nclass RawTextCursor {\n    constructor(text, dir = 1) {\n        this.dir = dir;\n        this.done = false;\n        this.lineBreak = false;\n        this.value = \"\";\n        this.nodes = [text];\n        this.offsets = [dir > 0 ? 1 : (text instanceof TextLeaf ? text.text.length : text.children.length) << 1];\n    }\n    nextInner(skip, dir) {\n        this.done = this.lineBreak = false;\n        for (;;) {\n            let last = this.nodes.length - 1;\n            let top = this.nodes[last], offsetValue = this.offsets[last], offset = offsetValue >> 1;\n            let size = top instanceof TextLeaf ? top.text.length : top.children.length;\n            if (offset == (dir > 0 ? size : 0)) {\n                if (last == 0) {\n                    this.done = true;\n                    this.value = \"\";\n                    return this;\n                }\n                if (dir > 0)\n                    this.offsets[last - 1]++;\n                this.nodes.pop();\n                this.offsets.pop();\n            }\n            else if ((offsetValue & 1) == (dir > 0 ? 0 : 1)) {\n                this.offsets[last] += dir;\n                if (skip == 0) {\n                    this.lineBreak = true;\n                    this.value = \"\\n\";\n                    return this;\n                }\n                skip--;\n            }\n            else if (top instanceof TextLeaf) {\n                // Move to the next string\n                let next = top.text[offset + (dir < 0 ? -1 : 0)];\n                this.offsets[last] += dir;\n                if (next.length > Math.max(0, skip)) {\n                    this.value = skip == 0 ? next : dir > 0 ? next.slice(skip) : next.slice(0, next.length - skip);\n                    return this;\n                }\n                skip -= next.length;\n            }\n            else {\n                let next = top.children[offset + (dir < 0 ? -1 : 0)];\n                if (skip > next.length) {\n                    skip -= next.length;\n                    this.offsets[last] += dir;\n                }\n                else {\n                    if (dir < 0)\n                        this.offsets[last]--;\n                    this.nodes.push(next);\n                    this.offsets.push(dir > 0 ? 1 : (next instanceof TextLeaf ? next.text.length : next.children.length) << 1);\n                }\n            }\n        }\n    }\n    next(skip = 0) {\n        if (skip < 0) {\n            this.nextInner(-skip, (-this.dir));\n            skip = this.value.length;\n        }\n        return this.nextInner(skip, this.dir);\n    }\n}\nclass PartialTextCursor {\n    constructor(text, start, end) {\n        this.value = \"\";\n        this.done = false;\n        this.cursor = new RawTextCursor(text, start > end ? -1 : 1);\n        this.pos = start > end ? text.length : 0;\n        this.from = Math.min(start, end);\n        this.to = Math.max(start, end);\n    }\n    nextInner(skip, dir) {\n        if (dir < 0 ? this.pos <= this.from : this.pos >= this.to) {\n            this.value = \"\";\n            this.done = true;\n            return this;\n        }\n        skip += Math.max(0, dir < 0 ? this.pos - this.to : this.from - this.pos);\n        let limit = dir < 0 ? this.pos - this.from : this.to - this.pos;\n        if (skip > limit)\n            skip = limit;\n        limit -= skip;\n        let { value } = this.cursor.next(skip);\n        this.pos += (value.length + skip) * dir;\n        this.value = value.length <= limit ? value : dir < 0 ? value.slice(value.length - limit) : value.slice(0, limit);\n        this.done = !this.value;\n        return this;\n    }\n    next(skip = 0) {\n        if (skip < 0)\n            skip = Math.max(skip, this.from - this.pos);\n        else if (skip > 0)\n            skip = Math.min(skip, this.to - this.pos);\n        return this.nextInner(skip, this.cursor.dir);\n    }\n    get lineBreak() { return this.cursor.lineBreak && this.value != \"\"; }\n}\nclass LineCursor {\n    constructor(inner) {\n        this.inner = inner;\n        this.afterBreak = true;\n        this.value = \"\";\n        this.done = false;\n    }\n    next(skip = 0) {\n        let { done, lineBreak, value } = this.inner.next(skip);\n        if (done) {\n            this.done = true;\n            this.value = \"\";\n        }\n        else if (lineBreak) {\n            if (this.afterBreak) {\n                this.value = \"\";\n            }\n            else {\n                this.afterBreak = true;\n                this.next();\n            }\n        }\n        else {\n            this.value = value;\n            this.afterBreak = false;\n        }\n        return this;\n    }\n    get lineBreak() { return false; }\n}\nif (typeof Symbol != \"undefined\") {\n    Text.prototype[Symbol.iterator] = function () { return this.iter(); };\n    RawTextCursor.prototype[Symbol.iterator] = PartialTextCursor.prototype[Symbol.iterator] =\n        LineCursor.prototype[Symbol.iterator] = function () { return this; };\n}\n/**\nThis type describes a line in the document. It is created\non-demand when lines are [queried](https://codemirror.net/6/docs/ref/#state.Text.lineAt).\n*/\nclass Line {\n    /**\n    @internal\n    */\n    constructor(\n    /**\n    The position of the start of the line.\n    */\n    from, \n    /**\n    The position at the end of the line (_before_ the line break,\n    or at the end of document for the last line).\n    */\n    to, \n    /**\n    This line's line number (1-based).\n    */\n    number, \n    /**\n    The line's content.\n    */\n    text) {\n        this.from = from;\n        this.to = to;\n        this.number = number;\n        this.text = text;\n    }\n    /**\n    The length of the line (not including any line break after it).\n    */\n    get length() { return this.to - this.from; }\n}\n\n// Compressed representation of the Grapheme_Cluster_Break=Extend\n// information from\n// http://www.unicode.org/Public/13.0.0/ucd/auxiliary/GraphemeBreakProperty.txt.\n// Each pair of elements represents a range, as an offet from the\n// previous range and a length. Numbers are in base-36, with the empty\n// string being a shorthand for 1.\nlet extend = /*@__PURE__*/\"lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o\".split(\",\").map(s => s ? parseInt(s, 36) : 1);\n// Convert offsets into absolute values\nfor (let i = 1; i < extend.length; i++)\n    extend[i] += extend[i - 1];\nfunction isExtendingChar(code) {\n    for (let i = 1; i < extend.length; i += 2)\n        if (extend[i] > code)\n            return extend[i - 1] <= code;\n    return false;\n}\nfunction isRegionalIndicator(code) {\n    return code >= 0x1F1E6 && code <= 0x1F1FF;\n}\nconst ZWJ = 0x200d;\n/**\nReturns a next grapheme cluster break _after_ (not equal to)\n`pos`, if `forward` is true, or before otherwise. Returns `pos`\nitself if no further cluster break is available in the string.\nMoves across surrogate pairs, extending characters (when\n`includeExtending` is true), characters joined with zero-width\njoiners, and flag emoji.\n*/\nfunction findClusterBreak(str, pos, forward = true, includeExtending = true) {\n    return (forward ? nextClusterBreak : prevClusterBreak)(str, pos, includeExtending);\n}\nfunction nextClusterBreak(str, pos, includeExtending) {\n    if (pos == str.length)\n        return pos;\n    // If pos is in the middle of a surrogate pair, move to its start\n    if (pos && surrogateLow(str.charCodeAt(pos)) && surrogateHigh(str.charCodeAt(pos - 1)))\n        pos--;\n    let prev = codePointAt(str, pos);\n    pos += codePointSize(prev);\n    while (pos < str.length) {\n        let next = codePointAt(str, pos);\n        if (prev == ZWJ || next == ZWJ || includeExtending && isExtendingChar(next)) {\n            pos += codePointSize(next);\n            prev = next;\n        }\n        else if (isRegionalIndicator(next)) {\n            let countBefore = 0, i = pos - 2;\n            while (i >= 0 && isRegionalIndicator(codePointAt(str, i))) {\n                countBefore++;\n                i -= 2;\n            }\n            if (countBefore % 2 == 0)\n                break;\n            else\n                pos += 2;\n        }\n        else {\n            break;\n        }\n    }\n    return pos;\n}\nfunction prevClusterBreak(str, pos, includeExtending) {\n    while (pos > 0) {\n        let found = nextClusterBreak(str, pos - 2, includeExtending);\n        if (found < pos)\n            return found;\n        pos--;\n    }\n    return 0;\n}\nfunction surrogateLow(ch) { return ch >= 0xDC00 && ch < 0xE000; }\nfunction surrogateHigh(ch) { return ch >= 0xD800 && ch < 0xDC00; }\n/**\nFind the code point at the given position in a string (like the\n[`codePointAt`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/codePointAt)\nstring method).\n*/\nfunction codePointAt(str, pos) {\n    let code0 = str.charCodeAt(pos);\n    if (!surrogateHigh(code0) || pos + 1 == str.length)\n        return code0;\n    let code1 = str.charCodeAt(pos + 1);\n    if (!surrogateLow(code1))\n        return code0;\n    return ((code0 - 0xd800) << 10) + (code1 - 0xdc00) + 0x10000;\n}\n/**\nGiven a Unicode codepoint, return the JavaScript string that\nrespresents it (like\n[`String.fromCodePoint`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/fromCodePoint)).\n*/\nfunction fromCodePoint(code) {\n    if (code <= 0xffff)\n        return String.fromCharCode(code);\n    code -= 0x10000;\n    return String.fromCharCode((code >> 10) + 0xd800, (code & 1023) + 0xdc00);\n}\n/**\nThe amount of positions a character takes up a JavaScript string.\n*/\nfunction codePointSize(code) { return code < 0x10000 ? 1 : 2; }\n\nconst DefaultSplit = /\\r\\n?|\\n/;\n/**\nDistinguishes different ways in which positions can be mapped.\n*/\nvar MapMode = /*@__PURE__*/(function (MapMode) {\n    /**\n    Map a position to a valid new position, even when its context\n    was deleted.\n    */\n    MapMode[MapMode[\"Simple\"] = 0] = \"Simple\";\n    /**\n    Return null if deletion happens across the position.\n    */\n    MapMode[MapMode[\"TrackDel\"] = 1] = \"TrackDel\";\n    /**\n    Return null if the character _before_ the position is deleted.\n    */\n    MapMode[MapMode[\"TrackBefore\"] = 2] = \"TrackBefore\";\n    /**\n    Return null if the character _after_ the position is deleted.\n    */\n    MapMode[MapMode[\"TrackAfter\"] = 3] = \"TrackAfter\";\nreturn MapMode})(MapMode || (MapMode = {}));\n/**\nA change description is a variant of [change set](https://codemirror.net/6/docs/ref/#state.ChangeSet)\nthat doesn't store the inserted text. As such, it can't be\napplied, but is cheaper to store and manipulate.\n*/\nclass ChangeDesc {\n    // Sections are encoded as pairs of integers. The first is the\n    // length in the current document, and the second is -1 for\n    // unaffected sections, and the length of the replacement content\n    // otherwise. So an insertion would be (0, n>0), a deletion (n>0,\n    // 0), and a replacement two positive numbers.\n    /**\n    @internal\n    */\n    constructor(\n    /**\n    @internal\n    */\n    sections) {\n        this.sections = sections;\n    }\n    /**\n    The length of the document before the change.\n    */\n    get length() {\n        let result = 0;\n        for (let i = 0; i < this.sections.length; i += 2)\n            result += this.sections[i];\n        return result;\n    }\n    /**\n    The length of the document after the change.\n    */\n    get newLength() {\n        let result = 0;\n        for (let i = 0; i < this.sections.length; i += 2) {\n            let ins = this.sections[i + 1];\n            result += ins < 0 ? this.sections[i] : ins;\n        }\n        return result;\n    }\n    /**\n    False when there are actual changes in this set.\n    */\n    get empty() { return this.sections.length == 0 || this.sections.length == 2 && this.sections[1] < 0; }\n    /**\n    Iterate over the unchanged parts left by these changes. `posA`\n    provides the position of the range in the old document, `posB`\n    the new position in the changed document.\n    */\n    iterGaps(f) {\n        for (let i = 0, posA = 0, posB = 0; i < this.sections.length;) {\n            let len = this.sections[i++], ins = this.sections[i++];\n            if (ins < 0) {\n                f(posA, posB, len);\n                posB += len;\n            }\n            else {\n                posB += ins;\n            }\n            posA += len;\n        }\n    }\n    /**\n    Iterate over the ranges changed by these changes. (See\n    [`ChangeSet.iterChanges`](https://codemirror.net/6/docs/ref/#state.ChangeSet.iterChanges) for a\n    variant that also provides you with the inserted text.)\n    `fromA`/`toA` provides the extent of the change in the starting\n    document, `fromB`/`toB` the extent of the replacement in the\n    changed document.\n    \n    When `individual` is true, adjacent changes (which are kept\n    separate for [position mapping](https://codemirror.net/6/docs/ref/#state.ChangeDesc.mapPos)) are\n    reported separately.\n    */\n    iterChangedRanges(f, individual = false) {\n        iterChanges(this, f, individual);\n    }\n    /**\n    Get a description of the inverted form of these changes.\n    */\n    get invertedDesc() {\n        let sections = [];\n        for (let i = 0; i < this.sections.length;) {\n            let len = this.sections[i++], ins = this.sections[i++];\n            if (ins < 0)\n                sections.push(len, ins);\n            else\n                sections.push(ins, len);\n        }\n        return new ChangeDesc(sections);\n    }\n    /**\n    Compute the combined effect of applying another set of changes\n    after this one. The length of the document after this set should\n    match the length before `other`.\n    */\n    composeDesc(other) { return this.empty ? other : other.empty ? this : composeSets(this, other); }\n    /**\n    Map this description, which should start with the same document\n    as `other`, over another set of changes, so that it can be\n    applied after it. When `before` is true, map as if the changes\n    in `other` happened before the ones in `this`.\n    */\n    mapDesc(other, before = false) { return other.empty ? this : mapSet(this, other, before); }\n    mapPos(pos, assoc = -1, mode = MapMode.Simple) {\n        let posA = 0, posB = 0;\n        for (let i = 0; i < this.sections.length;) {\n            let len = this.sections[i++], ins = this.sections[i++], endA = posA + len;\n            if (ins < 0) {\n                if (endA > pos)\n                    return posB + (pos - posA);\n                posB += len;\n            }\n            else {\n                if (mode != MapMode.Simple && endA >= pos &&\n                    (mode == MapMode.TrackDel && posA < pos && endA > pos ||\n                        mode == MapMode.TrackBefore && posA < pos ||\n                        mode == MapMode.TrackAfter && endA > pos))\n                    return null;\n                if (endA > pos || endA == pos && assoc < 0 && !len)\n                    return pos == posA || assoc < 0 ? posB : posB + ins;\n                posB += ins;\n            }\n            posA = endA;\n        }\n        if (pos > posA)\n            throw new RangeError(`Position ${pos} is out of range for changeset of length ${posA}`);\n        return posB;\n    }\n    /**\n    Check whether these changes touch a given range. When one of the\n    changes entirely covers the range, the string `\"cover\"` is\n    returned.\n    */\n    touchesRange(from, to = from) {\n        for (let i = 0, pos = 0; i < this.sections.length && pos <= to;) {\n            let len = this.sections[i++], ins = this.sections[i++], end = pos + len;\n            if (ins >= 0 && pos <= to && end >= from)\n                return pos < from && end > to ? \"cover\" : true;\n            pos = end;\n        }\n        return false;\n    }\n    /**\n    @internal\n    */\n    toString() {\n        let result = \"\";\n        for (let i = 0; i < this.sections.length;) {\n            let len = this.sections[i++], ins = this.sections[i++];\n            result += (result ? \" \" : \"\") + len + (ins >= 0 ? \":\" + ins : \"\");\n        }\n        return result;\n    }\n    /**\n    Serialize this change desc to a JSON-representable value.\n    */\n    toJSON() { return this.sections; }\n    /**\n    Create a change desc from its JSON representation (as produced\n    by [`toJSON`](https://codemirror.net/6/docs/ref/#state.ChangeDesc.toJSON).\n    */\n    static fromJSON(json) {\n        if (!Array.isArray(json) || json.length % 2 || json.some(a => typeof a != \"number\"))\n            throw new RangeError(\"Invalid JSON representation of ChangeDesc\");\n        return new ChangeDesc(json);\n    }\n    /**\n    @internal\n    */\n    static create(sections) { return new ChangeDesc(sections); }\n}\n/**\nA change set represents a group of modifications to a document. It\nstores the document length, and can only be applied to documents\nwith exactly that length.\n*/\nclass ChangeSet extends ChangeDesc {\n    constructor(sections, \n    /**\n    @internal\n    */\n    inserted) {\n        super(sections);\n        this.inserted = inserted;\n    }\n    /**\n    Apply the changes to a document, returning the modified\n    document.\n    */\n    apply(doc) {\n        if (this.length != doc.length)\n            throw new RangeError(\"Applying change set to a document with the wrong length\");\n        iterChanges(this, (fromA, toA, fromB, _toB, text) => doc = doc.replace(fromB, fromB + (toA - fromA), text), false);\n        return doc;\n    }\n    mapDesc(other, before = false) { return mapSet(this, other, before, true); }\n    /**\n    Given the document as it existed _before_ the changes, return a\n    change set that represents the inverse of this set, which could\n    be used to go from the document created by the changes back to\n    the document as it existed before the changes.\n    */\n    invert(doc) {\n        let sections = this.sections.slice(), inserted = [];\n        for (let i = 0, pos = 0; i < sections.length; i += 2) {\n            let len = sections[i], ins = sections[i + 1];\n            if (ins >= 0) {\n                sections[i] = ins;\n                sections[i + 1] = len;\n                let index = i >> 1;\n                while (inserted.length < index)\n                    inserted.push(Text.empty);\n                inserted.push(len ? doc.slice(pos, pos + len) : Text.empty);\n            }\n            pos += len;\n        }\n        return new ChangeSet(sections, inserted);\n    }\n    /**\n    Combine two subsequent change sets into a single set. `other`\n    must start in the document produced by `this`. If `this` goes\n    `docA` → `docB` and `other` represents `docB` → `docC`, the\n    returned value will represent the change `docA` → `docC`.\n    */\n    compose(other) { return this.empty ? other : other.empty ? this : composeSets(this, other, true); }\n    /**\n    Given another change set starting in the same document, maps this\n    change set over the other, producing a new change set that can be\n    applied to the document produced by applying `other`. When\n    `before` is `true`, order changes as if `this` comes before\n    `other`, otherwise (the default) treat `other` as coming first.\n    \n    Given two changes `A` and `B`, `A.compose(B.map(A))` and\n    `B.compose(A.map(B, true))` will produce the same document. This\n    provides a basic form of [operational\n    transformation](https://en.wikipedia.org/wiki/Operational_transformation),\n    and can be used for collaborative editing.\n    */\n    map(other, before = false) { return other.empty ? this : mapSet(this, other, before, true); }\n    /**\n    Iterate over the changed ranges in the document, calling `f` for\n    each, with the range in the original document (`fromA`-`toA`)\n    and the range that replaces it in the new document\n    (`fromB`-`toB`).\n    \n    When `individual` is true, adjacent changes are reported\n    separately.\n    */\n    iterChanges(f, individual = false) {\n        iterChanges(this, f, individual);\n    }\n    /**\n    Get a [change description](https://codemirror.net/6/docs/ref/#state.ChangeDesc) for this change\n    set.\n    */\n    get desc() { return ChangeDesc.create(this.sections); }\n    /**\n    @internal\n    */\n    filter(ranges) {\n        let resultSections = [], resultInserted = [], filteredSections = [];\n        let iter = new SectionIter(this);\n        done: for (let i = 0, pos = 0;;) {\n            let next = i == ranges.length ? 1e9 : ranges[i++];\n            while (pos < next || pos == next && iter.len == 0) {\n                if (iter.done)\n                    break done;\n                let len = Math.min(iter.len, next - pos);\n                addSection(filteredSections, len, -1);\n                let ins = iter.ins == -1 ? -1 : iter.off == 0 ? iter.ins : 0;\n                addSection(resultSections, len, ins);\n                if (ins > 0)\n                    addInsert(resultInserted, resultSections, iter.text);\n                iter.forward(len);\n                pos += len;\n            }\n            let end = ranges[i++];\n            while (pos < end) {\n                if (iter.done)\n                    break done;\n                let len = Math.min(iter.len, end - pos);\n                addSection(resultSections, len, -1);\n                addSection(filteredSections, len, iter.ins == -1 ? -1 : iter.off == 0 ? iter.ins : 0);\n                iter.forward(len);\n                pos += len;\n            }\n        }\n        return { changes: new ChangeSet(resultSections, resultInserted),\n            filtered: ChangeDesc.create(filteredSections) };\n    }\n    /**\n    Serialize this change set to a JSON-representable value.\n    */\n    toJSON() {\n        let parts = [];\n        for (let i = 0; i < this.sections.length; i += 2) {\n            let len = this.sections[i], ins = this.sections[i + 1];\n            if (ins < 0)\n                parts.push(len);\n            else if (ins == 0)\n                parts.push([len]);\n            else\n                parts.push([len].concat(this.inserted[i >> 1].toJSON()));\n        }\n        return parts;\n    }\n    /**\n    Create a change set for the given changes, for a document of the\n    given length, using `lineSep` as line separator.\n    */\n    static of(changes, length, lineSep) {\n        let sections = [], inserted = [], pos = 0;\n        let total = null;\n        function flush(force = false) {\n            if (!force && !sections.length)\n                return;\n            if (pos < length)\n                addSection(sections, length - pos, -1);\n            let set = new ChangeSet(sections, inserted);\n            total = total ? total.compose(set.map(total)) : set;\n            sections = [];\n            inserted = [];\n            pos = 0;\n        }\n        function process(spec) {\n            if (Array.isArray(spec)) {\n                for (let sub of spec)\n                    process(sub);\n            }\n            else if (spec instanceof ChangeSet) {\n                if (spec.length != length)\n                    throw new RangeError(`Mismatched change set length (got ${spec.length}, expected ${length})`);\n                flush();\n                total = total ? total.compose(spec.map(total)) : spec;\n            }\n            else {\n                let { from, to = from, insert } = spec;\n                if (from > to || from < 0 || to > length)\n                    throw new RangeError(`Invalid change range ${from} to ${to} (in doc of length ${length})`);\n                let insText = !insert ? Text.empty : typeof insert == \"string\" ? Text.of(insert.split(lineSep || DefaultSplit)) : insert;\n                let insLen = insText.length;\n                if (from == to && insLen == 0)\n                    return;\n                if (from < pos)\n                    flush();\n                if (from > pos)\n                    addSection(sections, from - pos, -1);\n                addSection(sections, to - from, insLen);\n                addInsert(inserted, sections, insText);\n                pos = to;\n            }\n        }\n        process(changes);\n        flush(!total);\n        return total;\n    }\n    /**\n    Create an empty changeset of the given length.\n    */\n    static empty(length) {\n        return new ChangeSet(length ? [length, -1] : [], []);\n    }\n    /**\n    Create a changeset from its JSON representation (as produced by\n    [`toJSON`](https://codemirror.net/6/docs/ref/#state.ChangeSet.toJSON).\n    */\n    static fromJSON(json) {\n        if (!Array.isArray(json))\n            throw new RangeError(\"Invalid JSON representation of ChangeSet\");\n        let sections = [], inserted = [];\n        for (let i = 0; i < json.length; i++) {\n            let part = json[i];\n            if (typeof part == \"number\") {\n                sections.push(part, -1);\n            }\n            else if (!Array.isArray(part) || typeof part[0] != \"number\" || part.some((e, i) => i && typeof e != \"string\")) {\n                throw new RangeError(\"Invalid JSON representation of ChangeSet\");\n            }\n            else if (part.length == 1) {\n                sections.push(part[0], 0);\n            }\n            else {\n                while (inserted.length < i)\n                    inserted.push(Text.empty);\n                inserted[i] = Text.of(part.slice(1));\n                sections.push(part[0], inserted[i].length);\n            }\n        }\n        return new ChangeSet(sections, inserted);\n    }\n    /**\n    @internal\n    */\n    static createSet(sections, inserted) {\n        return new ChangeSet(sections, inserted);\n    }\n}\nfunction addSection(sections, len, ins, forceJoin = false) {\n    if (len == 0 && ins <= 0)\n        return;\n    let last = sections.length - 2;\n    if (last >= 0 && ins <= 0 && ins == sections[last + 1])\n        sections[last] += len;\n    else if (len == 0 && sections[last] == 0)\n        sections[last + 1] += ins;\n    else if (forceJoin) {\n        sections[last] += len;\n        sections[last + 1] += ins;\n    }\n    else\n        sections.push(len, ins);\n}\nfunction addInsert(values, sections, value) {\n    if (value.length == 0)\n        return;\n    let index = (sections.length - 2) >> 1;\n    if (index < values.length) {\n        values[values.length - 1] = values[values.length - 1].append(value);\n    }\n    else {\n        while (values.length < index)\n            values.push(Text.empty);\n        values.push(value);\n    }\n}\nfunction iterChanges(desc, f, individual) {\n    let inserted = desc.inserted;\n    for (let posA = 0, posB = 0, i = 0; i < desc.sections.length;) {\n        let len = desc.sections[i++], ins = desc.sections[i++];\n        if (ins < 0) {\n            posA += len;\n            posB += len;\n        }\n        else {\n            let endA = posA, endB = posB, text = Text.empty;\n            for (;;) {\n                endA += len;\n                endB += ins;\n                if (ins && inserted)\n                    text = text.append(inserted[(i - 2) >> 1]);\n                if (individual || i == desc.sections.length || desc.sections[i + 1] < 0)\n                    break;\n                len = desc.sections[i++];\n                ins = desc.sections[i++];\n            }\n            f(posA, endA, posB, endB, text);\n            posA = endA;\n            posB = endB;\n        }\n    }\n}\nfunction mapSet(setA, setB, before, mkSet = false) {\n    // Produce a copy of setA that applies to the document after setB\n    // has been applied (assuming both start at the same document).\n    let sections = [], insert = mkSet ? [] : null;\n    let a = new SectionIter(setA), b = new SectionIter(setB);\n    // Iterate over both sets in parallel. inserted tracks, for changes\n    // in A that have to be processed piece-by-piece, whether their\n    // content has been inserted already, and refers to the section\n    // index.\n    for (let inserted = -1;;) {\n        if (a.ins == -1 && b.ins == -1) {\n            // Move across ranges skipped by both sets.\n            let len = Math.min(a.len, b.len);\n            addSection(sections, len, -1);\n            a.forward(len);\n            b.forward(len);\n        }\n        else if (b.ins >= 0 && (a.ins < 0 || inserted == a.i || a.off == 0 && (b.len < a.len || b.len == a.len && !before))) {\n            // If there's a change in B that comes before the next change in\n            // A (ordered by start pos, then len, then before flag), skip\n            // that (and process any changes in A it covers).\n            let len = b.len;\n            addSection(sections, b.ins, -1);\n            while (len) {\n                let piece = Math.min(a.len, len);\n                if (a.ins >= 0 && inserted < a.i && a.len <= piece) {\n                    addSection(sections, 0, a.ins);\n                    if (insert)\n                        addInsert(insert, sections, a.text);\n                    inserted = a.i;\n                }\n                a.forward(piece);\n                len -= piece;\n            }\n            b.next();\n        }\n        else if (a.ins >= 0) {\n            // Process the part of a change in A up to the start of the next\n            // non-deletion change in B (if overlapping).\n            let len = 0, left = a.len;\n            while (left) {\n                if (b.ins == -1) {\n                    let piece = Math.min(left, b.len);\n                    len += piece;\n                    left -= piece;\n                    b.forward(piece);\n                }\n                else if (b.ins == 0 && b.len < left) {\n                    left -= b.len;\n                    b.next();\n                }\n                else {\n                    break;\n                }\n            }\n            addSection(sections, len, inserted < a.i ? a.ins : 0);\n            if (insert && inserted < a.i)\n                addInsert(insert, sections, a.text);\n            inserted = a.i;\n            a.forward(a.len - left);\n        }\n        else if (a.done && b.done) {\n            return insert ? ChangeSet.createSet(sections, insert) : ChangeDesc.create(sections);\n        }\n        else {\n            throw new Error(\"Mismatched change set lengths\");\n        }\n    }\n}\nfunction composeSets(setA, setB, mkSet = false) {\n    let sections = [];\n    let insert = mkSet ? [] : null;\n    let a = new SectionIter(setA), b = new SectionIter(setB);\n    for (let open = false;;) {\n        if (a.done && b.done) {\n            return insert ? ChangeSet.createSet(sections, insert) : ChangeDesc.create(sections);\n        }\n        else if (a.ins == 0) { // Deletion in A\n            addSection(sections, a.len, 0, open);\n            a.next();\n        }\n        else if (b.len == 0 && !b.done) { // Insertion in B\n            addSection(sections, 0, b.ins, open);\n            if (insert)\n                addInsert(insert, sections, b.text);\n            b.next();\n        }\n        else if (a.done || b.done) {\n            throw new Error(\"Mismatched change set lengths\");\n        }\n        else {\n            let len = Math.min(a.len2, b.len), sectionLen = sections.length;\n            if (a.ins == -1) {\n                let insB = b.ins == -1 ? -1 : b.off ? 0 : b.ins;\n                addSection(sections, len, insB, open);\n                if (insert && insB)\n                    addInsert(insert, sections, b.text);\n            }\n            else if (b.ins == -1) {\n                addSection(sections, a.off ? 0 : a.len, len, open);\n                if (insert)\n                    addInsert(insert, sections, a.textBit(len));\n            }\n            else {\n                addSection(sections, a.off ? 0 : a.len, b.off ? 0 : b.ins, open);\n                if (insert && !b.off)\n                    addInsert(insert, sections, b.text);\n            }\n            open = (a.ins > len || b.ins >= 0 && b.len > len) && (open || sections.length > sectionLen);\n            a.forward2(len);\n            b.forward(len);\n        }\n    }\n}\nclass SectionIter {\n    constructor(set) {\n        this.set = set;\n        this.i = 0;\n        this.next();\n    }\n    next() {\n        let { sections } = this.set;\n        if (this.i < sections.length) {\n            this.len = sections[this.i++];\n            this.ins = sections[this.i++];\n        }\n        else {\n            this.len = 0;\n            this.ins = -2;\n        }\n        this.off = 0;\n    }\n    get done() { return this.ins == -2; }\n    get len2() { return this.ins < 0 ? this.len : this.ins; }\n    get text() {\n        let { inserted } = this.set, index = (this.i - 2) >> 1;\n        return index >= inserted.length ? Text.empty : inserted[index];\n    }\n    textBit(len) {\n        let { inserted } = this.set, index = (this.i - 2) >> 1;\n        return index >= inserted.length && !len ? Text.empty\n            : inserted[index].slice(this.off, len == null ? undefined : this.off + len);\n    }\n    forward(len) {\n        if (len == this.len)\n            this.next();\n        else {\n            this.len -= len;\n            this.off += len;\n        }\n    }\n    forward2(len) {\n        if (this.ins == -1)\n            this.forward(len);\n        else if (len == this.ins)\n            this.next();\n        else {\n            this.ins -= len;\n            this.off += len;\n        }\n    }\n}\n\n/**\nA single selection range. When\n[`allowMultipleSelections`](https://codemirror.net/6/docs/ref/#state.EditorState^allowMultipleSelections)\nis enabled, a [selection](https://codemirror.net/6/docs/ref/#state.EditorSelection) may hold\nmultiple ranges. By default, selections hold exactly one range.\n*/\nclass SelectionRange {\n    constructor(\n    /**\n    The lower boundary of the range.\n    */\n    from, \n    /**\n    The upper boundary of the range.\n    */\n    to, flags) {\n        this.from = from;\n        this.to = to;\n        this.flags = flags;\n    }\n    /**\n    The anchor of the range—the side that doesn't move when you\n    extend it.\n    */\n    get anchor() { return this.flags & 16 /* RangeFlag.Inverted */ ? this.to : this.from; }\n    /**\n    The head of the range, which is moved when the range is\n    [extended](https://codemirror.net/6/docs/ref/#state.SelectionRange.extend).\n    */\n    get head() { return this.flags & 16 /* RangeFlag.Inverted */ ? this.from : this.to; }\n    /**\n    True when `anchor` and `head` are at the same position.\n    */\n    get empty() { return this.from == this.to; }\n    /**\n    If this is a cursor that is explicitly associated with the\n    character on one of its sides, this returns the side. -1 means\n    the character before its position, 1 the character after, and 0\n    means no association.\n    */\n    get assoc() { return this.flags & 4 /* RangeFlag.AssocBefore */ ? -1 : this.flags & 8 /* RangeFlag.AssocAfter */ ? 1 : 0; }\n    /**\n    The bidirectional text level associated with this cursor, if\n    any.\n    */\n    get bidiLevel() {\n        let level = this.flags & 3 /* RangeFlag.BidiLevelMask */;\n        return level == 3 ? null : level;\n    }\n    /**\n    The goal column (stored vertical offset) associated with a\n    cursor. This is used to preserve the vertical position when\n    [moving](https://codemirror.net/6/docs/ref/#view.EditorView.moveVertically) across\n    lines of different length.\n    */\n    get goalColumn() {\n        let value = this.flags >> 5 /* RangeFlag.GoalColumnOffset */;\n        return value == 33554431 /* RangeFlag.NoGoalColumn */ ? undefined : value;\n    }\n    /**\n    Map this range through a change, producing a valid range in the\n    updated document.\n    */\n    map(change, assoc = -1) {\n        let from, to;\n        if (this.empty) {\n            from = to = change.mapPos(this.from, assoc);\n        }\n        else {\n            from = change.mapPos(this.from, 1);\n            to = change.mapPos(this.to, -1);\n        }\n        return from == this.from && to == this.to ? this : new SelectionRange(from, to, this.flags);\n    }\n    /**\n    Extend this range to cover at least `from` to `to`.\n    */\n    extend(from, to = from) {\n        if (from <= this.anchor && to >= this.anchor)\n            return EditorSelection.range(from, to);\n        let head = Math.abs(from - this.anchor) > Math.abs(to - this.anchor) ? from : to;\n        return EditorSelection.range(this.anchor, head);\n    }\n    /**\n    Compare this range to another range.\n    */\n    eq(other) {\n        return this.anchor == other.anchor && this.head == other.head;\n    }\n    /**\n    Return a JSON-serializable object representing the range.\n    */\n    toJSON() { return { anchor: this.anchor, head: this.head }; }\n    /**\n    Convert a JSON representation of a range to a `SelectionRange`\n    instance.\n    */\n    static fromJSON(json) {\n        if (!json || typeof json.anchor != \"number\" || typeof json.head != \"number\")\n            throw new RangeError(\"Invalid JSON representation for SelectionRange\");\n        return EditorSelection.range(json.anchor, json.head);\n    }\n    /**\n    @internal\n    */\n    static create(from, to, flags) {\n        return new SelectionRange(from, to, flags);\n    }\n}\n/**\nAn editor selection holds one or more selection ranges.\n*/\nclass EditorSelection {\n    constructor(\n    /**\n    The ranges in the selection, sorted by position. Ranges cannot\n    overlap (but they may touch, if they aren't empty).\n    */\n    ranges, \n    /**\n    The index of the _main_ range in the selection (which is\n    usually the range that was added last).\n    */\n    mainIndex) {\n        this.ranges = ranges;\n        this.mainIndex = mainIndex;\n    }\n    /**\n    Map a selection through a change. Used to adjust the selection\n    position for changes.\n    */\n    map(change, assoc = -1) {\n        if (change.empty)\n            return this;\n        return EditorSelection.create(this.ranges.map(r => r.map(change, assoc)), this.mainIndex);\n    }\n    /**\n    Compare this selection to another selection.\n    */\n    eq(other) {\n        if (this.ranges.length != other.ranges.length ||\n            this.mainIndex != other.mainIndex)\n            return false;\n        for (let i = 0; i < this.ranges.length; i++)\n            if (!this.ranges[i].eq(other.ranges[i]))\n                return false;\n        return true;\n    }\n    /**\n    Get the primary selection range. Usually, you should make sure\n    your code applies to _all_ ranges, by using methods like\n    [`changeByRange`](https://codemirror.net/6/docs/ref/#state.EditorState.changeByRange).\n    */\n    get main() { return this.ranges[this.mainIndex]; }\n    /**\n    Make sure the selection only has one range. Returns a selection\n    holding only the main range from this selection.\n    */\n    asSingle() {\n        return this.ranges.length == 1 ? this : new EditorSelection([this.main], 0);\n    }\n    /**\n    Extend this selection with an extra range.\n    */\n    addRange(range, main = true) {\n        return EditorSelection.create([range].concat(this.ranges), main ? 0 : this.mainIndex + 1);\n    }\n    /**\n    Replace a given range with another range, and then normalize the\n    selection to merge and sort ranges if necessary.\n    */\n    replaceRange(range, which = this.mainIndex) {\n        let ranges = this.ranges.slice();\n        ranges[which] = range;\n        return EditorSelection.create(ranges, this.mainIndex);\n    }\n    /**\n    Convert this selection to an object that can be serialized to\n    JSON.\n    */\n    toJSON() {\n        return { ranges: this.ranges.map(r => r.toJSON()), main: this.mainIndex };\n    }\n    /**\n    Create a selection from a JSON representation.\n    */\n    static fromJSON(json) {\n        if (!json || !Array.isArray(json.ranges) || typeof json.main != \"number\" || json.main >= json.ranges.length)\n            throw new RangeError(\"Invalid JSON representation for EditorSelection\");\n        return new EditorSelection(json.ranges.map((r) => SelectionRange.fromJSON(r)), json.main);\n    }\n    /**\n    Create a selection holding a single range.\n    */\n    static single(anchor, head = anchor) {\n        return new EditorSelection([EditorSelection.range(anchor, head)], 0);\n    }\n    /**\n    Sort and merge the given set of ranges, creating a valid\n    selection.\n    */\n    static create(ranges, mainIndex = 0) {\n        if (ranges.length == 0)\n            throw new RangeError(\"A selection needs at least one range\");\n        for (let pos = 0, i = 0; i < ranges.length; i++) {\n            let range = ranges[i];\n            if (range.empty ? range.from <= pos : range.from < pos)\n                return EditorSelection.normalized(ranges.slice(), mainIndex);\n            pos = range.to;\n        }\n        return new EditorSelection(ranges, mainIndex);\n    }\n    /**\n    Create a cursor selection range at the given position. You can\n    safely ignore the optional arguments in most situations.\n    */\n    static cursor(pos, assoc = 0, bidiLevel, goalColumn) {\n        return SelectionRange.create(pos, pos, (assoc == 0 ? 0 : assoc < 0 ? 4 /* RangeFlag.AssocBefore */ : 8 /* RangeFlag.AssocAfter */) |\n            (bidiLevel == null ? 3 : Math.min(2, bidiLevel)) |\n            ((goalColumn !== null && goalColumn !== void 0 ? goalColumn : 33554431 /* RangeFlag.NoGoalColumn */) << 5 /* RangeFlag.GoalColumnOffset */));\n    }\n    /**\n    Create a selection range.\n    */\n    static range(anchor, head, goalColumn, bidiLevel) {\n        let flags = ((goalColumn !== null && goalColumn !== void 0 ? goalColumn : 33554431 /* RangeFlag.NoGoalColumn */) << 5 /* RangeFlag.GoalColumnOffset */) |\n            (bidiLevel == null ? 3 : Math.min(2, bidiLevel));\n        return head < anchor ? SelectionRange.create(head, anchor, 16 /* RangeFlag.Inverted */ | 8 /* RangeFlag.AssocAfter */ | flags)\n            : SelectionRange.create(anchor, head, (head > anchor ? 4 /* RangeFlag.AssocBefore */ : 0) | flags);\n    }\n    /**\n    @internal\n    */\n    static normalized(ranges, mainIndex = 0) {\n        let main = ranges[mainIndex];\n        ranges.sort((a, b) => a.from - b.from);\n        mainIndex = ranges.indexOf(main);\n        for (let i = 1; i < ranges.length; i++) {\n            let range = ranges[i], prev = ranges[i - 1];\n            if (range.empty ? range.from <= prev.to : range.from < prev.to) {\n                let from = prev.from, to = Math.max(range.to, prev.to);\n                if (i <= mainIndex)\n                    mainIndex--;\n                ranges.splice(--i, 2, range.anchor > range.head ? EditorSelection.range(to, from) : EditorSelection.range(from, to));\n            }\n        }\n        return new EditorSelection(ranges, mainIndex);\n    }\n}\nfunction checkSelection(selection, docLength) {\n    for (let range of selection.ranges)\n        if (range.to > docLength)\n            throw new RangeError(\"Selection points outside of document\");\n}\n\nlet nextID = 0;\n/**\nA facet is a labeled value that is associated with an editor\nstate. It takes inputs from any number of extensions, and combines\nthose into a single output value.\n\nExamples of uses of facets are the [tab\nsize](https://codemirror.net/6/docs/ref/#state.EditorState^tabSize), [editor\nattributes](https://codemirror.net/6/docs/ref/#view.EditorView^editorAttributes), and [update\nlisteners](https://codemirror.net/6/docs/ref/#view.EditorView^updateListener).\n*/\nclass Facet {\n    constructor(\n    /**\n    @internal\n    */\n    combine, \n    /**\n    @internal\n    */\n    compareInput, \n    /**\n    @internal\n    */\n    compare, isStatic, enables) {\n        this.combine = combine;\n        this.compareInput = compareInput;\n        this.compare = compare;\n        this.isStatic = isStatic;\n        /**\n        @internal\n        */\n        this.id = nextID++;\n        this.default = combine([]);\n        this.extensions = typeof enables == \"function\" ? enables(this) : enables;\n    }\n    /**\n    Define a new facet.\n    */\n    static define(config = {}) {\n        return new Facet(config.combine || ((a) => a), config.compareInput || ((a, b) => a === b), config.compare || (!config.combine ? sameArray : (a, b) => a === b), !!config.static, config.enables);\n    }\n    /**\n    Returns an extension that adds the given value to this facet.\n    */\n    of(value) {\n        return new FacetProvider([], this, 0 /* Provider.Static */, value);\n    }\n    /**\n    Create an extension that computes a value for the facet from a\n    state. You must take care to declare the parts of the state that\n    this value depends on, since your function is only called again\n    for a new state when one of those parts changed.\n    \n    In cases where your value depends only on a single field, you'll\n    want to use the [`from`](https://codemirror.net/6/docs/ref/#state.Facet.from) method instead.\n    */\n    compute(deps, get) {\n        if (this.isStatic)\n            throw new Error(\"Can't compute a static facet\");\n        return new FacetProvider(deps, this, 1 /* Provider.Single */, get);\n    }\n    /**\n    Create an extension that computes zero or more values for this\n    facet from a state.\n    */\n    computeN(deps, get) {\n        if (this.isStatic)\n            throw new Error(\"Can't compute a static facet\");\n        return new FacetProvider(deps, this, 2 /* Provider.Multi */, get);\n    }\n    from(field, get) {\n        if (!get)\n            get = x => x;\n        return this.compute([field], state => get(state.field(field)));\n    }\n}\nfunction sameArray(a, b) {\n    return a == b || a.length == b.length && a.every((e, i) => e === b[i]);\n}\nclass FacetProvider {\n    constructor(dependencies, facet, type, value) {\n        this.dependencies = dependencies;\n        this.facet = facet;\n        this.type = type;\n        this.value = value;\n        this.id = nextID++;\n    }\n    dynamicSlot(addresses) {\n        var _a;\n        let getter = this.value;\n        let compare = this.facet.compareInput;\n        let id = this.id, idx = addresses[id] >> 1, multi = this.type == 2 /* Provider.Multi */;\n        let depDoc = false, depSel = false, depAddrs = [];\n        for (let dep of this.dependencies) {\n            if (dep == \"doc\")\n                depDoc = true;\n            else if (dep == \"selection\")\n                depSel = true;\n            else if ((((_a = addresses[dep.id]) !== null && _a !== void 0 ? _a : 1) & 1) == 0)\n                depAddrs.push(addresses[dep.id]);\n        }\n        return {\n            create(state) {\n                state.values[idx] = getter(state);\n                return 1 /* SlotStatus.Changed */;\n            },\n            update(state, tr) {\n                if ((depDoc && tr.docChanged) || (depSel && (tr.docChanged || tr.selection)) || ensureAll(state, depAddrs)) {\n                    let newVal = getter(state);\n                    if (multi ? !compareArray(newVal, state.values[idx], compare) : !compare(newVal, state.values[idx])) {\n                        state.values[idx] = newVal;\n                        return 1 /* SlotStatus.Changed */;\n                    }\n                }\n                return 0;\n            },\n            reconfigure: (state, oldState) => {\n                let newVal, oldAddr = oldState.config.address[id];\n                if (oldAddr != null) {\n                    let oldVal = getAddr(oldState, oldAddr);\n                    if (this.dependencies.every(dep => {\n                        return dep instanceof Facet ? oldState.facet(dep) === state.facet(dep) :\n                            dep instanceof StateField ? oldState.field(dep, false) == state.field(dep, false) : true;\n                    }) || (multi ? compareArray(newVal = getter(state), oldVal, compare) : compare(newVal = getter(state), oldVal))) {\n                        state.values[idx] = oldVal;\n                        return 0;\n                    }\n                }\n                else {\n                    newVal = getter(state);\n                }\n                state.values[idx] = newVal;\n                return 1 /* SlotStatus.Changed */;\n            }\n        };\n    }\n}\nfunction compareArray(a, b, compare) {\n    if (a.length != b.length)\n        return false;\n    for (let i = 0; i < a.length; i++)\n        if (!compare(a[i], b[i]))\n            return false;\n    return true;\n}\nfunction ensureAll(state, addrs) {\n    let changed = false;\n    for (let addr of addrs)\n        if (ensureAddr(state, addr) & 1 /* SlotStatus.Changed */)\n            changed = true;\n    return changed;\n}\nfunction dynamicFacetSlot(addresses, facet, providers) {\n    let providerAddrs = providers.map(p => addresses[p.id]);\n    let providerTypes = providers.map(p => p.type);\n    let dynamic = providerAddrs.filter(p => !(p & 1));\n    let idx = addresses[facet.id] >> 1;\n    function get(state) {\n        let values = [];\n        for (let i = 0; i < providerAddrs.length; i++) {\n            let value = getAddr(state, providerAddrs[i]);\n            if (providerTypes[i] == 2 /* Provider.Multi */)\n                for (let val of value)\n                    values.push(val);\n            else\n                values.push(value);\n        }\n        return facet.combine(values);\n    }\n    return {\n        create(state) {\n            for (let addr of providerAddrs)\n                ensureAddr(state, addr);\n            state.values[idx] = get(state);\n            return 1 /* SlotStatus.Changed */;\n        },\n        update(state, tr) {\n            if (!ensureAll(state, dynamic))\n                return 0;\n            let value = get(state);\n            if (facet.compare(value, state.values[idx]))\n                return 0;\n            state.values[idx] = value;\n            return 1 /* SlotStatus.Changed */;\n        },\n        reconfigure(state, oldState) {\n            let depChanged = ensureAll(state, providerAddrs);\n            let oldProviders = oldState.config.facets[facet.id], oldValue = oldState.facet(facet);\n            if (oldProviders && !depChanged && sameArray(providers, oldProviders)) {\n                state.values[idx] = oldValue;\n                return 0;\n            }\n            let value = get(state);\n            if (facet.compare(value, oldValue)) {\n                state.values[idx] = oldValue;\n                return 0;\n            }\n            state.values[idx] = value;\n            return 1 /* SlotStatus.Changed */;\n        }\n    };\n}\nconst initField = /*@__PURE__*/Facet.define({ static: true });\n/**\nFields can store additional information in an editor state, and\nkeep it in sync with the rest of the state.\n*/\nclass StateField {\n    constructor(\n    /**\n    @internal\n    */\n    id, createF, updateF, compareF, \n    /**\n    @internal\n    */\n    spec) {\n        this.id = id;\n        this.createF = createF;\n        this.updateF = updateF;\n        this.compareF = compareF;\n        this.spec = spec;\n        /**\n        @internal\n        */\n        this.provides = undefined;\n    }\n    /**\n    Define a state field.\n    */\n    static define(config) {\n        let field = new StateField(nextID++, config.create, config.update, config.compare || ((a, b) => a === b), config);\n        if (config.provide)\n            field.provides = config.provide(field);\n        return field;\n    }\n    create(state) {\n        let init = state.facet(initField).find(i => i.field == this);\n        return ((init === null || init === void 0 ? void 0 : init.create) || this.createF)(state);\n    }\n    /**\n    @internal\n    */\n    slot(addresses) {\n        let idx = addresses[this.id] >> 1;\n        return {\n            create: (state) => {\n                state.values[idx] = this.create(state);\n                return 1 /* SlotStatus.Changed */;\n            },\n            update: (state, tr) => {\n                let oldVal = state.values[idx];\n                let value = this.updateF(oldVal, tr);\n                if (this.compareF(oldVal, value))\n                    return 0;\n                state.values[idx] = value;\n                return 1 /* SlotStatus.Changed */;\n            },\n            reconfigure: (state, oldState) => {\n                if (oldState.config.address[this.id] != null) {\n                    state.values[idx] = oldState.field(this);\n                    return 0;\n                }\n                state.values[idx] = this.create(state);\n                return 1 /* SlotStatus.Changed */;\n            }\n        };\n    }\n    /**\n    Returns an extension that enables this field and overrides the\n    way it is initialized. Can be useful when you need to provide a\n    non-default starting value for the field.\n    */\n    init(create) {\n        return [this, initField.of({ field: this, create })];\n    }\n    /**\n    State field instances can be used as\n    [`Extension`](https://codemirror.net/6/docs/ref/#state.Extension) values to enable the field in a\n    given state.\n    */\n    get extension() { return this; }\n}\nconst Prec_ = { lowest: 4, low: 3, default: 2, high: 1, highest: 0 };\nfunction prec(value) {\n    return (ext) => new PrecExtension(ext, value);\n}\n/**\nBy default extensions are registered in the order they are found\nin the flattened form of nested array that was provided.\nIndividual extension values can be assigned a precedence to\noverride this. Extensions that do not have a precedence set get\nthe precedence of the nearest parent with a precedence, or\n[`default`](https://codemirror.net/6/docs/ref/#state.Prec.default) if there is no such parent. The\nfinal ordering of extensions is determined by first sorting by\nprecedence and then by order within each precedence.\n*/\nconst Prec = {\n    /**\n    The highest precedence level, for extensions that should end up\n    near the start of the precedence ordering.\n    */\n    highest: /*@__PURE__*/prec(Prec_.highest),\n    /**\n    A higher-than-default precedence, for extensions that should\n    come before those with default precedence.\n    */\n    high: /*@__PURE__*/prec(Prec_.high),\n    /**\n    The default precedence, which is also used for extensions\n    without an explicit precedence.\n    */\n    default: /*@__PURE__*/prec(Prec_.default),\n    /**\n    A lower-than-default precedence.\n    */\n    low: /*@__PURE__*/prec(Prec_.low),\n    /**\n    The lowest precedence level. Meant for things that should end up\n    near the end of the extension order.\n    */\n    lowest: /*@__PURE__*/prec(Prec_.lowest)\n};\nclass PrecExtension {\n    constructor(inner, prec) {\n        this.inner = inner;\n        this.prec = prec;\n    }\n}\n/**\nExtension compartments can be used to make a configuration\ndynamic. By [wrapping](https://codemirror.net/6/docs/ref/#state.Compartment.of) part of your\nconfiguration in a compartment, you can later\n[replace](https://codemirror.net/6/docs/ref/#state.Compartment.reconfigure) that part through a\ntransaction.\n*/\nclass Compartment {\n    /**\n    Create an instance of this compartment to add to your [state\n    configuration](https://codemirror.net/6/docs/ref/#state.EditorStateConfig.extensions).\n    */\n    of(ext) { return new CompartmentInstance(this, ext); }\n    /**\n    Create an [effect](https://codemirror.net/6/docs/ref/#state.TransactionSpec.effects) that\n    reconfigures this compartment.\n    */\n    reconfigure(content) {\n        return Compartment.reconfigure.of({ compartment: this, extension: content });\n    }\n    /**\n    Get the current content of the compartment in the state, or\n    `undefined` if it isn't present.\n    */\n    get(state) {\n        return state.config.compartments.get(this);\n    }\n}\nclass CompartmentInstance {\n    constructor(compartment, inner) {\n        this.compartment = compartment;\n        this.inner = inner;\n    }\n}\nclass Configuration {\n    constructor(base, compartments, dynamicSlots, address, staticValues, facets) {\n        this.base = base;\n        this.compartments = compartments;\n        this.dynamicSlots = dynamicSlots;\n        this.address = address;\n        this.staticValues = staticValues;\n        this.facets = facets;\n        this.statusTemplate = [];\n        while (this.statusTemplate.length < dynamicSlots.length)\n            this.statusTemplate.push(0 /* SlotStatus.Unresolved */);\n    }\n    staticFacet(facet) {\n        let addr = this.address[facet.id];\n        return addr == null ? facet.default : this.staticValues[addr >> 1];\n    }\n    static resolve(base, compartments, oldState) {\n        let fields = [];\n        let facets = Object.create(null);\n        let newCompartments = new Map();\n        for (let ext of flatten(base, compartments, newCompartments)) {\n            if (ext instanceof StateField)\n                fields.push(ext);\n            else\n                (facets[ext.facet.id] || (facets[ext.facet.id] = [])).push(ext);\n        }\n        let address = Object.create(null);\n        let staticValues = [];\n        let dynamicSlots = [];\n        for (let field of fields) {\n            address[field.id] = dynamicSlots.length << 1;\n            dynamicSlots.push(a => field.slot(a));\n        }\n        let oldFacets = oldState === null || oldState === void 0 ? void 0 : oldState.config.facets;\n        for (let id in facets) {\n            let providers = facets[id], facet = providers[0].facet;\n            let oldProviders = oldFacets && oldFacets[id] || [];\n            if (providers.every(p => p.type == 0 /* Provider.Static */)) {\n                address[facet.id] = (staticValues.length << 1) | 1;\n                if (sameArray(oldProviders, providers)) {\n                    staticValues.push(oldState.facet(facet));\n                }\n                else {\n                    let value = facet.combine(providers.map(p => p.value));\n                    staticValues.push(oldState && facet.compare(value, oldState.facet(facet)) ? oldState.facet(facet) : value);\n                }\n            }\n            else {\n                for (let p of providers) {\n                    if (p.type == 0 /* Provider.Static */) {\n                        address[p.id] = (staticValues.length << 1) | 1;\n                        staticValues.push(p.value);\n                    }\n                    else {\n                        address[p.id] = dynamicSlots.length << 1;\n                        dynamicSlots.push(a => p.dynamicSlot(a));\n                    }\n                }\n                address[facet.id] = dynamicSlots.length << 1;\n                dynamicSlots.push(a => dynamicFacetSlot(a, facet, providers));\n            }\n        }\n        let dynamic = dynamicSlots.map(f => f(address));\n        return new Configuration(base, newCompartments, dynamic, address, staticValues, facets);\n    }\n}\nfunction flatten(extension, compartments, newCompartments) {\n    let result = [[], [], [], [], []];\n    let seen = new Map();\n    function inner(ext, prec) {\n        let known = seen.get(ext);\n        if (known != null) {\n            if (known <= prec)\n                return;\n            let found = result[known].indexOf(ext);\n            if (found > -1)\n                result[known].splice(found, 1);\n            if (ext instanceof CompartmentInstance)\n                newCompartments.delete(ext.compartment);\n        }\n        seen.set(ext, prec);\n        if (Array.isArray(ext)) {\n            for (let e of ext)\n                inner(e, prec);\n        }\n        else if (ext instanceof CompartmentInstance) {\n            if (newCompartments.has(ext.compartment))\n                throw new RangeError(`Duplicate use of compartment in extensions`);\n            let content = compartments.get(ext.compartment) || ext.inner;\n            newCompartments.set(ext.compartment, content);\n            inner(content, prec);\n        }\n        else if (ext instanceof PrecExtension) {\n            inner(ext.inner, ext.prec);\n        }\n        else if (ext instanceof StateField) {\n            result[prec].push(ext);\n            if (ext.provides)\n                inner(ext.provides, prec);\n        }\n        else if (ext instanceof FacetProvider) {\n            result[prec].push(ext);\n            if (ext.facet.extensions)\n                inner(ext.facet.extensions, Prec_.default);\n        }\n        else {\n            let content = ext.extension;\n            if (!content)\n                throw new Error(`Unrecognized extension value in extension set (${ext}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);\n            inner(content, prec);\n        }\n    }\n    inner(extension, Prec_.default);\n    return result.reduce((a, b) => a.concat(b));\n}\nfunction ensureAddr(state, addr) {\n    if (addr & 1)\n        return 2 /* SlotStatus.Computed */;\n    let idx = addr >> 1;\n    let status = state.status[idx];\n    if (status == 4 /* SlotStatus.Computing */)\n        throw new Error(\"Cyclic dependency between fields and/or facets\");\n    if (status & 2 /* SlotStatus.Computed */)\n        return status;\n    state.status[idx] = 4 /* SlotStatus.Computing */;\n    let changed = state.computeSlot(state, state.config.dynamicSlots[idx]);\n    return state.status[idx] = 2 /* SlotStatus.Computed */ | changed;\n}\nfunction getAddr(state, addr) {\n    return addr & 1 ? state.config.staticValues[addr >> 1] : state.values[addr >> 1];\n}\n\nconst languageData = /*@__PURE__*/Facet.define();\nconst allowMultipleSelections = /*@__PURE__*/Facet.define({\n    combine: values => values.some(v => v),\n    static: true\n});\nconst lineSeparator = /*@__PURE__*/Facet.define({\n    combine: values => values.length ? values[0] : undefined,\n    static: true\n});\nconst changeFilter = /*@__PURE__*/Facet.define();\nconst transactionFilter = /*@__PURE__*/Facet.define();\nconst transactionExtender = /*@__PURE__*/Facet.define();\nconst readOnly = /*@__PURE__*/Facet.define({\n    combine: values => values.length ? values[0] : false\n});\n\n/**\nAnnotations are tagged values that are used to add metadata to\ntransactions in an extensible way. They should be used to model\nthings that effect the entire transaction (such as its [time\nstamp](https://codemirror.net/6/docs/ref/#state.Transaction^time) or information about its\n[origin](https://codemirror.net/6/docs/ref/#state.Transaction^userEvent)). For effects that happen\n_alongside_ the other changes made by the transaction, [state\neffects](https://codemirror.net/6/docs/ref/#state.StateEffect) are more appropriate.\n*/\nclass Annotation {\n    /**\n    @internal\n    */\n    constructor(\n    /**\n    The annotation type.\n    */\n    type, \n    /**\n    The value of this annotation.\n    */\n    value) {\n        this.type = type;\n        this.value = value;\n    }\n    /**\n    Define a new type of annotation.\n    */\n    static define() { return new AnnotationType(); }\n}\n/**\nMarker that identifies a type of [annotation](https://codemirror.net/6/docs/ref/#state.Annotation).\n*/\nclass AnnotationType {\n    /**\n    Create an instance of this annotation.\n    */\n    of(value) { return new Annotation(this, value); }\n}\n/**\nRepresentation of a type of state effect. Defined with\n[`StateEffect.define`](https://codemirror.net/6/docs/ref/#state.StateEffect^define).\n*/\nclass StateEffectType {\n    /**\n    @internal\n    */\n    constructor(\n    // The `any` types in these function types are there to work\n    // around TypeScript issue #37631, where the type guard on\n    // `StateEffect.is` mysteriously stops working when these properly\n    // have type `Value`.\n    /**\n    @internal\n    */\n    map) {\n        this.map = map;\n    }\n    /**\n    Create a [state effect](https://codemirror.net/6/docs/ref/#state.StateEffect) instance of this\n    type.\n    */\n    of(value) { return new StateEffect(this, value); }\n}\n/**\nState effects can be used to represent additional effects\nassociated with a [transaction](https://codemirror.net/6/docs/ref/#state.Transaction.effects). They\nare often useful to model changes to custom [state\nfields](https://codemirror.net/6/docs/ref/#state.StateField), when those changes aren't implicit in\ndocument or selection changes.\n*/\nclass StateEffect {\n    /**\n    @internal\n    */\n    constructor(\n    /**\n    @internal\n    */\n    type, \n    /**\n    The value of this effect.\n    */\n    value) {\n        this.type = type;\n        this.value = value;\n    }\n    /**\n    Map this effect through a position mapping. Will return\n    `undefined` when that ends up deleting the effect.\n    */\n    map(mapping) {\n        let mapped = this.type.map(this.value, mapping);\n        return mapped === undefined ? undefined : mapped == this.value ? this : new StateEffect(this.type, mapped);\n    }\n    /**\n    Tells you whether this effect object is of a given\n    [type](https://codemirror.net/6/docs/ref/#state.StateEffectType).\n    */\n    is(type) { return this.type == type; }\n    /**\n    Define a new effect type. The type parameter indicates the type\n    of values that his effect holds.\n    */\n    static define(spec = {}) {\n        return new StateEffectType(spec.map || (v => v));\n    }\n    /**\n    Map an array of effects through a change set.\n    */\n    static mapEffects(effects, mapping) {\n        if (!effects.length)\n            return effects;\n        let result = [];\n        for (let effect of effects) {\n            let mapped = effect.map(mapping);\n            if (mapped)\n                result.push(mapped);\n        }\n        return result;\n    }\n}\n/**\nThis effect can be used to reconfigure the root extensions of\nthe editor. Doing this will discard any extensions\n[appended](https://codemirror.net/6/docs/ref/#state.StateEffect^appendConfig), but does not reset\nthe content of [reconfigured](https://codemirror.net/6/docs/ref/#state.Compartment.reconfigure)\ncompartments.\n*/\nStateEffect.reconfigure = /*@__PURE__*/StateEffect.define();\n/**\nAppend extensions to the top-level configuration of the editor.\n*/\nStateEffect.appendConfig = /*@__PURE__*/StateEffect.define();\n/**\nChanges to the editor state are grouped into transactions.\nTypically, a user action creates a single transaction, which may\ncontain any number of document changes, may change the selection,\nor have other effects. Create a transaction by calling\n[`EditorState.update`](https://codemirror.net/6/docs/ref/#state.EditorState.update), or immediately\ndispatch one by calling\n[`EditorView.dispatch`](https://codemirror.net/6/docs/ref/#view.EditorView.dispatch).\n*/\nclass Transaction {\n    constructor(\n    /**\n    The state from which the transaction starts.\n    */\n    startState, \n    /**\n    The document changes made by this transaction.\n    */\n    changes, \n    /**\n    The selection set by this transaction, or undefined if it\n    doesn't explicitly set a selection.\n    */\n    selection, \n    /**\n    The effects added to the transaction.\n    */\n    effects, \n    /**\n    @internal\n    */\n    annotations, \n    /**\n    Whether the selection should be scrolled into view after this\n    transaction is dispatched.\n    */\n    scrollIntoView) {\n        this.startState = startState;\n        this.changes = changes;\n        this.selection = selection;\n        this.effects = effects;\n        this.annotations = annotations;\n        this.scrollIntoView = scrollIntoView;\n        /**\n        @internal\n        */\n        this._doc = null;\n        /**\n        @internal\n        */\n        this._state = null;\n        if (selection)\n            checkSelection(selection, changes.newLength);\n        if (!annotations.some((a) => a.type == Transaction.time))\n            this.annotations = annotations.concat(Transaction.time.of(Date.now()));\n    }\n    /**\n    @internal\n    */\n    static create(startState, changes, selection, effects, annotations, scrollIntoView) {\n        return new Transaction(startState, changes, selection, effects, annotations, scrollIntoView);\n    }\n    /**\n    The new document produced by the transaction. Contrary to\n    [`.state`](https://codemirror.net/6/docs/ref/#state.Transaction.state)`.doc`, accessing this won't\n    force the entire new state to be computed right away, so it is\n    recommended that [transaction\n    filters](https://codemirror.net/6/docs/ref/#state.EditorState^transactionFilter) use this getter\n    when they need to look at the new document.\n    */\n    get newDoc() {\n        return this._doc || (this._doc = this.changes.apply(this.startState.doc));\n    }\n    /**\n    The new selection produced by the transaction. If\n    [`this.selection`](https://codemirror.net/6/docs/ref/#state.Transaction.selection) is undefined,\n    this will [map](https://codemirror.net/6/docs/ref/#state.EditorSelection.map) the start state's\n    current selection through the changes made by the transaction.\n    */\n    get newSelection() {\n        return this.selection || this.startState.selection.map(this.changes);\n    }\n    /**\n    The new state created by the transaction. Computed on demand\n    (but retained for subsequent access), so it is recommended not to\n    access it in [transaction\n    filters](https://codemirror.net/6/docs/ref/#state.EditorState^transactionFilter) when possible.\n    */\n    get state() {\n        if (!this._state)\n            this.startState.applyTransaction(this);\n        return this._state;\n    }\n    /**\n    Get the value of the given annotation type, if any.\n    */\n    annotation(type) {\n        for (let ann of this.annotations)\n            if (ann.type == type)\n                return ann.value;\n        return undefined;\n    }\n    /**\n    Indicates whether the transaction changed the document.\n    */\n    get docChanged() { return !this.changes.empty; }\n    /**\n    Indicates whether this transaction reconfigures the state\n    (through a [configuration compartment](https://codemirror.net/6/docs/ref/#state.Compartment) or\n    with a top-level configuration\n    [effect](https://codemirror.net/6/docs/ref/#state.StateEffect^reconfigure).\n    */\n    get reconfigured() { return this.startState.config != this.state.config; }\n    /**\n    Returns true if the transaction has a [user\n    event](https://codemirror.net/6/docs/ref/#state.Transaction^userEvent) annotation that is equal to\n    or more specific than `event`. For example, if the transaction\n    has `\"select.pointer\"` as user event, `\"select\"` and\n    `\"select.pointer\"` will match it.\n    */\n    isUserEvent(event) {\n        let e = this.annotation(Transaction.userEvent);\n        return !!(e && (e == event || e.length > event.length && e.slice(0, event.length) == event && e[event.length] == \".\"));\n    }\n}\n/**\nAnnotation used to store transaction timestamps. Automatically\nadded to every transaction, holding `Date.now()`.\n*/\nTransaction.time = /*@__PURE__*/Annotation.define();\n/**\nAnnotation used to associate a transaction with a user interface\nevent. Holds a string identifying the event, using a\ndot-separated format to support attaching more specific\ninformation. The events used by the core libraries are:\n\n - `\"input\"` when content is entered\n   - `\"input.type\"` for typed input\n     - `\"input.type.compose\"` for composition\n   - `\"input.paste\"` for pasted input\n   - `\"input.drop\"` when adding content with drag-and-drop\n   - `\"input.complete\"` when autocompleting\n - `\"delete\"` when the user deletes content\n   - `\"delete.selection\"` when deleting the selection\n   - `\"delete.forward\"` when deleting forward from the selection\n   - `\"delete.backward\"` when deleting backward from the selection\n   - `\"delete.cut\"` when cutting to the clipboard\n - `\"move\"` when content is moved\n   - `\"move.drop\"` when content is moved within the editor through drag-and-drop\n - `\"select\"` when explicitly changing the selection\n   - `\"select.pointer\"` when selecting with a mouse or other pointing device\n - `\"undo\"` and `\"redo\"` for history actions\n\nUse [`isUserEvent`](https://codemirror.net/6/docs/ref/#state.Transaction.isUserEvent) to check\nwhether the annotation matches a given event.\n*/\nTransaction.userEvent = /*@__PURE__*/Annotation.define();\n/**\nAnnotation indicating whether a transaction should be added to\nthe undo history or not.\n*/\nTransaction.addToHistory = /*@__PURE__*/Annotation.define();\n/**\nAnnotation indicating (when present and true) that a transaction\nrepresents a change made by some other actor, not the user. This\nis used, for example, to tag other people's changes in\ncollaborative editing.\n*/\nTransaction.remote = /*@__PURE__*/Annotation.define();\nfunction joinRanges(a, b) {\n    let result = [];\n    for (let iA = 0, iB = 0;;) {\n        let from, to;\n        if (iA < a.length && (iB == b.length || b[iB] >= a[iA])) {\n            from = a[iA++];\n            to = a[iA++];\n        }\n        else if (iB < b.length) {\n            from = b[iB++];\n            to = b[iB++];\n        }\n        else\n            return result;\n        if (!result.length || result[result.length - 1] < from)\n            result.push(from, to);\n        else if (result[result.length - 1] < to)\n            result[result.length - 1] = to;\n    }\n}\nfunction mergeTransaction(a, b, sequential) {\n    var _a;\n    let mapForA, mapForB, changes;\n    if (sequential) {\n        mapForA = b.changes;\n        mapForB = ChangeSet.empty(b.changes.length);\n        changes = a.changes.compose(b.changes);\n    }\n    else {\n        mapForA = b.changes.map(a.changes);\n        mapForB = a.changes.mapDesc(b.changes, true);\n        changes = a.changes.compose(mapForA);\n    }\n    return {\n        changes,\n        selection: b.selection ? b.selection.map(mapForB) : (_a = a.selection) === null || _a === void 0 ? void 0 : _a.map(mapForA),\n        effects: StateEffect.mapEffects(a.effects, mapForA).concat(StateEffect.mapEffects(b.effects, mapForB)),\n        annotations: a.annotations.length ? a.annotations.concat(b.annotations) : b.annotations,\n        scrollIntoView: a.scrollIntoView || b.scrollIntoView\n    };\n}\nfunction resolveTransactionInner(state, spec, docSize) {\n    let sel = spec.selection, annotations = asArray(spec.annotations);\n    if (spec.userEvent)\n        annotations = annotations.concat(Transaction.userEvent.of(spec.userEvent));\n    return {\n        changes: spec.changes instanceof ChangeSet ? spec.changes\n            : ChangeSet.of(spec.changes || [], docSize, state.facet(lineSeparator)),\n        selection: sel && (sel instanceof EditorSelection ? sel : EditorSelection.single(sel.anchor, sel.head)),\n        effects: asArray(spec.effects),\n        annotations,\n        scrollIntoView: !!spec.scrollIntoView\n    };\n}\nfunction resolveTransaction(state, specs, filter) {\n    let s = resolveTransactionInner(state, specs.length ? specs[0] : {}, state.doc.length);\n    if (specs.length && specs[0].filter === false)\n        filter = false;\n    for (let i = 1; i < specs.length; i++) {\n        if (specs[i].filter === false)\n            filter = false;\n        let seq = !!specs[i].sequential;\n        s = mergeTransaction(s, resolveTransactionInner(state, specs[i], seq ? s.changes.newLength : state.doc.length), seq);\n    }\n    let tr = Transaction.create(state, s.changes, s.selection, s.effects, s.annotations, s.scrollIntoView);\n    return extendTransaction(filter ? filterTransaction(tr) : tr);\n}\n// Finish a transaction by applying filters if necessary.\nfunction filterTransaction(tr) {\n    let state = tr.startState;\n    // Change filters\n    let result = true;\n    for (let filter of state.facet(changeFilter)) {\n        let value = filter(tr);\n        if (value === false) {\n            result = false;\n            break;\n        }\n        if (Array.isArray(value))\n            result = result === true ? value : joinRanges(result, value);\n    }\n    if (result !== true) {\n        let changes, back;\n        if (result === false) {\n            back = tr.changes.invertedDesc;\n            changes = ChangeSet.empty(state.doc.length);\n        }\n        else {\n            let filtered = tr.changes.filter(result);\n            changes = filtered.changes;\n            back = filtered.filtered.mapDesc(filtered.changes).invertedDesc;\n        }\n        tr = Transaction.create(state, changes, tr.selection && tr.selection.map(back), StateEffect.mapEffects(tr.effects, back), tr.annotations, tr.scrollIntoView);\n    }\n    // Transaction filters\n    let filters = state.facet(transactionFilter);\n    for (let i = filters.length - 1; i >= 0; i--) {\n        let filtered = filters[i](tr);\n        if (filtered instanceof Transaction)\n            tr = filtered;\n        else if (Array.isArray(filtered) && filtered.length == 1 && filtered[0] instanceof Transaction)\n            tr = filtered[0];\n        else\n            tr = resolveTransaction(state, asArray(filtered), false);\n    }\n    return tr;\n}\nfunction extendTransaction(tr) {\n    let state = tr.startState, extenders = state.facet(transactionExtender), spec = tr;\n    for (let i = extenders.length - 1; i >= 0; i--) {\n        let extension = extenders[i](tr);\n        if (extension && Object.keys(extension).length)\n            spec = mergeTransaction(spec, resolveTransactionInner(state, extension, tr.changes.newLength), true);\n    }\n    return spec == tr ? tr : Transaction.create(state, tr.changes, tr.selection, spec.effects, spec.annotations, spec.scrollIntoView);\n}\nconst none = [];\nfunction asArray(value) {\n    return value == null ? none : Array.isArray(value) ? value : [value];\n}\n\n/**\nThe categories produced by a [character\ncategorizer](https://codemirror.net/6/docs/ref/#state.EditorState.charCategorizer). These are used\ndo things like selecting by word.\n*/\nvar CharCategory = /*@__PURE__*/(function (CharCategory) {\n    /**\n    Word characters.\n    */\n    CharCategory[CharCategory[\"Word\"] = 0] = \"Word\";\n    /**\n    Whitespace.\n    */\n    CharCategory[CharCategory[\"Space\"] = 1] = \"Space\";\n    /**\n    Anything else.\n    */\n    CharCategory[CharCategory[\"Other\"] = 2] = \"Other\";\nreturn CharCategory})(CharCategory || (CharCategory = {}));\nconst nonASCIISingleCaseWordChar = /[\\u00df\\u0587\\u0590-\\u05f4\\u0600-\\u06ff\\u3040-\\u309f\\u30a0-\\u30ff\\u3400-\\u4db5\\u4e00-\\u9fcc\\uac00-\\ud7af]/;\nlet wordChar;\ntry {\n    wordChar = /*@__PURE__*/new RegExp(\"[\\\\p{Alphabetic}\\\\p{Number}_]\", \"u\");\n}\ncatch (_) { }\nfunction hasWordChar(str) {\n    if (wordChar)\n        return wordChar.test(str);\n    for (let i = 0; i < str.length; i++) {\n        let ch = str[i];\n        if (/\\w/.test(ch) || ch > \"\\x80\" && (ch.toUpperCase() != ch.toLowerCase() || nonASCIISingleCaseWordChar.test(ch)))\n            return true;\n    }\n    return false;\n}\nfunction makeCategorizer(wordChars) {\n    return (char) => {\n        if (!/\\S/.test(char))\n            return CharCategory.Space;\n        if (hasWordChar(char))\n            return CharCategory.Word;\n        for (let i = 0; i < wordChars.length; i++)\n            if (char.indexOf(wordChars[i]) > -1)\n                return CharCategory.Word;\n        return CharCategory.Other;\n    };\n}\n\n/**\nThe editor state class is a persistent (immutable) data structure.\nTo update a state, you [create](https://codemirror.net/6/docs/ref/#state.EditorState.update) a\n[transaction](https://codemirror.net/6/docs/ref/#state.Transaction), which produces a _new_ state\ninstance, without modifying the original object.\n\nAs such, _never_ mutate properties of a state directly. That'll\njust break things.\n*/\nclass EditorState {\n    constructor(\n    /**\n    @internal\n    */\n    config, \n    /**\n    The current document.\n    */\n    doc, \n    /**\n    The current selection.\n    */\n    selection, \n    /**\n    @internal\n    */\n    values, computeSlot, tr) {\n        this.config = config;\n        this.doc = doc;\n        this.selection = selection;\n        this.values = values;\n        this.status = config.statusTemplate.slice();\n        this.computeSlot = computeSlot;\n        // Fill in the computed state immediately, so that further queries\n        // for it made during the update return this state\n        if (tr)\n            tr._state = this;\n        for (let i = 0; i < this.config.dynamicSlots.length; i++)\n            ensureAddr(this, i << 1);\n        this.computeSlot = null;\n    }\n    field(field, require = true) {\n        let addr = this.config.address[field.id];\n        if (addr == null) {\n            if (require)\n                throw new RangeError(\"Field is not present in this state\");\n            return undefined;\n        }\n        ensureAddr(this, addr);\n        return getAddr(this, addr);\n    }\n    /**\n    Create a [transaction](https://codemirror.net/6/docs/ref/#state.Transaction) that updates this\n    state. Any number of [transaction specs](https://codemirror.net/6/docs/ref/#state.TransactionSpec)\n    can be passed. Unless\n    [`sequential`](https://codemirror.net/6/docs/ref/#state.TransactionSpec.sequential) is set, the\n    [changes](https://codemirror.net/6/docs/ref/#state.TransactionSpec.changes) (if any) of each spec\n    are assumed to start in the _current_ document (not the document\n    produced by previous specs), and its\n    [selection](https://codemirror.net/6/docs/ref/#state.TransactionSpec.selection) and\n    [effects](https://codemirror.net/6/docs/ref/#state.TransactionSpec.effects) are assumed to refer\n    to the document created by its _own_ changes. The resulting\n    transaction contains the combined effect of all the different\n    specs. For [selection](https://codemirror.net/6/docs/ref/#state.TransactionSpec.selection), later\n    specs take precedence over earlier ones.\n    */\n    update(...specs) {\n        return resolveTransaction(this, specs, true);\n    }\n    /**\n    @internal\n    */\n    applyTransaction(tr) {\n        let conf = this.config, { base, compartments } = conf;\n        for (let effect of tr.effects) {\n            if (effect.is(Compartment.reconfigure)) {\n                if (conf) {\n                    compartments = new Map;\n                    conf.compartments.forEach((val, key) => compartments.set(key, val));\n                    conf = null;\n                }\n                compartments.set(effect.value.compartment, effect.value.extension);\n            }\n            else if (effect.is(StateEffect.reconfigure)) {\n                conf = null;\n                base = effect.value;\n            }\n            else if (effect.is(StateEffect.appendConfig)) {\n                conf = null;\n                base = asArray(base).concat(effect.value);\n            }\n        }\n        let startValues;\n        if (!conf) {\n            conf = Configuration.resolve(base, compartments, this);\n            let intermediateState = new EditorState(conf, this.doc, this.selection, conf.dynamicSlots.map(() => null), (state, slot) => slot.reconfigure(state, this), null);\n            startValues = intermediateState.values;\n        }\n        else {\n            startValues = tr.startState.values.slice();\n        }\n        new EditorState(conf, tr.newDoc, tr.newSelection, startValues, (state, slot) => slot.update(state, tr), tr);\n    }\n    /**\n    Create a [transaction spec](https://codemirror.net/6/docs/ref/#state.TransactionSpec) that\n    replaces every selection range with the given content.\n    */\n    replaceSelection(text) {\n        if (typeof text == \"string\")\n            text = this.toText(text);\n        return this.changeByRange(range => ({ changes: { from: range.from, to: range.to, insert: text },\n            range: EditorSelection.cursor(range.from + text.length) }));\n    }\n    /**\n    Create a set of changes and a new selection by running the given\n    function for each range in the active selection. The function\n    can return an optional set of changes (in the coordinate space\n    of the start document), plus an updated range (in the coordinate\n    space of the document produced by the call's own changes). This\n    method will merge all the changes and ranges into a single\n    changeset and selection, and return it as a [transaction\n    spec](https://codemirror.net/6/docs/ref/#state.TransactionSpec), which can be passed to\n    [`update`](https://codemirror.net/6/docs/ref/#state.EditorState.update).\n    */\n    changeByRange(f) {\n        let sel = this.selection;\n        let result1 = f(sel.ranges[0]);\n        let changes = this.changes(result1.changes), ranges = [result1.range];\n        let effects = asArray(result1.effects);\n        for (let i = 1; i < sel.ranges.length; i++) {\n            let result = f(sel.ranges[i]);\n            let newChanges = this.changes(result.changes), newMapped = newChanges.map(changes);\n            for (let j = 0; j < i; j++)\n                ranges[j] = ranges[j].map(newMapped);\n            let mapBy = changes.mapDesc(newChanges, true);\n            ranges.push(result.range.map(mapBy));\n            changes = changes.compose(newMapped);\n            effects = StateEffect.mapEffects(effects, newMapped).concat(StateEffect.mapEffects(asArray(result.effects), mapBy));\n        }\n        return {\n            changes,\n            selection: EditorSelection.create(ranges, sel.mainIndex),\n            effects\n        };\n    }\n    /**\n    Create a [change set](https://codemirror.net/6/docs/ref/#state.ChangeSet) from the given change\n    description, taking the state's document length and line\n    separator into account.\n    */\n    changes(spec = []) {\n        if (spec instanceof ChangeSet)\n            return spec;\n        return ChangeSet.of(spec, this.doc.length, this.facet(EditorState.lineSeparator));\n    }\n    /**\n    Using the state's [line\n    separator](https://codemirror.net/6/docs/ref/#state.EditorState^lineSeparator), create a\n    [`Text`](https://codemirror.net/6/docs/ref/#state.Text) instance from the given string.\n    */\n    toText(string) {\n        return Text.of(string.split(this.facet(EditorState.lineSeparator) || DefaultSplit));\n    }\n    /**\n    Return the given range of the document as a string.\n    */\n    sliceDoc(from = 0, to = this.doc.length) {\n        return this.doc.sliceString(from, to, this.lineBreak);\n    }\n    /**\n    Get the value of a state [facet](https://codemirror.net/6/docs/ref/#state.Facet).\n    */\n    facet(facet) {\n        let addr = this.config.address[facet.id];\n        if (addr == null)\n            return facet.default;\n        ensureAddr(this, addr);\n        return getAddr(this, addr);\n    }\n    /**\n    Convert this state to a JSON-serializable object. When custom\n    fields should be serialized, you can pass them in as an object\n    mapping property names (in the resulting object, which should\n    not use `doc` or `selection`) to fields.\n    */\n    toJSON(fields) {\n        let result = {\n            doc: this.sliceDoc(),\n            selection: this.selection.toJSON()\n        };\n        if (fields)\n            for (let prop in fields) {\n                let value = fields[prop];\n                if (value instanceof StateField && this.config.address[value.id] != null)\n                    result[prop] = value.spec.toJSON(this.field(fields[prop]), this);\n            }\n        return result;\n    }\n    /**\n    Deserialize a state from its JSON representation. When custom\n    fields should be deserialized, pass the same object you passed\n    to [`toJSON`](https://codemirror.net/6/docs/ref/#state.EditorState.toJSON) when serializing as\n    third argument.\n    */\n    static fromJSON(json, config = {}, fields) {\n        if (!json || typeof json.doc != \"string\")\n            throw new RangeError(\"Invalid JSON representation for EditorState\");\n        let fieldInit = [];\n        if (fields)\n            for (let prop in fields) {\n                if (Object.prototype.hasOwnProperty.call(json, prop)) {\n                    let field = fields[prop], value = json[prop];\n                    fieldInit.push(field.init(state => field.spec.fromJSON(value, state)));\n                }\n            }\n        return EditorState.create({\n            doc: json.doc,\n            selection: EditorSelection.fromJSON(json.selection),\n            extensions: config.extensions ? fieldInit.concat([config.extensions]) : fieldInit\n        });\n    }\n    /**\n    Create a new state. You'll usually only need this when\n    initializing an editor—updated states are created by applying\n    transactions.\n    */\n    static create(config = {}) {\n        let configuration = Configuration.resolve(config.extensions || [], new Map);\n        let doc = config.doc instanceof Text ? config.doc\n            : Text.of((config.doc || \"\").split(configuration.staticFacet(EditorState.lineSeparator) || DefaultSplit));\n        let selection = !config.selection ? EditorSelection.single(0)\n            : config.selection instanceof EditorSelection ? config.selection\n                : EditorSelection.single(config.selection.anchor, config.selection.head);\n        checkSelection(selection, doc.length);\n        if (!configuration.staticFacet(allowMultipleSelections))\n            selection = selection.asSingle();\n        return new EditorState(configuration, doc, selection, configuration.dynamicSlots.map(() => null), (state, slot) => slot.create(state), null);\n    }\n    /**\n    The size (in columns) of a tab in the document, determined by\n    the [`tabSize`](https://codemirror.net/6/docs/ref/#state.EditorState^tabSize) facet.\n    */\n    get tabSize() { return this.facet(EditorState.tabSize); }\n    /**\n    Get the proper [line-break](https://codemirror.net/6/docs/ref/#state.EditorState^lineSeparator)\n    string for this state.\n    */\n    get lineBreak() { return this.facet(EditorState.lineSeparator) || \"\\n\"; }\n    /**\n    Returns true when the editor is\n    [configured](https://codemirror.net/6/docs/ref/#state.EditorState^readOnly) to be read-only.\n    */\n    get readOnly() { return this.facet(readOnly); }\n    /**\n    Look up a translation for the given phrase (via the\n    [`phrases`](https://codemirror.net/6/docs/ref/#state.EditorState^phrases) facet), or return the\n    original string if no translation is found.\n    \n    If additional arguments are passed, they will be inserted in\n    place of markers like `$1` (for the first value) and `$2`, etc.\n    A single `$` is equivalent to `$1`, and `$$` will produce a\n    literal dollar sign.\n    */\n    phrase(phrase, ...insert) {\n        for (let map of this.facet(EditorState.phrases))\n            if (Object.prototype.hasOwnProperty.call(map, phrase)) {\n                phrase = map[phrase];\n                break;\n            }\n        if (insert.length)\n            phrase = phrase.replace(/\\$(\\$|\\d*)/g, (m, i) => {\n                if (i == \"$\")\n                    return \"$\";\n                let n = +(i || 1);\n                return !n || n > insert.length ? m : insert[n - 1];\n            });\n        return phrase;\n    }\n    /**\n    Find the values for a given language data field, provided by the\n    the [`languageData`](https://codemirror.net/6/docs/ref/#state.EditorState^languageData) facet.\n    \n    Examples of language data fields are...\n    \n    - [`\"commentTokens\"`](https://codemirror.net/6/docs/ref/#commands.CommentTokens) for specifying\n      comment syntax.\n    - [`\"autocomplete\"`](https://codemirror.net/6/docs/ref/#autocomplete.autocompletion^config.override)\n      for providing language-specific completion sources.\n    - [`\"wordChars\"`](https://codemirror.net/6/docs/ref/#state.EditorState.charCategorizer) for adding\n      characters that should be considered part of words in this\n      language.\n    - [`\"closeBrackets\"`](https://codemirror.net/6/docs/ref/#autocomplete.CloseBracketConfig) controls\n      bracket closing behavior.\n    */\n    languageDataAt(name, pos, side = -1) {\n        let values = [];\n        for (let provider of this.facet(languageData)) {\n            for (let result of provider(this, pos, side)) {\n                if (Object.prototype.hasOwnProperty.call(result, name))\n                    values.push(result[name]);\n            }\n        }\n        return values;\n    }\n    /**\n    Return a function that can categorize strings (expected to\n    represent a single [grapheme cluster](https://codemirror.net/6/docs/ref/#state.findClusterBreak))\n    into one of:\n    \n     - Word (contains an alphanumeric character or a character\n       explicitly listed in the local language's `\"wordChars\"`\n       language data, which should be a string)\n     - Space (contains only whitespace)\n     - Other (anything else)\n    */\n    charCategorizer(at) {\n        return makeCategorizer(this.languageDataAt(\"wordChars\", at).join(\"\"));\n    }\n    /**\n    Find the word at the given position, meaning the range\n    containing all [word](https://codemirror.net/6/docs/ref/#state.CharCategory.Word) characters\n    around it. If no word characters are adjacent to the position,\n    this returns null.\n    */\n    wordAt(pos) {\n        let { text, from, length } = this.doc.lineAt(pos);\n        let cat = this.charCategorizer(pos);\n        let start = pos - from, end = pos - from;\n        while (start > 0) {\n            let prev = findClusterBreak(text, start, false);\n            if (cat(text.slice(prev, start)) != CharCategory.Word)\n                break;\n            start = prev;\n        }\n        while (end < length) {\n            let next = findClusterBreak(text, end);\n            if (cat(text.slice(end, next)) != CharCategory.Word)\n                break;\n            end = next;\n        }\n        return start == end ? null : EditorSelection.range(start + from, end + from);\n    }\n}\n/**\nA facet that, when enabled, causes the editor to allow multiple\nranges to be selected. Be careful though, because by default the\neditor relies on the native DOM selection, which cannot handle\nmultiple selections. An extension like\n[`drawSelection`](https://codemirror.net/6/docs/ref/#view.drawSelection) can be used to make\nsecondary selections visible to the user.\n*/\nEditorState.allowMultipleSelections = allowMultipleSelections;\n/**\nConfigures the tab size to use in this state. The first\n(highest-precedence) value of the facet is used. If no value is\ngiven, this defaults to 4.\n*/\nEditorState.tabSize = /*@__PURE__*/Facet.define({\n    combine: values => values.length ? values[0] : 4\n});\n/**\nThe line separator to use. By default, any of `\"\\n\"`, `\"\\r\\n\"`\nand `\"\\r\"` is treated as a separator when splitting lines, and\nlines are joined with `\"\\n\"`.\n\nWhen you configure a value here, only that precise separator\nwill be used, allowing you to round-trip documents through the\neditor without normalizing line separators.\n*/\nEditorState.lineSeparator = lineSeparator;\n/**\nThis facet controls the value of the\n[`readOnly`](https://codemirror.net/6/docs/ref/#state.EditorState.readOnly) getter, which is\nconsulted by commands and extensions that implement editing\nfunctionality to determine whether they should apply. It\ndefaults to false, but when its highest-precedence value is\n`true`, such functionality disables itself.\n\nNot to be confused with\n[`EditorView.editable`](https://codemirror.net/6/docs/ref/#view.EditorView^editable), which\ncontrols whether the editor's DOM is set to be editable (and\nthus focusable).\n*/\nEditorState.readOnly = readOnly;\n/**\nRegisters translation phrases. The\n[`phrase`](https://codemirror.net/6/docs/ref/#state.EditorState.phrase) method will look through\nall objects registered with this facet to find translations for\nits argument.\n*/\nEditorState.phrases = /*@__PURE__*/Facet.define({\n    compare(a, b) {\n        let kA = Object.keys(a), kB = Object.keys(b);\n        return kA.length == kB.length && kA.every(k => a[k] == b[k]);\n    }\n});\n/**\nA facet used to register [language\ndata](https://codemirror.net/6/docs/ref/#state.EditorState.languageDataAt) providers.\n*/\nEditorState.languageData = languageData;\n/**\nFacet used to register change filters, which are called for each\ntransaction (unless explicitly\n[disabled](https://codemirror.net/6/docs/ref/#state.TransactionSpec.filter)), and can suppress\npart of the transaction's changes.\n\nSuch a function can return `true` to indicate that it doesn't\nwant to do anything, `false` to completely stop the changes in\nthe transaction, or a set of ranges in which changes should be\nsuppressed. Such ranges are represented as an array of numbers,\nwith each pair of two numbers indicating the start and end of a\nrange. So for example `[10, 20, 100, 110]` suppresses changes\nbetween 10 and 20, and between 100 and 110.\n*/\nEditorState.changeFilter = changeFilter;\n/**\nFacet used to register a hook that gets a chance to update or\nreplace transaction specs before they are applied. This will\nonly be applied for transactions that don't have\n[`filter`](https://codemirror.net/6/docs/ref/#state.TransactionSpec.filter) set to `false`. You\ncan either return a single transaction spec (possibly the input\ntransaction), or an array of specs (which will be combined in\nthe same way as the arguments to\n[`EditorState.update`](https://codemirror.net/6/docs/ref/#state.EditorState.update)).\n\nWhen possible, it is recommended to avoid accessing\n[`Transaction.state`](https://codemirror.net/6/docs/ref/#state.Transaction.state) in a filter,\nsince it will force creation of a state that will then be\ndiscarded again, if the transaction is actually filtered.\n\n(This functionality should be used with care. Indiscriminately\nmodifying transaction is likely to break something or degrade\nthe user experience.)\n*/\nEditorState.transactionFilter = transactionFilter;\n/**\nThis is a more limited form of\n[`transactionFilter`](https://codemirror.net/6/docs/ref/#state.EditorState^transactionFilter),\nwhich can only add\n[annotations](https://codemirror.net/6/docs/ref/#state.TransactionSpec.annotations) and\n[effects](https://codemirror.net/6/docs/ref/#state.TransactionSpec.effects). _But_, this type\nof filter runs even if the transaction has disabled regular\n[filtering](https://codemirror.net/6/docs/ref/#state.TransactionSpec.filter), making it suitable\nfor effects that don't need to touch the changes or selection,\nbut do want to process every transaction.\n\nExtenders run _after_ filters, when both are present.\n*/\nEditorState.transactionExtender = transactionExtender;\nCompartment.reconfigure = /*@__PURE__*/StateEffect.define();\n\n/**\nUtility function for combining behaviors to fill in a config\nobject from an array of provided configs. `defaults` should hold\ndefault values for all optional fields in `Config`.\n\nThe function will, by default, error\nwhen a field gets two values that aren't `===`-equal, but you can\nprovide combine functions per field to do something else.\n*/\nfunction combineConfig(configs, defaults, // Should hold only the optional properties of Config, but I haven't managed to express that\ncombine = {}) {\n    let result = {};\n    for (let config of configs)\n        for (let key of Object.keys(config)) {\n            let value = config[key], current = result[key];\n            if (current === undefined)\n                result[key] = value;\n            else if (current === value || value === undefined) ; // No conflict\n            else if (Object.hasOwnProperty.call(combine, key))\n                result[key] = combine[key](current, value);\n            else\n                throw new Error(\"Config merge conflict for field \" + key);\n        }\n    for (let key in defaults)\n        if (result[key] === undefined)\n            result[key] = defaults[key];\n    return result;\n}\n\n/**\nEach range is associated with a value, which must inherit from\nthis class.\n*/\nclass RangeValue {\n    /**\n    Compare this value with another value. Used when comparing\n    rangesets. The default implementation compares by identity.\n    Unless you are only creating a fixed number of unique instances\n    of your value type, it is a good idea to implement this\n    properly.\n    */\n    eq(other) { return this == other; }\n    /**\n    Create a [range](https://codemirror.net/6/docs/ref/#state.Range) with this value.\n    */\n    range(from, to = from) { return Range.create(from, to, this); }\n}\nRangeValue.prototype.startSide = RangeValue.prototype.endSide = 0;\nRangeValue.prototype.point = false;\nRangeValue.prototype.mapMode = MapMode.TrackDel;\n/**\nA range associates a value with a range of positions.\n*/\nclass Range {\n    constructor(\n    /**\n    The range's start position.\n    */\n    from, \n    /**\n    Its end position.\n    */\n    to, \n    /**\n    The value associated with this range.\n    */\n    value) {\n        this.from = from;\n        this.to = to;\n        this.value = value;\n    }\n    /**\n    @internal\n    */\n    static create(from, to, value) {\n        return new Range(from, to, value);\n    }\n}\nfunction cmpRange(a, b) {\n    return a.from - b.from || a.value.startSide - b.value.startSide;\n}\nclass Chunk {\n    constructor(from, to, value, \n    // Chunks are marked with the largest point that occurs\n    // in them (or -1 for no points), so that scans that are\n    // only interested in points (such as the\n    // heightmap-related logic) can skip range-only chunks.\n    maxPoint) {\n        this.from = from;\n        this.to = to;\n        this.value = value;\n        this.maxPoint = maxPoint;\n    }\n    get length() { return this.to[this.to.length - 1]; }\n    // Find the index of the given position and side. Use the ranges'\n    // `from` pos when `end == false`, `to` when `end == true`.\n    findIndex(pos, side, end, startAt = 0) {\n        let arr = end ? this.to : this.from;\n        for (let lo = startAt, hi = arr.length;;) {\n            if (lo == hi)\n                return lo;\n            let mid = (lo + hi) >> 1;\n            let diff = arr[mid] - pos || (end ? this.value[mid].endSide : this.value[mid].startSide) - side;\n            if (mid == lo)\n                return diff >= 0 ? lo : hi;\n            if (diff >= 0)\n                hi = mid;\n            else\n                lo = mid + 1;\n        }\n    }\n    between(offset, from, to, f) {\n        for (let i = this.findIndex(from, -1000000000 /* C.Far */, true), e = this.findIndex(to, 1000000000 /* C.Far */, false, i); i < e; i++)\n            if (f(this.from[i] + offset, this.to[i] + offset, this.value[i]) === false)\n                return false;\n    }\n    map(offset, changes) {\n        let value = [], from = [], to = [], newPos = -1, maxPoint = -1;\n        for (let i = 0; i < this.value.length; i++) {\n            let val = this.value[i], curFrom = this.from[i] + offset, curTo = this.to[i] + offset, newFrom, newTo;\n            if (curFrom == curTo) {\n                let mapped = changes.mapPos(curFrom, val.startSide, val.mapMode);\n                if (mapped == null)\n                    continue;\n                newFrom = newTo = mapped;\n                if (val.startSide != val.endSide) {\n                    newTo = changes.mapPos(curFrom, val.endSide);\n                    if (newTo < newFrom)\n                        continue;\n                }\n            }\n            else {\n                newFrom = changes.mapPos(curFrom, val.startSide);\n                newTo = changes.mapPos(curTo, val.endSide);\n                if (newFrom > newTo || newFrom == newTo && val.startSide > 0 && val.endSide <= 0)\n                    continue;\n            }\n            if ((newTo - newFrom || val.endSide - val.startSide) < 0)\n                continue;\n            if (newPos < 0)\n                newPos = newFrom;\n            if (val.point)\n                maxPoint = Math.max(maxPoint, newTo - newFrom);\n            value.push(val);\n            from.push(newFrom - newPos);\n            to.push(newTo - newPos);\n        }\n        return { mapped: value.length ? new Chunk(from, to, value, maxPoint) : null, pos: newPos };\n    }\n}\n/**\nA range set stores a collection of [ranges](https://codemirror.net/6/docs/ref/#state.Range) in a\nway that makes them efficient to [map](https://codemirror.net/6/docs/ref/#state.RangeSet.map) and\n[update](https://codemirror.net/6/docs/ref/#state.RangeSet.update). This is an immutable data\nstructure.\n*/\nclass RangeSet {\n    constructor(\n    /**\n    @internal\n    */\n    chunkPos, \n    /**\n    @internal\n    */\n    chunk, \n    /**\n    @internal\n    */\n    nextLayer, \n    /**\n    @internal\n    */\n    maxPoint) {\n        this.chunkPos = chunkPos;\n        this.chunk = chunk;\n        this.nextLayer = nextLayer;\n        this.maxPoint = maxPoint;\n    }\n    /**\n    @internal\n    */\n    static create(chunkPos, chunk, nextLayer, maxPoint) {\n        return new RangeSet(chunkPos, chunk, nextLayer, maxPoint);\n    }\n    /**\n    @internal\n    */\n    get length() {\n        let last = this.chunk.length - 1;\n        return last < 0 ? 0 : Math.max(this.chunkEnd(last), this.nextLayer.length);\n    }\n    /**\n    The number of ranges in the set.\n    */\n    get size() {\n        if (this.isEmpty)\n            return 0;\n        let size = this.nextLayer.size;\n        for (let chunk of this.chunk)\n            size += chunk.value.length;\n        return size;\n    }\n    /**\n    @internal\n    */\n    chunkEnd(index) {\n        return this.chunkPos[index] + this.chunk[index].length;\n    }\n    /**\n    Update the range set, optionally adding new ranges or filtering\n    out existing ones.\n    \n    (Note: The type parameter is just there as a kludge to work\n    around TypeScript variance issues that prevented `RangeSet<X>`\n    from being a subtype of `RangeSet<Y>` when `X` is a subtype of\n    `Y`.)\n    */\n    update(updateSpec) {\n        let { add = [], sort = false, filterFrom = 0, filterTo = this.length } = updateSpec;\n        let filter = updateSpec.filter;\n        if (add.length == 0 && !filter)\n            return this;\n        if (sort)\n            add = add.slice().sort(cmpRange);\n        if (this.isEmpty)\n            return add.length ? RangeSet.of(add) : this;\n        let cur = new LayerCursor(this, null, -1).goto(0), i = 0, spill = [];\n        let builder = new RangeSetBuilder();\n        while (cur.value || i < add.length) {\n            if (i < add.length && (cur.from - add[i].from || cur.startSide - add[i].value.startSide) >= 0) {\n                let range = add[i++];\n                if (!builder.addInner(range.from, range.to, range.value))\n                    spill.push(range);\n            }\n            else if (cur.rangeIndex == 1 && cur.chunkIndex < this.chunk.length &&\n                (i == add.length || this.chunkEnd(cur.chunkIndex) < add[i].from) &&\n                (!filter || filterFrom > this.chunkEnd(cur.chunkIndex) || filterTo < this.chunkPos[cur.chunkIndex]) &&\n                builder.addChunk(this.chunkPos[cur.chunkIndex], this.chunk[cur.chunkIndex])) {\n                cur.nextChunk();\n            }\n            else {\n                if (!filter || filterFrom > cur.to || filterTo < cur.from || filter(cur.from, cur.to, cur.value)) {\n                    if (!builder.addInner(cur.from, cur.to, cur.value))\n                        spill.push(Range.create(cur.from, cur.to, cur.value));\n                }\n                cur.next();\n            }\n        }\n        return builder.finishInner(this.nextLayer.isEmpty && !spill.length ? RangeSet.empty\n            : this.nextLayer.update({ add: spill, filter, filterFrom, filterTo }));\n    }\n    /**\n    Map this range set through a set of changes, return the new set.\n    */\n    map(changes) {\n        if (changes.empty || this.isEmpty)\n            return this;\n        let chunks = [], chunkPos = [], maxPoint = -1;\n        for (let i = 0; i < this.chunk.length; i++) {\n            let start = this.chunkPos[i], chunk = this.chunk[i];\n            let touch = changes.touchesRange(start, start + chunk.length);\n            if (touch === false) {\n                maxPoint = Math.max(maxPoint, chunk.maxPoint);\n                chunks.push(chunk);\n                chunkPos.push(changes.mapPos(start));\n            }\n            else if (touch === true) {\n                let { mapped, pos } = chunk.map(start, changes);\n                if (mapped) {\n                    maxPoint = Math.max(maxPoint, mapped.maxPoint);\n                    chunks.push(mapped);\n                    chunkPos.push(pos);\n                }\n            }\n        }\n        let next = this.nextLayer.map(changes);\n        return chunks.length == 0 ? next : new RangeSet(chunkPos, chunks, next || RangeSet.empty, maxPoint);\n    }\n    /**\n    Iterate over the ranges that touch the region `from` to `to`,\n    calling `f` for each. There is no guarantee that the ranges will\n    be reported in any specific order. When the callback returns\n    `false`, iteration stops.\n    */\n    between(from, to, f) {\n        if (this.isEmpty)\n            return;\n        for (let i = 0; i < this.chunk.length; i++) {\n            let start = this.chunkPos[i], chunk = this.chunk[i];\n            if (to >= start && from <= start + chunk.length &&\n                chunk.between(start, from - start, to - start, f) === false)\n                return;\n        }\n        this.nextLayer.between(from, to, f);\n    }\n    /**\n    Iterate over the ranges in this set, in order, including all\n    ranges that end at or after `from`.\n    */\n    iter(from = 0) {\n        return HeapCursor.from([this]).goto(from);\n    }\n    /**\n    @internal\n    */\n    get isEmpty() { return this.nextLayer == this; }\n    /**\n    Iterate over the ranges in a collection of sets, in order,\n    starting from `from`.\n    */\n    static iter(sets, from = 0) {\n        return HeapCursor.from(sets).goto(from);\n    }\n    /**\n    Iterate over two groups of sets, calling methods on `comparator`\n    to notify it of possible differences.\n    */\n    static compare(oldSets, newSets, \n    /**\n    This indicates how the underlying data changed between these\n    ranges, and is needed to synchronize the iteration. `from` and\n    `to` are coordinates in the _new_ space, after these changes.\n    */\n    textDiff, comparator, \n    /**\n    Can be used to ignore all non-point ranges, and points below\n    the given size. When -1, all ranges are compared.\n    */\n    minPointSize = -1) {\n        let a = oldSets.filter(set => set.maxPoint > 0 || !set.isEmpty && set.maxPoint >= minPointSize);\n        let b = newSets.filter(set => set.maxPoint > 0 || !set.isEmpty && set.maxPoint >= minPointSize);\n        let sharedChunks = findSharedChunks(a, b, textDiff);\n        let sideA = new SpanCursor(a, sharedChunks, minPointSize);\n        let sideB = new SpanCursor(b, sharedChunks, minPointSize);\n        textDiff.iterGaps((fromA, fromB, length) => compare(sideA, fromA, sideB, fromB, length, comparator));\n        if (textDiff.empty && textDiff.length == 0)\n            compare(sideA, 0, sideB, 0, 0, comparator);\n    }\n    /**\n    Compare the contents of two groups of range sets, returning true\n    if they are equivalent in the given range.\n    */\n    static eq(oldSets, newSets, from = 0, to) {\n        if (to == null)\n            to = 1000000000 /* C.Far */ - 1;\n        let a = oldSets.filter(set => !set.isEmpty && newSets.indexOf(set) < 0);\n        let b = newSets.filter(set => !set.isEmpty && oldSets.indexOf(set) < 0);\n        if (a.length != b.length)\n            return false;\n        if (!a.length)\n            return true;\n        let sharedChunks = findSharedChunks(a, b);\n        let sideA = new SpanCursor(a, sharedChunks, 0).goto(from), sideB = new SpanCursor(b, sharedChunks, 0).goto(from);\n        for (;;) {\n            if (sideA.to != sideB.to ||\n                !sameValues(sideA.active, sideB.active) ||\n                sideA.point && (!sideB.point || !sideA.point.eq(sideB.point)))\n                return false;\n            if (sideA.to > to)\n                return true;\n            sideA.next();\n            sideB.next();\n        }\n    }\n    /**\n    Iterate over a group of range sets at the same time, notifying\n    the iterator about the ranges covering every given piece of\n    content. Returns the open count (see\n    [`SpanIterator.span`](https://codemirror.net/6/docs/ref/#state.SpanIterator.span)) at the end\n    of the iteration.\n    */\n    static spans(sets, from, to, iterator, \n    /**\n    When given and greater than -1, only points of at least this\n    size are taken into account.\n    */\n    minPointSize = -1) {\n        let cursor = new SpanCursor(sets, null, minPointSize).goto(from), pos = from;\n        let openRanges = cursor.openStart;\n        for (;;) {\n            let curTo = Math.min(cursor.to, to);\n            if (cursor.point) {\n                let active = cursor.activeForPoint(cursor.to);\n                let openCount = cursor.pointFrom < from ? active.length + 1 : Math.min(active.length, openRanges);\n                iterator.point(pos, curTo, cursor.point, active, openCount, cursor.pointRank);\n                openRanges = Math.min(cursor.openEnd(curTo), active.length);\n            }\n            else if (curTo > pos) {\n                iterator.span(pos, curTo, cursor.active, openRanges);\n                openRanges = cursor.openEnd(curTo);\n            }\n            if (cursor.to > to)\n                return openRanges + (cursor.point && cursor.to > to ? 1 : 0);\n            pos = cursor.to;\n            cursor.next();\n        }\n    }\n    /**\n    Create a range set for the given range or array of ranges. By\n    default, this expects the ranges to be _sorted_ (by start\n    position and, if two start at the same position,\n    `value.startSide`). You can pass `true` as second argument to\n    cause the method to sort them.\n    */\n    static of(ranges, sort = false) {\n        let build = new RangeSetBuilder();\n        for (let range of ranges instanceof Range ? [ranges] : sort ? lazySort(ranges) : ranges)\n            build.add(range.from, range.to, range.value);\n        return build.finish();\n    }\n}\n/**\nThe empty set of ranges.\n*/\nRangeSet.empty = /*@__PURE__*/new RangeSet([], [], null, -1);\nfunction lazySort(ranges) {\n    if (ranges.length > 1)\n        for (let prev = ranges[0], i = 1; i < ranges.length; i++) {\n            let cur = ranges[i];\n            if (cmpRange(prev, cur) > 0)\n                return ranges.slice().sort(cmpRange);\n            prev = cur;\n        }\n    return ranges;\n}\nRangeSet.empty.nextLayer = RangeSet.empty;\n/**\nA range set builder is a data structure that helps build up a\n[range set](https://codemirror.net/6/docs/ref/#state.RangeSet) directly, without first allocating\nan array of [`Range`](https://codemirror.net/6/docs/ref/#state.Range) objects.\n*/\nclass RangeSetBuilder {\n    /**\n    Create an empty builder.\n    */\n    constructor() {\n        this.chunks = [];\n        this.chunkPos = [];\n        this.chunkStart = -1;\n        this.last = null;\n        this.lastFrom = -1000000000 /* C.Far */;\n        this.lastTo = -1000000000 /* C.Far */;\n        this.from = [];\n        this.to = [];\n        this.value = [];\n        this.maxPoint = -1;\n        this.setMaxPoint = -1;\n        this.nextLayer = null;\n    }\n    finishChunk(newArrays) {\n        this.chunks.push(new Chunk(this.from, this.to, this.value, this.maxPoint));\n        this.chunkPos.push(this.chunkStart);\n        this.chunkStart = -1;\n        this.setMaxPoint = Math.max(this.setMaxPoint, this.maxPoint);\n        this.maxPoint = -1;\n        if (newArrays) {\n            this.from = [];\n            this.to = [];\n            this.value = [];\n        }\n    }\n    /**\n    Add a range. Ranges should be added in sorted (by `from` and\n    `value.startSide`) order.\n    */\n    add(from, to, value) {\n        if (!this.addInner(from, to, value))\n            (this.nextLayer || (this.nextLayer = new RangeSetBuilder)).add(from, to, value);\n    }\n    /**\n    @internal\n    */\n    addInner(from, to, value) {\n        let diff = from - this.lastTo || value.startSide - this.last.endSide;\n        if (diff <= 0 && (from - this.lastFrom || value.startSide - this.last.startSide) < 0)\n            throw new Error(\"Ranges must be added sorted by `from` position and `startSide`\");\n        if (diff < 0)\n            return false;\n        if (this.from.length == 250 /* C.ChunkSize */)\n            this.finishChunk(true);\n        if (this.chunkStart < 0)\n            this.chunkStart = from;\n        this.from.push(from - this.chunkStart);\n        this.to.push(to - this.chunkStart);\n        this.last = value;\n        this.lastFrom = from;\n        this.lastTo = to;\n        this.value.push(value);\n        if (value.point)\n            this.maxPoint = Math.max(this.maxPoint, to - from);\n        return true;\n    }\n    /**\n    @internal\n    */\n    addChunk(from, chunk) {\n        if ((from - this.lastTo || chunk.value[0].startSide - this.last.endSide) < 0)\n            return false;\n        if (this.from.length)\n            this.finishChunk(true);\n        this.setMaxPoint = Math.max(this.setMaxPoint, chunk.maxPoint);\n        this.chunks.push(chunk);\n        this.chunkPos.push(from);\n        let last = chunk.value.length - 1;\n        this.last = chunk.value[last];\n        this.lastFrom = chunk.from[last] + from;\n        this.lastTo = chunk.to[last] + from;\n        return true;\n    }\n    /**\n    Finish the range set. Returns the new set. The builder can't be\n    used anymore after this has been called.\n    */\n    finish() { return this.finishInner(RangeSet.empty); }\n    /**\n    @internal\n    */\n    finishInner(next) {\n        if (this.from.length)\n            this.finishChunk(false);\n        if (this.chunks.length == 0)\n            return next;\n        let result = RangeSet.create(this.chunkPos, this.chunks, this.nextLayer ? this.nextLayer.finishInner(next) : next, this.setMaxPoint);\n        this.from = null; // Make sure further `add` calls produce errors\n        return result;\n    }\n}\nfunction findSharedChunks(a, b, textDiff) {\n    let inA = new Map();\n    for (let set of a)\n        for (let i = 0; i < set.chunk.length; i++)\n            if (set.chunk[i].maxPoint <= 0)\n                inA.set(set.chunk[i], set.chunkPos[i]);\n    let shared = new Set();\n    for (let set of b)\n        for (let i = 0; i < set.chunk.length; i++) {\n            let known = inA.get(set.chunk[i]);\n            if (known != null && (textDiff ? textDiff.mapPos(known) : known) == set.chunkPos[i] &&\n                !(textDiff === null || textDiff === void 0 ? void 0 : textDiff.touchesRange(known, known + set.chunk[i].length)))\n                shared.add(set.chunk[i]);\n        }\n    return shared;\n}\nclass LayerCursor {\n    constructor(layer, skip, minPoint, rank = 0) {\n        this.layer = layer;\n        this.skip = skip;\n        this.minPoint = minPoint;\n        this.rank = rank;\n    }\n    get startSide() { return this.value ? this.value.startSide : 0; }\n    get endSide() { return this.value ? this.value.endSide : 0; }\n    goto(pos, side = -1000000000 /* C.Far */) {\n        this.chunkIndex = this.rangeIndex = 0;\n        this.gotoInner(pos, side, false);\n        return this;\n    }\n    gotoInner(pos, side, forward) {\n        while (this.chunkIndex < this.layer.chunk.length) {\n            let next = this.layer.chunk[this.chunkIndex];\n            if (!(this.skip && this.skip.has(next) ||\n                this.layer.chunkEnd(this.chunkIndex) < pos ||\n                next.maxPoint < this.minPoint))\n                break;\n            this.chunkIndex++;\n            forward = false;\n        }\n        if (this.chunkIndex < this.layer.chunk.length) {\n            let rangeIndex = this.layer.chunk[this.chunkIndex].findIndex(pos - this.layer.chunkPos[this.chunkIndex], side, true);\n            if (!forward || this.rangeIndex < rangeIndex)\n                this.setRangeIndex(rangeIndex);\n        }\n        this.next();\n    }\n    forward(pos, side) {\n        if ((this.to - pos || this.endSide - side) < 0)\n            this.gotoInner(pos, side, true);\n    }\n    next() {\n        for (;;) {\n            if (this.chunkIndex == this.layer.chunk.length) {\n                this.from = this.to = 1000000000 /* C.Far */;\n                this.value = null;\n                break;\n            }\n            else {\n                let chunkPos = this.layer.chunkPos[this.chunkIndex], chunk = this.layer.chunk[this.chunkIndex];\n                let from = chunkPos + chunk.from[this.rangeIndex];\n                this.from = from;\n                this.to = chunkPos + chunk.to[this.rangeIndex];\n                this.value = chunk.value[this.rangeIndex];\n                this.setRangeIndex(this.rangeIndex + 1);\n                if (this.minPoint < 0 || this.value.point && this.to - this.from >= this.minPoint)\n                    break;\n            }\n        }\n    }\n    setRangeIndex(index) {\n        if (index == this.layer.chunk[this.chunkIndex].value.length) {\n            this.chunkIndex++;\n            if (this.skip) {\n                while (this.chunkIndex < this.layer.chunk.length && this.skip.has(this.layer.chunk[this.chunkIndex]))\n                    this.chunkIndex++;\n            }\n            this.rangeIndex = 0;\n        }\n        else {\n            this.rangeIndex = index;\n        }\n    }\n    nextChunk() {\n        this.chunkIndex++;\n        this.rangeIndex = 0;\n        this.next();\n    }\n    compare(other) {\n        return this.from - other.from || this.startSide - other.startSide || this.rank - other.rank ||\n            this.to - other.to || this.endSide - other.endSide;\n    }\n}\nclass HeapCursor {\n    constructor(heap) {\n        this.heap = heap;\n    }\n    static from(sets, skip = null, minPoint = -1) {\n        let heap = [];\n        for (let i = 0; i < sets.length; i++) {\n            for (let cur = sets[i]; !cur.isEmpty; cur = cur.nextLayer) {\n                if (cur.maxPoint >= minPoint)\n                    heap.push(new LayerCursor(cur, skip, minPoint, i));\n            }\n        }\n        return heap.length == 1 ? heap[0] : new HeapCursor(heap);\n    }\n    get startSide() { return this.value ? this.value.startSide : 0; }\n    goto(pos, side = -1000000000 /* C.Far */) {\n        for (let cur of this.heap)\n            cur.goto(pos, side);\n        for (let i = this.heap.length >> 1; i >= 0; i--)\n            heapBubble(this.heap, i);\n        this.next();\n        return this;\n    }\n    forward(pos, side) {\n        for (let cur of this.heap)\n            cur.forward(pos, side);\n        for (let i = this.heap.length >> 1; i >= 0; i--)\n            heapBubble(this.heap, i);\n        if ((this.to - pos || this.value.endSide - side) < 0)\n            this.next();\n    }\n    next() {\n        if (this.heap.length == 0) {\n            this.from = this.to = 1000000000 /* C.Far */;\n            this.value = null;\n            this.rank = -1;\n        }\n        else {\n            let top = this.heap[0];\n            this.from = top.from;\n            this.to = top.to;\n            this.value = top.value;\n            this.rank = top.rank;\n            if (top.value)\n                top.next();\n            heapBubble(this.heap, 0);\n        }\n    }\n}\nfunction heapBubble(heap, index) {\n    for (let cur = heap[index];;) {\n        let childIndex = (index << 1) + 1;\n        if (childIndex >= heap.length)\n            break;\n        let child = heap[childIndex];\n        if (childIndex + 1 < heap.length && child.compare(heap[childIndex + 1]) >= 0) {\n            child = heap[childIndex + 1];\n            childIndex++;\n        }\n        if (cur.compare(child) < 0)\n            break;\n        heap[childIndex] = cur;\n        heap[index] = child;\n        index = childIndex;\n    }\n}\nclass SpanCursor {\n    constructor(sets, skip, minPoint) {\n        this.minPoint = minPoint;\n        this.active = [];\n        this.activeTo = [];\n        this.activeRank = [];\n        this.minActive = -1;\n        // A currently active point range, if any\n        this.point = null;\n        this.pointFrom = 0;\n        this.pointRank = 0;\n        this.to = -1000000000 /* C.Far */;\n        this.endSide = 0;\n        // The amount of open active ranges at the start of the iterator.\n        // Not including points.\n        this.openStart = -1;\n        this.cursor = HeapCursor.from(sets, skip, minPoint);\n    }\n    goto(pos, side = -1000000000 /* C.Far */) {\n        this.cursor.goto(pos, side);\n        this.active.length = this.activeTo.length = this.activeRank.length = 0;\n        this.minActive = -1;\n        this.to = pos;\n        this.endSide = side;\n        this.openStart = -1;\n        this.next();\n        return this;\n    }\n    forward(pos, side) {\n        while (this.minActive > -1 && (this.activeTo[this.minActive] - pos || this.active[this.minActive].endSide - side) < 0)\n            this.removeActive(this.minActive);\n        this.cursor.forward(pos, side);\n    }\n    removeActive(index) {\n        remove(this.active, index);\n        remove(this.activeTo, index);\n        remove(this.activeRank, index);\n        this.minActive = findMinIndex(this.active, this.activeTo);\n    }\n    addActive(trackOpen) {\n        let i = 0, { value, to, rank } = this.cursor;\n        while (i < this.activeRank.length && this.activeRank[i] <= rank)\n            i++;\n        insert(this.active, i, value);\n        insert(this.activeTo, i, to);\n        insert(this.activeRank, i, rank);\n        if (trackOpen)\n            insert(trackOpen, i, this.cursor.from);\n        this.minActive = findMinIndex(this.active, this.activeTo);\n    }\n    // After calling this, if `this.point` != null, the next range is a\n    // point. Otherwise, it's a regular range, covered by `this.active`.\n    next() {\n        let from = this.to, wasPoint = this.point;\n        this.point = null;\n        let trackOpen = this.openStart < 0 ? [] : null;\n        for (;;) {\n            let a = this.minActive;\n            if (a > -1 && (this.activeTo[a] - this.cursor.from || this.active[a].endSide - this.cursor.startSide) < 0) {\n                if (this.activeTo[a] > from) {\n                    this.to = this.activeTo[a];\n                    this.endSide = this.active[a].endSide;\n                    break;\n                }\n                this.removeActive(a);\n                if (trackOpen)\n                    remove(trackOpen, a);\n            }\n            else if (!this.cursor.value) {\n                this.to = this.endSide = 1000000000 /* C.Far */;\n                break;\n            }\n            else if (this.cursor.from > from) {\n                this.to = this.cursor.from;\n                this.endSide = this.cursor.startSide;\n                break;\n            }\n            else {\n                let nextVal = this.cursor.value;\n                if (!nextVal.point) { // Opening a range\n                    this.addActive(trackOpen);\n                    this.cursor.next();\n                }\n                else if (wasPoint && this.cursor.to == this.to && this.cursor.from < this.cursor.to) {\n                    // Ignore any non-empty points that end precisely at the end of the prev point\n                    this.cursor.next();\n                }\n                else { // New point\n                    this.point = nextVal;\n                    this.pointFrom = this.cursor.from;\n                    this.pointRank = this.cursor.rank;\n                    this.to = this.cursor.to;\n                    this.endSide = nextVal.endSide;\n                    this.cursor.next();\n                    this.forward(this.to, this.endSide);\n                    break;\n                }\n            }\n        }\n        if (trackOpen) {\n            this.openStart = 0;\n            for (let i = trackOpen.length - 1; i >= 0 && trackOpen[i] < from; i--)\n                this.openStart++;\n        }\n    }\n    activeForPoint(to) {\n        if (!this.active.length)\n            return this.active;\n        let active = [];\n        for (let i = this.active.length - 1; i >= 0; i--) {\n            if (this.activeRank[i] < this.pointRank)\n                break;\n            if (this.activeTo[i] > to || this.activeTo[i] == to && this.active[i].endSide >= this.point.endSide)\n                active.push(this.active[i]);\n        }\n        return active.reverse();\n    }\n    openEnd(to) {\n        let open = 0;\n        for (let i = this.activeTo.length - 1; i >= 0 && this.activeTo[i] > to; i--)\n            open++;\n        return open;\n    }\n}\nfunction compare(a, startA, b, startB, length, comparator) {\n    a.goto(startA);\n    b.goto(startB);\n    let endB = startB + length;\n    let pos = startB, dPos = startB - startA;\n    for (;;) {\n        let diff = (a.to + dPos) - b.to || a.endSide - b.endSide;\n        let end = diff < 0 ? a.to + dPos : b.to, clipEnd = Math.min(end, endB);\n        if (a.point || b.point) {\n            if (!(a.point && b.point && (a.point == b.point || a.point.eq(b.point)) &&\n                sameValues(a.activeForPoint(a.to + dPos), b.activeForPoint(b.to))))\n                comparator.comparePoint(pos, clipEnd, a.point, b.point);\n        }\n        else {\n            if (clipEnd > pos && !sameValues(a.active, b.active))\n                comparator.compareRange(pos, clipEnd, a.active, b.active);\n        }\n        if (end > endB)\n            break;\n        pos = end;\n        if (diff <= 0)\n            a.next();\n        if (diff >= 0)\n            b.next();\n    }\n}\nfunction sameValues(a, b) {\n    if (a.length != b.length)\n        return false;\n    for (let i = 0; i < a.length; i++)\n        if (a[i] != b[i] && !a[i].eq(b[i]))\n            return false;\n    return true;\n}\nfunction remove(array, index) {\n    for (let i = index, e = array.length - 1; i < e; i++)\n        array[i] = array[i + 1];\n    array.pop();\n}\nfunction insert(array, index, value) {\n    for (let i = array.length - 1; i >= index; i--)\n        array[i + 1] = array[i];\n    array[index] = value;\n}\nfunction findMinIndex(value, array) {\n    let found = -1, foundPos = 1000000000 /* C.Far */;\n    for (let i = 0; i < array.length; i++)\n        if ((array[i] - foundPos || value[i].endSide - value[found].endSide) < 0) {\n            found = i;\n            foundPos = array[i];\n        }\n    return found;\n}\n\n/**\nCount the column position at the given offset into the string,\ntaking extending characters and tab size into account.\n*/\nfunction countColumn(string, tabSize, to = string.length) {\n    let n = 0;\n    for (let i = 0; i < to;) {\n        if (string.charCodeAt(i) == 9) {\n            n += tabSize - (n % tabSize);\n            i++;\n        }\n        else {\n            n++;\n            i = findClusterBreak(string, i);\n        }\n    }\n    return n;\n}\n/**\nFind the offset that corresponds to the given column position in a\nstring, taking extending characters and tab size into account. By\ndefault, the string length is returned when it is too short to\nreach the column. Pass `strict` true to make it return -1 in that\nsituation.\n*/\nfunction findColumn(string, col, tabSize, strict) {\n    for (let i = 0, n = 0;;) {\n        if (n >= col)\n            return i;\n        if (i == string.length)\n            break;\n        n += string.charCodeAt(i) == 9 ? tabSize - (n % tabSize) : 1;\n        i = findClusterBreak(string, i);\n    }\n    return strict === true ? -1 : string.length;\n}\n\nexport { Annotation, AnnotationType, ChangeDesc, ChangeSet, CharCategory, Compartment, EditorSelection, EditorState, Facet, Line, MapMode, Prec, Range, RangeSet, RangeSetBuilder, RangeValue, SelectionRange, StateEffect, StateEffectType, StateField, Text, Transaction, codePointAt, codePointSize, combineConfig, countColumn, findClusterBreak, findColumn, fromCodePoint };\n","const C = \"\\u037c\"\nconst COUNT = typeof Symbol == \"undefined\" ? \"__\" + C : Symbol.for(C)\nconst SET = typeof Symbol == \"undefined\" ? \"__styleSet\" + Math.floor(Math.random() * 1e8) : Symbol(\"styleSet\")\nconst top = typeof globalThis != \"undefined\" ? globalThis : typeof window != \"undefined\" ? window : {}\n\n// :: - Style modules encapsulate a set of CSS rules defined from\n// JavaScript. Their definitions are only available in a given DOM\n// root after it has been _mounted_ there with `StyleModule.mount`.\n//\n// Style modules should be created once and stored somewhere, as\n// opposed to re-creating them every time you need them. The amount of\n// CSS rules generated for a given DOM root is bounded by the amount\n// of style modules that were used. So to avoid leaking rules, don't\n// create these dynamically, but treat them as one-time allocations.\nexport class StyleModule {\n  // :: (Object<Style>, ?{finish: ?(string) → string})\n  // Create a style module from the given spec.\n  //\n  // When `finish` is given, it is called on regular (non-`@`)\n  // selectors (after `&` expansion) to compute the final selector.\n  constructor(spec, options) {\n    this.rules = []\n    let {finish} = options || {}\n\n    function splitSelector(selector) {\n      return /^@/.test(selector) ? [selector] : selector.split(/,\\s*/)\n    }\n\n    function render(selectors, spec, target, isKeyframes) {\n      let local = [], isAt = /^@(\\w+)\\b/.exec(selectors[0]), keyframes = isAt && isAt[1] == \"keyframes\"\n      if (isAt && spec == null) return target.push(selectors[0] + \";\")\n      for (let prop in spec) {\n        let value = spec[prop]\n        if (/&/.test(prop)) {\n          render(prop.split(/,\\s*/).map(part => selectors.map(sel => part.replace(/&/, sel))).reduce((a, b) => a.concat(b)),\n                 value, target)\n        } else if (value && typeof value == \"object\") {\n          if (!isAt) throw new RangeError(\"The value of a property (\" + prop + \") should be a primitive value.\")\n          render(splitSelector(prop), value, local, keyframes)\n        } else if (value != null) {\n          local.push(prop.replace(/_.*/, \"\").replace(/[A-Z]/g, l => \"-\" + l.toLowerCase()) + \": \" + value + \";\")\n        }\n      }\n      if (local.length || keyframes) {\n        target.push((finish && !isAt && !isKeyframes ? selectors.map(finish) : selectors).join(\", \") +\n                    \" {\" + local.join(\" \") + \"}\")\n      }\n    }\n\n    for (let prop in spec) render(splitSelector(prop), spec[prop], this.rules)\n  }\n\n  // :: () → string\n  // Returns a string containing the module's CSS rules.\n  getRules() { return this.rules.join(\"\\n\") }\n\n  // :: () → string\n  // Generate a new unique CSS class name.\n  static newName() {\n    let id = top[COUNT] || 1\n    top[COUNT] = id + 1\n    return C + id.toString(36)\n  }\n\n  // :: (union<Document, ShadowRoot>, union<[StyleModule], StyleModule>)\n  //\n  // Mount the given set of modules in the given DOM root, which ensures\n  // that the CSS rules defined by the module are available in that\n  // context.\n  //\n  // Rules are only added to the document once per root.\n  //\n  // Rule order will follow the order of the modules, so that rules from\n  // modules later in the array take precedence of those from earlier\n  // modules. If you call this function multiple times for the same root\n  // in a way that changes the order of already mounted modules, the old\n  // order will be changed.\n  static mount(root, modules) {\n    (root[SET] || new StyleSet(root)).mount(Array.isArray(modules) ? modules : [modules])\n  }\n}\n\nlet adoptedSet = null\n\nclass StyleSet {\n  constructor(root) {\n    if (!root.head && root.adoptedStyleSheets && typeof CSSStyleSheet != \"undefined\") {\n      if (adoptedSet) {\n        root.adoptedStyleSheets = [adoptedSet.sheet].concat(root.adoptedStyleSheets)\n        return root[SET] = adoptedSet\n      }\n      this.sheet = new CSSStyleSheet\n      root.adoptedStyleSheets = [this.sheet].concat(root.adoptedStyleSheets)\n      adoptedSet = this\n    } else {\n      this.styleTag = (root.ownerDocument || root).createElement(\"style\")\n      let target = root.head || root\n      target.insertBefore(this.styleTag, target.firstChild)\n    }\n    this.modules = []\n    root[SET] = this\n  }\n\n  mount(modules) {\n    let sheet = this.sheet\n    let pos = 0 /* Current rule offset */, j = 0 /* Index into this.modules */\n    for (let i = 0; i < modules.length; i++) {\n      let mod = modules[i], index = this.modules.indexOf(mod)\n      if (index < j && index > -1) { // Ordering conflict\n        this.modules.splice(index, 1)\n        j--\n        index = -1\n      }\n      if (index == -1) {\n        this.modules.splice(j++, 0, mod)\n        if (sheet) for (let k = 0; k < mod.rules.length; k++)\n          sheet.insertRule(mod.rules[k], pos++)\n      } else {\n        while (j < index) pos += this.modules[j++].rules.length\n        pos += mod.rules.length\n        j++\n      }\n    }\n\n    if (!sheet) {\n      let text = \"\"\n      for (let i = 0; i < this.modules.length; i++)\n        text += this.modules[i].getRules() + \"\\n\"\n      this.styleTag.textContent = text\n    }\n  }\n}\n\n// Style::Object<union<Style,string>>\n//\n// A style is an object that, in the simple case, maps CSS property\n// names to strings holding their values, as in `{color: \"red\",\n// fontWeight: \"bold\"}`. The property names can be given in\n// camel-case—the library will insert a dash before capital letters\n// when converting them to CSS.\n//\n// If you include an underscore in a property name, it and everything\n// after it will be removed from the output, which can be useful when\n// providing a property multiple times, for browser compatibility\n// reasons.\n//\n// A property in a style object can also be a sub-selector, which\n// extends the current context to add a pseudo-selector or a child\n// selector. Such a property should contain a `&` character, which\n// will be replaced by the current selector. For example `{\"&:before\":\n// {content: '\"hi\"'}}`. Sub-selectors and regular properties can\n// freely be mixed in a given object. Any property containing a `&` is\n// assumed to be a sub-selector.\n//\n// Finally, a property can specify an @-block to be wrapped around the\n// styles defined inside the object that's the property's value. For\n// example to create a media query you can do `{\"@media screen and\n// (min-width: 400px)\": {...}}`.\n","export var base = {\n  8: \"Backspace\",\n  9: \"Tab\",\n  10: \"Enter\",\n  12: \"NumLock\",\n  13: \"Enter\",\n  16: \"Shift\",\n  17: \"Control\",\n  18: \"Alt\",\n  20: \"CapsLock\",\n  27: \"Escape\",\n  32: \" \",\n  33: \"PageUp\",\n  34: \"PageDown\",\n  35: \"End\",\n  36: \"Home\",\n  37: \"ArrowLeft\",\n  38: \"ArrowUp\",\n  39: \"ArrowRight\",\n  40: \"ArrowDown\",\n  44: \"PrintScreen\",\n  45: \"Insert\",\n  46: \"Delete\",\n  59: \";\",\n  61: \"=\",\n  91: \"Meta\",\n  92: \"Meta\",\n  106: \"*\",\n  107: \"+\",\n  108: \",\",\n  109: \"-\",\n  110: \".\",\n  111: \"/\",\n  144: \"NumLock\",\n  145: \"ScrollLock\",\n  160: \"Shift\",\n  161: \"Shift\",\n  162: \"Control\",\n  163: \"Control\",\n  164: \"Alt\",\n  165: \"Alt\",\n  173: \"-\",\n  186: \";\",\n  187: \"=\",\n  188: \",\",\n  189: \"-\",\n  190: \".\",\n  191: \"/\",\n  192: \"`\",\n  219: \"[\",\n  220: \"\\\\\",\n  221: \"]\",\n  222: \"'\"\n}\n\nexport var shift = {\n  48: \")\",\n  49: \"!\",\n  50: \"@\",\n  51: \"#\",\n  52: \"$\",\n  53: \"%\",\n  54: \"^\",\n  55: \"&\",\n  56: \"*\",\n  57: \"(\",\n  59: \":\",\n  61: \"+\",\n  173: \"_\",\n  186: \":\",\n  187: \"+\",\n  188: \"<\",\n  189: \"_\",\n  190: \">\",\n  191: \"?\",\n  192: \"~\",\n  219: \"{\",\n  220: \"|\",\n  221: \"}\",\n  222: \"\\\"\"\n}\n\nvar chrome = typeof navigator != \"undefined\" && /Chrome\\/(\\d+)/.exec(navigator.userAgent)\nvar gecko = typeof navigator != \"undefined\" && /Gecko\\/\\d+/.test(navigator.userAgent)\nvar mac = typeof navigator != \"undefined\" && /Mac/.test(navigator.platform)\nvar ie = typeof navigator != \"undefined\" && /MSIE \\d|Trident\\/(?:[7-9]|\\d{2,})\\..*rv:(\\d+)/.exec(navigator.userAgent)\nvar brokenModifierNames = mac || chrome && +chrome[1] < 57\n\n// Fill in the digit keys\nfor (var i = 0; i < 10; i++) base[48 + i] = base[96 + i] = String(i)\n\n// The function keys\nfor (var i = 1; i <= 24; i++) base[i + 111] = \"F\" + i\n\n// And the alphabetic keys\nfor (var i = 65; i <= 90; i++) {\n  base[i] = String.fromCharCode(i + 32)\n  shift[i] = String.fromCharCode(i)\n}\n\n// For each code that doesn't have a shift-equivalent, copy the base name\nfor (var code in base) if (!shift.hasOwnProperty(code)) shift[code] = base[code]\n\nexport function keyName(event) {\n  var ignoreKey = brokenModifierNames && (event.ctrlKey || event.altKey || event.metaKey) ||\n    ie && event.shiftKey && event.key && event.key.length == 1 ||\n    event.key == \"Unidentified\"\n  var name = (!ignoreKey && event.key) ||\n    (event.shiftKey ? shift : base)[event.keyCode] ||\n    event.key || \"Unidentified\"\n  // Edge sometimes produces wrong names (Issue #3)\n  if (name == \"Esc\") name = \"Escape\"\n  if (name == \"Del\") name = \"Delete\"\n  // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/8860571/\n  if (name == \"Left\") name = \"ArrowLeft\"\n  if (name == \"Up\") name = \"ArrowUp\"\n  if (name == \"Right\") name = \"ArrowRight\"\n  if (name == \"Down\") name = \"ArrowDown\"\n  return name\n}\n","import { Text, RangeSet, MapMode, RangeValue, Facet, StateEffect, ChangeSet, findClusterBreak, EditorSelection, EditorState, findColumn, CharCategory, Annotation, Transaction, Prec, codePointAt, codePointSize, combineConfig, StateField, RangeSetBuilder, countColumn } from '@codemirror/state';\nimport { StyleModule } from 'style-mod';\nimport { keyName, base, shift } from 'w3c-keyname';\n\nfunction getSelection(root) {\n    let target;\n    // Browsers differ on whether shadow roots have a getSelection\n    // method. If it exists, use that, otherwise, call it on the\n    // document.\n    if (root.nodeType == 11) { // Shadow root\n        target = root.getSelection ? root : root.ownerDocument;\n    }\n    else {\n        target = root;\n    }\n    return target.getSelection();\n}\nfunction contains(dom, node) {\n    return node ? dom == node || dom.contains(node.nodeType != 1 ? node.parentNode : node) : false;\n}\nfunction deepActiveElement(doc) {\n    let elt = doc.activeElement;\n    while (elt && elt.shadowRoot)\n        elt = elt.shadowRoot.activeElement;\n    return elt;\n}\nfunction hasSelection(dom, selection) {\n    if (!selection.anchorNode)\n        return false;\n    try {\n        // Firefox will raise 'permission denied' errors when accessing\n        // properties of `sel.anchorNode` when it's in a generated CSS\n        // element.\n        return contains(dom, selection.anchorNode);\n    }\n    catch (_) {\n        return false;\n    }\n}\nfunction clientRectsFor(dom) {\n    if (dom.nodeType == 3)\n        return textRange(dom, 0, dom.nodeValue.length).getClientRects();\n    else if (dom.nodeType == 1)\n        return dom.getClientRects();\n    else\n        return [];\n}\n// Scans forward and backward through DOM positions equivalent to the\n// given one to see if the two are in the same place (i.e. after a\n// text node vs at the end of that text node)\nfunction isEquivalentPosition(node, off, targetNode, targetOff) {\n    return targetNode ? (scanFor(node, off, targetNode, targetOff, -1) ||\n        scanFor(node, off, targetNode, targetOff, 1)) : false;\n}\nfunction domIndex(node) {\n    for (var index = 0;; index++) {\n        node = node.previousSibling;\n        if (!node)\n            return index;\n    }\n}\nfunction scanFor(node, off, targetNode, targetOff, dir) {\n    for (;;) {\n        if (node == targetNode && off == targetOff)\n            return true;\n        if (off == (dir < 0 ? 0 : maxOffset(node))) {\n            if (node.nodeName == \"DIV\")\n                return false;\n            let parent = node.parentNode;\n            if (!parent || parent.nodeType != 1)\n                return false;\n            off = domIndex(node) + (dir < 0 ? 0 : 1);\n            node = parent;\n        }\n        else if (node.nodeType == 1) {\n            node = node.childNodes[off + (dir < 0 ? -1 : 0)];\n            if (node.nodeType == 1 && node.contentEditable == \"false\")\n                return false;\n            off = dir < 0 ? maxOffset(node) : 0;\n        }\n        else {\n            return false;\n        }\n    }\n}\nfunction maxOffset(node) {\n    return node.nodeType == 3 ? node.nodeValue.length : node.childNodes.length;\n}\nconst Rect0 = { left: 0, right: 0, top: 0, bottom: 0 };\nfunction flattenRect(rect, left) {\n    let x = left ? rect.left : rect.right;\n    return { left: x, right: x, top: rect.top, bottom: rect.bottom };\n}\nfunction windowRect(win) {\n    return { left: 0, right: win.innerWidth,\n        top: 0, bottom: win.innerHeight };\n}\nfunction scrollRectIntoView(dom, rect, side, x, y, xMargin, yMargin, ltr) {\n    let doc = dom.ownerDocument, win = doc.defaultView || window;\n    for (let cur = dom; cur;) {\n        if (cur.nodeType == 1) { // Element\n            let bounding, top = cur == doc.body;\n            if (top) {\n                bounding = windowRect(win);\n            }\n            else {\n                if (cur.scrollHeight <= cur.clientHeight && cur.scrollWidth <= cur.clientWidth) {\n                    cur = cur.assignedSlot || cur.parentNode;\n                    continue;\n                }\n                let rect = cur.getBoundingClientRect();\n                // Make sure scrollbar width isn't included in the rectangle\n                bounding = { left: rect.left, right: rect.left + cur.clientWidth,\n                    top: rect.top, bottom: rect.top + cur.clientHeight };\n            }\n            let moveX = 0, moveY = 0;\n            if (y == \"nearest\") {\n                if (rect.top < bounding.top) {\n                    moveY = -(bounding.top - rect.top + yMargin);\n                    if (side > 0 && rect.bottom > bounding.bottom + moveY)\n                        moveY = rect.bottom - bounding.bottom + moveY + yMargin;\n                }\n                else if (rect.bottom > bounding.bottom) {\n                    moveY = rect.bottom - bounding.bottom + yMargin;\n                    if (side < 0 && (rect.top - moveY) < bounding.top)\n                        moveY = -(bounding.top + moveY - rect.top + yMargin);\n                }\n            }\n            else {\n                let rectHeight = rect.bottom - rect.top, boundingHeight = bounding.bottom - bounding.top;\n                let targetTop = y == \"center\" && rectHeight <= boundingHeight ? rect.top + rectHeight / 2 - boundingHeight / 2 :\n                    y == \"start\" || y == \"center\" && side < 0 ? rect.top - yMargin :\n                        rect.bottom - boundingHeight + yMargin;\n                moveY = targetTop - bounding.top;\n            }\n            if (x == \"nearest\") {\n                if (rect.left < bounding.left) {\n                    moveX = -(bounding.left - rect.left + xMargin);\n                    if (side > 0 && rect.right > bounding.right + moveX)\n                        moveX = rect.right - bounding.right + moveX + xMargin;\n                }\n                else if (rect.right > bounding.right) {\n                    moveX = rect.right - bounding.right + xMargin;\n                    if (side < 0 && rect.left < bounding.left + moveX)\n                        moveX = -(bounding.left + moveX - rect.left + xMargin);\n                }\n            }\n            else {\n                let targetLeft = x == \"center\" ? rect.left + (rect.right - rect.left) / 2 - (bounding.right - bounding.left) / 2 :\n                    (x == \"start\") == ltr ? rect.left - xMargin :\n                        rect.right - (bounding.right - bounding.left) + xMargin;\n                moveX = targetLeft - bounding.left;\n            }\n            if (moveX || moveY) {\n                if (top) {\n                    win.scrollBy(moveX, moveY);\n                }\n                else {\n                    let movedX = 0, movedY = 0;\n                    if (moveY) {\n                        let start = cur.scrollTop;\n                        cur.scrollTop += moveY;\n                        movedY = cur.scrollTop - start;\n                    }\n                    if (moveX) {\n                        let start = cur.scrollLeft;\n                        cur.scrollLeft += moveX;\n                        movedX = cur.scrollLeft - start;\n                    }\n                    rect = { left: rect.left - movedX, top: rect.top - movedY,\n                        right: rect.right - movedX, bottom: rect.bottom - movedY };\n                    if (movedX && Math.abs(movedX - moveX) < 1)\n                        x = \"nearest\";\n                    if (movedY && Math.abs(movedY - moveY) < 1)\n                        y = \"nearest\";\n                }\n            }\n            if (top)\n                break;\n            cur = cur.assignedSlot || cur.parentNode;\n        }\n        else if (cur.nodeType == 11) { // A shadow root\n            cur = cur.host;\n        }\n        else {\n            break;\n        }\n    }\n}\nfunction scrollableParent(dom) {\n    let doc = dom.ownerDocument;\n    for (let cur = dom.parentNode; cur;) {\n        if (cur == doc.body) {\n            break;\n        }\n        else if (cur.nodeType == 1) {\n            if (cur.scrollHeight > cur.clientHeight || cur.scrollWidth > cur.clientWidth)\n                return cur;\n            cur = cur.assignedSlot || cur.parentNode;\n        }\n        else if (cur.nodeType == 11) {\n            cur = cur.host;\n        }\n        else {\n            break;\n        }\n    }\n    return null;\n}\nclass DOMSelectionState {\n    constructor() {\n        this.anchorNode = null;\n        this.anchorOffset = 0;\n        this.focusNode = null;\n        this.focusOffset = 0;\n    }\n    eq(domSel) {\n        return this.anchorNode == domSel.anchorNode && this.anchorOffset == domSel.anchorOffset &&\n            this.focusNode == domSel.focusNode && this.focusOffset == domSel.focusOffset;\n    }\n    setRange(range) {\n        this.set(range.anchorNode, range.anchorOffset, range.focusNode, range.focusOffset);\n    }\n    set(anchorNode, anchorOffset, focusNode, focusOffset) {\n        this.anchorNode = anchorNode;\n        this.anchorOffset = anchorOffset;\n        this.focusNode = focusNode;\n        this.focusOffset = focusOffset;\n    }\n}\nlet preventScrollSupported = null;\n// Feature-detects support for .focus({preventScroll: true}), and uses\n// a fallback kludge when not supported.\nfunction focusPreventScroll(dom) {\n    if (dom.setActive)\n        return dom.setActive(); // in IE\n    if (preventScrollSupported)\n        return dom.focus(preventScrollSupported);\n    let stack = [];\n    for (let cur = dom; cur; cur = cur.parentNode) {\n        stack.push(cur, cur.scrollTop, cur.scrollLeft);\n        if (cur == cur.ownerDocument)\n            break;\n    }\n    dom.focus(preventScrollSupported == null ? {\n        get preventScroll() {\n            preventScrollSupported = { preventScroll: true };\n            return true;\n        }\n    } : undefined);\n    if (!preventScrollSupported) {\n        preventScrollSupported = false;\n        for (let i = 0; i < stack.length;) {\n            let elt = stack[i++], top = stack[i++], left = stack[i++];\n            if (elt.scrollTop != top)\n                elt.scrollTop = top;\n            if (elt.scrollLeft != left)\n                elt.scrollLeft = left;\n        }\n    }\n}\nlet scratchRange;\nfunction textRange(node, from, to = from) {\n    let range = scratchRange || (scratchRange = document.createRange());\n    range.setEnd(node, to);\n    range.setStart(node, from);\n    return range;\n}\nfunction dispatchKey(elt, name, code) {\n    let options = { key: name, code: name, keyCode: code, which: code, cancelable: true };\n    let down = new KeyboardEvent(\"keydown\", options);\n    down.synthetic = true;\n    elt.dispatchEvent(down);\n    let up = new KeyboardEvent(\"keyup\", options);\n    up.synthetic = true;\n    elt.dispatchEvent(up);\n    return down.defaultPrevented || up.defaultPrevented;\n}\nfunction getRoot(node) {\n    while (node) {\n        if (node && (node.nodeType == 9 || node.nodeType == 11 && node.host))\n            return node;\n        node = node.assignedSlot || node.parentNode;\n    }\n    return null;\n}\nfunction clearAttributes(node) {\n    while (node.attributes.length)\n        node.removeAttributeNode(node.attributes[0]);\n}\nfunction atElementStart(doc, selection) {\n    let node = selection.focusNode, offset = selection.focusOffset;\n    if (!node || selection.anchorNode != node || selection.anchorOffset != offset)\n        return false;\n    for (;;) {\n        if (offset) {\n            if (node.nodeType != 1)\n                return false;\n            let prev = node.childNodes[offset - 1];\n            if (prev.contentEditable == \"false\")\n                offset--;\n            else {\n                node = prev;\n                offset = maxOffset(node);\n            }\n        }\n        else if (node == doc) {\n            return true;\n        }\n        else {\n            offset = domIndex(node);\n            node = node.parentNode;\n        }\n    }\n}\n\nclass DOMPos {\n    constructor(node, offset, precise = true) {\n        this.node = node;\n        this.offset = offset;\n        this.precise = precise;\n    }\n    static before(dom, precise) { return new DOMPos(dom.parentNode, domIndex(dom), precise); }\n    static after(dom, precise) { return new DOMPos(dom.parentNode, domIndex(dom) + 1, precise); }\n}\nconst noChildren = [];\nclass ContentView {\n    constructor() {\n        this.parent = null;\n        this.dom = null;\n        this.dirty = 2 /* Dirty.Node */;\n    }\n    get overrideDOMText() { return null; }\n    get posAtStart() {\n        return this.parent ? this.parent.posBefore(this) : 0;\n    }\n    get posAtEnd() {\n        return this.posAtStart + this.length;\n    }\n    posBefore(view) {\n        let pos = this.posAtStart;\n        for (let child of this.children) {\n            if (child == view)\n                return pos;\n            pos += child.length + child.breakAfter;\n        }\n        throw new RangeError(\"Invalid child in posBefore\");\n    }\n    posAfter(view) {\n        return this.posBefore(view) + view.length;\n    }\n    // Will return a rectangle directly before (when side < 0), after\n    // (side > 0) or directly on (when the browser supports it) the\n    // given position.\n    coordsAt(_pos, _side) { return null; }\n    sync(view, track) {\n        if (this.dirty & 2 /* Dirty.Node */) {\n            let parent = this.dom;\n            let prev = null, next;\n            for (let child of this.children) {\n                if (child.dirty) {\n                    if (!child.dom && (next = prev ? prev.nextSibling : parent.firstChild)) {\n                        let contentView = ContentView.get(next);\n                        if (!contentView || !contentView.parent && contentView.canReuseDOM(child))\n                            child.reuseDOM(next);\n                    }\n                    child.sync(view, track);\n                    child.dirty = 0 /* Dirty.Not */;\n                }\n                next = prev ? prev.nextSibling : parent.firstChild;\n                if (track && !track.written && track.node == parent && next != child.dom)\n                    track.written = true;\n                if (child.dom.parentNode == parent) {\n                    while (next && next != child.dom)\n                        next = rm$1(next);\n                }\n                else {\n                    parent.insertBefore(child.dom, next);\n                }\n                prev = child.dom;\n            }\n            next = prev ? prev.nextSibling : parent.firstChild;\n            if (next && track && track.node == parent)\n                track.written = true;\n            while (next)\n                next = rm$1(next);\n        }\n        else if (this.dirty & 1 /* Dirty.Child */) {\n            for (let child of this.children)\n                if (child.dirty) {\n                    child.sync(view, track);\n                    child.dirty = 0 /* Dirty.Not */;\n                }\n        }\n    }\n    reuseDOM(_dom) { }\n    localPosFromDOM(node, offset) {\n        let after;\n        if (node == this.dom) {\n            after = this.dom.childNodes[offset];\n        }\n        else {\n            let bias = maxOffset(node) == 0 ? 0 : offset == 0 ? -1 : 1;\n            for (;;) {\n                let parent = node.parentNode;\n                if (parent == this.dom)\n                    break;\n                if (bias == 0 && parent.firstChild != parent.lastChild) {\n                    if (node == parent.firstChild)\n                        bias = -1;\n                    else\n                        bias = 1;\n                }\n                node = parent;\n            }\n            if (bias < 0)\n                after = node;\n            else\n                after = node.nextSibling;\n        }\n        if (after == this.dom.firstChild)\n            return 0;\n        while (after && !ContentView.get(after))\n            after = after.nextSibling;\n        if (!after)\n            return this.length;\n        for (let i = 0, pos = 0;; i++) {\n            let child = this.children[i];\n            if (child.dom == after)\n                return pos;\n            pos += child.length + child.breakAfter;\n        }\n    }\n    domBoundsAround(from, to, offset = 0) {\n        let fromI = -1, fromStart = -1, toI = -1, toEnd = -1;\n        for (let i = 0, pos = offset, prevEnd = offset; i < this.children.length; i++) {\n            let child = this.children[i], end = pos + child.length;\n            if (pos < from && end > to)\n                return child.domBoundsAround(from, to, pos);\n            if (end >= from && fromI == -1) {\n                fromI = i;\n                fromStart = pos;\n            }\n            if (pos > to && child.dom.parentNode == this.dom) {\n                toI = i;\n                toEnd = prevEnd;\n                break;\n            }\n            prevEnd = end;\n            pos = end + child.breakAfter;\n        }\n        return { from: fromStart, to: toEnd < 0 ? offset + this.length : toEnd,\n            startDOM: (fromI ? this.children[fromI - 1].dom.nextSibling : null) || this.dom.firstChild,\n            endDOM: toI < this.children.length && toI >= 0 ? this.children[toI].dom : null };\n    }\n    markDirty(andParent = false) {\n        this.dirty |= 2 /* Dirty.Node */;\n        this.markParentsDirty(andParent);\n    }\n    markParentsDirty(childList) {\n        for (let parent = this.parent; parent; parent = parent.parent) {\n            if (childList)\n                parent.dirty |= 2 /* Dirty.Node */;\n            if (parent.dirty & 1 /* Dirty.Child */)\n                return;\n            parent.dirty |= 1 /* Dirty.Child */;\n            childList = false;\n        }\n    }\n    setParent(parent) {\n        if (this.parent != parent) {\n            this.parent = parent;\n            if (this.dirty)\n                this.markParentsDirty(true);\n        }\n    }\n    setDOM(dom) {\n        if (this.dom)\n            this.dom.cmView = null;\n        this.dom = dom;\n        dom.cmView = this;\n    }\n    get rootView() {\n        for (let v = this;;) {\n            let parent = v.parent;\n            if (!parent)\n                return v;\n            v = parent;\n        }\n    }\n    replaceChildren(from, to, children = noChildren) {\n        this.markDirty();\n        for (let i = from; i < to; i++) {\n            let child = this.children[i];\n            if (child.parent == this)\n                child.destroy();\n        }\n        this.children.splice(from, to - from, ...children);\n        for (let i = 0; i < children.length; i++)\n            children[i].setParent(this);\n    }\n    ignoreMutation(_rec) { return false; }\n    ignoreEvent(_event) { return false; }\n    childCursor(pos = this.length) {\n        return new ChildCursor(this.children, pos, this.children.length);\n    }\n    childPos(pos, bias = 1) {\n        return this.childCursor().findPos(pos, bias);\n    }\n    toString() {\n        let name = this.constructor.name.replace(\"View\", \"\");\n        return name + (this.children.length ? \"(\" + this.children.join() + \")\" :\n            this.length ? \"[\" + (name == \"Text\" ? this.text : this.length) + \"]\" : \"\") +\n            (this.breakAfter ? \"#\" : \"\");\n    }\n    static get(node) { return node.cmView; }\n    get isEditable() { return true; }\n    get isWidget() { return false; }\n    merge(from, to, source, hasStart, openStart, openEnd) {\n        return false;\n    }\n    become(other) { return false; }\n    canReuseDOM(other) { return other.constructor == this.constructor; }\n    // When this is a zero-length view with a side, this should return a\n    // number <= 0 to indicate it is before its position, or a\n    // number > 0 when after its position.\n    getSide() { return 0; }\n    destroy() {\n        this.parent = null;\n    }\n}\nContentView.prototype.breakAfter = 0;\n// Remove a DOM node and return its next sibling.\nfunction rm$1(dom) {\n    let next = dom.nextSibling;\n    dom.parentNode.removeChild(dom);\n    return next;\n}\nclass ChildCursor {\n    constructor(children, pos, i) {\n        this.children = children;\n        this.pos = pos;\n        this.i = i;\n        this.off = 0;\n    }\n    findPos(pos, bias = 1) {\n        for (;;) {\n            if (pos > this.pos || pos == this.pos &&\n                (bias > 0 || this.i == 0 || this.children[this.i - 1].breakAfter)) {\n                this.off = pos - this.pos;\n                return this;\n            }\n            let next = this.children[--this.i];\n            this.pos -= next.length + next.breakAfter;\n        }\n    }\n}\nfunction replaceRange(parent, fromI, fromOff, toI, toOff, insert, breakAtStart, openStart, openEnd) {\n    let { children } = parent;\n    let before = children.length ? children[fromI] : null;\n    let last = insert.length ? insert[insert.length - 1] : null;\n    let breakAtEnd = last ? last.breakAfter : breakAtStart;\n    // Change within a single child\n    if (fromI == toI && before && !breakAtStart && !breakAtEnd && insert.length < 2 &&\n        before.merge(fromOff, toOff, insert.length ? last : null, fromOff == 0, openStart, openEnd))\n        return;\n    if (toI < children.length) {\n        let after = children[toI];\n        // Make sure the end of the child after the update is preserved in `after`\n        if (after && toOff < after.length) {\n            // If we're splitting a child, separate part of it to avoid that\n            // being mangled when updating the child before the update.\n            if (fromI == toI) {\n                after = after.split(toOff);\n                toOff = 0;\n            }\n            // If the element after the replacement should be merged with\n            // the last replacing element, update `content`\n            if (!breakAtEnd && last && after.merge(0, toOff, last, true, 0, openEnd)) {\n                insert[insert.length - 1] = after;\n            }\n            else {\n                // Remove the start of the after element, if necessary, and\n                // add it to `content`.\n                if (toOff)\n                    after.merge(0, toOff, null, false, 0, openEnd);\n                insert.push(after);\n            }\n        }\n        else if (after === null || after === void 0 ? void 0 : after.breakAfter) {\n            // The element at `toI` is entirely covered by this range.\n            // Preserve its line break, if any.\n            if (last)\n                last.breakAfter = 1;\n            else\n                breakAtStart = 1;\n        }\n        // Since we've handled the next element from the current elements\n        // now, make sure `toI` points after that.\n        toI++;\n    }\n    if (before) {\n        before.breakAfter = breakAtStart;\n        if (fromOff > 0) {\n            if (!breakAtStart && insert.length && before.merge(fromOff, before.length, insert[0], false, openStart, 0)) {\n                before.breakAfter = insert.shift().breakAfter;\n            }\n            else if (fromOff < before.length || before.children.length && before.children[before.children.length - 1].length == 0) {\n                before.merge(fromOff, before.length, null, false, openStart, 0);\n            }\n            fromI++;\n        }\n    }\n    // Try to merge widgets on the boundaries of the replacement\n    while (fromI < toI && insert.length) {\n        if (children[toI - 1].become(insert[insert.length - 1])) {\n            toI--;\n            insert.pop();\n            openEnd = insert.length ? 0 : openStart;\n        }\n        else if (children[fromI].become(insert[0])) {\n            fromI++;\n            insert.shift();\n            openStart = insert.length ? 0 : openEnd;\n        }\n        else {\n            break;\n        }\n    }\n    if (!insert.length && fromI && toI < children.length && !children[fromI - 1].breakAfter &&\n        children[toI].merge(0, 0, children[fromI - 1], false, openStart, openEnd))\n        fromI--;\n    if (fromI < toI || insert.length)\n        parent.replaceChildren(fromI, toI, insert);\n}\nfunction mergeChildrenInto(parent, from, to, insert, openStart, openEnd) {\n    let cur = parent.childCursor();\n    let { i: toI, off: toOff } = cur.findPos(to, 1);\n    let { i: fromI, off: fromOff } = cur.findPos(from, -1);\n    let dLen = from - to;\n    for (let view of insert)\n        dLen += view.length;\n    parent.length += dLen;\n    replaceRange(parent, fromI, fromOff, toI, toOff, insert, 0, openStart, openEnd);\n}\n\nlet nav = typeof navigator != \"undefined\" ? navigator : { userAgent: \"\", vendor: \"\", platform: \"\" };\nlet doc = typeof document != \"undefined\" ? document : { documentElement: { style: {} } };\nconst ie_edge = /*@__PURE__*//Edge\\/(\\d+)/.exec(nav.userAgent);\nconst ie_upto10 = /*@__PURE__*//MSIE \\d/.test(nav.userAgent);\nconst ie_11up = /*@__PURE__*//Trident\\/(?:[7-9]|\\d{2,})\\..*rv:(\\d+)/.exec(nav.userAgent);\nconst ie = !!(ie_upto10 || ie_11up || ie_edge);\nconst gecko = !ie && /*@__PURE__*//gecko\\/(\\d+)/i.test(nav.userAgent);\nconst chrome = !ie && /*@__PURE__*//Chrome\\/(\\d+)/.exec(nav.userAgent);\nconst webkit = \"webkitFontSmoothing\" in doc.documentElement.style;\nconst safari = !ie && /*@__PURE__*//Apple Computer/.test(nav.vendor);\nconst ios = safari && (/*@__PURE__*//Mobile\\/\\w+/.test(nav.userAgent) || nav.maxTouchPoints > 2);\nvar browser = {\n    mac: ios || /*@__PURE__*//Mac/.test(nav.platform),\n    windows: /*@__PURE__*//Win/.test(nav.platform),\n    linux: /*@__PURE__*//Linux|X11/.test(nav.platform),\n    ie,\n    ie_version: ie_upto10 ? doc.documentMode || 6 : ie_11up ? +ie_11up[1] : ie_edge ? +ie_edge[1] : 0,\n    gecko,\n    gecko_version: gecko ? +(/*@__PURE__*//Firefox\\/(\\d+)/.exec(nav.userAgent) || [0, 0])[1] : 0,\n    chrome: !!chrome,\n    chrome_version: chrome ? +chrome[1] : 0,\n    ios,\n    android: /*@__PURE__*//Android\\b/.test(nav.userAgent),\n    webkit,\n    safari,\n    webkit_version: webkit ? +(/*@__PURE__*//\\bAppleWebKit\\/(\\d+)/.exec(navigator.userAgent) || [0, 0])[1] : 0,\n    tabSize: doc.documentElement.style.tabSize != null ? \"tab-size\" : \"-moz-tab-size\"\n};\n\nconst MaxJoinLen = 256;\nclass TextView extends ContentView {\n    constructor(text) {\n        super();\n        this.text = text;\n    }\n    get length() { return this.text.length; }\n    createDOM(textDOM) {\n        this.setDOM(textDOM || document.createTextNode(this.text));\n    }\n    sync(view, track) {\n        if (!this.dom)\n            this.createDOM();\n        if (this.dom.nodeValue != this.text) {\n            if (track && track.node == this.dom)\n                track.written = true;\n            this.dom.nodeValue = this.text;\n        }\n    }\n    reuseDOM(dom) {\n        if (dom.nodeType == 3)\n            this.createDOM(dom);\n    }\n    merge(from, to, source) {\n        if (source && (!(source instanceof TextView) || this.length - (to - from) + source.length > MaxJoinLen))\n            return false;\n        this.text = this.text.slice(0, from) + (source ? source.text : \"\") + this.text.slice(to);\n        this.markDirty();\n        return true;\n    }\n    split(from) {\n        let result = new TextView(this.text.slice(from));\n        this.text = this.text.slice(0, from);\n        this.markDirty();\n        return result;\n    }\n    localPosFromDOM(node, offset) {\n        return node == this.dom ? offset : offset ? this.text.length : 0;\n    }\n    domAtPos(pos) { return new DOMPos(this.dom, pos); }\n    domBoundsAround(_from, _to, offset) {\n        return { from: offset, to: offset + this.length, startDOM: this.dom, endDOM: this.dom.nextSibling };\n    }\n    coordsAt(pos, side) {\n        return textCoords(this.dom, pos, side);\n    }\n}\nclass MarkView extends ContentView {\n    constructor(mark, children = [], length = 0) {\n        super();\n        this.mark = mark;\n        this.children = children;\n        this.length = length;\n        for (let ch of children)\n            ch.setParent(this);\n    }\n    setAttrs(dom) {\n        clearAttributes(dom);\n        if (this.mark.class)\n            dom.className = this.mark.class;\n        if (this.mark.attrs)\n            for (let name in this.mark.attrs)\n                dom.setAttribute(name, this.mark.attrs[name]);\n        return dom;\n    }\n    reuseDOM(node) {\n        if (node.nodeName == this.mark.tagName.toUpperCase()) {\n            this.setDOM(node);\n            this.dirty |= 4 /* Dirty.Attrs */ | 2 /* Dirty.Node */;\n        }\n    }\n    sync(view, track) {\n        if (!this.dom)\n            this.setDOM(this.setAttrs(document.createElement(this.mark.tagName)));\n        else if (this.dirty & 4 /* Dirty.Attrs */)\n            this.setAttrs(this.dom);\n        super.sync(view, track);\n    }\n    merge(from, to, source, _hasStart, openStart, openEnd) {\n        if (source && (!(source instanceof MarkView && source.mark.eq(this.mark)) ||\n            (from && openStart <= 0) || (to < this.length && openEnd <= 0)))\n            return false;\n        mergeChildrenInto(this, from, to, source ? source.children : [], openStart - 1, openEnd - 1);\n        this.markDirty();\n        return true;\n    }\n    split(from) {\n        let result = [], off = 0, detachFrom = -1, i = 0;\n        for (let elt of this.children) {\n            let end = off + elt.length;\n            if (end > from)\n                result.push(off < from ? elt.split(from - off) : elt);\n            if (detachFrom < 0 && off >= from)\n                detachFrom = i;\n            off = end;\n            i++;\n        }\n        let length = this.length - from;\n        this.length = from;\n        if (detachFrom > -1) {\n            this.children.length = detachFrom;\n            this.markDirty();\n        }\n        return new MarkView(this.mark, result, length);\n    }\n    domAtPos(pos) {\n        return inlineDOMAtPos(this, pos);\n    }\n    coordsAt(pos, side) {\n        return coordsInChildren(this, pos, side);\n    }\n}\nfunction textCoords(text, pos, side) {\n    let length = text.nodeValue.length;\n    if (pos > length)\n        pos = length;\n    let from = pos, to = pos, flatten = 0;\n    if (pos == 0 && side < 0 || pos == length && side >= 0) {\n        if (!(browser.chrome || browser.gecko)) { // These browsers reliably return valid rectangles for empty ranges\n            if (pos) {\n                from--;\n                flatten = 1;\n            } // FIXME this is wrong in RTL text\n            else if (to < length) {\n                to++;\n                flatten = -1;\n            }\n        }\n    }\n    else {\n        if (side < 0)\n            from--;\n        else if (to < length)\n            to++;\n    }\n    let rects = textRange(text, from, to).getClientRects();\n    if (!rects.length)\n        return Rect0;\n    let rect = rects[(flatten ? flatten < 0 : side >= 0) ? 0 : rects.length - 1];\n    if (browser.safari && !flatten && rect.width == 0)\n        rect = Array.prototype.find.call(rects, r => r.width) || rect;\n    return flatten ? flattenRect(rect, flatten < 0) : rect || null;\n}\n// Also used for collapsed ranges that don't have a placeholder widget!\nclass WidgetView extends ContentView {\n    constructor(widget, length, side) {\n        super();\n        this.widget = widget;\n        this.length = length;\n        this.side = side;\n        this.prevWidget = null;\n    }\n    static create(widget, length, side) {\n        return new (widget.customView || WidgetView)(widget, length, side);\n    }\n    split(from) {\n        let result = WidgetView.create(this.widget, this.length - from, this.side);\n        this.length -= from;\n        return result;\n    }\n    sync(view) {\n        if (!this.dom || !this.widget.updateDOM(this.dom, view)) {\n            if (this.dom && this.prevWidget)\n                this.prevWidget.destroy(this.dom);\n            this.prevWidget = null;\n            this.setDOM(this.widget.toDOM(view));\n            this.dom.contentEditable = \"false\";\n        }\n    }\n    getSide() { return this.side; }\n    merge(from, to, source, hasStart, openStart, openEnd) {\n        if (source && (!(source instanceof WidgetView) || !this.widget.compare(source.widget) ||\n            from > 0 && openStart <= 0 || to < this.length && openEnd <= 0))\n            return false;\n        this.length = from + (source ? source.length : 0) + (this.length - to);\n        return true;\n    }\n    become(other) {\n        if (other.length == this.length && other instanceof WidgetView && other.side == this.side) {\n            if (this.widget.constructor == other.widget.constructor) {\n                if (!this.widget.eq(other.widget))\n                    this.markDirty(true);\n                if (this.dom && !this.prevWidget)\n                    this.prevWidget = this.widget;\n                this.widget = other.widget;\n                return true;\n            }\n        }\n        return false;\n    }\n    ignoreMutation() { return true; }\n    ignoreEvent(event) { return this.widget.ignoreEvent(event); }\n    get overrideDOMText() {\n        if (this.length == 0)\n            return Text.empty;\n        let top = this;\n        while (top.parent)\n            top = top.parent;\n        let { view } = top, text = view && view.state.doc, start = this.posAtStart;\n        return text ? text.slice(start, start + this.length) : Text.empty;\n    }\n    domAtPos(pos) {\n        return pos == 0 ? DOMPos.before(this.dom) : DOMPos.after(this.dom, pos == this.length);\n    }\n    domBoundsAround() { return null; }\n    coordsAt(pos, side) {\n        let rects = this.dom.getClientRects(), rect = null;\n        if (!rects.length)\n            return Rect0;\n        for (let i = pos > 0 ? rects.length - 1 : 0;; i += (pos > 0 ? -1 : 1)) {\n            rect = rects[i];\n            if (pos > 0 ? i == 0 : i == rects.length - 1 || rect.top < rect.bottom)\n                break;\n        }\n        return this.length ? rect : flattenRect(rect, this.side > 0);\n    }\n    get isEditable() { return false; }\n    get isWidget() { return true; }\n    destroy() {\n        super.destroy();\n        if (this.dom)\n            this.widget.destroy(this.dom);\n    }\n}\nclass CompositionView extends WidgetView {\n    domAtPos(pos) {\n        let { topView, text } = this.widget;\n        if (!topView)\n            return new DOMPos(text, Math.min(pos, text.nodeValue.length));\n        return scanCompositionTree(pos, 0, topView, text, (v, p) => v.domAtPos(p), p => new DOMPos(text, Math.min(p, text.nodeValue.length)));\n    }\n    sync() { this.setDOM(this.widget.toDOM()); }\n    localPosFromDOM(node, offset) {\n        let { topView, text } = this.widget;\n        if (!topView)\n            return Math.min(offset, this.length);\n        return posFromDOMInCompositionTree(node, offset, topView, text);\n    }\n    ignoreMutation() { return false; }\n    get overrideDOMText() { return null; }\n    coordsAt(pos, side) {\n        let { topView, text } = this.widget;\n        if (!topView)\n            return textCoords(text, pos, side);\n        return scanCompositionTree(pos, side, topView, text, (v, pos, side) => v.coordsAt(pos, side), (pos, side) => textCoords(text, pos, side));\n    }\n    destroy() {\n        var _a;\n        super.destroy();\n        (_a = this.widget.topView) === null || _a === void 0 ? void 0 : _a.destroy();\n    }\n    get isEditable() { return true; }\n    canReuseDOM() { return true; }\n}\n// Uses the old structure of a chunk of content view frozen for\n// composition to try and find a reasonable DOM location for the given\n// offset.\nfunction scanCompositionTree(pos, side, view, text, enterView, fromText) {\n    if (view instanceof MarkView) {\n        for (let child = view.dom.firstChild; child; child = child.nextSibling) {\n            let desc = ContentView.get(child);\n            if (!desc)\n                return fromText(pos, side);\n            let hasComp = contains(child, text);\n            let len = desc.length + (hasComp ? text.nodeValue.length : 0);\n            if (pos < len || pos == len && desc.getSide() <= 0)\n                return hasComp ? scanCompositionTree(pos, side, desc, text, enterView, fromText) : enterView(desc, pos, side);\n            pos -= len;\n        }\n        return enterView(view, view.length, -1);\n    }\n    else if (view.dom == text) {\n        return fromText(pos, side);\n    }\n    else {\n        return enterView(view, pos, side);\n    }\n}\nfunction posFromDOMInCompositionTree(node, offset, view, text) {\n    if (view instanceof MarkView) {\n        for (let child of view.children) {\n            let pos = 0, hasComp = contains(child.dom, text);\n            if (contains(child.dom, node))\n                return pos + (hasComp ? posFromDOMInCompositionTree(node, offset, child, text) : child.localPosFromDOM(node, offset));\n            pos += hasComp ? text.nodeValue.length : child.length;\n        }\n    }\n    else if (view.dom == text) {\n        return Math.min(offset, text.nodeValue.length);\n    }\n    return view.localPosFromDOM(node, offset);\n}\n// These are drawn around uneditable widgets to avoid a number of\n// browser bugs that show up when the cursor is directly next to\n// uneditable inline content.\nclass WidgetBufferView extends ContentView {\n    constructor(side) {\n        super();\n        this.side = side;\n    }\n    get length() { return 0; }\n    merge() { return false; }\n    become(other) {\n        return other instanceof WidgetBufferView && other.side == this.side;\n    }\n    split() { return new WidgetBufferView(this.side); }\n    sync() {\n        if (!this.dom) {\n            let dom = document.createElement(\"img\");\n            dom.className = \"cm-widgetBuffer\";\n            dom.setAttribute(\"aria-hidden\", \"true\");\n            this.setDOM(dom);\n        }\n    }\n    getSide() { return this.side; }\n    domAtPos(pos) { return DOMPos.before(this.dom); }\n    localPosFromDOM() { return 0; }\n    domBoundsAround() { return null; }\n    coordsAt(pos) {\n        let imgRect = this.dom.getBoundingClientRect();\n        // Since the <img> height doesn't correspond to text height, try\n        // to borrow the height from some sibling node.\n        let siblingRect = inlineSiblingRect(this, this.side > 0 ? -1 : 1);\n        return siblingRect && siblingRect.top < imgRect.bottom && siblingRect.bottom > imgRect.top\n            ? { left: imgRect.left, right: imgRect.right, top: siblingRect.top, bottom: siblingRect.bottom } : imgRect;\n    }\n    get overrideDOMText() {\n        return Text.empty;\n    }\n}\nTextView.prototype.children = WidgetView.prototype.children = WidgetBufferView.prototype.children = noChildren;\nfunction inlineSiblingRect(view, side) {\n    let parent = view.parent, index = parent ? parent.children.indexOf(view) : -1;\n    while (parent && index >= 0) {\n        if (side < 0 ? index > 0 : index < parent.children.length) {\n            let next = parent.children[index + side];\n            if (next instanceof TextView) {\n                let nextRect = next.coordsAt(side < 0 ? next.length : 0, side);\n                if (nextRect)\n                    return nextRect;\n            }\n            index += side;\n        }\n        else if (parent instanceof MarkView && parent.parent) {\n            index = parent.parent.children.indexOf(parent) + (side < 0 ? 0 : 1);\n            parent = parent.parent;\n        }\n        else {\n            let last = parent.dom.lastChild;\n            if (last && last.nodeName == \"BR\")\n                return last.getClientRects()[0];\n            break;\n        }\n    }\n    return undefined;\n}\nfunction inlineDOMAtPos(parent, pos) {\n    let dom = parent.dom, { children } = parent, i = 0;\n    for (let off = 0; i < children.length; i++) {\n        let child = children[i], end = off + child.length;\n        if (end == off && child.getSide() <= 0)\n            continue;\n        if (pos > off && pos < end && child.dom.parentNode == dom)\n            return child.domAtPos(pos - off);\n        if (pos <= off)\n            break;\n        off = end;\n    }\n    for (let j = i; j > 0; j--) {\n        let prev = children[j - 1];\n        if (prev.dom.parentNode == dom)\n            return prev.domAtPos(prev.length);\n    }\n    for (let j = i; j < children.length; j++) {\n        let next = children[j];\n        if (next.dom.parentNode == dom)\n            return next.domAtPos(0);\n    }\n    return new DOMPos(dom, 0);\n}\n// Assumes `view`, if a mark view, has precisely 1 child.\nfunction joinInlineInto(parent, view, open) {\n    let last, { children } = parent;\n    if (open > 0 && view instanceof MarkView && children.length &&\n        (last = children[children.length - 1]) instanceof MarkView && last.mark.eq(view.mark)) {\n        joinInlineInto(last, view.children[0], open - 1);\n    }\n    else {\n        children.push(view);\n        view.setParent(parent);\n    }\n    parent.length += view.length;\n}\nfunction coordsInChildren(view, pos, side) {\n    let before = null, beforePos = -1, after = null, afterPos = -1;\n    function scan(view, pos) {\n        for (let i = 0, off = 0; i < view.children.length && off <= pos; i++) {\n            let child = view.children[i], end = off + child.length;\n            if (end >= pos) {\n                if (child.children.length) {\n                    scan(child, pos - off);\n                }\n                else if (!after && (end > pos || off == end && child.getSide() > 0)) {\n                    after = child;\n                    afterPos = pos - off;\n                }\n                else if (off < pos || (off == end && child.getSide() < 0)) {\n                    before = child;\n                    beforePos = pos - off;\n                }\n            }\n            off = end;\n        }\n    }\n    scan(view, pos);\n    let target = (side < 0 ? before : after) || before || after;\n    if (target)\n        return target.coordsAt(Math.max(0, target == before ? beforePos : afterPos), side);\n    return fallbackRect(view);\n}\nfunction fallbackRect(view) {\n    let last = view.dom.lastChild;\n    if (!last)\n        return view.dom.getBoundingClientRect();\n    let rects = clientRectsFor(last);\n    return rects[rects.length - 1] || null;\n}\n\nfunction combineAttrs(source, target) {\n    for (let name in source) {\n        if (name == \"class\" && target.class)\n            target.class += \" \" + source.class;\n        else if (name == \"style\" && target.style)\n            target.style += \";\" + source.style;\n        else\n            target[name] = source[name];\n    }\n    return target;\n}\nfunction attrsEq(a, b) {\n    if (a == b)\n        return true;\n    if (!a || !b)\n        return false;\n    let keysA = Object.keys(a), keysB = Object.keys(b);\n    if (keysA.length != keysB.length)\n        return false;\n    for (let key of keysA) {\n        if (keysB.indexOf(key) == -1 || a[key] !== b[key])\n            return false;\n    }\n    return true;\n}\nfunction updateAttrs(dom, prev, attrs) {\n    let changed = null;\n    if (prev)\n        for (let name in prev)\n            if (!(attrs && name in attrs))\n                dom.removeAttribute(changed = name);\n    if (attrs)\n        for (let name in attrs)\n            if (!(prev && prev[name] == attrs[name]))\n                dom.setAttribute(changed = name, attrs[name]);\n    return !!changed;\n}\n\n/**\nWidgets added to the content are described by subclasses of this\nclass. Using a description object like that makes it possible to\ndelay creating of the DOM structure for a widget until it is\nneeded, and to avoid redrawing widgets even if the decorations\nthat define them are recreated.\n*/\nclass WidgetType {\n    /**\n    Compare this instance to another instance of the same type.\n    (TypeScript can't express this, but only instances of the same\n    specific class will be passed to this method.) This is used to\n    avoid redrawing widgets when they are replaced by a new\n    decoration of the same type. The default implementation just\n    returns `false`, which will cause new instances of the widget to\n    always be redrawn.\n    */\n    eq(widget) { return false; }\n    /**\n    Update a DOM element created by a widget of the same type (but\n    different, non-`eq` content) to reflect this widget. May return\n    true to indicate that it could update, false to indicate it\n    couldn't (in which case the widget will be redrawn). The default\n    implementation just returns false.\n    */\n    updateDOM(dom, view) { return false; }\n    /**\n    @internal\n    */\n    compare(other) {\n        return this == other || this.constructor == other.constructor && this.eq(other);\n    }\n    /**\n    The estimated height this widget will have, to be used when\n    estimating the height of content that hasn't been drawn. May\n    return -1 to indicate you don't know. The default implementation\n    returns -1.\n    */\n    get estimatedHeight() { return -1; }\n    /**\n    Can be used to configure which kinds of events inside the widget\n    should be ignored by the editor. The default is to ignore all\n    events.\n    */\n    ignoreEvent(event) { return true; }\n    /**\n    @internal\n    */\n    get customView() { return null; }\n    /**\n    This is called when the an instance of the widget is removed\n    from the editor view.\n    */\n    destroy(dom) { }\n}\n/**\nThe different types of blocks that can occur in an editor view.\n*/\nvar BlockType = /*@__PURE__*/(function (BlockType) {\n    /**\n    A line of text.\n    */\n    BlockType[BlockType[\"Text\"] = 0] = \"Text\";\n    /**\n    A block widget associated with the position after it.\n    */\n    BlockType[BlockType[\"WidgetBefore\"] = 1] = \"WidgetBefore\";\n    /**\n    A block widget associated with the position before it.\n    */\n    BlockType[BlockType[\"WidgetAfter\"] = 2] = \"WidgetAfter\";\n    /**\n    A block widget [replacing](https://codemirror.net/6/docs/ref/#view.Decoration^replace) a range of content.\n    */\n    BlockType[BlockType[\"WidgetRange\"] = 3] = \"WidgetRange\";\nreturn BlockType})(BlockType || (BlockType = {}));\n/**\nA decoration provides information on how to draw or style a piece\nof content. You'll usually use it wrapped in a\n[`Range`](https://codemirror.net/6/docs/ref/#state.Range), which adds a start and end position.\n@nonabstract\n*/\nclass Decoration extends RangeValue {\n    constructor(\n    /**\n    @internal\n    */\n    startSide, \n    /**\n    @internal\n    */\n    endSide, \n    /**\n    @internal\n    */\n    widget, \n    /**\n    The config object used to create this decoration. You can\n    include additional properties in there to store metadata about\n    your decoration.\n    */\n    spec) {\n        super();\n        this.startSide = startSide;\n        this.endSide = endSide;\n        this.widget = widget;\n        this.spec = spec;\n    }\n    /**\n    @internal\n    */\n    get heightRelevant() { return false; }\n    /**\n    Create a mark decoration, which influences the styling of the\n    content in its range. Nested mark decorations will cause nested\n    DOM elements to be created. Nesting order is determined by\n    precedence of the [facet](https://codemirror.net/6/docs/ref/#view.EditorView^decorations), with\n    the higher-precedence decorations creating the inner DOM nodes.\n    Such elements are split on line boundaries and on the boundaries\n    of lower-precedence decorations.\n    */\n    static mark(spec) {\n        return new MarkDecoration(spec);\n    }\n    /**\n    Create a widget decoration, which displays a DOM element at the\n    given position.\n    */\n    static widget(spec) {\n        let side = spec.side || 0, block = !!spec.block;\n        side += block ? (side > 0 ? 300000000 /* Side.BlockAfter */ : -400000000 /* Side.BlockBefore */) : (side > 0 ? 100000000 /* Side.InlineAfter */ : -100000000 /* Side.InlineBefore */);\n        return new PointDecoration(spec, side, side, block, spec.widget || null, false);\n    }\n    /**\n    Create a replace decoration which replaces the given range with\n    a widget, or simply hides it.\n    */\n    static replace(spec) {\n        let block = !!spec.block, startSide, endSide;\n        if (spec.isBlockGap) {\n            startSide = -500000000 /* Side.GapStart */;\n            endSide = 400000000 /* Side.GapEnd */;\n        }\n        else {\n            let { start, end } = getInclusive(spec, block);\n            startSide = (start ? (block ? -300000000 /* Side.BlockIncStart */ : -1 /* Side.InlineIncStart */) : 500000000 /* Side.NonIncStart */) - 1;\n            endSide = (end ? (block ? 200000000 /* Side.BlockIncEnd */ : 1 /* Side.InlineIncEnd */) : -600000000 /* Side.NonIncEnd */) + 1;\n        }\n        return new PointDecoration(spec, startSide, endSide, block, spec.widget || null, true);\n    }\n    /**\n    Create a line decoration, which can add DOM attributes to the\n    line starting at the given position.\n    */\n    static line(spec) {\n        return new LineDecoration(spec);\n    }\n    /**\n    Build a [`DecorationSet`](https://codemirror.net/6/docs/ref/#view.DecorationSet) from the given\n    decorated range or ranges. If the ranges aren't already sorted,\n    pass `true` for `sort` to make the library sort them for you.\n    */\n    static set(of, sort = false) {\n        return RangeSet.of(of, sort);\n    }\n    /**\n    @internal\n    */\n    hasHeight() { return this.widget ? this.widget.estimatedHeight > -1 : false; }\n}\n/**\nThe empty set of decorations.\n*/\nDecoration.none = RangeSet.empty;\nclass MarkDecoration extends Decoration {\n    constructor(spec) {\n        let { start, end } = getInclusive(spec);\n        super(start ? -1 /* Side.InlineIncStart */ : 500000000 /* Side.NonIncStart */, end ? 1 /* Side.InlineIncEnd */ : -600000000 /* Side.NonIncEnd */, null, spec);\n        this.tagName = spec.tagName || \"span\";\n        this.class = spec.class || \"\";\n        this.attrs = spec.attributes || null;\n    }\n    eq(other) {\n        return this == other ||\n            other instanceof MarkDecoration &&\n                this.tagName == other.tagName &&\n                this.class == other.class &&\n                attrsEq(this.attrs, other.attrs);\n    }\n    range(from, to = from) {\n        if (from >= to)\n            throw new RangeError(\"Mark decorations may not be empty\");\n        return super.range(from, to);\n    }\n}\nMarkDecoration.prototype.point = false;\nclass LineDecoration extends Decoration {\n    constructor(spec) {\n        super(-200000000 /* Side.Line */, -200000000 /* Side.Line */, null, spec);\n    }\n    eq(other) {\n        return other instanceof LineDecoration &&\n            this.spec.class == other.spec.class &&\n            attrsEq(this.spec.attributes, other.spec.attributes);\n    }\n    range(from, to = from) {\n        if (to != from)\n            throw new RangeError(\"Line decoration ranges must be zero-length\");\n        return super.range(from, to);\n    }\n}\nLineDecoration.prototype.mapMode = MapMode.TrackBefore;\nLineDecoration.prototype.point = true;\nclass PointDecoration extends Decoration {\n    constructor(spec, startSide, endSide, block, widget, isReplace) {\n        super(startSide, endSide, widget, spec);\n        this.block = block;\n        this.isReplace = isReplace;\n        this.mapMode = !block ? MapMode.TrackDel : startSide <= 0 ? MapMode.TrackBefore : MapMode.TrackAfter;\n    }\n    // Only relevant when this.block == true\n    get type() {\n        return this.startSide < this.endSide ? BlockType.WidgetRange\n            : this.startSide <= 0 ? BlockType.WidgetBefore : BlockType.WidgetAfter;\n    }\n    get heightRelevant() { return this.block || !!this.widget && this.widget.estimatedHeight >= 5; }\n    eq(other) {\n        return other instanceof PointDecoration &&\n            widgetsEq(this.widget, other.widget) &&\n            this.block == other.block &&\n            this.startSide == other.startSide && this.endSide == other.endSide;\n    }\n    range(from, to = from) {\n        if (this.isReplace && (from > to || (from == to && this.startSide > 0 && this.endSide <= 0)))\n            throw new RangeError(\"Invalid range for replacement decoration\");\n        if (!this.isReplace && to != from)\n            throw new RangeError(\"Widget decorations can only have zero-length ranges\");\n        return super.range(from, to);\n    }\n}\nPointDecoration.prototype.point = true;\nfunction getInclusive(spec, block = false) {\n    let { inclusiveStart: start, inclusiveEnd: end } = spec;\n    if (start == null)\n        start = spec.inclusive;\n    if (end == null)\n        end = spec.inclusive;\n    return { start: start !== null && start !== void 0 ? start : block, end: end !== null && end !== void 0 ? end : block };\n}\nfunction widgetsEq(a, b) {\n    return a == b || !!(a && b && a.compare(b));\n}\nfunction addRange(from, to, ranges, margin = 0) {\n    let last = ranges.length - 1;\n    if (last >= 0 && ranges[last] + margin >= from)\n        ranges[last] = Math.max(ranges[last], to);\n    else\n        ranges.push(from, to);\n}\n\nclass LineView extends ContentView {\n    constructor() {\n        super(...arguments);\n        this.children = [];\n        this.length = 0;\n        this.prevAttrs = undefined;\n        this.attrs = null;\n        this.breakAfter = 0;\n    }\n    // Consumes source\n    merge(from, to, source, hasStart, openStart, openEnd) {\n        if (source) {\n            if (!(source instanceof LineView))\n                return false;\n            if (!this.dom)\n                source.transferDOM(this); // Reuse source.dom when appropriate\n        }\n        if (hasStart)\n            this.setDeco(source ? source.attrs : null);\n        mergeChildrenInto(this, from, to, source ? source.children : [], openStart, openEnd);\n        return true;\n    }\n    split(at) {\n        let end = new LineView;\n        end.breakAfter = this.breakAfter;\n        if (this.length == 0)\n            return end;\n        let { i, off } = this.childPos(at);\n        if (off) {\n            end.append(this.children[i].split(off), 0);\n            this.children[i].merge(off, this.children[i].length, null, false, 0, 0);\n            i++;\n        }\n        for (let j = i; j < this.children.length; j++)\n            end.append(this.children[j], 0);\n        while (i > 0 && this.children[i - 1].length == 0)\n            this.children[--i].destroy();\n        this.children.length = i;\n        this.markDirty();\n        this.length = at;\n        return end;\n    }\n    transferDOM(other) {\n        if (!this.dom)\n            return;\n        this.markDirty();\n        other.setDOM(this.dom);\n        other.prevAttrs = this.prevAttrs === undefined ? this.attrs : this.prevAttrs;\n        this.prevAttrs = undefined;\n        this.dom = null;\n    }\n    setDeco(attrs) {\n        if (!attrsEq(this.attrs, attrs)) {\n            if (this.dom) {\n                this.prevAttrs = this.attrs;\n                this.markDirty();\n            }\n            this.attrs = attrs;\n        }\n    }\n    append(child, openStart) {\n        joinInlineInto(this, child, openStart);\n    }\n    // Only called when building a line view in ContentBuilder\n    addLineDeco(deco) {\n        let attrs = deco.spec.attributes, cls = deco.spec.class;\n        if (attrs)\n            this.attrs = combineAttrs(attrs, this.attrs || {});\n        if (cls)\n            this.attrs = combineAttrs({ class: cls }, this.attrs || {});\n    }\n    domAtPos(pos) {\n        return inlineDOMAtPos(this, pos);\n    }\n    reuseDOM(node) {\n        if (node.nodeName == \"DIV\") {\n            this.setDOM(node);\n            this.dirty |= 4 /* Dirty.Attrs */ | 2 /* Dirty.Node */;\n        }\n    }\n    sync(view, track) {\n        var _a;\n        if (!this.dom) {\n            this.setDOM(document.createElement(\"div\"));\n            this.dom.className = \"cm-line\";\n            this.prevAttrs = this.attrs ? null : undefined;\n        }\n        else if (this.dirty & 4 /* Dirty.Attrs */) {\n            clearAttributes(this.dom);\n            this.dom.className = \"cm-line\";\n            this.prevAttrs = this.attrs ? null : undefined;\n        }\n        if (this.prevAttrs !== undefined) {\n            updateAttrs(this.dom, this.prevAttrs, this.attrs);\n            this.dom.classList.add(\"cm-line\");\n            this.prevAttrs = undefined;\n        }\n        super.sync(view, track);\n        let last = this.dom.lastChild;\n        while (last && ContentView.get(last) instanceof MarkView)\n            last = last.lastChild;\n        if (!last || !this.length ||\n            last.nodeName != \"BR\" && ((_a = ContentView.get(last)) === null || _a === void 0 ? void 0 : _a.isEditable) == false &&\n                (!browser.ios || !this.children.some(ch => ch instanceof TextView))) {\n            let hack = document.createElement(\"BR\");\n            hack.cmIgnore = true;\n            this.dom.appendChild(hack);\n        }\n    }\n    measureTextSize() {\n        if (this.children.length == 0 || this.length > 20)\n            return null;\n        let totalWidth = 0;\n        for (let child of this.children) {\n            if (!(child instanceof TextView) || /[^ -~]/.test(child.text))\n                return null;\n            let rects = clientRectsFor(child.dom);\n            if (rects.length != 1)\n                return null;\n            totalWidth += rects[0].width;\n        }\n        return !totalWidth ? null : {\n            lineHeight: this.dom.getBoundingClientRect().height,\n            charWidth: totalWidth / this.length\n        };\n    }\n    coordsAt(pos, side) {\n        return coordsInChildren(this, pos, side);\n    }\n    become(_other) { return false; }\n    get type() { return BlockType.Text; }\n    static find(docView, pos) {\n        for (let i = 0, off = 0; i < docView.children.length; i++) {\n            let block = docView.children[i], end = off + block.length;\n            if (end >= pos) {\n                if (block instanceof LineView)\n                    return block;\n                if (end > pos)\n                    break;\n            }\n            off = end + block.breakAfter;\n        }\n        return null;\n    }\n}\nclass BlockWidgetView extends ContentView {\n    constructor(widget, length, type) {\n        super();\n        this.widget = widget;\n        this.length = length;\n        this.type = type;\n        this.breakAfter = 0;\n        this.prevWidget = null;\n    }\n    merge(from, to, source, _takeDeco, openStart, openEnd) {\n        if (source && (!(source instanceof BlockWidgetView) || !this.widget.compare(source.widget) ||\n            from > 0 && openStart <= 0 || to < this.length && openEnd <= 0))\n            return false;\n        this.length = from + (source ? source.length : 0) + (this.length - to);\n        return true;\n    }\n    domAtPos(pos) {\n        return pos == 0 ? DOMPos.before(this.dom) : DOMPos.after(this.dom, pos == this.length);\n    }\n    split(at) {\n        let len = this.length - at;\n        this.length = at;\n        let end = new BlockWidgetView(this.widget, len, this.type);\n        end.breakAfter = this.breakAfter;\n        return end;\n    }\n    get children() { return noChildren; }\n    sync(view) {\n        if (!this.dom || !this.widget.updateDOM(this.dom, view)) {\n            if (this.dom && this.prevWidget)\n                this.prevWidget.destroy(this.dom);\n            this.prevWidget = null;\n            this.setDOM(this.widget.toDOM(view));\n            this.dom.contentEditable = \"false\";\n        }\n    }\n    get overrideDOMText() {\n        return this.parent ? this.parent.view.state.doc.slice(this.posAtStart, this.posAtEnd) : Text.empty;\n    }\n    domBoundsAround() { return null; }\n    become(other) {\n        if (other instanceof BlockWidgetView && other.type == this.type &&\n            other.widget.constructor == this.widget.constructor) {\n            if (!other.widget.eq(this.widget))\n                this.markDirty(true);\n            if (this.dom && !this.prevWidget)\n                this.prevWidget = this.widget;\n            this.widget = other.widget;\n            this.length = other.length;\n            this.breakAfter = other.breakAfter;\n            return true;\n        }\n        return false;\n    }\n    ignoreMutation() { return true; }\n    ignoreEvent(event) { return this.widget.ignoreEvent(event); }\n    get isEditable() { return false; }\n    get isWidget() { return true; }\n    destroy() {\n        super.destroy();\n        if (this.dom)\n            this.widget.destroy(this.dom);\n    }\n}\n\nclass ContentBuilder {\n    constructor(doc, pos, end, disallowBlockEffectsFor) {\n        this.doc = doc;\n        this.pos = pos;\n        this.end = end;\n        this.disallowBlockEffectsFor = disallowBlockEffectsFor;\n        this.content = [];\n        this.curLine = null;\n        this.breakAtStart = 0;\n        this.pendingBuffer = 0 /* Buf.No */;\n        this.bufferMarks = [];\n        // Set to false directly after a widget that covers the position after it\n        this.atCursorPos = true;\n        this.openStart = -1;\n        this.openEnd = -1;\n        this.text = \"\";\n        this.textOff = 0;\n        this.cursor = doc.iter();\n        this.skip = pos;\n    }\n    posCovered() {\n        if (this.content.length == 0)\n            return !this.breakAtStart && this.doc.lineAt(this.pos).from != this.pos;\n        let last = this.content[this.content.length - 1];\n        return !last.breakAfter && !(last instanceof BlockWidgetView && last.type == BlockType.WidgetBefore);\n    }\n    getLine() {\n        if (!this.curLine) {\n            this.content.push(this.curLine = new LineView);\n            this.atCursorPos = true;\n        }\n        return this.curLine;\n    }\n    flushBuffer(active = this.bufferMarks) {\n        if (this.pendingBuffer) {\n            this.curLine.append(wrapMarks(new WidgetBufferView(-1), active), active.length);\n            this.pendingBuffer = 0 /* Buf.No */;\n        }\n    }\n    addBlockWidget(view) {\n        this.flushBuffer();\n        this.curLine = null;\n        this.content.push(view);\n    }\n    finish(openEnd) {\n        if (this.pendingBuffer && openEnd <= this.bufferMarks.length)\n            this.flushBuffer();\n        else\n            this.pendingBuffer = 0 /* Buf.No */;\n        if (!this.posCovered())\n            this.getLine();\n    }\n    buildText(length, active, openStart) {\n        while (length > 0) {\n            if (this.textOff == this.text.length) {\n                let { value, lineBreak, done } = this.cursor.next(this.skip);\n                this.skip = 0;\n                if (done)\n                    throw new Error(\"Ran out of text content when drawing inline views\");\n                if (lineBreak) {\n                    if (!this.posCovered())\n                        this.getLine();\n                    if (this.content.length)\n                        this.content[this.content.length - 1].breakAfter = 1;\n                    else\n                        this.breakAtStart = 1;\n                    this.flushBuffer();\n                    this.curLine = null;\n                    this.atCursorPos = true;\n                    length--;\n                    continue;\n                }\n                else {\n                    this.text = value;\n                    this.textOff = 0;\n                }\n            }\n            let take = Math.min(this.text.length - this.textOff, length, 512 /* T.Chunk */);\n            this.flushBuffer(active.slice(active.length - openStart));\n            this.getLine().append(wrapMarks(new TextView(this.text.slice(this.textOff, this.textOff + take)), active), openStart);\n            this.atCursorPos = true;\n            this.textOff += take;\n            length -= take;\n            openStart = 0;\n        }\n    }\n    span(from, to, active, openStart) {\n        this.buildText(to - from, active, openStart);\n        this.pos = to;\n        if (this.openStart < 0)\n            this.openStart = openStart;\n    }\n    point(from, to, deco, active, openStart, index) {\n        if (this.disallowBlockEffectsFor[index] && deco instanceof PointDecoration) {\n            if (deco.block)\n                throw new RangeError(\"Block decorations may not be specified via plugins\");\n            if (to > this.doc.lineAt(this.pos).to)\n                throw new RangeError(\"Decorations that replace line breaks may not be specified via plugins\");\n        }\n        let len = to - from;\n        if (deco instanceof PointDecoration) {\n            if (deco.block) {\n                let { type } = deco;\n                if (type == BlockType.WidgetAfter && !this.posCovered())\n                    this.getLine();\n                this.addBlockWidget(new BlockWidgetView(deco.widget || new NullWidget(\"div\"), len, type));\n            }\n            else {\n                let view = WidgetView.create(deco.widget || new NullWidget(\"span\"), len, len ? 0 : deco.startSide);\n                let cursorBefore = this.atCursorPos && !view.isEditable && openStart <= active.length && (from < to || deco.startSide > 0);\n                let cursorAfter = !view.isEditable && (from < to || openStart > active.length || deco.startSide <= 0);\n                let line = this.getLine();\n                if (this.pendingBuffer == 2 /* Buf.IfCursor */ && !cursorBefore)\n                    this.pendingBuffer = 0 /* Buf.No */;\n                this.flushBuffer(active);\n                if (cursorBefore) {\n                    line.append(wrapMarks(new WidgetBufferView(1), active), openStart);\n                    openStart = active.length + Math.max(0, openStart - active.length);\n                }\n                line.append(wrapMarks(view, active), openStart);\n                this.atCursorPos = cursorAfter;\n                this.pendingBuffer = !cursorAfter ? 0 /* Buf.No */ : from < to || openStart > active.length ? 1 /* Buf.Yes */ : 2 /* Buf.IfCursor */;\n                if (this.pendingBuffer)\n                    this.bufferMarks = active.slice();\n            }\n        }\n        else if (this.doc.lineAt(this.pos).from == this.pos) { // Line decoration\n            this.getLine().addLineDeco(deco);\n        }\n        if (len) {\n            // Advance the iterator past the replaced content\n            if (this.textOff + len <= this.text.length) {\n                this.textOff += len;\n            }\n            else {\n                this.skip += len - (this.text.length - this.textOff);\n                this.text = \"\";\n                this.textOff = 0;\n            }\n            this.pos = to;\n        }\n        if (this.openStart < 0)\n            this.openStart = openStart;\n    }\n    static build(text, from, to, decorations, dynamicDecorationMap) {\n        let builder = new ContentBuilder(text, from, to, dynamicDecorationMap);\n        builder.openEnd = RangeSet.spans(decorations, from, to, builder);\n        if (builder.openStart < 0)\n            builder.openStart = builder.openEnd;\n        builder.finish(builder.openEnd);\n        return builder;\n    }\n}\nfunction wrapMarks(view, active) {\n    for (let mark of active)\n        view = new MarkView(mark, [view], view.length);\n    return view;\n}\nclass NullWidget extends WidgetType {\n    constructor(tag) {\n        super();\n        this.tag = tag;\n    }\n    eq(other) { return other.tag == this.tag; }\n    toDOM() { return document.createElement(this.tag); }\n    updateDOM(elt) { return elt.nodeName.toLowerCase() == this.tag; }\n}\n\nconst clickAddsSelectionRange = /*@__PURE__*/Facet.define();\nconst dragMovesSelection$1 = /*@__PURE__*/Facet.define();\nconst mouseSelectionStyle = /*@__PURE__*/Facet.define();\nconst exceptionSink = /*@__PURE__*/Facet.define();\nconst updateListener = /*@__PURE__*/Facet.define();\nconst inputHandler = /*@__PURE__*/Facet.define();\nconst focusChangeEffect = /*@__PURE__*/Facet.define();\nconst perLineTextDirection = /*@__PURE__*/Facet.define({\n    combine: values => values.some(x => x)\n});\nconst nativeSelectionHidden = /*@__PURE__*/Facet.define({\n    combine: values => values.some(x => x)\n});\nclass ScrollTarget {\n    constructor(range, y = \"nearest\", x = \"nearest\", yMargin = 5, xMargin = 5) {\n        this.range = range;\n        this.y = y;\n        this.x = x;\n        this.yMargin = yMargin;\n        this.xMargin = xMargin;\n    }\n    map(changes) {\n        return changes.empty ? this : new ScrollTarget(this.range.map(changes), this.y, this.x, this.yMargin, this.xMargin);\n    }\n}\nconst scrollIntoView = /*@__PURE__*/StateEffect.define({ map: (t, ch) => t.map(ch) });\n/**\nLog or report an unhandled exception in client code. Should\nprobably only be used by extension code that allows client code to\nprovide functions, and calls those functions in a context where an\nexception can't be propagated to calling code in a reasonable way\n(for example when in an event handler).\n\nEither calls a handler registered with\n[`EditorView.exceptionSink`](https://codemirror.net/6/docs/ref/#view.EditorView^exceptionSink),\n`window.onerror`, if defined, or `console.error` (in which case\nit'll pass `context`, when given, as first argument).\n*/\nfunction logException(state, exception, context) {\n    let handler = state.facet(exceptionSink);\n    if (handler.length)\n        handler[0](exception);\n    else if (window.onerror)\n        window.onerror(String(exception), context, undefined, undefined, exception);\n    else if (context)\n        console.error(context + \":\", exception);\n    else\n        console.error(exception);\n}\nconst editable = /*@__PURE__*/Facet.define({ combine: values => values.length ? values[0] : true });\nlet nextPluginID = 0;\nconst viewPlugin = /*@__PURE__*/Facet.define();\n/**\nView plugins associate stateful values with a view. They can\ninfluence the way the content is drawn, and are notified of things\nthat happen in the view.\n*/\nclass ViewPlugin {\n    constructor(\n    /**\n    @internal\n    */\n    id, \n    /**\n    @internal\n    */\n    create, \n    /**\n    @internal\n    */\n    domEventHandlers, buildExtensions) {\n        this.id = id;\n        this.create = create;\n        this.domEventHandlers = domEventHandlers;\n        this.extension = buildExtensions(this);\n    }\n    /**\n    Define a plugin from a constructor function that creates the\n    plugin's value, given an editor view.\n    */\n    static define(create, spec) {\n        const { eventHandlers, provide, decorations: deco } = spec || {};\n        return new ViewPlugin(nextPluginID++, create, eventHandlers, plugin => {\n            let ext = [viewPlugin.of(plugin)];\n            if (deco)\n                ext.push(decorations.of(view => {\n                    let pluginInst = view.plugin(plugin);\n                    return pluginInst ? deco(pluginInst) : Decoration.none;\n                }));\n            if (provide)\n                ext.push(provide(plugin));\n            return ext;\n        });\n    }\n    /**\n    Create a plugin for a class whose constructor takes a single\n    editor view as argument.\n    */\n    static fromClass(cls, spec) {\n        return ViewPlugin.define(view => new cls(view), spec);\n    }\n}\nclass PluginInstance {\n    constructor(spec) {\n        this.spec = spec;\n        // When starting an update, all plugins have this field set to the\n        // update object, indicating they need to be updated. When finished\n        // updating, it is set to `false`. Retrieving a plugin that needs to\n        // be updated with `view.plugin` forces an eager update.\n        this.mustUpdate = null;\n        // This is null when the plugin is initially created, but\n        // initialized on the first update.\n        this.value = null;\n    }\n    update(view) {\n        if (!this.value) {\n            if (this.spec) {\n                try {\n                    this.value = this.spec.create(view);\n                }\n                catch (e) {\n                    logException(view.state, e, \"CodeMirror plugin crashed\");\n                    this.deactivate();\n                }\n            }\n        }\n        else if (this.mustUpdate) {\n            let update = this.mustUpdate;\n            this.mustUpdate = null;\n            if (this.value.update) {\n                try {\n                    this.value.update(update);\n                }\n                catch (e) {\n                    logException(update.state, e, \"CodeMirror plugin crashed\");\n                    if (this.value.destroy)\n                        try {\n                            this.value.destroy();\n                        }\n                        catch (_) { }\n                    this.deactivate();\n                }\n            }\n        }\n        return this;\n    }\n    destroy(view) {\n        var _a;\n        if ((_a = this.value) === null || _a === void 0 ? void 0 : _a.destroy) {\n            try {\n                this.value.destroy();\n            }\n            catch (e) {\n                logException(view.state, e, \"CodeMirror plugin crashed\");\n            }\n        }\n    }\n    deactivate() {\n        this.spec = this.value = null;\n    }\n}\nconst editorAttributes = /*@__PURE__*/Facet.define();\nconst contentAttributes = /*@__PURE__*/Facet.define();\n// Provide decorations\nconst decorations = /*@__PURE__*/Facet.define();\nconst atomicRanges = /*@__PURE__*/Facet.define();\nconst scrollMargins = /*@__PURE__*/Facet.define();\nconst styleModule = /*@__PURE__*/Facet.define();\nclass ChangedRange {\n    constructor(fromA, toA, fromB, toB) {\n        this.fromA = fromA;\n        this.toA = toA;\n        this.fromB = fromB;\n        this.toB = toB;\n    }\n    join(other) {\n        return new ChangedRange(Math.min(this.fromA, other.fromA), Math.max(this.toA, other.toA), Math.min(this.fromB, other.fromB), Math.max(this.toB, other.toB));\n    }\n    addToSet(set) {\n        let i = set.length, me = this;\n        for (; i > 0; i--) {\n            let range = set[i - 1];\n            if (range.fromA > me.toA)\n                continue;\n            if (range.toA < me.fromA)\n                break;\n            me = me.join(range);\n            set.splice(i - 1, 1);\n        }\n        set.splice(i, 0, me);\n        return set;\n    }\n    static extendWithRanges(diff, ranges) {\n        if (ranges.length == 0)\n            return diff;\n        let result = [];\n        for (let dI = 0, rI = 0, posA = 0, posB = 0;; dI++) {\n            let next = dI == diff.length ? null : diff[dI], off = posA - posB;\n            let end = next ? next.fromB : 1e9;\n            while (rI < ranges.length && ranges[rI] < end) {\n                let from = ranges[rI], to = ranges[rI + 1];\n                let fromB = Math.max(posB, from), toB = Math.min(end, to);\n                if (fromB <= toB)\n                    new ChangedRange(fromB + off, toB + off, fromB, toB).addToSet(result);\n                if (to > end)\n                    break;\n                else\n                    rI += 2;\n            }\n            if (!next)\n                return result;\n            new ChangedRange(next.fromA, next.toA, next.fromB, next.toB).addToSet(result);\n            posA = next.toA;\n            posB = next.toB;\n        }\n    }\n}\n/**\nView [plugins](https://codemirror.net/6/docs/ref/#view.ViewPlugin) are given instances of this\nclass, which describe what happened, whenever the view is updated.\n*/\nclass ViewUpdate {\n    constructor(\n    /**\n    The editor view that the update is associated with.\n    */\n    view, \n    /**\n    The new editor state.\n    */\n    state, \n    /**\n    The transactions involved in the update. May be empty.\n    */\n    transactions) {\n        this.view = view;\n        this.state = state;\n        this.transactions = transactions;\n        /**\n        @internal\n        */\n        this.flags = 0;\n        this.startState = view.state;\n        this.changes = ChangeSet.empty(this.startState.doc.length);\n        for (let tr of transactions)\n            this.changes = this.changes.compose(tr.changes);\n        let changedRanges = [];\n        this.changes.iterChangedRanges((fromA, toA, fromB, toB) => changedRanges.push(new ChangedRange(fromA, toA, fromB, toB)));\n        this.changedRanges = changedRanges;\n    }\n    /**\n    @internal\n    */\n    static create(view, state, transactions) {\n        return new ViewUpdate(view, state, transactions);\n    }\n    /**\n    Tells you whether the [viewport](https://codemirror.net/6/docs/ref/#view.EditorView.viewport) or\n    [visible ranges](https://codemirror.net/6/docs/ref/#view.EditorView.visibleRanges) changed in this\n    update.\n    */\n    get viewportChanged() {\n        return (this.flags & 4 /* UpdateFlag.Viewport */) > 0;\n    }\n    /**\n    Indicates whether the height of a block element in the editor\n    changed in this update.\n    */\n    get heightChanged() {\n        return (this.flags & 2 /* UpdateFlag.Height */) > 0;\n    }\n    /**\n    Returns true when the document was modified or the size of the\n    editor, or elements within the editor, changed.\n    */\n    get geometryChanged() {\n        return this.docChanged || (this.flags & (8 /* UpdateFlag.Geometry */ | 2 /* UpdateFlag.Height */)) > 0;\n    }\n    /**\n    True when this update indicates a focus change.\n    */\n    get focusChanged() {\n        return (this.flags & 1 /* UpdateFlag.Focus */) > 0;\n    }\n    /**\n    Whether the document changed in this update.\n    */\n    get docChanged() {\n        return !this.changes.empty;\n    }\n    /**\n    Whether the selection was explicitly set in this update.\n    */\n    get selectionSet() {\n        return this.transactions.some(tr => tr.selection);\n    }\n    /**\n    @internal\n    */\n    get empty() { return this.flags == 0 && this.transactions.length == 0; }\n}\n\n/**\nUsed to indicate [text direction](https://codemirror.net/6/docs/ref/#view.EditorView.textDirection).\n*/\nvar Direction = /*@__PURE__*/(function (Direction) {\n    // (These are chosen to match the base levels, in bidi algorithm\n    // terms, of spans in that direction.)\n    /**\n    Left-to-right.\n    */\n    Direction[Direction[\"LTR\"] = 0] = \"LTR\";\n    /**\n    Right-to-left.\n    */\n    Direction[Direction[\"RTL\"] = 1] = \"RTL\";\nreturn Direction})(Direction || (Direction = {}));\nconst LTR = Direction.LTR, RTL = Direction.RTL;\n// Decode a string with each type encoded as log2(type)\nfunction dec(str) {\n    let result = [];\n    for (let i = 0; i < str.length; i++)\n        result.push(1 << +str[i]);\n    return result;\n}\n// Character types for codepoints 0 to 0xf8\nconst LowTypes = /*@__PURE__*/dec(\"88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008\");\n// Character types for codepoints 0x600 to 0x6f9\nconst ArabicTypes = /*@__PURE__*/dec(\"4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333\");\nconst Brackets = /*@__PURE__*/Object.create(null), BracketStack = [];\n// There's a lot more in\n// https://www.unicode.org/Public/UCD/latest/ucd/BidiBrackets.txt,\n// which are left out to keep code size down.\nfor (let p of [\"()\", \"[]\", \"{}\"]) {\n    let l = /*@__PURE__*/p.charCodeAt(0), r = /*@__PURE__*/p.charCodeAt(1);\n    Brackets[l] = r;\n    Brackets[r] = -l;\n}\nfunction charType(ch) {\n    return ch <= 0xf7 ? LowTypes[ch] :\n        0x590 <= ch && ch <= 0x5f4 ? 2 /* T.R */ :\n            0x600 <= ch && ch <= 0x6f9 ? ArabicTypes[ch - 0x600] :\n                0x6ee <= ch && ch <= 0x8ac ? 4 /* T.AL */ :\n                    0x2000 <= ch && ch <= 0x200b ? 256 /* T.NI */ :\n                        0xfb50 <= ch && ch <= 0xfdff ? 4 /* T.AL */ :\n                            ch == 0x200c ? 256 /* T.NI */ : 1 /* T.L */;\n}\nconst BidiRE = /[\\u0590-\\u05f4\\u0600-\\u06ff\\u0700-\\u08ac\\ufb50-\\ufdff]/;\n/**\nRepresents a contiguous range of text that has a single direction\n(as in left-to-right or right-to-left).\n*/\nclass BidiSpan {\n    /**\n    @internal\n    */\n    constructor(\n    /**\n    The start of the span (relative to the start of the line).\n    */\n    from, \n    /**\n    The end of the span.\n    */\n    to, \n    /**\n    The [\"bidi\n    level\"](https://unicode.org/reports/tr9/#Basic_Display_Algorithm)\n    of the span (in this context, 0 means\n    left-to-right, 1 means right-to-left, 2 means left-to-right\n    number inside right-to-left text).\n    */\n    level) {\n        this.from = from;\n        this.to = to;\n        this.level = level;\n    }\n    /**\n    The direction of this span.\n    */\n    get dir() { return this.level % 2 ? RTL : LTR; }\n    /**\n    @internal\n    */\n    side(end, dir) { return (this.dir == dir) == end ? this.to : this.from; }\n    /**\n    @internal\n    */\n    static find(order, index, level, assoc) {\n        let maybe = -1;\n        for (let i = 0; i < order.length; i++) {\n            let span = order[i];\n            if (span.from <= index && span.to >= index) {\n                if (span.level == level)\n                    return i;\n                // When multiple spans match, if assoc != 0, take the one that\n                // covers that side, otherwise take the one with the minimum\n                // level.\n                if (maybe < 0 || (assoc != 0 ? (assoc < 0 ? span.from < index : span.to > index) : order[maybe].level > span.level))\n                    maybe = i;\n            }\n        }\n        if (maybe < 0)\n            throw new RangeError(\"Index out of range\");\n        return maybe;\n    }\n}\n// Reused array of character types\nconst types = [];\nfunction computeOrder(line, direction) {\n    let len = line.length, outerType = direction == LTR ? 1 /* T.L */ : 2 /* T.R */, oppositeType = direction == LTR ? 2 /* T.R */ : 1 /* T.L */;\n    if (!line || outerType == 1 /* T.L */ && !BidiRE.test(line))\n        return trivialOrder(len);\n    // W1. Examine each non-spacing mark (NSM) in the level run, and\n    // change the type of the NSM to the type of the previous\n    // character. If the NSM is at the start of the level run, it will\n    // get the type of sor.\n    // W2. Search backwards from each instance of a European number\n    // until the first strong type (R, L, AL, or sor) is found. If an\n    // AL is found, change the type of the European number to Arabic\n    // number.\n    // W3. Change all ALs to R.\n    // (Left after this: L, R, EN, AN, ET, CS, NI)\n    for (let i = 0, prev = outerType, prevStrong = outerType; i < len; i++) {\n        let type = charType(line.charCodeAt(i));\n        if (type == 512 /* T.NSM */)\n            type = prev;\n        else if (type == 8 /* T.EN */ && prevStrong == 4 /* T.AL */)\n            type = 16 /* T.AN */;\n        types[i] = type == 4 /* T.AL */ ? 2 /* T.R */ : type;\n        if (type & 7 /* T.Strong */)\n            prevStrong = type;\n        prev = type;\n    }\n    // W5. A sequence of European terminators adjacent to European\n    // numbers changes to all European numbers.\n    // W6. Otherwise, separators and terminators change to Other\n    // Neutral.\n    // W7. Search backwards from each instance of a European number\n    // until the first strong type (R, L, or sor) is found. If an L is\n    // found, then change the type of the European number to L.\n    // (Left after this: L, R, EN+AN, NI)\n    for (let i = 0, prev = outerType, prevStrong = outerType; i < len; i++) {\n        let type = types[i];\n        if (type == 128 /* T.CS */) {\n            if (i < len - 1 && prev == types[i + 1] && (prev & 24 /* T.Num */))\n                type = types[i] = prev;\n            else\n                types[i] = 256 /* T.NI */;\n        }\n        else if (type == 64 /* T.ET */) {\n            let end = i + 1;\n            while (end < len && types[end] == 64 /* T.ET */)\n                end++;\n            let replace = (i && prev == 8 /* T.EN */) || (end < len && types[end] == 8 /* T.EN */) ? (prevStrong == 1 /* T.L */ ? 1 /* T.L */ : 8 /* T.EN */) : 256 /* T.NI */;\n            for (let j = i; j < end; j++)\n                types[j] = replace;\n            i = end - 1;\n        }\n        else if (type == 8 /* T.EN */ && prevStrong == 1 /* T.L */) {\n            types[i] = 1 /* T.L */;\n        }\n        prev = type;\n        if (type & 7 /* T.Strong */)\n            prevStrong = type;\n    }\n    // N0. Process bracket pairs in an isolating run sequence\n    // sequentially in the logical order of the text positions of the\n    // opening paired brackets using the logic given below. Within this\n    // scope, bidirectional types EN and AN are treated as R.\n    for (let i = 0, sI = 0, context = 0, ch, br, type; i < len; i++) {\n        // Keeps [startIndex, type, strongSeen] triples for each open\n        // bracket on BracketStack.\n        if (br = Brackets[ch = line.charCodeAt(i)]) {\n            if (br < 0) { // Closing bracket\n                for (let sJ = sI - 3; sJ >= 0; sJ -= 3) {\n                    if (BracketStack[sJ + 1] == -br) {\n                        let flags = BracketStack[sJ + 2];\n                        let type = (flags & 2 /* Bracketed.EmbedInside */) ? outerType :\n                            !(flags & 4 /* Bracketed.OppositeInside */) ? 0 :\n                                (flags & 1 /* Bracketed.OppositeBefore */) ? oppositeType : outerType;\n                        if (type)\n                            types[i] = types[BracketStack[sJ]] = type;\n                        sI = sJ;\n                        break;\n                    }\n                }\n            }\n            else if (BracketStack.length == 189 /* Bracketed.MaxDepth */) {\n                break;\n            }\n            else {\n                BracketStack[sI++] = i;\n                BracketStack[sI++] = ch;\n                BracketStack[sI++] = context;\n            }\n        }\n        else if ((type = types[i]) == 2 /* T.R */ || type == 1 /* T.L */) {\n            let embed = type == outerType;\n            context = embed ? 0 : 1 /* Bracketed.OppositeBefore */;\n            for (let sJ = sI - 3; sJ >= 0; sJ -= 3) {\n                let cur = BracketStack[sJ + 2];\n                if (cur & 2 /* Bracketed.EmbedInside */)\n                    break;\n                if (embed) {\n                    BracketStack[sJ + 2] |= 2 /* Bracketed.EmbedInside */;\n                }\n                else {\n                    if (cur & 4 /* Bracketed.OppositeInside */)\n                        break;\n                    BracketStack[sJ + 2] |= 4 /* Bracketed.OppositeInside */;\n                }\n            }\n        }\n    }\n    // N1. A sequence of neutrals takes the direction of the\n    // surrounding strong text if the text on both sides has the same\n    // direction. European and Arabic numbers act as if they were R in\n    // terms of their influence on neutrals. Start-of-level-run (sor)\n    // and end-of-level-run (eor) are used at level run boundaries.\n    // N2. Any remaining neutrals take the embedding direction.\n    // (Left after this: L, R, EN+AN)\n    for (let i = 0; i < len; i++) {\n        if (types[i] == 256 /* T.NI */) {\n            let end = i + 1;\n            while (end < len && types[end] == 256 /* T.NI */)\n                end++;\n            let beforeL = (i ? types[i - 1] : outerType) == 1 /* T.L */;\n            let afterL = (end < len ? types[end] : outerType) == 1 /* T.L */;\n            let replace = beforeL == afterL ? (beforeL ? 1 /* T.L */ : 2 /* T.R */) : outerType;\n            for (let j = i; j < end; j++)\n                types[j] = replace;\n            i = end - 1;\n        }\n    }\n    // Here we depart from the documented algorithm, in order to avoid\n    // building up an actual levels array. Since there are only three\n    // levels (0, 1, 2) in an implementation that doesn't take\n    // explicit embedding into account, we can build up the order on\n    // the fly, without following the level-based algorithm.\n    let order = [];\n    if (outerType == 1 /* T.L */) {\n        for (let i = 0; i < len;) {\n            let start = i, rtl = types[i++] != 1 /* T.L */;\n            while (i < len && rtl == (types[i] != 1 /* T.L */))\n                i++;\n            if (rtl) {\n                for (let j = i; j > start;) {\n                    let end = j, l = types[--j] != 2 /* T.R */;\n                    while (j > start && l == (types[j - 1] != 2 /* T.R */))\n                        j--;\n                    order.push(new BidiSpan(j, end, l ? 2 : 1));\n                }\n            }\n            else {\n                order.push(new BidiSpan(start, i, 0));\n            }\n        }\n    }\n    else {\n        for (let i = 0; i < len;) {\n            let start = i, rtl = types[i++] == 2 /* T.R */;\n            while (i < len && rtl == (types[i] == 2 /* T.R */))\n                i++;\n            order.push(new BidiSpan(start, i, rtl ? 1 : 2));\n        }\n    }\n    return order;\n}\nfunction trivialOrder(length) {\n    return [new BidiSpan(0, length, 0)];\n}\nlet movedOver = \"\";\nfunction moveVisually(line, order, dir, start, forward) {\n    var _a;\n    let startIndex = start.head - line.from, spanI = -1;\n    if (startIndex == 0) {\n        if (!forward || !line.length)\n            return null;\n        if (order[0].level != dir) {\n            startIndex = order[0].side(false, dir);\n            spanI = 0;\n        }\n    }\n    else if (startIndex == line.length) {\n        if (forward)\n            return null;\n        let last = order[order.length - 1];\n        if (last.level != dir) {\n            startIndex = last.side(true, dir);\n            spanI = order.length - 1;\n        }\n    }\n    if (spanI < 0)\n        spanI = BidiSpan.find(order, startIndex, (_a = start.bidiLevel) !== null && _a !== void 0 ? _a : -1, start.assoc);\n    let span = order[spanI];\n    // End of span. (But not end of line--that was checked for above.)\n    if (startIndex == span.side(forward, dir)) {\n        span = order[spanI += forward ? 1 : -1];\n        startIndex = span.side(!forward, dir);\n    }\n    let indexForward = forward == (span.dir == dir);\n    let nextIndex = findClusterBreak(line.text, startIndex, indexForward);\n    movedOver = line.text.slice(Math.min(startIndex, nextIndex), Math.max(startIndex, nextIndex));\n    if (nextIndex != span.side(forward, dir))\n        return EditorSelection.cursor(nextIndex + line.from, indexForward ? -1 : 1, span.level);\n    let nextSpan = spanI == (forward ? order.length - 1 : 0) ? null : order[spanI + (forward ? 1 : -1)];\n    if (!nextSpan && span.level != dir)\n        return EditorSelection.cursor(forward ? line.to : line.from, forward ? -1 : 1, dir);\n    if (nextSpan && nextSpan.level < span.level)\n        return EditorSelection.cursor(nextSpan.side(!forward, dir) + line.from, forward ? 1 : -1, nextSpan.level);\n    return EditorSelection.cursor(nextIndex + line.from, forward ? -1 : 1, span.level);\n}\n\nconst LineBreakPlaceholder = \"\\uffff\";\nclass DOMReader {\n    constructor(points, state) {\n        this.points = points;\n        this.text = \"\";\n        this.lineSeparator = state.facet(EditorState.lineSeparator);\n    }\n    append(text) {\n        this.text += text;\n    }\n    lineBreak() {\n        this.text += LineBreakPlaceholder;\n    }\n    readRange(start, end) {\n        if (!start)\n            return this;\n        let parent = start.parentNode;\n        for (let cur = start;;) {\n            this.findPointBefore(parent, cur);\n            this.readNode(cur);\n            let next = cur.nextSibling;\n            if (next == end)\n                break;\n            let view = ContentView.get(cur), nextView = ContentView.get(next);\n            if (view && nextView ? view.breakAfter :\n                (view ? view.breakAfter : isBlockElement(cur)) ||\n                    (isBlockElement(next) && (cur.nodeName != \"BR\" || cur.cmIgnore)))\n                this.lineBreak();\n            cur = next;\n        }\n        this.findPointBefore(parent, end);\n        return this;\n    }\n    readTextNode(node) {\n        let text = node.nodeValue;\n        for (let point of this.points)\n            if (point.node == node)\n                point.pos = this.text.length + Math.min(point.offset, text.length);\n        for (let off = 0, re = this.lineSeparator ? null : /\\r\\n?|\\n/g;;) {\n            let nextBreak = -1, breakSize = 1, m;\n            if (this.lineSeparator) {\n                nextBreak = text.indexOf(this.lineSeparator, off);\n                breakSize = this.lineSeparator.length;\n            }\n            else if (m = re.exec(text)) {\n                nextBreak = m.index;\n                breakSize = m[0].length;\n            }\n            this.append(text.slice(off, nextBreak < 0 ? text.length : nextBreak));\n            if (nextBreak < 0)\n                break;\n            this.lineBreak();\n            if (breakSize > 1)\n                for (let point of this.points)\n                    if (point.node == node && point.pos > this.text.length)\n                        point.pos -= breakSize - 1;\n            off = nextBreak + breakSize;\n        }\n    }\n    readNode(node) {\n        if (node.cmIgnore)\n            return;\n        let view = ContentView.get(node);\n        let fromView = view && view.overrideDOMText;\n        if (fromView != null) {\n            this.findPointInside(node, fromView.length);\n            for (let i = fromView.iter(); !i.next().done;) {\n                if (i.lineBreak)\n                    this.lineBreak();\n                else\n                    this.append(i.value);\n            }\n        }\n        else if (node.nodeType == 3) {\n            this.readTextNode(node);\n        }\n        else if (node.nodeName == \"BR\") {\n            if (node.nextSibling)\n                this.lineBreak();\n        }\n        else if (node.nodeType == 1) {\n            this.readRange(node.firstChild, null);\n        }\n    }\n    findPointBefore(node, next) {\n        for (let point of this.points)\n            if (point.node == node && node.childNodes[point.offset] == next)\n                point.pos = this.text.length;\n    }\n    findPointInside(node, maxLen) {\n        for (let point of this.points)\n            if (node.nodeType == 3 ? point.node == node : node.contains(point.node))\n                point.pos = this.text.length + Math.min(maxLen, point.offset);\n    }\n}\nfunction isBlockElement(node) {\n    return node.nodeType == 1 && /^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\\d|SECTION|PRE)$/.test(node.nodeName);\n}\nclass DOMPoint {\n    constructor(node, offset) {\n        this.node = node;\n        this.offset = offset;\n        this.pos = -1;\n    }\n}\n\nclass DocView extends ContentView {\n    constructor(view) {\n        super();\n        this.view = view;\n        this.compositionDeco = Decoration.none;\n        this.decorations = [];\n        this.dynamicDecorationMap = [];\n        // Track a minimum width for the editor. When measuring sizes in\n        // measureVisibleLineHeights, this is updated to point at the width\n        // of a given element and its extent in the document. When a change\n        // happens in that range, these are reset. That way, once we've seen\n        // a line/element of a given length, we keep the editor wide enough\n        // to fit at least that element, until it is changed, at which point\n        // we forget it again.\n        this.minWidth = 0;\n        this.minWidthFrom = 0;\n        this.minWidthTo = 0;\n        // Track whether the DOM selection was set in a lossy way, so that\n        // we don't mess it up when reading it back it\n        this.impreciseAnchor = null;\n        this.impreciseHead = null;\n        this.forceSelection = false;\n        // Used by the resize observer to ignore resizes that we caused\n        // ourselves\n        this.lastUpdate = Date.now();\n        this.setDOM(view.contentDOM);\n        this.children = [new LineView];\n        this.children[0].setParent(this);\n        this.updateDeco();\n        this.updateInner([new ChangedRange(0, 0, 0, view.state.doc.length)], 0);\n    }\n    get length() { return this.view.state.doc.length; }\n    // Update the document view to a given state. scrollIntoView can be\n    // used as a hint to compute a new viewport that includes that\n    // position, if we know the editor is going to scroll that position\n    // into view.\n    update(update) {\n        let changedRanges = update.changedRanges;\n        if (this.minWidth > 0 && changedRanges.length) {\n            if (!changedRanges.every(({ fromA, toA }) => toA < this.minWidthFrom || fromA > this.minWidthTo)) {\n                this.minWidth = this.minWidthFrom = this.minWidthTo = 0;\n            }\n            else {\n                this.minWidthFrom = update.changes.mapPos(this.minWidthFrom, 1);\n                this.minWidthTo = update.changes.mapPos(this.minWidthTo, 1);\n            }\n        }\n        if (this.view.inputState.composing < 0)\n            this.compositionDeco = Decoration.none;\n        else if (update.transactions.length || this.dirty)\n            this.compositionDeco = computeCompositionDeco(this.view, update.changes);\n        // When the DOM nodes around the selection are moved to another\n        // parent, Chrome sometimes reports a different selection through\n        // getSelection than the one that it actually shows to the user.\n        // This forces a selection update when lines are joined to work\n        // around that. Issue #54\n        if ((browser.ie || browser.chrome) && !this.compositionDeco.size && update &&\n            update.state.doc.lines != update.startState.doc.lines)\n            this.forceSelection = true;\n        let prevDeco = this.decorations, deco = this.updateDeco();\n        let decoDiff = findChangedDeco(prevDeco, deco, update.changes);\n        changedRanges = ChangedRange.extendWithRanges(changedRanges, decoDiff);\n        if (this.dirty == 0 /* Dirty.Not */ && changedRanges.length == 0) {\n            return false;\n        }\n        else {\n            this.updateInner(changedRanges, update.startState.doc.length);\n            if (update.transactions.length)\n                this.lastUpdate = Date.now();\n            return true;\n        }\n    }\n    // Used by update and the constructor do perform the actual DOM\n    // update\n    updateInner(changes, oldLength) {\n        this.view.viewState.mustMeasureContent = true;\n        this.updateChildren(changes, oldLength);\n        let { observer } = this.view;\n        observer.ignore(() => {\n            // Lock the height during redrawing, since Chrome sometimes\n            // messes with the scroll position during DOM mutation (though\n            // no relayout is triggered and I cannot imagine how it can\n            // recompute the scroll position without a layout)\n            this.dom.style.height = this.view.viewState.contentHeight + \"px\";\n            this.dom.style.flexBasis = this.minWidth ? this.minWidth + \"px\" : \"\";\n            // Chrome will sometimes, when DOM mutations occur directly\n            // around the selection, get confused and report a different\n            // selection from the one it displays (issue #218). This tries\n            // to detect that situation.\n            let track = browser.chrome || browser.ios ? { node: observer.selectionRange.focusNode, written: false } : undefined;\n            this.sync(this.view, track);\n            this.dirty = 0 /* Dirty.Not */;\n            if (track && (track.written || observer.selectionRange.focusNode != track.node))\n                this.forceSelection = true;\n            this.dom.style.height = \"\";\n        });\n        let gaps = [];\n        if (this.view.viewport.from || this.view.viewport.to < this.view.state.doc.length)\n            for (let child of this.children)\n                if (child instanceof BlockWidgetView && child.widget instanceof BlockGapWidget)\n                    gaps.push(child.dom);\n        observer.updateGaps(gaps);\n    }\n    updateChildren(changes, oldLength) {\n        let cursor = this.childCursor(oldLength);\n        for (let i = changes.length - 1;; i--) {\n            let next = i >= 0 ? changes[i] : null;\n            if (!next)\n                break;\n            let { fromA, toA, fromB, toB } = next;\n            let { content, breakAtStart, openStart, openEnd } = ContentBuilder.build(this.view.state.doc, fromB, toB, this.decorations, this.dynamicDecorationMap);\n            let { i: toI, off: toOff } = cursor.findPos(toA, 1);\n            let { i: fromI, off: fromOff } = cursor.findPos(fromA, -1);\n            replaceRange(this, fromI, fromOff, toI, toOff, content, breakAtStart, openStart, openEnd);\n        }\n    }\n    // Sync the DOM selection to this.state.selection\n    updateSelection(mustRead = false, fromPointer = false) {\n        if (mustRead || !this.view.observer.selectionRange.focusNode)\n            this.view.observer.readSelectionRange();\n        if (!(fromPointer || this.mayControlSelection()))\n            return;\n        let force = this.forceSelection;\n        this.forceSelection = false;\n        let main = this.view.state.selection.main;\n        // FIXME need to handle the case where the selection falls inside a block range\n        let anchor = this.domAtPos(main.anchor);\n        let head = main.empty ? anchor : this.domAtPos(main.head);\n        // Always reset on Firefox when next to an uneditable node to\n        // avoid invisible cursor bugs (#111)\n        if (browser.gecko && main.empty && betweenUneditable(anchor)) {\n            let dummy = document.createTextNode(\"\");\n            this.view.observer.ignore(() => anchor.node.insertBefore(dummy, anchor.node.childNodes[anchor.offset] || null));\n            anchor = head = new DOMPos(dummy, 0);\n            force = true;\n        }\n        let domSel = this.view.observer.selectionRange;\n        // If the selection is already here, or in an equivalent position, don't touch it\n        if (force || !domSel.focusNode ||\n            !isEquivalentPosition(anchor.node, anchor.offset, domSel.anchorNode, domSel.anchorOffset) ||\n            !isEquivalentPosition(head.node, head.offset, domSel.focusNode, domSel.focusOffset)) {\n            this.view.observer.ignore(() => {\n                // Chrome Android will hide the virtual keyboard when tapping\n                // inside an uneditable node, and not bring it back when we\n                // move the cursor to its proper position. This tries to\n                // restore the keyboard by cycling focus.\n                if (browser.android && browser.chrome && this.dom.contains(domSel.focusNode) &&\n                    inUneditable(domSel.focusNode, this.dom)) {\n                    this.dom.blur();\n                    this.dom.focus({ preventScroll: true });\n                }\n                let rawSel = getSelection(this.view.root);\n                if (!rawSel) ;\n                else if (main.empty) {\n                    // Work around https://bugzilla.mozilla.org/show_bug.cgi?id=1612076\n                    if (browser.gecko) {\n                        let nextTo = nextToUneditable(anchor.node, anchor.offset);\n                        if (nextTo && nextTo != (1 /* NextTo.Before */ | 2 /* NextTo.After */)) {\n                            let text = nearbyTextNode(anchor.node, anchor.offset, nextTo == 1 /* NextTo.Before */ ? 1 : -1);\n                            if (text)\n                                anchor = new DOMPos(text, nextTo == 1 /* NextTo.Before */ ? 0 : text.nodeValue.length);\n                        }\n                    }\n                    rawSel.collapse(anchor.node, anchor.offset);\n                    if (main.bidiLevel != null && domSel.cursorBidiLevel != null)\n                        domSel.cursorBidiLevel = main.bidiLevel;\n                }\n                else if (rawSel.extend) {\n                    // Selection.extend can be used to create an 'inverted' selection\n                    // (one where the focus is before the anchor), but not all\n                    // browsers support it yet.\n                    rawSel.collapse(anchor.node, anchor.offset);\n                    // Safari will ignore the call above when the editor is\n                    // hidden, and then raise an error on the call to extend\n                    // (#940).\n                    try {\n                        rawSel.extend(head.node, head.offset);\n                    }\n                    catch (_) { }\n                }\n                else {\n                    // Primitive (IE) way\n                    let range = document.createRange();\n                    if (main.anchor > main.head)\n                        [anchor, head] = [head, anchor];\n                    range.setEnd(head.node, head.offset);\n                    range.setStart(anchor.node, anchor.offset);\n                    rawSel.removeAllRanges();\n                    rawSel.addRange(range);\n                }\n            });\n            this.view.observer.setSelectionRange(anchor, head);\n        }\n        this.impreciseAnchor = anchor.precise ? null : new DOMPos(domSel.anchorNode, domSel.anchorOffset);\n        this.impreciseHead = head.precise ? null : new DOMPos(domSel.focusNode, domSel.focusOffset);\n    }\n    enforceCursorAssoc() {\n        if (this.compositionDeco.size)\n            return;\n        let { view } = this, cursor = view.state.selection.main;\n        let sel = getSelection(view.root);\n        let { anchorNode, anchorOffset } = view.observer.selectionRange;\n        if (!sel || !cursor.empty || !cursor.assoc || !sel.modify)\n            return;\n        let line = LineView.find(this, cursor.head);\n        if (!line)\n            return;\n        let lineStart = line.posAtStart;\n        if (cursor.head == lineStart || cursor.head == lineStart + line.length)\n            return;\n        let before = this.coordsAt(cursor.head, -1), after = this.coordsAt(cursor.head, 1);\n        if (!before || !after || before.bottom > after.top)\n            return;\n        let dom = this.domAtPos(cursor.head + cursor.assoc);\n        sel.collapse(dom.node, dom.offset);\n        sel.modify(\"move\", cursor.assoc < 0 ? \"forward\" : \"backward\", \"lineboundary\");\n        // This can go wrong in corner cases like single-character lines,\n        // so check and reset if necessary.\n        view.observer.readSelectionRange();\n        let newRange = view.observer.selectionRange;\n        if (view.docView.posFromDOM(newRange.anchorNode, newRange.anchorOffset) != cursor.from)\n            sel.collapse(anchorNode, anchorOffset);\n    }\n    mayControlSelection() {\n        let active = this.view.root.activeElement;\n        return active == this.dom ||\n            hasSelection(this.dom, this.view.observer.selectionRange) && !(active && this.dom.contains(active));\n    }\n    nearest(dom) {\n        for (let cur = dom; cur;) {\n            let domView = ContentView.get(cur);\n            if (domView && domView.rootView == this)\n                return domView;\n            cur = cur.parentNode;\n        }\n        return null;\n    }\n    posFromDOM(node, offset) {\n        let view = this.nearest(node);\n        if (!view)\n            throw new RangeError(\"Trying to find position for a DOM position outside of the document\");\n        return view.localPosFromDOM(node, offset) + view.posAtStart;\n    }\n    domAtPos(pos) {\n        let { i, off } = this.childCursor().findPos(pos, -1);\n        for (; i < this.children.length - 1;) {\n            let child = this.children[i];\n            if (off < child.length || child instanceof LineView)\n                break;\n            i++;\n            off = 0;\n        }\n        return this.children[i].domAtPos(off);\n    }\n    coordsAt(pos, side) {\n        for (let off = this.length, i = this.children.length - 1;; i--) {\n            let child = this.children[i], start = off - child.breakAfter - child.length;\n            if (pos > start ||\n                (pos == start && child.type != BlockType.WidgetBefore && child.type != BlockType.WidgetAfter &&\n                    (!i || side == 2 || this.children[i - 1].breakAfter ||\n                        (this.children[i - 1].type == BlockType.WidgetBefore && side > -2))))\n                return child.coordsAt(pos - start, side);\n            off = start;\n        }\n    }\n    measureVisibleLineHeights(viewport) {\n        let result = [], { from, to } = viewport;\n        let contentWidth = this.view.contentDOM.clientWidth;\n        let isWider = contentWidth > Math.max(this.view.scrollDOM.clientWidth, this.minWidth) + 1;\n        let widest = -1, ltr = this.view.textDirection == Direction.LTR;\n        for (let pos = 0, i = 0; i < this.children.length; i++) {\n            let child = this.children[i], end = pos + child.length;\n            if (end > to)\n                break;\n            if (pos >= from) {\n                let childRect = child.dom.getBoundingClientRect();\n                result.push(childRect.height);\n                if (isWider) {\n                    let last = child.dom.lastChild;\n                    let rects = last ? clientRectsFor(last) : [];\n                    if (rects.length) {\n                        let rect = rects[rects.length - 1];\n                        let width = ltr ? rect.right - childRect.left : childRect.right - rect.left;\n                        if (width > widest) {\n                            widest = width;\n                            this.minWidth = contentWidth;\n                            this.minWidthFrom = pos;\n                            this.minWidthTo = end;\n                        }\n                    }\n                }\n            }\n            pos = end + child.breakAfter;\n        }\n        return result;\n    }\n    textDirectionAt(pos) {\n        let { i } = this.childPos(pos, 1);\n        return getComputedStyle(this.children[i].dom).direction == \"rtl\" ? Direction.RTL : Direction.LTR;\n    }\n    measureTextSize() {\n        for (let child of this.children) {\n            if (child instanceof LineView) {\n                let measure = child.measureTextSize();\n                if (measure)\n                    return measure;\n            }\n        }\n        // If no workable line exists, force a layout of a measurable element\n        let dummy = document.createElement(\"div\"), lineHeight, charWidth;\n        dummy.className = \"cm-line\";\n        dummy.style.width = \"99999px\";\n        dummy.textContent = \"abc def ghi jkl mno pqr stu\";\n        this.view.observer.ignore(() => {\n            this.dom.appendChild(dummy);\n            let rect = clientRectsFor(dummy.firstChild)[0];\n            lineHeight = dummy.getBoundingClientRect().height;\n            charWidth = rect ? rect.width / 27 : 7;\n            dummy.remove();\n        });\n        return { lineHeight, charWidth };\n    }\n    childCursor(pos = this.length) {\n        // Move back to start of last element when possible, so that\n        // `ChildCursor.findPos` doesn't have to deal with the edge case\n        // of being after the last element.\n        let i = this.children.length;\n        if (i)\n            pos -= this.children[--i].length;\n        return new ChildCursor(this.children, pos, i);\n    }\n    computeBlockGapDeco() {\n        let deco = [], vs = this.view.viewState;\n        for (let pos = 0, i = 0;; i++) {\n            let next = i == vs.viewports.length ? null : vs.viewports[i];\n            let end = next ? next.from - 1 : this.length;\n            if (end > pos) {\n                let height = vs.lineBlockAt(end).bottom - vs.lineBlockAt(pos).top;\n                deco.push(Decoration.replace({\n                    widget: new BlockGapWidget(height),\n                    block: true,\n                    inclusive: true,\n                    isBlockGap: true,\n                }).range(pos, end));\n            }\n            if (!next)\n                break;\n            pos = next.to + 1;\n        }\n        return Decoration.set(deco);\n    }\n    updateDeco() {\n        let allDeco = this.view.state.facet(decorations).map((d, i) => {\n            let dynamic = this.dynamicDecorationMap[i] = typeof d == \"function\";\n            return dynamic ? d(this.view) : d;\n        });\n        for (let i = allDeco.length; i < allDeco.length + 3; i++)\n            this.dynamicDecorationMap[i] = false;\n        return this.decorations = [\n            ...allDeco,\n            this.compositionDeco,\n            this.computeBlockGapDeco(),\n            this.view.viewState.lineGapDeco\n        ];\n    }\n    scrollIntoView(target) {\n        let { range } = target;\n        let rect = this.coordsAt(range.head, range.empty ? range.assoc : range.head > range.anchor ? -1 : 1), other;\n        if (!rect)\n            return;\n        if (!range.empty && (other = this.coordsAt(range.anchor, range.anchor > range.head ? -1 : 1)))\n            rect = { left: Math.min(rect.left, other.left), top: Math.min(rect.top, other.top),\n                right: Math.max(rect.right, other.right), bottom: Math.max(rect.bottom, other.bottom) };\n        let mLeft = 0, mRight = 0, mTop = 0, mBottom = 0;\n        for (let margins of this.view.state.facet(scrollMargins).map(f => f(this.view)))\n            if (margins) {\n                let { left, right, top, bottom } = margins;\n                if (left != null)\n                    mLeft = Math.max(mLeft, left);\n                if (right != null)\n                    mRight = Math.max(mRight, right);\n                if (top != null)\n                    mTop = Math.max(mTop, top);\n                if (bottom != null)\n                    mBottom = Math.max(mBottom, bottom);\n            }\n        let targetRect = {\n            left: rect.left - mLeft, top: rect.top - mTop,\n            right: rect.right + mRight, bottom: rect.bottom + mBottom\n        };\n        scrollRectIntoView(this.view.scrollDOM, targetRect, range.head < range.anchor ? -1 : 1, target.x, target.y, target.xMargin, target.yMargin, this.view.textDirection == Direction.LTR);\n    }\n}\nfunction betweenUneditable(pos) {\n    return pos.node.nodeType == 1 && pos.node.firstChild &&\n        (pos.offset == 0 || pos.node.childNodes[pos.offset - 1].contentEditable == \"false\") &&\n        (pos.offset == pos.node.childNodes.length || pos.node.childNodes[pos.offset].contentEditable == \"false\");\n}\nclass BlockGapWidget extends WidgetType {\n    constructor(height) {\n        super();\n        this.height = height;\n    }\n    toDOM() {\n        let elt = document.createElement(\"div\");\n        this.updateDOM(elt);\n        return elt;\n    }\n    eq(other) { return other.height == this.height; }\n    updateDOM(elt) {\n        elt.style.height = this.height + \"px\";\n        return true;\n    }\n    get estimatedHeight() { return this.height; }\n}\nfunction compositionSurroundingNode(view) {\n    let sel = view.observer.selectionRange;\n    let textNode = sel.focusNode && nearbyTextNode(sel.focusNode, sel.focusOffset, 0);\n    if (!textNode)\n        return null;\n    let cView = view.docView.nearest(textNode);\n    if (!cView)\n        return null;\n    if (cView instanceof LineView) {\n        let topNode = textNode;\n        while (topNode.parentNode != cView.dom)\n            topNode = topNode.parentNode;\n        let prev = topNode.previousSibling;\n        while (prev && !ContentView.get(prev))\n            prev = prev.previousSibling;\n        let pos = prev ? ContentView.get(prev).posAtEnd : cView.posAtStart;\n        return { from: pos, to: pos, node: topNode, text: textNode };\n    }\n    else {\n        for (;;) {\n            let { parent } = cView;\n            if (!parent)\n                return null;\n            if (parent instanceof LineView)\n                break;\n            cView = parent;\n        }\n        let from = cView.posAtStart;\n        return { from, to: from + cView.length, node: cView.dom, text: textNode };\n    }\n}\nfunction computeCompositionDeco(view, changes) {\n    let surrounding = compositionSurroundingNode(view);\n    if (!surrounding)\n        return Decoration.none;\n    let { from, to, node, text: textNode } = surrounding;\n    let newFrom = changes.mapPos(from, 1), newTo = Math.max(newFrom, changes.mapPos(to, -1));\n    let { state } = view, text = node.nodeType == 3 ? node.nodeValue :\n        new DOMReader([], state).readRange(node.firstChild, null).text;\n    if (newTo - newFrom < text.length) {\n        if (state.doc.sliceString(newFrom, Math.min(state.doc.length, newFrom + text.length), LineBreakPlaceholder) == text)\n            newTo = newFrom + text.length;\n        else if (state.doc.sliceString(Math.max(0, newTo - text.length), newTo, LineBreakPlaceholder) == text)\n            newFrom = newTo - text.length;\n        else\n            return Decoration.none;\n    }\n    else if (state.doc.sliceString(newFrom, newTo, LineBreakPlaceholder) != text) {\n        return Decoration.none;\n    }\n    let topView = ContentView.get(node);\n    if (topView instanceof CompositionView)\n        topView = topView.widget.topView;\n    else if (topView)\n        topView.parent = null;\n    return Decoration.set(Decoration.replace({ widget: new CompositionWidget(node, textNode, topView), inclusive: true })\n        .range(newFrom, newTo));\n}\nclass CompositionWidget extends WidgetType {\n    constructor(top, text, topView) {\n        super();\n        this.top = top;\n        this.text = text;\n        this.topView = topView;\n    }\n    eq(other) { return this.top == other.top && this.text == other.text; }\n    toDOM() { return this.top; }\n    ignoreEvent() { return false; }\n    get customView() { return CompositionView; }\n}\nfunction nearbyTextNode(node, offset, side) {\n    for (;;) {\n        if (node.nodeType == 3)\n            return node;\n        if (node.nodeType == 1 && offset > 0 && side <= 0) {\n            node = node.childNodes[offset - 1];\n            offset = maxOffset(node);\n        }\n        else if (node.nodeType == 1 && offset < node.childNodes.length && side >= 0) {\n            node = node.childNodes[offset];\n            offset = 0;\n        }\n        else {\n            return null;\n        }\n    }\n}\nfunction nextToUneditable(node, offset) {\n    if (node.nodeType != 1)\n        return 0;\n    return (offset && node.childNodes[offset - 1].contentEditable == \"false\" ? 1 /* NextTo.Before */ : 0) |\n        (offset < node.childNodes.length && node.childNodes[offset].contentEditable == \"false\" ? 2 /* NextTo.After */ : 0);\n}\nclass DecorationComparator$1 {\n    constructor() {\n        this.changes = [];\n    }\n    compareRange(from, to) { addRange(from, to, this.changes); }\n    comparePoint(from, to) { addRange(from, to, this.changes); }\n}\nfunction findChangedDeco(a, b, diff) {\n    let comp = new DecorationComparator$1;\n    RangeSet.compare(a, b, diff, comp);\n    return comp.changes;\n}\nfunction inUneditable(node, inside) {\n    for (let cur = node; cur && cur != inside; cur = cur.assignedSlot || cur.parentNode) {\n        if (cur.nodeType == 1 && cur.contentEditable == 'false') {\n            return true;\n        }\n    }\n    return false;\n}\n\nfunction groupAt(state, pos, bias = 1) {\n    let categorize = state.charCategorizer(pos);\n    let line = state.doc.lineAt(pos), linePos = pos - line.from;\n    if (line.length == 0)\n        return EditorSelection.cursor(pos);\n    if (linePos == 0)\n        bias = 1;\n    else if (linePos == line.length)\n        bias = -1;\n    let from = linePos, to = linePos;\n    if (bias < 0)\n        from = findClusterBreak(line.text, linePos, false);\n    else\n        to = findClusterBreak(line.text, linePos);\n    let cat = categorize(line.text.slice(from, to));\n    while (from > 0) {\n        let prev = findClusterBreak(line.text, from, false);\n        if (categorize(line.text.slice(prev, from)) != cat)\n            break;\n        from = prev;\n    }\n    while (to < line.length) {\n        let next = findClusterBreak(line.text, to);\n        if (categorize(line.text.slice(to, next)) != cat)\n            break;\n        to = next;\n    }\n    return EditorSelection.range(from + line.from, to + line.from);\n}\n// Search the DOM for the {node, offset} position closest to the given\n// coordinates. Very inefficient and crude, but can usually be avoided\n// by calling caret(Position|Range)FromPoint instead.\nfunction getdx(x, rect) {\n    return rect.left > x ? rect.left - x : Math.max(0, x - rect.right);\n}\nfunction getdy(y, rect) {\n    return rect.top > y ? rect.top - y : Math.max(0, y - rect.bottom);\n}\nfunction yOverlap(a, b) {\n    return a.top < b.bottom - 1 && a.bottom > b.top + 1;\n}\nfunction upTop(rect, top) {\n    return top < rect.top ? { top, left: rect.left, right: rect.right, bottom: rect.bottom } : rect;\n}\nfunction upBot(rect, bottom) {\n    return bottom > rect.bottom ? { top: rect.top, left: rect.left, right: rect.right, bottom } : rect;\n}\nfunction domPosAtCoords(parent, x, y) {\n    let closest, closestRect, closestX, closestY, closestOverlap = false;\n    let above, below, aboveRect, belowRect;\n    for (let child = parent.firstChild; child; child = child.nextSibling) {\n        let rects = clientRectsFor(child);\n        for (let i = 0; i < rects.length; i++) {\n            let rect = rects[i];\n            if (closestRect && yOverlap(closestRect, rect))\n                rect = upTop(upBot(rect, closestRect.bottom), closestRect.top);\n            let dx = getdx(x, rect), dy = getdy(y, rect);\n            if (dx == 0 && dy == 0)\n                return child.nodeType == 3 ? domPosInText(child, x, y) : domPosAtCoords(child, x, y);\n            if (!closest || closestY > dy || closestY == dy && closestX > dx) {\n                closest = child;\n                closestRect = rect;\n                closestX = dx;\n                closestY = dy;\n                let side = dy ? (y < rect.top ? -1 : 1) : dx ? (x < rect.left ? -1 : 1) : 0;\n                closestOverlap = !side || (side > 0 ? i < rects.length - 1 : i > 0);\n            }\n            if (dx == 0) {\n                if (y > rect.bottom && (!aboveRect || aboveRect.bottom < rect.bottom)) {\n                    above = child;\n                    aboveRect = rect;\n                }\n                else if (y < rect.top && (!belowRect || belowRect.top > rect.top)) {\n                    below = child;\n                    belowRect = rect;\n                }\n            }\n            else if (aboveRect && yOverlap(aboveRect, rect)) {\n                aboveRect = upBot(aboveRect, rect.bottom);\n            }\n            else if (belowRect && yOverlap(belowRect, rect)) {\n                belowRect = upTop(belowRect, rect.top);\n            }\n        }\n    }\n    if (aboveRect && aboveRect.bottom >= y) {\n        closest = above;\n        closestRect = aboveRect;\n    }\n    else if (belowRect && belowRect.top <= y) {\n        closest = below;\n        closestRect = belowRect;\n    }\n    if (!closest)\n        return { node: parent, offset: 0 };\n    let clipX = Math.max(closestRect.left, Math.min(closestRect.right, x));\n    if (closest.nodeType == 3)\n        return domPosInText(closest, clipX, y);\n    if (closestOverlap && closest.contentEditable != \"false\")\n        return domPosAtCoords(closest, clipX, y);\n    let offset = Array.prototype.indexOf.call(parent.childNodes, closest) +\n        (x >= (closestRect.left + closestRect.right) / 2 ? 1 : 0);\n    return { node: parent, offset };\n}\nfunction domPosInText(node, x, y) {\n    let len = node.nodeValue.length;\n    let closestOffset = -1, closestDY = 1e9, generalSide = 0;\n    for (let i = 0; i < len; i++) {\n        let rects = textRange(node, i, i + 1).getClientRects();\n        for (let j = 0; j < rects.length; j++) {\n            let rect = rects[j];\n            if (rect.top == rect.bottom)\n                continue;\n            if (!generalSide)\n                generalSide = x - rect.left;\n            let dy = (rect.top > y ? rect.top - y : y - rect.bottom) - 1;\n            if (rect.left - 1 <= x && rect.right + 1 >= x && dy < closestDY) {\n                let right = x >= (rect.left + rect.right) / 2, after = right;\n                if (browser.chrome || browser.gecko) {\n                    // Check for RTL on browsers that support getting client\n                    // rects for empty ranges.\n                    let rectBefore = textRange(node, i).getBoundingClientRect();\n                    if (rectBefore.left == rect.right)\n                        after = !right;\n                }\n                if (dy <= 0)\n                    return { node, offset: i + (after ? 1 : 0) };\n                closestOffset = i + (after ? 1 : 0);\n                closestDY = dy;\n            }\n        }\n    }\n    return { node, offset: closestOffset > -1 ? closestOffset : generalSide > 0 ? node.nodeValue.length : 0 };\n}\nfunction posAtCoords(view, coords, precise, bias = -1) {\n    var _a, _b;\n    let content = view.contentDOM.getBoundingClientRect(), docTop = content.top + view.viewState.paddingTop;\n    let block, { docHeight } = view.viewState;\n    let { x, y } = coords, yOffset = y - docTop;\n    if (yOffset < 0)\n        return 0;\n    if (yOffset > docHeight)\n        return view.state.doc.length;\n    // Scan for a text block near the queried y position\n    for (let halfLine = view.defaultLineHeight / 2, bounced = false;;) {\n        block = view.elementAtHeight(yOffset);\n        if (block.type == BlockType.Text)\n            break;\n        for (;;) {\n            // Move the y position out of this block\n            yOffset = bias > 0 ? block.bottom + halfLine : block.top - halfLine;\n            if (yOffset >= 0 && yOffset <= docHeight)\n                break;\n            // If the document consists entirely of replaced widgets, we\n            // won't find a text block, so return 0\n            if (bounced)\n                return precise ? null : 0;\n            bounced = true;\n            bias = -bias;\n        }\n    }\n    y = docTop + yOffset;\n    let lineStart = block.from;\n    // If this is outside of the rendered viewport, we can't determine a position\n    if (lineStart < view.viewport.from)\n        return view.viewport.from == 0 ? 0 : precise ? null : posAtCoordsImprecise(view, content, block, x, y);\n    if (lineStart > view.viewport.to)\n        return view.viewport.to == view.state.doc.length ? view.state.doc.length :\n            precise ? null : posAtCoordsImprecise(view, content, block, x, y);\n    // Prefer ShadowRootOrDocument.elementFromPoint if present, fall back to document if not\n    let doc = view.dom.ownerDocument;\n    let root = view.root.elementFromPoint ? view.root : doc;\n    let element = root.elementFromPoint(x, y);\n    if (element && !view.contentDOM.contains(element))\n        element = null;\n    // If the element is unexpected, clip x at the sides of the content area and try again\n    if (!element) {\n        x = Math.max(content.left + 1, Math.min(content.right - 1, x));\n        element = root.elementFromPoint(x, y);\n        if (element && !view.contentDOM.contains(element))\n            element = null;\n    }\n    // There's visible editor content under the point, so we can try\n    // using caret(Position|Range)FromPoint as a shortcut\n    let node, offset = -1;\n    if (element && ((_a = view.docView.nearest(element)) === null || _a === void 0 ? void 0 : _a.isEditable) != false) {\n        if (doc.caretPositionFromPoint) {\n            let pos = doc.caretPositionFromPoint(x, y);\n            if (pos)\n                ({ offsetNode: node, offset } = pos);\n        }\n        else if (doc.caretRangeFromPoint) {\n            let range = doc.caretRangeFromPoint(x, y);\n            if (range) {\n                ({ startContainer: node, startOffset: offset } = range);\n                if (!view.contentDOM.contains(node) ||\n                    browser.safari && isSuspiciousSafariCaretResult(node, offset, x) ||\n                    browser.chrome && isSuspiciousChromeCaretResult(node, offset, x))\n                    node = undefined;\n            }\n        }\n    }\n    // No luck, do our own (potentially expensive) search\n    if (!node || !view.docView.dom.contains(node)) {\n        let line = LineView.find(view.docView, lineStart);\n        if (!line)\n            return yOffset > block.top + block.height / 2 ? block.to : block.from;\n        ({ node, offset } = domPosAtCoords(line.dom, x, y));\n    }\n    let nearest = view.docView.nearest(node);\n    if (!nearest)\n        return null;\n    if (nearest.isWidget && ((_b = nearest.dom) === null || _b === void 0 ? void 0 : _b.nodeType) == 1) {\n        let rect = nearest.dom.getBoundingClientRect();\n        return coords.y < rect.top || coords.y <= rect.bottom && coords.x <= (rect.left + rect.right) / 2\n            ? nearest.posAtStart : nearest.posAtEnd;\n    }\n    else {\n        return nearest.localPosFromDOM(node, offset) + nearest.posAtStart;\n    }\n}\nfunction posAtCoordsImprecise(view, contentRect, block, x, y) {\n    let into = Math.round((x - contentRect.left) * view.defaultCharacterWidth);\n    if (view.lineWrapping && block.height > view.defaultLineHeight * 1.5) {\n        let line = Math.floor((y - block.top) / view.defaultLineHeight);\n        into += line * view.viewState.heightOracle.lineLength;\n    }\n    let content = view.state.sliceDoc(block.from, block.to);\n    return block.from + findColumn(content, into, view.state.tabSize);\n}\n// In case of a high line height, Safari's caretRangeFromPoint treats\n// the space between lines as belonging to the last character of the\n// line before. This is used to detect such a result so that it can be\n// ignored (issue #401).\nfunction isSuspiciousSafariCaretResult(node, offset, x) {\n    let len;\n    if (node.nodeType != 3 || offset != (len = node.nodeValue.length))\n        return false;\n    for (let next = node.nextSibling; next; next = next.nextSibling)\n        if (next.nodeType != 1 || next.nodeName != \"BR\")\n            return false;\n    return textRange(node, len - 1, len).getBoundingClientRect().left > x;\n}\n// Chrome will move positions between lines to the start of the next line\nfunction isSuspiciousChromeCaretResult(node, offset, x) {\n    if (offset != 0)\n        return false;\n    for (let cur = node;;) {\n        let parent = cur.parentNode;\n        if (!parent || parent.nodeType != 1 || parent.firstChild != cur)\n            return false;\n        if (parent.classList.contains(\"cm-line\"))\n            break;\n        cur = parent;\n    }\n    let rect = node.nodeType == 1 ? node.getBoundingClientRect()\n        : textRange(node, 0, Math.max(node.nodeValue.length, 1)).getBoundingClientRect();\n    return x - rect.left > 5;\n}\nfunction moveToLineBoundary(view, start, forward, includeWrap) {\n    let line = view.state.doc.lineAt(start.head);\n    let coords = !includeWrap || !view.lineWrapping ? null\n        : view.coordsAtPos(start.assoc < 0 && start.head > line.from ? start.head - 1 : start.head);\n    if (coords) {\n        let editorRect = view.dom.getBoundingClientRect();\n        let direction = view.textDirectionAt(line.from);\n        let pos = view.posAtCoords({ x: forward == (direction == Direction.LTR) ? editorRect.right - 1 : editorRect.left + 1,\n            y: (coords.top + coords.bottom) / 2 });\n        if (pos != null)\n            return EditorSelection.cursor(pos, forward ? -1 : 1);\n    }\n    let lineView = LineView.find(view.docView, start.head);\n    let end = lineView ? (forward ? lineView.posAtEnd : lineView.posAtStart) : (forward ? line.to : line.from);\n    return EditorSelection.cursor(end, forward ? -1 : 1);\n}\nfunction moveByChar(view, start, forward, by) {\n    let line = view.state.doc.lineAt(start.head), spans = view.bidiSpans(line);\n    let direction = view.textDirectionAt(line.from);\n    for (let cur = start, check = null;;) {\n        let next = moveVisually(line, spans, direction, cur, forward), char = movedOver;\n        if (!next) {\n            if (line.number == (forward ? view.state.doc.lines : 1))\n                return cur;\n            char = \"\\n\";\n            line = view.state.doc.line(line.number + (forward ? 1 : -1));\n            spans = view.bidiSpans(line);\n            next = EditorSelection.cursor(forward ? line.from : line.to);\n        }\n        if (!check) {\n            if (!by)\n                return next;\n            check = by(char);\n        }\n        else if (!check(char)) {\n            return cur;\n        }\n        cur = next;\n    }\n}\nfunction byGroup(view, pos, start) {\n    let categorize = view.state.charCategorizer(pos);\n    let cat = categorize(start);\n    return (next) => {\n        let nextCat = categorize(next);\n        if (cat == CharCategory.Space)\n            cat = nextCat;\n        return cat == nextCat;\n    };\n}\nfunction moveVertically(view, start, forward, distance) {\n    let startPos = start.head, dir = forward ? 1 : -1;\n    if (startPos == (forward ? view.state.doc.length : 0))\n        return EditorSelection.cursor(startPos, start.assoc);\n    let goal = start.goalColumn, startY;\n    let rect = view.contentDOM.getBoundingClientRect();\n    let startCoords = view.coordsAtPos(startPos), docTop = view.documentTop;\n    if (startCoords) {\n        if (goal == null)\n            goal = startCoords.left - rect.left;\n        startY = dir < 0 ? startCoords.top : startCoords.bottom;\n    }\n    else {\n        let line = view.viewState.lineBlockAt(startPos);\n        if (goal == null)\n            goal = Math.min(rect.right - rect.left, view.defaultCharacterWidth * (startPos - line.from));\n        startY = (dir < 0 ? line.top : line.bottom) + docTop;\n    }\n    let resolvedGoal = rect.left + goal;\n    let dist = distance !== null && distance !== void 0 ? distance : (view.defaultLineHeight >> 1);\n    for (let extra = 0;; extra += 10) {\n        let curY = startY + (dist + extra) * dir;\n        let pos = posAtCoords(view, { x: resolvedGoal, y: curY }, false, dir);\n        if (curY < rect.top || curY > rect.bottom || (dir < 0 ? pos < startPos : pos > startPos))\n            return EditorSelection.cursor(pos, start.assoc, undefined, goal);\n    }\n}\nfunction skipAtoms(view, oldPos, pos) {\n    let atoms = view.state.facet(atomicRanges).map(f => f(view));\n    for (;;) {\n        let moved = false;\n        for (let set of atoms) {\n            set.between(pos.from - 1, pos.from + 1, (from, to, value) => {\n                if (pos.from > from && pos.from < to) {\n                    pos = oldPos.head > pos.from ? EditorSelection.cursor(from, 1) : EditorSelection.cursor(to, -1);\n                    moved = true;\n                }\n            });\n        }\n        if (!moved)\n            return pos;\n    }\n}\n\n// This will also be where dragging info and such goes\nclass InputState {\n    constructor(view) {\n        this.lastKeyCode = 0;\n        this.lastKeyTime = 0;\n        this.lastTouchTime = 0;\n        this.lastFocusTime = 0;\n        this.lastScrollTop = 0;\n        this.lastScrollLeft = 0;\n        this.chromeScrollHack = -1;\n        // On iOS, some keys need to have their default behavior happen\n        // (after which we retroactively handle them and reset the DOM) to\n        // avoid messing up the virtual keyboard state.\n        this.pendingIOSKey = undefined;\n        this.lastSelectionOrigin = null;\n        this.lastSelectionTime = 0;\n        this.lastEscPress = 0;\n        this.lastContextMenu = 0;\n        this.scrollHandlers = [];\n        this.registeredEvents = [];\n        this.customHandlers = [];\n        // -1 means not in a composition. Otherwise, this counts the number\n        // of changes made during the composition. The count is used to\n        // avoid treating the start state of the composition, before any\n        // changes have been made, as part of the composition.\n        this.composing = -1;\n        // Tracks whether the next change should be marked as starting the\n        // composition (null means no composition, true means next is the\n        // first, false means first has already been marked for this\n        // composition)\n        this.compositionFirstChange = null;\n        this.compositionEndedAt = 0;\n        this.mouseSelection = null;\n        let handleEvent = (handler, event) => {\n            if (this.ignoreDuringComposition(event))\n                return;\n            if (event.type == \"keydown\" && this.keydown(view, event))\n                return;\n            if (this.mustFlushObserver(event))\n                view.observer.forceFlush();\n            if (this.runCustomHandlers(event.type, view, event))\n                event.preventDefault();\n            else\n                handler(view, event);\n        };\n        for (let type in handlers) {\n            let handler = handlers[type];\n            view.contentDOM.addEventListener(type, event => {\n                if (eventBelongsToEditor(view, event))\n                    handleEvent(handler, event);\n            }, handlerOptions[type]);\n            this.registeredEvents.push(type);\n        }\n        view.scrollDOM.addEventListener(\"mousedown\", (event) => {\n            if (event.target == view.scrollDOM && event.clientY > view.contentDOM.getBoundingClientRect().bottom)\n                handleEvent(handlers.mousedown, event);\n        });\n        if (browser.chrome && browser.chrome_version == 102) { // FIXME remove at some point\n            // On Chrome 102, viewport updates somehow stop wheel-based\n            // scrolling. Turning off pointer events during the scroll seems\n            // to avoid the issue.\n            view.scrollDOM.addEventListener(\"wheel\", () => {\n                if (this.chromeScrollHack < 0)\n                    view.contentDOM.style.pointerEvents = \"none\";\n                else\n                    window.clearTimeout(this.chromeScrollHack);\n                this.chromeScrollHack = setTimeout(() => {\n                    this.chromeScrollHack = -1;\n                    view.contentDOM.style.pointerEvents = \"\";\n                }, 100);\n            }, { passive: true });\n        }\n        this.notifiedFocused = view.hasFocus;\n        // On Safari adding an input event handler somehow prevents an\n        // issue where the composition vanishes when you press enter.\n        if (browser.safari)\n            view.contentDOM.addEventListener(\"input\", () => null);\n    }\n    setSelectionOrigin(origin) {\n        this.lastSelectionOrigin = origin;\n        this.lastSelectionTime = Date.now();\n    }\n    ensureHandlers(view, plugins) {\n        var _a;\n        let handlers;\n        this.customHandlers = [];\n        for (let plugin of plugins)\n            if (handlers = (_a = plugin.update(view).spec) === null || _a === void 0 ? void 0 : _a.domEventHandlers) {\n                this.customHandlers.push({ plugin: plugin.value, handlers });\n                for (let type in handlers)\n                    if (this.registeredEvents.indexOf(type) < 0 && type != \"scroll\") {\n                        this.registeredEvents.push(type);\n                        view.contentDOM.addEventListener(type, (event) => {\n                            if (!eventBelongsToEditor(view, event))\n                                return;\n                            if (this.runCustomHandlers(type, view, event))\n                                event.preventDefault();\n                        });\n                    }\n            }\n    }\n    runCustomHandlers(type, view, event) {\n        for (let set of this.customHandlers) {\n            let handler = set.handlers[type];\n            if (handler) {\n                try {\n                    if (handler.call(set.plugin, event, view) || event.defaultPrevented)\n                        return true;\n                }\n                catch (e) {\n                    logException(view.state, e);\n                }\n            }\n        }\n        return false;\n    }\n    runScrollHandlers(view, event) {\n        this.lastScrollTop = view.scrollDOM.scrollTop;\n        this.lastScrollLeft = view.scrollDOM.scrollLeft;\n        for (let set of this.customHandlers) {\n            let handler = set.handlers.scroll;\n            if (handler) {\n                try {\n                    handler.call(set.plugin, event, view);\n                }\n                catch (e) {\n                    logException(view.state, e);\n                }\n            }\n        }\n    }\n    keydown(view, event) {\n        // Must always run, even if a custom handler handled the event\n        this.lastKeyCode = event.keyCode;\n        this.lastKeyTime = Date.now();\n        if (event.keyCode == 9 && Date.now() < this.lastEscPress + 2000)\n            return true;\n        // Chrome for Android usually doesn't fire proper key events, but\n        // occasionally does, usually surrounded by a bunch of complicated\n        // composition changes. When an enter or backspace key event is\n        // seen, hold off on handling DOM events for a bit, and then\n        // dispatch it.\n        if (browser.android && browser.chrome && !event.synthetic &&\n            (event.keyCode == 13 || event.keyCode == 8)) {\n            view.observer.delayAndroidKey(event.key, event.keyCode);\n            return true;\n        }\n        // Prevent the default behavior of Enter on iOS makes the\n        // virtual keyboard get stuck in the wrong (lowercase)\n        // state. So we let it go through, and then, in\n        // applyDOMChange, notify key handlers of it and reset to\n        // the state they produce.\n        let pending;\n        if (browser.ios && !event.synthetic && !event.altKey && !event.metaKey &&\n            ((pending = PendingKeys.find(key => key.keyCode == event.keyCode)) && !event.ctrlKey ||\n                EmacsyPendingKeys.indexOf(event.key) > -1 && event.ctrlKey && !event.shiftKey)) {\n            this.pendingIOSKey = pending || event;\n            setTimeout(() => this.flushIOSKey(view), 250);\n            return true;\n        }\n        return false;\n    }\n    flushIOSKey(view) {\n        let key = this.pendingIOSKey;\n        if (!key)\n            return false;\n        this.pendingIOSKey = undefined;\n        return dispatchKey(view.contentDOM, key.key, key.keyCode);\n    }\n    ignoreDuringComposition(event) {\n        if (!/^key/.test(event.type))\n            return false;\n        if (this.composing > 0)\n            return true;\n        // See https://www.stum.de/2016/06/24/handling-ime-events-in-javascript/.\n        // On some input method editors (IMEs), the Enter key is used to\n        // confirm character selection. On Safari, when Enter is pressed,\n        // compositionend and keydown events are sometimes emitted in the\n        // wrong order. The key event should still be ignored, even when\n        // it happens after the compositionend event.\n        if (browser.safari && !browser.ios && Date.now() - this.compositionEndedAt < 100) {\n            this.compositionEndedAt = 0;\n            return true;\n        }\n        return false;\n    }\n    mustFlushObserver(event) {\n        return event.type == \"keydown\" && event.keyCode != 229;\n    }\n    startMouseSelection(mouseSelection) {\n        if (this.mouseSelection)\n            this.mouseSelection.destroy();\n        this.mouseSelection = mouseSelection;\n    }\n    update(update) {\n        if (this.mouseSelection)\n            this.mouseSelection.update(update);\n        if (update.transactions.length)\n            this.lastKeyCode = this.lastSelectionTime = 0;\n    }\n    destroy() {\n        if (this.mouseSelection)\n            this.mouseSelection.destroy();\n    }\n}\nconst PendingKeys = [\n    { key: \"Backspace\", keyCode: 8, inputType: \"deleteContentBackward\" },\n    { key: \"Enter\", keyCode: 13, inputType: \"insertParagraph\" },\n    { key: \"Delete\", keyCode: 46, inputType: \"deleteContentForward\" }\n];\nconst EmacsyPendingKeys = \"dthko\";\n// Key codes for modifier keys\nconst modifierCodes = [16, 17, 18, 20, 91, 92, 224, 225];\nfunction dragScrollSpeed(dist) {\n    return dist * 0.7 + 8;\n}\nclass MouseSelection {\n    constructor(view, startEvent, style, mustSelect) {\n        this.view = view;\n        this.style = style;\n        this.mustSelect = mustSelect;\n        this.scrollSpeed = { x: 0, y: 0 };\n        this.scrolling = -1;\n        this.lastEvent = startEvent;\n        this.scrollParent = scrollableParent(view.contentDOM);\n        let doc = view.contentDOM.ownerDocument;\n        doc.addEventListener(\"mousemove\", this.move = this.move.bind(this));\n        doc.addEventListener(\"mouseup\", this.up = this.up.bind(this));\n        this.extend = startEvent.shiftKey;\n        this.multiple = view.state.facet(EditorState.allowMultipleSelections) && addsSelectionRange(view, startEvent);\n        this.dragMove = dragMovesSelection(view, startEvent);\n        this.dragging = isInPrimarySelection(view, startEvent) && getClickType(startEvent) == 1 ? null : false;\n    }\n    start(event) {\n        // When clicking outside of the selection, immediately apply the\n        // effect of starting the selection\n        if (this.dragging === false) {\n            event.preventDefault();\n            this.select(event);\n        }\n    }\n    move(event) {\n        var _a;\n        if (event.buttons == 0)\n            return this.destroy();\n        if (this.dragging !== false)\n            return;\n        this.select(this.lastEvent = event);\n        let sx = 0, sy = 0;\n        let rect = ((_a = this.scrollParent) === null || _a === void 0 ? void 0 : _a.getBoundingClientRect())\n            || { left: 0, top: 0, right: this.view.win.innerWidth, bottom: this.view.win.innerHeight };\n        if (event.clientX <= rect.left)\n            sx = -dragScrollSpeed(rect.left - event.clientX);\n        else if (event.clientX >= rect.right)\n            sx = dragScrollSpeed(event.clientX - rect.right);\n        if (event.clientY <= rect.top)\n            sy = -dragScrollSpeed(rect.top - event.clientY);\n        else if (event.clientY >= rect.bottom)\n            sy = dragScrollSpeed(event.clientY - rect.bottom);\n        this.setScrollSpeed(sx, sy);\n    }\n    up(event) {\n        if (this.dragging == null)\n            this.select(this.lastEvent);\n        if (!this.dragging)\n            event.preventDefault();\n        this.destroy();\n    }\n    destroy() {\n        this.setScrollSpeed(0, 0);\n        let doc = this.view.contentDOM.ownerDocument;\n        doc.removeEventListener(\"mousemove\", this.move);\n        doc.removeEventListener(\"mouseup\", this.up);\n        this.view.inputState.mouseSelection = null;\n    }\n    setScrollSpeed(sx, sy) {\n        this.scrollSpeed = { x: sx, y: sy };\n        if (sx || sy) {\n            if (this.scrolling < 0)\n                this.scrolling = setInterval(() => this.scroll(), 50);\n        }\n        else if (this.scrolling > -1) {\n            clearInterval(this.scrolling);\n            this.scrolling = -1;\n        }\n    }\n    scroll() {\n        if (this.scrollParent) {\n            this.scrollParent.scrollLeft += this.scrollSpeed.x;\n            this.scrollParent.scrollTop += this.scrollSpeed.y;\n        }\n        else {\n            this.view.win.scrollBy(this.scrollSpeed.x, this.scrollSpeed.y);\n        }\n        if (this.dragging === false)\n            this.select(this.lastEvent);\n    }\n    select(event) {\n        let selection = this.style.get(event, this.extend, this.multiple);\n        if (this.mustSelect || !selection.eq(this.view.state.selection) ||\n            selection.main.assoc != this.view.state.selection.main.assoc)\n            this.view.dispatch({\n                selection,\n                userEvent: \"select.pointer\"\n            });\n        this.mustSelect = false;\n    }\n    update(update) {\n        if (update.docChanged && this.dragging)\n            this.dragging = this.dragging.map(update.changes);\n        if (this.style.update(update))\n            setTimeout(() => this.select(this.lastEvent), 20);\n    }\n}\nfunction addsSelectionRange(view, event) {\n    let facet = view.state.facet(clickAddsSelectionRange);\n    return facet.length ? facet[0](event) : browser.mac ? event.metaKey : event.ctrlKey;\n}\nfunction dragMovesSelection(view, event) {\n    let facet = view.state.facet(dragMovesSelection$1);\n    return facet.length ? facet[0](event) : browser.mac ? !event.altKey : !event.ctrlKey;\n}\nfunction isInPrimarySelection(view, event) {\n    let { main } = view.state.selection;\n    if (main.empty)\n        return false;\n    // On boundary clicks, check whether the coordinates are inside the\n    // selection's client rectangles\n    let sel = getSelection(view.root);\n    if (!sel || sel.rangeCount == 0)\n        return true;\n    let rects = sel.getRangeAt(0).getClientRects();\n    for (let i = 0; i < rects.length; i++) {\n        let rect = rects[i];\n        if (rect.left <= event.clientX && rect.right >= event.clientX &&\n            rect.top <= event.clientY && rect.bottom >= event.clientY)\n            return true;\n    }\n    return false;\n}\nfunction eventBelongsToEditor(view, event) {\n    if (!event.bubbles)\n        return true;\n    if (event.defaultPrevented)\n        return false;\n    for (let node = event.target, cView; node != view.contentDOM; node = node.parentNode)\n        if (!node || node.nodeType == 11 || ((cView = ContentView.get(node)) && cView.ignoreEvent(event)))\n            return false;\n    return true;\n}\nconst handlers = /*@__PURE__*/Object.create(null);\nconst handlerOptions = /*@__PURE__*/Object.create(null);\n// This is very crude, but unfortunately both these browsers _pretend_\n// that they have a clipboard API—all the objects and methods are\n// there, they just don't work, and they are hard to test.\nconst brokenClipboardAPI = (browser.ie && browser.ie_version < 15) ||\n    (browser.ios && browser.webkit_version < 604);\nfunction capturePaste(view) {\n    let parent = view.dom.parentNode;\n    if (!parent)\n        return;\n    let target = parent.appendChild(document.createElement(\"textarea\"));\n    target.style.cssText = \"position: fixed; left: -10000px; top: 10px\";\n    target.focus();\n    setTimeout(() => {\n        view.focus();\n        target.remove();\n        doPaste(view, target.value);\n    }, 50);\n}\nfunction doPaste(view, input) {\n    let { state } = view, changes, i = 1, text = state.toText(input);\n    let byLine = text.lines == state.selection.ranges.length;\n    let linewise = lastLinewiseCopy != null && state.selection.ranges.every(r => r.empty) && lastLinewiseCopy == text.toString();\n    if (linewise) {\n        let lastLine = -1;\n        changes = state.changeByRange(range => {\n            let line = state.doc.lineAt(range.from);\n            if (line.from == lastLine)\n                return { range };\n            lastLine = line.from;\n            let insert = state.toText((byLine ? text.line(i++).text : input) + state.lineBreak);\n            return { changes: { from: line.from, insert },\n                range: EditorSelection.cursor(range.from + insert.length) };\n        });\n    }\n    else if (byLine) {\n        changes = state.changeByRange(range => {\n            let line = text.line(i++);\n            return { changes: { from: range.from, to: range.to, insert: line.text },\n                range: EditorSelection.cursor(range.from + line.length) };\n        });\n    }\n    else {\n        changes = state.replaceSelection(text);\n    }\n    view.dispatch(changes, {\n        userEvent: \"input.paste\",\n        scrollIntoView: true\n    });\n}\nhandlers.keydown = (view, event) => {\n    view.inputState.setSelectionOrigin(\"select\");\n    if (event.keyCode == 27)\n        view.inputState.lastEscPress = Date.now();\n    else if (modifierCodes.indexOf(event.keyCode) < 0)\n        view.inputState.lastEscPress = 0;\n};\nhandlers.touchstart = (view, e) => {\n    view.inputState.lastTouchTime = Date.now();\n    view.inputState.setSelectionOrigin(\"select.pointer\");\n};\nhandlers.touchmove = view => {\n    view.inputState.setSelectionOrigin(\"select.pointer\");\n};\nhandlerOptions.touchstart = handlerOptions.touchmove = { passive: true };\nhandlers.mousedown = (view, event) => {\n    view.observer.flush();\n    if (view.inputState.lastTouchTime > Date.now() - 2000)\n        return; // Ignore touch interaction\n    let style = null;\n    for (let makeStyle of view.state.facet(mouseSelectionStyle)) {\n        style = makeStyle(view, event);\n        if (style)\n            break;\n    }\n    if (!style && event.button == 0)\n        style = basicMouseSelection(view, event);\n    if (style) {\n        let mustFocus = view.root.activeElement != view.contentDOM;\n        view.inputState.startMouseSelection(new MouseSelection(view, event, style, mustFocus));\n        if (mustFocus)\n            view.observer.ignore(() => focusPreventScroll(view.contentDOM));\n        if (view.inputState.mouseSelection)\n            view.inputState.mouseSelection.start(event);\n    }\n};\nfunction rangeForClick(view, pos, bias, type) {\n    if (type == 1) { // Single click\n        return EditorSelection.cursor(pos, bias);\n    }\n    else if (type == 2) { // Double click\n        return groupAt(view.state, pos, bias);\n    }\n    else { // Triple click\n        let visual = LineView.find(view.docView, pos), line = view.state.doc.lineAt(visual ? visual.posAtEnd : pos);\n        let from = visual ? visual.posAtStart : line.from, to = visual ? visual.posAtEnd : line.to;\n        if (to < view.state.doc.length && to == line.to)\n            to++;\n        return EditorSelection.range(from, to);\n    }\n}\nlet insideY = (y, rect) => y >= rect.top && y <= rect.bottom;\nlet inside = (x, y, rect) => insideY(y, rect) && x >= rect.left && x <= rect.right;\n// Try to determine, for the given coordinates, associated with the\n// given position, whether they are related to the element before or\n// the element after the position.\nfunction findPositionSide(view, pos, x, y) {\n    let line = LineView.find(view.docView, pos);\n    if (!line)\n        return 1;\n    let off = pos - line.posAtStart;\n    // Line boundaries point into the line\n    if (off == 0)\n        return 1;\n    if (off == line.length)\n        return -1;\n    // Positions on top of an element point at that element\n    let before = line.coordsAt(off, -1);\n    if (before && inside(x, y, before))\n        return -1;\n    let after = line.coordsAt(off, 1);\n    if (after && inside(x, y, after))\n        return 1;\n    // This is probably a line wrap point. Pick before if the point is\n    // beside it.\n    return before && insideY(y, before) ? -1 : 1;\n}\nfunction queryPos(view, event) {\n    let pos = view.posAtCoords({ x: event.clientX, y: event.clientY }, false);\n    return { pos, bias: findPositionSide(view, pos, event.clientX, event.clientY) };\n}\nconst BadMouseDetail = browser.ie && browser.ie_version <= 11;\nlet lastMouseDown = null, lastMouseDownCount = 0, lastMouseDownTime = 0;\nfunction getClickType(event) {\n    if (!BadMouseDetail)\n        return event.detail;\n    let last = lastMouseDown, lastTime = lastMouseDownTime;\n    lastMouseDown = event;\n    lastMouseDownTime = Date.now();\n    return lastMouseDownCount = !last || (lastTime > Date.now() - 400 && Math.abs(last.clientX - event.clientX) < 2 &&\n        Math.abs(last.clientY - event.clientY) < 2) ? (lastMouseDownCount + 1) % 3 : 1;\n}\nfunction basicMouseSelection(view, event) {\n    let start = queryPos(view, event), type = getClickType(event);\n    let startSel = view.state.selection;\n    return {\n        update(update) {\n            if (update.docChanged) {\n                start.pos = update.changes.mapPos(start.pos);\n                startSel = startSel.map(update.changes);\n            }\n        },\n        get(event, extend, multiple) {\n            let cur = queryPos(view, event);\n            let range = rangeForClick(view, cur.pos, cur.bias, type);\n            if (start.pos != cur.pos && !extend) {\n                let startRange = rangeForClick(view, start.pos, start.bias, type);\n                let from = Math.min(startRange.from, range.from), to = Math.max(startRange.to, range.to);\n                range = from < range.from ? EditorSelection.range(from, to) : EditorSelection.range(to, from);\n            }\n            if (extend)\n                return startSel.replaceRange(startSel.main.extend(range.from, range.to));\n            else if (multiple && startSel.ranges.length > 1 && startSel.ranges.some(r => r.eq(range)))\n                return removeRange(startSel, range);\n            else if (multiple)\n                return startSel.addRange(range);\n            else\n                return EditorSelection.create([range]);\n        }\n    };\n}\nfunction removeRange(sel, range) {\n    for (let i = 0;; i++) {\n        if (sel.ranges[i].eq(range))\n            return EditorSelection.create(sel.ranges.slice(0, i).concat(sel.ranges.slice(i + 1)), sel.mainIndex == i ? 0 : sel.mainIndex - (sel.mainIndex > i ? 1 : 0));\n    }\n}\nhandlers.dragstart = (view, event) => {\n    let { selection: { main } } = view.state;\n    let { mouseSelection } = view.inputState;\n    if (mouseSelection)\n        mouseSelection.dragging = main;\n    if (event.dataTransfer) {\n        event.dataTransfer.setData(\"Text\", view.state.sliceDoc(main.from, main.to));\n        event.dataTransfer.effectAllowed = \"copyMove\";\n    }\n};\nfunction dropText(view, event, text, direct) {\n    if (!text)\n        return;\n    let dropPos = view.posAtCoords({ x: event.clientX, y: event.clientY }, false);\n    event.preventDefault();\n    let { mouseSelection } = view.inputState;\n    let del = direct && mouseSelection && mouseSelection.dragging && mouseSelection.dragMove ?\n        { from: mouseSelection.dragging.from, to: mouseSelection.dragging.to } : null;\n    let ins = { from: dropPos, insert: text };\n    let changes = view.state.changes(del ? [del, ins] : ins);\n    view.focus();\n    view.dispatch({\n        changes,\n        selection: { anchor: changes.mapPos(dropPos, -1), head: changes.mapPos(dropPos, 1) },\n        userEvent: del ? \"move.drop\" : \"input.drop\"\n    });\n}\nhandlers.drop = (view, event) => {\n    if (!event.dataTransfer)\n        return;\n    if (view.state.readOnly)\n        return event.preventDefault();\n    let files = event.dataTransfer.files;\n    if (files && files.length) { // For a file drop, read the file's text.\n        event.preventDefault();\n        let text = Array(files.length), read = 0;\n        let finishFile = () => {\n            if (++read == files.length)\n                dropText(view, event, text.filter(s => s != null).join(view.state.lineBreak), false);\n        };\n        for (let i = 0; i < files.length; i++) {\n            let reader = new FileReader;\n            reader.onerror = finishFile;\n            reader.onload = () => {\n                if (!/[\\x00-\\x08\\x0e-\\x1f]{2}/.test(reader.result))\n                    text[i] = reader.result;\n                finishFile();\n            };\n            reader.readAsText(files[i]);\n        }\n    }\n    else {\n        dropText(view, event, event.dataTransfer.getData(\"Text\"), true);\n    }\n};\nhandlers.paste = (view, event) => {\n    if (view.state.readOnly)\n        return event.preventDefault();\n    view.observer.flush();\n    let data = brokenClipboardAPI ? null : event.clipboardData;\n    if (data) {\n        doPaste(view, data.getData(\"text/plain\") || data.getData(\"text/uri-text\"));\n        event.preventDefault();\n    }\n    else {\n        capturePaste(view);\n    }\n};\nfunction captureCopy(view, text) {\n    // The extra wrapper is somehow necessary on IE/Edge to prevent the\n    // content from being mangled when it is put onto the clipboard\n    let parent = view.dom.parentNode;\n    if (!parent)\n        return;\n    let target = parent.appendChild(document.createElement(\"textarea\"));\n    target.style.cssText = \"position: fixed; left: -10000px; top: 10px\";\n    target.value = text;\n    target.focus();\n    target.selectionEnd = text.length;\n    target.selectionStart = 0;\n    setTimeout(() => {\n        target.remove();\n        view.focus();\n    }, 50);\n}\nfunction copiedRange(state) {\n    let content = [], ranges = [], linewise = false;\n    for (let range of state.selection.ranges)\n        if (!range.empty) {\n            content.push(state.sliceDoc(range.from, range.to));\n            ranges.push(range);\n        }\n    if (!content.length) {\n        // Nothing selected, do a line-wise copy\n        let upto = -1;\n        for (let { from } of state.selection.ranges) {\n            let line = state.doc.lineAt(from);\n            if (line.number > upto) {\n                content.push(line.text);\n                ranges.push({ from: line.from, to: Math.min(state.doc.length, line.to + 1) });\n            }\n            upto = line.number;\n        }\n        linewise = true;\n    }\n    return { text: content.join(state.lineBreak), ranges, linewise };\n}\nlet lastLinewiseCopy = null;\nhandlers.copy = handlers.cut = (view, event) => {\n    let { text, ranges, linewise } = copiedRange(view.state);\n    if (!text && !linewise)\n        return;\n    lastLinewiseCopy = linewise ? text : null;\n    let data = brokenClipboardAPI ? null : event.clipboardData;\n    if (data) {\n        event.preventDefault();\n        data.clearData();\n        data.setData(\"text/plain\", text);\n    }\n    else {\n        captureCopy(view, text);\n    }\n    if (event.type == \"cut\" && !view.state.readOnly)\n        view.dispatch({\n            changes: ranges,\n            scrollIntoView: true,\n            userEvent: \"delete.cut\"\n        });\n};\nconst isFocusChange = /*@__PURE__*/Annotation.define();\nfunction focusChangeTransaction(state, focus) {\n    let effects = [];\n    for (let getEffect of state.facet(focusChangeEffect)) {\n        let effect = getEffect(state, focus);\n        if (effect)\n            effects.push(effect);\n    }\n    return effects ? state.update({ effects, annotations: isFocusChange.of(true) }) : null;\n}\nfunction updateForFocusChange(view) {\n    setTimeout(() => {\n        let focus = view.hasFocus;\n        if (focus != view.inputState.notifiedFocused) {\n            let tr = focusChangeTransaction(view.state, focus);\n            if (tr)\n                view.dispatch(tr);\n            else\n                view.update([]);\n        }\n    }, 10);\n}\nhandlers.focus = view => {\n    view.inputState.lastFocusTime = Date.now();\n    // When focusing reset the scroll position, move it back to where it was\n    if (!view.scrollDOM.scrollTop && (view.inputState.lastScrollTop || view.inputState.lastScrollLeft)) {\n        view.scrollDOM.scrollTop = view.inputState.lastScrollTop;\n        view.scrollDOM.scrollLeft = view.inputState.lastScrollLeft;\n    }\n    updateForFocusChange(view);\n};\nhandlers.blur = view => {\n    view.observer.clearSelectionRange();\n    updateForFocusChange(view);\n};\nhandlers.compositionstart = handlers.compositionupdate = view => {\n    if (view.inputState.compositionFirstChange == null)\n        view.inputState.compositionFirstChange = true;\n    if (view.inputState.composing < 0) {\n        // FIXME possibly set a timeout to clear it again on Android\n        view.inputState.composing = 0;\n    }\n};\nhandlers.compositionend = view => {\n    view.inputState.composing = -1;\n    view.inputState.compositionEndedAt = Date.now();\n    view.inputState.compositionFirstChange = null;\n    if (browser.chrome && browser.android)\n        view.observer.flushSoon();\n    setTimeout(() => {\n        // Force the composition state to be cleared if it hasn't already been\n        if (view.inputState.composing < 0 && view.docView.compositionDeco.size)\n            view.update([]);\n    }, 50);\n};\nhandlers.contextmenu = view => {\n    view.inputState.lastContextMenu = Date.now();\n};\nhandlers.beforeinput = (view, event) => {\n    var _a;\n    // Because Chrome Android doesn't fire useful key events, use\n    // beforeinput to detect backspace (and possibly enter and delete,\n    // but those usually don't even seem to fire beforeinput events at\n    // the moment) and fake a key event for it.\n    //\n    // (preventDefault on beforeinput, though supported in the spec,\n    // seems to do nothing at all on Chrome).\n    let pending;\n    if (browser.chrome && browser.android && (pending = PendingKeys.find(key => key.inputType == event.inputType))) {\n        view.observer.delayAndroidKey(pending.key, pending.keyCode);\n        if (pending.key == \"Backspace\" || pending.key == \"Delete\") {\n            let startViewHeight = ((_a = window.visualViewport) === null || _a === void 0 ? void 0 : _a.height) || 0;\n            setTimeout(() => {\n                var _a;\n                // Backspacing near uneditable nodes on Chrome Android sometimes\n                // closes the virtual keyboard. This tries to crudely detect\n                // that and refocus to get it back.\n                if ((((_a = window.visualViewport) === null || _a === void 0 ? void 0 : _a.height) || 0) > startViewHeight + 10 && view.hasFocus) {\n                    view.contentDOM.blur();\n                    view.focus();\n                }\n            }, 100);\n        }\n    }\n};\n\nconst wrappingWhiteSpace = [\"pre-wrap\", \"normal\", \"pre-line\", \"break-spaces\"];\nclass HeightOracle {\n    constructor(lineWrapping) {\n        this.lineWrapping = lineWrapping;\n        this.doc = Text.empty;\n        this.heightSamples = {};\n        this.lineHeight = 14;\n        this.charWidth = 7;\n        this.lineLength = 30;\n        // Used to track, during updateHeight, if any actual heights changed\n        this.heightChanged = false;\n    }\n    heightForGap(from, to) {\n        let lines = this.doc.lineAt(to).number - this.doc.lineAt(from).number + 1;\n        if (this.lineWrapping)\n            lines += Math.max(0, Math.ceil(((to - from) - (lines * this.lineLength * 0.5)) / this.lineLength));\n        return this.lineHeight * lines;\n    }\n    heightForLine(length) {\n        if (!this.lineWrapping)\n            return this.lineHeight;\n        let lines = 1 + Math.max(0, Math.ceil((length - this.lineLength) / (this.lineLength - 5)));\n        return lines * this.lineHeight;\n    }\n    setDoc(doc) { this.doc = doc; return this; }\n    mustRefreshForWrapping(whiteSpace) {\n        return (wrappingWhiteSpace.indexOf(whiteSpace) > -1) != this.lineWrapping;\n    }\n    mustRefreshForHeights(lineHeights) {\n        let newHeight = false;\n        for (let i = 0; i < lineHeights.length; i++) {\n            let h = lineHeights[i];\n            if (h < 0) {\n                i++;\n            }\n            else if (!this.heightSamples[Math.floor(h * 10)]) { // Round to .1 pixels\n                newHeight = true;\n                this.heightSamples[Math.floor(h * 10)] = true;\n            }\n        }\n        return newHeight;\n    }\n    refresh(whiteSpace, lineHeight, charWidth, lineLength, knownHeights) {\n        let lineWrapping = wrappingWhiteSpace.indexOf(whiteSpace) > -1;\n        let changed = Math.round(lineHeight) != Math.round(this.lineHeight) || this.lineWrapping != lineWrapping;\n        this.lineWrapping = lineWrapping;\n        this.lineHeight = lineHeight;\n        this.charWidth = charWidth;\n        this.lineLength = lineLength;\n        if (changed) {\n            this.heightSamples = {};\n            for (let i = 0; i < knownHeights.length; i++) {\n                let h = knownHeights[i];\n                if (h < 0)\n                    i++;\n                else\n                    this.heightSamples[Math.floor(h * 10)] = true;\n            }\n        }\n        return changed;\n    }\n}\n// This object is used by `updateHeight` to make DOM measurements\n// arrive at the right nides. The `heights` array is a sequence of\n// block heights, starting from position `from`.\nclass MeasuredHeights {\n    constructor(from, heights) {\n        this.from = from;\n        this.heights = heights;\n        this.index = 0;\n    }\n    get more() { return this.index < this.heights.length; }\n}\n/**\nRecord used to represent information about a block-level element\nin the editor view.\n*/\nclass BlockInfo {\n    /**\n    @internal\n    */\n    constructor(\n    /**\n    The start of the element in the document.\n    */\n    from, \n    /**\n    The length of the element.\n    */\n    length, \n    /**\n    The top position of the element (relative to the top of the\n    document).\n    */\n    top, \n    /**\n    Its height.\n    */\n    height, \n    /**\n    The type of element this is. When querying lines, this may be\n    an array of all the blocks that make up the line.\n    */\n    type) {\n        this.from = from;\n        this.length = length;\n        this.top = top;\n        this.height = height;\n        this.type = type;\n    }\n    /**\n    The end of the element as a document position.\n    */\n    get to() { return this.from + this.length; }\n    /**\n    The bottom position of the element.\n    */\n    get bottom() { return this.top + this.height; }\n    /**\n    @internal\n    */\n    join(other) {\n        let detail = (Array.isArray(this.type) ? this.type : [this])\n            .concat(Array.isArray(other.type) ? other.type : [other]);\n        return new BlockInfo(this.from, this.length + other.length, this.top, this.height + other.height, detail);\n    }\n}\nvar QueryType = /*@__PURE__*/(function (QueryType) {\n    QueryType[QueryType[\"ByPos\"] = 0] = \"ByPos\";\n    QueryType[QueryType[\"ByHeight\"] = 1] = \"ByHeight\";\n    QueryType[QueryType[\"ByPosNoHeight\"] = 2] = \"ByPosNoHeight\";\nreturn QueryType})(QueryType || (QueryType = {}));\nconst Epsilon = 1e-3;\nclass HeightMap {\n    constructor(length, // The number of characters covered\n    height, // Height of this part of the document\n    flags = 2 /* Flag.Outdated */) {\n        this.length = length;\n        this.height = height;\n        this.flags = flags;\n    }\n    get outdated() { return (this.flags & 2 /* Flag.Outdated */) > 0; }\n    set outdated(value) { this.flags = (value ? 2 /* Flag.Outdated */ : 0) | (this.flags & ~2 /* Flag.Outdated */); }\n    setHeight(oracle, height) {\n        if (this.height != height) {\n            if (Math.abs(this.height - height) > Epsilon)\n                oracle.heightChanged = true;\n            this.height = height;\n        }\n    }\n    // Base case is to replace a leaf node, which simply builds a tree\n    // from the new nodes and returns that (HeightMapBranch and\n    // HeightMapGap override this to actually use from/to)\n    replace(_from, _to, nodes) {\n        return HeightMap.of(nodes);\n    }\n    // Again, these are base cases, and are overridden for branch and gap nodes.\n    decomposeLeft(_to, result) { result.push(this); }\n    decomposeRight(_from, result) { result.push(this); }\n    applyChanges(decorations, oldDoc, oracle, changes) {\n        let me = this, doc = oracle.doc;\n        for (let i = changes.length - 1; i >= 0; i--) {\n            let { fromA, toA, fromB, toB } = changes[i];\n            let start = me.lineAt(fromA, QueryType.ByPosNoHeight, oracle.setDoc(oldDoc), 0, 0);\n            let end = start.to >= toA ? start : me.lineAt(toA, QueryType.ByPosNoHeight, oracle, 0, 0);\n            toB += end.to - toA;\n            toA = end.to;\n            while (i > 0 && start.from <= changes[i - 1].toA) {\n                fromA = changes[i - 1].fromA;\n                fromB = changes[i - 1].fromB;\n                i--;\n                if (fromA < start.from)\n                    start = me.lineAt(fromA, QueryType.ByPosNoHeight, oracle, 0, 0);\n            }\n            fromB += start.from - fromA;\n            fromA = start.from;\n            let nodes = NodeBuilder.build(oracle.setDoc(doc), decorations, fromB, toB);\n            me = me.replace(fromA, toA, nodes);\n        }\n        return me.updateHeight(oracle, 0);\n    }\n    static empty() { return new HeightMapText(0, 0); }\n    // nodes uses null values to indicate the position of line breaks.\n    // There are never line breaks at the start or end of the array, or\n    // two line breaks next to each other, and the array isn't allowed\n    // to be empty (same restrictions as return value from the builder).\n    static of(nodes) {\n        if (nodes.length == 1)\n            return nodes[0];\n        let i = 0, j = nodes.length, before = 0, after = 0;\n        for (;;) {\n            if (i == j) {\n                if (before > after * 2) {\n                    let split = nodes[i - 1];\n                    if (split.break)\n                        nodes.splice(--i, 1, split.left, null, split.right);\n                    else\n                        nodes.splice(--i, 1, split.left, split.right);\n                    j += 1 + split.break;\n                    before -= split.size;\n                }\n                else if (after > before * 2) {\n                    let split = nodes[j];\n                    if (split.break)\n                        nodes.splice(j, 1, split.left, null, split.right);\n                    else\n                        nodes.splice(j, 1, split.left, split.right);\n                    j += 2 + split.break;\n                    after -= split.size;\n                }\n                else {\n                    break;\n                }\n            }\n            else if (before < after) {\n                let next = nodes[i++];\n                if (next)\n                    before += next.size;\n            }\n            else {\n                let next = nodes[--j];\n                if (next)\n                    after += next.size;\n            }\n        }\n        let brk = 0;\n        if (nodes[i - 1] == null) {\n            brk = 1;\n            i--;\n        }\n        else if (nodes[i] == null) {\n            brk = 1;\n            j++;\n        }\n        return new HeightMapBranch(HeightMap.of(nodes.slice(0, i)), brk, HeightMap.of(nodes.slice(j)));\n    }\n}\nHeightMap.prototype.size = 1;\nclass HeightMapBlock extends HeightMap {\n    constructor(length, height, type) {\n        super(length, height);\n        this.type = type;\n    }\n    blockAt(_height, _oracle, top, offset) {\n        return new BlockInfo(offset, this.length, top, this.height, this.type);\n    }\n    lineAt(_value, _type, oracle, top, offset) {\n        return this.blockAt(0, oracle, top, offset);\n    }\n    forEachLine(from, to, oracle, top, offset, f) {\n        if (from <= offset + this.length && to >= offset)\n            f(this.blockAt(0, oracle, top, offset));\n    }\n    updateHeight(oracle, offset = 0, _force = false, measured) {\n        if (measured && measured.from <= offset && measured.more)\n            this.setHeight(oracle, measured.heights[measured.index++]);\n        this.outdated = false;\n        return this;\n    }\n    toString() { return `block(${this.length})`; }\n}\nclass HeightMapText extends HeightMapBlock {\n    constructor(length, height) {\n        super(length, height, BlockType.Text);\n        this.collapsed = 0; // Amount of collapsed content in the line\n        this.widgetHeight = 0; // Maximum inline widget height\n    }\n    replace(_from, _to, nodes) {\n        let node = nodes[0];\n        if (nodes.length == 1 && (node instanceof HeightMapText || node instanceof HeightMapGap && (node.flags & 4 /* Flag.SingleLine */)) &&\n            Math.abs(this.length - node.length) < 10) {\n            if (node instanceof HeightMapGap)\n                node = new HeightMapText(node.length, this.height);\n            else\n                node.height = this.height;\n            if (!this.outdated)\n                node.outdated = false;\n            return node;\n        }\n        else {\n            return HeightMap.of(nodes);\n        }\n    }\n    updateHeight(oracle, offset = 0, force = false, measured) {\n        if (measured && measured.from <= offset && measured.more)\n            this.setHeight(oracle, measured.heights[measured.index++]);\n        else if (force || this.outdated)\n            this.setHeight(oracle, Math.max(this.widgetHeight, oracle.heightForLine(this.length - this.collapsed)));\n        this.outdated = false;\n        return this;\n    }\n    toString() {\n        return `line(${this.length}${this.collapsed ? -this.collapsed : \"\"}${this.widgetHeight ? \":\" + this.widgetHeight : \"\"})`;\n    }\n}\nclass HeightMapGap extends HeightMap {\n    constructor(length) { super(length, 0); }\n    heightMetrics(oracle, offset) {\n        let firstLine = oracle.doc.lineAt(offset).number, lastLine = oracle.doc.lineAt(offset + this.length).number;\n        let lines = lastLine - firstLine + 1;\n        let perLine, perChar = 0;\n        if (oracle.lineWrapping) {\n            let totalPerLine = Math.min(this.height, oracle.lineHeight * lines);\n            perLine = totalPerLine / lines;\n            perChar = (this.height - totalPerLine) / (this.length - lines - 1);\n        }\n        else {\n            perLine = this.height / lines;\n        }\n        return { firstLine, lastLine, perLine, perChar };\n    }\n    blockAt(height, oracle, top, offset) {\n        let { firstLine, lastLine, perLine, perChar } = this.heightMetrics(oracle, offset);\n        if (oracle.lineWrapping) {\n            let guess = offset + Math.round(Math.max(0, Math.min(1, (height - top) / this.height)) * this.length);\n            let line = oracle.doc.lineAt(guess), lineHeight = perLine + line.length * perChar;\n            let lineTop = Math.max(top, height - lineHeight / 2);\n            return new BlockInfo(line.from, line.length, lineTop, lineHeight, BlockType.Text);\n        }\n        else {\n            let line = Math.max(0, Math.min(lastLine - firstLine, Math.floor((height - top) / perLine)));\n            let { from, length } = oracle.doc.line(firstLine + line);\n            return new BlockInfo(from, length, top + perLine * line, perLine, BlockType.Text);\n        }\n    }\n    lineAt(value, type, oracle, top, offset) {\n        if (type == QueryType.ByHeight)\n            return this.blockAt(value, oracle, top, offset);\n        if (type == QueryType.ByPosNoHeight) {\n            let { from, to } = oracle.doc.lineAt(value);\n            return new BlockInfo(from, to - from, 0, 0, BlockType.Text);\n        }\n        let { firstLine, perLine, perChar } = this.heightMetrics(oracle, offset);\n        let line = oracle.doc.lineAt(value), lineHeight = perLine + line.length * perChar;\n        let linesAbove = line.number - firstLine;\n        let lineTop = top + perLine * linesAbove + perChar * (line.from - offset - linesAbove);\n        return new BlockInfo(line.from, line.length, Math.max(top, Math.min(lineTop, top + this.height - lineHeight)), lineHeight, BlockType.Text);\n    }\n    forEachLine(from, to, oracle, top, offset, f) {\n        from = Math.max(from, offset);\n        to = Math.min(to, offset + this.length);\n        let { firstLine, perLine, perChar } = this.heightMetrics(oracle, offset);\n        for (let pos = from, lineTop = top; pos <= to;) {\n            let line = oracle.doc.lineAt(pos);\n            if (pos == from) {\n                let linesAbove = line.number - firstLine;\n                lineTop += perLine * linesAbove + perChar * (from - offset - linesAbove);\n            }\n            let lineHeight = perLine + perChar * line.length;\n            f(new BlockInfo(line.from, line.length, lineTop, lineHeight, BlockType.Text));\n            lineTop += lineHeight;\n            pos = line.to + 1;\n        }\n    }\n    replace(from, to, nodes) {\n        let after = this.length - to;\n        if (after > 0) {\n            let last = nodes[nodes.length - 1];\n            if (last instanceof HeightMapGap)\n                nodes[nodes.length - 1] = new HeightMapGap(last.length + after);\n            else\n                nodes.push(null, new HeightMapGap(after - 1));\n        }\n        if (from > 0) {\n            let first = nodes[0];\n            if (first instanceof HeightMapGap)\n                nodes[0] = new HeightMapGap(from + first.length);\n            else\n                nodes.unshift(new HeightMapGap(from - 1), null);\n        }\n        return HeightMap.of(nodes);\n    }\n    decomposeLeft(to, result) {\n        result.push(new HeightMapGap(to - 1), null);\n    }\n    decomposeRight(from, result) {\n        result.push(null, new HeightMapGap(this.length - from - 1));\n    }\n    updateHeight(oracle, offset = 0, force = false, measured) {\n        let end = offset + this.length;\n        if (measured && measured.from <= offset + this.length && measured.more) {\n            // Fill in part of this gap with measured lines. We know there\n            // can't be widgets or collapsed ranges in those lines, because\n            // they would already have been added to the heightmap (gaps\n            // only contain plain text).\n            let nodes = [], pos = Math.max(offset, measured.from), singleHeight = -1;\n            if (measured.from > offset)\n                nodes.push(new HeightMapGap(measured.from - offset - 1).updateHeight(oracle, offset));\n            while (pos <= end && measured.more) {\n                let len = oracle.doc.lineAt(pos).length;\n                if (nodes.length)\n                    nodes.push(null);\n                let height = measured.heights[measured.index++];\n                if (singleHeight == -1)\n                    singleHeight = height;\n                else if (Math.abs(height - singleHeight) >= Epsilon)\n                    singleHeight = -2;\n                let line = new HeightMapText(len, height);\n                line.outdated = false;\n                nodes.push(line);\n                pos += len + 1;\n            }\n            if (pos <= end)\n                nodes.push(null, new HeightMapGap(end - pos).updateHeight(oracle, pos));\n            let result = HeightMap.of(nodes);\n            if (singleHeight < 0 || Math.abs(result.height - this.height) >= Epsilon ||\n                Math.abs(singleHeight - this.heightMetrics(oracle, offset).perLine) >= Epsilon)\n                oracle.heightChanged = true;\n            return result;\n        }\n        else if (force || this.outdated) {\n            this.setHeight(oracle, oracle.heightForGap(offset, offset + this.length));\n            this.outdated = false;\n        }\n        return this;\n    }\n    toString() { return `gap(${this.length})`; }\n}\nclass HeightMapBranch extends HeightMap {\n    constructor(left, brk, right) {\n        super(left.length + brk + right.length, left.height + right.height, brk | (left.outdated || right.outdated ? 2 /* Flag.Outdated */ : 0));\n        this.left = left;\n        this.right = right;\n        this.size = left.size + right.size;\n    }\n    get break() { return this.flags & 1 /* Flag.Break */; }\n    blockAt(height, oracle, top, offset) {\n        let mid = top + this.left.height;\n        return height < mid ? this.left.blockAt(height, oracle, top, offset)\n            : this.right.blockAt(height, oracle, mid, offset + this.left.length + this.break);\n    }\n    lineAt(value, type, oracle, top, offset) {\n        let rightTop = top + this.left.height, rightOffset = offset + this.left.length + this.break;\n        let left = type == QueryType.ByHeight ? value < rightTop : value < rightOffset;\n        let base = left ? this.left.lineAt(value, type, oracle, top, offset)\n            : this.right.lineAt(value, type, oracle, rightTop, rightOffset);\n        if (this.break || (left ? base.to < rightOffset : base.from > rightOffset))\n            return base;\n        let subQuery = type == QueryType.ByPosNoHeight ? QueryType.ByPosNoHeight : QueryType.ByPos;\n        if (left)\n            return base.join(this.right.lineAt(rightOffset, subQuery, oracle, rightTop, rightOffset));\n        else\n            return this.left.lineAt(rightOffset, subQuery, oracle, top, offset).join(base);\n    }\n    forEachLine(from, to, oracle, top, offset, f) {\n        let rightTop = top + this.left.height, rightOffset = offset + this.left.length + this.break;\n        if (this.break) {\n            if (from < rightOffset)\n                this.left.forEachLine(from, to, oracle, top, offset, f);\n            if (to >= rightOffset)\n                this.right.forEachLine(from, to, oracle, rightTop, rightOffset, f);\n        }\n        else {\n            let mid = this.lineAt(rightOffset, QueryType.ByPos, oracle, top, offset);\n            if (from < mid.from)\n                this.left.forEachLine(from, mid.from - 1, oracle, top, offset, f);\n            if (mid.to >= from && mid.from <= to)\n                f(mid);\n            if (to > mid.to)\n                this.right.forEachLine(mid.to + 1, to, oracle, rightTop, rightOffset, f);\n        }\n    }\n    replace(from, to, nodes) {\n        let rightStart = this.left.length + this.break;\n        if (to < rightStart)\n            return this.balanced(this.left.replace(from, to, nodes), this.right);\n        if (from > this.left.length)\n            return this.balanced(this.left, this.right.replace(from - rightStart, to - rightStart, nodes));\n        let result = [];\n        if (from > 0)\n            this.decomposeLeft(from, result);\n        let left = result.length;\n        for (let node of nodes)\n            result.push(node);\n        if (from > 0)\n            mergeGaps(result, left - 1);\n        if (to < this.length) {\n            let right = result.length;\n            this.decomposeRight(to, result);\n            mergeGaps(result, right);\n        }\n        return HeightMap.of(result);\n    }\n    decomposeLeft(to, result) {\n        let left = this.left.length;\n        if (to <= left)\n            return this.left.decomposeLeft(to, result);\n        result.push(this.left);\n        if (this.break) {\n            left++;\n            if (to >= left)\n                result.push(null);\n        }\n        if (to > left)\n            this.right.decomposeLeft(to - left, result);\n    }\n    decomposeRight(from, result) {\n        let left = this.left.length, right = left + this.break;\n        if (from >= right)\n            return this.right.decomposeRight(from - right, result);\n        if (from < left)\n            this.left.decomposeRight(from, result);\n        if (this.break && from < right)\n            result.push(null);\n        result.push(this.right);\n    }\n    balanced(left, right) {\n        if (left.size > 2 * right.size || right.size > 2 * left.size)\n            return HeightMap.of(this.break ? [left, null, right] : [left, right]);\n        this.left = left;\n        this.right = right;\n        this.height = left.height + right.height;\n        this.outdated = left.outdated || right.outdated;\n        this.size = left.size + right.size;\n        this.length = left.length + this.break + right.length;\n        return this;\n    }\n    updateHeight(oracle, offset = 0, force = false, measured) {\n        let { left, right } = this, rightStart = offset + left.length + this.break, rebalance = null;\n        if (measured && measured.from <= offset + left.length && measured.more)\n            rebalance = left = left.updateHeight(oracle, offset, force, measured);\n        else\n            left.updateHeight(oracle, offset, force);\n        if (measured && measured.from <= rightStart + right.length && measured.more)\n            rebalance = right = right.updateHeight(oracle, rightStart, force, measured);\n        else\n            right.updateHeight(oracle, rightStart, force);\n        if (rebalance)\n            return this.balanced(left, right);\n        this.height = this.left.height + this.right.height;\n        this.outdated = false;\n        return this;\n    }\n    toString() { return this.left + (this.break ? \" \" : \"-\") + this.right; }\n}\nfunction mergeGaps(nodes, around) {\n    let before, after;\n    if (nodes[around] == null &&\n        (before = nodes[around - 1]) instanceof HeightMapGap &&\n        (after = nodes[around + 1]) instanceof HeightMapGap)\n        nodes.splice(around - 1, 3, new HeightMapGap(before.length + 1 + after.length));\n}\nconst relevantWidgetHeight = 5;\nclass NodeBuilder {\n    constructor(pos, oracle) {\n        this.pos = pos;\n        this.oracle = oracle;\n        this.nodes = [];\n        this.lineStart = -1;\n        this.lineEnd = -1;\n        this.covering = null;\n        this.writtenTo = pos;\n    }\n    get isCovered() {\n        return this.covering && this.nodes[this.nodes.length - 1] == this.covering;\n    }\n    span(_from, to) {\n        if (this.lineStart > -1) {\n            let end = Math.min(to, this.lineEnd), last = this.nodes[this.nodes.length - 1];\n            if (last instanceof HeightMapText)\n                last.length += end - this.pos;\n            else if (end > this.pos || !this.isCovered)\n                this.nodes.push(new HeightMapText(end - this.pos, -1));\n            this.writtenTo = end;\n            if (to > end) {\n                this.nodes.push(null);\n                this.writtenTo++;\n                this.lineStart = -1;\n            }\n        }\n        this.pos = to;\n    }\n    point(from, to, deco) {\n        if (from < to || deco.heightRelevant) {\n            let height = deco.widget ? deco.widget.estimatedHeight : 0;\n            if (height < 0)\n                height = this.oracle.lineHeight;\n            let len = to - from;\n            if (deco.block) {\n                this.addBlock(new HeightMapBlock(len, height, deco.type));\n            }\n            else if (len || height >= relevantWidgetHeight) {\n                this.addLineDeco(height, len);\n            }\n        }\n        else if (to > from) {\n            this.span(from, to);\n        }\n        if (this.lineEnd > -1 && this.lineEnd < this.pos)\n            this.lineEnd = this.oracle.doc.lineAt(this.pos).to;\n    }\n    enterLine() {\n        if (this.lineStart > -1)\n            return;\n        let { from, to } = this.oracle.doc.lineAt(this.pos);\n        this.lineStart = from;\n        this.lineEnd = to;\n        if (this.writtenTo < from) {\n            if (this.writtenTo < from - 1 || this.nodes[this.nodes.length - 1] == null)\n                this.nodes.push(this.blankContent(this.writtenTo, from - 1));\n            this.nodes.push(null);\n        }\n        if (this.pos > from)\n            this.nodes.push(new HeightMapText(this.pos - from, -1));\n        this.writtenTo = this.pos;\n    }\n    blankContent(from, to) {\n        let gap = new HeightMapGap(to - from);\n        if (this.oracle.doc.lineAt(from).to == to)\n            gap.flags |= 4 /* Flag.SingleLine */;\n        return gap;\n    }\n    ensureLine() {\n        this.enterLine();\n        let last = this.nodes.length ? this.nodes[this.nodes.length - 1] : null;\n        if (last instanceof HeightMapText)\n            return last;\n        let line = new HeightMapText(0, -1);\n        this.nodes.push(line);\n        return line;\n    }\n    addBlock(block) {\n        this.enterLine();\n        if (block.type == BlockType.WidgetAfter && !this.isCovered)\n            this.ensureLine();\n        this.nodes.push(block);\n        this.writtenTo = this.pos = this.pos + block.length;\n        if (block.type != BlockType.WidgetBefore)\n            this.covering = block;\n    }\n    addLineDeco(height, length) {\n        let line = this.ensureLine();\n        line.length += length;\n        line.collapsed += length;\n        line.widgetHeight = Math.max(line.widgetHeight, height);\n        this.writtenTo = this.pos = this.pos + length;\n    }\n    finish(from) {\n        let last = this.nodes.length == 0 ? null : this.nodes[this.nodes.length - 1];\n        if (this.lineStart > -1 && !(last instanceof HeightMapText) && !this.isCovered)\n            this.nodes.push(new HeightMapText(0, -1));\n        else if (this.writtenTo < this.pos || last == null)\n            this.nodes.push(this.blankContent(this.writtenTo, this.pos));\n        let pos = from;\n        for (let node of this.nodes) {\n            if (node instanceof HeightMapText)\n                node.updateHeight(this.oracle, pos);\n            pos += node ? node.length : 1;\n        }\n        return this.nodes;\n    }\n    // Always called with a region that on both sides either stretches\n    // to a line break or the end of the document.\n    // The returned array uses null to indicate line breaks, but never\n    // starts or ends in a line break, or has multiple line breaks next\n    // to each other.\n    static build(oracle, decorations, from, to) {\n        let builder = new NodeBuilder(from, oracle);\n        RangeSet.spans(decorations, from, to, builder, 0);\n        return builder.finish(from);\n    }\n}\nfunction heightRelevantDecoChanges(a, b, diff) {\n    let comp = new DecorationComparator;\n    RangeSet.compare(a, b, diff, comp, 0);\n    return comp.changes;\n}\nclass DecorationComparator {\n    constructor() {\n        this.changes = [];\n    }\n    compareRange() { }\n    comparePoint(from, to, a, b) {\n        if (from < to || a && a.heightRelevant || b && b.heightRelevant)\n            addRange(from, to, this.changes, 5);\n    }\n}\n\nfunction visiblePixelRange(dom, paddingTop) {\n    let rect = dom.getBoundingClientRect();\n    let doc = dom.ownerDocument, win = doc.defaultView || window;\n    let left = Math.max(0, rect.left), right = Math.min(win.innerWidth, rect.right);\n    let top = Math.max(0, rect.top), bottom = Math.min(win.innerHeight, rect.bottom);\n    for (let parent = dom.parentNode; parent && parent != doc.body;) {\n        if (parent.nodeType == 1) {\n            let elt = parent;\n            let style = window.getComputedStyle(elt);\n            if ((elt.scrollHeight > elt.clientHeight || elt.scrollWidth > elt.clientWidth) &&\n                style.overflow != \"visible\") {\n                let parentRect = elt.getBoundingClientRect();\n                left = Math.max(left, parentRect.left);\n                right = Math.min(right, parentRect.right);\n                top = Math.max(top, parentRect.top);\n                bottom = parent == dom.parentNode ? parentRect.bottom : Math.min(bottom, parentRect.bottom);\n            }\n            parent = style.position == \"absolute\" || style.position == \"fixed\" ? elt.offsetParent : elt.parentNode;\n        }\n        else if (parent.nodeType == 11) { // Shadow root\n            parent = parent.host;\n        }\n        else {\n            break;\n        }\n    }\n    return { left: left - rect.left, right: Math.max(left, right) - rect.left,\n        top: top - (rect.top + paddingTop), bottom: Math.max(top, bottom) - (rect.top + paddingTop) };\n}\nfunction fullPixelRange(dom, paddingTop) {\n    let rect = dom.getBoundingClientRect();\n    return { left: 0, right: rect.right - rect.left,\n        top: paddingTop, bottom: rect.bottom - (rect.top + paddingTop) };\n}\n// Line gaps are placeholder widgets used to hide pieces of overlong\n// lines within the viewport, as a kludge to keep the editor\n// responsive when a ridiculously long line is loaded into it.\nclass LineGap {\n    constructor(from, to, size) {\n        this.from = from;\n        this.to = to;\n        this.size = size;\n    }\n    static same(a, b) {\n        if (a.length != b.length)\n            return false;\n        for (let i = 0; i < a.length; i++) {\n            let gA = a[i], gB = b[i];\n            if (gA.from != gB.from || gA.to != gB.to || gA.size != gB.size)\n                return false;\n        }\n        return true;\n    }\n    draw(wrapping) {\n        return Decoration.replace({ widget: new LineGapWidget(this.size, wrapping) }).range(this.from, this.to);\n    }\n}\nclass LineGapWidget extends WidgetType {\n    constructor(size, vertical) {\n        super();\n        this.size = size;\n        this.vertical = vertical;\n    }\n    eq(other) { return other.size == this.size && other.vertical == this.vertical; }\n    toDOM() {\n        let elt = document.createElement(\"div\");\n        if (this.vertical) {\n            elt.style.height = this.size + \"px\";\n        }\n        else {\n            elt.style.width = this.size + \"px\";\n            elt.style.height = \"2px\";\n            elt.style.display = \"inline-block\";\n        }\n        return elt;\n    }\n    get estimatedHeight() { return this.vertical ? this.size : -1; }\n}\nclass ViewState {\n    constructor(state) {\n        this.state = state;\n        // These are contentDOM-local coordinates\n        this.pixelViewport = { left: 0, right: window.innerWidth, top: 0, bottom: 0 };\n        this.inView = true;\n        this.paddingTop = 0;\n        this.paddingBottom = 0;\n        this.contentDOMWidth = 0;\n        this.contentDOMHeight = 0;\n        this.editorHeight = 0;\n        this.editorWidth = 0;\n        // See VP.MaxDOMHeight\n        this.scaler = IdScaler;\n        this.scrollTarget = null;\n        // Briefly set to true when printing, to disable viewport limiting\n        this.printing = false;\n        // Flag set when editor content was redrawn, so that the next\n        // measure stage knows it must read DOM layout\n        this.mustMeasureContent = true;\n        this.defaultTextDirection = Direction.LTR;\n        this.visibleRanges = [];\n        // Cursor 'assoc' is only significant when the cursor is on a line\n        // wrap point, where it must stick to the character that it is\n        // associated with. Since browsers don't provide a reasonable\n        // interface to set or query this, when a selection is set that\n        // might cause this to be significant, this flag is set. The next\n        // measure phase will check whether the cursor is on a line-wrapping\n        // boundary and, if so, reset it to make sure it is positioned in\n        // the right place.\n        this.mustEnforceCursorAssoc = false;\n        let guessWrapping = state.facet(contentAttributes).some(v => typeof v != \"function\" && v.class == \"cm-lineWrapping\");\n        this.heightOracle = new HeightOracle(guessWrapping);\n        this.stateDeco = state.facet(decorations).filter(d => typeof d != \"function\");\n        this.heightMap = HeightMap.empty().applyChanges(this.stateDeco, Text.empty, this.heightOracle.setDoc(state.doc), [new ChangedRange(0, 0, 0, state.doc.length)]);\n        this.viewport = this.getViewport(0, null);\n        this.updateViewportLines();\n        this.updateForViewport();\n        this.lineGaps = this.ensureLineGaps([]);\n        this.lineGapDeco = Decoration.set(this.lineGaps.map(gap => gap.draw(false)));\n        this.computeVisibleRanges();\n    }\n    updateForViewport() {\n        let viewports = [this.viewport], { main } = this.state.selection;\n        for (let i = 0; i <= 1; i++) {\n            let pos = i ? main.head : main.anchor;\n            if (!viewports.some(({ from, to }) => pos >= from && pos <= to)) {\n                let { from, to } = this.lineBlockAt(pos);\n                viewports.push(new Viewport(from, to));\n            }\n        }\n        this.viewports = viewports.sort((a, b) => a.from - b.from);\n        this.scaler = this.heightMap.height <= 7000000 /* VP.MaxDOMHeight */ ? IdScaler :\n            new BigScaler(this.heightOracle, this.heightMap, this.viewports);\n    }\n    updateViewportLines() {\n        this.viewportLines = [];\n        this.heightMap.forEachLine(this.viewport.from, this.viewport.to, this.heightOracle.setDoc(this.state.doc), 0, 0, block => {\n            this.viewportLines.push(this.scaler.scale == 1 ? block : scaleBlock(block, this.scaler));\n        });\n    }\n    update(update, scrollTarget = null) {\n        this.state = update.state;\n        let prevDeco = this.stateDeco;\n        this.stateDeco = this.state.facet(decorations).filter(d => typeof d != \"function\");\n        let contentChanges = update.changedRanges;\n        let heightChanges = ChangedRange.extendWithRanges(contentChanges, heightRelevantDecoChanges(prevDeco, this.stateDeco, update ? update.changes : ChangeSet.empty(this.state.doc.length)));\n        let prevHeight = this.heightMap.height;\n        this.heightMap = this.heightMap.applyChanges(this.stateDeco, update.startState.doc, this.heightOracle.setDoc(this.state.doc), heightChanges);\n        if (this.heightMap.height != prevHeight)\n            update.flags |= 2 /* UpdateFlag.Height */;\n        let viewport = heightChanges.length ? this.mapViewport(this.viewport, update.changes) : this.viewport;\n        if (scrollTarget && (scrollTarget.range.head < viewport.from || scrollTarget.range.head > viewport.to) ||\n            !this.viewportIsAppropriate(viewport))\n            viewport = this.getViewport(0, scrollTarget);\n        let updateLines = !update.changes.empty || (update.flags & 2 /* UpdateFlag.Height */) ||\n            viewport.from != this.viewport.from || viewport.to != this.viewport.to;\n        this.viewport = viewport;\n        this.updateForViewport();\n        if (updateLines)\n            this.updateViewportLines();\n        if (this.lineGaps.length || this.viewport.to - this.viewport.from > (2000 /* LG.Margin */ << 1))\n            this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps, update.changes)));\n        update.flags |= this.computeVisibleRanges();\n        if (scrollTarget)\n            this.scrollTarget = scrollTarget;\n        if (!this.mustEnforceCursorAssoc && update.selectionSet && update.view.lineWrapping &&\n            update.state.selection.main.empty && update.state.selection.main.assoc &&\n            !update.state.facet(nativeSelectionHidden))\n            this.mustEnforceCursorAssoc = true;\n    }\n    measure(view) {\n        let dom = view.contentDOM, style = window.getComputedStyle(dom);\n        let oracle = this.heightOracle;\n        let whiteSpace = style.whiteSpace;\n        this.defaultTextDirection = style.direction == \"rtl\" ? Direction.RTL : Direction.LTR;\n        let refresh = this.heightOracle.mustRefreshForWrapping(whiteSpace);\n        let domRect = dom.getBoundingClientRect();\n        let measureContent = refresh || this.mustMeasureContent || this.contentDOMHeight != domRect.height;\n        this.contentDOMHeight = domRect.height;\n        this.mustMeasureContent = false;\n        let result = 0, bias = 0;\n        // Vertical padding\n        let paddingTop = parseInt(style.paddingTop) || 0, paddingBottom = parseInt(style.paddingBottom) || 0;\n        if (this.paddingTop != paddingTop || this.paddingBottom != paddingBottom) {\n            this.paddingTop = paddingTop;\n            this.paddingBottom = paddingBottom;\n            result |= 8 /* UpdateFlag.Geometry */ | 2 /* UpdateFlag.Height */;\n        }\n        if (this.editorWidth != view.scrollDOM.clientWidth) {\n            if (oracle.lineWrapping)\n                measureContent = true;\n            this.editorWidth = view.scrollDOM.clientWidth;\n            result |= 8 /* UpdateFlag.Geometry */;\n        }\n        // Pixel viewport\n        let pixelViewport = (this.printing ? fullPixelRange : visiblePixelRange)(dom, this.paddingTop);\n        let dTop = pixelViewport.top - this.pixelViewport.top, dBottom = pixelViewport.bottom - this.pixelViewport.bottom;\n        this.pixelViewport = pixelViewport;\n        let inView = this.pixelViewport.bottom > this.pixelViewport.top && this.pixelViewport.right > this.pixelViewport.left;\n        if (inView != this.inView) {\n            this.inView = inView;\n            if (inView)\n                measureContent = true;\n        }\n        if (!this.inView && !this.scrollTarget)\n            return 0;\n        let contentWidth = domRect.width;\n        if (this.contentDOMWidth != contentWidth || this.editorHeight != view.scrollDOM.clientHeight) {\n            this.contentDOMWidth = domRect.width;\n            this.editorHeight = view.scrollDOM.clientHeight;\n            result |= 8 /* UpdateFlag.Geometry */;\n        }\n        if (measureContent) {\n            let lineHeights = view.docView.measureVisibleLineHeights(this.viewport);\n            if (oracle.mustRefreshForHeights(lineHeights))\n                refresh = true;\n            if (refresh || oracle.lineWrapping && Math.abs(contentWidth - this.contentDOMWidth) > oracle.charWidth) {\n                let { lineHeight, charWidth } = view.docView.measureTextSize();\n                refresh = lineHeight > 0 && oracle.refresh(whiteSpace, lineHeight, charWidth, contentWidth / charWidth, lineHeights);\n                if (refresh) {\n                    view.docView.minWidth = 0;\n                    result |= 8 /* UpdateFlag.Geometry */;\n                }\n            }\n            if (dTop > 0 && dBottom > 0)\n                bias = Math.max(dTop, dBottom);\n            else if (dTop < 0 && dBottom < 0)\n                bias = Math.min(dTop, dBottom);\n            oracle.heightChanged = false;\n            for (let vp of this.viewports) {\n                let heights = vp.from == this.viewport.from ? lineHeights : view.docView.measureVisibleLineHeights(vp);\n                this.heightMap = (refresh ? HeightMap.empty().applyChanges(this.stateDeco, Text.empty, this.heightOracle, [new ChangedRange(0, 0, 0, view.state.doc.length)]) : this.heightMap).updateHeight(oracle, 0, refresh, new MeasuredHeights(vp.from, heights));\n            }\n            if (oracle.heightChanged)\n                result |= 2 /* UpdateFlag.Height */;\n        }\n        let viewportChange = !this.viewportIsAppropriate(this.viewport, bias) ||\n            this.scrollTarget && (this.scrollTarget.range.head < this.viewport.from ||\n                this.scrollTarget.range.head > this.viewport.to);\n        if (viewportChange)\n            this.viewport = this.getViewport(bias, this.scrollTarget);\n        this.updateForViewport();\n        if ((result & 2 /* UpdateFlag.Height */) || viewportChange)\n            this.updateViewportLines();\n        if (this.lineGaps.length || this.viewport.to - this.viewport.from > (2000 /* LG.Margin */ << 1))\n            this.updateLineGaps(this.ensureLineGaps(refresh ? [] : this.lineGaps, view));\n        result |= this.computeVisibleRanges();\n        if (this.mustEnforceCursorAssoc) {\n            this.mustEnforceCursorAssoc = false;\n            // This is done in the read stage, because moving the selection\n            // to a line end is going to trigger a layout anyway, so it\n            // can't be a pure write. It should be rare that it does any\n            // writing.\n            view.docView.enforceCursorAssoc();\n        }\n        return result;\n    }\n    get visibleTop() { return this.scaler.fromDOM(this.pixelViewport.top); }\n    get visibleBottom() { return this.scaler.fromDOM(this.pixelViewport.bottom); }\n    getViewport(bias, scrollTarget) {\n        // This will divide VP.Margin between the top and the\n        // bottom, depending on the bias (the change in viewport position\n        // since the last update). It'll hold a number between 0 and 1\n        let marginTop = 0.5 - Math.max(-0.5, Math.min(0.5, bias / 1000 /* VP.Margin */ / 2));\n        let map = this.heightMap, oracle = this.heightOracle;\n        let { visibleTop, visibleBottom } = this;\n        let viewport = new Viewport(map.lineAt(visibleTop - marginTop * 1000 /* VP.Margin */, QueryType.ByHeight, oracle, 0, 0).from, map.lineAt(visibleBottom + (1 - marginTop) * 1000 /* VP.Margin */, QueryType.ByHeight, oracle, 0, 0).to);\n        // If scrollTarget is given, make sure the viewport includes that position\n        if (scrollTarget) {\n            let { head } = scrollTarget.range;\n            if (head < viewport.from || head > viewport.to) {\n                let viewHeight = Math.min(this.editorHeight, this.pixelViewport.bottom - this.pixelViewport.top);\n                let block = map.lineAt(head, QueryType.ByPos, oracle, 0, 0), topPos;\n                if (scrollTarget.y == \"center\")\n                    topPos = (block.top + block.bottom) / 2 - viewHeight / 2;\n                else if (scrollTarget.y == \"start\" || scrollTarget.y == \"nearest\" && head < viewport.from)\n                    topPos = block.top;\n                else\n                    topPos = block.bottom - viewHeight;\n                viewport = new Viewport(map.lineAt(topPos - 1000 /* VP.Margin */ / 2, QueryType.ByHeight, oracle, 0, 0).from, map.lineAt(topPos + viewHeight + 1000 /* VP.Margin */ / 2, QueryType.ByHeight, oracle, 0, 0).to);\n            }\n        }\n        return viewport;\n    }\n    mapViewport(viewport, changes) {\n        let from = changes.mapPos(viewport.from, -1), to = changes.mapPos(viewport.to, 1);\n        return new Viewport(this.heightMap.lineAt(from, QueryType.ByPos, this.heightOracle, 0, 0).from, this.heightMap.lineAt(to, QueryType.ByPos, this.heightOracle, 0, 0).to);\n    }\n    // Checks if a given viewport covers the visible part of the\n    // document and not too much beyond that.\n    viewportIsAppropriate({ from, to }, bias = 0) {\n        if (!this.inView)\n            return true;\n        let { top } = this.heightMap.lineAt(from, QueryType.ByPos, this.heightOracle, 0, 0);\n        let { bottom } = this.heightMap.lineAt(to, QueryType.ByPos, this.heightOracle, 0, 0);\n        let { visibleTop, visibleBottom } = this;\n        return (from == 0 || top <= visibleTop - Math.max(10 /* VP.MinCoverMargin */, Math.min(-bias, 250 /* VP.MaxCoverMargin */))) &&\n            (to == this.state.doc.length ||\n                bottom >= visibleBottom + Math.max(10 /* VP.MinCoverMargin */, Math.min(bias, 250 /* VP.MaxCoverMargin */))) &&\n            (top > visibleTop - 2 * 1000 /* VP.Margin */ && bottom < visibleBottom + 2 * 1000 /* VP.Margin */);\n    }\n    mapLineGaps(gaps, changes) {\n        if (!gaps.length || changes.empty)\n            return gaps;\n        let mapped = [];\n        for (let gap of gaps)\n            if (!changes.touchesRange(gap.from, gap.to))\n                mapped.push(new LineGap(changes.mapPos(gap.from), changes.mapPos(gap.to), gap.size));\n        return mapped;\n    }\n    // Computes positions in the viewport where the start or end of a\n    // line should be hidden, trying to reuse existing line gaps when\n    // appropriate to avoid unneccesary redraws.\n    // Uses crude character-counting for the positioning and sizing,\n    // since actual DOM coordinates aren't always available and\n    // predictable. Relies on generous margins (see LG.Margin) to hide\n    // the artifacts this might produce from the user.\n    ensureLineGaps(current, mayMeasure) {\n        let wrapping = this.heightOracle.lineWrapping;\n        let margin = wrapping ? 10000 /* LG.MarginWrap */ : 2000 /* LG.Margin */, halfMargin = margin >> 1, doubleMargin = margin << 1;\n        // The non-wrapping logic won't work at all in predominantly right-to-left text.\n        if (this.defaultTextDirection != Direction.LTR && !wrapping)\n            return [];\n        let gaps = [];\n        let addGap = (from, to, line, structure) => {\n            if (to - from < halfMargin)\n                return;\n            let sel = this.state.selection.main, avoid = [sel.from];\n            if (!sel.empty)\n                avoid.push(sel.to);\n            for (let pos of avoid) {\n                if (pos > from && pos < to) {\n                    addGap(from, pos - 10 /* LG.SelectionMargin */, line, structure);\n                    addGap(pos + 10 /* LG.SelectionMargin */, to, line, structure);\n                    return;\n                }\n            }\n            let gap = find(current, gap => gap.from >= line.from && gap.to <= line.to &&\n                Math.abs(gap.from - from) < halfMargin && Math.abs(gap.to - to) < halfMargin &&\n                !avoid.some(pos => gap.from < pos && gap.to > pos));\n            if (!gap) {\n                // When scrolling down, snap gap ends to line starts to avoid shifts in wrapping\n                if (to < line.to && mayMeasure && wrapping &&\n                    mayMeasure.visibleRanges.some(r => r.from <= to && r.to >= to)) {\n                    let lineStart = mayMeasure.moveToLineBoundary(EditorSelection.cursor(to), false, true).head;\n                    if (lineStart > from)\n                        to = lineStart;\n                }\n                gap = new LineGap(from, to, this.gapSize(line, from, to, structure));\n            }\n            gaps.push(gap);\n        };\n        for (let line of this.viewportLines) {\n            if (line.length < doubleMargin)\n                continue;\n            let structure = lineStructure(line.from, line.to, this.stateDeco);\n            if (structure.total < doubleMargin)\n                continue;\n            let target = this.scrollTarget ? this.scrollTarget.range.head : null;\n            let viewFrom, viewTo;\n            if (wrapping) {\n                let marginHeight = (margin / this.heightOracle.lineLength) * this.heightOracle.lineHeight;\n                let top, bot;\n                if (target != null) {\n                    let targetFrac = findFraction(structure, target);\n                    let spaceFrac = ((this.visibleBottom - this.visibleTop) / 2 + marginHeight) / line.height;\n                    top = targetFrac - spaceFrac;\n                    bot = targetFrac + spaceFrac;\n                }\n                else {\n                    top = (this.visibleTop - line.top - marginHeight) / line.height;\n                    bot = (this.visibleBottom - line.top + marginHeight) / line.height;\n                }\n                viewFrom = findPosition(structure, top);\n                viewTo = findPosition(structure, bot);\n            }\n            else {\n                let totalWidth = structure.total * this.heightOracle.charWidth;\n                let marginWidth = margin * this.heightOracle.charWidth;\n                let left, right;\n                if (target != null) {\n                    let targetFrac = findFraction(structure, target);\n                    let spaceFrac = ((this.pixelViewport.right - this.pixelViewport.left) / 2 + marginWidth) / totalWidth;\n                    left = targetFrac - spaceFrac;\n                    right = targetFrac + spaceFrac;\n                }\n                else {\n                    left = (this.pixelViewport.left - marginWidth) / totalWidth;\n                    right = (this.pixelViewport.right + marginWidth) / totalWidth;\n                }\n                viewFrom = findPosition(structure, left);\n                viewTo = findPosition(structure, right);\n            }\n            if (viewFrom > line.from)\n                addGap(line.from, viewFrom, line, structure);\n            if (viewTo < line.to)\n                addGap(viewTo, line.to, line, structure);\n        }\n        return gaps;\n    }\n    gapSize(line, from, to, structure) {\n        let fraction = findFraction(structure, to) - findFraction(structure, from);\n        if (this.heightOracle.lineWrapping) {\n            return line.height * fraction;\n        }\n        else {\n            return structure.total * this.heightOracle.charWidth * fraction;\n        }\n    }\n    updateLineGaps(gaps) {\n        if (!LineGap.same(gaps, this.lineGaps)) {\n            this.lineGaps = gaps;\n            this.lineGapDeco = Decoration.set(gaps.map(gap => gap.draw(this.heightOracle.lineWrapping)));\n        }\n    }\n    computeVisibleRanges() {\n        let deco = this.stateDeco;\n        if (this.lineGaps.length)\n            deco = deco.concat(this.lineGapDeco);\n        let ranges = [];\n        RangeSet.spans(deco, this.viewport.from, this.viewport.to, {\n            span(from, to) { ranges.push({ from, to }); },\n            point() { }\n        }, 20);\n        let changed = ranges.length != this.visibleRanges.length ||\n            this.visibleRanges.some((r, i) => r.from != ranges[i].from || r.to != ranges[i].to);\n        this.visibleRanges = ranges;\n        return changed ? 4 /* UpdateFlag.Viewport */ : 0;\n    }\n    lineBlockAt(pos) {\n        return (pos >= this.viewport.from && pos <= this.viewport.to && this.viewportLines.find(b => b.from <= pos && b.to >= pos)) ||\n            scaleBlock(this.heightMap.lineAt(pos, QueryType.ByPos, this.heightOracle, 0, 0), this.scaler);\n    }\n    lineBlockAtHeight(height) {\n        return scaleBlock(this.heightMap.lineAt(this.scaler.fromDOM(height), QueryType.ByHeight, this.heightOracle, 0, 0), this.scaler);\n    }\n    elementAtHeight(height) {\n        return scaleBlock(this.heightMap.blockAt(this.scaler.fromDOM(height), this.heightOracle, 0, 0), this.scaler);\n    }\n    get docHeight() {\n        return this.scaler.toDOM(this.heightMap.height);\n    }\n    get contentHeight() {\n        return this.docHeight + this.paddingTop + this.paddingBottom;\n    }\n}\nclass Viewport {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n    }\n}\nfunction lineStructure(from, to, stateDeco) {\n    let ranges = [], pos = from, total = 0;\n    RangeSet.spans(stateDeco, from, to, {\n        span() { },\n        point(from, to) {\n            if (from > pos) {\n                ranges.push({ from: pos, to: from });\n                total += from - pos;\n            }\n            pos = to;\n        }\n    }, 20); // We're only interested in collapsed ranges of a significant size\n    if (pos < to) {\n        ranges.push({ from: pos, to });\n        total += to - pos;\n    }\n    return { total, ranges };\n}\nfunction findPosition({ total, ranges }, ratio) {\n    if (ratio <= 0)\n        return ranges[0].from;\n    if (ratio >= 1)\n        return ranges[ranges.length - 1].to;\n    let dist = Math.floor(total * ratio);\n    for (let i = 0;; i++) {\n        let { from, to } = ranges[i], size = to - from;\n        if (dist <= size)\n            return from + dist;\n        dist -= size;\n    }\n}\nfunction findFraction(structure, pos) {\n    let counted = 0;\n    for (let { from, to } of structure.ranges) {\n        if (pos <= to) {\n            counted += pos - from;\n            break;\n        }\n        counted += to - from;\n    }\n    return counted / structure.total;\n}\nfunction find(array, f) {\n    for (let val of array)\n        if (f(val))\n            return val;\n    return undefined;\n}\n// Don't scale when the document height is within the range of what\n// the DOM can handle.\nconst IdScaler = {\n    toDOM(n) { return n; },\n    fromDOM(n) { return n; },\n    scale: 1\n};\n// When the height is too big (> VP.MaxDOMHeight), scale down the\n// regions outside the viewports so that the total height is\n// VP.MaxDOMHeight.\nclass BigScaler {\n    constructor(oracle, heightMap, viewports) {\n        let vpHeight = 0, base = 0, domBase = 0;\n        this.viewports = viewports.map(({ from, to }) => {\n            let top = heightMap.lineAt(from, QueryType.ByPos, oracle, 0, 0).top;\n            let bottom = heightMap.lineAt(to, QueryType.ByPos, oracle, 0, 0).bottom;\n            vpHeight += bottom - top;\n            return { from, to, top, bottom, domTop: 0, domBottom: 0 };\n        });\n        this.scale = (7000000 /* VP.MaxDOMHeight */ - vpHeight) / (heightMap.height - vpHeight);\n        for (let obj of this.viewports) {\n            obj.domTop = domBase + (obj.top - base) * this.scale;\n            domBase = obj.domBottom = obj.domTop + (obj.bottom - obj.top);\n            base = obj.bottom;\n        }\n    }\n    toDOM(n) {\n        for (let i = 0, base = 0, domBase = 0;; i++) {\n            let vp = i < this.viewports.length ? this.viewports[i] : null;\n            if (!vp || n < vp.top)\n                return domBase + (n - base) * this.scale;\n            if (n <= vp.bottom)\n                return vp.domTop + (n - vp.top);\n            base = vp.bottom;\n            domBase = vp.domBottom;\n        }\n    }\n    fromDOM(n) {\n        for (let i = 0, base = 0, domBase = 0;; i++) {\n            let vp = i < this.viewports.length ? this.viewports[i] : null;\n            if (!vp || n < vp.domTop)\n                return base + (n - domBase) / this.scale;\n            if (n <= vp.domBottom)\n                return vp.top + (n - vp.domTop);\n            base = vp.bottom;\n            domBase = vp.domBottom;\n        }\n    }\n}\nfunction scaleBlock(block, scaler) {\n    if (scaler.scale == 1)\n        return block;\n    let bTop = scaler.toDOM(block.top), bBottom = scaler.toDOM(block.bottom);\n    return new BlockInfo(block.from, block.length, bTop, bBottom - bTop, Array.isArray(block.type) ? block.type.map(b => scaleBlock(b, scaler)) : block.type);\n}\n\nconst theme = /*@__PURE__*/Facet.define({ combine: strs => strs.join(\" \") });\nconst darkTheme = /*@__PURE__*/Facet.define({ combine: values => values.indexOf(true) > -1 });\nconst baseThemeID = /*@__PURE__*/StyleModule.newName(), baseLightID = /*@__PURE__*/StyleModule.newName(), baseDarkID = /*@__PURE__*/StyleModule.newName();\nconst lightDarkIDs = { \"&light\": \".\" + baseLightID, \"&dark\": \".\" + baseDarkID };\nfunction buildTheme(main, spec, scopes) {\n    return new StyleModule(spec, {\n        finish(sel) {\n            return /&/.test(sel) ? sel.replace(/&\\w*/, m => {\n                if (m == \"&\")\n                    return main;\n                if (!scopes || !scopes[m])\n                    throw new RangeError(`Unsupported selector: ${m}`);\n                return scopes[m];\n            }) : main + \" \" + sel;\n        }\n    });\n}\nconst baseTheme$1 = /*@__PURE__*/buildTheme(\".\" + baseThemeID, {\n    \"&\": {\n        position: \"relative !important\",\n        boxSizing: \"border-box\",\n        \"&.cm-focused\": {\n            // Provide a simple default outline to make sure a focused\n            // editor is visually distinct. Can't leave the default behavior\n            // because that will apply to the content element, which is\n            // inside the scrollable container and doesn't include the\n            // gutters. We also can't use an 'auto' outline, since those\n            // are, for some reason, drawn behind the element content, which\n            // will cause things like the active line background to cover\n            // the outline (#297).\n            outline: \"1px dotted #212121\"\n        },\n        display: \"flex !important\",\n        flexDirection: \"column\"\n    },\n    \".cm-scroller\": {\n        display: \"flex !important\",\n        alignItems: \"flex-start !important\",\n        fontFamily: \"monospace\",\n        lineHeight: 1.4,\n        height: \"100%\",\n        overflowX: \"auto\",\n        position: \"relative\",\n        zIndex: 0\n    },\n    \".cm-content\": {\n        margin: 0,\n        flexGrow: 2,\n        flexShrink: 0,\n        display: \"block\",\n        whiteSpace: \"pre\",\n        wordWrap: \"normal\",\n        boxSizing: \"border-box\",\n        padding: \"4px 0\",\n        outline: \"none\",\n        \"&[contenteditable=true]\": {\n            WebkitUserModify: \"read-write-plaintext-only\",\n        }\n    },\n    \".cm-lineWrapping\": {\n        whiteSpace_fallback: \"pre-wrap\",\n        whiteSpace: \"break-spaces\",\n        wordBreak: \"break-word\",\n        overflowWrap: \"anywhere\",\n        flexShrink: 1\n    },\n    \"&light .cm-content\": { caretColor: \"black\" },\n    \"&dark .cm-content\": { caretColor: \"white\" },\n    \".cm-line\": {\n        display: \"block\",\n        padding: \"0 2px 0 6px\"\n    },\n    \".cm-layer\": {\n        position: \"absolute\",\n        left: 0,\n        top: 0,\n        contain: \"size style\",\n        \"& > *\": {\n            position: \"absolute\"\n        }\n    },\n    \"&light .cm-selectionBackground\": {\n        background: \"#d9d9d9\"\n    },\n    \"&dark .cm-selectionBackground\": {\n        background: \"#222\"\n    },\n    \"&light.cm-focused .cm-selectionBackground\": {\n        background: \"#d7d4f0\"\n    },\n    \"&dark.cm-focused .cm-selectionBackground\": {\n        background: \"#233\"\n    },\n    \".cm-cursorLayer\": {\n        pointerEvents: \"none\"\n    },\n    \"&.cm-focused .cm-cursorLayer\": {\n        animation: \"steps(1) cm-blink 1.2s infinite\"\n    },\n    // Two animations defined so that we can switch between them to\n    // restart the animation without forcing another style\n    // recomputation.\n    \"@keyframes cm-blink\": { \"0%\": {}, \"50%\": { opacity: 0 }, \"100%\": {} },\n    \"@keyframes cm-blink2\": { \"0%\": {}, \"50%\": { opacity: 0 }, \"100%\": {} },\n    \".cm-cursor, .cm-dropCursor\": {\n        borderLeft: \"1.2px solid black\",\n        marginLeft: \"-0.6px\",\n        pointerEvents: \"none\",\n    },\n    \".cm-cursor\": {\n        display: \"none\"\n    },\n    \"&dark .cm-cursor\": {\n        borderLeftColor: \"#444\"\n    },\n    \".cm-dropCursor\": {\n        position: \"absolute\"\n    },\n    \"&.cm-focused .cm-cursor\": {\n        display: \"block\"\n    },\n    \"&light .cm-activeLine\": { backgroundColor: \"#cceeff44\" },\n    \"&dark .cm-activeLine\": { backgroundColor: \"#99eeff33\" },\n    \"&light .cm-specialChar\": { color: \"red\" },\n    \"&dark .cm-specialChar\": { color: \"#f78\" },\n    \".cm-gutters\": {\n        flexShrink: 0,\n        display: \"flex\",\n        height: \"100%\",\n        boxSizing: \"border-box\",\n        left: 0,\n        zIndex: 200\n    },\n    \"&light .cm-gutters\": {\n        backgroundColor: \"#f5f5f5\",\n        color: \"#6c6c6c\",\n        borderRight: \"1px solid #ddd\"\n    },\n    \"&dark .cm-gutters\": {\n        backgroundColor: \"#333338\",\n        color: \"#ccc\"\n    },\n    \".cm-gutter\": {\n        display: \"flex !important\",\n        flexDirection: \"column\",\n        flexShrink: 0,\n        boxSizing: \"border-box\",\n        minHeight: \"100%\",\n        overflow: \"hidden\"\n    },\n    \".cm-gutterElement\": {\n        boxSizing: \"border-box\"\n    },\n    \".cm-lineNumbers .cm-gutterElement\": {\n        padding: \"0 3px 0 5px\",\n        minWidth: \"20px\",\n        textAlign: \"right\",\n        whiteSpace: \"nowrap\"\n    },\n    \"&light .cm-activeLineGutter\": {\n        backgroundColor: \"#e2f2ff\"\n    },\n    \"&dark .cm-activeLineGutter\": {\n        backgroundColor: \"#222227\"\n    },\n    \".cm-panels\": {\n        boxSizing: \"border-box\",\n        position: \"sticky\",\n        left: 0,\n        right: 0\n    },\n    \"&light .cm-panels\": {\n        backgroundColor: \"#f5f5f5\",\n        color: \"black\"\n    },\n    \"&light .cm-panels-top\": {\n        borderBottom: \"1px solid #ddd\"\n    },\n    \"&light .cm-panels-bottom\": {\n        borderTop: \"1px solid #ddd\"\n    },\n    \"&dark .cm-panels\": {\n        backgroundColor: \"#333338\",\n        color: \"white\"\n    },\n    \".cm-tab\": {\n        display: \"inline-block\",\n        overflow: \"hidden\",\n        verticalAlign: \"bottom\"\n    },\n    \".cm-widgetBuffer\": {\n        verticalAlign: \"text-top\",\n        height: \"1em\",\n        width: 0,\n        display: \"inline\"\n    },\n    \".cm-placeholder\": {\n        color: \"#888\",\n        display: \"inline-block\",\n        verticalAlign: \"top\",\n    },\n    \".cm-highlightSpace:before\": {\n        content: \"attr(data-display)\",\n        position: \"absolute\",\n        pointerEvents: \"none\",\n        color: \"#888\"\n    },\n    \".cm-highlightTab\": {\n        backgroundImage: `url('data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"200\" height=\"20\"><path stroke=\"%23888\" stroke-width=\"1\" fill=\"none\" d=\"M1 10H196L190 5M190 15L196 10M197 4L197 16\"/></svg>')`,\n        backgroundSize: \"auto 100%\",\n        backgroundPosition: \"right 90%\",\n        backgroundRepeat: \"no-repeat\"\n    },\n    \".cm-trailingSpace\": {\n        backgroundColor: \"#ff332255\"\n    },\n    \".cm-button\": {\n        verticalAlign: \"middle\",\n        color: \"inherit\",\n        fontSize: \"70%\",\n        padding: \".2em 1em\",\n        borderRadius: \"1px\"\n    },\n    \"&light .cm-button\": {\n        backgroundImage: \"linear-gradient(#eff1f5, #d9d9df)\",\n        border: \"1px solid #888\",\n        \"&:active\": {\n            backgroundImage: \"linear-gradient(#b4b4b4, #d0d3d6)\"\n        }\n    },\n    \"&dark .cm-button\": {\n        backgroundImage: \"linear-gradient(#393939, #111)\",\n        border: \"1px solid #888\",\n        \"&:active\": {\n            backgroundImage: \"linear-gradient(#111, #333)\"\n        }\n    },\n    \".cm-textfield\": {\n        verticalAlign: \"middle\",\n        color: \"inherit\",\n        fontSize: \"70%\",\n        border: \"1px solid silver\",\n        padding: \".2em .5em\"\n    },\n    \"&light .cm-textfield\": {\n        backgroundColor: \"white\"\n    },\n    \"&dark .cm-textfield\": {\n        border: \"1px solid #555\",\n        backgroundColor: \"inherit\"\n    }\n}, lightDarkIDs);\n\nclass DOMChange {\n    constructor(view, start, end, typeOver) {\n        this.typeOver = typeOver;\n        this.bounds = null;\n        this.text = \"\";\n        let { impreciseHead: iHead, impreciseAnchor: iAnchor } = view.docView;\n        if (view.state.readOnly && start > -1) {\n            // Ignore changes when the editor is read-only\n            this.newSel = null;\n        }\n        else if (start > -1 && (this.bounds = view.docView.domBoundsAround(start, end, 0))) {\n            let selPoints = iHead || iAnchor ? [] : selectionPoints(view);\n            let reader = new DOMReader(selPoints, view.state);\n            reader.readRange(this.bounds.startDOM, this.bounds.endDOM);\n            this.text = reader.text;\n            this.newSel = selectionFromPoints(selPoints, this.bounds.from);\n        }\n        else {\n            let domSel = view.observer.selectionRange;\n            let head = iHead && iHead.node == domSel.focusNode && iHead.offset == domSel.focusOffset ||\n                !contains(view.contentDOM, domSel.focusNode)\n                ? view.state.selection.main.head\n                : view.docView.posFromDOM(domSel.focusNode, domSel.focusOffset);\n            let anchor = iAnchor && iAnchor.node == domSel.anchorNode && iAnchor.offset == domSel.anchorOffset ||\n                !contains(view.contentDOM, domSel.anchorNode)\n                ? view.state.selection.main.anchor\n                : view.docView.posFromDOM(domSel.anchorNode, domSel.anchorOffset);\n            this.newSel = EditorSelection.single(anchor, head);\n        }\n    }\n}\nfunction applyDOMChange(view, domChange) {\n    let change;\n    let { newSel } = domChange, sel = view.state.selection.main;\n    if (domChange.bounds) {\n        let { from, to } = domChange.bounds;\n        let preferredPos = sel.from, preferredSide = null;\n        // Prefer anchoring to end when Backspace is pressed (or, on\n        // Android, when something was deleted)\n        if (view.inputState.lastKeyCode === 8 && view.inputState.lastKeyTime > Date.now() - 100 ||\n            browser.android && domChange.text.length < to - from) {\n            preferredPos = sel.to;\n            preferredSide = \"end\";\n        }\n        let diff = findDiff(view.state.doc.sliceString(from, to, LineBreakPlaceholder), domChange.text, preferredPos - from, preferredSide);\n        if (diff) {\n            // Chrome inserts two newlines when pressing shift-enter at the\n            // end of a line. DomChange drops one of those.\n            if (browser.chrome && view.inputState.lastKeyCode == 13 &&\n                diff.toB == diff.from + 2 && domChange.text.slice(diff.from, diff.toB) == LineBreakPlaceholder + LineBreakPlaceholder)\n                diff.toB--;\n            change = { from: from + diff.from, to: from + diff.toA,\n                insert: Text.of(domChange.text.slice(diff.from, diff.toB).split(LineBreakPlaceholder)) };\n        }\n    }\n    else if (newSel && (!view.hasFocus && view.state.facet(editable) || newSel.main.eq(sel))) {\n        newSel = null;\n    }\n    if (!change && !newSel)\n        return false;\n    if (!change && domChange.typeOver && !sel.empty && newSel && newSel.main.empty) {\n        // Heuristic to notice typing over a selected character\n        change = { from: sel.from, to: sel.to, insert: view.state.doc.slice(sel.from, sel.to) };\n    }\n    else if (change && change.from >= sel.from && change.to <= sel.to &&\n        (change.from != sel.from || change.to != sel.to) &&\n        (sel.to - sel.from) - (change.to - change.from) <= 4) {\n        // If the change is inside the selection and covers most of it,\n        // assume it is a selection replace (with identical characters at\n        // the start/end not included in the diff)\n        change = {\n            from: sel.from, to: sel.to,\n            insert: view.state.doc.slice(sel.from, change.from).append(change.insert).append(view.state.doc.slice(change.to, sel.to))\n        };\n    }\n    else if ((browser.mac || browser.android) && change && change.from == change.to && change.from == sel.head - 1 &&\n        /^\\. ?$/.test(change.insert.toString()) && view.contentDOM.getAttribute(\"autocorrect\") == \"off\") {\n        // Detect insert-period-on-double-space Mac and Android behavior,\n        // and transform it into a regular space insert.\n        if (newSel && change.insert.length == 2)\n            newSel = EditorSelection.single(newSel.main.anchor - 1, newSel.main.head - 1);\n        change = { from: sel.from, to: sel.to, insert: Text.of([\" \"]) };\n    }\n    else if (browser.chrome && change && change.from == change.to && change.from == sel.head &&\n        change.insert.toString() == \"\\n \" && view.lineWrapping) {\n        // In Chrome, if you insert a space at the start of a wrapped\n        // line, it will actually insert a newline and a space, causing a\n        // bogus new line to be created in CodeMirror (#968)\n        if (newSel)\n            newSel = EditorSelection.single(newSel.main.anchor - 1, newSel.main.head - 1);\n        change = { from: sel.from, to: sel.to, insert: Text.of([\" \"]) };\n    }\n    if (change) {\n        let startState = view.state;\n        if (browser.ios && view.inputState.flushIOSKey(view))\n            return true;\n        // Android browsers don't fire reasonable key events for enter,\n        // backspace, or delete. So this detects changes that look like\n        // they're caused by those keys, and reinterprets them as key\n        // events. (Some of these keys are also handled by beforeinput\n        // events and the pendingAndroidKey mechanism, but that's not\n        // reliable in all situations.)\n        if (browser.android &&\n            ((change.from == sel.from && change.to == sel.to &&\n                change.insert.length == 1 && change.insert.lines == 2 &&\n                dispatchKey(view.contentDOM, \"Enter\", 13)) ||\n                (change.from == sel.from - 1 && change.to == sel.to && change.insert.length == 0 &&\n                    dispatchKey(view.contentDOM, \"Backspace\", 8)) ||\n                (change.from == sel.from && change.to == sel.to + 1 && change.insert.length == 0 &&\n                    dispatchKey(view.contentDOM, \"Delete\", 46))))\n            return true;\n        let text = change.insert.toString();\n        if (view.state.facet(inputHandler).some(h => h(view, change.from, change.to, text)))\n            return true;\n        if (view.inputState.composing >= 0)\n            view.inputState.composing++;\n        let tr;\n        if (change.from >= sel.from && change.to <= sel.to && change.to - change.from >= (sel.to - sel.from) / 3 &&\n            (!newSel || newSel.main.empty && newSel.main.from == change.from + change.insert.length) &&\n            view.inputState.composing < 0) {\n            let before = sel.from < change.from ? startState.sliceDoc(sel.from, change.from) : \"\";\n            let after = sel.to > change.to ? startState.sliceDoc(change.to, sel.to) : \"\";\n            tr = startState.replaceSelection(view.state.toText(before + change.insert.sliceString(0, undefined, view.state.lineBreak) + after));\n        }\n        else {\n            let changes = startState.changes(change);\n            let mainSel = newSel && !startState.selection.main.eq(newSel.main) && newSel.main.to <= changes.newLength\n                ? newSel.main : undefined;\n            // Try to apply a composition change to all cursors\n            if (startState.selection.ranges.length > 1 && view.inputState.composing >= 0 &&\n                change.to <= sel.to && change.to >= sel.to - 10) {\n                let replaced = view.state.sliceDoc(change.from, change.to);\n                let compositionRange = compositionSurroundingNode(view) || view.state.doc.lineAt(sel.head);\n                let offset = sel.to - change.to, size = sel.to - sel.from;\n                tr = startState.changeByRange(range => {\n                    if (range.from == sel.from && range.to == sel.to)\n                        return { changes, range: mainSel || range.map(changes) };\n                    let to = range.to - offset, from = to - replaced.length;\n                    if (range.to - range.from != size || view.state.sliceDoc(from, to) != replaced ||\n                        // Unfortunately, there's no way to make multiple\n                        // changes in the same node work without aborting\n                        // composition, so cursors in the composition range are\n                        // ignored.\n                        compositionRange && range.to >= compositionRange.from && range.from <= compositionRange.to)\n                        return { range };\n                    let rangeChanges = startState.changes({ from, to, insert: change.insert }), selOff = range.to - sel.to;\n                    return {\n                        changes: rangeChanges,\n                        range: !mainSel ? range.map(rangeChanges) :\n                            EditorSelection.range(Math.max(0, mainSel.anchor + selOff), Math.max(0, mainSel.head + selOff))\n                    };\n                });\n            }\n            else {\n                tr = {\n                    changes,\n                    selection: mainSel && startState.selection.replaceRange(mainSel)\n                };\n            }\n        }\n        let userEvent = \"input.type\";\n        if (view.composing) {\n            userEvent += \".compose\";\n            if (view.inputState.compositionFirstChange) {\n                userEvent += \".start\";\n                view.inputState.compositionFirstChange = false;\n            }\n        }\n        view.dispatch(tr, { scrollIntoView: true, userEvent });\n        return true;\n    }\n    else if (newSel && !newSel.main.eq(sel)) {\n        let scrollIntoView = false, userEvent = \"select\";\n        if (view.inputState.lastSelectionTime > Date.now() - 50) {\n            if (view.inputState.lastSelectionOrigin == \"select\")\n                scrollIntoView = true;\n            userEvent = view.inputState.lastSelectionOrigin;\n        }\n        view.dispatch({ selection: newSel, scrollIntoView, userEvent });\n        return true;\n    }\n    else {\n        return false;\n    }\n}\nfunction findDiff(a, b, preferredPos, preferredSide) {\n    let minLen = Math.min(a.length, b.length);\n    let from = 0;\n    while (from < minLen && a.charCodeAt(from) == b.charCodeAt(from))\n        from++;\n    if (from == minLen && a.length == b.length)\n        return null;\n    let toA = a.length, toB = b.length;\n    while (toA > 0 && toB > 0 && a.charCodeAt(toA - 1) == b.charCodeAt(toB - 1)) {\n        toA--;\n        toB--;\n    }\n    if (preferredSide == \"end\") {\n        let adjust = Math.max(0, from - Math.min(toA, toB));\n        preferredPos -= toA + adjust - from;\n    }\n    if (toA < from && a.length < b.length) {\n        let move = preferredPos <= from && preferredPos >= toA ? from - preferredPos : 0;\n        from -= move;\n        toB = from + (toB - toA);\n        toA = from;\n    }\n    else if (toB < from) {\n        let move = preferredPos <= from && preferredPos >= toB ? from - preferredPos : 0;\n        from -= move;\n        toA = from + (toA - toB);\n        toB = from;\n    }\n    return { from, toA, toB };\n}\nfunction selectionPoints(view) {\n    let result = [];\n    if (view.root.activeElement != view.contentDOM)\n        return result;\n    let { anchorNode, anchorOffset, focusNode, focusOffset } = view.observer.selectionRange;\n    if (anchorNode) {\n        result.push(new DOMPoint(anchorNode, anchorOffset));\n        if (focusNode != anchorNode || focusOffset != anchorOffset)\n            result.push(new DOMPoint(focusNode, focusOffset));\n    }\n    return result;\n}\nfunction selectionFromPoints(points, base) {\n    if (points.length == 0)\n        return null;\n    let anchor = points[0].pos, head = points.length == 2 ? points[1].pos : anchor;\n    return anchor > -1 && head > -1 ? EditorSelection.single(anchor + base, head + base) : null;\n}\n\nconst observeOptions = {\n    childList: true,\n    characterData: true,\n    subtree: true,\n    attributes: true,\n    characterDataOldValue: true\n};\n// IE11 has very broken mutation observers, so we also listen to\n// DOMCharacterDataModified there\nconst useCharData = browser.ie && browser.ie_version <= 11;\nclass DOMObserver {\n    constructor(view) {\n        this.view = view;\n        this.active = false;\n        // The known selection. Kept in our own object, as opposed to just\n        // directly accessing the selection because:\n        //  - Safari doesn't report the right selection in shadow DOM\n        //  - Reading from the selection forces a DOM layout\n        //  - This way, we can ignore selectionchange events if we have\n        //    already seen the 'new' selection\n        this.selectionRange = new DOMSelectionState;\n        // Set when a selection change is detected, cleared on flush\n        this.selectionChanged = false;\n        this.delayedFlush = -1;\n        this.resizeTimeout = -1;\n        this.queue = [];\n        this.delayedAndroidKey = null;\n        this.flushingAndroidKey = -1;\n        this.lastChange = 0;\n        this.scrollTargets = [];\n        this.intersection = null;\n        this.resizeScroll = null;\n        this.resizeContent = null;\n        this.intersecting = false;\n        this.gapIntersection = null;\n        this.gaps = [];\n        // Timeout for scheduling check of the parents that need scroll handlers\n        this.parentCheck = -1;\n        this.dom = view.contentDOM;\n        this.observer = new MutationObserver(mutations => {\n            for (let mut of mutations)\n                this.queue.push(mut);\n            // IE11 will sometimes (on typing over a selection or\n            // backspacing out a single character text node) call the\n            // observer callback before actually updating the DOM.\n            //\n            // Unrelatedly, iOS Safari will, when ending a composition,\n            // sometimes first clear it, deliver the mutations, and then\n            // reinsert the finished text. CodeMirror's handling of the\n            // deletion will prevent the reinsertion from happening,\n            // breaking composition.\n            if ((browser.ie && browser.ie_version <= 11 || browser.ios && view.composing) &&\n                mutations.some(m => m.type == \"childList\" && m.removedNodes.length ||\n                    m.type == \"characterData\" && m.oldValue.length > m.target.nodeValue.length))\n                this.flushSoon();\n            else\n                this.flush();\n        });\n        if (useCharData)\n            this.onCharData = (event) => {\n                this.queue.push({ target: event.target,\n                    type: \"characterData\",\n                    oldValue: event.prevValue });\n                this.flushSoon();\n            };\n        this.onSelectionChange = this.onSelectionChange.bind(this);\n        this.onResize = this.onResize.bind(this);\n        this.onPrint = this.onPrint.bind(this);\n        this.onScroll = this.onScroll.bind(this);\n        if (typeof ResizeObserver == \"function\") {\n            this.resizeScroll = new ResizeObserver(() => {\n                var _a;\n                if (((_a = this.view.docView) === null || _a === void 0 ? void 0 : _a.lastUpdate) < Date.now() - 75)\n                    this.onResize();\n            });\n            this.resizeScroll.observe(view.scrollDOM);\n            this.resizeContent = new ResizeObserver(() => this.view.requestMeasure());\n            this.resizeContent.observe(view.contentDOM);\n        }\n        this.addWindowListeners(this.win = view.win);\n        this.start();\n        if (typeof IntersectionObserver == \"function\") {\n            this.intersection = new IntersectionObserver(entries => {\n                if (this.parentCheck < 0)\n                    this.parentCheck = setTimeout(this.listenForScroll.bind(this), 1000);\n                if (entries.length > 0 && (entries[entries.length - 1].intersectionRatio > 0) != this.intersecting) {\n                    this.intersecting = !this.intersecting;\n                    if (this.intersecting != this.view.inView)\n                        this.onScrollChanged(document.createEvent(\"Event\"));\n                }\n            }, {});\n            this.intersection.observe(this.dom);\n            this.gapIntersection = new IntersectionObserver(entries => {\n                if (entries.length > 0 && entries[entries.length - 1].intersectionRatio > 0)\n                    this.onScrollChanged(document.createEvent(\"Event\"));\n            }, {});\n        }\n        this.listenForScroll();\n        this.readSelectionRange();\n    }\n    onScrollChanged(e) {\n        this.view.inputState.runScrollHandlers(this.view, e);\n        if (this.intersecting)\n            this.view.measure();\n    }\n    onScroll(e) {\n        if (this.intersecting)\n            this.flush(false);\n        this.onScrollChanged(e);\n    }\n    onResize() {\n        if (this.resizeTimeout < 0)\n            this.resizeTimeout = setTimeout(() => {\n                this.resizeTimeout = -1;\n                this.view.requestMeasure();\n            }, 50);\n    }\n    onPrint() {\n        this.view.viewState.printing = true;\n        this.view.measure();\n        setTimeout(() => {\n            this.view.viewState.printing = false;\n            this.view.requestMeasure();\n        }, 500);\n    }\n    updateGaps(gaps) {\n        if (this.gapIntersection && (gaps.length != this.gaps.length || this.gaps.some((g, i) => g != gaps[i]))) {\n            this.gapIntersection.disconnect();\n            for (let gap of gaps)\n                this.gapIntersection.observe(gap);\n            this.gaps = gaps;\n        }\n    }\n    onSelectionChange(event) {\n        let wasChanged = this.selectionChanged;\n        if (!this.readSelectionRange() || this.delayedAndroidKey)\n            return;\n        let { view } = this, sel = this.selectionRange;\n        if (view.state.facet(editable) ? view.root.activeElement != this.dom : !hasSelection(view.dom, sel))\n            return;\n        let context = sel.anchorNode && view.docView.nearest(sel.anchorNode);\n        if (context && context.ignoreEvent(event)) {\n            if (!wasChanged)\n                this.selectionChanged = false;\n            return;\n        }\n        // Deletions on IE11 fire their events in the wrong order, giving\n        // us a selection change event before the DOM changes are\n        // reported.\n        // Chrome Android has a similar issue when backspacing out a\n        // selection (#645).\n        if ((browser.ie && browser.ie_version <= 11 || browser.android && browser.chrome) && !view.state.selection.main.empty &&\n            // (Selection.isCollapsed isn't reliable on IE)\n            sel.focusNode && isEquivalentPosition(sel.focusNode, sel.focusOffset, sel.anchorNode, sel.anchorOffset))\n            this.flushSoon();\n        else\n            this.flush(false);\n    }\n    readSelectionRange() {\n        let { view } = this;\n        // The Selection object is broken in shadow roots in Safari. See\n        // https://github.com/codemirror/dev/issues/414\n        let range = browser.safari && view.root.nodeType == 11 &&\n            deepActiveElement(this.dom.ownerDocument) == this.dom &&\n            safariSelectionRangeHack(this.view) || getSelection(view.root);\n        if (!range || this.selectionRange.eq(range))\n            return false;\n        let local = hasSelection(this.dom, range);\n        // Detect the situation where the browser has, on focus, moved the\n        // selection to the start of the content element. Reset it to the\n        // position from the editor state.\n        if (local && !this.selectionChanged &&\n            view.inputState.lastFocusTime > Date.now() - 200 &&\n            view.inputState.lastTouchTime < Date.now() - 300 &&\n            atElementStart(this.dom, range)) {\n            this.view.inputState.lastFocusTime = 0;\n            view.docView.updateSelection();\n            return false;\n        }\n        this.selectionRange.setRange(range);\n        if (local)\n            this.selectionChanged = true;\n        return true;\n    }\n    setSelectionRange(anchor, head) {\n        this.selectionRange.set(anchor.node, anchor.offset, head.node, head.offset);\n        this.selectionChanged = false;\n    }\n    clearSelectionRange() {\n        this.selectionRange.set(null, 0, null, 0);\n    }\n    listenForScroll() {\n        this.parentCheck = -1;\n        let i = 0, changed = null;\n        for (let dom = this.dom; dom;) {\n            if (dom.nodeType == 1) {\n                if (!changed && i < this.scrollTargets.length && this.scrollTargets[i] == dom)\n                    i++;\n                else if (!changed)\n                    changed = this.scrollTargets.slice(0, i);\n                if (changed)\n                    changed.push(dom);\n                dom = dom.assignedSlot || dom.parentNode;\n            }\n            else if (dom.nodeType == 11) { // Shadow root\n                dom = dom.host;\n            }\n            else {\n                break;\n            }\n        }\n        if (i < this.scrollTargets.length && !changed)\n            changed = this.scrollTargets.slice(0, i);\n        if (changed) {\n            for (let dom of this.scrollTargets)\n                dom.removeEventListener(\"scroll\", this.onScroll);\n            for (let dom of this.scrollTargets = changed)\n                dom.addEventListener(\"scroll\", this.onScroll);\n        }\n    }\n    ignore(f) {\n        if (!this.active)\n            return f();\n        try {\n            this.stop();\n            return f();\n        }\n        finally {\n            this.start();\n            this.clear();\n        }\n    }\n    start() {\n        if (this.active)\n            return;\n        this.observer.observe(this.dom, observeOptions);\n        if (useCharData)\n            this.dom.addEventListener(\"DOMCharacterDataModified\", this.onCharData);\n        this.active = true;\n    }\n    stop() {\n        if (!this.active)\n            return;\n        this.active = false;\n        this.observer.disconnect();\n        if (useCharData)\n            this.dom.removeEventListener(\"DOMCharacterDataModified\", this.onCharData);\n    }\n    // Throw away any pending changes\n    clear() {\n        this.processRecords();\n        this.queue.length = 0;\n        this.selectionChanged = false;\n    }\n    // Chrome Android, especially in combination with GBoard, not only\n    // doesn't reliably fire regular key events, but also often\n    // surrounds the effect of enter or backspace with a bunch of\n    // composition events that, when interrupted, cause text duplication\n    // or other kinds of corruption. This hack makes the editor back off\n    // from handling DOM changes for a moment when such a key is\n    // detected (via beforeinput or keydown), and then tries to flush\n    // them or, if that has no effect, dispatches the given key.\n    delayAndroidKey(key, keyCode) {\n        var _a;\n        if (!this.delayedAndroidKey) {\n            let flush = () => {\n                let key = this.delayedAndroidKey;\n                if (key) {\n                    this.clearDelayedAndroidKey();\n                    if (!this.flush() && key.force)\n                        dispatchKey(this.dom, key.key, key.keyCode);\n                }\n            };\n            this.flushingAndroidKey = this.view.win.requestAnimationFrame(flush);\n        }\n        // Since backspace beforeinput is sometimes signalled spuriously,\n        // Enter always takes precedence.\n        if (!this.delayedAndroidKey || key == \"Enter\")\n            this.delayedAndroidKey = {\n                key, keyCode,\n                // Only run the key handler when no changes are detected if\n                // this isn't coming right after another change, in which case\n                // it is probably part of a weird chain of updates, and should\n                // be ignored if it returns the DOM to its previous state.\n                force: this.lastChange < Date.now() - 50 || !!((_a = this.delayedAndroidKey) === null || _a === void 0 ? void 0 : _a.force)\n            };\n    }\n    clearDelayedAndroidKey() {\n        this.win.cancelAnimationFrame(this.flushingAndroidKey);\n        this.delayedAndroidKey = null;\n        this.flushingAndroidKey = -1;\n    }\n    flushSoon() {\n        if (this.delayedFlush < 0)\n            this.delayedFlush = this.view.win.requestAnimationFrame(() => { this.delayedFlush = -1; this.flush(); });\n    }\n    forceFlush() {\n        if (this.delayedFlush >= 0) {\n            this.view.win.cancelAnimationFrame(this.delayedFlush);\n            this.delayedFlush = -1;\n        }\n        this.flush();\n    }\n    processRecords() {\n        let records = this.queue;\n        for (let mut of this.observer.takeRecords())\n            records.push(mut);\n        if (records.length)\n            this.queue = [];\n        let from = -1, to = -1, typeOver = false;\n        for (let record of records) {\n            let range = this.readMutation(record);\n            if (!range)\n                continue;\n            if (range.typeOver)\n                typeOver = true;\n            if (from == -1) {\n                ({ from, to } = range);\n            }\n            else {\n                from = Math.min(range.from, from);\n                to = Math.max(range.to, to);\n            }\n        }\n        return { from, to, typeOver };\n    }\n    readChange() {\n        let { from, to, typeOver } = this.processRecords();\n        let newSel = this.selectionChanged && hasSelection(this.dom, this.selectionRange);\n        if (from < 0 && !newSel)\n            return null;\n        if (from > -1)\n            this.lastChange = Date.now();\n        this.view.inputState.lastFocusTime = 0;\n        this.selectionChanged = false;\n        return new DOMChange(this.view, from, to, typeOver);\n    }\n    // Apply pending changes, if any\n    flush(readSelection = true) {\n        // Completely hold off flushing when pending keys are set—the code\n        // managing those will make sure processRecords is called and the\n        // view is resynchronized after\n        if (this.delayedFlush >= 0 || this.delayedAndroidKey)\n            return false;\n        if (readSelection)\n            this.readSelectionRange();\n        let domChange = this.readChange();\n        if (!domChange)\n            return false;\n        let startState = this.view.state;\n        let handled = applyDOMChange(this.view, domChange);\n        // The view wasn't updated\n        if (this.view.state == startState)\n            this.view.update([]);\n        return handled;\n    }\n    readMutation(rec) {\n        let cView = this.view.docView.nearest(rec.target);\n        if (!cView || cView.ignoreMutation(rec))\n            return null;\n        cView.markDirty(rec.type == \"attributes\");\n        if (rec.type == \"attributes\")\n            cView.dirty |= 4 /* Dirty.Attrs */;\n        if (rec.type == \"childList\") {\n            let childBefore = findChild(cView, rec.previousSibling || rec.target.previousSibling, -1);\n            let childAfter = findChild(cView, rec.nextSibling || rec.target.nextSibling, 1);\n            return { from: childBefore ? cView.posAfter(childBefore) : cView.posAtStart,\n                to: childAfter ? cView.posBefore(childAfter) : cView.posAtEnd, typeOver: false };\n        }\n        else if (rec.type == \"characterData\") {\n            return { from: cView.posAtStart, to: cView.posAtEnd, typeOver: rec.target.nodeValue == rec.oldValue };\n        }\n        else {\n            return null;\n        }\n    }\n    setWindow(win) {\n        if (win != this.win) {\n            this.removeWindowListeners(this.win);\n            this.win = win;\n            this.addWindowListeners(this.win);\n        }\n    }\n    addWindowListeners(win) {\n        win.addEventListener(\"resize\", this.onResize);\n        win.addEventListener(\"beforeprint\", this.onPrint);\n        win.addEventListener(\"scroll\", this.onScroll);\n        win.document.addEventListener(\"selectionchange\", this.onSelectionChange);\n    }\n    removeWindowListeners(win) {\n        win.removeEventListener(\"scroll\", this.onScroll);\n        win.removeEventListener(\"resize\", this.onResize);\n        win.removeEventListener(\"beforeprint\", this.onPrint);\n        win.document.removeEventListener(\"selectionchange\", this.onSelectionChange);\n    }\n    destroy() {\n        var _a, _b, _c, _d;\n        this.stop();\n        (_a = this.intersection) === null || _a === void 0 ? void 0 : _a.disconnect();\n        (_b = this.gapIntersection) === null || _b === void 0 ? void 0 : _b.disconnect();\n        (_c = this.resizeScroll) === null || _c === void 0 ? void 0 : _c.disconnect();\n        (_d = this.resizeContent) === null || _d === void 0 ? void 0 : _d.disconnect();\n        for (let dom of this.scrollTargets)\n            dom.removeEventListener(\"scroll\", this.onScroll);\n        this.removeWindowListeners(this.win);\n        clearTimeout(this.parentCheck);\n        clearTimeout(this.resizeTimeout);\n        this.win.cancelAnimationFrame(this.delayedFlush);\n        this.win.cancelAnimationFrame(this.flushingAndroidKey);\n    }\n}\nfunction findChild(cView, dom, dir) {\n    while (dom) {\n        let curView = ContentView.get(dom);\n        if (curView && curView.parent == cView)\n            return curView;\n        let parent = dom.parentNode;\n        dom = parent != cView.dom ? parent : dir > 0 ? dom.nextSibling : dom.previousSibling;\n    }\n    return null;\n}\n// Used to work around a Safari Selection/shadow DOM bug (#414)\nfunction safariSelectionRangeHack(view) {\n    let found = null;\n    // Because Safari (at least in 2018-2021) doesn't provide regular\n    // access to the selection inside a shadowroot, we have to perform a\n    // ridiculous hack to get at it—using `execCommand` to trigger a\n    // `beforeInput` event so that we can read the target range from the\n    // event.\n    function read(event) {\n        event.preventDefault();\n        event.stopImmediatePropagation();\n        found = event.getTargetRanges()[0];\n    }\n    view.contentDOM.addEventListener(\"beforeinput\", read, true);\n    view.dom.ownerDocument.execCommand(\"indent\");\n    view.contentDOM.removeEventListener(\"beforeinput\", read, true);\n    if (!found)\n        return null;\n    let anchorNode = found.startContainer, anchorOffset = found.startOffset;\n    let focusNode = found.endContainer, focusOffset = found.endOffset;\n    let curAnchor = view.docView.domAtPos(view.state.selection.main.anchor);\n    // Since such a range doesn't distinguish between anchor and head,\n    // use a heuristic that flips it around if its end matches the\n    // current anchor.\n    if (isEquivalentPosition(curAnchor.node, curAnchor.offset, focusNode, focusOffset))\n        [anchorNode, anchorOffset, focusNode, focusOffset] = [focusNode, focusOffset, anchorNode, anchorOffset];\n    return { anchorNode, anchorOffset, focusNode, focusOffset };\n}\n\n// The editor's update state machine looks something like this:\n//\n//     Idle → Updating ⇆ Idle (unchecked) → Measuring → Idle\n//                                         ↑      ↓\n//                                         Updating (measure)\n//\n// The difference between 'Idle' and 'Idle (unchecked)' lies in\n// whether a layout check has been scheduled. A regular update through\n// the `update` method updates the DOM in a write-only fashion, and\n// relies on a check (scheduled with `requestAnimationFrame`) to make\n// sure everything is where it should be and the viewport covers the\n// visible code. That check continues to measure and then optionally\n// update until it reaches a coherent state.\n/**\nAn editor view represents the editor's user interface. It holds\nthe editable DOM surface, and possibly other elements such as the\nline number gutter. It handles events and dispatches state\ntransactions for editing actions.\n*/\nclass EditorView {\n    /**\n    Construct a new view. You'll want to either provide a `parent`\n    option, or put `view.dom` into your document after creating a\n    view, so that the user can see the editor.\n    */\n    constructor(config = {}) {\n        this.plugins = [];\n        this.pluginMap = new Map;\n        this.editorAttrs = {};\n        this.contentAttrs = {};\n        this.bidiCache = [];\n        this.destroyed = false;\n        /**\n        @internal\n        */\n        this.updateState = 2 /* UpdateState.Updating */;\n        /**\n        @internal\n        */\n        this.measureScheduled = -1;\n        /**\n        @internal\n        */\n        this.measureRequests = [];\n        this.contentDOM = document.createElement(\"div\");\n        this.scrollDOM = document.createElement(\"div\");\n        this.scrollDOM.tabIndex = -1;\n        this.scrollDOM.className = \"cm-scroller\";\n        this.scrollDOM.appendChild(this.contentDOM);\n        this.announceDOM = document.createElement(\"div\");\n        this.announceDOM.style.cssText = \"position: fixed; top: -10000px\";\n        this.announceDOM.setAttribute(\"aria-live\", \"polite\");\n        this.dom = document.createElement(\"div\");\n        this.dom.appendChild(this.announceDOM);\n        this.dom.appendChild(this.scrollDOM);\n        this._dispatch = config.dispatch || ((tr) => this.update([tr]));\n        this.dispatch = this.dispatch.bind(this);\n        this._root = (config.root || getRoot(config.parent) || document);\n        this.viewState = new ViewState(config.state || EditorState.create(config));\n        this.plugins = this.state.facet(viewPlugin).map(spec => new PluginInstance(spec));\n        for (let plugin of this.plugins)\n            plugin.update(this);\n        this.observer = new DOMObserver(this);\n        this.inputState = new InputState(this);\n        this.inputState.ensureHandlers(this, this.plugins);\n        this.docView = new DocView(this);\n        this.mountStyles();\n        this.updateAttrs();\n        this.updateState = 0 /* UpdateState.Idle */;\n        this.requestMeasure();\n        if (config.parent)\n            config.parent.appendChild(this.dom);\n    }\n    /**\n    The current editor state.\n    */\n    get state() { return this.viewState.state; }\n    /**\n    To be able to display large documents without consuming too much\n    memory or overloading the browser, CodeMirror only draws the\n    code that is visible (plus a margin around it) to the DOM. This\n    property tells you the extent of the current drawn viewport, in\n    document positions.\n    */\n    get viewport() { return this.viewState.viewport; }\n    /**\n    When there are, for example, large collapsed ranges in the\n    viewport, its size can be a lot bigger than the actual visible\n    content. Thus, if you are doing something like styling the\n    content in the viewport, it is preferable to only do so for\n    these ranges, which are the subset of the viewport that is\n    actually drawn.\n    */\n    get visibleRanges() { return this.viewState.visibleRanges; }\n    /**\n    Returns false when the editor is entirely scrolled out of view\n    or otherwise hidden.\n    */\n    get inView() { return this.viewState.inView; }\n    /**\n    Indicates whether the user is currently composing text via\n    [IME](https://en.wikipedia.org/wiki/Input_method), and at least\n    one change has been made in the current composition.\n    */\n    get composing() { return this.inputState.composing > 0; }\n    /**\n    Indicates whether the user is currently in composing state. Note\n    that on some platforms, like Android, this will be the case a\n    lot, since just putting the cursor on a word starts a\n    composition there.\n    */\n    get compositionStarted() { return this.inputState.composing >= 0; }\n    /**\n    The document or shadow root that the view lives in.\n    */\n    get root() { return this._root; }\n    /**\n    @internal\n    */\n    get win() { return this.dom.ownerDocument.defaultView || window; }\n    dispatch(...input) {\n        this._dispatch(input.length == 1 && input[0] instanceof Transaction ? input[0]\n            : this.state.update(...input));\n    }\n    /**\n    Update the view for the given array of transactions. This will\n    update the visible document and selection to match the state\n    produced by the transactions, and notify view plugins of the\n    change. You should usually call\n    [`dispatch`](https://codemirror.net/6/docs/ref/#view.EditorView.dispatch) instead, which uses this\n    as a primitive.\n    */\n    update(transactions) {\n        if (this.updateState != 0 /* UpdateState.Idle */)\n            throw new Error(\"Calls to EditorView.update are not allowed while an update is in progress\");\n        let redrawn = false, attrsChanged = false, update;\n        let state = this.state;\n        for (let tr of transactions) {\n            if (tr.startState != state)\n                throw new RangeError(\"Trying to update state with a transaction that doesn't start from the previous state.\");\n            state = tr.state;\n        }\n        if (this.destroyed) {\n            this.viewState.state = state;\n            return;\n        }\n        let focus = this.hasFocus, focusFlag = 0, dispatchFocus = null;\n        if (transactions.some(tr => tr.annotation(isFocusChange))) {\n            this.inputState.notifiedFocused = focus;\n            // If a focus-change transaction is being dispatched, set this update flag.\n            focusFlag = 1 /* UpdateFlag.Focus */;\n        }\n        else if (focus != this.inputState.notifiedFocused) {\n            this.inputState.notifiedFocused = focus;\n            // Schedule a separate focus transaction if necessary, otherwise\n            // add a flag to this update\n            dispatchFocus = focusChangeTransaction(state, focus);\n            if (!dispatchFocus)\n                focusFlag = 1 /* UpdateFlag.Focus */;\n        }\n        // If there was a pending DOM change, eagerly read it and try to\n        // apply it after the given transactions.\n        let pendingKey = this.observer.delayedAndroidKey, domChange = null;\n        if (pendingKey) {\n            this.observer.clearDelayedAndroidKey();\n            domChange = this.observer.readChange();\n            // Only try to apply DOM changes if the transactions didn't\n            // change the doc or selection.\n            if (domChange && !this.state.doc.eq(state.doc) || !this.state.selection.eq(state.selection))\n                domChange = null;\n        }\n        else {\n            this.observer.clear();\n        }\n        // When the phrases change, redraw the editor\n        if (state.facet(EditorState.phrases) != this.state.facet(EditorState.phrases))\n            return this.setState(state);\n        update = ViewUpdate.create(this, state, transactions);\n        update.flags |= focusFlag;\n        let scrollTarget = this.viewState.scrollTarget;\n        try {\n            this.updateState = 2 /* UpdateState.Updating */;\n            for (let tr of transactions) {\n                if (scrollTarget)\n                    scrollTarget = scrollTarget.map(tr.changes);\n                if (tr.scrollIntoView) {\n                    let { main } = tr.state.selection;\n                    scrollTarget = new ScrollTarget(main.empty ? main : EditorSelection.cursor(main.head, main.head > main.anchor ? -1 : 1));\n                }\n                for (let e of tr.effects)\n                    if (e.is(scrollIntoView))\n                        scrollTarget = e.value;\n            }\n            this.viewState.update(update, scrollTarget);\n            this.bidiCache = CachedOrder.update(this.bidiCache, update.changes);\n            if (!update.empty) {\n                this.updatePlugins(update);\n                this.inputState.update(update);\n            }\n            redrawn = this.docView.update(update);\n            if (this.state.facet(styleModule) != this.styleModules)\n                this.mountStyles();\n            attrsChanged = this.updateAttrs();\n            this.showAnnouncements(transactions);\n            this.docView.updateSelection(redrawn, transactions.some(tr => tr.isUserEvent(\"select.pointer\")));\n        }\n        finally {\n            this.updateState = 0 /* UpdateState.Idle */;\n        }\n        if (update.startState.facet(theme) != update.state.facet(theme))\n            this.viewState.mustMeasureContent = true;\n        if (redrawn || attrsChanged || scrollTarget || this.viewState.mustEnforceCursorAssoc || this.viewState.mustMeasureContent)\n            this.requestMeasure();\n        if (!update.empty)\n            for (let listener of this.state.facet(updateListener))\n                listener(update);\n        if (dispatchFocus || domChange)\n            Promise.resolve().then(() => {\n                if (dispatchFocus && this.state == dispatchFocus.startState)\n                    this.dispatch(dispatchFocus);\n                if (domChange) {\n                    if (!applyDOMChange(this, domChange) && pendingKey.force)\n                        dispatchKey(this.contentDOM, pendingKey.key, pendingKey.keyCode);\n                }\n            });\n    }\n    /**\n    Reset the view to the given state. (This will cause the entire\n    document to be redrawn and all view plugins to be reinitialized,\n    so you should probably only use it when the new state isn't\n    derived from the old state. Otherwise, use\n    [`dispatch`](https://codemirror.net/6/docs/ref/#view.EditorView.dispatch) instead.)\n    */\n    setState(newState) {\n        if (this.updateState != 0 /* UpdateState.Idle */)\n            throw new Error(\"Calls to EditorView.setState are not allowed while an update is in progress\");\n        if (this.destroyed) {\n            this.viewState.state = newState;\n            return;\n        }\n        this.updateState = 2 /* UpdateState.Updating */;\n        let hadFocus = this.hasFocus;\n        try {\n            for (let plugin of this.plugins)\n                plugin.destroy(this);\n            this.viewState = new ViewState(newState);\n            this.plugins = newState.facet(viewPlugin).map(spec => new PluginInstance(spec));\n            this.pluginMap.clear();\n            for (let plugin of this.plugins)\n                plugin.update(this);\n            this.docView = new DocView(this);\n            this.inputState.ensureHandlers(this, this.plugins);\n            this.mountStyles();\n            this.updateAttrs();\n            this.bidiCache = [];\n        }\n        finally {\n            this.updateState = 0 /* UpdateState.Idle */;\n        }\n        if (hadFocus)\n            this.focus();\n        this.requestMeasure();\n    }\n    updatePlugins(update) {\n        let prevSpecs = update.startState.facet(viewPlugin), specs = update.state.facet(viewPlugin);\n        if (prevSpecs != specs) {\n            let newPlugins = [];\n            for (let spec of specs) {\n                let found = prevSpecs.indexOf(spec);\n                if (found < 0) {\n                    newPlugins.push(new PluginInstance(spec));\n                }\n                else {\n                    let plugin = this.plugins[found];\n                    plugin.mustUpdate = update;\n                    newPlugins.push(plugin);\n                }\n            }\n            for (let plugin of this.plugins)\n                if (plugin.mustUpdate != update)\n                    plugin.destroy(this);\n            this.plugins = newPlugins;\n            this.pluginMap.clear();\n            this.inputState.ensureHandlers(this, this.plugins);\n        }\n        else {\n            for (let p of this.plugins)\n                p.mustUpdate = update;\n        }\n        for (let i = 0; i < this.plugins.length; i++)\n            this.plugins[i].update(this);\n    }\n    /**\n    @internal\n    */\n    measure(flush = true) {\n        if (this.destroyed)\n            return;\n        if (this.measureScheduled > -1)\n            this.win.cancelAnimationFrame(this.measureScheduled);\n        this.measureScheduled = 0; // Prevent requestMeasure calls from scheduling another animation frame\n        if (flush)\n            this.observer.forceFlush();\n        let updated = null;\n        let { scrollHeight, scrollTop, clientHeight } = this.scrollDOM;\n        let refHeight = scrollTop > scrollHeight - clientHeight - 4 ? scrollHeight : scrollTop;\n        try {\n            for (let i = 0;; i++) {\n                this.updateState = 1 /* UpdateState.Measuring */;\n                let oldViewport = this.viewport;\n                let refBlock = this.viewState.lineBlockAtHeight(refHeight);\n                let changed = this.viewState.measure(this);\n                if (!changed && !this.measureRequests.length && this.viewState.scrollTarget == null)\n                    break;\n                if (i > 5) {\n                    console.warn(this.measureRequests.length\n                        ? \"Measure loop restarted more than 5 times\"\n                        : \"Viewport failed to stabilize\");\n                    break;\n                }\n                let measuring = [];\n                // Only run measure requests in this cycle when the viewport didn't change\n                if (!(changed & 4 /* UpdateFlag.Viewport */))\n                    [this.measureRequests, measuring] = [measuring, this.measureRequests];\n                let measured = measuring.map(m => {\n                    try {\n                        return m.read(this);\n                    }\n                    catch (e) {\n                        logException(this.state, e);\n                        return BadMeasure;\n                    }\n                });\n                let update = ViewUpdate.create(this, this.state, []), redrawn = false, scrolled = false;\n                update.flags |= changed;\n                if (!updated)\n                    updated = update;\n                else\n                    updated.flags |= changed;\n                this.updateState = 2 /* UpdateState.Updating */;\n                if (!update.empty) {\n                    this.updatePlugins(update);\n                    this.inputState.update(update);\n                    this.updateAttrs();\n                    redrawn = this.docView.update(update);\n                }\n                for (let i = 0; i < measuring.length; i++)\n                    if (measured[i] != BadMeasure) {\n                        try {\n                            let m = measuring[i];\n                            if (m.write)\n                                m.write(measured[i], this);\n                        }\n                        catch (e) {\n                            logException(this.state, e);\n                        }\n                    }\n                if (this.viewState.editorHeight) {\n                    if (this.viewState.scrollTarget) {\n                        this.docView.scrollIntoView(this.viewState.scrollTarget);\n                        this.viewState.scrollTarget = null;\n                        scrolled = true;\n                    }\n                    else {\n                        let diff = this.viewState.lineBlockAt(refBlock.from).top - refBlock.top;\n                        if (diff > 1 || diff < -1) {\n                            this.scrollDOM.scrollTop += diff;\n                            scrolled = true;\n                        }\n                    }\n                }\n                if (redrawn)\n                    this.docView.updateSelection(true);\n                if (this.viewport.from == oldViewport.from && this.viewport.to == oldViewport.to &&\n                    !scrolled && this.measureRequests.length == 0)\n                    break;\n            }\n        }\n        finally {\n            this.updateState = 0 /* UpdateState.Idle */;\n            this.measureScheduled = -1;\n        }\n        if (updated && !updated.empty)\n            for (let listener of this.state.facet(updateListener))\n                listener(updated);\n    }\n    /**\n    Get the CSS classes for the currently active editor themes.\n    */\n    get themeClasses() {\n        return baseThemeID + \" \" +\n            (this.state.facet(darkTheme) ? baseDarkID : baseLightID) + \" \" +\n            this.state.facet(theme);\n    }\n    updateAttrs() {\n        let editorAttrs = attrsFromFacet(this, editorAttributes, {\n            class: \"cm-editor\" + (this.hasFocus ? \" cm-focused \" : \" \") + this.themeClasses\n        });\n        let contentAttrs = {\n            spellcheck: \"false\",\n            autocorrect: \"off\",\n            autocapitalize: \"off\",\n            translate: \"no\",\n            contenteditable: !this.state.facet(editable) ? \"false\" : \"true\",\n            class: \"cm-content\",\n            style: `${browser.tabSize}: ${this.state.tabSize}`,\n            role: \"textbox\",\n            \"aria-multiline\": \"true\"\n        };\n        if (this.state.readOnly)\n            contentAttrs[\"aria-readonly\"] = \"true\";\n        attrsFromFacet(this, contentAttributes, contentAttrs);\n        let changed = this.observer.ignore(() => {\n            let changedContent = updateAttrs(this.contentDOM, this.contentAttrs, contentAttrs);\n            let changedEditor = updateAttrs(this.dom, this.editorAttrs, editorAttrs);\n            return changedContent || changedEditor;\n        });\n        this.editorAttrs = editorAttrs;\n        this.contentAttrs = contentAttrs;\n        return changed;\n    }\n    showAnnouncements(trs) {\n        let first = true;\n        for (let tr of trs)\n            for (let effect of tr.effects)\n                if (effect.is(EditorView.announce)) {\n                    if (first)\n                        this.announceDOM.textContent = \"\";\n                    first = false;\n                    let div = this.announceDOM.appendChild(document.createElement(\"div\"));\n                    div.textContent = effect.value;\n                }\n    }\n    mountStyles() {\n        this.styleModules = this.state.facet(styleModule);\n        StyleModule.mount(this.root, this.styleModules.concat(baseTheme$1).reverse());\n    }\n    readMeasured() {\n        if (this.updateState == 2 /* UpdateState.Updating */)\n            throw new Error(\"Reading the editor layout isn't allowed during an update\");\n        if (this.updateState == 0 /* UpdateState.Idle */ && this.measureScheduled > -1)\n            this.measure(false);\n    }\n    /**\n    Schedule a layout measurement, optionally providing callbacks to\n    do custom DOM measuring followed by a DOM write phase. Using\n    this is preferable reading DOM layout directly from, for\n    example, an event handler, because it'll make sure measuring and\n    drawing done by other components is synchronized, avoiding\n    unnecessary DOM layout computations.\n    */\n    requestMeasure(request) {\n        if (this.measureScheduled < 0)\n            this.measureScheduled = this.win.requestAnimationFrame(() => this.measure());\n        if (request) {\n            if (this.measureRequests.indexOf(request) > -1)\n                return;\n            if (request.key != null)\n                for (let i = 0; i < this.measureRequests.length; i++) {\n                    if (this.measureRequests[i].key === request.key) {\n                        this.measureRequests[i] = request;\n                        return;\n                    }\n                }\n            this.measureRequests.push(request);\n        }\n    }\n    /**\n    Get the value of a specific plugin, if present. Note that\n    plugins that crash can be dropped from a view, so even when you\n    know you registered a given plugin, it is recommended to check\n    the return value of this method.\n    */\n    plugin(plugin) {\n        let known = this.pluginMap.get(plugin);\n        if (known === undefined || known && known.spec != plugin)\n            this.pluginMap.set(plugin, known = this.plugins.find(p => p.spec == plugin) || null);\n        return known && known.update(this).value;\n    }\n    /**\n    The top position of the document, in screen coordinates. This\n    may be negative when the editor is scrolled down. Points\n    directly to the top of the first line, not above the padding.\n    */\n    get documentTop() {\n        return this.contentDOM.getBoundingClientRect().top + this.viewState.paddingTop;\n    }\n    /**\n    Reports the padding above and below the document.\n    */\n    get documentPadding() {\n        return { top: this.viewState.paddingTop, bottom: this.viewState.paddingBottom };\n    }\n    /**\n    Find the text line or block widget at the given vertical\n    position (which is interpreted as relative to the [top of the\n    document](https://codemirror.net/6/docs/ref/#view.EditorView.documentTop)).\n    */\n    elementAtHeight(height) {\n        this.readMeasured();\n        return this.viewState.elementAtHeight(height);\n    }\n    /**\n    Find the line block (see\n    [`lineBlockAt`](https://codemirror.net/6/docs/ref/#view.EditorView.lineBlockAt) at the given\n    height, again interpreted relative to the [top of the\n    document](https://codemirror.net/6/docs/ref/#view.EditorView.documentTop).\n    */\n    lineBlockAtHeight(height) {\n        this.readMeasured();\n        return this.viewState.lineBlockAtHeight(height);\n    }\n    /**\n    Get the extent and vertical position of all [line\n    blocks](https://codemirror.net/6/docs/ref/#view.EditorView.lineBlockAt) in the viewport. Positions\n    are relative to the [top of the\n    document](https://codemirror.net/6/docs/ref/#view.EditorView.documentTop);\n    */\n    get viewportLineBlocks() {\n        return this.viewState.viewportLines;\n    }\n    /**\n    Find the line block around the given document position. A line\n    block is a range delimited on both sides by either a\n    non-[hidden](https://codemirror.net/6/docs/ref/#view.Decoration^replace) line breaks, or the\n    start/end of the document. It will usually just hold a line of\n    text, but may be broken into multiple textblocks by block\n    widgets.\n    */\n    lineBlockAt(pos) {\n        return this.viewState.lineBlockAt(pos);\n    }\n    /**\n    The editor's total content height.\n    */\n    get contentHeight() {\n        return this.viewState.contentHeight;\n    }\n    /**\n    Move a cursor position by [grapheme\n    cluster](https://codemirror.net/6/docs/ref/#state.findClusterBreak). `forward` determines whether\n    the motion is away from the line start, or towards it. In\n    bidirectional text, the line is traversed in visual order, using\n    the editor's [text direction](https://codemirror.net/6/docs/ref/#view.EditorView.textDirection).\n    When the start position was the last one on the line, the\n    returned position will be across the line break. If there is no\n    further line, the original position is returned.\n    \n    By default, this method moves over a single cluster. The\n    optional `by` argument can be used to move across more. It will\n    be called with the first cluster as argument, and should return\n    a predicate that determines, for each subsequent cluster,\n    whether it should also be moved over.\n    */\n    moveByChar(start, forward, by) {\n        return skipAtoms(this, start, moveByChar(this, start, forward, by));\n    }\n    /**\n    Move a cursor position across the next group of either\n    [letters](https://codemirror.net/6/docs/ref/#state.EditorState.charCategorizer) or non-letter\n    non-whitespace characters.\n    */\n    moveByGroup(start, forward) {\n        return skipAtoms(this, start, moveByChar(this, start, forward, initial => byGroup(this, start.head, initial)));\n    }\n    /**\n    Move to the next line boundary in the given direction. If\n    `includeWrap` is true, line wrapping is on, and there is a\n    further wrap point on the current line, the wrap point will be\n    returned. Otherwise this function will return the start or end\n    of the line.\n    */\n    moveToLineBoundary(start, forward, includeWrap = true) {\n        return moveToLineBoundary(this, start, forward, includeWrap);\n    }\n    /**\n    Move a cursor position vertically. When `distance` isn't given,\n    it defaults to moving to the next line (including wrapped\n    lines). Otherwise, `distance` should provide a positive distance\n    in pixels.\n    \n    When `start` has a\n    [`goalColumn`](https://codemirror.net/6/docs/ref/#state.SelectionRange.goalColumn), the vertical\n    motion will use that as a target horizontal position. Otherwise,\n    the cursor's own horizontal position is used. The returned\n    cursor will have its goal column set to whichever column was\n    used.\n    */\n    moveVertically(start, forward, distance) {\n        return skipAtoms(this, start, moveVertically(this, start, forward, distance));\n    }\n    /**\n    Find the DOM parent node and offset (child offset if `node` is\n    an element, character offset when it is a text node) at the\n    given document position.\n    \n    Note that for positions that aren't currently in\n    `visibleRanges`, the resulting DOM position isn't necessarily\n    meaningful (it may just point before or after a placeholder\n    element).\n    */\n    domAtPos(pos) {\n        return this.docView.domAtPos(pos);\n    }\n    /**\n    Find the document position at the given DOM node. Can be useful\n    for associating positions with DOM events. Will raise an error\n    when `node` isn't part of the editor content.\n    */\n    posAtDOM(node, offset = 0) {\n        return this.docView.posFromDOM(node, offset);\n    }\n    posAtCoords(coords, precise = true) {\n        this.readMeasured();\n        return posAtCoords(this, coords, precise);\n    }\n    /**\n    Get the screen coordinates at the given document position.\n    `side` determines whether the coordinates are based on the\n    element before (-1) or after (1) the position (if no element is\n    available on the given side, the method will transparently use\n    another strategy to get reasonable coordinates).\n    */\n    coordsAtPos(pos, side = 1) {\n        this.readMeasured();\n        let rect = this.docView.coordsAt(pos, side);\n        if (!rect || rect.left == rect.right)\n            return rect;\n        let line = this.state.doc.lineAt(pos), order = this.bidiSpans(line);\n        let span = order[BidiSpan.find(order, pos - line.from, -1, side)];\n        return flattenRect(rect, (span.dir == Direction.LTR) == (side > 0));\n    }\n    /**\n    The default width of a character in the editor. May not\n    accurately reflect the width of all characters (given variable\n    width fonts or styling of invididual ranges).\n    */\n    get defaultCharacterWidth() { return this.viewState.heightOracle.charWidth; }\n    /**\n    The default height of a line in the editor. May not be accurate\n    for all lines.\n    */\n    get defaultLineHeight() { return this.viewState.heightOracle.lineHeight; }\n    /**\n    The text direction\n    ([`direction`](https://developer.mozilla.org/en-US/docs/Web/CSS/direction)\n    CSS property) of the editor's content element.\n    */\n    get textDirection() { return this.viewState.defaultTextDirection; }\n    /**\n    Find the text direction of the block at the given position, as\n    assigned by CSS. If\n    [`perLineTextDirection`](https://codemirror.net/6/docs/ref/#view.EditorView^perLineTextDirection)\n    isn't enabled, or the given position is outside of the viewport,\n    this will always return the same as\n    [`textDirection`](https://codemirror.net/6/docs/ref/#view.EditorView.textDirection). Note that\n    this may trigger a DOM layout.\n    */\n    textDirectionAt(pos) {\n        let perLine = this.state.facet(perLineTextDirection);\n        if (!perLine || pos < this.viewport.from || pos > this.viewport.to)\n            return this.textDirection;\n        this.readMeasured();\n        return this.docView.textDirectionAt(pos);\n    }\n    /**\n    Whether this editor [wraps lines](https://codemirror.net/6/docs/ref/#view.EditorView.lineWrapping)\n    (as determined by the\n    [`white-space`](https://developer.mozilla.org/en-US/docs/Web/CSS/white-space)\n    CSS property of its content element).\n    */\n    get lineWrapping() { return this.viewState.heightOracle.lineWrapping; }\n    /**\n    Returns the bidirectional text structure of the given line\n    (which should be in the current document) as an array of span\n    objects. The order of these spans matches the [text\n    direction](https://codemirror.net/6/docs/ref/#view.EditorView.textDirection)—if that is\n    left-to-right, the leftmost spans come first, otherwise the\n    rightmost spans come first.\n    */\n    bidiSpans(line) {\n        if (line.length > MaxBidiLine)\n            return trivialOrder(line.length);\n        let dir = this.textDirectionAt(line.from);\n        for (let entry of this.bidiCache)\n            if (entry.from == line.from && entry.dir == dir)\n                return entry.order;\n        let order = computeOrder(line.text, dir);\n        this.bidiCache.push(new CachedOrder(line.from, line.to, dir, order));\n        return order;\n    }\n    /**\n    Check whether the editor has focus.\n    */\n    get hasFocus() {\n        var _a;\n        // Safari return false for hasFocus when the context menu is open\n        // or closing, which leads us to ignore selection changes from the\n        // context menu because it looks like the editor isn't focused.\n        // This kludges around that.\n        return (this.dom.ownerDocument.hasFocus() || browser.safari && ((_a = this.inputState) === null || _a === void 0 ? void 0 : _a.lastContextMenu) > Date.now() - 3e4) &&\n            this.root.activeElement == this.contentDOM;\n    }\n    /**\n    Put focus on the editor.\n    */\n    focus() {\n        this.observer.ignore(() => {\n            focusPreventScroll(this.contentDOM);\n            this.docView.updateSelection();\n        });\n    }\n    /**\n    Update the [root](https://codemirror.net/6/docs/ref/##view.EditorViewConfig.root) in which the editor lives. This is only\n    necessary when moving the editor's existing DOM to a new window or shadow root.\n    */\n    setRoot(root) {\n        if (this._root != root) {\n            this._root = root;\n            this.observer.setWindow((root.nodeType == 9 ? root : root.ownerDocument).defaultView || window);\n            this.mountStyles();\n        }\n    }\n    /**\n    Clean up this editor view, removing its element from the\n    document, unregistering event handlers, and notifying\n    plugins. The view instance can no longer be used after\n    calling this.\n    */\n    destroy() {\n        for (let plugin of this.plugins)\n            plugin.destroy(this);\n        this.plugins = [];\n        this.inputState.destroy();\n        this.dom.remove();\n        this.observer.destroy();\n        if (this.measureScheduled > -1)\n            this.win.cancelAnimationFrame(this.measureScheduled);\n        this.destroyed = true;\n    }\n    /**\n    Returns an effect that can be\n    [added](https://codemirror.net/6/docs/ref/#state.TransactionSpec.effects) to a transaction to\n    cause it to scroll the given position or range into view.\n    */\n    static scrollIntoView(pos, options = {}) {\n        return scrollIntoView.of(new ScrollTarget(typeof pos == \"number\" ? EditorSelection.cursor(pos) : pos, options.y, options.x, options.yMargin, options.xMargin));\n    }\n    /**\n    Returns an extension that can be used to add DOM event handlers.\n    The value should be an object mapping event names to handler\n    functions. For any given event, such functions are ordered by\n    extension precedence, and the first handler to return true will\n    be assumed to have handled that event, and no other handlers or\n    built-in behavior will be activated for it. These are registered\n    on the [content element](https://codemirror.net/6/docs/ref/#view.EditorView.contentDOM), except\n    for `scroll` handlers, which will be called any time the\n    editor's [scroll element](https://codemirror.net/6/docs/ref/#view.EditorView.scrollDOM) or one of\n    its parent nodes is scrolled.\n    */\n    static domEventHandlers(handlers) {\n        return ViewPlugin.define(() => ({}), { eventHandlers: handlers });\n    }\n    /**\n    Create a theme extension. The first argument can be a\n    [`style-mod`](https://github.com/marijnh/style-mod#documentation)\n    style spec providing the styles for the theme. These will be\n    prefixed with a generated class for the style.\n    \n    Because the selectors will be prefixed with a scope class, rule\n    that directly match the editor's [wrapper\n    element](https://codemirror.net/6/docs/ref/#view.EditorView.dom)—to which the scope class will be\n    added—need to be explicitly differentiated by adding an `&` to\n    the selector for that element—for example\n    `&.cm-focused`.\n    \n    When `dark` is set to true, the theme will be marked as dark,\n    which will cause the `&dark` rules from [base\n    themes](https://codemirror.net/6/docs/ref/#view.EditorView^baseTheme) to be used (as opposed to\n    `&light` when a light theme is active).\n    */\n    static theme(spec, options) {\n        let prefix = StyleModule.newName();\n        let result = [theme.of(prefix), styleModule.of(buildTheme(`.${prefix}`, spec))];\n        if (options && options.dark)\n            result.push(darkTheme.of(true));\n        return result;\n    }\n    /**\n    Create an extension that adds styles to the base theme. Like\n    with [`theme`](https://codemirror.net/6/docs/ref/#view.EditorView^theme), use `&` to indicate the\n    place of the editor wrapper element when directly targeting\n    that. You can also use `&dark` or `&light` instead to only\n    target editors with a dark or light theme.\n    */\n    static baseTheme(spec) {\n        return Prec.lowest(styleModule.of(buildTheme(\".\" + baseThemeID, spec, lightDarkIDs)));\n    }\n    /**\n    Retrieve an editor view instance from the view's DOM\n    representation.\n    */\n    static findFromDOM(dom) {\n        var _a;\n        let content = dom.querySelector(\".cm-content\");\n        let cView = content && ContentView.get(content) || ContentView.get(dom);\n        return ((_a = cView === null || cView === void 0 ? void 0 : cView.rootView) === null || _a === void 0 ? void 0 : _a.view) || null;\n    }\n}\n/**\nFacet to add a [style\nmodule](https://github.com/marijnh/style-mod#documentation) to\nan editor view. The view will ensure that the module is\nmounted in its [document\nroot](https://codemirror.net/6/docs/ref/#view.EditorView.constructor^config.root).\n*/\nEditorView.styleModule = styleModule;\n/**\nAn input handler can override the way changes to the editable\nDOM content are handled. Handlers are passed the document\npositions between which the change was found, and the new\ncontent. When one returns true, no further input handlers are\ncalled and the default behavior is prevented.\n*/\nEditorView.inputHandler = inputHandler;\n/**\nThis facet can be used to provide functions that create effects\nto be dispatched when the editor's focus state changes.\n*/\nEditorView.focusChangeEffect = focusChangeEffect;\n/**\nBy default, the editor assumes all its content has the same\n[text direction](https://codemirror.net/6/docs/ref/#view.Direction). Configure this with a `true`\nvalue to make it read the text direction of every (rendered)\nline separately.\n*/\nEditorView.perLineTextDirection = perLineTextDirection;\n/**\nAllows you to provide a function that should be called when the\nlibrary catches an exception from an extension (mostly from view\nplugins, but may be used by other extensions to route exceptions\nfrom user-code-provided callbacks). This is mostly useful for\ndebugging and logging. See [`logException`](https://codemirror.net/6/docs/ref/#view.logException).\n*/\nEditorView.exceptionSink = exceptionSink;\n/**\nA facet that can be used to register a function to be called\nevery time the view updates.\n*/\nEditorView.updateListener = updateListener;\n/**\nFacet that controls whether the editor content DOM is editable.\nWhen its highest-precedence value is `false`, the element will\nnot have its `contenteditable` attribute set. (Note that this\ndoesn't affect API calls that change the editor content, even\nwhen those are bound to keys or buttons. See the\n[`readOnly`](https://codemirror.net/6/docs/ref/#state.EditorState.readOnly) facet for that.)\n*/\nEditorView.editable = editable;\n/**\nAllows you to influence the way mouse selection happens. The\nfunctions in this facet will be called for a `mousedown` event\non the editor, and can return an object that overrides the way a\nselection is computed from that mouse click or drag.\n*/\nEditorView.mouseSelectionStyle = mouseSelectionStyle;\n/**\nFacet used to configure whether a given selection drag event\nshould move or copy the selection. The given predicate will be\ncalled with the `mousedown` event, and can return `true` when\nthe drag should move the content.\n*/\nEditorView.dragMovesSelection = dragMovesSelection$1;\n/**\nFacet used to configure whether a given selecting click adds a\nnew range to the existing selection or replaces it entirely. The\ndefault behavior is to check `event.metaKey` on macOS, and\n`event.ctrlKey` elsewhere.\n*/\nEditorView.clickAddsSelectionRange = clickAddsSelectionRange;\n/**\nA facet that determines which [decorations](https://codemirror.net/6/docs/ref/#view.Decoration)\nare shown in the view. Decorations can be provided in two\nways—directly, or via a function that takes an editor view.\n\nOnly decoration sets provided directly are allowed to influence\nthe editor's vertical layout structure. The ones provided as\nfunctions are called _after_ the new viewport has been computed,\nand thus **must not** introduce block widgets or replacing\ndecorations that cover line breaks.\n\nIf you want decorated ranges to behave like atomic units for\ncursor motion and deletion purposes, also provide the range set\ncontaining the decorations to\n[`EditorView.atomicRanges`](https://codemirror.net/6/docs/ref/#view.EditorView^atomicRanges).\n*/\nEditorView.decorations = decorations;\n/**\nUsed to provide ranges that should be treated as atoms as far as\ncursor motion is concerned. This causes methods like\n[`moveByChar`](https://codemirror.net/6/docs/ref/#view.EditorView.moveByChar) and\n[`moveVertically`](https://codemirror.net/6/docs/ref/#view.EditorView.moveVertically) (and the\ncommands built on top of them) to skip across such regions when\na selection endpoint would enter them. This does _not_ prevent\ndirect programmatic [selection\nupdates](https://codemirror.net/6/docs/ref/#state.TransactionSpec.selection) from moving into such\nregions.\n*/\nEditorView.atomicRanges = atomicRanges;\n/**\nFacet that allows extensions to provide additional scroll\nmargins (space around the sides of the scrolling element that\nshould be considered invisible). This can be useful when the\nplugin introduces elements that cover part of that element (for\nexample a horizontally fixed gutter).\n*/\nEditorView.scrollMargins = scrollMargins;\n/**\nThis facet records whether a dark theme is active. The extension\nreturned by [`theme`](https://codemirror.net/6/docs/ref/#view.EditorView^theme) automatically\nincludes an instance of this when the `dark` option is set to\ntrue.\n*/\nEditorView.darkTheme = darkTheme;\n/**\nFacet that provides additional DOM attributes for the editor's\neditable DOM element.\n*/\nEditorView.contentAttributes = contentAttributes;\n/**\nFacet that provides DOM attributes for the editor's outer\nelement.\n*/\nEditorView.editorAttributes = editorAttributes;\n/**\nAn extension that enables line wrapping in the editor (by\nsetting CSS `white-space` to `pre-wrap` in the content).\n*/\nEditorView.lineWrapping = /*@__PURE__*/EditorView.contentAttributes.of({ \"class\": \"cm-lineWrapping\" });\n/**\nState effect used to include screen reader announcements in a\ntransaction. These will be added to the DOM in a visually hidden\nelement with `aria-live=\"polite\"` set, and should be used to\ndescribe effects that are visually obvious but may not be\nnoticed by screen reader users (such as moving to the next\nsearch match).\n*/\nEditorView.announce = /*@__PURE__*/StateEffect.define();\n// Maximum line length for which we compute accurate bidi info\nconst MaxBidiLine = 4096;\nconst BadMeasure = {};\nclass CachedOrder {\n    constructor(from, to, dir, order) {\n        this.from = from;\n        this.to = to;\n        this.dir = dir;\n        this.order = order;\n    }\n    static update(cache, changes) {\n        if (changes.empty)\n            return cache;\n        let result = [], lastDir = cache.length ? cache[cache.length - 1].dir : Direction.LTR;\n        for (let i = Math.max(0, cache.length - 10); i < cache.length; i++) {\n            let entry = cache[i];\n            if (entry.dir == lastDir && !changes.touchesRange(entry.from, entry.to))\n                result.push(new CachedOrder(changes.mapPos(entry.from, 1), changes.mapPos(entry.to, -1), entry.dir, entry.order));\n        }\n        return result;\n    }\n}\nfunction attrsFromFacet(view, facet, base) {\n    for (let sources = view.state.facet(facet), i = sources.length - 1; i >= 0; i--) {\n        let source = sources[i], value = typeof source == \"function\" ? source(view) : source;\n        if (value)\n            combineAttrs(value, base);\n    }\n    return base;\n}\n\nconst currentPlatform = browser.mac ? \"mac\" : browser.windows ? \"win\" : browser.linux ? \"linux\" : \"key\";\nfunction normalizeKeyName(name, platform) {\n    const parts = name.split(/-(?!$)/);\n    let result = parts[parts.length - 1];\n    if (result == \"Space\")\n        result = \" \";\n    let alt, ctrl, shift, meta;\n    for (let i = 0; i < parts.length - 1; ++i) {\n        const mod = parts[i];\n        if (/^(cmd|meta|m)$/i.test(mod))\n            meta = true;\n        else if (/^a(lt)?$/i.test(mod))\n            alt = true;\n        else if (/^(c|ctrl|control)$/i.test(mod))\n            ctrl = true;\n        else if (/^s(hift)?$/i.test(mod))\n            shift = true;\n        else if (/^mod$/i.test(mod)) {\n            if (platform == \"mac\")\n                meta = true;\n            else\n                ctrl = true;\n        }\n        else\n            throw new Error(\"Unrecognized modifier name: \" + mod);\n    }\n    if (alt)\n        result = \"Alt-\" + result;\n    if (ctrl)\n        result = \"Ctrl-\" + result;\n    if (meta)\n        result = \"Meta-\" + result;\n    if (shift)\n        result = \"Shift-\" + result;\n    return result;\n}\nfunction modifiers(name, event, shift) {\n    if (event.altKey)\n        name = \"Alt-\" + name;\n    if (event.ctrlKey)\n        name = \"Ctrl-\" + name;\n    if (event.metaKey)\n        name = \"Meta-\" + name;\n    if (shift !== false && event.shiftKey)\n        name = \"Shift-\" + name;\n    return name;\n}\nconst handleKeyEvents = /*@__PURE__*/Prec.default(/*@__PURE__*/EditorView.domEventHandlers({\n    keydown(event, view) {\n        return runHandlers(getKeymap(view.state), event, view, \"editor\");\n    }\n}));\n/**\nFacet used for registering keymaps.\n\nYou can add multiple keymaps to an editor. Their priorities\ndetermine their precedence (the ones specified early or with high\npriority get checked first). When a handler has returned `true`\nfor a given key, no further handlers are called.\n*/\nconst keymap = /*@__PURE__*/Facet.define({ enables: handleKeyEvents });\nconst Keymaps = /*@__PURE__*/new WeakMap();\n// This is hidden behind an indirection, rather than directly computed\n// by the facet, to keep internal types out of the facet's type.\nfunction getKeymap(state) {\n    let bindings = state.facet(keymap);\n    let map = Keymaps.get(bindings);\n    if (!map)\n        Keymaps.set(bindings, map = buildKeymap(bindings.reduce((a, b) => a.concat(b), [])));\n    return map;\n}\n/**\nRun the key handlers registered for a given scope. The event\nobject should be a `\"keydown\"` event. Returns true if any of the\nhandlers handled it.\n*/\nfunction runScopeHandlers(view, event, scope) {\n    return runHandlers(getKeymap(view.state), event, view, scope);\n}\nlet storedPrefix = null;\nconst PrefixTimeout = 4000;\nfunction buildKeymap(bindings, platform = currentPlatform) {\n    let bound = Object.create(null);\n    let isPrefix = Object.create(null);\n    let checkPrefix = (name, is) => {\n        let current = isPrefix[name];\n        if (current == null)\n            isPrefix[name] = is;\n        else if (current != is)\n            throw new Error(\"Key binding \" + name + \" is used both as a regular binding and as a multi-stroke prefix\");\n    };\n    let add = (scope, key, command, preventDefault) => {\n        var _a, _b;\n        let scopeObj = bound[scope] || (bound[scope] = Object.create(null));\n        let parts = key.split(/ (?!$)/).map(k => normalizeKeyName(k, platform));\n        for (let i = 1; i < parts.length; i++) {\n            let prefix = parts.slice(0, i).join(\" \");\n            checkPrefix(prefix, true);\n            if (!scopeObj[prefix])\n                scopeObj[prefix] = {\n                    preventDefault: true,\n                    run: [(view) => {\n                            let ourObj = storedPrefix = { view, prefix, scope };\n                            setTimeout(() => { if (storedPrefix == ourObj)\n                                storedPrefix = null; }, PrefixTimeout);\n                            return true;\n                        }]\n                };\n        }\n        let full = parts.join(\" \");\n        checkPrefix(full, false);\n        let binding = scopeObj[full] || (scopeObj[full] = { preventDefault: false, run: ((_b = (_a = scopeObj._any) === null || _a === void 0 ? void 0 : _a.run) === null || _b === void 0 ? void 0 : _b.slice()) || [] });\n        if (command)\n            binding.run.push(command);\n        if (preventDefault)\n            binding.preventDefault = true;\n    };\n    for (let b of bindings) {\n        let scopes = b.scope ? b.scope.split(\" \") : [\"editor\"];\n        if (b.any)\n            for (let scope of scopes) {\n                let scopeObj = bound[scope] || (bound[scope] = Object.create(null));\n                if (!scopeObj._any)\n                    scopeObj._any = { preventDefault: false, run: [] };\n                for (let key in scopeObj)\n                    scopeObj[key].run.push(b.any);\n            }\n        let name = b[platform] || b.key;\n        if (!name)\n            continue;\n        for (let scope of scopes) {\n            add(scope, name, b.run, b.preventDefault);\n            if (b.shift)\n                add(scope, \"Shift-\" + name, b.shift, b.preventDefault);\n        }\n    }\n    return bound;\n}\nfunction runHandlers(map, event, view, scope) {\n    let name = keyName(event);\n    let charCode = codePointAt(name, 0), isChar = codePointSize(charCode) == name.length && name != \" \";\n    let prefix = \"\", fallthrough = false;\n    if (storedPrefix && storedPrefix.view == view && storedPrefix.scope == scope) {\n        prefix = storedPrefix.prefix + \" \";\n        if (fallthrough = modifierCodes.indexOf(event.keyCode) < 0)\n            storedPrefix = null;\n    }\n    let ran = new Set;\n    let runFor = (binding) => {\n        if (binding) {\n            for (let cmd of binding.run)\n                if (!ran.has(cmd)) {\n                    ran.add(cmd);\n                    if (cmd(view, event))\n                        return true;\n                }\n            if (binding.preventDefault)\n                fallthrough = true;\n        }\n        return false;\n    };\n    let scopeObj = map[scope], baseName, shiftName;\n    if (scopeObj) {\n        if (runFor(scopeObj[prefix + modifiers(name, event, !isChar)]))\n            return true;\n        if (isChar && (event.altKey || event.metaKey || event.ctrlKey) &&\n            // Ctrl-Alt may be used for AltGr on Windows\n            !(browser.windows && event.ctrlKey && event.altKey) &&\n            (baseName = base[event.keyCode]) && baseName != name) {\n            if (runFor(scopeObj[prefix + modifiers(baseName, event, true)]))\n                return true;\n            else if (event.shiftKey && (shiftName = shift[event.keyCode]) != name && shiftName != baseName &&\n                runFor(scopeObj[prefix + modifiers(shiftName, event, false)]))\n                return true;\n        }\n        else if (isChar && event.shiftKey) {\n            if (runFor(scopeObj[prefix + modifiers(name, event, true)]))\n                return true;\n        }\n        if (runFor(scopeObj._any))\n            return true;\n    }\n    return fallthrough;\n}\n\n/**\nImplementation of [`LayerMarker`](https://codemirror.net/6/docs/ref/#view.LayerMarker) that creates\na rectangle at a given set of coordinates.\n*/\nclass RectangleMarker {\n    /**\n    Create a marker with the given class and dimensions. If `width`\n    is null, the DOM element will get no width style.\n    */\n    constructor(className, left, top, width, height) {\n        this.className = className;\n        this.left = left;\n        this.top = top;\n        this.width = width;\n        this.height = height;\n    }\n    draw() {\n        let elt = document.createElement(\"div\");\n        elt.className = this.className;\n        this.adjust(elt);\n        return elt;\n    }\n    update(elt, prev) {\n        if (prev.className != this.className)\n            return false;\n        this.adjust(elt);\n        return true;\n    }\n    adjust(elt) {\n        elt.style.left = this.left + \"px\";\n        elt.style.top = this.top + \"px\";\n        if (this.width != null)\n            elt.style.width = this.width + \"px\";\n        elt.style.height = this.height + \"px\";\n    }\n    eq(p) {\n        return this.left == p.left && this.top == p.top && this.width == p.width && this.height == p.height &&\n            this.className == p.className;\n    }\n    /**\n    Create a set of rectangles for the given selection range,\n    assigning them theclass`className`. Will create a single\n    rectangle for empty ranges, and a set of selection-style\n    rectangles covering the range's content (in a bidi-aware\n    way) for non-empty ones.\n    */\n    static forRange(view, className, range) {\n        if (range.empty) {\n            let pos = view.coordsAtPos(range.head, range.assoc || 1);\n            if (!pos)\n                return [];\n            let base = getBase(view);\n            return [new RectangleMarker(className, pos.left - base.left, pos.top - base.top, null, pos.bottom - pos.top)];\n        }\n        else {\n            return rectanglesForRange(view, className, range);\n        }\n    }\n}\nfunction getBase(view) {\n    let rect = view.scrollDOM.getBoundingClientRect();\n    let left = view.textDirection == Direction.LTR ? rect.left : rect.right - view.scrollDOM.clientWidth;\n    return { left: left - view.scrollDOM.scrollLeft, top: rect.top - view.scrollDOM.scrollTop };\n}\nfunction wrappedLine(view, pos, inside) {\n    let range = EditorSelection.cursor(pos);\n    return { from: Math.max(inside.from, view.moveToLineBoundary(range, false, true).from),\n        to: Math.min(inside.to, view.moveToLineBoundary(range, true, true).from),\n        type: BlockType.Text };\n}\nfunction blockAt(view, pos) {\n    let line = view.lineBlockAt(pos);\n    if (Array.isArray(line.type))\n        for (let l of line.type) {\n            if (l.to > pos || l.to == pos && (l.to == line.to || l.type == BlockType.Text))\n                return l;\n        }\n    return line;\n}\nfunction rectanglesForRange(view, className, range) {\n    if (range.to <= view.viewport.from || range.from >= view.viewport.to)\n        return [];\n    let from = Math.max(range.from, view.viewport.from), to = Math.min(range.to, view.viewport.to);\n    let ltr = view.textDirection == Direction.LTR;\n    let content = view.contentDOM, contentRect = content.getBoundingClientRect(), base = getBase(view);\n    let lineElt = content.querySelector(\".cm-line\"), lineStyle = lineElt && window.getComputedStyle(lineElt);\n    let leftSide = contentRect.left +\n        (lineStyle ? parseInt(lineStyle.paddingLeft) + Math.min(0, parseInt(lineStyle.textIndent)) : 0);\n    let rightSide = contentRect.right - (lineStyle ? parseInt(lineStyle.paddingRight) : 0);\n    let startBlock = blockAt(view, from), endBlock = blockAt(view, to);\n    let visualStart = startBlock.type == BlockType.Text ? startBlock : null;\n    let visualEnd = endBlock.type == BlockType.Text ? endBlock : null;\n    if (view.lineWrapping) {\n        if (visualStart)\n            visualStart = wrappedLine(view, from, visualStart);\n        if (visualEnd)\n            visualEnd = wrappedLine(view, to, visualEnd);\n    }\n    if (visualStart && visualEnd && visualStart.from == visualEnd.from) {\n        return pieces(drawForLine(range.from, range.to, visualStart));\n    }\n    else {\n        let top = visualStart ? drawForLine(range.from, null, visualStart) : drawForWidget(startBlock, false);\n        let bottom = visualEnd ? drawForLine(null, range.to, visualEnd) : drawForWidget(endBlock, true);\n        let between = [];\n        if ((visualStart || startBlock).to < (visualEnd || endBlock).from - 1)\n            between.push(piece(leftSide, top.bottom, rightSide, bottom.top));\n        else if (top.bottom < bottom.top && view.elementAtHeight((top.bottom + bottom.top) / 2).type == BlockType.Text)\n            top.bottom = bottom.top = (top.bottom + bottom.top) / 2;\n        return pieces(top).concat(between).concat(pieces(bottom));\n    }\n    function piece(left, top, right, bottom) {\n        return new RectangleMarker(className, left - base.left, top - base.top - 0.01 /* C.Epsilon */, right - left, bottom - top + 0.01 /* C.Epsilon */);\n    }\n    function pieces({ top, bottom, horizontal }) {\n        let pieces = [];\n        for (let i = 0; i < horizontal.length; i += 2)\n            pieces.push(piece(horizontal[i], top, horizontal[i + 1], bottom));\n        return pieces;\n    }\n    // Gets passed from/to in line-local positions\n    function drawForLine(from, to, line) {\n        let top = 1e9, bottom = -1e9, horizontal = [];\n        function addSpan(from, fromOpen, to, toOpen, dir) {\n            // Passing 2/-2 is a kludge to force the view to return\n            // coordinates on the proper side of block widgets, since\n            // normalizing the side there, though appropriate for most\n            // coordsAtPos queries, would break selection drawing.\n            let fromCoords = view.coordsAtPos(from, (from == line.to ? -2 : 2));\n            let toCoords = view.coordsAtPos(to, (to == line.from ? 2 : -2));\n            top = Math.min(fromCoords.top, toCoords.top, top);\n            bottom = Math.max(fromCoords.bottom, toCoords.bottom, bottom);\n            if (dir == Direction.LTR)\n                horizontal.push(ltr && fromOpen ? leftSide : fromCoords.left, ltr && toOpen ? rightSide : toCoords.right);\n            else\n                horizontal.push(!ltr && toOpen ? leftSide : toCoords.left, !ltr && fromOpen ? rightSide : fromCoords.right);\n        }\n        let start = from !== null && from !== void 0 ? from : line.from, end = to !== null && to !== void 0 ? to : line.to;\n        // Split the range by visible range and document line\n        for (let r of view.visibleRanges)\n            if (r.to > start && r.from < end) {\n                for (let pos = Math.max(r.from, start), endPos = Math.min(r.to, end);;) {\n                    let docLine = view.state.doc.lineAt(pos);\n                    for (let span of view.bidiSpans(docLine)) {\n                        let spanFrom = span.from + docLine.from, spanTo = span.to + docLine.from;\n                        if (spanFrom >= endPos)\n                            break;\n                        if (spanTo > pos)\n                            addSpan(Math.max(spanFrom, pos), from == null && spanFrom <= start, Math.min(spanTo, endPos), to == null && spanTo >= end, span.dir);\n                    }\n                    pos = docLine.to + 1;\n                    if (pos >= endPos)\n                        break;\n                }\n            }\n        if (horizontal.length == 0)\n            addSpan(start, from == null, end, to == null, view.textDirection);\n        return { top, bottom, horizontal };\n    }\n    function drawForWidget(block, top) {\n        let y = contentRect.top + (top ? block.top : block.bottom);\n        return { top: y, bottom: y, horizontal: [] };\n    }\n}\nfunction sameMarker(a, b) {\n    return a.constructor == b.constructor && a.eq(b);\n}\nclass LayerView {\n    constructor(view, layer) {\n        this.view = view;\n        this.layer = layer;\n        this.drawn = [];\n        this.measureReq = { read: this.measure.bind(this), write: this.draw.bind(this) };\n        this.dom = view.scrollDOM.appendChild(document.createElement(\"div\"));\n        this.dom.classList.add(\"cm-layer\");\n        if (layer.above)\n            this.dom.classList.add(\"cm-layer-above\");\n        if (layer.class)\n            this.dom.classList.add(layer.class);\n        this.dom.setAttribute(\"aria-hidden\", \"true\");\n        this.setOrder(view.state);\n        view.requestMeasure(this.measureReq);\n        if (layer.mount)\n            layer.mount(this.dom, view);\n    }\n    update(update) {\n        if (update.startState.facet(layerOrder) != update.state.facet(layerOrder))\n            this.setOrder(update.state);\n        if (this.layer.update(update, this.dom) || update.geometryChanged)\n            update.view.requestMeasure(this.measureReq);\n    }\n    setOrder(state) {\n        let pos = 0, order = state.facet(layerOrder);\n        while (pos < order.length && order[pos] != this.layer)\n            pos++;\n        this.dom.style.zIndex = String((this.layer.above ? 150 : -1) - pos);\n    }\n    measure() {\n        return this.layer.markers(this.view);\n    }\n    draw(markers) {\n        if (markers.length != this.drawn.length || markers.some((p, i) => !sameMarker(p, this.drawn[i]))) {\n            let old = this.dom.firstChild, oldI = 0;\n            for (let marker of markers) {\n                if (marker.update && old && marker.constructor && this.drawn[oldI].constructor &&\n                    marker.update(old, this.drawn[oldI])) {\n                    old = old.nextSibling;\n                    oldI++;\n                }\n                else {\n                    this.dom.insertBefore(marker.draw(), old);\n                }\n            }\n            while (old) {\n                let next = old.nextSibling;\n                old.remove();\n                old = next;\n            }\n            this.drawn = markers;\n        }\n    }\n    destroy() {\n        if (this.layer.destroy)\n            this.layer.destroy(this.dom, this.view);\n        this.dom.remove();\n    }\n}\nconst layerOrder = /*@__PURE__*/Facet.define();\n/**\nDefine a layer.\n*/\nfunction layer(config) {\n    return [\n        ViewPlugin.define(v => new LayerView(v, config)),\n        layerOrder.of(config)\n    ];\n}\n\nconst CanHidePrimary = !browser.ios; // FIXME test IE\nconst selectionConfig = /*@__PURE__*/Facet.define({\n    combine(configs) {\n        return combineConfig(configs, {\n            cursorBlinkRate: 1200,\n            drawRangeCursor: true\n        }, {\n            cursorBlinkRate: (a, b) => Math.min(a, b),\n            drawRangeCursor: (a, b) => a || b\n        });\n    }\n});\n/**\nReturns an extension that hides the browser's native selection and\ncursor, replacing the selection with a background behind the text\n(with the `cm-selectionBackground` class), and the\ncursors with elements overlaid over the code (using\n`cm-cursor-primary` and `cm-cursor-secondary`).\n\nThis allows the editor to display secondary selection ranges, and\ntends to produce a type of selection more in line with that users\nexpect in a text editor (the native selection styling will often\nleave gaps between lines and won't fill the horizontal space after\na line when the selection continues past it).\n\nIt does have a performance cost, in that it requires an extra DOM\nlayout cycle for many updates (the selection is drawn based on DOM\nlayout information that's only available after laying out the\ncontent).\n*/\nfunction drawSelection(config = {}) {\n    return [\n        selectionConfig.of(config),\n        cursorLayer,\n        selectionLayer,\n        hideNativeSelection,\n        nativeSelectionHidden.of(true)\n    ];\n}\nfunction configChanged(update) {\n    return update.startState.facet(selectionConfig) != update.state.facet(selectionConfig);\n}\nconst cursorLayer = /*@__PURE__*/layer({\n    above: true,\n    markers(view) {\n        let { state } = view, conf = state.facet(selectionConfig);\n        let cursors = [];\n        for (let r of state.selection.ranges) {\n            let prim = r == state.selection.main;\n            if (r.empty ? !prim || CanHidePrimary : conf.drawRangeCursor) {\n                let className = prim ? \"cm-cursor cm-cursor-primary\" : \"cm-cursor cm-cursor-secondary\";\n                let cursor = r.empty ? r : EditorSelection.cursor(r.head, r.head > r.anchor ? -1 : 1);\n                for (let piece of RectangleMarker.forRange(view, className, cursor))\n                    cursors.push(piece);\n            }\n        }\n        return cursors;\n    },\n    update(update, dom) {\n        if (update.transactions.some(tr => tr.selection))\n            dom.style.animationName = dom.style.animationName == \"cm-blink\" ? \"cm-blink2\" : \"cm-blink\";\n        let confChange = configChanged(update);\n        if (confChange)\n            setBlinkRate(update.state, dom);\n        return update.docChanged || update.selectionSet || confChange;\n    },\n    mount(dom, view) {\n        setBlinkRate(view.state, dom);\n    },\n    class: \"cm-cursorLayer\"\n});\nfunction setBlinkRate(state, dom) {\n    dom.style.animationDuration = state.facet(selectionConfig).cursorBlinkRate + \"ms\";\n}\nconst selectionLayer = /*@__PURE__*/layer({\n    above: false,\n    markers(view) {\n        return view.state.selection.ranges.map(r => r.empty ? [] : RectangleMarker.forRange(view, \"cm-selectionBackground\", r))\n            .reduce((a, b) => a.concat(b));\n    },\n    update(update, dom) {\n        return update.docChanged || update.selectionSet || update.viewportChanged || configChanged(update);\n    },\n    class: \"cm-selectionLayer\"\n});\nconst themeSpec = {\n    \".cm-line\": {\n        \"& ::selection\": { backgroundColor: \"transparent !important\" },\n        \"&::selection\": { backgroundColor: \"transparent !important\" }\n    }\n};\nif (CanHidePrimary)\n    themeSpec[\".cm-line\"].caretColor = \"transparent !important\";\nconst hideNativeSelection = /*@__PURE__*/Prec.highest(/*@__PURE__*/EditorView.theme(themeSpec));\n\nconst setDropCursorPos = /*@__PURE__*/StateEffect.define({\n    map(pos, mapping) { return pos == null ? null : mapping.mapPos(pos); }\n});\nconst dropCursorPos = /*@__PURE__*/StateField.define({\n    create() { return null; },\n    update(pos, tr) {\n        if (pos != null)\n            pos = tr.changes.mapPos(pos);\n        return tr.effects.reduce((pos, e) => e.is(setDropCursorPos) ? e.value : pos, pos);\n    }\n});\nconst drawDropCursor = /*@__PURE__*/ViewPlugin.fromClass(class {\n    constructor(view) {\n        this.view = view;\n        this.cursor = null;\n        this.measureReq = { read: this.readPos.bind(this), write: this.drawCursor.bind(this) };\n    }\n    update(update) {\n        var _a;\n        let cursorPos = update.state.field(dropCursorPos);\n        if (cursorPos == null) {\n            if (this.cursor != null) {\n                (_a = this.cursor) === null || _a === void 0 ? void 0 : _a.remove();\n                this.cursor = null;\n            }\n        }\n        else {\n            if (!this.cursor) {\n                this.cursor = this.view.scrollDOM.appendChild(document.createElement(\"div\"));\n                this.cursor.className = \"cm-dropCursor\";\n            }\n            if (update.startState.field(dropCursorPos) != cursorPos || update.docChanged || update.geometryChanged)\n                this.view.requestMeasure(this.measureReq);\n        }\n    }\n    readPos() {\n        let pos = this.view.state.field(dropCursorPos);\n        let rect = pos != null && this.view.coordsAtPos(pos);\n        if (!rect)\n            return null;\n        let outer = this.view.scrollDOM.getBoundingClientRect();\n        return {\n            left: rect.left - outer.left + this.view.scrollDOM.scrollLeft,\n            top: rect.top - outer.top + this.view.scrollDOM.scrollTop,\n            height: rect.bottom - rect.top\n        };\n    }\n    drawCursor(pos) {\n        if (this.cursor) {\n            if (pos) {\n                this.cursor.style.left = pos.left + \"px\";\n                this.cursor.style.top = pos.top + \"px\";\n                this.cursor.style.height = pos.height + \"px\";\n            }\n            else {\n                this.cursor.style.left = \"-100000px\";\n            }\n        }\n    }\n    destroy() {\n        if (this.cursor)\n            this.cursor.remove();\n    }\n    setDropPos(pos) {\n        if (this.view.state.field(dropCursorPos) != pos)\n            this.view.dispatch({ effects: setDropCursorPos.of(pos) });\n    }\n}, {\n    eventHandlers: {\n        dragover(event) {\n            this.setDropPos(this.view.posAtCoords({ x: event.clientX, y: event.clientY }));\n        },\n        dragleave(event) {\n            if (event.target == this.view.contentDOM || !this.view.contentDOM.contains(event.relatedTarget))\n                this.setDropPos(null);\n        },\n        dragend() {\n            this.setDropPos(null);\n        },\n        drop() {\n            this.setDropPos(null);\n        }\n    }\n});\n/**\nDraws a cursor at the current drop position when something is\ndragged over the editor.\n*/\nfunction dropCursor() {\n    return [dropCursorPos, drawDropCursor];\n}\n\nfunction iterMatches(doc, re, from, to, f) {\n    re.lastIndex = 0;\n    for (let cursor = doc.iterRange(from, to), pos = from, m; !cursor.next().done; pos += cursor.value.length) {\n        if (!cursor.lineBreak)\n            while (m = re.exec(cursor.value))\n                f(pos + m.index, m);\n    }\n}\nfunction matchRanges(view, maxLength) {\n    let visible = view.visibleRanges;\n    if (visible.length == 1 && visible[0].from == view.viewport.from &&\n        visible[0].to == view.viewport.to)\n        return visible;\n    let result = [];\n    for (let { from, to } of visible) {\n        from = Math.max(view.state.doc.lineAt(from).from, from - maxLength);\n        to = Math.min(view.state.doc.lineAt(to).to, to + maxLength);\n        if (result.length && result[result.length - 1].to >= from)\n            result[result.length - 1].to = to;\n        else\n            result.push({ from, to });\n    }\n    return result;\n}\n/**\nHelper class used to make it easier to maintain decorations on\nvisible code that matches a given regular expression. To be used\nin a [view plugin](https://codemirror.net/6/docs/ref/#view.ViewPlugin). Instances of this object\nrepresent a matching configuration.\n*/\nclass MatchDecorator {\n    /**\n    Create a decorator.\n    */\n    constructor(config) {\n        const { regexp, decoration, decorate, boundary, maxLength = 1000 } = config;\n        if (!regexp.global)\n            throw new RangeError(\"The regular expression given to MatchDecorator should have its 'g' flag set\");\n        this.regexp = regexp;\n        if (decorate) {\n            this.addMatch = (match, view, from, add) => decorate(add, from, from + match[0].length, match, view);\n        }\n        else if (typeof decoration == \"function\") {\n            this.addMatch = (match, view, from, add) => {\n                let deco = decoration(match, view, from);\n                if (deco)\n                    add(from, from + match[0].length, deco);\n            };\n        }\n        else if (decoration) {\n            this.addMatch = (match, _view, from, add) => add(from, from + match[0].length, decoration);\n        }\n        else {\n            throw new RangeError(\"Either 'decorate' or 'decoration' should be provided to MatchDecorator\");\n        }\n        this.boundary = boundary;\n        this.maxLength = maxLength;\n    }\n    /**\n    Compute the full set of decorations for matches in the given\n    view's viewport. You'll want to call this when initializing your\n    plugin.\n    */\n    createDeco(view) {\n        let build = new RangeSetBuilder(), add = build.add.bind(build);\n        for (let { from, to } of matchRanges(view, this.maxLength))\n            iterMatches(view.state.doc, this.regexp, from, to, (from, m) => this.addMatch(m, view, from, add));\n        return build.finish();\n    }\n    /**\n    Update a set of decorations for a view update. `deco` _must_ be\n    the set of decorations produced by _this_ `MatchDecorator` for\n    the view state before the update.\n    */\n    updateDeco(update, deco) {\n        let changeFrom = 1e9, changeTo = -1;\n        if (update.docChanged)\n            update.changes.iterChanges((_f, _t, from, to) => {\n                if (to > update.view.viewport.from && from < update.view.viewport.to) {\n                    changeFrom = Math.min(from, changeFrom);\n                    changeTo = Math.max(to, changeTo);\n                }\n            });\n        if (update.viewportChanged || changeTo - changeFrom > 1000)\n            return this.createDeco(update.view);\n        if (changeTo > -1)\n            return this.updateRange(update.view, deco.map(update.changes), changeFrom, changeTo);\n        return deco;\n    }\n    updateRange(view, deco, updateFrom, updateTo) {\n        for (let r of view.visibleRanges) {\n            let from = Math.max(r.from, updateFrom), to = Math.min(r.to, updateTo);\n            if (to > from) {\n                let fromLine = view.state.doc.lineAt(from), toLine = fromLine.to < to ? view.state.doc.lineAt(to) : fromLine;\n                let start = Math.max(r.from, fromLine.from), end = Math.min(r.to, toLine.to);\n                if (this.boundary) {\n                    for (; from > fromLine.from; from--)\n                        if (this.boundary.test(fromLine.text[from - 1 - fromLine.from])) {\n                            start = from;\n                            break;\n                        }\n                    for (; to < toLine.to; to++)\n                        if (this.boundary.test(toLine.text[to - toLine.from])) {\n                            end = to;\n                            break;\n                        }\n                }\n                let ranges = [], m;\n                let add = (from, to, deco) => ranges.push(deco.range(from, to));\n                if (fromLine == toLine) {\n                    this.regexp.lastIndex = start - fromLine.from;\n                    while ((m = this.regexp.exec(fromLine.text)) && m.index < end - fromLine.from)\n                        this.addMatch(m, view, m.index + fromLine.from, add);\n                }\n                else {\n                    iterMatches(view.state.doc, this.regexp, start, end, (from, m) => this.addMatch(m, view, from, add));\n                }\n                deco = deco.update({ filterFrom: start, filterTo: end, filter: (from, to) => from < start || to > end, add: ranges });\n            }\n        }\n        return deco;\n    }\n}\n\nconst UnicodeRegexpSupport = /x/.unicode != null ? \"gu\" : \"g\";\nconst Specials = /*@__PURE__*/new RegExp(\"[\\u0000-\\u0008\\u000a-\\u001f\\u007f-\\u009f\\u00ad\\u061c\\u200b\\u200e\\u200f\\u2028\\u2029\\u202d\\u202e\\u2066\\u2067\\u2069\\ufeff\\ufff9-\\ufffc]\", UnicodeRegexpSupport);\nconst Names = {\n    0: \"null\",\n    7: \"bell\",\n    8: \"backspace\",\n    10: \"newline\",\n    11: \"vertical tab\",\n    13: \"carriage return\",\n    27: \"escape\",\n    8203: \"zero width space\",\n    8204: \"zero width non-joiner\",\n    8205: \"zero width joiner\",\n    8206: \"left-to-right mark\",\n    8207: \"right-to-left mark\",\n    8232: \"line separator\",\n    8237: \"left-to-right override\",\n    8238: \"right-to-left override\",\n    8294: \"left-to-right isolate\",\n    8295: \"right-to-left isolate\",\n    8297: \"pop directional isolate\",\n    8233: \"paragraph separator\",\n    65279: \"zero width no-break space\",\n    65532: \"object replacement\"\n};\nlet _supportsTabSize = null;\nfunction supportsTabSize() {\n    var _a;\n    if (_supportsTabSize == null && typeof document != \"undefined\" && document.body) {\n        let styles = document.body.style;\n        _supportsTabSize = ((_a = styles.tabSize) !== null && _a !== void 0 ? _a : styles.MozTabSize) != null;\n    }\n    return _supportsTabSize || false;\n}\nconst specialCharConfig = /*@__PURE__*/Facet.define({\n    combine(configs) {\n        let config = combineConfig(configs, {\n            render: null,\n            specialChars: Specials,\n            addSpecialChars: null\n        });\n        if (config.replaceTabs = !supportsTabSize())\n            config.specialChars = new RegExp(\"\\t|\" + config.specialChars.source, UnicodeRegexpSupport);\n        if (config.addSpecialChars)\n            config.specialChars = new RegExp(config.specialChars.source + \"|\" + config.addSpecialChars.source, UnicodeRegexpSupport);\n        return config;\n    }\n});\n/**\nReturns an extension that installs highlighting of special\ncharacters.\n*/\nfunction highlightSpecialChars(\n/**\nConfiguration options.\n*/\nconfig = {}) {\n    return [specialCharConfig.of(config), specialCharPlugin()];\n}\nlet _plugin = null;\nfunction specialCharPlugin() {\n    return _plugin || (_plugin = ViewPlugin.fromClass(class {\n        constructor(view) {\n            this.view = view;\n            this.decorations = Decoration.none;\n            this.decorationCache = Object.create(null);\n            this.decorator = this.makeDecorator(view.state.facet(specialCharConfig));\n            this.decorations = this.decorator.createDeco(view);\n        }\n        makeDecorator(conf) {\n            return new MatchDecorator({\n                regexp: conf.specialChars,\n                decoration: (m, view, pos) => {\n                    let { doc } = view.state;\n                    let code = codePointAt(m[0], 0);\n                    if (code == 9) {\n                        let line = doc.lineAt(pos);\n                        let size = view.state.tabSize, col = countColumn(line.text, size, pos - line.from);\n                        return Decoration.replace({ widget: new TabWidget((size - (col % size)) * this.view.defaultCharacterWidth) });\n                    }\n                    return this.decorationCache[code] ||\n                        (this.decorationCache[code] = Decoration.replace({ widget: new SpecialCharWidget(conf, code) }));\n                },\n                boundary: conf.replaceTabs ? undefined : /[^]/\n            });\n        }\n        update(update) {\n            let conf = update.state.facet(specialCharConfig);\n            if (update.startState.facet(specialCharConfig) != conf) {\n                this.decorator = this.makeDecorator(conf);\n                this.decorations = this.decorator.createDeco(update.view);\n            }\n            else {\n                this.decorations = this.decorator.updateDeco(update, this.decorations);\n            }\n        }\n    }, {\n        decorations: v => v.decorations\n    }));\n}\nconst DefaultPlaceholder = \"\\u2022\";\n// Assigns placeholder characters from the Control Pictures block to\n// ASCII control characters\nfunction placeholder$1(code) {\n    if (code >= 32)\n        return DefaultPlaceholder;\n    if (code == 10)\n        return \"\\u2424\";\n    return String.fromCharCode(9216 + code);\n}\nclass SpecialCharWidget extends WidgetType {\n    constructor(options, code) {\n        super();\n        this.options = options;\n        this.code = code;\n    }\n    eq(other) { return other.code == this.code; }\n    toDOM(view) {\n        let ph = placeholder$1(this.code);\n        let desc = view.state.phrase(\"Control character\") + \" \" + (Names[this.code] || \"0x\" + this.code.toString(16));\n        let custom = this.options.render && this.options.render(this.code, desc, ph);\n        if (custom)\n            return custom;\n        let span = document.createElement(\"span\");\n        span.textContent = ph;\n        span.title = desc;\n        span.setAttribute(\"aria-label\", desc);\n        span.className = \"cm-specialChar\";\n        return span;\n    }\n    ignoreEvent() { return false; }\n}\nclass TabWidget extends WidgetType {\n    constructor(width) {\n        super();\n        this.width = width;\n    }\n    eq(other) { return other.width == this.width; }\n    toDOM() {\n        let span = document.createElement(\"span\");\n        span.textContent = \"\\t\";\n        span.className = \"cm-tab\";\n        span.style.width = this.width + \"px\";\n        return span;\n    }\n    ignoreEvent() { return false; }\n}\n\nconst plugin = /*@__PURE__*/ViewPlugin.fromClass(class {\n    constructor() {\n        this.height = 1000;\n        this.attrs = { style: \"padding-bottom: 1000px\" };\n    }\n    update(update) {\n        let { view } = update;\n        let height = view.viewState.editorHeight - view.defaultLineHeight - view.documentPadding.top - 0.5;\n        if (height != this.height) {\n            this.height = height;\n            this.attrs = { style: `padding-bottom: ${height}px` };\n        }\n    }\n});\n/**\nReturns an extension that makes sure the content has a bottom\nmargin equivalent to the height of the editor, minus one line\nheight, so that every line in the document can be scrolled to the\ntop of the editor.\n\nThis is only meaningful when the editor is scrollable, and should\nnot be enabled in editors that take the size of their content.\n*/\nfunction scrollPastEnd() {\n    return [plugin, contentAttributes.of(view => { var _a; return ((_a = view.plugin(plugin)) === null || _a === void 0 ? void 0 : _a.attrs) || null; })];\n}\n\n/**\nMark lines that have a cursor on them with the `\"cm-activeLine\"`\nDOM class.\n*/\nfunction highlightActiveLine() {\n    return activeLineHighlighter;\n}\nconst lineDeco = /*@__PURE__*/Decoration.line({ class: \"cm-activeLine\" });\nconst activeLineHighlighter = /*@__PURE__*/ViewPlugin.fromClass(class {\n    constructor(view) {\n        this.decorations = this.getDeco(view);\n    }\n    update(update) {\n        if (update.docChanged || update.selectionSet)\n            this.decorations = this.getDeco(update.view);\n    }\n    getDeco(view) {\n        let lastLineStart = -1, deco = [];\n        for (let r of view.state.selection.ranges) {\n            let line = view.lineBlockAt(r.head);\n            if (line.from > lastLineStart) {\n                deco.push(lineDeco.range(line.from));\n                lastLineStart = line.from;\n            }\n        }\n        return Decoration.set(deco);\n    }\n}, {\n    decorations: v => v.decorations\n});\n\nclass Placeholder extends WidgetType {\n    constructor(content) {\n        super();\n        this.content = content;\n    }\n    toDOM() {\n        let wrap = document.createElement(\"span\");\n        wrap.className = \"cm-placeholder\";\n        wrap.style.pointerEvents = \"none\";\n        wrap.appendChild(typeof this.content == \"string\" ? document.createTextNode(this.content) : this.content);\n        if (typeof this.content == \"string\")\n            wrap.setAttribute(\"aria-label\", \"placeholder \" + this.content);\n        else\n            wrap.setAttribute(\"aria-hidden\", \"true\");\n        return wrap;\n    }\n    ignoreEvent() { return false; }\n}\n/**\nExtension that enables a placeholder—a piece of example content\nto show when the editor is empty.\n*/\nfunction placeholder(content) {\n    return ViewPlugin.fromClass(class {\n        constructor(view) {\n            this.view = view;\n            this.placeholder = Decoration.set([Decoration.widget({ widget: new Placeholder(content), side: 1 }).range(0)]);\n        }\n        get decorations() { return this.view.state.doc.length ? Decoration.none : this.placeholder; }\n    }, { decorations: v => v.decorations });\n}\n\n// Don't compute precise column positions for line offsets above this\n// (since it could get expensive). Assume offset==column for them.\nconst MaxOff = 2000;\nfunction rectangleFor(state, a, b) {\n    let startLine = Math.min(a.line, b.line), endLine = Math.max(a.line, b.line);\n    let ranges = [];\n    if (a.off > MaxOff || b.off > MaxOff || a.col < 0 || b.col < 0) {\n        let startOff = Math.min(a.off, b.off), endOff = Math.max(a.off, b.off);\n        for (let i = startLine; i <= endLine; i++) {\n            let line = state.doc.line(i);\n            if (line.length <= endOff)\n                ranges.push(EditorSelection.range(line.from + startOff, line.to + endOff));\n        }\n    }\n    else {\n        let startCol = Math.min(a.col, b.col), endCol = Math.max(a.col, b.col);\n        for (let i = startLine; i <= endLine; i++) {\n            let line = state.doc.line(i);\n            let start = findColumn(line.text, startCol, state.tabSize, true);\n            if (start < 0) {\n                ranges.push(EditorSelection.cursor(line.to));\n            }\n            else {\n                let end = findColumn(line.text, endCol, state.tabSize);\n                ranges.push(EditorSelection.range(line.from + start, line.from + end));\n            }\n        }\n    }\n    return ranges;\n}\nfunction absoluteColumn(view, x) {\n    let ref = view.coordsAtPos(view.viewport.from);\n    return ref ? Math.round(Math.abs((ref.left - x) / view.defaultCharacterWidth)) : -1;\n}\nfunction getPos(view, event) {\n    let offset = view.posAtCoords({ x: event.clientX, y: event.clientY }, false);\n    let line = view.state.doc.lineAt(offset), off = offset - line.from;\n    let col = off > MaxOff ? -1\n        : off == line.length ? absoluteColumn(view, event.clientX)\n            : countColumn(line.text, view.state.tabSize, offset - line.from);\n    return { line: line.number, col, off };\n}\nfunction rectangleSelectionStyle(view, event) {\n    let start = getPos(view, event), startSel = view.state.selection;\n    if (!start)\n        return null;\n    return {\n        update(update) {\n            if (update.docChanged) {\n                let newStart = update.changes.mapPos(update.startState.doc.line(start.line).from);\n                let newLine = update.state.doc.lineAt(newStart);\n                start = { line: newLine.number, col: start.col, off: Math.min(start.off, newLine.length) };\n                startSel = startSel.map(update.changes);\n            }\n        },\n        get(event, _extend, multiple) {\n            let cur = getPos(view, event);\n            if (!cur)\n                return startSel;\n            let ranges = rectangleFor(view.state, start, cur);\n            if (!ranges.length)\n                return startSel;\n            if (multiple)\n                return EditorSelection.create(ranges.concat(startSel.ranges));\n            else\n                return EditorSelection.create(ranges);\n        }\n    };\n}\n/**\nCreate an extension that enables rectangular selections. By\ndefault, it will react to left mouse drag with the Alt key held\ndown. When such a selection occurs, the text within the rectangle\nthat was dragged over will be selected, as one selection\n[range](https://codemirror.net/6/docs/ref/#state.SelectionRange) per line.\n*/\nfunction rectangularSelection(options) {\n    let filter = (options === null || options === void 0 ? void 0 : options.eventFilter) || (e => e.altKey && e.button == 0);\n    return EditorView.mouseSelectionStyle.of((view, event) => filter(event) ? rectangleSelectionStyle(view, event) : null);\n}\nconst keys = {\n    Alt: [18, e => e.altKey],\n    Control: [17, e => e.ctrlKey],\n    Shift: [16, e => e.shiftKey],\n    Meta: [91, e => e.metaKey]\n};\nconst showCrosshair = { style: \"cursor: crosshair\" };\n/**\nReturns an extension that turns the pointer cursor into a\ncrosshair when a given modifier key, defaulting to Alt, is held\ndown. Can serve as a visual hint that rectangular selection is\ngoing to happen when paired with\n[`rectangularSelection`](https://codemirror.net/6/docs/ref/#view.rectangularSelection).\n*/\nfunction crosshairCursor(options = {}) {\n    let [code, getter] = keys[options.key || \"Alt\"];\n    let plugin = ViewPlugin.fromClass(class {\n        constructor(view) {\n            this.view = view;\n            this.isDown = false;\n        }\n        set(isDown) {\n            if (this.isDown != isDown) {\n                this.isDown = isDown;\n                this.view.update([]);\n            }\n        }\n    }, {\n        eventHandlers: {\n            keydown(e) {\n                this.set(e.keyCode == code || getter(e));\n            },\n            keyup(e) {\n                if (e.keyCode == code || !getter(e))\n                    this.set(false);\n            },\n            mousemove(e) {\n                this.set(getter(e));\n            }\n        }\n    });\n    return [\n        plugin,\n        EditorView.contentAttributes.of(view => { var _a; return ((_a = view.plugin(plugin)) === null || _a === void 0 ? void 0 : _a.isDown) ? showCrosshair : null; })\n    ];\n}\n\nconst Outside = \"-10000px\";\nclass TooltipViewManager {\n    constructor(view, facet, createTooltipView) {\n        this.facet = facet;\n        this.createTooltipView = createTooltipView;\n        this.input = view.state.facet(facet);\n        this.tooltips = this.input.filter(t => t);\n        this.tooltipViews = this.tooltips.map(createTooltipView);\n    }\n    update(update) {\n        var _a;\n        let input = update.state.facet(this.facet);\n        let tooltips = input.filter(x => x);\n        if (input === this.input) {\n            for (let t of this.tooltipViews)\n                if (t.update)\n                    t.update(update);\n            return false;\n        }\n        let tooltipViews = [];\n        for (let i = 0; i < tooltips.length; i++) {\n            let tip = tooltips[i], known = -1;\n            if (!tip)\n                continue;\n            for (let i = 0; i < this.tooltips.length; i++) {\n                let other = this.tooltips[i];\n                if (other && other.create == tip.create)\n                    known = i;\n            }\n            if (known < 0) {\n                tooltipViews[i] = this.createTooltipView(tip);\n            }\n            else {\n                let tooltipView = tooltipViews[i] = this.tooltipViews[known];\n                if (tooltipView.update)\n                    tooltipView.update(update);\n            }\n        }\n        for (let t of this.tooltipViews)\n            if (tooltipViews.indexOf(t) < 0) {\n                t.dom.remove();\n                (_a = t.destroy) === null || _a === void 0 ? void 0 : _a.call(t);\n            }\n        this.input = input;\n        this.tooltips = tooltips;\n        this.tooltipViews = tooltipViews;\n        return true;\n    }\n}\n/**\nCreates an extension that configures tooltip behavior.\n*/\nfunction tooltips(config = {}) {\n    return tooltipConfig.of(config);\n}\nfunction windowSpace(view) {\n    let { win } = view;\n    return { top: 0, left: 0, bottom: win.innerHeight, right: win.innerWidth };\n}\nconst tooltipConfig = /*@__PURE__*/Facet.define({\n    combine: values => {\n        var _a, _b, _c;\n        return ({\n            position: browser.ios ? \"absolute\" : ((_a = values.find(conf => conf.position)) === null || _a === void 0 ? void 0 : _a.position) || \"fixed\",\n            parent: ((_b = values.find(conf => conf.parent)) === null || _b === void 0 ? void 0 : _b.parent) || null,\n            tooltipSpace: ((_c = values.find(conf => conf.tooltipSpace)) === null || _c === void 0 ? void 0 : _c.tooltipSpace) || windowSpace,\n        });\n    }\n});\nconst knownHeight = /*@__PURE__*/new WeakMap();\nconst tooltipPlugin = /*@__PURE__*/ViewPlugin.fromClass(class {\n    constructor(view) {\n        this.view = view;\n        this.inView = true;\n        this.lastTransaction = 0;\n        this.measureTimeout = -1;\n        let config = view.state.facet(tooltipConfig);\n        this.position = config.position;\n        this.parent = config.parent;\n        this.classes = view.themeClasses;\n        this.createContainer();\n        this.measureReq = { read: this.readMeasure.bind(this), write: this.writeMeasure.bind(this), key: this };\n        this.manager = new TooltipViewManager(view, showTooltip, t => this.createTooltip(t));\n        this.intersectionObserver = typeof IntersectionObserver == \"function\" ? new IntersectionObserver(entries => {\n            if (Date.now() > this.lastTransaction - 50 &&\n                entries.length > 0 && entries[entries.length - 1].intersectionRatio < 1)\n                this.measureSoon();\n        }, { threshold: [1] }) : null;\n        this.observeIntersection();\n        view.win.addEventListener(\"resize\", this.measureSoon = this.measureSoon.bind(this));\n        this.maybeMeasure();\n    }\n    createContainer() {\n        if (this.parent) {\n            this.container = document.createElement(\"div\");\n            this.container.style.position = \"relative\";\n            this.container.className = this.view.themeClasses;\n            this.parent.appendChild(this.container);\n        }\n        else {\n            this.container = this.view.dom;\n        }\n    }\n    observeIntersection() {\n        if (this.intersectionObserver) {\n            this.intersectionObserver.disconnect();\n            for (let tooltip of this.manager.tooltipViews)\n                this.intersectionObserver.observe(tooltip.dom);\n        }\n    }\n    measureSoon() {\n        if (this.measureTimeout < 0)\n            this.measureTimeout = setTimeout(() => {\n                this.measureTimeout = -1;\n                this.maybeMeasure();\n            }, 50);\n    }\n    update(update) {\n        if (update.transactions.length)\n            this.lastTransaction = Date.now();\n        let updated = this.manager.update(update);\n        if (updated)\n            this.observeIntersection();\n        let shouldMeasure = updated || update.geometryChanged;\n        let newConfig = update.state.facet(tooltipConfig);\n        if (newConfig.position != this.position) {\n            this.position = newConfig.position;\n            for (let t of this.manager.tooltipViews)\n                t.dom.style.position = this.position;\n            shouldMeasure = true;\n        }\n        if (newConfig.parent != this.parent) {\n            if (this.parent)\n                this.container.remove();\n            this.parent = newConfig.parent;\n            this.createContainer();\n            for (let t of this.manager.tooltipViews)\n                this.container.appendChild(t.dom);\n            shouldMeasure = true;\n        }\n        else if (this.parent && this.view.themeClasses != this.classes) {\n            this.classes = this.container.className = this.view.themeClasses;\n        }\n        if (shouldMeasure)\n            this.maybeMeasure();\n    }\n    createTooltip(tooltip) {\n        let tooltipView = tooltip.create(this.view);\n        tooltipView.dom.classList.add(\"cm-tooltip\");\n        if (tooltip.arrow && !tooltipView.dom.querySelector(\".cm-tooltip > .cm-tooltip-arrow\")) {\n            let arrow = document.createElement(\"div\");\n            arrow.className = \"cm-tooltip-arrow\";\n            tooltipView.dom.appendChild(arrow);\n        }\n        tooltipView.dom.style.position = this.position;\n        tooltipView.dom.style.top = Outside;\n        this.container.appendChild(tooltipView.dom);\n        if (tooltipView.mount)\n            tooltipView.mount(this.view);\n        return tooltipView;\n    }\n    destroy() {\n        var _a, _b;\n        this.view.win.removeEventListener(\"resize\", this.measureSoon);\n        for (let tooltipView of this.manager.tooltipViews) {\n            tooltipView.dom.remove();\n            (_a = tooltipView.destroy) === null || _a === void 0 ? void 0 : _a.call(tooltipView);\n        }\n        (_b = this.intersectionObserver) === null || _b === void 0 ? void 0 : _b.disconnect();\n        clearTimeout(this.measureTimeout);\n    }\n    readMeasure() {\n        let editor = this.view.dom.getBoundingClientRect();\n        return {\n            editor,\n            parent: this.parent ? this.container.getBoundingClientRect() : editor,\n            pos: this.manager.tooltips.map((t, i) => {\n                let tv = this.manager.tooltipViews[i];\n                return tv.getCoords ? tv.getCoords(t.pos) : this.view.coordsAtPos(t.pos);\n            }),\n            size: this.manager.tooltipViews.map(({ dom }) => dom.getBoundingClientRect()),\n            space: this.view.state.facet(tooltipConfig).tooltipSpace(this.view),\n        };\n    }\n    writeMeasure(measured) {\n        var _a;\n        let { editor, space } = measured;\n        let others = [];\n        for (let i = 0; i < this.manager.tooltips.length; i++) {\n            let tooltip = this.manager.tooltips[i], tView = this.manager.tooltipViews[i], { dom } = tView;\n            let pos = measured.pos[i], size = measured.size[i];\n            // Hide tooltips that are outside of the editor.\n            if (!pos || pos.bottom <= Math.max(editor.top, space.top) ||\n                pos.top >= Math.min(editor.bottom, space.bottom) ||\n                pos.right < Math.max(editor.left, space.left) - .1 ||\n                pos.left > Math.min(editor.right, space.right) + .1) {\n                dom.style.top = Outside;\n                continue;\n            }\n            let arrow = tooltip.arrow ? tView.dom.querySelector(\".cm-tooltip-arrow\") : null;\n            let arrowHeight = arrow ? 7 /* Arrow.Size */ : 0;\n            let width = size.right - size.left, height = (_a = knownHeight.get(tView)) !== null && _a !== void 0 ? _a : size.bottom - size.top;\n            let offset = tView.offset || noOffset, ltr = this.view.textDirection == Direction.LTR;\n            let left = size.width > space.right - space.left ? (ltr ? space.left : space.right - size.width)\n                : ltr ? Math.min(pos.left - (arrow ? 14 /* Arrow.Offset */ : 0) + offset.x, space.right - width)\n                    : Math.max(space.left, pos.left - width + (arrow ? 14 /* Arrow.Offset */ : 0) - offset.x);\n            let above = !!tooltip.above;\n            if (!tooltip.strictSide && (above\n                ? pos.top - (size.bottom - size.top) - offset.y < space.top\n                : pos.bottom + (size.bottom - size.top) + offset.y > space.bottom) &&\n                above == (space.bottom - pos.bottom > pos.top - space.top))\n                above = !above;\n            let spaceVert = (above ? pos.top - space.top : space.bottom - pos.bottom) - arrowHeight;\n            if (spaceVert < height && tView.resize !== false) {\n                if (spaceVert < this.view.defaultLineHeight) {\n                    dom.style.top = Outside;\n                    continue;\n                }\n                knownHeight.set(tView, height);\n                dom.style.height = (height = spaceVert) + \"px\";\n            }\n            else if (dom.style.height) {\n                dom.style.height = \"\";\n            }\n            let top = above ? pos.top - height - arrowHeight - offset.y : pos.bottom + arrowHeight + offset.y;\n            let right = left + width;\n            if (tView.overlap !== true)\n                for (let r of others)\n                    if (r.left < right && r.right > left && r.top < top + height && r.bottom > top)\n                        top = above ? r.top - height - 2 - arrowHeight : r.bottom + arrowHeight + 2;\n            if (this.position == \"absolute\") {\n                dom.style.top = (top - measured.parent.top) + \"px\";\n                dom.style.left = (left - measured.parent.left) + \"px\";\n            }\n            else {\n                dom.style.top = top + \"px\";\n                dom.style.left = left + \"px\";\n            }\n            if (arrow)\n                arrow.style.left = `${pos.left + (ltr ? offset.x : -offset.x) - (left + 14 /* Arrow.Offset */ - 7 /* Arrow.Size */)}px`;\n            if (tView.overlap !== true)\n                others.push({ left, top, right, bottom: top + height });\n            dom.classList.toggle(\"cm-tooltip-above\", above);\n            dom.classList.toggle(\"cm-tooltip-below\", !above);\n            if (tView.positioned)\n                tView.positioned(measured.space);\n        }\n    }\n    maybeMeasure() {\n        if (this.manager.tooltips.length) {\n            if (this.view.inView)\n                this.view.requestMeasure(this.measureReq);\n            if (this.inView != this.view.inView) {\n                this.inView = this.view.inView;\n                if (!this.inView)\n                    for (let tv of this.manager.tooltipViews)\n                        tv.dom.style.top = Outside;\n            }\n        }\n    }\n}, {\n    eventHandlers: {\n        scroll() { this.maybeMeasure(); }\n    }\n});\nconst baseTheme = /*@__PURE__*/EditorView.baseTheme({\n    \".cm-tooltip\": {\n        zIndex: 100,\n        boxSizing: \"border-box\"\n    },\n    \"&light .cm-tooltip\": {\n        border: \"1px solid #bbb\",\n        backgroundColor: \"#f5f5f5\"\n    },\n    \"&light .cm-tooltip-section:not(:first-child)\": {\n        borderTop: \"1px solid #bbb\",\n    },\n    \"&dark .cm-tooltip\": {\n        backgroundColor: \"#333338\",\n        color: \"white\"\n    },\n    \".cm-tooltip-arrow\": {\n        height: `${7 /* Arrow.Size */}px`,\n        width: `${7 /* Arrow.Size */ * 2}px`,\n        position: \"absolute\",\n        zIndex: -1,\n        overflow: \"hidden\",\n        \"&:before, &:after\": {\n            content: \"''\",\n            position: \"absolute\",\n            width: 0,\n            height: 0,\n            borderLeft: `${7 /* Arrow.Size */}px solid transparent`,\n            borderRight: `${7 /* Arrow.Size */}px solid transparent`,\n        },\n        \".cm-tooltip-above &\": {\n            bottom: `-${7 /* Arrow.Size */}px`,\n            \"&:before\": {\n                borderTop: `${7 /* Arrow.Size */}px solid #bbb`,\n            },\n            \"&:after\": {\n                borderTop: `${7 /* Arrow.Size */}px solid #f5f5f5`,\n                bottom: \"1px\"\n            }\n        },\n        \".cm-tooltip-below &\": {\n            top: `-${7 /* Arrow.Size */}px`,\n            \"&:before\": {\n                borderBottom: `${7 /* Arrow.Size */}px solid #bbb`,\n            },\n            \"&:after\": {\n                borderBottom: `${7 /* Arrow.Size */}px solid #f5f5f5`,\n                top: \"1px\"\n            }\n        },\n    },\n    \"&dark .cm-tooltip .cm-tooltip-arrow\": {\n        \"&:before\": {\n            borderTopColor: \"#333338\",\n            borderBottomColor: \"#333338\"\n        },\n        \"&:after\": {\n            borderTopColor: \"transparent\",\n            borderBottomColor: \"transparent\"\n        }\n    }\n});\nconst noOffset = { x: 0, y: 0 };\n/**\nFacet to which an extension can add a value to show a tooltip.\n*/\nconst showTooltip = /*@__PURE__*/Facet.define({\n    enables: [tooltipPlugin, baseTheme]\n});\nconst showHoverTooltip = /*@__PURE__*/Facet.define();\nclass HoverTooltipHost {\n    constructor(view) {\n        this.view = view;\n        this.mounted = false;\n        this.dom = document.createElement(\"div\");\n        this.dom.classList.add(\"cm-tooltip-hover\");\n        this.manager = new TooltipViewManager(view, showHoverTooltip, t => this.createHostedView(t));\n    }\n    // Needs to be static so that host tooltip instances always match\n    static create(view) {\n        return new HoverTooltipHost(view);\n    }\n    createHostedView(tooltip) {\n        let hostedView = tooltip.create(this.view);\n        hostedView.dom.classList.add(\"cm-tooltip-section\");\n        this.dom.appendChild(hostedView.dom);\n        if (this.mounted && hostedView.mount)\n            hostedView.mount(this.view);\n        return hostedView;\n    }\n    mount(view) {\n        for (let hostedView of this.manager.tooltipViews) {\n            if (hostedView.mount)\n                hostedView.mount(view);\n        }\n        this.mounted = true;\n    }\n    positioned(space) {\n        for (let hostedView of this.manager.tooltipViews) {\n            if (hostedView.positioned)\n                hostedView.positioned(space);\n        }\n    }\n    update(update) {\n        this.manager.update(update);\n    }\n}\nconst showHoverTooltipHost = /*@__PURE__*/showTooltip.compute([showHoverTooltip], state => {\n    let tooltips = state.facet(showHoverTooltip).filter(t => t);\n    if (tooltips.length === 0)\n        return null;\n    return {\n        pos: Math.min(...tooltips.map(t => t.pos)),\n        end: Math.max(...tooltips.filter(t => t.end != null).map(t => t.end)),\n        create: HoverTooltipHost.create,\n        above: tooltips[0].above,\n        arrow: tooltips.some(t => t.arrow),\n    };\n});\nclass HoverPlugin {\n    constructor(view, source, field, setHover, hoverTime) {\n        this.view = view;\n        this.source = source;\n        this.field = field;\n        this.setHover = setHover;\n        this.hoverTime = hoverTime;\n        this.hoverTimeout = -1;\n        this.restartTimeout = -1;\n        this.pending = null;\n        this.lastMove = { x: 0, y: 0, target: view.dom, time: 0 };\n        this.checkHover = this.checkHover.bind(this);\n        view.dom.addEventListener(\"mouseleave\", this.mouseleave = this.mouseleave.bind(this));\n        view.dom.addEventListener(\"mousemove\", this.mousemove = this.mousemove.bind(this));\n    }\n    update() {\n        if (this.pending) {\n            this.pending = null;\n            clearTimeout(this.restartTimeout);\n            this.restartTimeout = setTimeout(() => this.startHover(), 20);\n        }\n    }\n    get active() {\n        return this.view.state.field(this.field);\n    }\n    checkHover() {\n        this.hoverTimeout = -1;\n        if (this.active)\n            return;\n        let hovered = Date.now() - this.lastMove.time;\n        if (hovered < this.hoverTime)\n            this.hoverTimeout = setTimeout(this.checkHover, this.hoverTime - hovered);\n        else\n            this.startHover();\n    }\n    startHover() {\n        clearTimeout(this.restartTimeout);\n        let { lastMove } = this;\n        let pos = this.view.contentDOM.contains(lastMove.target) ? this.view.posAtCoords(lastMove) : null;\n        if (pos == null)\n            return;\n        let posCoords = this.view.coordsAtPos(pos);\n        if (posCoords == null || lastMove.y < posCoords.top || lastMove.y > posCoords.bottom ||\n            lastMove.x < posCoords.left - this.view.defaultCharacterWidth ||\n            lastMove.x > posCoords.right + this.view.defaultCharacterWidth)\n            return;\n        let bidi = this.view.bidiSpans(this.view.state.doc.lineAt(pos)).find(s => s.from <= pos && s.to >= pos);\n        let rtl = bidi && bidi.dir == Direction.RTL ? -1 : 1;\n        let open = this.source(this.view, pos, (lastMove.x < posCoords.left ? -rtl : rtl));\n        if (open === null || open === void 0 ? void 0 : open.then) {\n            let pending = this.pending = { pos };\n            open.then(result => {\n                if (this.pending == pending) {\n                    this.pending = null;\n                    if (result)\n                        this.view.dispatch({ effects: this.setHover.of(result) });\n                }\n            }, e => logException(this.view.state, e, \"hover tooltip\"));\n        }\n        else if (open) {\n            this.view.dispatch({ effects: this.setHover.of(open) });\n        }\n    }\n    mousemove(event) {\n        var _a;\n        this.lastMove = { x: event.clientX, y: event.clientY, target: event.target, time: Date.now() };\n        if (this.hoverTimeout < 0)\n            this.hoverTimeout = setTimeout(this.checkHover, this.hoverTime);\n        let tooltip = this.active;\n        if (tooltip && !isInTooltip(this.lastMove.target) || this.pending) {\n            let { pos } = tooltip || this.pending, end = (_a = tooltip === null || tooltip === void 0 ? void 0 : tooltip.end) !== null && _a !== void 0 ? _a : pos;\n            if ((pos == end ? this.view.posAtCoords(this.lastMove) != pos\n                : !isOverRange(this.view, pos, end, event.clientX, event.clientY, 6 /* Hover.MaxDist */))) {\n                this.view.dispatch({ effects: this.setHover.of(null) });\n                this.pending = null;\n            }\n        }\n    }\n    mouseleave(e) {\n        clearTimeout(this.hoverTimeout);\n        this.hoverTimeout = -1;\n        if (this.active && !isInTooltip(e.relatedTarget))\n            this.view.dispatch({ effects: this.setHover.of(null) });\n    }\n    destroy() {\n        clearTimeout(this.hoverTimeout);\n        this.view.dom.removeEventListener(\"mouseleave\", this.mouseleave);\n        this.view.dom.removeEventListener(\"mousemove\", this.mousemove);\n    }\n}\nfunction isInTooltip(elt) {\n    for (let cur = elt; cur; cur = cur.parentNode)\n        if (cur.nodeType == 1 && cur.classList.contains(\"cm-tooltip\"))\n            return true;\n    return false;\n}\nfunction isOverRange(view, from, to, x, y, margin) {\n    let range = document.createRange();\n    let fromDOM = view.domAtPos(from), toDOM = view.domAtPos(to);\n    range.setEnd(toDOM.node, toDOM.offset);\n    range.setStart(fromDOM.node, fromDOM.offset);\n    let rects = range.getClientRects();\n    range.detach();\n    for (let i = 0; i < rects.length; i++) {\n        let rect = rects[i];\n        let dist = Math.max(rect.top - y, y - rect.bottom, rect.left - x, x - rect.right);\n        if (dist <= margin)\n            return true;\n    }\n    return false;\n}\n/**\nSet up a hover tooltip, which shows up when the pointer hovers\nover ranges of text. The callback is called when the mouse hovers\nover the document text. It should, if there is a tooltip\nassociated with position `pos`, return the tooltip description\n(either directly or in a promise). The `side` argument indicates\non which side of the position the pointer is—it will be -1 if the\npointer is before the position, 1 if after the position.\n\nNote that all hover tooltips are hosted within a single tooltip\ncontainer element. This allows multiple tooltips over the same\nrange to be \"merged\" together without overlapping.\n*/\nfunction hoverTooltip(source, options = {}) {\n    let setHover = StateEffect.define();\n    let hoverState = StateField.define({\n        create() { return null; },\n        update(value, tr) {\n            if (value && (options.hideOnChange && (tr.docChanged || tr.selection) ||\n                options.hideOn && options.hideOn(tr, value)))\n                return null;\n            if (value && tr.docChanged) {\n                let newPos = tr.changes.mapPos(value.pos, -1, MapMode.TrackDel);\n                if (newPos == null)\n                    return null;\n                let copy = Object.assign(Object.create(null), value);\n                copy.pos = newPos;\n                if (value.end != null)\n                    copy.end = tr.changes.mapPos(value.end);\n                value = copy;\n            }\n            for (let effect of tr.effects) {\n                if (effect.is(setHover))\n                    value = effect.value;\n                if (effect.is(closeHoverTooltipEffect))\n                    value = null;\n            }\n            return value;\n        },\n        provide: f => showHoverTooltip.from(f)\n    });\n    return [\n        hoverState,\n        ViewPlugin.define(view => new HoverPlugin(view, source, hoverState, setHover, options.hoverTime || 300 /* Hover.Time */)),\n        showHoverTooltipHost\n    ];\n}\n/**\nGet the active tooltip view for a given tooltip, if available.\n*/\nfunction getTooltip(view, tooltip) {\n    let plugin = view.plugin(tooltipPlugin);\n    if (!plugin)\n        return null;\n    let found = plugin.manager.tooltips.indexOf(tooltip);\n    return found < 0 ? null : plugin.manager.tooltipViews[found];\n}\n/**\nReturns true if any hover tooltips are currently active.\n*/\nfunction hasHoverTooltips(state) {\n    return state.facet(showHoverTooltip).some(x => x);\n}\nconst closeHoverTooltipEffect = /*@__PURE__*/StateEffect.define();\n/**\nTransaction effect that closes all hover tooltips.\n*/\nconst closeHoverTooltips = /*@__PURE__*/closeHoverTooltipEffect.of(null);\n/**\nTell the tooltip extension to recompute the position of the active\ntooltips. This can be useful when something happens (such as a\nre-positioning or CSS change affecting the editor) that could\ninvalidate the existing tooltip positions.\n*/\nfunction repositionTooltips(view) {\n    var _a;\n    (_a = view.plugin(tooltipPlugin)) === null || _a === void 0 ? void 0 : _a.maybeMeasure();\n}\n\nconst panelConfig = /*@__PURE__*/Facet.define({\n    combine(configs) {\n        let topContainer, bottomContainer;\n        for (let c of configs) {\n            topContainer = topContainer || c.topContainer;\n            bottomContainer = bottomContainer || c.bottomContainer;\n        }\n        return { topContainer, bottomContainer };\n    }\n});\n/**\nConfigures the panel-managing extension.\n*/\nfunction panels(config) {\n    return config ? [panelConfig.of(config)] : [];\n}\n/**\nGet the active panel created by the given constructor, if any.\nThis can be useful when you need access to your panels' DOM\nstructure.\n*/\nfunction getPanel(view, panel) {\n    let plugin = view.plugin(panelPlugin);\n    let index = plugin ? plugin.specs.indexOf(panel) : -1;\n    return index > -1 ? plugin.panels[index] : null;\n}\nconst panelPlugin = /*@__PURE__*/ViewPlugin.fromClass(class {\n    constructor(view) {\n        this.input = view.state.facet(showPanel);\n        this.specs = this.input.filter(s => s);\n        this.panels = this.specs.map(spec => spec(view));\n        let conf = view.state.facet(panelConfig);\n        this.top = new PanelGroup(view, true, conf.topContainer);\n        this.bottom = new PanelGroup(view, false, conf.bottomContainer);\n        this.top.sync(this.panels.filter(p => p.top));\n        this.bottom.sync(this.panels.filter(p => !p.top));\n        for (let p of this.panels) {\n            p.dom.classList.add(\"cm-panel\");\n            if (p.mount)\n                p.mount();\n        }\n    }\n    update(update) {\n        let conf = update.state.facet(panelConfig);\n        if (this.top.container != conf.topContainer) {\n            this.top.sync([]);\n            this.top = new PanelGroup(update.view, true, conf.topContainer);\n        }\n        if (this.bottom.container != conf.bottomContainer) {\n            this.bottom.sync([]);\n            this.bottom = new PanelGroup(update.view, false, conf.bottomContainer);\n        }\n        this.top.syncClasses();\n        this.bottom.syncClasses();\n        let input = update.state.facet(showPanel);\n        if (input != this.input) {\n            let specs = input.filter(x => x);\n            let panels = [], top = [], bottom = [], mount = [];\n            for (let spec of specs) {\n                let known = this.specs.indexOf(spec), panel;\n                if (known < 0) {\n                    panel = spec(update.view);\n                    mount.push(panel);\n                }\n                else {\n                    panel = this.panels[known];\n                    if (panel.update)\n                        panel.update(update);\n                }\n                panels.push(panel);\n                (panel.top ? top : bottom).push(panel);\n            }\n            this.specs = specs;\n            this.panels = panels;\n            this.top.sync(top);\n            this.bottom.sync(bottom);\n            for (let p of mount) {\n                p.dom.classList.add(\"cm-panel\");\n                if (p.mount)\n                    p.mount();\n            }\n        }\n        else {\n            for (let p of this.panels)\n                if (p.update)\n                    p.update(update);\n        }\n    }\n    destroy() {\n        this.top.sync([]);\n        this.bottom.sync([]);\n    }\n}, {\n    provide: plugin => EditorView.scrollMargins.of(view => {\n        let value = view.plugin(plugin);\n        return value && { top: value.top.scrollMargin(), bottom: value.bottom.scrollMargin() };\n    })\n});\nclass PanelGroup {\n    constructor(view, top, container) {\n        this.view = view;\n        this.top = top;\n        this.container = container;\n        this.dom = undefined;\n        this.classes = \"\";\n        this.panels = [];\n        this.syncClasses();\n    }\n    sync(panels) {\n        for (let p of this.panels)\n            if (p.destroy && panels.indexOf(p) < 0)\n                p.destroy();\n        this.panels = panels;\n        this.syncDOM();\n    }\n    syncDOM() {\n        if (this.panels.length == 0) {\n            if (this.dom) {\n                this.dom.remove();\n                this.dom = undefined;\n            }\n            return;\n        }\n        if (!this.dom) {\n            this.dom = document.createElement(\"div\");\n            this.dom.className = this.top ? \"cm-panels cm-panels-top\" : \"cm-panels cm-panels-bottom\";\n            this.dom.style[this.top ? \"top\" : \"bottom\"] = \"0\";\n            let parent = this.container || this.view.dom;\n            parent.insertBefore(this.dom, this.top ? parent.firstChild : null);\n        }\n        let curDOM = this.dom.firstChild;\n        for (let panel of this.panels) {\n            if (panel.dom.parentNode == this.dom) {\n                while (curDOM != panel.dom)\n                    curDOM = rm(curDOM);\n                curDOM = curDOM.nextSibling;\n            }\n            else {\n                this.dom.insertBefore(panel.dom, curDOM);\n            }\n        }\n        while (curDOM)\n            curDOM = rm(curDOM);\n    }\n    scrollMargin() {\n        return !this.dom || this.container ? 0\n            : Math.max(0, this.top ?\n                this.dom.getBoundingClientRect().bottom - Math.max(0, this.view.scrollDOM.getBoundingClientRect().top) :\n                Math.min(innerHeight, this.view.scrollDOM.getBoundingClientRect().bottom) - this.dom.getBoundingClientRect().top);\n    }\n    syncClasses() {\n        if (!this.container || this.classes == this.view.themeClasses)\n            return;\n        for (let cls of this.classes.split(\" \"))\n            if (cls)\n                this.container.classList.remove(cls);\n        for (let cls of (this.classes = this.view.themeClasses).split(\" \"))\n            if (cls)\n                this.container.classList.add(cls);\n    }\n}\nfunction rm(node) {\n    let next = node.nextSibling;\n    node.remove();\n    return next;\n}\n/**\nOpening a panel is done by providing a constructor function for\nthe panel through this facet. (The panel is closed again when its\nconstructor is no longer provided.) Values of `null` are ignored.\n*/\nconst showPanel = /*@__PURE__*/Facet.define({\n    enables: panelPlugin\n});\n\n/**\nA gutter marker represents a bit of information attached to a line\nin a specific gutter. Your own custom markers have to extend this\nclass.\n*/\nclass GutterMarker extends RangeValue {\n    /**\n    @internal\n    */\n    compare(other) {\n        return this == other || this.constructor == other.constructor && this.eq(other);\n    }\n    /**\n    Compare this marker to another marker of the same type.\n    */\n    eq(other) { return false; }\n    /**\n    Called if the marker has a `toDOM` method and its representation\n    was removed from a gutter.\n    */\n    destroy(dom) { }\n}\nGutterMarker.prototype.elementClass = \"\";\nGutterMarker.prototype.toDOM = undefined;\nGutterMarker.prototype.mapMode = MapMode.TrackBefore;\nGutterMarker.prototype.startSide = GutterMarker.prototype.endSide = -1;\nGutterMarker.prototype.point = true;\n/**\nFacet used to add a class to all gutter elements for a given line.\nMarkers given to this facet should _only_ define an\n[`elementclass`](https://codemirror.net/6/docs/ref/#view.GutterMarker.elementClass), not a\n[`toDOM`](https://codemirror.net/6/docs/ref/#view.GutterMarker.toDOM) (or the marker will appear\nin all gutters for the line).\n*/\nconst gutterLineClass = /*@__PURE__*/Facet.define();\nconst defaults = {\n    class: \"\",\n    renderEmptyElements: false,\n    elementStyle: \"\",\n    markers: () => RangeSet.empty,\n    lineMarker: () => null,\n    lineMarkerChange: null,\n    initialSpacer: null,\n    updateSpacer: null,\n    domEventHandlers: {}\n};\nconst activeGutters = /*@__PURE__*/Facet.define();\n/**\nDefine an editor gutter. The order in which the gutters appear is\ndetermined by their extension priority.\n*/\nfunction gutter(config) {\n    return [gutters(), activeGutters.of(Object.assign(Object.assign({}, defaults), config))];\n}\nconst unfixGutters = /*@__PURE__*/Facet.define({\n    combine: values => values.some(x => x)\n});\n/**\nThe gutter-drawing plugin is automatically enabled when you add a\ngutter, but you can use this function to explicitly configure it.\n\nUnless `fixed` is explicitly set to `false`, the gutters are\nfixed, meaning they don't scroll along with the content\nhorizontally (except on Internet Explorer, which doesn't support\nCSS [`position:\nsticky`](https://developer.mozilla.org/en-US/docs/Web/CSS/position#sticky)).\n*/\nfunction gutters(config) {\n    let result = [\n        gutterView,\n    ];\n    if (config && config.fixed === false)\n        result.push(unfixGutters.of(true));\n    return result;\n}\nconst gutterView = /*@__PURE__*/ViewPlugin.fromClass(class {\n    constructor(view) {\n        this.view = view;\n        this.prevViewport = view.viewport;\n        this.dom = document.createElement(\"div\");\n        this.dom.className = \"cm-gutters\";\n        this.dom.setAttribute(\"aria-hidden\", \"true\");\n        this.dom.style.minHeight = this.view.contentHeight + \"px\";\n        this.gutters = view.state.facet(activeGutters).map(conf => new SingleGutterView(view, conf));\n        for (let gutter of this.gutters)\n            this.dom.appendChild(gutter.dom);\n        this.fixed = !view.state.facet(unfixGutters);\n        if (this.fixed) {\n            // FIXME IE11 fallback, which doesn't support position: sticky,\n            // by using position: relative + event handlers that realign the\n            // gutter (or just force fixed=false on IE11?)\n            this.dom.style.position = \"sticky\";\n        }\n        this.syncGutters(false);\n        view.scrollDOM.insertBefore(this.dom, view.contentDOM);\n    }\n    update(update) {\n        if (this.updateGutters(update)) {\n            // Detach during sync when the viewport changed significantly\n            // (such as during scrolling), since for large updates that is\n            // faster.\n            let vpA = this.prevViewport, vpB = update.view.viewport;\n            let vpOverlap = Math.min(vpA.to, vpB.to) - Math.max(vpA.from, vpB.from);\n            this.syncGutters(vpOverlap < (vpB.to - vpB.from) * 0.8);\n        }\n        if (update.geometryChanged)\n            this.dom.style.minHeight = this.view.contentHeight + \"px\";\n        if (this.view.state.facet(unfixGutters) != !this.fixed) {\n            this.fixed = !this.fixed;\n            this.dom.style.position = this.fixed ? \"sticky\" : \"\";\n        }\n        this.prevViewport = update.view.viewport;\n    }\n    syncGutters(detach) {\n        let after = this.dom.nextSibling;\n        if (detach)\n            this.dom.remove();\n        let lineClasses = RangeSet.iter(this.view.state.facet(gutterLineClass), this.view.viewport.from);\n        let classSet = [];\n        let contexts = this.gutters.map(gutter => new UpdateContext(gutter, this.view.viewport, -this.view.documentPadding.top));\n        for (let line of this.view.viewportLineBlocks) {\n            let text;\n            if (Array.isArray(line.type)) {\n                for (let b of line.type)\n                    if (b.type == BlockType.Text) {\n                        text = b;\n                        break;\n                    }\n            }\n            else {\n                text = line.type == BlockType.Text ? line : undefined;\n            }\n            if (!text)\n                continue;\n            if (classSet.length)\n                classSet = [];\n            advanceCursor(lineClasses, classSet, line.from);\n            for (let cx of contexts)\n                cx.line(this.view, text, classSet);\n        }\n        for (let cx of contexts)\n            cx.finish();\n        if (detach)\n            this.view.scrollDOM.insertBefore(this.dom, after);\n    }\n    updateGutters(update) {\n        let prev = update.startState.facet(activeGutters), cur = update.state.facet(activeGutters);\n        let change = update.docChanged || update.heightChanged || update.viewportChanged ||\n            !RangeSet.eq(update.startState.facet(gutterLineClass), update.state.facet(gutterLineClass), update.view.viewport.from, update.view.viewport.to);\n        if (prev == cur) {\n            for (let gutter of this.gutters)\n                if (gutter.update(update))\n                    change = true;\n        }\n        else {\n            change = true;\n            let gutters = [];\n            for (let conf of cur) {\n                let known = prev.indexOf(conf);\n                if (known < 0) {\n                    gutters.push(new SingleGutterView(this.view, conf));\n                }\n                else {\n                    this.gutters[known].update(update);\n                    gutters.push(this.gutters[known]);\n                }\n            }\n            for (let g of this.gutters) {\n                g.dom.remove();\n                if (gutters.indexOf(g) < 0)\n                    g.destroy();\n            }\n            for (let g of gutters)\n                this.dom.appendChild(g.dom);\n            this.gutters = gutters;\n        }\n        return change;\n    }\n    destroy() {\n        for (let view of this.gutters)\n            view.destroy();\n        this.dom.remove();\n    }\n}, {\n    provide: plugin => EditorView.scrollMargins.of(view => {\n        let value = view.plugin(plugin);\n        if (!value || value.gutters.length == 0 || !value.fixed)\n            return null;\n        return view.textDirection == Direction.LTR ? { left: value.dom.offsetWidth } : { right: value.dom.offsetWidth };\n    })\n});\nfunction asArray(val) { return (Array.isArray(val) ? val : [val]); }\nfunction advanceCursor(cursor, collect, pos) {\n    while (cursor.value && cursor.from <= pos) {\n        if (cursor.from == pos)\n            collect.push(cursor.value);\n        cursor.next();\n    }\n}\nclass UpdateContext {\n    constructor(gutter, viewport, height) {\n        this.gutter = gutter;\n        this.height = height;\n        this.i = 0;\n        this.cursor = RangeSet.iter(gutter.markers, viewport.from);\n    }\n    line(view, line, extraMarkers) {\n        let localMarkers = [];\n        advanceCursor(this.cursor, localMarkers, line.from);\n        if (extraMarkers.length)\n            localMarkers = localMarkers.concat(extraMarkers);\n        let forLine = this.gutter.config.lineMarker(view, line, localMarkers);\n        if (forLine)\n            localMarkers.unshift(forLine);\n        let gutter = this.gutter;\n        if (localMarkers.length == 0 && !gutter.config.renderEmptyElements)\n            return;\n        let above = line.top - this.height;\n        if (this.i == gutter.elements.length) {\n            let newElt = new GutterElement(view, line.height, above, localMarkers);\n            gutter.elements.push(newElt);\n            gutter.dom.appendChild(newElt.dom);\n        }\n        else {\n            gutter.elements[this.i].update(view, line.height, above, localMarkers);\n        }\n        this.height = line.bottom;\n        this.i++;\n    }\n    finish() {\n        let gutter = this.gutter;\n        while (gutter.elements.length > this.i) {\n            let last = gutter.elements.pop();\n            gutter.dom.removeChild(last.dom);\n            last.destroy();\n        }\n    }\n}\nclass SingleGutterView {\n    constructor(view, config) {\n        this.view = view;\n        this.config = config;\n        this.elements = [];\n        this.spacer = null;\n        this.dom = document.createElement(\"div\");\n        this.dom.className = \"cm-gutter\" + (this.config.class ? \" \" + this.config.class : \"\");\n        for (let prop in config.domEventHandlers) {\n            this.dom.addEventListener(prop, (event) => {\n                let target = event.target, y;\n                if (target != this.dom && this.dom.contains(target)) {\n                    while (target.parentNode != this.dom)\n                        target = target.parentNode;\n                    let rect = target.getBoundingClientRect();\n                    y = (rect.top + rect.bottom) / 2;\n                }\n                else {\n                    y = event.clientY;\n                }\n                let line = view.lineBlockAtHeight(y - view.documentTop);\n                if (config.domEventHandlers[prop](view, line, event))\n                    event.preventDefault();\n            });\n        }\n        this.markers = asArray(config.markers(view));\n        if (config.initialSpacer) {\n            this.spacer = new GutterElement(view, 0, 0, [config.initialSpacer(view)]);\n            this.dom.appendChild(this.spacer.dom);\n            this.spacer.dom.style.cssText += \"visibility: hidden; pointer-events: none\";\n        }\n    }\n    update(update) {\n        let prevMarkers = this.markers;\n        this.markers = asArray(this.config.markers(update.view));\n        if (this.spacer && this.config.updateSpacer) {\n            let updated = this.config.updateSpacer(this.spacer.markers[0], update);\n            if (updated != this.spacer.markers[0])\n                this.spacer.update(update.view, 0, 0, [updated]);\n        }\n        let vp = update.view.viewport;\n        return !RangeSet.eq(this.markers, prevMarkers, vp.from, vp.to) ||\n            (this.config.lineMarkerChange ? this.config.lineMarkerChange(update) : false);\n    }\n    destroy() {\n        for (let elt of this.elements)\n            elt.destroy();\n    }\n}\nclass GutterElement {\n    constructor(view, height, above, markers) {\n        this.height = -1;\n        this.above = 0;\n        this.markers = [];\n        this.dom = document.createElement(\"div\");\n        this.dom.className = \"cm-gutterElement\";\n        this.update(view, height, above, markers);\n    }\n    update(view, height, above, markers) {\n        if (this.height != height)\n            this.dom.style.height = (this.height = height) + \"px\";\n        if (this.above != above)\n            this.dom.style.marginTop = (this.above = above) ? above + \"px\" : \"\";\n        if (!sameMarkers(this.markers, markers))\n            this.setMarkers(view, markers);\n    }\n    setMarkers(view, markers) {\n        let cls = \"cm-gutterElement\", domPos = this.dom.firstChild;\n        for (let iNew = 0, iOld = 0;;) {\n            let skipTo = iOld, marker = iNew < markers.length ? markers[iNew++] : null, matched = false;\n            if (marker) {\n                let c = marker.elementClass;\n                if (c)\n                    cls += \" \" + c;\n                for (let i = iOld; i < this.markers.length; i++)\n                    if (this.markers[i].compare(marker)) {\n                        skipTo = i;\n                        matched = true;\n                        break;\n                    }\n            }\n            else {\n                skipTo = this.markers.length;\n            }\n            while (iOld < skipTo) {\n                let next = this.markers[iOld++];\n                if (next.toDOM) {\n                    next.destroy(domPos);\n                    let after = domPos.nextSibling;\n                    domPos.remove();\n                    domPos = after;\n                }\n            }\n            if (!marker)\n                break;\n            if (marker.toDOM) {\n                if (matched)\n                    domPos = domPos.nextSibling;\n                else\n                    this.dom.insertBefore(marker.toDOM(view), domPos);\n            }\n            if (matched)\n                iOld++;\n        }\n        this.dom.className = cls;\n        this.markers = markers;\n    }\n    destroy() {\n        this.setMarkers(null, []); // First argument not used unless creating markers\n    }\n}\nfunction sameMarkers(a, b) {\n    if (a.length != b.length)\n        return false;\n    for (let i = 0; i < a.length; i++)\n        if (!a[i].compare(b[i]))\n            return false;\n    return true;\n}\n/**\nFacet used to provide markers to the line number gutter.\n*/\nconst lineNumberMarkers = /*@__PURE__*/Facet.define();\nconst lineNumberConfig = /*@__PURE__*/Facet.define({\n    combine(values) {\n        return combineConfig(values, { formatNumber: String, domEventHandlers: {} }, {\n            domEventHandlers(a, b) {\n                let result = Object.assign({}, a);\n                for (let event in b) {\n                    let exists = result[event], add = b[event];\n                    result[event] = exists ? (view, line, event) => exists(view, line, event) || add(view, line, event) : add;\n                }\n                return result;\n            }\n        });\n    }\n});\nclass NumberMarker extends GutterMarker {\n    constructor(number) {\n        super();\n        this.number = number;\n    }\n    eq(other) { return this.number == other.number; }\n    toDOM() { return document.createTextNode(this.number); }\n}\nfunction formatNumber(view, number) {\n    return view.state.facet(lineNumberConfig).formatNumber(number, view.state);\n}\nconst lineNumberGutter = /*@__PURE__*/activeGutters.compute([lineNumberConfig], state => ({\n    class: \"cm-lineNumbers\",\n    renderEmptyElements: false,\n    markers(view) { return view.state.facet(lineNumberMarkers); },\n    lineMarker(view, line, others) {\n        if (others.some(m => m.toDOM))\n            return null;\n        return new NumberMarker(formatNumber(view, view.state.doc.lineAt(line.from).number));\n    },\n    lineMarkerChange: update => update.startState.facet(lineNumberConfig) != update.state.facet(lineNumberConfig),\n    initialSpacer(view) {\n        return new NumberMarker(formatNumber(view, maxLineNumber(view.state.doc.lines)));\n    },\n    updateSpacer(spacer, update) {\n        let max = formatNumber(update.view, maxLineNumber(update.view.state.doc.lines));\n        return max == spacer.number ? spacer : new NumberMarker(max);\n    },\n    domEventHandlers: state.facet(lineNumberConfig).domEventHandlers\n}));\n/**\nCreate a line number gutter extension.\n*/\nfunction lineNumbers(config = {}) {\n    return [\n        lineNumberConfig.of(config),\n        gutters(),\n        lineNumberGutter\n    ];\n}\nfunction maxLineNumber(lines) {\n    let last = 9;\n    while (last < lines)\n        last = last * 10 + 9;\n    return last;\n}\nconst activeLineGutterMarker = /*@__PURE__*/new class extends GutterMarker {\n    constructor() {\n        super(...arguments);\n        this.elementClass = \"cm-activeLineGutter\";\n    }\n};\nconst activeLineGutterHighlighter = /*@__PURE__*/gutterLineClass.compute([\"selection\"], state => {\n    let marks = [], last = -1;\n    for (let range of state.selection.ranges) {\n        let linePos = state.doc.lineAt(range.head).from;\n        if (linePos > last) {\n            last = linePos;\n            marks.push(activeLineGutterMarker.range(linePos));\n        }\n    }\n    return RangeSet.of(marks);\n});\n/**\nReturns an extension that adds a `cm-activeLineGutter` class to\nall gutter elements on the [active\nline](https://codemirror.net/6/docs/ref/#view.highlightActiveLine).\n*/\nfunction highlightActiveLineGutter() {\n    return activeLineGutterHighlighter;\n}\n\nconst WhitespaceDeco = /*@__PURE__*/new Map();\nfunction getWhitespaceDeco(space) {\n    let deco = WhitespaceDeco.get(space);\n    if (!deco)\n        WhitespaceDeco.set(space, deco = Decoration.mark({\n            attributes: space === \"\\t\" ? {\n                class: \"cm-highlightTab\",\n            } : {\n                class: \"cm-highlightSpace\",\n                \"data-display\": space.replace(/ /g, \"·\")\n            }\n        }));\n    return deco;\n}\nfunction matcher(decorator) {\n    return ViewPlugin.define(view => ({\n        decorations: decorator.createDeco(view),\n        update(u) {\n            this.decorations = decorator.updateDeco(u, this.decorations);\n        },\n    }), {\n        decorations: v => v.decorations\n    });\n}\nconst whitespaceHighlighter = /*@__PURE__*/matcher(/*@__PURE__*/new MatchDecorator({\n    regexp: /\\t| +/g,\n    decoration: match => getWhitespaceDeco(match[0]),\n    boundary: /\\S/,\n}));\n/**\nReturns an extension that highlights whitespace, adding a\n`cm-highlightSpace` class to stretches of spaces, and a\n`cm-highlightTab` class to individual tab characters. By default,\nthe former are shown as faint dots, and the latter as arrows.\n*/\nfunction highlightWhitespace() {\n    return whitespaceHighlighter;\n}\nconst trailingHighlighter = /*@__PURE__*/matcher(/*@__PURE__*/new MatchDecorator({\n    regexp: /\\s+$/g,\n    decoration: /*@__PURE__*/Decoration.mark({ class: \"cm-trailingSpace\" }),\n    boundary: /\\S/,\n}));\n/**\nReturns an extension that adds a `cm-trailingSpace` class to all\ntrailing whitespace.\n*/\nfunction highlightTrailingWhitespace() {\n    return trailingHighlighter;\n}\n\n/**\n@internal\n*/\nconst __test = { HeightMap, HeightOracle, MeasuredHeights, QueryType, ChangedRange, computeOrder, moveVisually };\n\nexport { BidiSpan, BlockInfo, BlockType, Decoration, Direction, EditorView, GutterMarker, MatchDecorator, RectangleMarker, ViewPlugin, ViewUpdate, WidgetType, __test, closeHoverTooltips, crosshairCursor, drawSelection, dropCursor, getPanel, getTooltip, gutter, gutterLineClass, gutters, hasHoverTooltips, highlightActiveLine, highlightActiveLineGutter, highlightSpecialChars, highlightTrailingWhitespace, highlightWhitespace, hoverTooltip, keymap, layer, lineNumberMarkers, lineNumbers, logException, panels, placeholder, rectangularSelection, repositionTooltips, runScopeHandlers, scrollPastEnd, showPanel, showTooltip, tooltips };\n","// FIXME profile adding a per-Tree TreeNode cache, validating it by\n// parent pointer\n/// The default maximum length of a `TreeBuffer` node.\nconst DefaultBufferLength = 1024;\nlet nextPropID = 0;\nclass Range {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n    }\n}\n/// Each [node type](#common.NodeType) or [individual tree](#common.Tree)\n/// can have metadata associated with it in props. Instances of this\n/// class represent prop names.\nclass NodeProp {\n    /// Create a new node prop type.\n    constructor(config = {}) {\n        this.id = nextPropID++;\n        this.perNode = !!config.perNode;\n        this.deserialize = config.deserialize || (() => {\n            throw new Error(\"This node type doesn't define a deserialize function\");\n        });\n    }\n    /// This is meant to be used with\n    /// [`NodeSet.extend`](#common.NodeSet.extend) or\n    /// [`LRParser.configure`](#lr.ParserConfig.props) to compute\n    /// prop values for each node type in the set. Takes a [match\n    /// object](#common.NodeType^match) or function that returns undefined\n    /// if the node type doesn't get this prop, and the prop's value if\n    /// it does.\n    add(match) {\n        if (this.perNode)\n            throw new RangeError(\"Can't add per-node props to node types\");\n        if (typeof match != \"function\")\n            match = NodeType.match(match);\n        return (type) => {\n            let result = match(type);\n            return result === undefined ? null : [this, result];\n        };\n    }\n}\n/// Prop that is used to describe matching delimiters. For opening\n/// delimiters, this holds an array of node names (written as a\n/// space-separated string when declaring this prop in a grammar)\n/// for the node types of closing delimiters that match it.\nNodeProp.closedBy = new NodeProp({ deserialize: str => str.split(\" \") });\n/// The inverse of [`closedBy`](#common.NodeProp^closedBy). This is\n/// attached to closing delimiters, holding an array of node names\n/// of types of matching opening delimiters.\nNodeProp.openedBy = new NodeProp({ deserialize: str => str.split(\" \") });\n/// Used to assign node types to groups (for example, all node\n/// types that represent an expression could be tagged with an\n/// `\"Expression\"` group).\nNodeProp.group = new NodeProp({ deserialize: str => str.split(\" \") });\n/// The hash of the [context](#lr.ContextTracker.constructor)\n/// that the node was parsed in, if any. Used to limit reuse of\n/// contextual nodes.\nNodeProp.contextHash = new NodeProp({ perNode: true });\n/// The distance beyond the end of the node that the tokenizer\n/// looked ahead for any of the tokens inside the node. (The LR\n/// parser only stores this when it is larger than 25, for\n/// efficiency reasons.)\nNodeProp.lookAhead = new NodeProp({ perNode: true });\n/// This per-node prop is used to replace a given node, or part of a\n/// node, with another tree. This is useful to include trees from\n/// different languages in mixed-language parsers.\nNodeProp.mounted = new NodeProp({ perNode: true });\n/// A mounted tree, which can be [stored](#common.NodeProp^mounted) on\n/// a tree node to indicate that parts of its content are\n/// represented by another tree.\nclass MountedTree {\n    constructor(\n    /// The inner tree.\n    tree, \n    /// If this is null, this tree replaces the entire node (it will\n    /// be included in the regular iteration instead of its host\n    /// node). If not, only the given ranges are considered to be\n    /// covered by this tree. This is used for trees that are mixed in\n    /// a way that isn't strictly hierarchical. Such mounted trees are\n    /// only entered by [`resolveInner`](#common.Tree.resolveInner)\n    /// and [`enter`](#common.SyntaxNode.enter).\n    overlay, \n    /// The parser used to create this subtree.\n    parser) {\n        this.tree = tree;\n        this.overlay = overlay;\n        this.parser = parser;\n    }\n}\nconst noProps = Object.create(null);\n/// Each node in a syntax tree has a node type associated with it.\nclass NodeType {\n    /// @internal\n    constructor(\n    /// The name of the node type. Not necessarily unique, but if the\n    /// grammar was written properly, different node types with the\n    /// same name within a node set should play the same semantic\n    /// role.\n    name, \n    /// @internal\n    props, \n    /// The id of this node in its set. Corresponds to the term ids\n    /// used in the parser.\n    id, \n    /// @internal\n    flags = 0) {\n        this.name = name;\n        this.props = props;\n        this.id = id;\n        this.flags = flags;\n    }\n    /// Define a node type.\n    static define(spec) {\n        let props = spec.props && spec.props.length ? Object.create(null) : noProps;\n        let flags = (spec.top ? 1 /* NodeFlag.Top */ : 0) | (spec.skipped ? 2 /* NodeFlag.Skipped */ : 0) |\n            (spec.error ? 4 /* NodeFlag.Error */ : 0) | (spec.name == null ? 8 /* NodeFlag.Anonymous */ : 0);\n        let type = new NodeType(spec.name || \"\", props, spec.id, flags);\n        if (spec.props)\n            for (let src of spec.props) {\n                if (!Array.isArray(src))\n                    src = src(type);\n                if (src) {\n                    if (src[0].perNode)\n                        throw new RangeError(\"Can't store a per-node prop on a node type\");\n                    props[src[0].id] = src[1];\n                }\n            }\n        return type;\n    }\n    /// Retrieves a node prop for this type. Will return `undefined` if\n    /// the prop isn't present on this node.\n    prop(prop) { return this.props[prop.id]; }\n    /// True when this is the top node of a grammar.\n    get isTop() { return (this.flags & 1 /* NodeFlag.Top */) > 0; }\n    /// True when this node is produced by a skip rule.\n    get isSkipped() { return (this.flags & 2 /* NodeFlag.Skipped */) > 0; }\n    /// Indicates whether this is an error node.\n    get isError() { return (this.flags & 4 /* NodeFlag.Error */) > 0; }\n    /// When true, this node type doesn't correspond to a user-declared\n    /// named node, for example because it is used to cache repetition.\n    get isAnonymous() { return (this.flags & 8 /* NodeFlag.Anonymous */) > 0; }\n    /// Returns true when this node's name or one of its\n    /// [groups](#common.NodeProp^group) matches the given string.\n    is(name) {\n        if (typeof name == 'string') {\n            if (this.name == name)\n                return true;\n            let group = this.prop(NodeProp.group);\n            return group ? group.indexOf(name) > -1 : false;\n        }\n        return this.id == name;\n    }\n    /// Create a function from node types to arbitrary values by\n    /// specifying an object whose property names are node or\n    /// [group](#common.NodeProp^group) names. Often useful with\n    /// [`NodeProp.add`](#common.NodeProp.add). You can put multiple\n    /// names, separated by spaces, in a single property name to map\n    /// multiple node names to a single value.\n    static match(map) {\n        let direct = Object.create(null);\n        for (let prop in map)\n            for (let name of prop.split(\" \"))\n                direct[name] = map[prop];\n        return (node) => {\n            for (let groups = node.prop(NodeProp.group), i = -1; i < (groups ? groups.length : 0); i++) {\n                let found = direct[i < 0 ? node.name : groups[i]];\n                if (found)\n                    return found;\n            }\n        };\n    }\n}\n/// An empty dummy node type to use when no actual type is available.\nNodeType.none = new NodeType(\"\", Object.create(null), 0, 8 /* NodeFlag.Anonymous */);\n/// A node set holds a collection of node types. It is used to\n/// compactly represent trees by storing their type ids, rather than a\n/// full pointer to the type object, in a numeric array. Each parser\n/// [has](#lr.LRParser.nodeSet) a node set, and [tree\n/// buffers](#common.TreeBuffer) can only store collections of nodes\n/// from the same set. A set can have a maximum of 2**16 (65536) node\n/// types in it, so that the ids fit into 16-bit typed array slots.\nclass NodeSet {\n    /// Create a set with the given types. The `id` property of each\n    /// type should correspond to its position within the array.\n    constructor(\n    /// The node types in this set, by id.\n    types) {\n        this.types = types;\n        for (let i = 0; i < types.length; i++)\n            if (types[i].id != i)\n                throw new RangeError(\"Node type ids should correspond to array positions when creating a node set\");\n    }\n    /// Create a copy of this set with some node properties added. The\n    /// arguments to this method can be created with\n    /// [`NodeProp.add`](#common.NodeProp.add).\n    extend(...props) {\n        let newTypes = [];\n        for (let type of this.types) {\n            let newProps = null;\n            for (let source of props) {\n                let add = source(type);\n                if (add) {\n                    if (!newProps)\n                        newProps = Object.assign({}, type.props);\n                    newProps[add[0].id] = add[1];\n                }\n            }\n            newTypes.push(newProps ? new NodeType(type.name, newProps, type.id, type.flags) : type);\n        }\n        return new NodeSet(newTypes);\n    }\n}\nconst CachedNode = new WeakMap(), CachedInnerNode = new WeakMap();\n/// Options that control iteration. Can be combined with the `|`\n/// operator to enable multiple ones.\nvar IterMode;\n(function (IterMode) {\n    /// When enabled, iteration will only visit [`Tree`](#common.Tree)\n    /// objects, not nodes packed into\n    /// [`TreeBuffer`](#common.TreeBuffer)s.\n    IterMode[IterMode[\"ExcludeBuffers\"] = 1] = \"ExcludeBuffers\";\n    /// Enable this to make iteration include anonymous nodes (such as\n    /// the nodes that wrap repeated grammar constructs into a balanced\n    /// tree).\n    IterMode[IterMode[\"IncludeAnonymous\"] = 2] = \"IncludeAnonymous\";\n    /// By default, regular [mounted](#common.NodeProp^mounted) nodes\n    /// replace their base node in iteration. Enable this to ignore them\n    /// instead.\n    IterMode[IterMode[\"IgnoreMounts\"] = 4] = \"IgnoreMounts\";\n    /// This option only applies in\n    /// [`enter`](#common.SyntaxNode.enter)-style methods. It tells the\n    /// library to not enter mounted overlays if one covers the given\n    /// position.\n    IterMode[IterMode[\"IgnoreOverlays\"] = 8] = \"IgnoreOverlays\";\n})(IterMode || (IterMode = {}));\n/// A piece of syntax tree. There are two ways to approach these\n/// trees: the way they are actually stored in memory, and the\n/// convenient way.\n///\n/// Syntax trees are stored as a tree of `Tree` and `TreeBuffer`\n/// objects. By packing detail information into `TreeBuffer` leaf\n/// nodes, the representation is made a lot more memory-efficient.\n///\n/// However, when you want to actually work with tree nodes, this\n/// representation is very awkward, so most client code will want to\n/// use the [`TreeCursor`](#common.TreeCursor) or\n/// [`SyntaxNode`](#common.SyntaxNode) interface instead, which provides\n/// a view on some part of this data structure, and can be used to\n/// move around to adjacent nodes.\nclass Tree {\n    /// Construct a new tree. See also [`Tree.build`](#common.Tree^build).\n    constructor(\n    /// The type of the top node.\n    type, \n    /// This node's child nodes.\n    children, \n    /// The positions (offsets relative to the start of this tree) of\n    /// the children.\n    positions, \n    /// The total length of this tree\n    length, \n    /// Per-node [node props](#common.NodeProp) to associate with this node.\n    props) {\n        this.type = type;\n        this.children = children;\n        this.positions = positions;\n        this.length = length;\n        /// @internal\n        this.props = null;\n        if (props && props.length) {\n            this.props = Object.create(null);\n            for (let [prop, value] of props)\n                this.props[typeof prop == \"number\" ? prop : prop.id] = value;\n        }\n    }\n    /// @internal\n    toString() {\n        let mounted = this.prop(NodeProp.mounted);\n        if (mounted && !mounted.overlay)\n            return mounted.tree.toString();\n        let children = \"\";\n        for (let ch of this.children) {\n            let str = ch.toString();\n            if (str) {\n                if (children)\n                    children += \",\";\n                children += str;\n            }\n        }\n        return !this.type.name ? children :\n            (/\\W/.test(this.type.name) && !this.type.isError ? JSON.stringify(this.type.name) : this.type.name) +\n                (children.length ? \"(\" + children + \")\" : \"\");\n    }\n    /// Get a [tree cursor](#common.TreeCursor) positioned at the top of\n    /// the tree. Mode can be used to [control](#common.IterMode) which\n    /// nodes the cursor visits.\n    cursor(mode = 0) {\n        return new TreeCursor(this.topNode, mode);\n    }\n    /// Get a [tree cursor](#common.TreeCursor) pointing into this tree\n    /// at the given position and side (see\n    /// [`moveTo`](#common.TreeCursor.moveTo).\n    cursorAt(pos, side = 0, mode = 0) {\n        let scope = CachedNode.get(this) || this.topNode;\n        let cursor = new TreeCursor(scope);\n        cursor.moveTo(pos, side);\n        CachedNode.set(this, cursor._tree);\n        return cursor;\n    }\n    /// Get a [syntax node](#common.SyntaxNode) object for the top of the\n    /// tree.\n    get topNode() {\n        return new TreeNode(this, 0, 0, null);\n    }\n    /// Get the [syntax node](#common.SyntaxNode) at the given position.\n    /// If `side` is -1, this will move into nodes that end at the\n    /// position. If 1, it'll move into nodes that start at the\n    /// position. With 0, it'll only enter nodes that cover the position\n    /// from both sides.\n    ///\n    /// Note that this will not enter\n    /// [overlays](#common.MountedTree.overlay), and you often want\n    /// [`resolveInner`](#common.Tree.resolveInner) instead.\n    resolve(pos, side = 0) {\n        let node = resolveNode(CachedNode.get(this) || this.topNode, pos, side, false);\n        CachedNode.set(this, node);\n        return node;\n    }\n    /// Like [`resolve`](#common.Tree.resolve), but will enter\n    /// [overlaid](#common.MountedTree.overlay) nodes, producing a syntax node\n    /// pointing into the innermost overlaid tree at the given position\n    /// (with parent links going through all parent structure, including\n    /// the host trees).\n    resolveInner(pos, side = 0) {\n        let node = resolveNode(CachedInnerNode.get(this) || this.topNode, pos, side, true);\n        CachedInnerNode.set(this, node);\n        return node;\n    }\n    /// Iterate over the tree and its children, calling `enter` for any\n    /// node that touches the `from`/`to` region (if given) before\n    /// running over such a node's children, and `leave` (if given) when\n    /// leaving the node. When `enter` returns `false`, that node will\n    /// not have its children iterated over (or `leave` called).\n    iterate(spec) {\n        let { enter, leave, from = 0, to = this.length } = spec;\n        for (let c = this.cursor((spec.mode || 0) | IterMode.IncludeAnonymous);;) {\n            let entered = false;\n            if (c.from <= to && c.to >= from && (c.type.isAnonymous || enter(c) !== false)) {\n                if (c.firstChild())\n                    continue;\n                entered = true;\n            }\n            for (;;) {\n                if (entered && leave && !c.type.isAnonymous)\n                    leave(c);\n                if (c.nextSibling())\n                    break;\n                if (!c.parent())\n                    return;\n                entered = true;\n            }\n        }\n    }\n    /// Get the value of the given [node prop](#common.NodeProp) for this\n    /// node. Works with both per-node and per-type props.\n    prop(prop) {\n        return !prop.perNode ? this.type.prop(prop) : this.props ? this.props[prop.id] : undefined;\n    }\n    /// Returns the node's [per-node props](#common.NodeProp.perNode) in a\n    /// format that can be passed to the [`Tree`](#common.Tree)\n    /// constructor.\n    get propValues() {\n        let result = [];\n        if (this.props)\n            for (let id in this.props)\n                result.push([+id, this.props[id]]);\n        return result;\n    }\n    /// Balance the direct children of this tree, producing a copy of\n    /// which may have children grouped into subtrees with type\n    /// [`NodeType.none`](#common.NodeType^none).\n    balance(config = {}) {\n        return this.children.length <= 8 /* Balance.BranchFactor */ ? this :\n            balanceRange(NodeType.none, this.children, this.positions, 0, this.children.length, 0, this.length, (children, positions, length) => new Tree(this.type, children, positions, length, this.propValues), config.makeTree || ((children, positions, length) => new Tree(NodeType.none, children, positions, length)));\n    }\n    /// Build a tree from a postfix-ordered buffer of node information,\n    /// or a cursor over such a buffer.\n    static build(data) { return buildTree(data); }\n}\n/// The empty tree\nTree.empty = new Tree(NodeType.none, [], [], 0);\nclass FlatBufferCursor {\n    constructor(buffer, index) {\n        this.buffer = buffer;\n        this.index = index;\n    }\n    get id() { return this.buffer[this.index - 4]; }\n    get start() { return this.buffer[this.index - 3]; }\n    get end() { return this.buffer[this.index - 2]; }\n    get size() { return this.buffer[this.index - 1]; }\n    get pos() { return this.index; }\n    next() { this.index -= 4; }\n    fork() { return new FlatBufferCursor(this.buffer, this.index); }\n}\n/// Tree buffers contain (type, start, end, endIndex) quads for each\n/// node. In such a buffer, nodes are stored in prefix order (parents\n/// before children, with the endIndex of the parent indicating which\n/// children belong to it).\nclass TreeBuffer {\n    /// Create a tree buffer.\n    constructor(\n    /// The buffer's content.\n    buffer, \n    /// The total length of the group of nodes in the buffer.\n    length, \n    /// The node set used in this buffer.\n    set) {\n        this.buffer = buffer;\n        this.length = length;\n        this.set = set;\n    }\n    /// @internal\n    get type() { return NodeType.none; }\n    /// @internal\n    toString() {\n        let result = [];\n        for (let index = 0; index < this.buffer.length;) {\n            result.push(this.childString(index));\n            index = this.buffer[index + 3];\n        }\n        return result.join(\",\");\n    }\n    /// @internal\n    childString(index) {\n        let id = this.buffer[index], endIndex = this.buffer[index + 3];\n        let type = this.set.types[id], result = type.name;\n        if (/\\W/.test(result) && !type.isError)\n            result = JSON.stringify(result);\n        index += 4;\n        if (endIndex == index)\n            return result;\n        let children = [];\n        while (index < endIndex) {\n            children.push(this.childString(index));\n            index = this.buffer[index + 3];\n        }\n        return result + \"(\" + children.join(\",\") + \")\";\n    }\n    /// @internal\n    findChild(startIndex, endIndex, dir, pos, side) {\n        let { buffer } = this, pick = -1;\n        for (let i = startIndex; i != endIndex; i = buffer[i + 3]) {\n            if (checkSide(side, pos, buffer[i + 1], buffer[i + 2])) {\n                pick = i;\n                if (dir > 0)\n                    break;\n            }\n        }\n        return pick;\n    }\n    /// @internal\n    slice(startI, endI, from) {\n        let b = this.buffer;\n        let copy = new Uint16Array(endI - startI), len = 0;\n        for (let i = startI, j = 0; i < endI;) {\n            copy[j++] = b[i++];\n            copy[j++] = b[i++] - from;\n            let to = copy[j++] = b[i++] - from;\n            copy[j++] = b[i++] - startI;\n            len = Math.max(len, to);\n        }\n        return new TreeBuffer(copy, len, this.set);\n    }\n}\nfunction checkSide(side, pos, from, to) {\n    switch (side) {\n        case -2 /* Side.Before */: return from < pos;\n        case -1 /* Side.AtOrBefore */: return to >= pos && from < pos;\n        case 0 /* Side.Around */: return from < pos && to > pos;\n        case 1 /* Side.AtOrAfter */: return from <= pos && to > pos;\n        case 2 /* Side.After */: return to > pos;\n        case 4 /* Side.DontCare */: return true;\n    }\n}\nfunction enterUnfinishedNodesBefore(node, pos) {\n    let scan = node.childBefore(pos);\n    while (scan) {\n        let last = scan.lastChild;\n        if (!last || last.to != scan.to)\n            break;\n        if (last.type.isError && last.from == last.to) {\n            node = scan;\n            scan = last.prevSibling;\n        }\n        else {\n            scan = last;\n        }\n    }\n    return node;\n}\nfunction resolveNode(node, pos, side, overlays) {\n    var _a;\n    // Move up to a node that actually holds the position, if possible\n    while (node.from == node.to ||\n        (side < 1 ? node.from >= pos : node.from > pos) ||\n        (side > -1 ? node.to <= pos : node.to < pos)) {\n        let parent = !overlays && node instanceof TreeNode && node.index < 0 ? null : node.parent;\n        if (!parent)\n            return node;\n        node = parent;\n    }\n    let mode = overlays ? 0 : IterMode.IgnoreOverlays;\n    // Must go up out of overlays when those do not overlap with pos\n    if (overlays)\n        for (let scan = node, parent = scan.parent; parent; scan = parent, parent = scan.parent) {\n            if (scan instanceof TreeNode && scan.index < 0 && ((_a = parent.enter(pos, side, mode)) === null || _a === void 0 ? void 0 : _a.from) != scan.from)\n                node = parent;\n        }\n    for (;;) {\n        let inner = node.enter(pos, side, mode);\n        if (!inner)\n            return node;\n        node = inner;\n    }\n}\nclass TreeNode {\n    constructor(_tree, from, \n    // Index in parent node, set to -1 if the node is not a direct child of _parent.node (overlay)\n    index, _parent) {\n        this._tree = _tree;\n        this.from = from;\n        this.index = index;\n        this._parent = _parent;\n    }\n    get type() { return this._tree.type; }\n    get name() { return this._tree.type.name; }\n    get to() { return this.from + this._tree.length; }\n    nextChild(i, dir, pos, side, mode = 0) {\n        for (let parent = this;;) {\n            for (let { children, positions } = parent._tree, e = dir > 0 ? children.length : -1; i != e; i += dir) {\n                let next = children[i], start = positions[i] + parent.from;\n                if (!checkSide(side, pos, start, start + next.length))\n                    continue;\n                if (next instanceof TreeBuffer) {\n                    if (mode & IterMode.ExcludeBuffers)\n                        continue;\n                    let index = next.findChild(0, next.buffer.length, dir, pos - start, side);\n                    if (index > -1)\n                        return new BufferNode(new BufferContext(parent, next, i, start), null, index);\n                }\n                else if ((mode & IterMode.IncludeAnonymous) || (!next.type.isAnonymous || hasChild(next))) {\n                    let mounted;\n                    if (!(mode & IterMode.IgnoreMounts) &&\n                        next.props && (mounted = next.prop(NodeProp.mounted)) && !mounted.overlay)\n                        return new TreeNode(mounted.tree, start, i, parent);\n                    let inner = new TreeNode(next, start, i, parent);\n                    return (mode & IterMode.IncludeAnonymous) || !inner.type.isAnonymous ? inner\n                        : inner.nextChild(dir < 0 ? next.children.length - 1 : 0, dir, pos, side);\n                }\n            }\n            if ((mode & IterMode.IncludeAnonymous) || !parent.type.isAnonymous)\n                return null;\n            if (parent.index >= 0)\n                i = parent.index + dir;\n            else\n                i = dir < 0 ? -1 : parent._parent._tree.children.length;\n            parent = parent._parent;\n            if (!parent)\n                return null;\n        }\n    }\n    get firstChild() { return this.nextChild(0, 1, 0, 4 /* Side.DontCare */); }\n    get lastChild() { return this.nextChild(this._tree.children.length - 1, -1, 0, 4 /* Side.DontCare */); }\n    childAfter(pos) { return this.nextChild(0, 1, pos, 2 /* Side.After */); }\n    childBefore(pos) { return this.nextChild(this._tree.children.length - 1, -1, pos, -2 /* Side.Before */); }\n    enter(pos, side, mode = 0) {\n        let mounted;\n        if (!(mode & IterMode.IgnoreOverlays) && (mounted = this._tree.prop(NodeProp.mounted)) && mounted.overlay) {\n            let rPos = pos - this.from;\n            for (let { from, to } of mounted.overlay) {\n                if ((side > 0 ? from <= rPos : from < rPos) &&\n                    (side < 0 ? to >= rPos : to > rPos))\n                    return new TreeNode(mounted.tree, mounted.overlay[0].from + this.from, -1, this);\n            }\n        }\n        return this.nextChild(0, 1, pos, side, mode);\n    }\n    nextSignificantParent() {\n        let val = this;\n        while (val.type.isAnonymous && val._parent)\n            val = val._parent;\n        return val;\n    }\n    get parent() {\n        return this._parent ? this._parent.nextSignificantParent() : null;\n    }\n    get nextSibling() {\n        return this._parent && this.index >= 0 ? this._parent.nextChild(this.index + 1, 1, 0, 4 /* Side.DontCare */) : null;\n    }\n    get prevSibling() {\n        return this._parent && this.index >= 0 ? this._parent.nextChild(this.index - 1, -1, 0, 4 /* Side.DontCare */) : null;\n    }\n    cursor(mode = 0) { return new TreeCursor(this, mode); }\n    get tree() { return this._tree; }\n    toTree() { return this._tree; }\n    resolve(pos, side = 0) {\n        return resolveNode(this, pos, side, false);\n    }\n    resolveInner(pos, side = 0) {\n        return resolveNode(this, pos, side, true);\n    }\n    enterUnfinishedNodesBefore(pos) { return enterUnfinishedNodesBefore(this, pos); }\n    getChild(type, before = null, after = null) {\n        let r = getChildren(this, type, before, after);\n        return r.length ? r[0] : null;\n    }\n    getChildren(type, before = null, after = null) {\n        return getChildren(this, type, before, after);\n    }\n    /// @internal\n    toString() { return this._tree.toString(); }\n    get node() { return this; }\n    matchContext(context) { return matchNodeContext(this, context); }\n}\nfunction getChildren(node, type, before, after) {\n    let cur = node.cursor(), result = [];\n    if (!cur.firstChild())\n        return result;\n    if (before != null)\n        while (!cur.type.is(before))\n            if (!cur.nextSibling())\n                return result;\n    for (;;) {\n        if (after != null && cur.type.is(after))\n            return result;\n        if (cur.type.is(type))\n            result.push(cur.node);\n        if (!cur.nextSibling())\n            return after == null ? result : [];\n    }\n}\nfunction matchNodeContext(node, context, i = context.length - 1) {\n    for (let p = node.parent; i >= 0; p = p.parent) {\n        if (!p)\n            return false;\n        if (!p.type.isAnonymous) {\n            if (context[i] && context[i] != p.name)\n                return false;\n            i--;\n        }\n    }\n    return true;\n}\nclass BufferContext {\n    constructor(parent, buffer, index, start) {\n        this.parent = parent;\n        this.buffer = buffer;\n        this.index = index;\n        this.start = start;\n    }\n}\nclass BufferNode {\n    get name() { return this.type.name; }\n    get from() { return this.context.start + this.context.buffer.buffer[this.index + 1]; }\n    get to() { return this.context.start + this.context.buffer.buffer[this.index + 2]; }\n    constructor(context, _parent, index) {\n        this.context = context;\n        this._parent = _parent;\n        this.index = index;\n        this.type = context.buffer.set.types[context.buffer.buffer[index]];\n    }\n    child(dir, pos, side) {\n        let { buffer } = this.context;\n        let index = buffer.findChild(this.index + 4, buffer.buffer[this.index + 3], dir, pos - this.context.start, side);\n        return index < 0 ? null : new BufferNode(this.context, this, index);\n    }\n    get firstChild() { return this.child(1, 0, 4 /* Side.DontCare */); }\n    get lastChild() { return this.child(-1, 0, 4 /* Side.DontCare */); }\n    childAfter(pos) { return this.child(1, pos, 2 /* Side.After */); }\n    childBefore(pos) { return this.child(-1, pos, -2 /* Side.Before */); }\n    enter(pos, side, mode = 0) {\n        if (mode & IterMode.ExcludeBuffers)\n            return null;\n        let { buffer } = this.context;\n        let index = buffer.findChild(this.index + 4, buffer.buffer[this.index + 3], side > 0 ? 1 : -1, pos - this.context.start, side);\n        return index < 0 ? null : new BufferNode(this.context, this, index);\n    }\n    get parent() {\n        return this._parent || this.context.parent.nextSignificantParent();\n    }\n    externalSibling(dir) {\n        return this._parent ? null : this.context.parent.nextChild(this.context.index + dir, dir, 0, 4 /* Side.DontCare */);\n    }\n    get nextSibling() {\n        let { buffer } = this.context;\n        let after = buffer.buffer[this.index + 3];\n        if (after < (this._parent ? buffer.buffer[this._parent.index + 3] : buffer.buffer.length))\n            return new BufferNode(this.context, this._parent, after);\n        return this.externalSibling(1);\n    }\n    get prevSibling() {\n        let { buffer } = this.context;\n        let parentStart = this._parent ? this._parent.index + 4 : 0;\n        if (this.index == parentStart)\n            return this.externalSibling(-1);\n        return new BufferNode(this.context, this._parent, buffer.findChild(parentStart, this.index, -1, 0, 4 /* Side.DontCare */));\n    }\n    cursor(mode = 0) { return new TreeCursor(this, mode); }\n    get tree() { return null; }\n    toTree() {\n        let children = [], positions = [];\n        let { buffer } = this.context;\n        let startI = this.index + 4, endI = buffer.buffer[this.index + 3];\n        if (endI > startI) {\n            let from = buffer.buffer[this.index + 1];\n            children.push(buffer.slice(startI, endI, from));\n            positions.push(0);\n        }\n        return new Tree(this.type, children, positions, this.to - this.from);\n    }\n    resolve(pos, side = 0) {\n        return resolveNode(this, pos, side, false);\n    }\n    resolveInner(pos, side = 0) {\n        return resolveNode(this, pos, side, true);\n    }\n    enterUnfinishedNodesBefore(pos) { return enterUnfinishedNodesBefore(this, pos); }\n    /// @internal\n    toString() { return this.context.buffer.childString(this.index); }\n    getChild(type, before = null, after = null) {\n        let r = getChildren(this, type, before, after);\n        return r.length ? r[0] : null;\n    }\n    getChildren(type, before = null, after = null) {\n        return getChildren(this, type, before, after);\n    }\n    get node() { return this; }\n    matchContext(context) { return matchNodeContext(this, context); }\n}\n/// A tree cursor object focuses on a given node in a syntax tree, and\n/// allows you to move to adjacent nodes.\nclass TreeCursor {\n    /// Shorthand for `.type.name`.\n    get name() { return this.type.name; }\n    /// @internal\n    constructor(node, \n    /// @internal\n    mode = 0) {\n        this.mode = mode;\n        /// @internal\n        this.buffer = null;\n        this.stack = [];\n        /// @internal\n        this.index = 0;\n        this.bufferNode = null;\n        if (node instanceof TreeNode) {\n            this.yieldNode(node);\n        }\n        else {\n            this._tree = node.context.parent;\n            this.buffer = node.context;\n            for (let n = node._parent; n; n = n._parent)\n                this.stack.unshift(n.index);\n            this.bufferNode = node;\n            this.yieldBuf(node.index);\n        }\n    }\n    yieldNode(node) {\n        if (!node)\n            return false;\n        this._tree = node;\n        this.type = node.type;\n        this.from = node.from;\n        this.to = node.to;\n        return true;\n    }\n    yieldBuf(index, type) {\n        this.index = index;\n        let { start, buffer } = this.buffer;\n        this.type = type || buffer.set.types[buffer.buffer[index]];\n        this.from = start + buffer.buffer[index + 1];\n        this.to = start + buffer.buffer[index + 2];\n        return true;\n    }\n    yield(node) {\n        if (!node)\n            return false;\n        if (node instanceof TreeNode) {\n            this.buffer = null;\n            return this.yieldNode(node);\n        }\n        this.buffer = node.context;\n        return this.yieldBuf(node.index, node.type);\n    }\n    /// @internal\n    toString() {\n        return this.buffer ? this.buffer.buffer.childString(this.index) : this._tree.toString();\n    }\n    /// @internal\n    enterChild(dir, pos, side) {\n        if (!this.buffer)\n            return this.yield(this._tree.nextChild(dir < 0 ? this._tree._tree.children.length - 1 : 0, dir, pos, side, this.mode));\n        let { buffer } = this.buffer;\n        let index = buffer.findChild(this.index + 4, buffer.buffer[this.index + 3], dir, pos - this.buffer.start, side);\n        if (index < 0)\n            return false;\n        this.stack.push(this.index);\n        return this.yieldBuf(index);\n    }\n    /// Move the cursor to this node's first child. When this returns\n    /// false, the node has no child, and the cursor has not been moved.\n    firstChild() { return this.enterChild(1, 0, 4 /* Side.DontCare */); }\n    /// Move the cursor to this node's last child.\n    lastChild() { return this.enterChild(-1, 0, 4 /* Side.DontCare */); }\n    /// Move the cursor to the first child that ends after `pos`.\n    childAfter(pos) { return this.enterChild(1, pos, 2 /* Side.After */); }\n    /// Move to the last child that starts before `pos`.\n    childBefore(pos) { return this.enterChild(-1, pos, -2 /* Side.Before */); }\n    /// Move the cursor to the child around `pos`. If side is -1 the\n    /// child may end at that position, when 1 it may start there. This\n    /// will also enter [overlaid](#common.MountedTree.overlay)\n    /// [mounted](#common.NodeProp^mounted) trees unless `overlays` is\n    /// set to false.\n    enter(pos, side, mode = this.mode) {\n        if (!this.buffer)\n            return this.yield(this._tree.enter(pos, side, mode));\n        return mode & IterMode.ExcludeBuffers ? false : this.enterChild(1, pos, side);\n    }\n    /// Move to the node's parent node, if this isn't the top node.\n    parent() {\n        if (!this.buffer)\n            return this.yieldNode((this.mode & IterMode.IncludeAnonymous) ? this._tree._parent : this._tree.parent);\n        if (this.stack.length)\n            return this.yieldBuf(this.stack.pop());\n        let parent = (this.mode & IterMode.IncludeAnonymous) ? this.buffer.parent : this.buffer.parent.nextSignificantParent();\n        this.buffer = null;\n        return this.yieldNode(parent);\n    }\n    /// @internal\n    sibling(dir) {\n        if (!this.buffer)\n            return !this._tree._parent ? false\n                : this.yield(this._tree.index < 0 ? null\n                    : this._tree._parent.nextChild(this._tree.index + dir, dir, 0, 4 /* Side.DontCare */, this.mode));\n        let { buffer } = this.buffer, d = this.stack.length - 1;\n        if (dir < 0) {\n            let parentStart = d < 0 ? 0 : this.stack[d] + 4;\n            if (this.index != parentStart)\n                return this.yieldBuf(buffer.findChild(parentStart, this.index, -1, 0, 4 /* Side.DontCare */));\n        }\n        else {\n            let after = buffer.buffer[this.index + 3];\n            if (after < (d < 0 ? buffer.buffer.length : buffer.buffer[this.stack[d] + 3]))\n                return this.yieldBuf(after);\n        }\n        return d < 0 ? this.yield(this.buffer.parent.nextChild(this.buffer.index + dir, dir, 0, 4 /* Side.DontCare */, this.mode)) : false;\n    }\n    /// Move to this node's next sibling, if any.\n    nextSibling() { return this.sibling(1); }\n    /// Move to this node's previous sibling, if any.\n    prevSibling() { return this.sibling(-1); }\n    atLastNode(dir) {\n        let index, parent, { buffer } = this;\n        if (buffer) {\n            if (dir > 0) {\n                if (this.index < buffer.buffer.buffer.length)\n                    return false;\n            }\n            else {\n                for (let i = 0; i < this.index; i++)\n                    if (buffer.buffer.buffer[i + 3] < this.index)\n                        return false;\n            }\n            ({ index, parent } = buffer);\n        }\n        else {\n            ({ index, _parent: parent } = this._tree);\n        }\n        for (; parent; { index, _parent: parent } = parent) {\n            if (index > -1)\n                for (let i = index + dir, e = dir < 0 ? -1 : parent._tree.children.length; i != e; i += dir) {\n                    let child = parent._tree.children[i];\n                    if ((this.mode & IterMode.IncludeAnonymous) ||\n                        child instanceof TreeBuffer ||\n                        !child.type.isAnonymous ||\n                        hasChild(child))\n                        return false;\n                }\n        }\n        return true;\n    }\n    move(dir, enter) {\n        if (enter && this.enterChild(dir, 0, 4 /* Side.DontCare */))\n            return true;\n        for (;;) {\n            if (this.sibling(dir))\n                return true;\n            if (this.atLastNode(dir) || !this.parent())\n                return false;\n        }\n    }\n    /// Move to the next node in a\n    /// [pre-order](https://en.wikipedia.org/wiki/Tree_traversal#Pre-order,_NLR)\n    /// traversal, going from a node to its first child or, if the\n    /// current node is empty or `enter` is false, its next sibling or\n    /// the next sibling of the first parent node that has one.\n    next(enter = true) { return this.move(1, enter); }\n    /// Move to the next node in a last-to-first pre-order traveral. A\n    /// node is followed by its last child or, if it has none, its\n    /// previous sibling or the previous sibling of the first parent\n    /// node that has one.\n    prev(enter = true) { return this.move(-1, enter); }\n    /// Move the cursor to the innermost node that covers `pos`. If\n    /// `side` is -1, it will enter nodes that end at `pos`. If it is 1,\n    /// it will enter nodes that start at `pos`.\n    moveTo(pos, side = 0) {\n        // Move up to a node that actually holds the position, if possible\n        while (this.from == this.to ||\n            (side < 1 ? this.from >= pos : this.from > pos) ||\n            (side > -1 ? this.to <= pos : this.to < pos))\n            if (!this.parent())\n                break;\n        // Then scan down into child nodes as far as possible\n        while (this.enterChild(1, pos, side)) { }\n        return this;\n    }\n    /// Get a [syntax node](#common.SyntaxNode) at the cursor's current\n    /// position.\n    get node() {\n        if (!this.buffer)\n            return this._tree;\n        let cache = this.bufferNode, result = null, depth = 0;\n        if (cache && cache.context == this.buffer) {\n            scan: for (let index = this.index, d = this.stack.length; d >= 0;) {\n                for (let c = cache; c; c = c._parent)\n                    if (c.index == index) {\n                        if (index == this.index)\n                            return c;\n                        result = c;\n                        depth = d + 1;\n                        break scan;\n                    }\n                index = this.stack[--d];\n            }\n        }\n        for (let i = depth; i < this.stack.length; i++)\n            result = new BufferNode(this.buffer, result, this.stack[i]);\n        return this.bufferNode = new BufferNode(this.buffer, result, this.index);\n    }\n    /// Get the [tree](#common.Tree) that represents the current node, if\n    /// any. Will return null when the node is in a [tree\n    /// buffer](#common.TreeBuffer).\n    get tree() {\n        return this.buffer ? null : this._tree._tree;\n    }\n    /// Iterate over the current node and all its descendants, calling\n    /// `enter` when entering a node and `leave`, if given, when leaving\n    /// one. When `enter` returns `false`, any children of that node are\n    /// skipped, and `leave` isn't called for it.\n    iterate(enter, leave) {\n        for (let depth = 0;;) {\n            let mustLeave = false;\n            if (this.type.isAnonymous || enter(this) !== false) {\n                if (this.firstChild()) {\n                    depth++;\n                    continue;\n                }\n                if (!this.type.isAnonymous)\n                    mustLeave = true;\n            }\n            for (;;) {\n                if (mustLeave && leave)\n                    leave(this);\n                mustLeave = this.type.isAnonymous;\n                if (this.nextSibling())\n                    break;\n                if (!depth)\n                    return;\n                this.parent();\n                depth--;\n                mustLeave = true;\n            }\n        }\n    }\n    /// Test whether the current node matches a given context—a sequence\n    /// of direct parent node names. Empty strings in the context array\n    /// are treated as wildcards.\n    matchContext(context) {\n        if (!this.buffer)\n            return matchNodeContext(this.node, context);\n        let { buffer } = this.buffer, { types } = buffer.set;\n        for (let i = context.length - 1, d = this.stack.length - 1; i >= 0; d--) {\n            if (d < 0)\n                return matchNodeContext(this.node, context, i);\n            let type = types[buffer.buffer[this.stack[d]]];\n            if (!type.isAnonymous) {\n                if (context[i] && context[i] != type.name)\n                    return false;\n                i--;\n            }\n        }\n        return true;\n    }\n}\nfunction hasChild(tree) {\n    return tree.children.some(ch => ch instanceof TreeBuffer || !ch.type.isAnonymous || hasChild(ch));\n}\nfunction buildTree(data) {\n    var _a;\n    let { buffer, nodeSet, maxBufferLength = DefaultBufferLength, reused = [], minRepeatType = nodeSet.types.length } = data;\n    let cursor = Array.isArray(buffer) ? new FlatBufferCursor(buffer, buffer.length) : buffer;\n    let types = nodeSet.types;\n    let contextHash = 0, lookAhead = 0;\n    function takeNode(parentStart, minPos, children, positions, inRepeat) {\n        let { id, start, end, size } = cursor;\n        let lookAheadAtStart = lookAhead;\n        while (size < 0) {\n            cursor.next();\n            if (size == -1 /* SpecialRecord.Reuse */) {\n                let node = reused[id];\n                children.push(node);\n                positions.push(start - parentStart);\n                return;\n            }\n            else if (size == -3 /* SpecialRecord.ContextChange */) { // Context change\n                contextHash = id;\n                return;\n            }\n            else if (size == -4 /* SpecialRecord.LookAhead */) {\n                lookAhead = id;\n                return;\n            }\n            else {\n                throw new RangeError(`Unrecognized record size: ${size}`);\n            }\n        }\n        let type = types[id], node, buffer;\n        let startPos = start - parentStart;\n        if (end - start <= maxBufferLength && (buffer = findBufferSize(cursor.pos - minPos, inRepeat))) {\n            // Small enough for a buffer, and no reused nodes inside\n            let data = new Uint16Array(buffer.size - buffer.skip);\n            let endPos = cursor.pos - buffer.size, index = data.length;\n            while (cursor.pos > endPos)\n                index = copyToBuffer(buffer.start, data, index);\n            node = new TreeBuffer(data, end - buffer.start, nodeSet);\n            startPos = buffer.start - parentStart;\n        }\n        else { // Make it a node\n            let endPos = cursor.pos - size;\n            cursor.next();\n            let localChildren = [], localPositions = [];\n            let localInRepeat = id >= minRepeatType ? id : -1;\n            let lastGroup = 0, lastEnd = end;\n            while (cursor.pos > endPos) {\n                if (localInRepeat >= 0 && cursor.id == localInRepeat && cursor.size >= 0) {\n                    if (cursor.end <= lastEnd - maxBufferLength) {\n                        makeRepeatLeaf(localChildren, localPositions, start, lastGroup, cursor.end, lastEnd, localInRepeat, lookAheadAtStart);\n                        lastGroup = localChildren.length;\n                        lastEnd = cursor.end;\n                    }\n                    cursor.next();\n                }\n                else {\n                    takeNode(start, endPos, localChildren, localPositions, localInRepeat);\n                }\n            }\n            if (localInRepeat >= 0 && lastGroup > 0 && lastGroup < localChildren.length)\n                makeRepeatLeaf(localChildren, localPositions, start, lastGroup, start, lastEnd, localInRepeat, lookAheadAtStart);\n            localChildren.reverse();\n            localPositions.reverse();\n            if (localInRepeat > -1 && lastGroup > 0) {\n                let make = makeBalanced(type);\n                node = balanceRange(type, localChildren, localPositions, 0, localChildren.length, 0, end - start, make, make);\n            }\n            else {\n                node = makeTree(type, localChildren, localPositions, end - start, lookAheadAtStart - end);\n            }\n        }\n        children.push(node);\n        positions.push(startPos);\n    }\n    function makeBalanced(type) {\n        return (children, positions, length) => {\n            let lookAhead = 0, lastI = children.length - 1, last, lookAheadProp;\n            if (lastI >= 0 && (last = children[lastI]) instanceof Tree) {\n                if (!lastI && last.type == type && last.length == length)\n                    return last;\n                if (lookAheadProp = last.prop(NodeProp.lookAhead))\n                    lookAhead = positions[lastI] + last.length + lookAheadProp;\n            }\n            return makeTree(type, children, positions, length, lookAhead);\n        };\n    }\n    function makeRepeatLeaf(children, positions, base, i, from, to, type, lookAhead) {\n        let localChildren = [], localPositions = [];\n        while (children.length > i) {\n            localChildren.push(children.pop());\n            localPositions.push(positions.pop() + base - from);\n        }\n        children.push(makeTree(nodeSet.types[type], localChildren, localPositions, to - from, lookAhead - to));\n        positions.push(from - base);\n    }\n    function makeTree(type, children, positions, length, lookAhead = 0, props) {\n        if (contextHash) {\n            let pair = [NodeProp.contextHash, contextHash];\n            props = props ? [pair].concat(props) : [pair];\n        }\n        if (lookAhead > 25) {\n            let pair = [NodeProp.lookAhead, lookAhead];\n            props = props ? [pair].concat(props) : [pair];\n        }\n        return new Tree(type, children, positions, length, props);\n    }\n    function findBufferSize(maxSize, inRepeat) {\n        // Scan through the buffer to find previous siblings that fit\n        // together in a TreeBuffer, and don't contain any reused nodes\n        // (which can't be stored in a buffer).\n        // If `inRepeat` is > -1, ignore node boundaries of that type for\n        // nesting, but make sure the end falls either at the start\n        // (`maxSize`) or before such a node.\n        let fork = cursor.fork();\n        let size = 0, start = 0, skip = 0, minStart = fork.end - maxBufferLength;\n        let result = { size: 0, start: 0, skip: 0 };\n        scan: for (let minPos = fork.pos - maxSize; fork.pos > minPos;) {\n            let nodeSize = fork.size;\n            // Pretend nested repeat nodes of the same type don't exist\n            if (fork.id == inRepeat && nodeSize >= 0) {\n                // Except that we store the current state as a valid return\n                // value.\n                result.size = size;\n                result.start = start;\n                result.skip = skip;\n                skip += 4;\n                size += 4;\n                fork.next();\n                continue;\n            }\n            let startPos = fork.pos - nodeSize;\n            if (nodeSize < 0 || startPos < minPos || fork.start < minStart)\n                break;\n            let localSkipped = fork.id >= minRepeatType ? 4 : 0;\n            let nodeStart = fork.start;\n            fork.next();\n            while (fork.pos > startPos) {\n                if (fork.size < 0) {\n                    if (fork.size == -3 /* SpecialRecord.ContextChange */)\n                        localSkipped += 4;\n                    else\n                        break scan;\n                }\n                else if (fork.id >= minRepeatType) {\n                    localSkipped += 4;\n                }\n                fork.next();\n            }\n            start = nodeStart;\n            size += nodeSize;\n            skip += localSkipped;\n        }\n        if (inRepeat < 0 || size == maxSize) {\n            result.size = size;\n            result.start = start;\n            result.skip = skip;\n        }\n        return result.size > 4 ? result : undefined;\n    }\n    function copyToBuffer(bufferStart, buffer, index) {\n        let { id, start, end, size } = cursor;\n        cursor.next();\n        if (size >= 0 && id < minRepeatType) {\n            let startIndex = index;\n            if (size > 4) {\n                let endPos = cursor.pos - (size - 4);\n                while (cursor.pos > endPos)\n                    index = copyToBuffer(bufferStart, buffer, index);\n            }\n            buffer[--index] = startIndex;\n            buffer[--index] = end - bufferStart;\n            buffer[--index] = start - bufferStart;\n            buffer[--index] = id;\n        }\n        else if (size == -3 /* SpecialRecord.ContextChange */) {\n            contextHash = id;\n        }\n        else if (size == -4 /* SpecialRecord.LookAhead */) {\n            lookAhead = id;\n        }\n        return index;\n    }\n    let children = [], positions = [];\n    while (cursor.pos > 0)\n        takeNode(data.start || 0, data.bufferStart || 0, children, positions, -1);\n    let length = (_a = data.length) !== null && _a !== void 0 ? _a : (children.length ? positions[0] + children[0].length : 0);\n    return new Tree(types[data.topID], children.reverse(), positions.reverse(), length);\n}\nconst nodeSizeCache = new WeakMap;\nfunction nodeSize(balanceType, node) {\n    if (!balanceType.isAnonymous || node instanceof TreeBuffer || node.type != balanceType)\n        return 1;\n    let size = nodeSizeCache.get(node);\n    if (size == null) {\n        size = 1;\n        for (let child of node.children) {\n            if (child.type != balanceType || !(child instanceof Tree)) {\n                size = 1;\n                break;\n            }\n            size += nodeSize(balanceType, child);\n        }\n        nodeSizeCache.set(node, size);\n    }\n    return size;\n}\nfunction balanceRange(\n// The type the balanced tree's inner nodes.\nbalanceType, \n// The direct children and their positions\nchildren, positions, \n// The index range in children/positions to use\nfrom, to, \n// The start position of the nodes, relative to their parent.\nstart, \n// Length of the outer node\nlength, \n// Function to build the top node of the balanced tree\nmkTop, \n// Function to build internal nodes for the balanced tree\nmkTree) {\n    let total = 0;\n    for (let i = from; i < to; i++)\n        total += nodeSize(balanceType, children[i]);\n    let maxChild = Math.ceil((total * 1.5) / 8 /* Balance.BranchFactor */);\n    let localChildren = [], localPositions = [];\n    function divide(children, positions, from, to, offset) {\n        for (let i = from; i < to;) {\n            let groupFrom = i, groupStart = positions[i], groupSize = nodeSize(balanceType, children[i]);\n            i++;\n            for (; i < to; i++) {\n                let nextSize = nodeSize(balanceType, children[i]);\n                if (groupSize + nextSize >= maxChild)\n                    break;\n                groupSize += nextSize;\n            }\n            if (i == groupFrom + 1) {\n                if (groupSize > maxChild) {\n                    let only = children[groupFrom]; // Only trees can have a size > 1\n                    divide(only.children, only.positions, 0, only.children.length, positions[groupFrom] + offset);\n                    continue;\n                }\n                localChildren.push(children[groupFrom]);\n            }\n            else {\n                let length = positions[i - 1] + children[i - 1].length - groupStart;\n                localChildren.push(balanceRange(balanceType, children, positions, groupFrom, i, groupStart, length, null, mkTree));\n            }\n            localPositions.push(groupStart + offset - start);\n        }\n    }\n    divide(children, positions, from, to, 0);\n    return (mkTop || mkTree)(localChildren, localPositions, length);\n}\n/// Provides a way to associate values with pieces of trees. As long\n/// as that part of the tree is reused, the associated values can be\n/// retrieved from an updated tree.\nclass NodeWeakMap {\n    constructor() {\n        this.map = new WeakMap();\n    }\n    setBuffer(buffer, index, value) {\n        let inner = this.map.get(buffer);\n        if (!inner)\n            this.map.set(buffer, inner = new Map);\n        inner.set(index, value);\n    }\n    getBuffer(buffer, index) {\n        let inner = this.map.get(buffer);\n        return inner && inner.get(index);\n    }\n    /// Set the value for this syntax node.\n    set(node, value) {\n        if (node instanceof BufferNode)\n            this.setBuffer(node.context.buffer, node.index, value);\n        else if (node instanceof TreeNode)\n            this.map.set(node.tree, value);\n    }\n    /// Retrieve value for this syntax node, if it exists in the map.\n    get(node) {\n        return node instanceof BufferNode ? this.getBuffer(node.context.buffer, node.index)\n            : node instanceof TreeNode ? this.map.get(node.tree) : undefined;\n    }\n    /// Set the value for the node that a cursor currently points to.\n    cursorSet(cursor, value) {\n        if (cursor.buffer)\n            this.setBuffer(cursor.buffer.buffer, cursor.index, value);\n        else\n            this.map.set(cursor.tree, value);\n    }\n    /// Retrieve the value for the node that a cursor currently points\n    /// to.\n    cursorGet(cursor) {\n        return cursor.buffer ? this.getBuffer(cursor.buffer.buffer, cursor.index) : this.map.get(cursor.tree);\n    }\n}\n\n/// Tree fragments are used during [incremental\n/// parsing](#common.Parser.startParse) to track parts of old trees\n/// that can be reused in a new parse. An array of fragments is used\n/// to track regions of an old tree whose nodes might be reused in new\n/// parses. Use the static\n/// [`applyChanges`](#common.TreeFragment^applyChanges) method to\n/// update fragments for document changes.\nclass TreeFragment {\n    /// Construct a tree fragment. You'll usually want to use\n    /// [`addTree`](#common.TreeFragment^addTree) and\n    /// [`applyChanges`](#common.TreeFragment^applyChanges) instead of\n    /// calling this directly.\n    constructor(\n    /// The start of the unchanged range pointed to by this fragment.\n    /// This refers to an offset in the _updated_ document (as opposed\n    /// to the original tree).\n    from, \n    /// The end of the unchanged range.\n    to, \n    /// The tree that this fragment is based on.\n    tree, \n    /// The offset between the fragment's tree and the document that\n    /// this fragment can be used against. Add this when going from\n    /// document to tree positions, subtract it to go from tree to\n    /// document positions.\n    offset, openStart = false, openEnd = false) {\n        this.from = from;\n        this.to = to;\n        this.tree = tree;\n        this.offset = offset;\n        this.open = (openStart ? 1 /* Open.Start */ : 0) | (openEnd ? 2 /* Open.End */ : 0);\n    }\n    /// Whether the start of the fragment represents the start of a\n    /// parse, or the end of a change. (In the second case, it may not\n    /// be safe to reuse some nodes at the start, depending on the\n    /// parsing algorithm.)\n    get openStart() { return (this.open & 1 /* Open.Start */) > 0; }\n    /// Whether the end of the fragment represents the end of a\n    /// full-document parse, or the start of a change.\n    get openEnd() { return (this.open & 2 /* Open.End */) > 0; }\n    /// Create a set of fragments from a freshly parsed tree, or update\n    /// an existing set of fragments by replacing the ones that overlap\n    /// with a tree with content from the new tree. When `partial` is\n    /// true, the parse is treated as incomplete, and the resulting\n    /// fragment has [`openEnd`](#common.TreeFragment.openEnd) set to\n    /// true.\n    static addTree(tree, fragments = [], partial = false) {\n        let result = [new TreeFragment(0, tree.length, tree, 0, false, partial)];\n        for (let f of fragments)\n            if (f.to > tree.length)\n                result.push(f);\n        return result;\n    }\n    /// Apply a set of edits to an array of fragments, removing or\n    /// splitting fragments as necessary to remove edited ranges, and\n    /// adjusting offsets for fragments that moved.\n    static applyChanges(fragments, changes, minGap = 128) {\n        if (!changes.length)\n            return fragments;\n        let result = [];\n        let fI = 1, nextF = fragments.length ? fragments[0] : null;\n        for (let cI = 0, pos = 0, off = 0;; cI++) {\n            let nextC = cI < changes.length ? changes[cI] : null;\n            let nextPos = nextC ? nextC.fromA : 1e9;\n            if (nextPos - pos >= minGap)\n                while (nextF && nextF.from < nextPos) {\n                    let cut = nextF;\n                    if (pos >= cut.from || nextPos <= cut.to || off) {\n                        let fFrom = Math.max(cut.from, pos) - off, fTo = Math.min(cut.to, nextPos) - off;\n                        cut = fFrom >= fTo ? null : new TreeFragment(fFrom, fTo, cut.tree, cut.offset + off, cI > 0, !!nextC);\n                    }\n                    if (cut)\n                        result.push(cut);\n                    if (nextF.to > nextPos)\n                        break;\n                    nextF = fI < fragments.length ? fragments[fI++] : null;\n                }\n            if (!nextC)\n                break;\n            pos = nextC.toA;\n            off = nextC.toA - nextC.toB;\n        }\n        return result;\n    }\n}\n/// A superclass that parsers should extend.\nclass Parser {\n    /// Start a parse, returning a [partial parse](#common.PartialParse)\n    /// object. [`fragments`](#common.TreeFragment) can be passed in to\n    /// make the parse incremental.\n    ///\n    /// By default, the entire input is parsed. You can pass `ranges`,\n    /// which should be a sorted array of non-empty, non-overlapping\n    /// ranges, to parse only those ranges. The tree returned in that\n    /// case will start at `ranges[0].from`.\n    startParse(input, fragments, ranges) {\n        if (typeof input == \"string\")\n            input = new StringInput(input);\n        ranges = !ranges ? [new Range(0, input.length)] : ranges.length ? ranges.map(r => new Range(r.from, r.to)) : [new Range(0, 0)];\n        return this.createParse(input, fragments || [], ranges);\n    }\n    /// Run a full parse, returning the resulting tree.\n    parse(input, fragments, ranges) {\n        let parse = this.startParse(input, fragments, ranges);\n        for (;;) {\n            let done = parse.advance();\n            if (done)\n                return done;\n        }\n    }\n}\nclass StringInput {\n    constructor(string) {\n        this.string = string;\n    }\n    get length() { return this.string.length; }\n    chunk(from) { return this.string.slice(from); }\n    get lineChunks() { return false; }\n    read(from, to) { return this.string.slice(from, to); }\n}\n\n/// Create a parse wrapper that, after the inner parse completes,\n/// scans its tree for mixed language regions with the `nest`\n/// function, runs the resulting [inner parses](#common.NestedParse),\n/// and then [mounts](#common.NodeProp^mounted) their results onto the\n/// tree.\nfunction parseMixed(nest) {\n    return (parse, input, fragments, ranges) => new MixedParse(parse, nest, input, fragments, ranges);\n}\nclass InnerParse {\n    constructor(parser, parse, overlay, target, ranges) {\n        this.parser = parser;\n        this.parse = parse;\n        this.overlay = overlay;\n        this.target = target;\n        this.ranges = ranges;\n    }\n}\nclass ActiveOverlay {\n    constructor(parser, predicate, mounts, index, start, target, prev) {\n        this.parser = parser;\n        this.predicate = predicate;\n        this.mounts = mounts;\n        this.index = index;\n        this.start = start;\n        this.target = target;\n        this.prev = prev;\n        this.depth = 0;\n        this.ranges = [];\n    }\n}\nconst stoppedInner = new NodeProp({ perNode: true });\nclass MixedParse {\n    constructor(base, nest, input, fragments, ranges) {\n        this.nest = nest;\n        this.input = input;\n        this.fragments = fragments;\n        this.ranges = ranges;\n        this.inner = [];\n        this.innerDone = 0;\n        this.baseTree = null;\n        this.stoppedAt = null;\n        this.baseParse = base;\n    }\n    advance() {\n        if (this.baseParse) {\n            let done = this.baseParse.advance();\n            if (!done)\n                return null;\n            this.baseParse = null;\n            this.baseTree = done;\n            this.startInner();\n            if (this.stoppedAt != null)\n                for (let inner of this.inner)\n                    inner.parse.stopAt(this.stoppedAt);\n        }\n        if (this.innerDone == this.inner.length) {\n            let result = this.baseTree;\n            if (this.stoppedAt != null)\n                result = new Tree(result.type, result.children, result.positions, result.length, result.propValues.concat([[stoppedInner, this.stoppedAt]]));\n            return result;\n        }\n        let inner = this.inner[this.innerDone], done = inner.parse.advance();\n        if (done) {\n            this.innerDone++;\n            // This is a somewhat dodgy but super helpful hack where we\n            // patch up nodes created by the inner parse (and thus\n            // presumably not aliased anywhere else) to hold the information\n            // about the inner parse.\n            let props = Object.assign(Object.create(null), inner.target.props);\n            props[NodeProp.mounted.id] = new MountedTree(done, inner.overlay, inner.parser);\n            inner.target.props = props;\n        }\n        return null;\n    }\n    get parsedPos() {\n        if (this.baseParse)\n            return 0;\n        let pos = this.input.length;\n        for (let i = this.innerDone; i < this.inner.length; i++) {\n            if (this.inner[i].ranges[0].from < pos)\n                pos = Math.min(pos, this.inner[i].parse.parsedPos);\n        }\n        return pos;\n    }\n    stopAt(pos) {\n        this.stoppedAt = pos;\n        if (this.baseParse)\n            this.baseParse.stopAt(pos);\n        else\n            for (let i = this.innerDone; i < this.inner.length; i++)\n                this.inner[i].parse.stopAt(pos);\n    }\n    startInner() {\n        let fragmentCursor = new FragmentCursor(this.fragments);\n        let overlay = null;\n        let covered = null;\n        let cursor = new TreeCursor(new TreeNode(this.baseTree, this.ranges[0].from, 0, null), IterMode.IncludeAnonymous | IterMode.IgnoreMounts);\n        scan: for (let nest, isCovered; this.stoppedAt == null || cursor.from < this.stoppedAt;) {\n            let enter = true, range;\n            if (fragmentCursor.hasNode(cursor)) {\n                if (overlay) {\n                    let match = overlay.mounts.find(m => m.frag.from <= cursor.from && m.frag.to >= cursor.to && m.mount.overlay);\n                    if (match)\n                        for (let r of match.mount.overlay) {\n                            let from = r.from + match.pos, to = r.to + match.pos;\n                            if (from >= cursor.from && to <= cursor.to && !overlay.ranges.some(r => r.from < to && r.to > from))\n                                overlay.ranges.push({ from, to });\n                        }\n                }\n                enter = false;\n            }\n            else if (covered && (isCovered = checkCover(covered.ranges, cursor.from, cursor.to))) {\n                enter = isCovered != 2 /* Cover.Full */;\n            }\n            else if (!cursor.type.isAnonymous && cursor.from < cursor.to && (nest = this.nest(cursor, this.input))) {\n                if (!cursor.tree)\n                    materialize(cursor);\n                let oldMounts = fragmentCursor.findMounts(cursor.from, nest.parser);\n                if (typeof nest.overlay == \"function\") {\n                    overlay = new ActiveOverlay(nest.parser, nest.overlay, oldMounts, this.inner.length, cursor.from, cursor.tree, overlay);\n                }\n                else {\n                    let ranges = punchRanges(this.ranges, nest.overlay || [new Range(cursor.from, cursor.to)]);\n                    if (ranges.length)\n                        this.inner.push(new InnerParse(nest.parser, nest.parser.startParse(this.input, enterFragments(oldMounts, ranges), ranges), nest.overlay ? nest.overlay.map(r => new Range(r.from - cursor.from, r.to - cursor.from)) : null, cursor.tree, ranges));\n                    if (!nest.overlay)\n                        enter = false;\n                    else if (ranges.length)\n                        covered = { ranges, depth: 0, prev: covered };\n                }\n            }\n            else if (overlay && (range = overlay.predicate(cursor))) {\n                if (range === true)\n                    range = new Range(cursor.from, cursor.to);\n                if (range.from < range.to)\n                    overlay.ranges.push(range);\n            }\n            if (enter && cursor.firstChild()) {\n                if (overlay)\n                    overlay.depth++;\n                if (covered)\n                    covered.depth++;\n            }\n            else {\n                for (;;) {\n                    if (cursor.nextSibling())\n                        break;\n                    if (!cursor.parent())\n                        break scan;\n                    if (overlay && !--overlay.depth) {\n                        let ranges = punchRanges(this.ranges, overlay.ranges);\n                        if (ranges.length)\n                            this.inner.splice(overlay.index, 0, new InnerParse(overlay.parser, overlay.parser.startParse(this.input, enterFragments(overlay.mounts, ranges), ranges), overlay.ranges.map(r => new Range(r.from - overlay.start, r.to - overlay.start)), overlay.target, ranges));\n                        overlay = overlay.prev;\n                    }\n                    if (covered && !--covered.depth)\n                        covered = covered.prev;\n                }\n            }\n        }\n    }\n}\nfunction checkCover(covered, from, to) {\n    for (let range of covered) {\n        if (range.from >= to)\n            break;\n        if (range.to > from)\n            return range.from <= from && range.to >= to ? 2 /* Cover.Full */ : 1 /* Cover.Partial */;\n    }\n    return 0 /* Cover.None */;\n}\n// Take a piece of buffer and convert it into a stand-alone\n// TreeBuffer.\nfunction sliceBuf(buf, startI, endI, nodes, positions, off) {\n    if (startI < endI) {\n        let from = buf.buffer[startI + 1];\n        nodes.push(buf.slice(startI, endI, from));\n        positions.push(from - off);\n    }\n}\n// This function takes a node that's in a buffer, and converts it, and\n// its parent buffer nodes, into a Tree. This is again acting on the\n// assumption that the trees and buffers have been constructed by the\n// parse that was ran via the mix parser, and thus aren't shared with\n// any other code, making violations of the immutability safe.\nfunction materialize(cursor) {\n    let { node } = cursor, depth = 0;\n    // Scan up to the nearest tree\n    do {\n        cursor.parent();\n        depth++;\n    } while (!cursor.tree);\n    // Find the index of the buffer in that tree\n    let i = 0, base = cursor.tree, off = 0;\n    for (;; i++) {\n        off = base.positions[i] + cursor.from;\n        if (off <= node.from && off + base.children[i].length >= node.to)\n            break;\n    }\n    let buf = base.children[i], b = buf.buffer;\n    // Split a level in the buffer, putting the nodes before and after\n    // the child that contains `node` into new buffers.\n    function split(startI, endI, type, innerOffset, length) {\n        let i = startI;\n        while (b[i + 2] + off <= node.from)\n            i = b[i + 3];\n        let children = [], positions = [];\n        sliceBuf(buf, startI, i, children, positions, innerOffset);\n        let from = b[i + 1], to = b[i + 2];\n        let isTarget = from + off == node.from && to + off == node.to && b[i] == node.type.id;\n        children.push(isTarget ? node.toTree() : split(i + 4, b[i + 3], buf.set.types[b[i]], from, to - from));\n        positions.push(from - innerOffset);\n        sliceBuf(buf, b[i + 3], endI, children, positions, innerOffset);\n        return new Tree(type, children, positions, length);\n    }\n    base.children[i] = split(0, b.length, NodeType.none, 0, buf.length);\n    // Move the cursor back to the target node\n    for (let d = 0; d <= depth; d++)\n        cursor.childAfter(node.from);\n}\nclass StructureCursor {\n    constructor(root, offset) {\n        this.offset = offset;\n        this.done = false;\n        this.cursor = root.cursor(IterMode.IncludeAnonymous | IterMode.IgnoreMounts);\n    }\n    // Move to the first node (in pre-order) that starts at or after `pos`.\n    moveTo(pos) {\n        let { cursor } = this, p = pos - this.offset;\n        while (!this.done && cursor.from < p) {\n            if (cursor.to >= pos && cursor.enter(p, 1, IterMode.IgnoreOverlays | IterMode.ExcludeBuffers)) ;\n            else if (!cursor.next(false))\n                this.done = true;\n        }\n    }\n    hasNode(cursor) {\n        this.moveTo(cursor.from);\n        if (!this.done && this.cursor.from + this.offset == cursor.from && this.cursor.tree) {\n            for (let tree = this.cursor.tree;;) {\n                if (tree == cursor.tree)\n                    return true;\n                if (tree.children.length && tree.positions[0] == 0 && tree.children[0] instanceof Tree)\n                    tree = tree.children[0];\n                else\n                    break;\n            }\n        }\n        return false;\n    }\n}\nclass FragmentCursor {\n    constructor(fragments) {\n        var _a;\n        this.fragments = fragments;\n        this.curTo = 0;\n        this.fragI = 0;\n        if (fragments.length) {\n            let first = this.curFrag = fragments[0];\n            this.curTo = (_a = first.tree.prop(stoppedInner)) !== null && _a !== void 0 ? _a : first.to;\n            this.inner = new StructureCursor(first.tree, -first.offset);\n        }\n        else {\n            this.curFrag = this.inner = null;\n        }\n    }\n    hasNode(node) {\n        while (this.curFrag && node.from >= this.curTo)\n            this.nextFrag();\n        return this.curFrag && this.curFrag.from <= node.from && this.curTo >= node.to && this.inner.hasNode(node);\n    }\n    nextFrag() {\n        var _a;\n        this.fragI++;\n        if (this.fragI == this.fragments.length) {\n            this.curFrag = this.inner = null;\n        }\n        else {\n            let frag = this.curFrag = this.fragments[this.fragI];\n            this.curTo = (_a = frag.tree.prop(stoppedInner)) !== null && _a !== void 0 ? _a : frag.to;\n            this.inner = new StructureCursor(frag.tree, -frag.offset);\n        }\n    }\n    findMounts(pos, parser) {\n        var _a;\n        let result = [];\n        if (this.inner) {\n            this.inner.cursor.moveTo(pos, 1);\n            for (let pos = this.inner.cursor.node; pos; pos = pos.parent) {\n                let mount = (_a = pos.tree) === null || _a === void 0 ? void 0 : _a.prop(NodeProp.mounted);\n                if (mount && mount.parser == parser) {\n                    for (let i = this.fragI; i < this.fragments.length; i++) {\n                        let frag = this.fragments[i];\n                        if (frag.from >= pos.to)\n                            break;\n                        if (frag.tree == this.curFrag.tree)\n                            result.push({\n                                frag,\n                                pos: pos.from - frag.offset,\n                                mount\n                            });\n                    }\n                }\n            }\n        }\n        return result;\n    }\n}\nfunction punchRanges(outer, ranges) {\n    let copy = null, current = ranges;\n    for (let i = 1, j = 0; i < outer.length; i++) {\n        let gapFrom = outer[i - 1].to, gapTo = outer[i].from;\n        for (; j < current.length; j++) {\n            let r = current[j];\n            if (r.from >= gapTo)\n                break;\n            if (r.to <= gapFrom)\n                continue;\n            if (!copy)\n                current = copy = ranges.slice();\n            if (r.from < gapFrom) {\n                copy[j] = new Range(r.from, gapFrom);\n                if (r.to > gapTo)\n                    copy.splice(j + 1, 0, new Range(gapTo, r.to));\n            }\n            else if (r.to > gapTo) {\n                copy[j--] = new Range(gapTo, r.to);\n            }\n            else {\n                copy.splice(j--, 1);\n            }\n        }\n    }\n    return current;\n}\nfunction findCoverChanges(a, b, from, to) {\n    let iA = 0, iB = 0, inA = false, inB = false, pos = -1e9;\n    let result = [];\n    for (;;) {\n        let nextA = iA == a.length ? 1e9 : inA ? a[iA].to : a[iA].from;\n        let nextB = iB == b.length ? 1e9 : inB ? b[iB].to : b[iB].from;\n        if (inA != inB) {\n            let start = Math.max(pos, from), end = Math.min(nextA, nextB, to);\n            if (start < end)\n                result.push(new Range(start, end));\n        }\n        pos = Math.min(nextA, nextB);\n        if (pos == 1e9)\n            break;\n        if (nextA == pos) {\n            if (!inA)\n                inA = true;\n            else {\n                inA = false;\n                iA++;\n            }\n        }\n        if (nextB == pos) {\n            if (!inB)\n                inB = true;\n            else {\n                inB = false;\n                iB++;\n            }\n        }\n    }\n    return result;\n}\n// Given a number of fragments for the outer tree, and a set of ranges\n// to parse, find fragments for inner trees mounted around those\n// ranges, if any.\nfunction enterFragments(mounts, ranges) {\n    let result = [];\n    for (let { pos, mount, frag } of mounts) {\n        let startPos = pos + (mount.overlay ? mount.overlay[0].from : 0), endPos = startPos + mount.tree.length;\n        let from = Math.max(frag.from, startPos), to = Math.min(frag.to, endPos);\n        if (mount.overlay) {\n            let overlay = mount.overlay.map(r => new Range(r.from + pos, r.to + pos));\n            let changes = findCoverChanges(ranges, overlay, from, to);\n            for (let i = 0, pos = from;; i++) {\n                let last = i == changes.length, end = last ? to : changes[i].from;\n                if (end > pos)\n                    result.push(new TreeFragment(pos, end, mount.tree, -startPos, frag.from >= pos || frag.openStart, frag.to <= end || frag.openEnd));\n                if (last)\n                    break;\n                pos = changes[i].to;\n            }\n        }\n        else {\n            result.push(new TreeFragment(from, to, mount.tree, -startPos, frag.from >= startPos || frag.openStart, frag.to <= endPos || frag.openEnd));\n        }\n    }\n    return result;\n}\n\nexport { DefaultBufferLength, IterMode, MountedTree, NodeProp, NodeSet, NodeType, NodeWeakMap, Parser, Tree, TreeBuffer, TreeCursor, TreeFragment, parseMixed };\n","import { NodeProp } from '@lezer/common';\n\nlet nextTagID = 0;\n/// Highlighting tags are markers that denote a highlighting category.\n/// They are [associated](#highlight.styleTags) with parts of a syntax\n/// tree by a language mode, and then mapped to an actual CSS style by\n/// a [highlighter](#highlight.Highlighter).\n///\n/// Because syntax tree node types and highlight styles have to be\n/// able to talk the same language, CodeMirror uses a mostly _closed_\n/// [vocabulary](#highlight.tags) of syntax tags (as opposed to\n/// traditional open string-based systems, which make it hard for\n/// highlighting themes to cover all the tokens produced by the\n/// various languages).\n///\n/// It _is_ possible to [define](#highlight.Tag^define) your own\n/// highlighting tags for system-internal use (where you control both\n/// the language package and the highlighter), but such tags will not\n/// be picked up by regular highlighters (though you can derive them\n/// from standard tags to allow highlighters to fall back to those).\nclass Tag {\n    /// @internal\n    constructor(\n    /// The set of this tag and all its parent tags, starting with\n    /// this one itself and sorted in order of decreasing specificity.\n    set, \n    /// The base unmodified tag that this one is based on, if it's\n    /// modified @internal\n    base, \n    /// The modifiers applied to this.base @internal\n    modified) {\n        this.set = set;\n        this.base = base;\n        this.modified = modified;\n        /// @internal\n        this.id = nextTagID++;\n    }\n    /// Define a new tag. If `parent` is given, the tag is treated as a\n    /// sub-tag of that parent, and\n    /// [highlighters](#highlight.tagHighlighter) that don't mention\n    /// this tag will try to fall back to the parent tag (or grandparent\n    /// tag, etc).\n    static define(parent) {\n        if (parent === null || parent === void 0 ? void 0 : parent.base)\n            throw new Error(\"Can not derive from a modified tag\");\n        let tag = new Tag([], null, []);\n        tag.set.push(tag);\n        if (parent)\n            for (let t of parent.set)\n                tag.set.push(t);\n        return tag;\n    }\n    /// Define a tag _modifier_, which is a function that, given a tag,\n    /// will return a tag that is a subtag of the original. Applying the\n    /// same modifier to a twice tag will return the same value (`m1(t1)\n    /// == m1(t1)`) and applying multiple modifiers will, regardless or\n    /// order, produce the same tag (`m1(m2(t1)) == m2(m1(t1))`).\n    ///\n    /// When multiple modifiers are applied to a given base tag, each\n    /// smaller set of modifiers is registered as a parent, so that for\n    /// example `m1(m2(m3(t1)))` is a subtype of `m1(m2(t1))`,\n    /// `m1(m3(t1)`, and so on.\n    static defineModifier() {\n        let mod = new Modifier;\n        return (tag) => {\n            if (tag.modified.indexOf(mod) > -1)\n                return tag;\n            return Modifier.get(tag.base || tag, tag.modified.concat(mod).sort((a, b) => a.id - b.id));\n        };\n    }\n}\nlet nextModifierID = 0;\nclass Modifier {\n    constructor() {\n        this.instances = [];\n        this.id = nextModifierID++;\n    }\n    static get(base, mods) {\n        if (!mods.length)\n            return base;\n        let exists = mods[0].instances.find(t => t.base == base && sameArray(mods, t.modified));\n        if (exists)\n            return exists;\n        let set = [], tag = new Tag(set, base, mods);\n        for (let m of mods)\n            m.instances.push(tag);\n        let configs = powerSet(mods);\n        for (let parent of base.set)\n            if (!parent.modified.length)\n                for (let config of configs)\n                    set.push(Modifier.get(parent, config));\n        return tag;\n    }\n}\nfunction sameArray(a, b) {\n    return a.length == b.length && a.every((x, i) => x == b[i]);\n}\nfunction powerSet(array) {\n    let sets = [[]];\n    for (let i = 0; i < array.length; i++) {\n        for (let j = 0, e = sets.length; j < e; j++) {\n            sets.push(sets[j].concat(array[i]));\n        }\n    }\n    return sets.sort((a, b) => b.length - a.length);\n}\n/// This function is used to add a set of tags to a language syntax\n/// via [`NodeSet.extend`](#common.NodeSet.extend) or\n/// [`LRParser.configure`](#lr.LRParser.configure).\n///\n/// The argument object maps node selectors to [highlighting\n/// tags](#highlight.Tag) or arrays of tags.\n///\n/// Node selectors may hold one or more (space-separated) node paths.\n/// Such a path can be a [node name](#common.NodeType.name), or\n/// multiple node names (or `*` wildcards) separated by slash\n/// characters, as in `\"Block/Declaration/VariableName\"`. Such a path\n/// matches the final node but only if its direct parent nodes are the\n/// other nodes mentioned. A `*` in such a path matches any parent,\n/// but only a single level—wildcards that match multiple parents\n/// aren't supported, both for efficiency reasons and because Lezer\n/// trees make it rather hard to reason about what they would match.)\n///\n/// A path can be ended with `/...` to indicate that the tag assigned\n/// to the node should also apply to all child nodes, even if they\n/// match their own style (by default, only the innermost style is\n/// used).\n///\n/// When a path ends in `!`, as in `Attribute!`, no further matching\n/// happens for the node's child nodes, and the entire node gets the\n/// given style.\n///\n/// In this notation, node names that contain `/`, `!`, `*`, or `...`\n/// must be quoted as JSON strings.\n///\n/// For example:\n///\n/// ```javascript\n/// parser.withProps(\n///   styleTags({\n///     // Style Number and BigNumber nodes\n///     \"Number BigNumber\": tags.number,\n///     // Style Escape nodes whose parent is String\n///     \"String/Escape\": tags.escape,\n///     // Style anything inside Attributes nodes\n///     \"Attributes!\": tags.meta,\n///     // Add a style to all content inside Italic nodes\n///     \"Italic/...\": tags.emphasis,\n///     // Style InvalidString nodes as both `string` and `invalid`\n///     \"InvalidString\": [tags.string, tags.invalid],\n///     // Style the node named \"/\" as punctuation\n///     '\"/\"': tags.punctuation\n///   })\n/// )\n/// ```\nfunction styleTags(spec) {\n    let byName = Object.create(null);\n    for (let prop in spec) {\n        let tags = spec[prop];\n        if (!Array.isArray(tags))\n            tags = [tags];\n        for (let part of prop.split(\" \"))\n            if (part) {\n                let pieces = [], mode = 2 /* Mode.Normal */, rest = part;\n                for (let pos = 0;;) {\n                    if (rest == \"...\" && pos > 0 && pos + 3 == part.length) {\n                        mode = 1 /* Mode.Inherit */;\n                        break;\n                    }\n                    let m = /^\"(?:[^\"\\\\]|\\\\.)*?\"|[^\\/!]+/.exec(rest);\n                    if (!m)\n                        throw new RangeError(\"Invalid path: \" + part);\n                    pieces.push(m[0] == \"*\" ? \"\" : m[0][0] == '\"' ? JSON.parse(m[0]) : m[0]);\n                    pos += m[0].length;\n                    if (pos == part.length)\n                        break;\n                    let next = part[pos++];\n                    if (pos == part.length && next == \"!\") {\n                        mode = 0 /* Mode.Opaque */;\n                        break;\n                    }\n                    if (next != \"/\")\n                        throw new RangeError(\"Invalid path: \" + part);\n                    rest = part.slice(pos);\n                }\n                let last = pieces.length - 1, inner = pieces[last];\n                if (!inner)\n                    throw new RangeError(\"Invalid path: \" + part);\n                let rule = new Rule(tags, mode, last > 0 ? pieces.slice(0, last) : null);\n                byName[inner] = rule.sort(byName[inner]);\n            }\n    }\n    return ruleNodeProp.add(byName);\n}\nconst ruleNodeProp = new NodeProp();\nclass Rule {\n    constructor(tags, mode, context, next) {\n        this.tags = tags;\n        this.mode = mode;\n        this.context = context;\n        this.next = next;\n    }\n    get opaque() { return this.mode == 0 /* Mode.Opaque */; }\n    get inherit() { return this.mode == 1 /* Mode.Inherit */; }\n    sort(other) {\n        if (!other || other.depth < this.depth) {\n            this.next = other;\n            return this;\n        }\n        other.next = this.sort(other.next);\n        return other;\n    }\n    get depth() { return this.context ? this.context.length : 0; }\n}\nRule.empty = new Rule([], 2 /* Mode.Normal */, null);\n/// Define a [highlighter](#highlight.Highlighter) from an array of\n/// tag/class pairs. Classes associated with more specific tags will\n/// take precedence.\nfunction tagHighlighter(tags, options) {\n    let map = Object.create(null);\n    for (let style of tags) {\n        if (!Array.isArray(style.tag))\n            map[style.tag.id] = style.class;\n        else\n            for (let tag of style.tag)\n                map[tag.id] = style.class;\n    }\n    let { scope, all = null } = options || {};\n    return {\n        style: (tags) => {\n            let cls = all;\n            for (let tag of tags) {\n                for (let sub of tag.set) {\n                    let tagClass = map[sub.id];\n                    if (tagClass) {\n                        cls = cls ? cls + \" \" + tagClass : tagClass;\n                        break;\n                    }\n                }\n            }\n            return cls;\n        },\n        scope\n    };\n}\nfunction highlightTags(highlighters, tags) {\n    let result = null;\n    for (let highlighter of highlighters) {\n        let value = highlighter.style(tags);\n        if (value)\n            result = result ? result + \" \" + value : value;\n    }\n    return result;\n}\n/// Highlight the given [tree](#common.Tree) with the given\n/// [highlighter](#highlight.Highlighter).\nfunction highlightTree(tree, highlighter, \n/// Assign styling to a region of the text. Will be called, in order\n/// of position, for any ranges where more than zero classes apply.\n/// `classes` is a space separated string of CSS classes.\nputStyle, \n/// The start of the range to highlight.\nfrom = 0, \n/// The end of the range.\nto = tree.length) {\n    let builder = new HighlightBuilder(from, Array.isArray(highlighter) ? highlighter : [highlighter], putStyle);\n    builder.highlightRange(tree.cursor(), from, to, \"\", builder.highlighters);\n    builder.flush(to);\n}\nclass HighlightBuilder {\n    constructor(at, highlighters, span) {\n        this.at = at;\n        this.highlighters = highlighters;\n        this.span = span;\n        this.class = \"\";\n    }\n    startSpan(at, cls) {\n        if (cls != this.class) {\n            this.flush(at);\n            if (at > this.at)\n                this.at = at;\n            this.class = cls;\n        }\n    }\n    flush(to) {\n        if (to > this.at && this.class)\n            this.span(this.at, to, this.class);\n    }\n    highlightRange(cursor, from, to, inheritedClass, highlighters) {\n        let { type, from: start, to: end } = cursor;\n        if (start >= to || end <= from)\n            return;\n        if (type.isTop)\n            highlighters = this.highlighters.filter(h => !h.scope || h.scope(type));\n        let cls = inheritedClass;\n        let rule = getStyleTags(cursor) || Rule.empty;\n        let tagCls = highlightTags(highlighters, rule.tags);\n        if (tagCls) {\n            if (cls)\n                cls += \" \";\n            cls += tagCls;\n            if (rule.mode == 1 /* Mode.Inherit */)\n                inheritedClass += (inheritedClass ? \" \" : \"\") + tagCls;\n        }\n        this.startSpan(cursor.from, cls);\n        if (rule.opaque)\n            return;\n        let mounted = cursor.tree && cursor.tree.prop(NodeProp.mounted);\n        if (mounted && mounted.overlay) {\n            let inner = cursor.node.enter(mounted.overlay[0].from + start, 1);\n            let innerHighlighters = this.highlighters.filter(h => !h.scope || h.scope(mounted.tree.type));\n            let hasChild = cursor.firstChild();\n            for (let i = 0, pos = start;; i++) {\n                let next = i < mounted.overlay.length ? mounted.overlay[i] : null;\n                let nextPos = next ? next.from + start : end;\n                let rangeFrom = Math.max(from, pos), rangeTo = Math.min(to, nextPos);\n                if (rangeFrom < rangeTo && hasChild) {\n                    while (cursor.from < rangeTo) {\n                        this.highlightRange(cursor, rangeFrom, rangeTo, inheritedClass, highlighters);\n                        this.startSpan(Math.min(rangeTo, cursor.to), cls);\n                        if (cursor.to >= nextPos || !cursor.nextSibling())\n                            break;\n                    }\n                }\n                if (!next || nextPos > to)\n                    break;\n                pos = next.to + start;\n                if (pos > from) {\n                    this.highlightRange(inner.cursor(), Math.max(from, next.from + start), Math.min(to, pos), inheritedClass, innerHighlighters);\n                    this.startSpan(pos, cls);\n                }\n            }\n            if (hasChild)\n                cursor.parent();\n        }\n        else if (cursor.firstChild()) {\n            do {\n                if (cursor.to <= from)\n                    continue;\n                if (cursor.from >= to)\n                    break;\n                this.highlightRange(cursor, from, to, inheritedClass, highlighters);\n                this.startSpan(Math.min(to, cursor.to), cls);\n            } while (cursor.nextSibling());\n            cursor.parent();\n        }\n    }\n}\n/// Match a syntax node's [highlight rules](#highlight.styleTags). If\n/// there's a match, return its set of tags, and whether it is\n/// opaque (uses a `!`) or applies to all child nodes (`/...`).\nfunction getStyleTags(node) {\n    let rule = node.type.prop(ruleNodeProp);\n    while (rule && rule.context && !node.matchContext(rule.context))\n        rule = rule.next;\n    return rule || null;\n}\nconst t = Tag.define;\nconst comment = t(), name = t(), typeName = t(name), propertyName = t(name), literal = t(), string = t(literal), number = t(literal), content = t(), heading = t(content), keyword = t(), operator = t(), punctuation = t(), bracket = t(punctuation), meta = t();\n/// The default set of highlighting [tags](#highlight.Tag).\n///\n/// This collection is heavily biased towards programming languages,\n/// and necessarily incomplete. A full ontology of syntactic\n/// constructs would fill a stack of books, and be impractical to\n/// write themes for. So try to make do with this set. If all else\n/// fails, [open an\n/// issue](https://github.com/codemirror/codemirror.next) to propose a\n/// new tag, or [define](#highlight.Tag^define) a local custom tag for\n/// your use case.\n///\n/// Note that it is not obligatory to always attach the most specific\n/// tag possible to an element—if your grammar can't easily\n/// distinguish a certain type of element (such as a local variable),\n/// it is okay to style it as its more general variant (a variable).\n/// \n/// For tags that extend some parent tag, the documentation links to\n/// the parent.\nconst tags = {\n    /// A comment.\n    comment,\n    /// A line [comment](#highlight.tags.comment).\n    lineComment: t(comment),\n    /// A block [comment](#highlight.tags.comment).\n    blockComment: t(comment),\n    /// A documentation [comment](#highlight.tags.comment).\n    docComment: t(comment),\n    /// Any kind of identifier.\n    name,\n    /// The [name](#highlight.tags.name) of a variable.\n    variableName: t(name),\n    /// A type [name](#highlight.tags.name).\n    typeName: typeName,\n    /// A tag name (subtag of [`typeName`](#highlight.tags.typeName)).\n    tagName: t(typeName),\n    /// A property or field [name](#highlight.tags.name).\n    propertyName: propertyName,\n    /// An attribute name (subtag of [`propertyName`](#highlight.tags.propertyName)).\n    attributeName: t(propertyName),\n    /// The [name](#highlight.tags.name) of a class.\n    className: t(name),\n    /// A label [name](#highlight.tags.name).\n    labelName: t(name),\n    /// A namespace [name](#highlight.tags.name).\n    namespace: t(name),\n    /// The [name](#highlight.tags.name) of a macro.\n    macroName: t(name),\n    /// A literal value.\n    literal,\n    /// A string [literal](#highlight.tags.literal).\n    string,\n    /// A documentation [string](#highlight.tags.string).\n    docString: t(string),\n    /// A character literal (subtag of [string](#highlight.tags.string)).\n    character: t(string),\n    /// An attribute value (subtag of [string](#highlight.tags.string)).\n    attributeValue: t(string),\n    /// A number [literal](#highlight.tags.literal).\n    number,\n    /// An integer [number](#highlight.tags.number) literal.\n    integer: t(number),\n    /// A floating-point [number](#highlight.tags.number) literal.\n    float: t(number),\n    /// A boolean [literal](#highlight.tags.literal).\n    bool: t(literal),\n    /// Regular expression [literal](#highlight.tags.literal).\n    regexp: t(literal),\n    /// An escape [literal](#highlight.tags.literal), for example a\n    /// backslash escape in a string.\n    escape: t(literal),\n    /// A color [literal](#highlight.tags.literal).\n    color: t(literal),\n    /// A URL [literal](#highlight.tags.literal).\n    url: t(literal),\n    /// A language keyword.\n    keyword,\n    /// The [keyword](#highlight.tags.keyword) for the self or this\n    /// object.\n    self: t(keyword),\n    /// The [keyword](#highlight.tags.keyword) for null.\n    null: t(keyword),\n    /// A [keyword](#highlight.tags.keyword) denoting some atomic value.\n    atom: t(keyword),\n    /// A [keyword](#highlight.tags.keyword) that represents a unit.\n    unit: t(keyword),\n    /// A modifier [keyword](#highlight.tags.keyword).\n    modifier: t(keyword),\n    /// A [keyword](#highlight.tags.keyword) that acts as an operator.\n    operatorKeyword: t(keyword),\n    /// A control-flow related [keyword](#highlight.tags.keyword).\n    controlKeyword: t(keyword),\n    /// A [keyword](#highlight.tags.keyword) that defines something.\n    definitionKeyword: t(keyword),\n    /// A [keyword](#highlight.tags.keyword) related to defining or\n    /// interfacing with modules.\n    moduleKeyword: t(keyword),\n    /// An operator.\n    operator,\n    /// An [operator](#highlight.tags.operator) that dereferences something.\n    derefOperator: t(operator),\n    /// Arithmetic-related [operator](#highlight.tags.operator).\n    arithmeticOperator: t(operator),\n    /// Logical [operator](#highlight.tags.operator).\n    logicOperator: t(operator),\n    /// Bit [operator](#highlight.tags.operator).\n    bitwiseOperator: t(operator),\n    /// Comparison [operator](#highlight.tags.operator).\n    compareOperator: t(operator),\n    /// [Operator](#highlight.tags.operator) that updates its operand.\n    updateOperator: t(operator),\n    /// [Operator](#highlight.tags.operator) that defines something.\n    definitionOperator: t(operator),\n    /// Type-related [operator](#highlight.tags.operator).\n    typeOperator: t(operator),\n    /// Control-flow [operator](#highlight.tags.operator).\n    controlOperator: t(operator),\n    /// Program or markup punctuation.\n    punctuation,\n    /// [Punctuation](#highlight.tags.punctuation) that separates\n    /// things.\n    separator: t(punctuation),\n    /// Bracket-style [punctuation](#highlight.tags.punctuation).\n    bracket,\n    /// Angle [brackets](#highlight.tags.bracket) (usually `<` and `>`\n    /// tokens).\n    angleBracket: t(bracket),\n    /// Square [brackets](#highlight.tags.bracket) (usually `[` and `]`\n    /// tokens).\n    squareBracket: t(bracket),\n    /// Parentheses (usually `(` and `)` tokens). Subtag of\n    /// [bracket](#highlight.tags.bracket).\n    paren: t(bracket),\n    /// Braces (usually `{` and `}` tokens). Subtag of\n    /// [bracket](#highlight.tags.bracket).\n    brace: t(bracket),\n    /// Content, for example plain text in XML or markup documents.\n    content,\n    /// [Content](#highlight.tags.content) that represents a heading.\n    heading,\n    /// A level 1 [heading](#highlight.tags.heading).\n    heading1: t(heading),\n    /// A level 2 [heading](#highlight.tags.heading).\n    heading2: t(heading),\n    /// A level 3 [heading](#highlight.tags.heading).\n    heading3: t(heading),\n    /// A level 4 [heading](#highlight.tags.heading).\n    heading4: t(heading),\n    /// A level 5 [heading](#highlight.tags.heading).\n    heading5: t(heading),\n    /// A level 6 [heading](#highlight.tags.heading).\n    heading6: t(heading),\n    /// A prose separator (such as a horizontal rule).\n    contentSeparator: t(content),\n    /// [Content](#highlight.tags.content) that represents a list.\n    list: t(content),\n    /// [Content](#highlight.tags.content) that represents a quote.\n    quote: t(content),\n    /// [Content](#highlight.tags.content) that is emphasized.\n    emphasis: t(content),\n    /// [Content](#highlight.tags.content) that is styled strong.\n    strong: t(content),\n    /// [Content](#highlight.tags.content) that is part of a link.\n    link: t(content),\n    /// [Content](#highlight.tags.content) that is styled as code or\n    /// monospace.\n    monospace: t(content),\n    /// [Content](#highlight.tags.content) that has a strike-through\n    /// style.\n    strikethrough: t(content),\n    /// Inserted text in a change-tracking format.\n    inserted: t(),\n    /// Deleted text.\n    deleted: t(),\n    /// Changed text.\n    changed: t(),\n    /// An invalid or unsyntactic element.\n    invalid: t(),\n    /// Metadata or meta-instruction.\n    meta,\n    /// [Metadata](#highlight.tags.meta) that applies to the entire\n    /// document.\n    documentMeta: t(meta),\n    /// [Metadata](#highlight.tags.meta) that annotates or adds\n    /// attributes to a given syntactic element.\n    annotation: t(meta),\n    /// Processing instruction or preprocessor directive. Subtag of\n    /// [meta](#highlight.tags.meta).\n    processingInstruction: t(meta),\n    /// [Modifier](#highlight.Tag^defineModifier) that indicates that a\n    /// given element is being defined. Expected to be used with the\n    /// various [name](#highlight.tags.name) tags.\n    definition: Tag.defineModifier(),\n    /// [Modifier](#highlight.Tag^defineModifier) that indicates that\n    /// something is constant. Mostly expected to be used with\n    /// [variable names](#highlight.tags.variableName).\n    constant: Tag.defineModifier(),\n    /// [Modifier](#highlight.Tag^defineModifier) used to indicate that\n    /// a [variable](#highlight.tags.variableName) or [property\n    /// name](#highlight.tags.propertyName) is being called or defined\n    /// as a function.\n    function: Tag.defineModifier(),\n    /// [Modifier](#highlight.Tag^defineModifier) that can be applied to\n    /// [names](#highlight.tags.name) to indicate that they belong to\n    /// the language's standard environment.\n    standard: Tag.defineModifier(),\n    /// [Modifier](#highlight.Tag^defineModifier) that indicates a given\n    /// [names](#highlight.tags.name) is local to some scope.\n    local: Tag.defineModifier(),\n    /// A generic variant [modifier](#highlight.Tag^defineModifier) that\n    /// can be used to tag language-specific alternative variants of\n    /// some common tag. It is recommended for themes to define special\n    /// forms of at least the [string](#highlight.tags.string) and\n    /// [variable name](#highlight.tags.variableName) tags, since those\n    /// come up a lot.\n    special: Tag.defineModifier()\n};\n/// This is a highlighter that adds stable, predictable classes to\n/// tokens, for styling with external CSS.\n///\n/// The following tags are mapped to their name prefixed with `\"tok-\"`\n/// (for example `\"tok-comment\"`):\n///\n/// * [`link`](#highlight.tags.link)\n/// * [`heading`](#highlight.tags.heading)\n/// * [`emphasis`](#highlight.tags.emphasis)\n/// * [`strong`](#highlight.tags.strong)\n/// * [`keyword`](#highlight.tags.keyword)\n/// * [`atom`](#highlight.tags.atom)\n/// * [`bool`](#highlight.tags.bool)\n/// * [`url`](#highlight.tags.url)\n/// * [`labelName`](#highlight.tags.labelName)\n/// * [`inserted`](#highlight.tags.inserted)\n/// * [`deleted`](#highlight.tags.deleted)\n/// * [`literal`](#highlight.tags.literal)\n/// * [`string`](#highlight.tags.string)\n/// * [`number`](#highlight.tags.number)\n/// * [`variableName`](#highlight.tags.variableName)\n/// * [`typeName`](#highlight.tags.typeName)\n/// * [`namespace`](#highlight.tags.namespace)\n/// * [`className`](#highlight.tags.className)\n/// * [`macroName`](#highlight.tags.macroName)\n/// * [`propertyName`](#highlight.tags.propertyName)\n/// * [`operator`](#highlight.tags.operator)\n/// * [`comment`](#highlight.tags.comment)\n/// * [`meta`](#highlight.tags.meta)\n/// * [`punctuation`](#highlight.tags.punctuation)\n/// * [`invalid`](#highlight.tags.invalid)\n///\n/// In addition, these mappings are provided:\n///\n/// * [`regexp`](#highlight.tags.regexp),\n///   [`escape`](#highlight.tags.escape), and\n///   [`special`](#highlight.tags.special)[`(string)`](#highlight.tags.string)\n///   are mapped to `\"tok-string2\"`\n/// * [`special`](#highlight.tags.special)[`(variableName)`](#highlight.tags.variableName)\n///   to `\"tok-variableName2\"`\n/// * [`local`](#highlight.tags.local)[`(variableName)`](#highlight.tags.variableName)\n///   to `\"tok-variableName tok-local\"`\n/// * [`definition`](#highlight.tags.definition)[`(variableName)`](#highlight.tags.variableName)\n///   to `\"tok-variableName tok-definition\"`\n/// * [`definition`](#highlight.tags.definition)[`(propertyName)`](#highlight.tags.propertyName)\n///   to `\"tok-propertyName tok-definition\"`\nconst classHighlighter = tagHighlighter([\n    { tag: tags.link, class: \"tok-link\" },\n    { tag: tags.heading, class: \"tok-heading\" },\n    { tag: tags.emphasis, class: \"tok-emphasis\" },\n    { tag: tags.strong, class: \"tok-strong\" },\n    { tag: tags.keyword, class: \"tok-keyword\" },\n    { tag: tags.atom, class: \"tok-atom\" },\n    { tag: tags.bool, class: \"tok-bool\" },\n    { tag: tags.url, class: \"tok-url\" },\n    { tag: tags.labelName, class: \"tok-labelName\" },\n    { tag: tags.inserted, class: \"tok-inserted\" },\n    { tag: tags.deleted, class: \"tok-deleted\" },\n    { tag: tags.literal, class: \"tok-literal\" },\n    { tag: tags.string, class: \"tok-string\" },\n    { tag: tags.number, class: \"tok-number\" },\n    { tag: [tags.regexp, tags.escape, tags.special(tags.string)], class: \"tok-string2\" },\n    { tag: tags.variableName, class: \"tok-variableName\" },\n    { tag: tags.local(tags.variableName), class: \"tok-variableName tok-local\" },\n    { tag: tags.definition(tags.variableName), class: \"tok-variableName tok-definition\" },\n    { tag: tags.special(tags.variableName), class: \"tok-variableName2\" },\n    { tag: tags.definition(tags.propertyName), class: \"tok-propertyName tok-definition\" },\n    { tag: tags.typeName, class: \"tok-typeName\" },\n    { tag: tags.namespace, class: \"tok-namespace\" },\n    { tag: tags.className, class: \"tok-className\" },\n    { tag: tags.macroName, class: \"tok-macroName\" },\n    { tag: tags.propertyName, class: \"tok-propertyName\" },\n    { tag: tags.operator, class: \"tok-operator\" },\n    { tag: tags.comment, class: \"tok-comment\" },\n    { tag: tags.meta, class: \"tok-meta\" },\n    { tag: tags.invalid, class: \"tok-invalid\" },\n    { tag: tags.punctuation, class: \"tok-punctuation\" }\n]);\n\nexport { Tag, classHighlighter, getStyleTags, highlightTree, styleTags, tagHighlighter, tags };\n","import { NodeProp, IterMode, Tree, TreeFragment, Parser, NodeType, NodeSet } from '@lezer/common';\nimport { StateEffect, StateField, Facet, EditorState, countColumn, combineConfig, RangeSet, RangeSetBuilder, Prec } from '@codemirror/state';\nimport { ViewPlugin, logException, EditorView, Decoration, WidgetType, gutter, GutterMarker } from '@codemirror/view';\nimport { tags, tagHighlighter, highlightTree, styleTags } from '@lezer/highlight';\nimport { StyleModule } from 'style-mod';\n\nvar _a;\n/**\nNode prop stored in a parser's top syntax node to provide the\nfacet that stores language-specific data for that language.\n*/\nconst languageDataProp = /*@__PURE__*/new NodeProp();\n/**\nHelper function to define a facet (to be added to the top syntax\nnode(s) for a language via\n[`languageDataProp`](https://codemirror.net/6/docs/ref/#language.languageDataProp)), that will be\nused to associate language data with the language. You\nprobably only need this when subclassing\n[`Language`](https://codemirror.net/6/docs/ref/#language.Language).\n*/\nfunction defineLanguageFacet(baseData) {\n    return Facet.define({\n        combine: baseData ? values => values.concat(baseData) : undefined\n    });\n}\n/**\nSyntax node prop used to register sublangauges. Should be added to\nthe top level node type for the language.\n*/\nconst sublanguageProp = /*@__PURE__*/new NodeProp();\n/**\nA language object manages parsing and per-language\n[metadata](https://codemirror.net/6/docs/ref/#state.EditorState.languageDataAt). Parse data is\nmanaged as a [Lezer](https://lezer.codemirror.net) tree. The class\ncan be used directly, via the [`LRLanguage`](https://codemirror.net/6/docs/ref/#language.LRLanguage)\nsubclass for [Lezer](https://lezer.codemirror.net/) LR parsers, or\nvia the [`StreamLanguage`](https://codemirror.net/6/docs/ref/#language.StreamLanguage) subclass\nfor stream parsers.\n*/\nclass Language {\n    /**\n    Construct a language object. If you need to invoke this\n    directly, first define a data facet with\n    [`defineLanguageFacet`](https://codemirror.net/6/docs/ref/#language.defineLanguageFacet), and then\n    configure your parser to [attach](https://codemirror.net/6/docs/ref/#language.languageDataProp) it\n    to the language's outer syntax node.\n    */\n    constructor(\n    /**\n    The [language data](https://codemirror.net/6/docs/ref/#state.EditorState.languageDataAt) facet\n    used for this language.\n    */\n    data, parser, extraExtensions = [], \n    /**\n    A language name.\n    */\n    name = \"\") {\n        this.data = data;\n        this.name = name;\n        // Kludge to define EditorState.tree as a debugging helper,\n        // without the EditorState package actually knowing about\n        // languages and lezer trees.\n        if (!EditorState.prototype.hasOwnProperty(\"tree\"))\n            Object.defineProperty(EditorState.prototype, \"tree\", { get() { return syntaxTree(this); } });\n        this.parser = parser;\n        this.extension = [\n            language.of(this),\n            EditorState.languageData.of((state, pos, side) => {\n                let top = topNodeAt(state, pos, side), data = top.type.prop(languageDataProp);\n                if (!data)\n                    return [];\n                let base = state.facet(data), sub = top.type.prop(sublanguageProp);\n                if (sub) {\n                    let innerNode = top.resolve(pos - top.from, side);\n                    for (let sublang of sub)\n                        if (sublang.test(innerNode, state)) {\n                            let data = state.facet(sublang.facet);\n                            return sublang.type == \"replace\" ? data : data.concat(base);\n                        }\n                }\n                return base;\n            })\n        ].concat(extraExtensions);\n    }\n    /**\n    Query whether this language is active at the given position.\n    */\n    isActiveAt(state, pos, side = -1) {\n        return topNodeAt(state, pos, side).type.prop(languageDataProp) == this.data;\n    }\n    /**\n    Find the document regions that were parsed using this language.\n    The returned regions will _include_ any nested languages rooted\n    in this language, when those exist.\n    */\n    findRegions(state) {\n        let lang = state.facet(language);\n        if ((lang === null || lang === void 0 ? void 0 : lang.data) == this.data)\n            return [{ from: 0, to: state.doc.length }];\n        if (!lang || !lang.allowsNesting)\n            return [];\n        let result = [];\n        let explore = (tree, from) => {\n            if (tree.prop(languageDataProp) == this.data) {\n                result.push({ from, to: from + tree.length });\n                return;\n            }\n            let mount = tree.prop(NodeProp.mounted);\n            if (mount) {\n                if (mount.tree.prop(languageDataProp) == this.data) {\n                    if (mount.overlay)\n                        for (let r of mount.overlay)\n                            result.push({ from: r.from + from, to: r.to + from });\n                    else\n                        result.push({ from: from, to: from + tree.length });\n                    return;\n                }\n                else if (mount.overlay) {\n                    let size = result.length;\n                    explore(mount.tree, mount.overlay[0].from + from);\n                    if (result.length > size)\n                        return;\n                }\n            }\n            for (let i = 0; i < tree.children.length; i++) {\n                let ch = tree.children[i];\n                if (ch instanceof Tree)\n                    explore(ch, tree.positions[i] + from);\n            }\n        };\n        explore(syntaxTree(state), 0);\n        return result;\n    }\n    /**\n    Indicates whether this language allows nested languages. The\n    default implementation returns true.\n    */\n    get allowsNesting() { return true; }\n}\n/**\n@internal\n*/\nLanguage.setState = /*@__PURE__*/StateEffect.define();\nfunction topNodeAt(state, pos, side) {\n    let topLang = state.facet(language), tree = syntaxTree(state).topNode;\n    if (!topLang || topLang.allowsNesting) {\n        for (let node = tree; node; node = node.enter(pos, side, IterMode.ExcludeBuffers))\n            if (node.type.isTop)\n                tree = node;\n    }\n    return tree;\n}\n/**\nA subclass of [`Language`](https://codemirror.net/6/docs/ref/#language.Language) for use with Lezer\n[LR parsers](https://lezer.codemirror.net/docs/ref#lr.LRParser)\nparsers.\n*/\nclass LRLanguage extends Language {\n    constructor(data, parser, name) {\n        super(data, parser, [], name);\n        this.parser = parser;\n    }\n    /**\n    Define a language from a parser.\n    */\n    static define(spec) {\n        let data = defineLanguageFacet(spec.languageData);\n        return new LRLanguage(data, spec.parser.configure({\n            props: [languageDataProp.add(type => type.isTop ? data : undefined)]\n        }), spec.name);\n    }\n    /**\n    Create a new instance of this language with a reconfigured\n    version of its parser and optionally a new name.\n    */\n    configure(options, name) {\n        return new LRLanguage(this.data, this.parser.configure(options), name || this.name);\n    }\n    get allowsNesting() { return this.parser.hasWrappers(); }\n}\n/**\nGet the syntax tree for a state, which is the current (possibly\nincomplete) parse tree of the active\n[language](https://codemirror.net/6/docs/ref/#language.Language), or the empty tree if there is no\nlanguage available.\n*/\nfunction syntaxTree(state) {\n    let field = state.field(Language.state, false);\n    return field ? field.tree : Tree.empty;\n}\n/**\nTry to get a parse tree that spans at least up to `upto`. The\nmethod will do at most `timeout` milliseconds of work to parse\nup to that point if the tree isn't already available.\n*/\nfunction ensureSyntaxTree(state, upto, timeout = 50) {\n    var _a;\n    let parse = (_a = state.field(Language.state, false)) === null || _a === void 0 ? void 0 : _a.context;\n    if (!parse)\n        return null;\n    let oldVieport = parse.viewport;\n    parse.updateViewport({ from: 0, to: upto });\n    let result = parse.isDone(upto) || parse.work(timeout, upto) ? parse.tree : null;\n    parse.updateViewport(oldVieport);\n    return result;\n}\n/**\nQueries whether there is a full syntax tree available up to the\ngiven document position. If there isn't, the background parse\nprocess _might_ still be working and update the tree further, but\nthere is no guarantee of that—the parser will [stop\nworking](https://codemirror.net/6/docs/ref/#language.syntaxParserRunning) when it has spent a\ncertain amount of time or has moved beyond the visible viewport.\nAlways returns false if no language has been enabled.\n*/\nfunction syntaxTreeAvailable(state, upto = state.doc.length) {\n    var _a;\n    return ((_a = state.field(Language.state, false)) === null || _a === void 0 ? void 0 : _a.context.isDone(upto)) || false;\n}\n/**\nMove parsing forward, and update the editor state afterwards to\nreflect the new tree. Will work for at most `timeout`\nmilliseconds. Returns true if the parser managed get to the given\nposition in that time.\n*/\nfunction forceParsing(view, upto = view.viewport.to, timeout = 100) {\n    let success = ensureSyntaxTree(view.state, upto, timeout);\n    if (success != syntaxTree(view.state))\n        view.dispatch({});\n    return !!success;\n}\n/**\nTells you whether the language parser is planning to do more\nparsing work (in a `requestIdleCallback` pseudo-thread) or has\nstopped running, either because it parsed the entire document,\nbecause it spent too much time and was cut off, or because there\nis no language parser enabled.\n*/\nfunction syntaxParserRunning(view) {\n    var _a;\n    return ((_a = view.plugin(parseWorker)) === null || _a === void 0 ? void 0 : _a.isWorking()) || false;\n}\n// Lezer-style Input object for a Text document.\nclass DocInput {\n    constructor(doc) {\n        this.doc = doc;\n        this.cursorPos = 0;\n        this.string = \"\";\n        this.cursor = doc.iter();\n    }\n    get length() { return this.doc.length; }\n    syncTo(pos) {\n        this.string = this.cursor.next(pos - this.cursorPos).value;\n        this.cursorPos = pos + this.string.length;\n        return this.cursorPos - this.string.length;\n    }\n    chunk(pos) {\n        this.syncTo(pos);\n        return this.string;\n    }\n    get lineChunks() { return true; }\n    read(from, to) {\n        let stringStart = this.cursorPos - this.string.length;\n        if (from < stringStart || to >= this.cursorPos)\n            return this.doc.sliceString(from, to);\n        else\n            return this.string.slice(from - stringStart, to - stringStart);\n    }\n}\nlet currentContext = null;\n/**\nA parse context provided to parsers working on the editor content.\n*/\nclass ParseContext {\n    constructor(parser, \n    /**\n    The current editor state.\n    */\n    state, \n    /**\n    Tree fragments that can be reused by incremental re-parses.\n    */\n    fragments = [], \n    /**\n    @internal\n    */\n    tree, \n    /**\n    @internal\n    */\n    treeLen, \n    /**\n    The current editor viewport (or some overapproximation\n    thereof). Intended to be used for opportunistically avoiding\n    work (in which case\n    [`skipUntilInView`](https://codemirror.net/6/docs/ref/#language.ParseContext.skipUntilInView)\n    should be called to make sure the parser is restarted when the\n    skipped region becomes visible).\n    */\n    viewport, \n    /**\n    @internal\n    */\n    skipped, \n    /**\n    This is where skipping parsers can register a promise that,\n    when resolved, will schedule a new parse. It is cleared when\n    the parse worker picks up the promise. @internal\n    */\n    scheduleOn) {\n        this.parser = parser;\n        this.state = state;\n        this.fragments = fragments;\n        this.tree = tree;\n        this.treeLen = treeLen;\n        this.viewport = viewport;\n        this.skipped = skipped;\n        this.scheduleOn = scheduleOn;\n        this.parse = null;\n        /**\n        @internal\n        */\n        this.tempSkipped = [];\n    }\n    /**\n    @internal\n    */\n    static create(parser, state, viewport) {\n        return new ParseContext(parser, state, [], Tree.empty, 0, viewport, [], null);\n    }\n    startParse() {\n        return this.parser.startParse(new DocInput(this.state.doc), this.fragments);\n    }\n    /**\n    @internal\n    */\n    work(until, upto) {\n        if (upto != null && upto >= this.state.doc.length)\n            upto = undefined;\n        if (this.tree != Tree.empty && this.isDone(upto !== null && upto !== void 0 ? upto : this.state.doc.length)) {\n            this.takeTree();\n            return true;\n        }\n        return this.withContext(() => {\n            var _a;\n            if (typeof until == \"number\") {\n                let endTime = Date.now() + until;\n                until = () => Date.now() > endTime;\n            }\n            if (!this.parse)\n                this.parse = this.startParse();\n            if (upto != null && (this.parse.stoppedAt == null || this.parse.stoppedAt > upto) &&\n                upto < this.state.doc.length)\n                this.parse.stopAt(upto);\n            for (;;) {\n                let done = this.parse.advance();\n                if (done) {\n                    this.fragments = this.withoutTempSkipped(TreeFragment.addTree(done, this.fragments, this.parse.stoppedAt != null));\n                    this.treeLen = (_a = this.parse.stoppedAt) !== null && _a !== void 0 ? _a : this.state.doc.length;\n                    this.tree = done;\n                    this.parse = null;\n                    if (this.treeLen < (upto !== null && upto !== void 0 ? upto : this.state.doc.length))\n                        this.parse = this.startParse();\n                    else\n                        return true;\n                }\n                if (until())\n                    return false;\n            }\n        });\n    }\n    /**\n    @internal\n    */\n    takeTree() {\n        let pos, tree;\n        if (this.parse && (pos = this.parse.parsedPos) >= this.treeLen) {\n            if (this.parse.stoppedAt == null || this.parse.stoppedAt > pos)\n                this.parse.stopAt(pos);\n            this.withContext(() => { while (!(tree = this.parse.advance())) { } });\n            this.treeLen = pos;\n            this.tree = tree;\n            this.fragments = this.withoutTempSkipped(TreeFragment.addTree(this.tree, this.fragments, true));\n            this.parse = null;\n        }\n    }\n    withContext(f) {\n        let prev = currentContext;\n        currentContext = this;\n        try {\n            return f();\n        }\n        finally {\n            currentContext = prev;\n        }\n    }\n    withoutTempSkipped(fragments) {\n        for (let r; r = this.tempSkipped.pop();)\n            fragments = cutFragments(fragments, r.from, r.to);\n        return fragments;\n    }\n    /**\n    @internal\n    */\n    changes(changes, newState) {\n        let { fragments, tree, treeLen, viewport, skipped } = this;\n        this.takeTree();\n        if (!changes.empty) {\n            let ranges = [];\n            changes.iterChangedRanges((fromA, toA, fromB, toB) => ranges.push({ fromA, toA, fromB, toB }));\n            fragments = TreeFragment.applyChanges(fragments, ranges);\n            tree = Tree.empty;\n            treeLen = 0;\n            viewport = { from: changes.mapPos(viewport.from, -1), to: changes.mapPos(viewport.to, 1) };\n            if (this.skipped.length) {\n                skipped = [];\n                for (let r of this.skipped) {\n                    let from = changes.mapPos(r.from, 1), to = changes.mapPos(r.to, -1);\n                    if (from < to)\n                        skipped.push({ from, to });\n                }\n            }\n        }\n        return new ParseContext(this.parser, newState, fragments, tree, treeLen, viewport, skipped, this.scheduleOn);\n    }\n    /**\n    @internal\n    */\n    updateViewport(viewport) {\n        if (this.viewport.from == viewport.from && this.viewport.to == viewport.to)\n            return false;\n        this.viewport = viewport;\n        let startLen = this.skipped.length;\n        for (let i = 0; i < this.skipped.length; i++) {\n            let { from, to } = this.skipped[i];\n            if (from < viewport.to && to > viewport.from) {\n                this.fragments = cutFragments(this.fragments, from, to);\n                this.skipped.splice(i--, 1);\n            }\n        }\n        if (this.skipped.length >= startLen)\n            return false;\n        this.reset();\n        return true;\n    }\n    /**\n    @internal\n    */\n    reset() {\n        if (this.parse) {\n            this.takeTree();\n            this.parse = null;\n        }\n    }\n    /**\n    Notify the parse scheduler that the given region was skipped\n    because it wasn't in view, and the parse should be restarted\n    when it comes into view.\n    */\n    skipUntilInView(from, to) {\n        this.skipped.push({ from, to });\n    }\n    /**\n    Returns a parser intended to be used as placeholder when\n    asynchronously loading a nested parser. It'll skip its input and\n    mark it as not-really-parsed, so that the next update will parse\n    it again.\n    \n    When `until` is given, a reparse will be scheduled when that\n    promise resolves.\n    */\n    static getSkippingParser(until) {\n        return new class extends Parser {\n            createParse(input, fragments, ranges) {\n                let from = ranges[0].from, to = ranges[ranges.length - 1].to;\n                let parser = {\n                    parsedPos: from,\n                    advance() {\n                        let cx = currentContext;\n                        if (cx) {\n                            for (let r of ranges)\n                                cx.tempSkipped.push(r);\n                            if (until)\n                                cx.scheduleOn = cx.scheduleOn ? Promise.all([cx.scheduleOn, until]) : until;\n                        }\n                        this.parsedPos = to;\n                        return new Tree(NodeType.none, [], [], to - from);\n                    },\n                    stoppedAt: null,\n                    stopAt() { }\n                };\n                return parser;\n            }\n        };\n    }\n    /**\n    @internal\n    */\n    isDone(upto) {\n        upto = Math.min(upto, this.state.doc.length);\n        let frags = this.fragments;\n        return this.treeLen >= upto && frags.length && frags[0].from == 0 && frags[0].to >= upto;\n    }\n    /**\n    Get the context for the current parse, or `null` if no editor\n    parse is in progress.\n    */\n    static get() { return currentContext; }\n}\nfunction cutFragments(fragments, from, to) {\n    return TreeFragment.applyChanges(fragments, [{ fromA: from, toA: to, fromB: from, toB: to }]);\n}\nclass LanguageState {\n    constructor(\n    // A mutable parse state that is used to preserve work done during\n    // the lifetime of a state when moving to the next state.\n    context) {\n        this.context = context;\n        this.tree = context.tree;\n    }\n    apply(tr) {\n        if (!tr.docChanged && this.tree == this.context.tree)\n            return this;\n        let newCx = this.context.changes(tr.changes, tr.state);\n        // If the previous parse wasn't done, go forward only up to its\n        // end position or the end of the viewport, to avoid slowing down\n        // state updates with parse work beyond the viewport.\n        let upto = this.context.treeLen == tr.startState.doc.length ? undefined\n            : Math.max(tr.changes.mapPos(this.context.treeLen), newCx.viewport.to);\n        if (!newCx.work(20 /* Work.Apply */, upto))\n            newCx.takeTree();\n        return new LanguageState(newCx);\n    }\n    static init(state) {\n        let vpTo = Math.min(3000 /* Work.InitViewport */, state.doc.length);\n        let parseState = ParseContext.create(state.facet(language).parser, state, { from: 0, to: vpTo });\n        if (!parseState.work(20 /* Work.Apply */, vpTo))\n            parseState.takeTree();\n        return new LanguageState(parseState);\n    }\n}\nLanguage.state = /*@__PURE__*/StateField.define({\n    create: LanguageState.init,\n    update(value, tr) {\n        for (let e of tr.effects)\n            if (e.is(Language.setState))\n                return e.value;\n        if (tr.startState.facet(language) != tr.state.facet(language))\n            return LanguageState.init(tr.state);\n        return value.apply(tr);\n    }\n});\nlet requestIdle = (callback) => {\n    let timeout = setTimeout(() => callback(), 500 /* Work.MaxPause */);\n    return () => clearTimeout(timeout);\n};\nif (typeof requestIdleCallback != \"undefined\")\n    requestIdle = (callback) => {\n        let idle = -1, timeout = setTimeout(() => {\n            idle = requestIdleCallback(callback, { timeout: 500 /* Work.MaxPause */ - 100 /* Work.MinPause */ });\n        }, 100 /* Work.MinPause */);\n        return () => idle < 0 ? clearTimeout(timeout) : cancelIdleCallback(idle);\n    };\nconst isInputPending = typeof navigator != \"undefined\" && ((_a = navigator.scheduling) === null || _a === void 0 ? void 0 : _a.isInputPending)\n    ? () => navigator.scheduling.isInputPending() : null;\nconst parseWorker = /*@__PURE__*/ViewPlugin.fromClass(class ParseWorker {\n    constructor(view) {\n        this.view = view;\n        this.working = null;\n        this.workScheduled = 0;\n        // End of the current time chunk\n        this.chunkEnd = -1;\n        // Milliseconds of budget left for this chunk\n        this.chunkBudget = -1;\n        this.work = this.work.bind(this);\n        this.scheduleWork();\n    }\n    update(update) {\n        let cx = this.view.state.field(Language.state).context;\n        if (cx.updateViewport(update.view.viewport) || this.view.viewport.to > cx.treeLen)\n            this.scheduleWork();\n        if (update.docChanged) {\n            if (this.view.hasFocus)\n                this.chunkBudget += 50 /* Work.ChangeBonus */;\n            this.scheduleWork();\n        }\n        this.checkAsyncSchedule(cx);\n    }\n    scheduleWork() {\n        if (this.working)\n            return;\n        let { state } = this.view, field = state.field(Language.state);\n        if (field.tree != field.context.tree || !field.context.isDone(state.doc.length))\n            this.working = requestIdle(this.work);\n    }\n    work(deadline) {\n        this.working = null;\n        let now = Date.now();\n        if (this.chunkEnd < now && (this.chunkEnd < 0 || this.view.hasFocus)) { // Start a new chunk\n            this.chunkEnd = now + 30000 /* Work.ChunkTime */;\n            this.chunkBudget = 3000 /* Work.ChunkBudget */;\n        }\n        if (this.chunkBudget <= 0)\n            return; // No more budget\n        let { state, viewport: { to: vpTo } } = this.view, field = state.field(Language.state);\n        if (field.tree == field.context.tree && field.context.isDone(vpTo + 100000 /* Work.MaxParseAhead */))\n            return;\n        let endTime = Date.now() + Math.min(this.chunkBudget, 100 /* Work.Slice */, deadline && !isInputPending ? Math.max(25 /* Work.MinSlice */, deadline.timeRemaining() - 5) : 1e9);\n        let viewportFirst = field.context.treeLen < vpTo && state.doc.length > vpTo + 1000;\n        let done = field.context.work(() => {\n            return isInputPending && isInputPending() || Date.now() > endTime;\n        }, vpTo + (viewportFirst ? 0 : 100000 /* Work.MaxParseAhead */));\n        this.chunkBudget -= Date.now() - now;\n        if (done || this.chunkBudget <= 0) {\n            field.context.takeTree();\n            this.view.dispatch({ effects: Language.setState.of(new LanguageState(field.context)) });\n        }\n        if (this.chunkBudget > 0 && !(done && !viewportFirst))\n            this.scheduleWork();\n        this.checkAsyncSchedule(field.context);\n    }\n    checkAsyncSchedule(cx) {\n        if (cx.scheduleOn) {\n            this.workScheduled++;\n            cx.scheduleOn\n                .then(() => this.scheduleWork())\n                .catch(err => logException(this.view.state, err))\n                .then(() => this.workScheduled--);\n            cx.scheduleOn = null;\n        }\n    }\n    destroy() {\n        if (this.working)\n            this.working();\n    }\n    isWorking() {\n        return !!(this.working || this.workScheduled > 0);\n    }\n}, {\n    eventHandlers: { focus() { this.scheduleWork(); } }\n});\n/**\nThe facet used to associate a language with an editor state. Used\nby `Language` object's `extension` property (so you don't need to\nmanually wrap your languages in this). Can be used to access the\ncurrent language on a state.\n*/\nconst language = /*@__PURE__*/Facet.define({\n    combine(languages) { return languages.length ? languages[0] : null; },\n    enables: language => [\n        Language.state,\n        parseWorker,\n        EditorView.contentAttributes.compute([language], state => {\n            let lang = state.facet(language);\n            return lang && lang.name ? { \"data-language\": lang.name } : {};\n        })\n    ]\n});\n/**\nThis class bundles a [language](https://codemirror.net/6/docs/ref/#language.Language) with an\noptional set of supporting extensions. Language packages are\nencouraged to export a function that optionally takes a\nconfiguration object and returns a `LanguageSupport` instance, as\nthe main way for client code to use the package.\n*/\nclass LanguageSupport {\n    /**\n    Create a language support object.\n    */\n    constructor(\n    /**\n    The language object.\n    */\n    language, \n    /**\n    An optional set of supporting extensions. When nesting a\n    language in another language, the outer language is encouraged\n    to include the supporting extensions for its inner languages\n    in its own set of support extensions.\n    */\n    support = []) {\n        this.language = language;\n        this.support = support;\n        this.extension = [language, support];\n    }\n}\n/**\nLanguage descriptions are used to store metadata about languages\nand to dynamically load them. Their main role is finding the\nappropriate language for a filename or dynamically loading nested\nparsers.\n*/\nclass LanguageDescription {\n    constructor(\n    /**\n    The name of this language.\n    */\n    name, \n    /**\n    Alternative names for the mode (lowercased, includes `this.name`).\n    */\n    alias, \n    /**\n    File extensions associated with this language.\n    */\n    extensions, \n    /**\n    Optional filename pattern that should be associated with this\n    language.\n    */\n    filename, loadFunc, \n    /**\n    If the language has been loaded, this will hold its value.\n    */\n    support = undefined) {\n        this.name = name;\n        this.alias = alias;\n        this.extensions = extensions;\n        this.filename = filename;\n        this.loadFunc = loadFunc;\n        this.support = support;\n        this.loading = null;\n    }\n    /**\n    Start loading the the language. Will return a promise that\n    resolves to a [`LanguageSupport`](https://codemirror.net/6/docs/ref/#language.LanguageSupport)\n    object when the language successfully loads.\n    */\n    load() {\n        return this.loading || (this.loading = this.loadFunc().then(support => this.support = support, err => { this.loading = null; throw err; }));\n    }\n    /**\n    Create a language description.\n    */\n    static of(spec) {\n        let { load, support } = spec;\n        if (!load) {\n            if (!support)\n                throw new RangeError(\"Must pass either 'load' or 'support' to LanguageDescription.of\");\n            load = () => Promise.resolve(support);\n        }\n        return new LanguageDescription(spec.name, (spec.alias || []).concat(spec.name).map(s => s.toLowerCase()), spec.extensions || [], spec.filename, load, support);\n    }\n    /**\n    Look for a language in the given array of descriptions that\n    matches the filename. Will first match\n    [`filename`](https://codemirror.net/6/docs/ref/#language.LanguageDescription.filename) patterns,\n    and then [extensions](https://codemirror.net/6/docs/ref/#language.LanguageDescription.extensions),\n    and return the first language that matches.\n    */\n    static matchFilename(descs, filename) {\n        for (let d of descs)\n            if (d.filename && d.filename.test(filename))\n                return d;\n        let ext = /\\.([^.]+)$/.exec(filename);\n        if (ext)\n            for (let d of descs)\n                if (d.extensions.indexOf(ext[1]) > -1)\n                    return d;\n        return null;\n    }\n    /**\n    Look for a language whose name or alias matches the the given\n    name (case-insensitively). If `fuzzy` is true, and no direct\n    matchs is found, this'll also search for a language whose name\n    or alias occurs in the string (for names shorter than three\n    characters, only when surrounded by non-word characters).\n    */\n    static matchLanguageName(descs, name, fuzzy = true) {\n        name = name.toLowerCase();\n        for (let d of descs)\n            if (d.alias.some(a => a == name))\n                return d;\n        if (fuzzy)\n            for (let d of descs)\n                for (let a of d.alias) {\n                    let found = name.indexOf(a);\n                    if (found > -1 && (a.length > 2 || !/\\w/.test(name[found - 1]) && !/\\w/.test(name[found + a.length])))\n                        return d;\n                }\n        return null;\n    }\n}\n\n/**\nFacet that defines a way to provide a function that computes the\nappropriate indentation depth, as a column number (see\n[`indentString`](https://codemirror.net/6/docs/ref/#language.indentString)), at the start of a given\nline. A return value of `null` indicates no indentation can be\ndetermined, and the line should inherit the indentation of the one\nabove it. A return value of `undefined` defers to the next indent\nservice.\n*/\nconst indentService = /*@__PURE__*/Facet.define();\n/**\nFacet for overriding the unit by which indentation happens. Should\nbe a string consisting either entirely of the same whitespace\ncharacter. When not set, this defaults to 2 spaces.\n*/\nconst indentUnit = /*@__PURE__*/Facet.define({\n    combine: values => {\n        if (!values.length)\n            return \"  \";\n        let unit = values[0];\n        if (!unit || /\\S/.test(unit) || Array.from(unit).some(e => e != unit[0]))\n            throw new Error(\"Invalid indent unit: \" + JSON.stringify(values[0]));\n        return unit;\n    }\n});\n/**\nReturn the _column width_ of an indent unit in the state.\nDetermined by the [`indentUnit`](https://codemirror.net/6/docs/ref/#language.indentUnit)\nfacet, and [`tabSize`](https://codemirror.net/6/docs/ref/#state.EditorState^tabSize) when that\ncontains tabs.\n*/\nfunction getIndentUnit(state) {\n    let unit = state.facet(indentUnit);\n    return unit.charCodeAt(0) == 9 ? state.tabSize * unit.length : unit.length;\n}\n/**\nCreate an indentation string that covers columns 0 to `cols`.\nWill use tabs for as much of the columns as possible when the\n[`indentUnit`](https://codemirror.net/6/docs/ref/#language.indentUnit) facet contains\ntabs.\n*/\nfunction indentString(state, cols) {\n    let result = \"\", ts = state.tabSize, ch = state.facet(indentUnit)[0];\n    if (ch == \"\\t\") {\n        while (cols >= ts) {\n            result += \"\\t\";\n            cols -= ts;\n        }\n        ch = \" \";\n    }\n    for (let i = 0; i < cols; i++)\n        result += ch;\n    return result;\n}\n/**\nGet the indentation, as a column number, at the given position.\nWill first consult any [indent services](https://codemirror.net/6/docs/ref/#language.indentService)\nthat are registered, and if none of those return an indentation,\nthis will check the syntax tree for the [indent node\nprop](https://codemirror.net/6/docs/ref/#language.indentNodeProp) and use that if found. Returns a\nnumber when an indentation could be determined, and null\notherwise.\n*/\nfunction getIndentation(context, pos) {\n    if (context instanceof EditorState)\n        context = new IndentContext(context);\n    for (let service of context.state.facet(indentService)) {\n        let result = service(context, pos);\n        if (result !== undefined)\n            return result;\n    }\n    let tree = syntaxTree(context.state);\n    return tree ? syntaxIndentation(context, tree, pos) : null;\n}\n/**\nCreate a change set that auto-indents all lines touched by the\ngiven document range.\n*/\nfunction indentRange(state, from, to) {\n    let updated = Object.create(null);\n    let context = new IndentContext(state, { overrideIndentation: start => { var _a; return (_a = updated[start]) !== null && _a !== void 0 ? _a : -1; } });\n    let changes = [];\n    for (let pos = from; pos <= to;) {\n        let line = state.doc.lineAt(pos);\n        pos = line.to + 1;\n        let indent = getIndentation(context, line.from);\n        if (indent == null)\n            continue;\n        if (!/\\S/.test(line.text))\n            indent = 0;\n        let cur = /^\\s*/.exec(line.text)[0];\n        let norm = indentString(state, indent);\n        if (cur != norm) {\n            updated[line.from] = indent;\n            changes.push({ from: line.from, to: line.from + cur.length, insert: norm });\n        }\n    }\n    return state.changes(changes);\n}\n/**\nIndentation contexts are used when calling [indentation\nservices](https://codemirror.net/6/docs/ref/#language.indentService). They provide helper utilities\nuseful in indentation logic, and can selectively override the\nindentation reported for some lines.\n*/\nclass IndentContext {\n    /**\n    Create an indent context.\n    */\n    constructor(\n    /**\n    The editor state.\n    */\n    state, \n    /**\n    @internal\n    */\n    options = {}) {\n        this.state = state;\n        this.options = options;\n        this.unit = getIndentUnit(state);\n    }\n    /**\n    Get a description of the line at the given position, taking\n    [simulated line\n    breaks](https://codemirror.net/6/docs/ref/#language.IndentContext.constructor^options.simulateBreak)\n    into account. If there is such a break at `pos`, the `bias`\n    argument determines whether the part of the line line before or\n    after the break is used.\n    */\n    lineAt(pos, bias = 1) {\n        let line = this.state.doc.lineAt(pos);\n        let { simulateBreak, simulateDoubleBreak } = this.options;\n        if (simulateBreak != null && simulateBreak >= line.from && simulateBreak <= line.to) {\n            if (simulateDoubleBreak && simulateBreak == pos)\n                return { text: \"\", from: pos };\n            else if (bias < 0 ? simulateBreak < pos : simulateBreak <= pos)\n                return { text: line.text.slice(simulateBreak - line.from), from: simulateBreak };\n            else\n                return { text: line.text.slice(0, simulateBreak - line.from), from: line.from };\n        }\n        return line;\n    }\n    /**\n    Get the text directly after `pos`, either the entire line\n    or the next 100 characters, whichever is shorter.\n    */\n    textAfterPos(pos, bias = 1) {\n        if (this.options.simulateDoubleBreak && pos == this.options.simulateBreak)\n            return \"\";\n        let { text, from } = this.lineAt(pos, bias);\n        return text.slice(pos - from, Math.min(text.length, pos + 100 - from));\n    }\n    /**\n    Find the column for the given position.\n    */\n    column(pos, bias = 1) {\n        let { text, from } = this.lineAt(pos, bias);\n        let result = this.countColumn(text, pos - from);\n        let override = this.options.overrideIndentation ? this.options.overrideIndentation(from) : -1;\n        if (override > -1)\n            result += override - this.countColumn(text, text.search(/\\S|$/));\n        return result;\n    }\n    /**\n    Find the column position (taking tabs into account) of the given\n    position in the given string.\n    */\n    countColumn(line, pos = line.length) {\n        return countColumn(line, this.state.tabSize, pos);\n    }\n    /**\n    Find the indentation column of the line at the given point.\n    */\n    lineIndent(pos, bias = 1) {\n        let { text, from } = this.lineAt(pos, bias);\n        let override = this.options.overrideIndentation;\n        if (override) {\n            let overriden = override(from);\n            if (overriden > -1)\n                return overriden;\n        }\n        return this.countColumn(text, text.search(/\\S|$/));\n    }\n    /**\n    Returns the [simulated line\n    break](https://codemirror.net/6/docs/ref/#language.IndentContext.constructor^options.simulateBreak)\n    for this context, if any.\n    */\n    get simulatedBreak() {\n        return this.options.simulateBreak || null;\n    }\n}\n/**\nA syntax tree node prop used to associate indentation strategies\nwith node types. Such a strategy is a function from an indentation\ncontext to a column number (see also\n[`indentString`](https://codemirror.net/6/docs/ref/#language.indentString)) or null, where null\nindicates that no definitive indentation can be determined.\n*/\nconst indentNodeProp = /*@__PURE__*/new NodeProp();\n// Compute the indentation for a given position from the syntax tree.\nfunction syntaxIndentation(cx, ast, pos) {\n    return indentFrom(ast.resolveInner(pos).enterUnfinishedNodesBefore(pos), pos, cx);\n}\nfunction ignoreClosed(cx) {\n    return cx.pos == cx.options.simulateBreak && cx.options.simulateDoubleBreak;\n}\nfunction indentStrategy(tree) {\n    let strategy = tree.type.prop(indentNodeProp);\n    if (strategy)\n        return strategy;\n    let first = tree.firstChild, close;\n    if (first && (close = first.type.prop(NodeProp.closedBy))) {\n        let last = tree.lastChild, closed = last && close.indexOf(last.name) > -1;\n        return cx => delimitedStrategy(cx, true, 1, undefined, closed && !ignoreClosed(cx) ? last.from : undefined);\n    }\n    return tree.parent == null ? topIndent : null;\n}\nfunction indentFrom(node, pos, base) {\n    for (; node; node = node.parent) {\n        let strategy = indentStrategy(node);\n        if (strategy)\n            return strategy(TreeIndentContext.create(base, pos, node));\n    }\n    return null;\n}\nfunction topIndent() { return 0; }\n/**\nObjects of this type provide context information and helper\nmethods to indentation functions registered on syntax nodes.\n*/\nclass TreeIndentContext extends IndentContext {\n    constructor(base, \n    /**\n    The position at which indentation is being computed.\n    */\n    pos, \n    /**\n    The syntax tree node to which the indentation strategy\n    applies.\n    */\n    node) {\n        super(base.state, base.options);\n        this.base = base;\n        this.pos = pos;\n        this.node = node;\n    }\n    /**\n    @internal\n    */\n    static create(base, pos, node) {\n        return new TreeIndentContext(base, pos, node);\n    }\n    /**\n    Get the text directly after `this.pos`, either the entire line\n    or the next 100 characters, whichever is shorter.\n    */\n    get textAfter() {\n        return this.textAfterPos(this.pos);\n    }\n    /**\n    Get the indentation at the reference line for `this.node`, which\n    is the line on which it starts, unless there is a node that is\n    _not_ a parent of this node covering the start of that line. If\n    so, the line at the start of that node is tried, again skipping\n    on if it is covered by another such node.\n    */\n    get baseIndent() {\n        let line = this.state.doc.lineAt(this.node.from);\n        // Skip line starts that are covered by a sibling (or cousin, etc)\n        for (;;) {\n            let atBreak = this.node.resolve(line.from);\n            while (atBreak.parent && atBreak.parent.from == atBreak.from)\n                atBreak = atBreak.parent;\n            if (isParent(atBreak, this.node))\n                break;\n            line = this.state.doc.lineAt(atBreak.from);\n        }\n        return this.lineIndent(line.from);\n    }\n    /**\n    Continue looking for indentations in the node's parent nodes,\n    and return the result of that.\n    */\n    continue() {\n        let parent = this.node.parent;\n        return parent ? indentFrom(parent, this.pos, this.base) : 0;\n    }\n}\nfunction isParent(parent, of) {\n    for (let cur = of; cur; cur = cur.parent)\n        if (parent == cur)\n            return true;\n    return false;\n}\n// Check whether a delimited node is aligned (meaning there are\n// non-skipped nodes on the same line as the opening delimiter). And\n// if so, return the opening token.\nfunction bracketedAligned(context) {\n    let tree = context.node;\n    let openToken = tree.childAfter(tree.from), last = tree.lastChild;\n    if (!openToken)\n        return null;\n    let sim = context.options.simulateBreak;\n    let openLine = context.state.doc.lineAt(openToken.from);\n    let lineEnd = sim == null || sim <= openLine.from ? openLine.to : Math.min(openLine.to, sim);\n    for (let pos = openToken.to;;) {\n        let next = tree.childAfter(pos);\n        if (!next || next == last)\n            return null;\n        if (!next.type.isSkipped)\n            return next.from < lineEnd ? openToken : null;\n        pos = next.to;\n    }\n}\n/**\nAn indentation strategy for delimited (usually bracketed) nodes.\nWill, by default, indent one unit more than the parent's base\nindent unless the line starts with a closing token. When `align`\nis true and there are non-skipped nodes on the node's opening\nline, the content of the node will be aligned with the end of the\nopening node, like this:\n\n    foo(bar,\n        baz)\n*/\nfunction delimitedIndent({ closing, align = true, units = 1 }) {\n    return (context) => delimitedStrategy(context, align, units, closing);\n}\nfunction delimitedStrategy(context, align, units, closing, closedAt) {\n    let after = context.textAfter, space = after.match(/^\\s*/)[0].length;\n    let closed = closing && after.slice(space, space + closing.length) == closing || closedAt == context.pos + space;\n    let aligned = align ? bracketedAligned(context) : null;\n    if (aligned)\n        return closed ? context.column(aligned.from) : context.column(aligned.to);\n    return context.baseIndent + (closed ? 0 : context.unit * units);\n}\n/**\nAn indentation strategy that aligns a node's content to its base\nindentation.\n*/\nconst flatIndent = (context) => context.baseIndent;\n/**\nCreates an indentation strategy that, by default, indents\ncontinued lines one unit more than the node's base indentation.\nYou can provide `except` to prevent indentation of lines that\nmatch a pattern (for example `/^else\\b/` in `if`/`else`\nconstructs), and you can change the amount of units used with the\n`units` option.\n*/\nfunction continuedIndent({ except, units = 1 } = {}) {\n    return (context) => {\n        let matchExcept = except && except.test(context.textAfter);\n        return context.baseIndent + (matchExcept ? 0 : units * context.unit);\n    };\n}\nconst DontIndentBeyond = 200;\n/**\nEnables reindentation on input. When a language defines an\n`indentOnInput` field in its [language\ndata](https://codemirror.net/6/docs/ref/#state.EditorState.languageDataAt), which must hold a regular\nexpression, the line at the cursor will be reindented whenever new\ntext is typed and the input from the start of the line up to the\ncursor matches that regexp.\n\nTo avoid unneccesary reindents, it is recommended to start the\nregexp with `^` (usually followed by `\\s*`), and end it with `$`.\nFor example, `/^\\s*\\}$/` will reindent when a closing brace is\nadded at the start of a line.\n*/\nfunction indentOnInput() {\n    return EditorState.transactionFilter.of(tr => {\n        if (!tr.docChanged || !tr.isUserEvent(\"input.type\") && !tr.isUserEvent(\"input.complete\"))\n            return tr;\n        let rules = tr.startState.languageDataAt(\"indentOnInput\", tr.startState.selection.main.head);\n        if (!rules.length)\n            return tr;\n        let doc = tr.newDoc, { head } = tr.newSelection.main, line = doc.lineAt(head);\n        if (head > line.from + DontIndentBeyond)\n            return tr;\n        let lineStart = doc.sliceString(line.from, head);\n        if (!rules.some(r => r.test(lineStart)))\n            return tr;\n        let { state } = tr, last = -1, changes = [];\n        for (let { head } of state.selection.ranges) {\n            let line = state.doc.lineAt(head);\n            if (line.from == last)\n                continue;\n            last = line.from;\n            let indent = getIndentation(state, line.from);\n            if (indent == null)\n                continue;\n            let cur = /^\\s*/.exec(line.text)[0];\n            let norm = indentString(state, indent);\n            if (cur != norm)\n                changes.push({ from: line.from, to: line.from + cur.length, insert: norm });\n        }\n        return changes.length ? [tr, { changes, sequential: true }] : tr;\n    });\n}\n\n/**\nA facet that registers a code folding service. When called with\nthe extent of a line, such a function should return a foldable\nrange that starts on that line (but continues beyond it), if one\ncan be found.\n*/\nconst foldService = /*@__PURE__*/Facet.define();\n/**\nThis node prop is used to associate folding information with\nsyntax node types. Given a syntax node, it should check whether\nthat tree is foldable and return the range that can be collapsed\nwhen it is.\n*/\nconst foldNodeProp = /*@__PURE__*/new NodeProp();\n/**\n[Fold](https://codemirror.net/6/docs/ref/#language.foldNodeProp) function that folds everything but\nthe first and the last child of a syntax node. Useful for nodes\nthat start and end with delimiters.\n*/\nfunction foldInside(node) {\n    let first = node.firstChild, last = node.lastChild;\n    return first && first.to < last.from ? { from: first.to, to: last.type.isError ? node.to : last.from } : null;\n}\nfunction syntaxFolding(state, start, end) {\n    let tree = syntaxTree(state);\n    if (tree.length < end)\n        return null;\n    let inner = tree.resolveInner(end, 1);\n    let found = null;\n    for (let cur = inner; cur; cur = cur.parent) {\n        if (cur.to <= end || cur.from > end)\n            continue;\n        if (found && cur.from < start)\n            break;\n        let prop = cur.type.prop(foldNodeProp);\n        if (prop && (cur.to < tree.length - 50 || tree.length == state.doc.length || !isUnfinished(cur))) {\n            let value = prop(cur, state);\n            if (value && value.from <= end && value.from >= start && value.to > end)\n                found = value;\n        }\n    }\n    return found;\n}\nfunction isUnfinished(node) {\n    let ch = node.lastChild;\n    return ch && ch.to == node.to && ch.type.isError;\n}\n/**\nCheck whether the given line is foldable. First asks any fold\nservices registered through\n[`foldService`](https://codemirror.net/6/docs/ref/#language.foldService), and if none of them return\na result, tries to query the [fold node\nprop](https://codemirror.net/6/docs/ref/#language.foldNodeProp) of syntax nodes that cover the end\nof the line.\n*/\nfunction foldable(state, lineStart, lineEnd) {\n    for (let service of state.facet(foldService)) {\n        let result = service(state, lineStart, lineEnd);\n        if (result)\n            return result;\n    }\n    return syntaxFolding(state, lineStart, lineEnd);\n}\nfunction mapRange(range, mapping) {\n    let from = mapping.mapPos(range.from, 1), to = mapping.mapPos(range.to, -1);\n    return from >= to ? undefined : { from, to };\n}\n/**\nState effect that can be attached to a transaction to fold the\ngiven range. (You probably only need this in exceptional\ncircumstances—usually you'll just want to let\n[`foldCode`](https://codemirror.net/6/docs/ref/#language.foldCode) and the [fold\ngutter](https://codemirror.net/6/docs/ref/#language.foldGutter) create the transactions.)\n*/\nconst foldEffect = /*@__PURE__*/StateEffect.define({ map: mapRange });\n/**\nState effect that unfolds the given range (if it was folded).\n*/\nconst unfoldEffect = /*@__PURE__*/StateEffect.define({ map: mapRange });\nfunction selectedLines(view) {\n    let lines = [];\n    for (let { head } of view.state.selection.ranges) {\n        if (lines.some(l => l.from <= head && l.to >= head))\n            continue;\n        lines.push(view.lineBlockAt(head));\n    }\n    return lines;\n}\n/**\nThe state field that stores the folded ranges (as a [decoration\nset](https://codemirror.net/6/docs/ref/#view.DecorationSet)). Can be passed to\n[`EditorState.toJSON`](https://codemirror.net/6/docs/ref/#state.EditorState.toJSON) and\n[`fromJSON`](https://codemirror.net/6/docs/ref/#state.EditorState^fromJSON) to serialize the fold\nstate.\n*/\nconst foldState = /*@__PURE__*/StateField.define({\n    create() {\n        return Decoration.none;\n    },\n    update(folded, tr) {\n        folded = folded.map(tr.changes);\n        for (let e of tr.effects) {\n            if (e.is(foldEffect) && !foldExists(folded, e.value.from, e.value.to))\n                folded = folded.update({ add: [foldWidget.range(e.value.from, e.value.to)] });\n            else if (e.is(unfoldEffect))\n                folded = folded.update({ filter: (from, to) => e.value.from != from || e.value.to != to,\n                    filterFrom: e.value.from, filterTo: e.value.to });\n        }\n        // Clear folded ranges that cover the selection head\n        if (tr.selection) {\n            let onSelection = false, { head } = tr.selection.main;\n            folded.between(head, head, (a, b) => { if (a < head && b > head)\n                onSelection = true; });\n            if (onSelection)\n                folded = folded.update({\n                    filterFrom: head,\n                    filterTo: head,\n                    filter: (a, b) => b <= head || a >= head\n                });\n        }\n        return folded;\n    },\n    provide: f => EditorView.decorations.from(f),\n    toJSON(folded, state) {\n        let ranges = [];\n        folded.between(0, state.doc.length, (from, to) => { ranges.push(from, to); });\n        return ranges;\n    },\n    fromJSON(value) {\n        if (!Array.isArray(value) || value.length % 2)\n            throw new RangeError(\"Invalid JSON for fold state\");\n        let ranges = [];\n        for (let i = 0; i < value.length;) {\n            let from = value[i++], to = value[i++];\n            if (typeof from != \"number\" || typeof to != \"number\")\n                throw new RangeError(\"Invalid JSON for fold state\");\n            ranges.push(foldWidget.range(from, to));\n        }\n        return Decoration.set(ranges, true);\n    }\n});\n/**\nGet a [range set](https://codemirror.net/6/docs/ref/#state.RangeSet) containing the folded ranges\nin the given state.\n*/\nfunction foldedRanges(state) {\n    return state.field(foldState, false) || RangeSet.empty;\n}\nfunction findFold(state, from, to) {\n    var _a;\n    let found = null;\n    (_a = state.field(foldState, false)) === null || _a === void 0 ? void 0 : _a.between(from, to, (from, to) => {\n        if (!found || found.from > from)\n            found = { from, to };\n    });\n    return found;\n}\nfunction foldExists(folded, from, to) {\n    let found = false;\n    folded.between(from, from, (a, b) => { if (a == from && b == to)\n        found = true; });\n    return found;\n}\nfunction maybeEnable(state, other) {\n    return state.field(foldState, false) ? other : other.concat(StateEffect.appendConfig.of(codeFolding()));\n}\n/**\nFold the lines that are selected, if possible.\n*/\nconst foldCode = view => {\n    for (let line of selectedLines(view)) {\n        let range = foldable(view.state, line.from, line.to);\n        if (range) {\n            view.dispatch({ effects: maybeEnable(view.state, [foldEffect.of(range), announceFold(view, range)]) });\n            return true;\n        }\n    }\n    return false;\n};\n/**\nUnfold folded ranges on selected lines.\n*/\nconst unfoldCode = view => {\n    if (!view.state.field(foldState, false))\n        return false;\n    let effects = [];\n    for (let line of selectedLines(view)) {\n        let folded = findFold(view.state, line.from, line.to);\n        if (folded)\n            effects.push(unfoldEffect.of(folded), announceFold(view, folded, false));\n    }\n    if (effects.length)\n        view.dispatch({ effects });\n    return effects.length > 0;\n};\nfunction announceFold(view, range, fold = true) {\n    let lineFrom = view.state.doc.lineAt(range.from).number, lineTo = view.state.doc.lineAt(range.to).number;\n    return EditorView.announce.of(`${view.state.phrase(fold ? \"Folded lines\" : \"Unfolded lines\")} ${lineFrom} ${view.state.phrase(\"to\")} ${lineTo}.`);\n}\n/**\nFold all top-level foldable ranges. Note that, in most cases,\nfolding information will depend on the [syntax\ntree](https://codemirror.net/6/docs/ref/#language.syntaxTree), and folding everything may not work\nreliably when the document hasn't been fully parsed (either\nbecause the editor state was only just initialized, or because the\ndocument is so big that the parser decided not to parse it\nentirely).\n*/\nconst foldAll = view => {\n    let { state } = view, effects = [];\n    for (let pos = 0; pos < state.doc.length;) {\n        let line = view.lineBlockAt(pos), range = foldable(state, line.from, line.to);\n        if (range)\n            effects.push(foldEffect.of(range));\n        pos = (range ? view.lineBlockAt(range.to) : line).to + 1;\n    }\n    if (effects.length)\n        view.dispatch({ effects: maybeEnable(view.state, effects) });\n    return !!effects.length;\n};\n/**\nUnfold all folded code.\n*/\nconst unfoldAll = view => {\n    let field = view.state.field(foldState, false);\n    if (!field || !field.size)\n        return false;\n    let effects = [];\n    field.between(0, view.state.doc.length, (from, to) => { effects.push(unfoldEffect.of({ from, to })); });\n    view.dispatch({ effects });\n    return true;\n};\n// Find the foldable region containing the given line, if one exists\nfunction foldableContainer(view, lineBlock) {\n    // Look backwards through line blocks until we find a foldable region that\n    // intersects with the line\n    for (let line = lineBlock;;) {\n        let foldableRegion = foldable(view.state, line.from, line.to);\n        if (foldableRegion && foldableRegion.to > lineBlock.from)\n            return foldableRegion;\n        if (!line.from)\n            return null;\n        line = view.lineBlockAt(line.from - 1);\n    }\n}\n/**\nToggle folding at cursors. Unfolds if there is an existing fold\nstarting in that line, tries to find a foldable range around it\notherwise.\n*/\nconst toggleFold = (view) => {\n    let effects = [];\n    for (let line of selectedLines(view)) {\n        let folded = findFold(view.state, line.from, line.to);\n        if (folded) {\n            effects.push(unfoldEffect.of(folded), announceFold(view, folded, false));\n        }\n        else {\n            let foldRange = foldableContainer(view, line);\n            if (foldRange)\n                effects.push(foldEffect.of(foldRange), announceFold(view, foldRange));\n        }\n    }\n    if (effects.length > 0)\n        view.dispatch({ effects: maybeEnable(view.state, effects) });\n    return !!effects.length;\n};\n/**\nDefault fold-related key bindings.\n\n - Ctrl-Shift-[ (Cmd-Alt-[ on macOS): [`foldCode`](https://codemirror.net/6/docs/ref/#language.foldCode).\n - Ctrl-Shift-] (Cmd-Alt-] on macOS): [`unfoldCode`](https://codemirror.net/6/docs/ref/#language.unfoldCode).\n - Ctrl-Alt-[: [`foldAll`](https://codemirror.net/6/docs/ref/#language.foldAll).\n - Ctrl-Alt-]: [`unfoldAll`](https://codemirror.net/6/docs/ref/#language.unfoldAll).\n*/\nconst foldKeymap = [\n    { key: \"Ctrl-Shift-[\", mac: \"Cmd-Alt-[\", run: foldCode },\n    { key: \"Ctrl-Shift-]\", mac: \"Cmd-Alt-]\", run: unfoldCode },\n    { key: \"Ctrl-Alt-[\", run: foldAll },\n    { key: \"Ctrl-Alt-]\", run: unfoldAll }\n];\nconst defaultConfig = {\n    placeholderDOM: null,\n    placeholderText: \"…\"\n};\nconst foldConfig = /*@__PURE__*/Facet.define({\n    combine(values) { return combineConfig(values, defaultConfig); }\n});\n/**\nCreate an extension that configures code folding.\n*/\nfunction codeFolding(config) {\n    let result = [foldState, baseTheme$1];\n    if (config)\n        result.push(foldConfig.of(config));\n    return result;\n}\nconst foldWidget = /*@__PURE__*/Decoration.replace({ widget: /*@__PURE__*/new class extends WidgetType {\n        toDOM(view) {\n            let { state } = view, conf = state.facet(foldConfig);\n            let onclick = (event) => {\n                let line = view.lineBlockAt(view.posAtDOM(event.target));\n                let folded = findFold(view.state, line.from, line.to);\n                if (folded)\n                    view.dispatch({ effects: unfoldEffect.of(folded) });\n                event.preventDefault();\n            };\n            if (conf.placeholderDOM)\n                return conf.placeholderDOM(view, onclick);\n            let element = document.createElement(\"span\");\n            element.textContent = conf.placeholderText;\n            element.setAttribute(\"aria-label\", state.phrase(\"folded code\"));\n            element.title = state.phrase(\"unfold\");\n            element.className = \"cm-foldPlaceholder\";\n            element.onclick = onclick;\n            return element;\n        }\n    } });\nconst foldGutterDefaults = {\n    openText: \"⌄\",\n    closedText: \"›\",\n    markerDOM: null,\n    domEventHandlers: {},\n    foldingChanged: () => false\n};\nclass FoldMarker extends GutterMarker {\n    constructor(config, open) {\n        super();\n        this.config = config;\n        this.open = open;\n    }\n    eq(other) { return this.config == other.config && this.open == other.open; }\n    toDOM(view) {\n        if (this.config.markerDOM)\n            return this.config.markerDOM(this.open);\n        let span = document.createElement(\"span\");\n        span.textContent = this.open ? this.config.openText : this.config.closedText;\n        span.title = view.state.phrase(this.open ? \"Fold line\" : \"Unfold line\");\n        return span;\n    }\n}\n/**\nCreate an extension that registers a fold gutter, which shows a\nfold status indicator before foldable lines (which can be clicked\nto fold or unfold the line).\n*/\nfunction foldGutter(config = {}) {\n    let fullConfig = Object.assign(Object.assign({}, foldGutterDefaults), config);\n    let canFold = new FoldMarker(fullConfig, true), canUnfold = new FoldMarker(fullConfig, false);\n    let markers = ViewPlugin.fromClass(class {\n        constructor(view) {\n            this.from = view.viewport.from;\n            this.markers = this.buildMarkers(view);\n        }\n        update(update) {\n            if (update.docChanged || update.viewportChanged ||\n                update.startState.facet(language) != update.state.facet(language) ||\n                update.startState.field(foldState, false) != update.state.field(foldState, false) ||\n                syntaxTree(update.startState) != syntaxTree(update.state) ||\n                fullConfig.foldingChanged(update))\n                this.markers = this.buildMarkers(update.view);\n        }\n        buildMarkers(view) {\n            let builder = new RangeSetBuilder();\n            for (let line of view.viewportLineBlocks) {\n                let mark = findFold(view.state, line.from, line.to) ? canUnfold\n                    : foldable(view.state, line.from, line.to) ? canFold : null;\n                if (mark)\n                    builder.add(line.from, line.from, mark);\n            }\n            return builder.finish();\n        }\n    });\n    let { domEventHandlers } = fullConfig;\n    return [\n        markers,\n        gutter({\n            class: \"cm-foldGutter\",\n            markers(view) { var _a; return ((_a = view.plugin(markers)) === null || _a === void 0 ? void 0 : _a.markers) || RangeSet.empty; },\n            initialSpacer() {\n                return new FoldMarker(fullConfig, false);\n            },\n            domEventHandlers: Object.assign(Object.assign({}, domEventHandlers), { click: (view, line, event) => {\n                    if (domEventHandlers.click && domEventHandlers.click(view, line, event))\n                        return true;\n                    let folded = findFold(view.state, line.from, line.to);\n                    if (folded) {\n                        view.dispatch({ effects: unfoldEffect.of(folded) });\n                        return true;\n                    }\n                    let range = foldable(view.state, line.from, line.to);\n                    if (range) {\n                        view.dispatch({ effects: foldEffect.of(range) });\n                        return true;\n                    }\n                    return false;\n                } })\n        }),\n        codeFolding()\n    ];\n}\nconst baseTheme$1 = /*@__PURE__*/EditorView.baseTheme({\n    \".cm-foldPlaceholder\": {\n        backgroundColor: \"#eee\",\n        border: \"1px solid #ddd\",\n        color: \"#888\",\n        borderRadius: \".2em\",\n        margin: \"0 1px\",\n        padding: \"0 1px\",\n        cursor: \"pointer\"\n    },\n    \".cm-foldGutter span\": {\n        padding: \"0 1px\",\n        cursor: \"pointer\"\n    }\n});\n\n/**\nA highlight style associates CSS styles with higlighting\n[tags](https://lezer.codemirror.net/docs/ref#highlight.Tag).\n*/\nclass HighlightStyle {\n    constructor(\n    /**\n    The tag styles used to create this highlight style.\n    */\n    specs, options) {\n        this.specs = specs;\n        let modSpec;\n        function def(spec) {\n            let cls = StyleModule.newName();\n            (modSpec || (modSpec = Object.create(null)))[\".\" + cls] = spec;\n            return cls;\n        }\n        const all = typeof options.all == \"string\" ? options.all : options.all ? def(options.all) : undefined;\n        const scopeOpt = options.scope;\n        this.scope = scopeOpt instanceof Language ? (type) => type.prop(languageDataProp) == scopeOpt.data\n            : scopeOpt ? (type) => type == scopeOpt : undefined;\n        this.style = tagHighlighter(specs.map(style => ({\n            tag: style.tag,\n            class: style.class || def(Object.assign({}, style, { tag: null }))\n        })), {\n            all,\n        }).style;\n        this.module = modSpec ? new StyleModule(modSpec) : null;\n        this.themeType = options.themeType;\n    }\n    /**\n    Create a highlighter style that associates the given styles to\n    the given tags. The specs must be objects that hold a style tag\n    or array of tags in their `tag` property, and either a single\n    `class` property providing a static CSS class (for highlighter\n    that rely on external styling), or a\n    [`style-mod`](https://github.com/marijnh/style-mod#documentation)-style\n    set of CSS properties (which define the styling for those tags).\n    \n    The CSS rules created for a highlighter will be emitted in the\n    order of the spec's properties. That means that for elements that\n    have multiple tags associated with them, styles defined further\n    down in the list will have a higher CSS precedence than styles\n    defined earlier.\n    */\n    static define(specs, options) {\n        return new HighlightStyle(specs, options || {});\n    }\n}\nconst highlighterFacet = /*@__PURE__*/Facet.define();\nconst fallbackHighlighter = /*@__PURE__*/Facet.define({\n    combine(values) { return values.length ? [values[0]] : null; }\n});\nfunction getHighlighters(state) {\n    let main = state.facet(highlighterFacet);\n    return main.length ? main : state.facet(fallbackHighlighter);\n}\n/**\nWrap a highlighter in an editor extension that uses it to apply\nsyntax highlighting to the editor content.\n\nWhen multiple (non-fallback) styles are provided, the styling\napplied is the union of the classes they emit.\n*/\nfunction syntaxHighlighting(highlighter, options) {\n    let ext = [treeHighlighter], themeType;\n    if (highlighter instanceof HighlightStyle) {\n        if (highlighter.module)\n            ext.push(EditorView.styleModule.of(highlighter.module));\n        themeType = highlighter.themeType;\n    }\n    if (options === null || options === void 0 ? void 0 : options.fallback)\n        ext.push(fallbackHighlighter.of(highlighter));\n    else if (themeType)\n        ext.push(highlighterFacet.computeN([EditorView.darkTheme], state => {\n            return state.facet(EditorView.darkTheme) == (themeType == \"dark\") ? [highlighter] : [];\n        }));\n    else\n        ext.push(highlighterFacet.of(highlighter));\n    return ext;\n}\n/**\nReturns the CSS classes (if any) that the highlighters active in\nthe state would assign to the given style\n[tags](https://lezer.codemirror.net/docs/ref#highlight.Tag) and\n(optional) language\n[scope](https://codemirror.net/6/docs/ref/#language.HighlightStyle^define^options.scope).\n*/\nfunction highlightingFor(state, tags, scope) {\n    let highlighters = getHighlighters(state);\n    let result = null;\n    if (highlighters)\n        for (let highlighter of highlighters) {\n            if (!highlighter.scope || scope && highlighter.scope(scope)) {\n                let cls = highlighter.style(tags);\n                if (cls)\n                    result = result ? result + \" \" + cls : cls;\n            }\n        }\n    return result;\n}\nclass TreeHighlighter {\n    constructor(view) {\n        this.markCache = Object.create(null);\n        this.tree = syntaxTree(view.state);\n        this.decorations = this.buildDeco(view, getHighlighters(view.state));\n    }\n    update(update) {\n        let tree = syntaxTree(update.state), highlighters = getHighlighters(update.state);\n        let styleChange = highlighters != getHighlighters(update.startState);\n        if (tree.length < update.view.viewport.to && !styleChange && tree.type == this.tree.type) {\n            this.decorations = this.decorations.map(update.changes);\n        }\n        else if (tree != this.tree || update.viewportChanged || styleChange) {\n            this.tree = tree;\n            this.decorations = this.buildDeco(update.view, highlighters);\n        }\n    }\n    buildDeco(view, highlighters) {\n        if (!highlighters || !this.tree.length)\n            return Decoration.none;\n        let builder = new RangeSetBuilder();\n        for (let { from, to } of view.visibleRanges) {\n            highlightTree(this.tree, highlighters, (from, to, style) => {\n                builder.add(from, to, this.markCache[style] || (this.markCache[style] = Decoration.mark({ class: style })));\n            }, from, to);\n        }\n        return builder.finish();\n    }\n}\nconst treeHighlighter = /*@__PURE__*/Prec.high(/*@__PURE__*/ViewPlugin.fromClass(TreeHighlighter, {\n    decorations: v => v.decorations\n}));\n/**\nA default highlight style (works well with light themes).\n*/\nconst defaultHighlightStyle = /*@__PURE__*/HighlightStyle.define([\n    { tag: tags.meta,\n        color: \"#404740\" },\n    { tag: tags.link,\n        textDecoration: \"underline\" },\n    { tag: tags.heading,\n        textDecoration: \"underline\",\n        fontWeight: \"bold\" },\n    { tag: tags.emphasis,\n        fontStyle: \"italic\" },\n    { tag: tags.strong,\n        fontWeight: \"bold\" },\n    { tag: tags.strikethrough,\n        textDecoration: \"line-through\" },\n    { tag: tags.keyword,\n        color: \"#708\" },\n    { tag: [tags.atom, tags.bool, tags.url, tags.contentSeparator, tags.labelName],\n        color: \"#219\" },\n    { tag: [tags.literal, tags.inserted],\n        color: \"#164\" },\n    { tag: [tags.string, tags.deleted],\n        color: \"#a11\" },\n    { tag: [tags.regexp, tags.escape, /*@__PURE__*/tags.special(tags.string)],\n        color: \"#e40\" },\n    { tag: /*@__PURE__*/tags.definition(tags.variableName),\n        color: \"#00f\" },\n    { tag: /*@__PURE__*/tags.local(tags.variableName),\n        color: \"#30a\" },\n    { tag: [tags.typeName, tags.namespace],\n        color: \"#085\" },\n    { tag: tags.className,\n        color: \"#167\" },\n    { tag: [/*@__PURE__*/tags.special(tags.variableName), tags.macroName],\n        color: \"#256\" },\n    { tag: /*@__PURE__*/tags.definition(tags.propertyName),\n        color: \"#00c\" },\n    { tag: tags.comment,\n        color: \"#940\" },\n    { tag: tags.invalid,\n        color: \"#f00\" }\n]);\n\nconst baseTheme = /*@__PURE__*/EditorView.baseTheme({\n    \"&.cm-focused .cm-matchingBracket\": { backgroundColor: \"#328c8252\" },\n    \"&.cm-focused .cm-nonmatchingBracket\": { backgroundColor: \"#bb555544\" }\n});\nconst DefaultScanDist = 10000, DefaultBrackets = \"()[]{}\";\nconst bracketMatchingConfig = /*@__PURE__*/Facet.define({\n    combine(configs) {\n        return combineConfig(configs, {\n            afterCursor: true,\n            brackets: DefaultBrackets,\n            maxScanDistance: DefaultScanDist,\n            renderMatch: defaultRenderMatch\n        });\n    }\n});\nconst matchingMark = /*@__PURE__*/Decoration.mark({ class: \"cm-matchingBracket\" }), nonmatchingMark = /*@__PURE__*/Decoration.mark({ class: \"cm-nonmatchingBracket\" });\nfunction defaultRenderMatch(match) {\n    let decorations = [];\n    let mark = match.matched ? matchingMark : nonmatchingMark;\n    decorations.push(mark.range(match.start.from, match.start.to));\n    if (match.end)\n        decorations.push(mark.range(match.end.from, match.end.to));\n    return decorations;\n}\nconst bracketMatchingState = /*@__PURE__*/StateField.define({\n    create() { return Decoration.none; },\n    update(deco, tr) {\n        if (!tr.docChanged && !tr.selection)\n            return deco;\n        let decorations = [];\n        let config = tr.state.facet(bracketMatchingConfig);\n        for (let range of tr.state.selection.ranges) {\n            if (!range.empty)\n                continue;\n            let match = matchBrackets(tr.state, range.head, -1, config)\n                || (range.head > 0 && matchBrackets(tr.state, range.head - 1, 1, config))\n                || (config.afterCursor &&\n                    (matchBrackets(tr.state, range.head, 1, config) ||\n                        (range.head < tr.state.doc.length && matchBrackets(tr.state, range.head + 1, -1, config))));\n            if (match)\n                decorations = decorations.concat(config.renderMatch(match, tr.state));\n        }\n        return Decoration.set(decorations, true);\n    },\n    provide: f => EditorView.decorations.from(f)\n});\nconst bracketMatchingUnique = [\n    bracketMatchingState,\n    baseTheme\n];\n/**\nCreate an extension that enables bracket matching. Whenever the\ncursor is next to a bracket, that bracket and the one it matches\nare highlighted. Or, when no matching bracket is found, another\nhighlighting style is used to indicate this.\n*/\nfunction bracketMatching(config = {}) {\n    return [bracketMatchingConfig.of(config), bracketMatchingUnique];\n}\n/**\nWhen larger syntax nodes, such as HTML tags, are marked as\nopening/closing, it can be a bit messy to treat the whole node as\na matchable bracket. This node prop allows you to define, for such\na node, a ‘handle’—the part of the node that is highlighted, and\nthat the cursor must be on to activate highlighting in the first\nplace.\n*/\nconst bracketMatchingHandle = /*@__PURE__*/new NodeProp();\nfunction matchingNodes(node, dir, brackets) {\n    let byProp = node.prop(dir < 0 ? NodeProp.openedBy : NodeProp.closedBy);\n    if (byProp)\n        return byProp;\n    if (node.name.length == 1) {\n        let index = brackets.indexOf(node.name);\n        if (index > -1 && index % 2 == (dir < 0 ? 1 : 0))\n            return [brackets[index + dir]];\n    }\n    return null;\n}\nfunction findHandle(node) {\n    let hasHandle = node.type.prop(bracketMatchingHandle);\n    return hasHandle ? hasHandle(node.node) : node;\n}\n/**\nFind the matching bracket for the token at `pos`, scanning\ndirection `dir`. Only the `brackets` and `maxScanDistance`\nproperties are used from `config`, if given. Returns null if no\nbracket was found at `pos`, or a match result otherwise.\n*/\nfunction matchBrackets(state, pos, dir, config = {}) {\n    let maxScanDistance = config.maxScanDistance || DefaultScanDist, brackets = config.brackets || DefaultBrackets;\n    let tree = syntaxTree(state), node = tree.resolveInner(pos, dir);\n    for (let cur = node; cur; cur = cur.parent) {\n        let matches = matchingNodes(cur.type, dir, brackets);\n        if (matches && cur.from < cur.to) {\n            let handle = findHandle(cur);\n            if (handle && (dir > 0 ? pos >= handle.from && pos < handle.to : pos > handle.from && pos <= handle.to))\n                return matchMarkedBrackets(state, pos, dir, cur, handle, matches, brackets);\n        }\n    }\n    return matchPlainBrackets(state, pos, dir, tree, node.type, maxScanDistance, brackets);\n}\nfunction matchMarkedBrackets(_state, _pos, dir, token, handle, matching, brackets) {\n    let parent = token.parent, firstToken = { from: handle.from, to: handle.to };\n    let depth = 0, cursor = parent === null || parent === void 0 ? void 0 : parent.cursor();\n    if (cursor && (dir < 0 ? cursor.childBefore(token.from) : cursor.childAfter(token.to)))\n        do {\n            if (dir < 0 ? cursor.to <= token.from : cursor.from >= token.to) {\n                if (depth == 0 && matching.indexOf(cursor.type.name) > -1 && cursor.from < cursor.to) {\n                    let endHandle = findHandle(cursor);\n                    return { start: firstToken, end: endHandle ? { from: endHandle.from, to: endHandle.to } : undefined, matched: true };\n                }\n                else if (matchingNodes(cursor.type, dir, brackets)) {\n                    depth++;\n                }\n                else if (matchingNodes(cursor.type, -dir, brackets)) {\n                    if (depth == 0) {\n                        let endHandle = findHandle(cursor);\n                        return {\n                            start: firstToken,\n                            end: endHandle && endHandle.from < endHandle.to ? { from: endHandle.from, to: endHandle.to } : undefined,\n                            matched: false\n                        };\n                    }\n                    depth--;\n                }\n            }\n        } while (dir < 0 ? cursor.prevSibling() : cursor.nextSibling());\n    return { start: firstToken, matched: false };\n}\nfunction matchPlainBrackets(state, pos, dir, tree, tokenType, maxScanDistance, brackets) {\n    let startCh = dir < 0 ? state.sliceDoc(pos - 1, pos) : state.sliceDoc(pos, pos + 1);\n    let bracket = brackets.indexOf(startCh);\n    if (bracket < 0 || (bracket % 2 == 0) != (dir > 0))\n        return null;\n    let startToken = { from: dir < 0 ? pos - 1 : pos, to: dir > 0 ? pos + 1 : pos };\n    let iter = state.doc.iterRange(pos, dir > 0 ? state.doc.length : 0), depth = 0;\n    for (let distance = 0; !(iter.next()).done && distance <= maxScanDistance;) {\n        let text = iter.value;\n        if (dir < 0)\n            distance += text.length;\n        let basePos = pos + distance * dir;\n        for (let pos = dir > 0 ? 0 : text.length - 1, end = dir > 0 ? text.length : -1; pos != end; pos += dir) {\n            let found = brackets.indexOf(text[pos]);\n            if (found < 0 || tree.resolveInner(basePos + pos, 1).type != tokenType)\n                continue;\n            if ((found % 2 == 0) == (dir > 0)) {\n                depth++;\n            }\n            else if (depth == 1) { // Closing\n                return { start: startToken, end: { from: basePos + pos, to: basePos + pos + 1 }, matched: (found >> 1) == (bracket >> 1) };\n            }\n            else {\n                depth--;\n            }\n        }\n        if (dir > 0)\n            distance += text.length;\n    }\n    return iter.done ? { start: startToken, matched: false } : null;\n}\n\n// Counts the column offset in a string, taking tabs into account.\n// Used mostly to find indentation.\nfunction countCol(string, end, tabSize, startIndex = 0, startValue = 0) {\n    if (end == null) {\n        end = string.search(/[^\\s\\u00a0]/);\n        if (end == -1)\n            end = string.length;\n    }\n    let n = startValue;\n    for (let i = startIndex; i < end; i++) {\n        if (string.charCodeAt(i) == 9)\n            n += tabSize - (n % tabSize);\n        else\n            n++;\n    }\n    return n;\n}\n/**\nEncapsulates a single line of input. Given to stream syntax code,\nwhich uses it to tokenize the content.\n*/\nclass StringStream {\n    /**\n    Create a stream.\n    */\n    constructor(\n    /**\n    The line.\n    */\n    string, tabSize, \n    /**\n    The current indent unit size.\n    */\n    indentUnit, overrideIndent) {\n        this.string = string;\n        this.tabSize = tabSize;\n        this.indentUnit = indentUnit;\n        this.overrideIndent = overrideIndent;\n        /**\n        The current position on the line.\n        */\n        this.pos = 0;\n        /**\n        The start position of the current token.\n        */\n        this.start = 0;\n        this.lastColumnPos = 0;\n        this.lastColumnValue = 0;\n    }\n    /**\n    True if we are at the end of the line.\n    */\n    eol() { return this.pos >= this.string.length; }\n    /**\n    True if we are at the start of the line.\n    */\n    sol() { return this.pos == 0; }\n    /**\n    Get the next code unit after the current position, or undefined\n    if we're at the end of the line.\n    */\n    peek() { return this.string.charAt(this.pos) || undefined; }\n    /**\n    Read the next code unit and advance `this.pos`.\n    */\n    next() {\n        if (this.pos < this.string.length)\n            return this.string.charAt(this.pos++);\n    }\n    /**\n    Match the next character against the given string, regular\n    expression, or predicate. Consume and return it if it matches.\n    */\n    eat(match) {\n        let ch = this.string.charAt(this.pos);\n        let ok;\n        if (typeof match == \"string\")\n            ok = ch == match;\n        else\n            ok = ch && (match instanceof RegExp ? match.test(ch) : match(ch));\n        if (ok) {\n            ++this.pos;\n            return ch;\n        }\n    }\n    /**\n    Continue matching characters that match the given string,\n    regular expression, or predicate function. Return true if any\n    characters were consumed.\n    */\n    eatWhile(match) {\n        let start = this.pos;\n        while (this.eat(match)) { }\n        return this.pos > start;\n    }\n    /**\n    Consume whitespace ahead of `this.pos`. Return true if any was\n    found.\n    */\n    eatSpace() {\n        let start = this.pos;\n        while (/[\\s\\u00a0]/.test(this.string.charAt(this.pos)))\n            ++this.pos;\n        return this.pos > start;\n    }\n    /**\n    Move to the end of the line.\n    */\n    skipToEnd() { this.pos = this.string.length; }\n    /**\n    Move to directly before the given character, if found on the\n    current line.\n    */\n    skipTo(ch) {\n        let found = this.string.indexOf(ch, this.pos);\n        if (found > -1) {\n            this.pos = found;\n            return true;\n        }\n    }\n    /**\n    Move back `n` characters.\n    */\n    backUp(n) { this.pos -= n; }\n    /**\n    Get the column position at `this.pos`.\n    */\n    column() {\n        if (this.lastColumnPos < this.start) {\n            this.lastColumnValue = countCol(this.string, this.start, this.tabSize, this.lastColumnPos, this.lastColumnValue);\n            this.lastColumnPos = this.start;\n        }\n        return this.lastColumnValue;\n    }\n    /**\n    Get the indentation column of the current line.\n    */\n    indentation() {\n        var _a;\n        return (_a = this.overrideIndent) !== null && _a !== void 0 ? _a : countCol(this.string, null, this.tabSize);\n    }\n    /**\n    Match the input against the given string or regular expression\n    (which should start with a `^`). Return true or the regexp match\n    if it matches.\n    \n    Unless `consume` is set to `false`, this will move `this.pos`\n    past the matched text.\n    \n    When matching a string `caseInsensitive` can be set to true to\n    make the match case-insensitive.\n    */\n    match(pattern, consume, caseInsensitive) {\n        if (typeof pattern == \"string\") {\n            let cased = (str) => caseInsensitive ? str.toLowerCase() : str;\n            let substr = this.string.substr(this.pos, pattern.length);\n            if (cased(substr) == cased(pattern)) {\n                if (consume !== false)\n                    this.pos += pattern.length;\n                return true;\n            }\n            else\n                return null;\n        }\n        else {\n            let match = this.string.slice(this.pos).match(pattern);\n            if (match && match.index > 0)\n                return null;\n            if (match && consume !== false)\n                this.pos += match[0].length;\n            return match;\n        }\n    }\n    /**\n    Get the current token.\n    */\n    current() { return this.string.slice(this.start, this.pos); }\n}\n\nfunction fullParser(spec) {\n    return {\n        name: spec.name || \"\",\n        token: spec.token,\n        blankLine: spec.blankLine || (() => { }),\n        startState: spec.startState || (() => true),\n        copyState: spec.copyState || defaultCopyState,\n        indent: spec.indent || (() => null),\n        languageData: spec.languageData || {},\n        tokenTable: spec.tokenTable || noTokens\n    };\n}\nfunction defaultCopyState(state) {\n    if (typeof state != \"object\")\n        return state;\n    let newState = {};\n    for (let prop in state) {\n        let val = state[prop];\n        newState[prop] = (val instanceof Array ? val.slice() : val);\n    }\n    return newState;\n}\nconst IndentedFrom = /*@__PURE__*/new WeakMap();\n/**\nA [language](https://codemirror.net/6/docs/ref/#language.Language) class based on a CodeMirror\n5-style [streaming parser](https://codemirror.net/6/docs/ref/#language.StreamParser).\n*/\nclass StreamLanguage extends Language {\n    constructor(parser) {\n        let data = defineLanguageFacet(parser.languageData);\n        let p = fullParser(parser), self;\n        let impl = new class extends Parser {\n            createParse(input, fragments, ranges) {\n                return new Parse(self, input, fragments, ranges);\n            }\n        };\n        super(data, impl, [indentService.of((cx, pos) => this.getIndent(cx, pos))], parser.name);\n        this.topNode = docID(data);\n        self = this;\n        this.streamParser = p;\n        this.stateAfter = new NodeProp({ perNode: true });\n        this.tokenTable = parser.tokenTable ? new TokenTable(p.tokenTable) : defaultTokenTable;\n    }\n    /**\n    Define a stream language.\n    */\n    static define(spec) { return new StreamLanguage(spec); }\n    getIndent(cx, pos) {\n        let tree = syntaxTree(cx.state), at = tree.resolve(pos);\n        while (at && at.type != this.topNode)\n            at = at.parent;\n        if (!at)\n            return null;\n        let from = undefined;\n        let { overrideIndentation } = cx.options;\n        if (overrideIndentation) {\n            from = IndentedFrom.get(cx.state);\n            if (from != null && from < pos - 1e4)\n                from = undefined;\n        }\n        let start = findState(this, tree, 0, at.from, from !== null && from !== void 0 ? from : pos), statePos, state;\n        if (start) {\n            state = start.state;\n            statePos = start.pos + 1;\n        }\n        else {\n            state = this.streamParser.startState(cx.unit);\n            statePos = 0;\n        }\n        if (pos - statePos > 10000 /* C.MaxIndentScanDist */)\n            return null;\n        while (statePos < pos) {\n            let line = cx.state.doc.lineAt(statePos), end = Math.min(pos, line.to);\n            if (line.length) {\n                let indentation = overrideIndentation ? overrideIndentation(line.from) : -1;\n                let stream = new StringStream(line.text, cx.state.tabSize, cx.unit, indentation < 0 ? undefined : indentation);\n                while (stream.pos < end - line.from)\n                    readToken(this.streamParser.token, stream, state);\n            }\n            else {\n                this.streamParser.blankLine(state, cx.unit);\n            }\n            if (end == pos)\n                break;\n            statePos = line.to + 1;\n        }\n        let line = cx.lineAt(pos);\n        if (overrideIndentation && from == null)\n            IndentedFrom.set(cx.state, line.from);\n        return this.streamParser.indent(state, /^\\s*(.*)/.exec(line.text)[1], cx);\n    }\n    get allowsNesting() { return false; }\n}\nfunction findState(lang, tree, off, startPos, before) {\n    let state = off >= startPos && off + tree.length <= before && tree.prop(lang.stateAfter);\n    if (state)\n        return { state: lang.streamParser.copyState(state), pos: off + tree.length };\n    for (let i = tree.children.length - 1; i >= 0; i--) {\n        let child = tree.children[i], pos = off + tree.positions[i];\n        let found = child instanceof Tree && pos < before && findState(lang, child, pos, startPos, before);\n        if (found)\n            return found;\n    }\n    return null;\n}\nfunction cutTree(lang, tree, from, to, inside) {\n    if (inside && from <= 0 && to >= tree.length)\n        return tree;\n    if (!inside && tree.type == lang.topNode)\n        inside = true;\n    for (let i = tree.children.length - 1; i >= 0; i--) {\n        let pos = tree.positions[i], child = tree.children[i], inner;\n        if (pos < to && child instanceof Tree) {\n            if (!(inner = cutTree(lang, child, from - pos, to - pos, inside)))\n                break;\n            return !inside ? inner\n                : new Tree(tree.type, tree.children.slice(0, i).concat(inner), tree.positions.slice(0, i + 1), pos + inner.length);\n        }\n    }\n    return null;\n}\nfunction findStartInFragments(lang, fragments, startPos, editorState) {\n    for (let f of fragments) {\n        let from = f.from + (f.openStart ? 25 : 0), to = f.to - (f.openEnd ? 25 : 0);\n        let found = from <= startPos && to > startPos && findState(lang, f.tree, 0 - f.offset, startPos, to), tree;\n        if (found && (tree = cutTree(lang, f.tree, startPos + f.offset, found.pos + f.offset, false)))\n            return { state: found.state, tree };\n    }\n    return { state: lang.streamParser.startState(editorState ? getIndentUnit(editorState) : 4), tree: Tree.empty };\n}\nclass Parse {\n    constructor(lang, input, fragments, ranges) {\n        this.lang = lang;\n        this.input = input;\n        this.fragments = fragments;\n        this.ranges = ranges;\n        this.stoppedAt = null;\n        this.chunks = [];\n        this.chunkPos = [];\n        this.chunk = [];\n        this.chunkReused = undefined;\n        this.rangeIndex = 0;\n        this.to = ranges[ranges.length - 1].to;\n        let context = ParseContext.get(), from = ranges[0].from;\n        let { state, tree } = findStartInFragments(lang, fragments, from, context === null || context === void 0 ? void 0 : context.state);\n        this.state = state;\n        this.parsedPos = this.chunkStart = from + tree.length;\n        for (let i = 0; i < tree.children.length; i++) {\n            this.chunks.push(tree.children[i]);\n            this.chunkPos.push(tree.positions[i]);\n        }\n        if (context && this.parsedPos < context.viewport.from - 100000 /* C.MaxDistanceBeforeViewport */) {\n            this.state = this.lang.streamParser.startState(getIndentUnit(context.state));\n            context.skipUntilInView(this.parsedPos, context.viewport.from);\n            this.parsedPos = context.viewport.from;\n        }\n        this.moveRangeIndex();\n    }\n    advance() {\n        let context = ParseContext.get();\n        let parseEnd = this.stoppedAt == null ? this.to : Math.min(this.to, this.stoppedAt);\n        let end = Math.min(parseEnd, this.chunkStart + 2048 /* C.ChunkSize */);\n        if (context)\n            end = Math.min(end, context.viewport.to);\n        while (this.parsedPos < end)\n            this.parseLine(context);\n        if (this.chunkStart < this.parsedPos)\n            this.finishChunk();\n        if (this.parsedPos >= parseEnd)\n            return this.finish();\n        if (context && this.parsedPos >= context.viewport.to) {\n            context.skipUntilInView(this.parsedPos, parseEnd);\n            return this.finish();\n        }\n        return null;\n    }\n    stopAt(pos) {\n        this.stoppedAt = pos;\n    }\n    lineAfter(pos) {\n        let chunk = this.input.chunk(pos);\n        if (!this.input.lineChunks) {\n            let eol = chunk.indexOf(\"\\n\");\n            if (eol > -1)\n                chunk = chunk.slice(0, eol);\n        }\n        else if (chunk == \"\\n\") {\n            chunk = \"\";\n        }\n        return pos + chunk.length <= this.to ? chunk : chunk.slice(0, this.to - pos);\n    }\n    nextLine() {\n        let from = this.parsedPos, line = this.lineAfter(from), end = from + line.length;\n        for (let index = this.rangeIndex;;) {\n            let rangeEnd = this.ranges[index].to;\n            if (rangeEnd >= end)\n                break;\n            line = line.slice(0, rangeEnd - (end - line.length));\n            index++;\n            if (index == this.ranges.length)\n                break;\n            let rangeStart = this.ranges[index].from;\n            let after = this.lineAfter(rangeStart);\n            line += after;\n            end = rangeStart + after.length;\n        }\n        return { line, end };\n    }\n    skipGapsTo(pos, offset, side) {\n        for (;;) {\n            let end = this.ranges[this.rangeIndex].to, offPos = pos + offset;\n            if (side > 0 ? end > offPos : end >= offPos)\n                break;\n            let start = this.ranges[++this.rangeIndex].from;\n            offset += start - end;\n        }\n        return offset;\n    }\n    moveRangeIndex() {\n        while (this.ranges[this.rangeIndex].to < this.parsedPos)\n            this.rangeIndex++;\n    }\n    emitToken(id, from, to, size, offset) {\n        if (this.ranges.length > 1) {\n            offset = this.skipGapsTo(from, offset, 1);\n            from += offset;\n            let len0 = this.chunk.length;\n            offset = this.skipGapsTo(to, offset, -1);\n            to += offset;\n            size += this.chunk.length - len0;\n        }\n        this.chunk.push(id, from, to, size);\n        return offset;\n    }\n    parseLine(context) {\n        let { line, end } = this.nextLine(), offset = 0, { streamParser } = this.lang;\n        let stream = new StringStream(line, context ? context.state.tabSize : 4, context ? getIndentUnit(context.state) : 2);\n        if (stream.eol()) {\n            streamParser.blankLine(this.state, stream.indentUnit);\n        }\n        else {\n            while (!stream.eol()) {\n                let token = readToken(streamParser.token, stream, this.state);\n                if (token)\n                    offset = this.emitToken(this.lang.tokenTable.resolve(token), this.parsedPos + stream.start, this.parsedPos + stream.pos, 4, offset);\n                if (stream.start > 10000 /* C.MaxLineLength */)\n                    break;\n            }\n        }\n        this.parsedPos = end;\n        this.moveRangeIndex();\n        if (this.parsedPos < this.to)\n            this.parsedPos++;\n    }\n    finishChunk() {\n        let tree = Tree.build({\n            buffer: this.chunk,\n            start: this.chunkStart,\n            length: this.parsedPos - this.chunkStart,\n            nodeSet,\n            topID: 0,\n            maxBufferLength: 2048 /* C.ChunkSize */,\n            reused: this.chunkReused\n        });\n        tree = new Tree(tree.type, tree.children, tree.positions, tree.length, [[this.lang.stateAfter, this.lang.streamParser.copyState(this.state)]]);\n        this.chunks.push(tree);\n        this.chunkPos.push(this.chunkStart - this.ranges[0].from);\n        this.chunk = [];\n        this.chunkReused = undefined;\n        this.chunkStart = this.parsedPos;\n    }\n    finish() {\n        return new Tree(this.lang.topNode, this.chunks, this.chunkPos, this.parsedPos - this.ranges[0].from).balance();\n    }\n}\nfunction readToken(token, stream, state) {\n    stream.start = stream.pos;\n    for (let i = 0; i < 10; i++) {\n        let result = token(stream, state);\n        if (stream.pos > stream.start)\n            return result;\n    }\n    throw new Error(\"Stream parser failed to advance stream.\");\n}\nconst noTokens = /*@__PURE__*/Object.create(null);\nconst typeArray = [NodeType.none];\nconst nodeSet = /*@__PURE__*/new NodeSet(typeArray);\nconst warned = [];\nconst defaultTable = /*@__PURE__*/Object.create(null);\nfor (let [legacyName, name] of [\n    [\"variable\", \"variableName\"],\n    [\"variable-2\", \"variableName.special\"],\n    [\"string-2\", \"string.special\"],\n    [\"def\", \"variableName.definition\"],\n    [\"tag\", \"tagName\"],\n    [\"attribute\", \"attributeName\"],\n    [\"type\", \"typeName\"],\n    [\"builtin\", \"variableName.standard\"],\n    [\"qualifier\", \"modifier\"],\n    [\"error\", \"invalid\"],\n    [\"header\", \"heading\"],\n    [\"property\", \"propertyName\"]\n])\n    defaultTable[legacyName] = /*@__PURE__*/createTokenType(noTokens, name);\nclass TokenTable {\n    constructor(extra) {\n        this.extra = extra;\n        this.table = Object.assign(Object.create(null), defaultTable);\n    }\n    resolve(tag) {\n        return !tag ? 0 : this.table[tag] || (this.table[tag] = createTokenType(this.extra, tag));\n    }\n}\nconst defaultTokenTable = /*@__PURE__*/new TokenTable(noTokens);\nfunction warnForPart(part, msg) {\n    if (warned.indexOf(part) > -1)\n        return;\n    warned.push(part);\n    console.warn(msg);\n}\nfunction createTokenType(extra, tagStr) {\n    let tag = null;\n    for (let part of tagStr.split(\".\")) {\n        let value = (extra[part] || tags[part]);\n        if (!value) {\n            warnForPart(part, `Unknown highlighting tag ${part}`);\n        }\n        else if (typeof value == \"function\") {\n            if (!tag)\n                warnForPart(part, `Modifier ${part} used at start of tag`);\n            else\n                tag = value(tag);\n        }\n        else {\n            if (tag)\n                warnForPart(part, `Tag ${part} used as modifier`);\n            else\n                tag = value;\n        }\n    }\n    if (!tag)\n        return 0;\n    let name = tagStr.replace(/ /g, \"_\"), type = NodeType.define({\n        id: typeArray.length,\n        name,\n        props: [styleTags({ [name]: tag })]\n    });\n    typeArray.push(type);\n    return type.id;\n}\nfunction docID(data) {\n    let type = NodeType.define({ id: typeArray.length, name: \"Document\", props: [languageDataProp.add(() => data)] });\n    typeArray.push(type);\n    return type;\n}\n\nexport { HighlightStyle, IndentContext, LRLanguage, Language, LanguageDescription, LanguageSupport, ParseContext, StreamLanguage, StringStream, TreeIndentContext, bracketMatching, bracketMatchingHandle, codeFolding, continuedIndent, defaultHighlightStyle, defineLanguageFacet, delimitedIndent, ensureSyntaxTree, flatIndent, foldAll, foldCode, foldEffect, foldGutter, foldInside, foldKeymap, foldNodeProp, foldService, foldState, foldable, foldedRanges, forceParsing, getIndentUnit, getIndentation, highlightingFor, indentNodeProp, indentOnInput, indentRange, indentService, indentString, indentUnit, language, languageDataProp, matchBrackets, sublanguageProp, syntaxHighlighting, syntaxParserRunning, syntaxTree, syntaxTreeAvailable, toggleFold, unfoldAll, unfoldCode, unfoldEffect };\n","import { Annotation, Facet, combineConfig, StateField, EditorSelection, Transaction, ChangeSet, ChangeDesc, StateEffect, Text, findClusterBreak, countColumn, CharCategory } from '@codemirror/state';\nimport { EditorView, Direction } from '@codemirror/view';\nimport { IndentContext, getIndentation, indentString, matchBrackets, syntaxTree, getIndentUnit, indentUnit } from '@codemirror/language';\nimport { NodeProp } from '@lezer/common';\n\n/**\nComment or uncomment the current selection. Will use line comments\nif available, otherwise falling back to block comments.\n*/\nconst toggleComment = target => {\n    let { state } = target, line = state.doc.lineAt(state.selection.main.head), config = getConfig(target.state, line.from);\n    return config.line ? toggleLineComment(target) : config.block ? toggleBlockCommentByLine(target) : false;\n};\nfunction command(f, option) {\n    return ({ state, dispatch }) => {\n        if (state.readOnly)\n            return false;\n        let tr = f(option, state);\n        if (!tr)\n            return false;\n        dispatch(state.update(tr));\n        return true;\n    };\n}\n/**\nComment or uncomment the current selection using line comments.\nThe line comment syntax is taken from the\n[`commentTokens`](https://codemirror.net/6/docs/ref/#commands.CommentTokens) [language\ndata](https://codemirror.net/6/docs/ref/#state.EditorState.languageDataAt).\n*/\nconst toggleLineComment = /*@__PURE__*/command(changeLineComment, 0 /* CommentOption.Toggle */);\n/**\nComment the current selection using line comments.\n*/\nconst lineComment = /*@__PURE__*/command(changeLineComment, 1 /* CommentOption.Comment */);\n/**\nUncomment the current selection using line comments.\n*/\nconst lineUncomment = /*@__PURE__*/command(changeLineComment, 2 /* CommentOption.Uncomment */);\n/**\nComment or uncomment the current selection using block comments.\nThe block comment syntax is taken from the\n[`commentTokens`](https://codemirror.net/6/docs/ref/#commands.CommentTokens) [language\ndata](https://codemirror.net/6/docs/ref/#state.EditorState.languageDataAt).\n*/\nconst toggleBlockComment = /*@__PURE__*/command(changeBlockComment, 0 /* CommentOption.Toggle */);\n/**\nComment the current selection using block comments.\n*/\nconst blockComment = /*@__PURE__*/command(changeBlockComment, 1 /* CommentOption.Comment */);\n/**\nUncomment the current selection using block comments.\n*/\nconst blockUncomment = /*@__PURE__*/command(changeBlockComment, 2 /* CommentOption.Uncomment */);\n/**\nComment or uncomment the lines around the current selection using\nblock comments.\n*/\nconst toggleBlockCommentByLine = /*@__PURE__*/command((o, s) => changeBlockComment(o, s, selectedLineRanges(s)), 0 /* CommentOption.Toggle */);\nfunction getConfig(state, pos) {\n    let data = state.languageDataAt(\"commentTokens\", pos);\n    return data.length ? data[0] : {};\n}\nconst SearchMargin = 50;\n/**\nDetermines if the given range is block-commented in the given\nstate.\n*/\nfunction findBlockComment(state, { open, close }, from, to) {\n    let textBefore = state.sliceDoc(from - SearchMargin, from);\n    let textAfter = state.sliceDoc(to, to + SearchMargin);\n    let spaceBefore = /\\s*$/.exec(textBefore)[0].length, spaceAfter = /^\\s*/.exec(textAfter)[0].length;\n    let beforeOff = textBefore.length - spaceBefore;\n    if (textBefore.slice(beforeOff - open.length, beforeOff) == open &&\n        textAfter.slice(spaceAfter, spaceAfter + close.length) == close) {\n        return { open: { pos: from - spaceBefore, margin: spaceBefore && 1 },\n            close: { pos: to + spaceAfter, margin: spaceAfter && 1 } };\n    }\n    let startText, endText;\n    if (to - from <= 2 * SearchMargin) {\n        startText = endText = state.sliceDoc(from, to);\n    }\n    else {\n        startText = state.sliceDoc(from, from + SearchMargin);\n        endText = state.sliceDoc(to - SearchMargin, to);\n    }\n    let startSpace = /^\\s*/.exec(startText)[0].length, endSpace = /\\s*$/.exec(endText)[0].length;\n    let endOff = endText.length - endSpace - close.length;\n    if (startText.slice(startSpace, startSpace + open.length) == open &&\n        endText.slice(endOff, endOff + close.length) == close) {\n        return { open: { pos: from + startSpace + open.length,\n                margin: /\\s/.test(startText.charAt(startSpace + open.length)) ? 1 : 0 },\n            close: { pos: to - endSpace - close.length,\n                margin: /\\s/.test(endText.charAt(endOff - 1)) ? 1 : 0 } };\n    }\n    return null;\n}\nfunction selectedLineRanges(state) {\n    let ranges = [];\n    for (let r of state.selection.ranges) {\n        let fromLine = state.doc.lineAt(r.from);\n        let toLine = r.to <= fromLine.to ? fromLine : state.doc.lineAt(r.to);\n        let last = ranges.length - 1;\n        if (last >= 0 && ranges[last].to > fromLine.from)\n            ranges[last].to = toLine.to;\n        else\n            ranges.push({ from: fromLine.from, to: toLine.to });\n    }\n    return ranges;\n}\n// Performs toggle, comment and uncomment of block comments in\n// languages that support them.\nfunction changeBlockComment(option, state, ranges = state.selection.ranges) {\n    let tokens = ranges.map(r => getConfig(state, r.from).block);\n    if (!tokens.every(c => c))\n        return null;\n    let comments = ranges.map((r, i) => findBlockComment(state, tokens[i], r.from, r.to));\n    if (option != 2 /* CommentOption.Uncomment */ && !comments.every(c => c)) {\n        return { changes: state.changes(ranges.map((range, i) => {\n                if (comments[i])\n                    return [];\n                return [{ from: range.from, insert: tokens[i].open + \" \" }, { from: range.to, insert: \" \" + tokens[i].close }];\n            })) };\n    }\n    else if (option != 1 /* CommentOption.Comment */ && comments.some(c => c)) {\n        let changes = [];\n        for (let i = 0, comment; i < comments.length; i++)\n            if (comment = comments[i]) {\n                let token = tokens[i], { open, close } = comment;\n                changes.push({ from: open.pos - token.open.length, to: open.pos + open.margin }, { from: close.pos - close.margin, to: close.pos + token.close.length });\n            }\n        return { changes };\n    }\n    return null;\n}\n// Performs toggle, comment and uncomment of line comments.\nfunction changeLineComment(option, state, ranges = state.selection.ranges) {\n    let lines = [];\n    let prevLine = -1;\n    for (let { from, to } of ranges) {\n        let startI = lines.length, minIndent = 1e9;\n        for (let pos = from; pos <= to;) {\n            let line = state.doc.lineAt(pos);\n            if (line.from > prevLine && (from == to || to > line.from)) {\n                prevLine = line.from;\n                let token = getConfig(state, line.from).line;\n                if (!token)\n                    continue;\n                let indent = /^\\s*/.exec(line.text)[0].length;\n                let empty = indent == line.length;\n                let comment = line.text.slice(indent, indent + token.length) == token ? indent : -1;\n                if (indent < line.text.length && indent < minIndent)\n                    minIndent = indent;\n                lines.push({ line, comment, token, indent, empty, single: false });\n            }\n            pos = line.to + 1;\n        }\n        if (minIndent < 1e9)\n            for (let i = startI; i < lines.length; i++)\n                if (lines[i].indent < lines[i].line.text.length)\n                    lines[i].indent = minIndent;\n        if (lines.length == startI + 1)\n            lines[startI].single = true;\n    }\n    if (option != 2 /* CommentOption.Uncomment */ && lines.some(l => l.comment < 0 && (!l.empty || l.single))) {\n        let changes = [];\n        for (let { line, token, indent, empty, single } of lines)\n            if (single || !empty)\n                changes.push({ from: line.from + indent, insert: token + \" \" });\n        let changeSet = state.changes(changes);\n        return { changes: changeSet, selection: state.selection.map(changeSet, 1) };\n    }\n    else if (option != 1 /* CommentOption.Comment */ && lines.some(l => l.comment >= 0)) {\n        let changes = [];\n        for (let { line, comment, token } of lines)\n            if (comment >= 0) {\n                let from = line.from + comment, to = from + token.length;\n                if (line.text[to - line.from] == \" \")\n                    to++;\n                changes.push({ from, to });\n            }\n        return { changes };\n    }\n    return null;\n}\n\nconst fromHistory = /*@__PURE__*/Annotation.define();\n/**\nTransaction annotation that will prevent that transaction from\nbeing combined with other transactions in the undo history. Given\n`\"before\"`, it'll prevent merging with previous transactions. With\n`\"after\"`, subsequent transactions won't be combined with this\none. With `\"full\"`, the transaction is isolated on both sides.\n*/\nconst isolateHistory = /*@__PURE__*/Annotation.define();\n/**\nThis facet provides a way to register functions that, given a\ntransaction, provide a set of effects that the history should\nstore when inverting the transaction. This can be used to\nintegrate some kinds of effects in the history, so that they can\nbe undone (and redone again).\n*/\nconst invertedEffects = /*@__PURE__*/Facet.define();\nconst historyConfig = /*@__PURE__*/Facet.define({\n    combine(configs) {\n        return combineConfig(configs, {\n            minDepth: 100,\n            newGroupDelay: 500,\n            joinToEvent: (_t, isAdjacent) => isAdjacent,\n        }, {\n            minDepth: Math.max,\n            newGroupDelay: Math.min,\n            joinToEvent: (a, b) => (tr, adj) => a(tr, adj) || b(tr, adj)\n        });\n    }\n});\nfunction changeEnd(changes) {\n    let end = 0;\n    changes.iterChangedRanges((_, to) => end = to);\n    return end;\n}\nconst historyField_ = /*@__PURE__*/StateField.define({\n    create() {\n        return HistoryState.empty;\n    },\n    update(state, tr) {\n        let config = tr.state.facet(historyConfig);\n        let fromHist = tr.annotation(fromHistory);\n        if (fromHist) {\n            let selection = tr.docChanged ? EditorSelection.single(changeEnd(tr.changes)) : undefined;\n            let item = HistEvent.fromTransaction(tr, selection), from = fromHist.side;\n            let other = from == 0 /* BranchName.Done */ ? state.undone : state.done;\n            if (item)\n                other = updateBranch(other, other.length, config.minDepth, item);\n            else\n                other = addSelection(other, tr.startState.selection);\n            return new HistoryState(from == 0 /* BranchName.Done */ ? fromHist.rest : other, from == 0 /* BranchName.Done */ ? other : fromHist.rest);\n        }\n        let isolate = tr.annotation(isolateHistory);\n        if (isolate == \"full\" || isolate == \"before\")\n            state = state.isolate();\n        if (tr.annotation(Transaction.addToHistory) === false)\n            return !tr.changes.empty ? state.addMapping(tr.changes.desc) : state;\n        let event = HistEvent.fromTransaction(tr);\n        let time = tr.annotation(Transaction.time), userEvent = tr.annotation(Transaction.userEvent);\n        if (event)\n            state = state.addChanges(event, time, userEvent, config, tr);\n        else if (tr.selection)\n            state = state.addSelection(tr.startState.selection, time, userEvent, config.newGroupDelay);\n        if (isolate == \"full\" || isolate == \"after\")\n            state = state.isolate();\n        return state;\n    },\n    toJSON(value) {\n        return { done: value.done.map(e => e.toJSON()), undone: value.undone.map(e => e.toJSON()) };\n    },\n    fromJSON(json) {\n        return new HistoryState(json.done.map(HistEvent.fromJSON), json.undone.map(HistEvent.fromJSON));\n    }\n});\n/**\nCreate a history extension with the given configuration.\n*/\nfunction history(config = {}) {\n    return [\n        historyField_,\n        historyConfig.of(config),\n        EditorView.domEventHandlers({\n            beforeinput(e, view) {\n                let command = e.inputType == \"historyUndo\" ? undo : e.inputType == \"historyRedo\" ? redo : null;\n                if (!command)\n                    return false;\n                e.preventDefault();\n                return command(view);\n            }\n        })\n    ];\n}\n/**\nThe state field used to store the history data. Should probably\nonly be used when you want to\n[serialize](https://codemirror.net/6/docs/ref/#state.EditorState.toJSON) or\n[deserialize](https://codemirror.net/6/docs/ref/#state.EditorState^fromJSON) state objects in a way\nthat preserves history.\n*/\nconst historyField = historyField_;\nfunction cmd(side, selection) {\n    return function ({ state, dispatch }) {\n        if (!selection && state.readOnly)\n            return false;\n        let historyState = state.field(historyField_, false);\n        if (!historyState)\n            return false;\n        let tr = historyState.pop(side, state, selection);\n        if (!tr)\n            return false;\n        dispatch(tr);\n        return true;\n    };\n}\n/**\nUndo a single group of history events. Returns false if no group\nwas available.\n*/\nconst undo = /*@__PURE__*/cmd(0 /* BranchName.Done */, false);\n/**\nRedo a group of history events. Returns false if no group was\navailable.\n*/\nconst redo = /*@__PURE__*/cmd(1 /* BranchName.Undone */, false);\n/**\nUndo a change or selection change.\n*/\nconst undoSelection = /*@__PURE__*/cmd(0 /* BranchName.Done */, true);\n/**\nRedo a change or selection change.\n*/\nconst redoSelection = /*@__PURE__*/cmd(1 /* BranchName.Undone */, true);\nfunction depth(side) {\n    return function (state) {\n        let histState = state.field(historyField_, false);\n        if (!histState)\n            return 0;\n        let branch = side == 0 /* BranchName.Done */ ? histState.done : histState.undone;\n        return branch.length - (branch.length && !branch[0].changes ? 1 : 0);\n    };\n}\n/**\nThe amount of undoable change events available in a given state.\n*/\nconst undoDepth = /*@__PURE__*/depth(0 /* BranchName.Done */);\n/**\nThe amount of redoable change events available in a given state.\n*/\nconst redoDepth = /*@__PURE__*/depth(1 /* BranchName.Undone */);\n// History events store groups of changes or effects that need to be\n// undone/redone together.\nclass HistEvent {\n    constructor(\n    // The changes in this event. Normal events hold at least one\n    // change or effect. But it may be necessary to store selection\n    // events before the first change, in which case a special type of\n    // instance is created which doesn't hold any changes, with\n    // changes == startSelection == undefined\n    changes, \n    // The effects associated with this event\n    effects, \n    // Accumulated mapping (from addToHistory==false) that should be\n    // applied to events below this one.\n    mapped, \n    // The selection before this event\n    startSelection, \n    // Stores selection changes after this event, to be used for\n    // selection undo/redo.\n    selectionsAfter) {\n        this.changes = changes;\n        this.effects = effects;\n        this.mapped = mapped;\n        this.startSelection = startSelection;\n        this.selectionsAfter = selectionsAfter;\n    }\n    setSelAfter(after) {\n        return new HistEvent(this.changes, this.effects, this.mapped, this.startSelection, after);\n    }\n    toJSON() {\n        var _a, _b, _c;\n        return {\n            changes: (_a = this.changes) === null || _a === void 0 ? void 0 : _a.toJSON(),\n            mapped: (_b = this.mapped) === null || _b === void 0 ? void 0 : _b.toJSON(),\n            startSelection: (_c = this.startSelection) === null || _c === void 0 ? void 0 : _c.toJSON(),\n            selectionsAfter: this.selectionsAfter.map(s => s.toJSON())\n        };\n    }\n    static fromJSON(json) {\n        return new HistEvent(json.changes && ChangeSet.fromJSON(json.changes), [], json.mapped && ChangeDesc.fromJSON(json.mapped), json.startSelection && EditorSelection.fromJSON(json.startSelection), json.selectionsAfter.map(EditorSelection.fromJSON));\n    }\n    // This does not check `addToHistory` and such, it assumes the\n    // transaction needs to be converted to an item. Returns null when\n    // there are no changes or effects in the transaction.\n    static fromTransaction(tr, selection) {\n        let effects = none;\n        for (let invert of tr.startState.facet(invertedEffects)) {\n            let result = invert(tr);\n            if (result.length)\n                effects = effects.concat(result);\n        }\n        if (!effects.length && tr.changes.empty)\n            return null;\n        return new HistEvent(tr.changes.invert(tr.startState.doc), effects, undefined, selection || tr.startState.selection, none);\n    }\n    static selection(selections) {\n        return new HistEvent(undefined, none, undefined, undefined, selections);\n    }\n}\nfunction updateBranch(branch, to, maxLen, newEvent) {\n    let start = to + 1 > maxLen + 20 ? to - maxLen - 1 : 0;\n    let newBranch = branch.slice(start, to);\n    newBranch.push(newEvent);\n    return newBranch;\n}\nfunction isAdjacent(a, b) {\n    let ranges = [], isAdjacent = false;\n    a.iterChangedRanges((f, t) => ranges.push(f, t));\n    b.iterChangedRanges((_f, _t, f, t) => {\n        for (let i = 0; i < ranges.length;) {\n            let from = ranges[i++], to = ranges[i++];\n            if (t >= from && f <= to)\n                isAdjacent = true;\n        }\n    });\n    return isAdjacent;\n}\nfunction eqSelectionShape(a, b) {\n    return a.ranges.length == b.ranges.length &&\n        a.ranges.filter((r, i) => r.empty != b.ranges[i].empty).length === 0;\n}\nfunction conc(a, b) {\n    return !a.length ? b : !b.length ? a : a.concat(b);\n}\nconst none = [];\nconst MaxSelectionsPerEvent = 200;\nfunction addSelection(branch, selection) {\n    if (!branch.length) {\n        return [HistEvent.selection([selection])];\n    }\n    else {\n        let lastEvent = branch[branch.length - 1];\n        let sels = lastEvent.selectionsAfter.slice(Math.max(0, lastEvent.selectionsAfter.length - MaxSelectionsPerEvent));\n        if (sels.length && sels[sels.length - 1].eq(selection))\n            return branch;\n        sels.push(selection);\n        return updateBranch(branch, branch.length - 1, 1e9, lastEvent.setSelAfter(sels));\n    }\n}\n// Assumes the top item has one or more selectionAfter values\nfunction popSelection(branch) {\n    let last = branch[branch.length - 1];\n    let newBranch = branch.slice();\n    newBranch[branch.length - 1] = last.setSelAfter(last.selectionsAfter.slice(0, last.selectionsAfter.length - 1));\n    return newBranch;\n}\n// Add a mapping to the top event in the given branch. If this maps\n// away all the changes and effects in that item, drop it and\n// propagate the mapping to the next item.\nfunction addMappingToBranch(branch, mapping) {\n    if (!branch.length)\n        return branch;\n    let length = branch.length, selections = none;\n    while (length) {\n        let event = mapEvent(branch[length - 1], mapping, selections);\n        if (event.changes && !event.changes.empty || event.effects.length) { // Event survived mapping\n            let result = branch.slice(0, length);\n            result[length - 1] = event;\n            return result;\n        }\n        else { // Drop this event, since there's no changes or effects left\n            mapping = event.mapped;\n            length--;\n            selections = event.selectionsAfter;\n        }\n    }\n    return selections.length ? [HistEvent.selection(selections)] : none;\n}\nfunction mapEvent(event, mapping, extraSelections) {\n    let selections = conc(event.selectionsAfter.length ? event.selectionsAfter.map(s => s.map(mapping)) : none, extraSelections);\n    // Change-less events don't store mappings (they are always the last event in a branch)\n    if (!event.changes)\n        return HistEvent.selection(selections);\n    let mappedChanges = event.changes.map(mapping), before = mapping.mapDesc(event.changes, true);\n    let fullMapping = event.mapped ? event.mapped.composeDesc(before) : before;\n    return new HistEvent(mappedChanges, StateEffect.mapEffects(event.effects, mapping), fullMapping, event.startSelection.map(before), selections);\n}\nconst joinableUserEvent = /^(input\\.type|delete)($|\\.)/;\nclass HistoryState {\n    constructor(done, undone, prevTime = 0, prevUserEvent = undefined) {\n        this.done = done;\n        this.undone = undone;\n        this.prevTime = prevTime;\n        this.prevUserEvent = prevUserEvent;\n    }\n    isolate() {\n        return this.prevTime ? new HistoryState(this.done, this.undone) : this;\n    }\n    addChanges(event, time, userEvent, config, tr) {\n        let done = this.done, lastEvent = done[done.length - 1];\n        if (lastEvent && lastEvent.changes && !lastEvent.changes.empty && event.changes &&\n            (!userEvent || joinableUserEvent.test(userEvent)) &&\n            ((!lastEvent.selectionsAfter.length &&\n                time - this.prevTime < config.newGroupDelay &&\n                config.joinToEvent(tr, isAdjacent(lastEvent.changes, event.changes))) ||\n                // For compose (but not compose.start) events, always join with previous event\n                userEvent == \"input.type.compose\")) {\n            done = updateBranch(done, done.length - 1, config.minDepth, new HistEvent(event.changes.compose(lastEvent.changes), conc(event.effects, lastEvent.effects), lastEvent.mapped, lastEvent.startSelection, none));\n        }\n        else {\n            done = updateBranch(done, done.length, config.minDepth, event);\n        }\n        return new HistoryState(done, none, time, userEvent);\n    }\n    addSelection(selection, time, userEvent, newGroupDelay) {\n        let last = this.done.length ? this.done[this.done.length - 1].selectionsAfter : none;\n        if (last.length > 0 &&\n            time - this.prevTime < newGroupDelay &&\n            userEvent == this.prevUserEvent && userEvent && /^select($|\\.)/.test(userEvent) &&\n            eqSelectionShape(last[last.length - 1], selection))\n            return this;\n        return new HistoryState(addSelection(this.done, selection), this.undone, time, userEvent);\n    }\n    addMapping(mapping) {\n        return new HistoryState(addMappingToBranch(this.done, mapping), addMappingToBranch(this.undone, mapping), this.prevTime, this.prevUserEvent);\n    }\n    pop(side, state, selection) {\n        let branch = side == 0 /* BranchName.Done */ ? this.done : this.undone;\n        if (branch.length == 0)\n            return null;\n        let event = branch[branch.length - 1];\n        if (selection && event.selectionsAfter.length) {\n            return state.update({\n                selection: event.selectionsAfter[event.selectionsAfter.length - 1],\n                annotations: fromHistory.of({ side, rest: popSelection(branch) }),\n                userEvent: side == 0 /* BranchName.Done */ ? \"select.undo\" : \"select.redo\",\n                scrollIntoView: true\n            });\n        }\n        else if (!event.changes) {\n            return null;\n        }\n        else {\n            let rest = branch.length == 1 ? none : branch.slice(0, branch.length - 1);\n            if (event.mapped)\n                rest = addMappingToBranch(rest, event.mapped);\n            return state.update({\n                changes: event.changes,\n                selection: event.startSelection,\n                effects: event.effects,\n                annotations: fromHistory.of({ side, rest }),\n                filter: false,\n                userEvent: side == 0 /* BranchName.Done */ ? \"undo\" : \"redo\",\n                scrollIntoView: true\n            });\n        }\n    }\n}\nHistoryState.empty = /*@__PURE__*/new HistoryState(none, none);\n/**\nDefault key bindings for the undo history.\n\n- Mod-z: [`undo`](https://codemirror.net/6/docs/ref/#commands.undo).\n- Mod-y (Mod-Shift-z on macOS) + Ctrl-Shift-z on Linux: [`redo`](https://codemirror.net/6/docs/ref/#commands.redo).\n- Mod-u: [`undoSelection`](https://codemirror.net/6/docs/ref/#commands.undoSelection).\n- Alt-u (Mod-Shift-u on macOS): [`redoSelection`](https://codemirror.net/6/docs/ref/#commands.redoSelection).\n*/\nconst historyKeymap = [\n    { key: \"Mod-z\", run: undo, preventDefault: true },\n    { key: \"Mod-y\", mac: \"Mod-Shift-z\", run: redo, preventDefault: true },\n    { linux: \"Ctrl-Shift-z\", run: redo, preventDefault: true },\n    { key: \"Mod-u\", run: undoSelection, preventDefault: true },\n    { key: \"Alt-u\", mac: \"Mod-Shift-u\", run: redoSelection, preventDefault: true }\n];\n\nfunction updateSel(sel, by) {\n    return EditorSelection.create(sel.ranges.map(by), sel.mainIndex);\n}\nfunction setSel(state, selection) {\n    return state.update({ selection, scrollIntoView: true, userEvent: \"select\" });\n}\nfunction moveSel({ state, dispatch }, how) {\n    let selection = updateSel(state.selection, how);\n    if (selection.eq(state.selection))\n        return false;\n    dispatch(setSel(state, selection));\n    return true;\n}\nfunction rangeEnd(range, forward) {\n    return EditorSelection.cursor(forward ? range.to : range.from);\n}\nfunction cursorByChar(view, forward) {\n    return moveSel(view, range => range.empty ? view.moveByChar(range, forward) : rangeEnd(range, forward));\n}\nfunction ltrAtCursor(view) {\n    return view.textDirectionAt(view.state.selection.main.head) == Direction.LTR;\n}\n/**\nMove the selection one character to the left (which is backward in\nleft-to-right text, forward in right-to-left text).\n*/\nconst cursorCharLeft = view => cursorByChar(view, !ltrAtCursor(view));\n/**\nMove the selection one character to the right.\n*/\nconst cursorCharRight = view => cursorByChar(view, ltrAtCursor(view));\n/**\nMove the selection one character forward.\n*/\nconst cursorCharForward = view => cursorByChar(view, true);\n/**\nMove the selection one character backward.\n*/\nconst cursorCharBackward = view => cursorByChar(view, false);\nfunction cursorByGroup(view, forward) {\n    return moveSel(view, range => range.empty ? view.moveByGroup(range, forward) : rangeEnd(range, forward));\n}\n/**\nMove the selection to the left across one group of word or\nnon-word (but also non-space) characters.\n*/\nconst cursorGroupLeft = view => cursorByGroup(view, !ltrAtCursor(view));\n/**\nMove the selection one group to the right.\n*/\nconst cursorGroupRight = view => cursorByGroup(view, ltrAtCursor(view));\n/**\nMove the selection one group forward.\n*/\nconst cursorGroupForward = view => cursorByGroup(view, true);\n/**\nMove the selection one group backward.\n*/\nconst cursorGroupBackward = view => cursorByGroup(view, false);\nfunction moveBySubword(view, range, forward) {\n    let categorize = view.state.charCategorizer(range.from);\n    return view.moveByChar(range, forward, start => {\n        let cat = CharCategory.Space, pos = range.from;\n        let done = false, sawUpper = false, sawLower = false;\n        let step = (next) => {\n            if (done)\n                return false;\n            pos += forward ? next.length : -next.length;\n            let nextCat = categorize(next), ahead;\n            if (cat == CharCategory.Space)\n                cat = nextCat;\n            if (cat != nextCat)\n                return false;\n            if (cat == CharCategory.Word) {\n                if (next.toLowerCase() == next) {\n                    if (!forward && sawUpper)\n                        return false;\n                    sawLower = true;\n                }\n                else if (sawLower) {\n                    if (forward)\n                        return false;\n                    done = true;\n                }\n                else {\n                    if (sawUpper && forward && categorize(ahead = view.state.sliceDoc(pos, pos + 1)) == CharCategory.Word &&\n                        ahead.toLowerCase() == ahead)\n                        return false;\n                    sawUpper = true;\n                }\n            }\n            return true;\n        };\n        step(start);\n        return step;\n    });\n}\nfunction cursorBySubword(view, forward) {\n    return moveSel(view, range => range.empty ? moveBySubword(view, range, forward) : rangeEnd(range, forward));\n}\n/**\nMove the selection one group or camel-case subword forward.\n*/\nconst cursorSubwordForward = view => cursorBySubword(view, true);\n/**\nMove the selection one group or camel-case subword backward.\n*/\nconst cursorSubwordBackward = view => cursorBySubword(view, false);\nfunction interestingNode(state, node, bracketProp) {\n    if (node.type.prop(bracketProp))\n        return true;\n    let len = node.to - node.from;\n    return len && (len > 2 || /[^\\s,.;:]/.test(state.sliceDoc(node.from, node.to))) || node.firstChild;\n}\nfunction moveBySyntax(state, start, forward) {\n    let pos = syntaxTree(state).resolveInner(start.head);\n    let bracketProp = forward ? NodeProp.closedBy : NodeProp.openedBy;\n    // Scan forward through child nodes to see if there's an interesting\n    // node ahead.\n    for (let at = start.head;;) {\n        let next = forward ? pos.childAfter(at) : pos.childBefore(at);\n        if (!next)\n            break;\n        if (interestingNode(state, next, bracketProp))\n            pos = next;\n        else\n            at = forward ? next.to : next.from;\n    }\n    let bracket = pos.type.prop(bracketProp), match, newPos;\n    if (bracket && (match = forward ? matchBrackets(state, pos.from, 1) : matchBrackets(state, pos.to, -1)) && match.matched)\n        newPos = forward ? match.end.to : match.end.from;\n    else\n        newPos = forward ? pos.to : pos.from;\n    return EditorSelection.cursor(newPos, forward ? -1 : 1);\n}\n/**\nMove the cursor over the next syntactic element to the left.\n*/\nconst cursorSyntaxLeft = view => moveSel(view, range => moveBySyntax(view.state, range, !ltrAtCursor(view)));\n/**\nMove the cursor over the next syntactic element to the right.\n*/\nconst cursorSyntaxRight = view => moveSel(view, range => moveBySyntax(view.state, range, ltrAtCursor(view)));\nfunction cursorByLine(view, forward) {\n    return moveSel(view, range => {\n        if (!range.empty)\n            return rangeEnd(range, forward);\n        let moved = view.moveVertically(range, forward);\n        return moved.head != range.head ? moved : view.moveToLineBoundary(range, forward);\n    });\n}\n/**\nMove the selection one line up.\n*/\nconst cursorLineUp = view => cursorByLine(view, false);\n/**\nMove the selection one line down.\n*/\nconst cursorLineDown = view => cursorByLine(view, true);\nfunction pageInfo(view) {\n    let selfScroll = view.scrollDOM.clientHeight < view.scrollDOM.scrollHeight - 2;\n    let marginTop = 0, marginBottom = 0, height;\n    if (selfScroll) {\n        for (let source of view.state.facet(EditorView.scrollMargins)) {\n            let margins = source(view);\n            if (margins === null || margins === void 0 ? void 0 : margins.top)\n                marginTop = Math.max(margins === null || margins === void 0 ? void 0 : margins.top, marginTop);\n            if (margins === null || margins === void 0 ? void 0 : margins.bottom)\n                marginBottom = Math.max(margins === null || margins === void 0 ? void 0 : margins.bottom, marginBottom);\n        }\n        height = view.scrollDOM.clientHeight - marginTop - marginBottom;\n    }\n    else {\n        height = (view.dom.ownerDocument.defaultView || window).innerHeight;\n    }\n    return { marginTop, marginBottom, selfScroll,\n        height: Math.max(view.defaultLineHeight, height - 5) };\n}\nfunction cursorByPage(view, forward) {\n    let page = pageInfo(view);\n    let { state } = view, selection = updateSel(state.selection, range => {\n        return range.empty ? view.moveVertically(range, forward, page.height)\n            : rangeEnd(range, forward);\n    });\n    if (selection.eq(state.selection))\n        return false;\n    let effect;\n    if (page.selfScroll) {\n        let startPos = view.coordsAtPos(state.selection.main.head);\n        let scrollRect = view.scrollDOM.getBoundingClientRect();\n        let scrollTop = scrollRect.top + page.marginTop, scrollBottom = scrollRect.bottom - page.marginBottom;\n        if (startPos && startPos.top > scrollTop && startPos.bottom < scrollBottom)\n            effect = EditorView.scrollIntoView(selection.main.head, { y: \"start\", yMargin: startPos.top - scrollTop });\n    }\n    view.dispatch(setSel(state, selection), { effects: effect });\n    return true;\n}\n/**\nMove the selection one page up.\n*/\nconst cursorPageUp = view => cursorByPage(view, false);\n/**\nMove the selection one page down.\n*/\nconst cursorPageDown = view => cursorByPage(view, true);\nfunction moveByLineBoundary(view, start, forward) {\n    let line = view.lineBlockAt(start.head), moved = view.moveToLineBoundary(start, forward);\n    if (moved.head == start.head && moved.head != (forward ? line.to : line.from))\n        moved = view.moveToLineBoundary(start, forward, false);\n    if (!forward && moved.head == line.from && line.length) {\n        let space = /^\\s*/.exec(view.state.sliceDoc(line.from, Math.min(line.from + 100, line.to)))[0].length;\n        if (space && start.head != line.from + space)\n            moved = EditorSelection.cursor(line.from + space);\n    }\n    return moved;\n}\n/**\nMove the selection to the next line wrap point, or to the end of\nthe line if there isn't one left on this line.\n*/\nconst cursorLineBoundaryForward = view => moveSel(view, range => moveByLineBoundary(view, range, true));\n/**\nMove the selection to previous line wrap point, or failing that to\nthe start of the line. If the line is indented, and the cursor\nisn't already at the end of the indentation, this will move to the\nend of the indentation instead of the start of the line.\n*/\nconst cursorLineBoundaryBackward = view => moveSel(view, range => moveByLineBoundary(view, range, false));\n/**\nMove the selection one line wrap point to the left.\n*/\nconst cursorLineBoundaryLeft = view => moveSel(view, range => moveByLineBoundary(view, range, !ltrAtCursor(view)));\n/**\nMove the selection one line wrap point to the right.\n*/\nconst cursorLineBoundaryRight = view => moveSel(view, range => moveByLineBoundary(view, range, ltrAtCursor(view)));\n/**\nMove the selection to the start of the line.\n*/\nconst cursorLineStart = view => moveSel(view, range => EditorSelection.cursor(view.lineBlockAt(range.head).from, 1));\n/**\nMove the selection to the end of the line.\n*/\nconst cursorLineEnd = view => moveSel(view, range => EditorSelection.cursor(view.lineBlockAt(range.head).to, -1));\nfunction toMatchingBracket(state, dispatch, extend) {\n    let found = false, selection = updateSel(state.selection, range => {\n        let matching = matchBrackets(state, range.head, -1)\n            || matchBrackets(state, range.head, 1)\n            || (range.head > 0 && matchBrackets(state, range.head - 1, 1))\n            || (range.head < state.doc.length && matchBrackets(state, range.head + 1, -1));\n        if (!matching || !matching.end)\n            return range;\n        found = true;\n        let head = matching.start.from == range.head ? matching.end.to : matching.end.from;\n        return extend ? EditorSelection.range(range.anchor, head) : EditorSelection.cursor(head);\n    });\n    if (!found)\n        return false;\n    dispatch(setSel(state, selection));\n    return true;\n}\n/**\nMove the selection to the bracket matching the one it is currently\non, if any.\n*/\nconst cursorMatchingBracket = ({ state, dispatch }) => toMatchingBracket(state, dispatch, false);\n/**\nExtend the selection to the bracket matching the one the selection\nhead is currently on, if any.\n*/\nconst selectMatchingBracket = ({ state, dispatch }) => toMatchingBracket(state, dispatch, true);\nfunction extendSel(view, how) {\n    let selection = updateSel(view.state.selection, range => {\n        let head = how(range);\n        return EditorSelection.range(range.anchor, head.head, head.goalColumn, head.bidiLevel || undefined);\n    });\n    if (selection.eq(view.state.selection))\n        return false;\n    view.dispatch(setSel(view.state, selection));\n    return true;\n}\nfunction selectByChar(view, forward) {\n    return extendSel(view, range => view.moveByChar(range, forward));\n}\n/**\nMove the selection head one character to the left, while leaving\nthe anchor in place.\n*/\nconst selectCharLeft = view => selectByChar(view, !ltrAtCursor(view));\n/**\nMove the selection head one character to the right.\n*/\nconst selectCharRight = view => selectByChar(view, ltrAtCursor(view));\n/**\nMove the selection head one character forward.\n*/\nconst selectCharForward = view => selectByChar(view, true);\n/**\nMove the selection head one character backward.\n*/\nconst selectCharBackward = view => selectByChar(view, false);\nfunction selectByGroup(view, forward) {\n    return extendSel(view, range => view.moveByGroup(range, forward));\n}\n/**\nMove the selection head one [group](https://codemirror.net/6/docs/ref/#commands.cursorGroupLeft) to\nthe left.\n*/\nconst selectGroupLeft = view => selectByGroup(view, !ltrAtCursor(view));\n/**\nMove the selection head one group to the right.\n*/\nconst selectGroupRight = view => selectByGroup(view, ltrAtCursor(view));\n/**\nMove the selection head one group forward.\n*/\nconst selectGroupForward = view => selectByGroup(view, true);\n/**\nMove the selection head one group backward.\n*/\nconst selectGroupBackward = view => selectByGroup(view, false);\nfunction selectBySubword(view, forward) {\n    return extendSel(view, range => moveBySubword(view, range, forward));\n}\n/**\nMove the selection head one group or camel-case subword forward.\n*/\nconst selectSubwordForward = view => selectBySubword(view, true);\n/**\nMove the selection head one group or subword backward.\n*/\nconst selectSubwordBackward = view => selectBySubword(view, false);\n/**\nMove the selection head over the next syntactic element to the left.\n*/\nconst selectSyntaxLeft = view => extendSel(view, range => moveBySyntax(view.state, range, !ltrAtCursor(view)));\n/**\nMove the selection head over the next syntactic element to the right.\n*/\nconst selectSyntaxRight = view => extendSel(view, range => moveBySyntax(view.state, range, ltrAtCursor(view)));\nfunction selectByLine(view, forward) {\n    return extendSel(view, range => view.moveVertically(range, forward));\n}\n/**\nMove the selection head one line up.\n*/\nconst selectLineUp = view => selectByLine(view, false);\n/**\nMove the selection head one line down.\n*/\nconst selectLineDown = view => selectByLine(view, true);\nfunction selectByPage(view, forward) {\n    return extendSel(view, range => view.moveVertically(range, forward, pageInfo(view).height));\n}\n/**\nMove the selection head one page up.\n*/\nconst selectPageUp = view => selectByPage(view, false);\n/**\nMove the selection head one page down.\n*/\nconst selectPageDown = view => selectByPage(view, true);\n/**\nMove the selection head to the next line boundary.\n*/\nconst selectLineBoundaryForward = view => extendSel(view, range => moveByLineBoundary(view, range, true));\n/**\nMove the selection head to the previous line boundary.\n*/\nconst selectLineBoundaryBackward = view => extendSel(view, range => moveByLineBoundary(view, range, false));\n/**\nMove the selection head one line boundary to the left.\n*/\nconst selectLineBoundaryLeft = view => extendSel(view, range => moveByLineBoundary(view, range, !ltrAtCursor(view)));\n/**\nMove the selection head one line boundary to the right.\n*/\nconst selectLineBoundaryRight = view => extendSel(view, range => moveByLineBoundary(view, range, ltrAtCursor(view)));\n/**\nMove the selection head to the start of the line.\n*/\nconst selectLineStart = view => extendSel(view, range => EditorSelection.cursor(view.lineBlockAt(range.head).from));\n/**\nMove the selection head to the end of the line.\n*/\nconst selectLineEnd = view => extendSel(view, range => EditorSelection.cursor(view.lineBlockAt(range.head).to));\n/**\nMove the selection to the start of the document.\n*/\nconst cursorDocStart = ({ state, dispatch }) => {\n    dispatch(setSel(state, { anchor: 0 }));\n    return true;\n};\n/**\nMove the selection to the end of the document.\n*/\nconst cursorDocEnd = ({ state, dispatch }) => {\n    dispatch(setSel(state, { anchor: state.doc.length }));\n    return true;\n};\n/**\nMove the selection head to the start of the document.\n*/\nconst selectDocStart = ({ state, dispatch }) => {\n    dispatch(setSel(state, { anchor: state.selection.main.anchor, head: 0 }));\n    return true;\n};\n/**\nMove the selection head to the end of the document.\n*/\nconst selectDocEnd = ({ state, dispatch }) => {\n    dispatch(setSel(state, { anchor: state.selection.main.anchor, head: state.doc.length }));\n    return true;\n};\n/**\nSelect the entire document.\n*/\nconst selectAll = ({ state, dispatch }) => {\n    dispatch(state.update({ selection: { anchor: 0, head: state.doc.length }, userEvent: \"select\" }));\n    return true;\n};\n/**\nExpand the selection to cover entire lines.\n*/\nconst selectLine = ({ state, dispatch }) => {\n    let ranges = selectedLineBlocks(state).map(({ from, to }) => EditorSelection.range(from, Math.min(to + 1, state.doc.length)));\n    dispatch(state.update({ selection: EditorSelection.create(ranges), userEvent: \"select\" }));\n    return true;\n};\n/**\nSelect the next syntactic construct that is larger than the\nselection. Note that this will only work insofar as the language\n[provider](https://codemirror.net/6/docs/ref/#language.language) you use builds up a full\nsyntax tree.\n*/\nconst selectParentSyntax = ({ state, dispatch }) => {\n    let selection = updateSel(state.selection, range => {\n        var _a;\n        let context = syntaxTree(state).resolveInner(range.head, 1);\n        while (!((context.from < range.from && context.to >= range.to) ||\n            (context.to > range.to && context.from <= range.from) ||\n            !((_a = context.parent) === null || _a === void 0 ? void 0 : _a.parent)))\n            context = context.parent;\n        return EditorSelection.range(context.to, context.from);\n    });\n    dispatch(setSel(state, selection));\n    return true;\n};\n/**\nSimplify the current selection. When multiple ranges are selected,\nreduce it to its main range. Otherwise, if the selection is\nnon-empty, convert it to a cursor selection.\n*/\nconst simplifySelection = ({ state, dispatch }) => {\n    let cur = state.selection, selection = null;\n    if (cur.ranges.length > 1)\n        selection = EditorSelection.create([cur.main]);\n    else if (!cur.main.empty)\n        selection = EditorSelection.create([EditorSelection.cursor(cur.main.head)]);\n    if (!selection)\n        return false;\n    dispatch(setSel(state, selection));\n    return true;\n};\nfunction deleteBy(target, by) {\n    if (target.state.readOnly)\n        return false;\n    let event = \"delete.selection\", { state } = target;\n    let changes = state.changeByRange(range => {\n        let { from, to } = range;\n        if (from == to) {\n            let towards = by(from);\n            if (towards < from) {\n                event = \"delete.backward\";\n                towards = skipAtomic(target, towards, false);\n            }\n            else if (towards > from) {\n                event = \"delete.forward\";\n                towards = skipAtomic(target, towards, true);\n            }\n            from = Math.min(from, towards);\n            to = Math.max(to, towards);\n        }\n        else {\n            from = skipAtomic(target, from, false);\n            to = skipAtomic(target, to, true);\n        }\n        return from == to ? { range } : { changes: { from, to }, range: EditorSelection.cursor(from) };\n    });\n    if (changes.changes.empty)\n        return false;\n    target.dispatch(state.update(changes, {\n        scrollIntoView: true,\n        userEvent: event,\n        effects: event == \"delete.selection\" ? EditorView.announce.of(state.phrase(\"Selection deleted\")) : undefined\n    }));\n    return true;\n}\nfunction skipAtomic(target, pos, forward) {\n    if (target instanceof EditorView)\n        for (let ranges of target.state.facet(EditorView.atomicRanges).map(f => f(target)))\n            ranges.between(pos, pos, (from, to) => {\n                if (from < pos && to > pos)\n                    pos = forward ? to : from;\n            });\n    return pos;\n}\nconst deleteByChar = (target, forward) => deleteBy(target, pos => {\n    let { state } = target, line = state.doc.lineAt(pos), before, targetPos;\n    if (!forward && pos > line.from && pos < line.from + 200 &&\n        !/[^ \\t]/.test(before = line.text.slice(0, pos - line.from))) {\n        if (before[before.length - 1] == \"\\t\")\n            return pos - 1;\n        let col = countColumn(before, state.tabSize), drop = col % getIndentUnit(state) || getIndentUnit(state);\n        for (let i = 0; i < drop && before[before.length - 1 - i] == \" \"; i++)\n            pos--;\n        targetPos = pos;\n    }\n    else {\n        targetPos = findClusterBreak(line.text, pos - line.from, forward, forward) + line.from;\n        if (targetPos == pos && line.number != (forward ? state.doc.lines : 1))\n            targetPos += forward ? 1 : -1;\n    }\n    return targetPos;\n});\n/**\nDelete the selection, or, for cursor selections, the character\nbefore the cursor.\n*/\nconst deleteCharBackward = view => deleteByChar(view, false);\n/**\nDelete the selection or the character after the cursor.\n*/\nconst deleteCharForward = view => deleteByChar(view, true);\nconst deleteByGroup = (target, forward) => deleteBy(target, start => {\n    let pos = start, { state } = target, line = state.doc.lineAt(pos);\n    let categorize = state.charCategorizer(pos);\n    for (let cat = null;;) {\n        if (pos == (forward ? line.to : line.from)) {\n            if (pos == start && line.number != (forward ? state.doc.lines : 1))\n                pos += forward ? 1 : -1;\n            break;\n        }\n        let next = findClusterBreak(line.text, pos - line.from, forward) + line.from;\n        let nextChar = line.text.slice(Math.min(pos, next) - line.from, Math.max(pos, next) - line.from);\n        let nextCat = categorize(nextChar);\n        if (cat != null && nextCat != cat)\n            break;\n        if (nextChar != \" \" || pos != start)\n            cat = nextCat;\n        pos = next;\n    }\n    return pos;\n});\n/**\nDelete the selection or backward until the end of the next\n[group](https://codemirror.net/6/docs/ref/#view.EditorView.moveByGroup), only skipping groups of\nwhitespace when they consist of a single space.\n*/\nconst deleteGroupBackward = target => deleteByGroup(target, false);\n/**\nDelete the selection or forward until the end of the next group.\n*/\nconst deleteGroupForward = target => deleteByGroup(target, true);\n/**\nDelete the selection, or, if it is a cursor selection, delete to\nthe end of the line. If the cursor is directly at the end of the\nline, delete the line break after it.\n*/\nconst deleteToLineEnd = view => deleteBy(view, pos => {\n    let lineEnd = view.lineBlockAt(pos).to;\n    return pos < lineEnd ? lineEnd : Math.min(view.state.doc.length, pos + 1);\n});\n/**\nDelete the selection, or, if it is a cursor selection, delete to\nthe start of the line. If the cursor is directly at the start of the\nline, delete the line break before it.\n*/\nconst deleteToLineStart = view => deleteBy(view, pos => {\n    let lineStart = view.lineBlockAt(pos).from;\n    return pos > lineStart ? lineStart : Math.max(0, pos - 1);\n});\n/**\nDelete all whitespace directly before a line end from the\ndocument.\n*/\nconst deleteTrailingWhitespace = ({ state, dispatch }) => {\n    if (state.readOnly)\n        return false;\n    let changes = [];\n    for (let pos = 0, prev = \"\", iter = state.doc.iter();;) {\n        iter.next();\n        if (iter.lineBreak || iter.done) {\n            let trailing = prev.search(/\\s+$/);\n            if (trailing > -1)\n                changes.push({ from: pos - (prev.length - trailing), to: pos });\n            if (iter.done)\n                break;\n            prev = \"\";\n        }\n        else {\n            prev = iter.value;\n        }\n        pos += iter.value.length;\n    }\n    if (!changes.length)\n        return false;\n    dispatch(state.update({ changes, userEvent: \"delete\" }));\n    return true;\n};\n/**\nReplace each selection range with a line break, leaving the cursor\non the line before the break.\n*/\nconst splitLine = ({ state, dispatch }) => {\n    if (state.readOnly)\n        return false;\n    let changes = state.changeByRange(range => {\n        return { changes: { from: range.from, to: range.to, insert: Text.of([\"\", \"\"]) },\n            range: EditorSelection.cursor(range.from) };\n    });\n    dispatch(state.update(changes, { scrollIntoView: true, userEvent: \"input\" }));\n    return true;\n};\n/**\nFlip the characters before and after the cursor(s).\n*/\nconst transposeChars = ({ state, dispatch }) => {\n    if (state.readOnly)\n        return false;\n    let changes = state.changeByRange(range => {\n        if (!range.empty || range.from == 0 || range.from == state.doc.length)\n            return { range };\n        let pos = range.from, line = state.doc.lineAt(pos);\n        let from = pos == line.from ? pos - 1 : findClusterBreak(line.text, pos - line.from, false) + line.from;\n        let to = pos == line.to ? pos + 1 : findClusterBreak(line.text, pos - line.from, true) + line.from;\n        return { changes: { from, to, insert: state.doc.slice(pos, to).append(state.doc.slice(from, pos)) },\n            range: EditorSelection.cursor(to) };\n    });\n    if (changes.changes.empty)\n        return false;\n    dispatch(state.update(changes, { scrollIntoView: true, userEvent: \"move.character\" }));\n    return true;\n};\nfunction selectedLineBlocks(state) {\n    let blocks = [], upto = -1;\n    for (let range of state.selection.ranges) {\n        let startLine = state.doc.lineAt(range.from), endLine = state.doc.lineAt(range.to);\n        if (!range.empty && range.to == endLine.from)\n            endLine = state.doc.lineAt(range.to - 1);\n        if (upto >= startLine.number) {\n            let prev = blocks[blocks.length - 1];\n            prev.to = endLine.to;\n            prev.ranges.push(range);\n        }\n        else {\n            blocks.push({ from: startLine.from, to: endLine.to, ranges: [range] });\n        }\n        upto = endLine.number + 1;\n    }\n    return blocks;\n}\nfunction moveLine(state, dispatch, forward) {\n    if (state.readOnly)\n        return false;\n    let changes = [], ranges = [];\n    for (let block of selectedLineBlocks(state)) {\n        if (forward ? block.to == state.doc.length : block.from == 0)\n            continue;\n        let nextLine = state.doc.lineAt(forward ? block.to + 1 : block.from - 1);\n        let size = nextLine.length + 1;\n        if (forward) {\n            changes.push({ from: block.to, to: nextLine.to }, { from: block.from, insert: nextLine.text + state.lineBreak });\n            for (let r of block.ranges)\n                ranges.push(EditorSelection.range(Math.min(state.doc.length, r.anchor + size), Math.min(state.doc.length, r.head + size)));\n        }\n        else {\n            changes.push({ from: nextLine.from, to: block.from }, { from: block.to, insert: state.lineBreak + nextLine.text });\n            for (let r of block.ranges)\n                ranges.push(EditorSelection.range(r.anchor - size, r.head - size));\n        }\n    }\n    if (!changes.length)\n        return false;\n    dispatch(state.update({\n        changes,\n        scrollIntoView: true,\n        selection: EditorSelection.create(ranges, state.selection.mainIndex),\n        userEvent: \"move.line\"\n    }));\n    return true;\n}\n/**\nMove the selected lines up one line.\n*/\nconst moveLineUp = ({ state, dispatch }) => moveLine(state, dispatch, false);\n/**\nMove the selected lines down one line.\n*/\nconst moveLineDown = ({ state, dispatch }) => moveLine(state, dispatch, true);\nfunction copyLine(state, dispatch, forward) {\n    if (state.readOnly)\n        return false;\n    let changes = [];\n    for (let block of selectedLineBlocks(state)) {\n        if (forward)\n            changes.push({ from: block.from, insert: state.doc.slice(block.from, block.to) + state.lineBreak });\n        else\n            changes.push({ from: block.to, insert: state.lineBreak + state.doc.slice(block.from, block.to) });\n    }\n    dispatch(state.update({ changes, scrollIntoView: true, userEvent: \"input.copyline\" }));\n    return true;\n}\n/**\nCreate a copy of the selected lines. Keep the selection in the top copy.\n*/\nconst copyLineUp = ({ state, dispatch }) => copyLine(state, dispatch, false);\n/**\nCreate a copy of the selected lines. Keep the selection in the bottom copy.\n*/\nconst copyLineDown = ({ state, dispatch }) => copyLine(state, dispatch, true);\n/**\nDelete selected lines.\n*/\nconst deleteLine = view => {\n    if (view.state.readOnly)\n        return false;\n    let { state } = view, changes = state.changes(selectedLineBlocks(state).map(({ from, to }) => {\n        if (from > 0)\n            from--;\n        else if (to < state.doc.length)\n            to++;\n        return { from, to };\n    }));\n    let selection = updateSel(state.selection, range => view.moveVertically(range, true)).map(changes);\n    view.dispatch({ changes, selection, scrollIntoView: true, userEvent: \"delete.line\" });\n    return true;\n};\n/**\nReplace the selection with a newline.\n*/\nconst insertNewline = ({ state, dispatch }) => {\n    dispatch(state.update(state.replaceSelection(state.lineBreak), { scrollIntoView: true, userEvent: \"input\" }));\n    return true;\n};\nfunction isBetweenBrackets(state, pos) {\n    if (/\\(\\)|\\[\\]|\\{\\}/.test(state.sliceDoc(pos - 1, pos + 1)))\n        return { from: pos, to: pos };\n    let context = syntaxTree(state).resolveInner(pos);\n    let before = context.childBefore(pos), after = context.childAfter(pos), closedBy;\n    if (before && after && before.to <= pos && after.from >= pos &&\n        (closedBy = before.type.prop(NodeProp.closedBy)) && closedBy.indexOf(after.name) > -1 &&\n        state.doc.lineAt(before.to).from == state.doc.lineAt(after.from).from)\n        return { from: before.to, to: after.from };\n    return null;\n}\n/**\nReplace the selection with a newline and indent the newly created\nline(s). If the current line consists only of whitespace, this\nwill also delete that whitespace. When the cursor is between\nmatching brackets, an additional newline will be inserted after\nthe cursor.\n*/\nconst insertNewlineAndIndent = /*@__PURE__*/newlineAndIndent(false);\n/**\nCreate a blank, indented line below the current line.\n*/\nconst insertBlankLine = /*@__PURE__*/newlineAndIndent(true);\nfunction newlineAndIndent(atEof) {\n    return ({ state, dispatch }) => {\n        if (state.readOnly)\n            return false;\n        let changes = state.changeByRange(range => {\n            let { from, to } = range, line = state.doc.lineAt(from);\n            let explode = !atEof && from == to && isBetweenBrackets(state, from);\n            if (atEof)\n                from = to = (to <= line.to ? line : state.doc.lineAt(to)).to;\n            let cx = new IndentContext(state, { simulateBreak: from, simulateDoubleBreak: !!explode });\n            let indent = getIndentation(cx, from);\n            if (indent == null)\n                indent = /^\\s*/.exec(state.doc.lineAt(from).text)[0].length;\n            while (to < line.to && /\\s/.test(line.text[to - line.from]))\n                to++;\n            if (explode)\n                ({ from, to } = explode);\n            else if (from > line.from && from < line.from + 100 && !/\\S/.test(line.text.slice(0, from)))\n                from = line.from;\n            let insert = [\"\", indentString(state, indent)];\n            if (explode)\n                insert.push(indentString(state, cx.lineIndent(line.from, -1)));\n            return { changes: { from, to, insert: Text.of(insert) },\n                range: EditorSelection.cursor(from + 1 + insert[1].length) };\n        });\n        dispatch(state.update(changes, { scrollIntoView: true, userEvent: \"input\" }));\n        return true;\n    };\n}\nfunction changeBySelectedLine(state, f) {\n    let atLine = -1;\n    return state.changeByRange(range => {\n        let changes = [];\n        for (let pos = range.from; pos <= range.to;) {\n            let line = state.doc.lineAt(pos);\n            if (line.number > atLine && (range.empty || range.to > line.from)) {\n                f(line, changes, range);\n                atLine = line.number;\n            }\n            pos = line.to + 1;\n        }\n        let changeSet = state.changes(changes);\n        return { changes,\n            range: EditorSelection.range(changeSet.mapPos(range.anchor, 1), changeSet.mapPos(range.head, 1)) };\n    });\n}\n/**\nAuto-indent the selected lines. This uses the [indentation service\nfacet](https://codemirror.net/6/docs/ref/#language.indentService) as source for auto-indent\ninformation.\n*/\nconst indentSelection = ({ state, dispatch }) => {\n    if (state.readOnly)\n        return false;\n    let updated = Object.create(null);\n    let context = new IndentContext(state, { overrideIndentation: start => {\n            let found = updated[start];\n            return found == null ? -1 : found;\n        } });\n    let changes = changeBySelectedLine(state, (line, changes, range) => {\n        let indent = getIndentation(context, line.from);\n        if (indent == null)\n            return;\n        if (!/\\S/.test(line.text))\n            indent = 0;\n        let cur = /^\\s*/.exec(line.text)[0];\n        let norm = indentString(state, indent);\n        if (cur != norm || range.from < line.from + cur.length) {\n            updated[line.from] = indent;\n            changes.push({ from: line.from, to: line.from + cur.length, insert: norm });\n        }\n    });\n    if (!changes.changes.empty)\n        dispatch(state.update(changes, { userEvent: \"indent\" }));\n    return true;\n};\n/**\nAdd a [unit](https://codemirror.net/6/docs/ref/#language.indentUnit) of indentation to all selected\nlines.\n*/\nconst indentMore = ({ state, dispatch }) => {\n    if (state.readOnly)\n        return false;\n    dispatch(state.update(changeBySelectedLine(state, (line, changes) => {\n        changes.push({ from: line.from, insert: state.facet(indentUnit) });\n    }), { userEvent: \"input.indent\" }));\n    return true;\n};\n/**\nRemove a [unit](https://codemirror.net/6/docs/ref/#language.indentUnit) of indentation from all\nselected lines.\n*/\nconst indentLess = ({ state, dispatch }) => {\n    if (state.readOnly)\n        return false;\n    dispatch(state.update(changeBySelectedLine(state, (line, changes) => {\n        let space = /^\\s*/.exec(line.text)[0];\n        if (!space)\n            return;\n        let col = countColumn(space, state.tabSize), keep = 0;\n        let insert = indentString(state, Math.max(0, col - getIndentUnit(state)));\n        while (keep < space.length && keep < insert.length && space.charCodeAt(keep) == insert.charCodeAt(keep))\n            keep++;\n        changes.push({ from: line.from + keep, to: line.from + space.length, insert: insert.slice(keep) });\n    }), { userEvent: \"delete.dedent\" }));\n    return true;\n};\n/**\nInsert a tab character at the cursor or, if something is selected,\nuse [`indentMore`](https://codemirror.net/6/docs/ref/#commands.indentMore) to indent the entire\nselection.\n*/\nconst insertTab = ({ state, dispatch }) => {\n    if (state.selection.ranges.some(r => !r.empty))\n        return indentMore({ state, dispatch });\n    dispatch(state.update(state.replaceSelection(\"\\t\"), { scrollIntoView: true, userEvent: \"input\" }));\n    return true;\n};\n/**\nArray of key bindings containing the Emacs-style bindings that are\navailable on macOS by default.\n\n - Ctrl-b: [`cursorCharLeft`](https://codemirror.net/6/docs/ref/#commands.cursorCharLeft) ([`selectCharLeft`](https://codemirror.net/6/docs/ref/#commands.selectCharLeft) with Shift)\n - Ctrl-f: [`cursorCharRight`](https://codemirror.net/6/docs/ref/#commands.cursorCharRight) ([`selectCharRight`](https://codemirror.net/6/docs/ref/#commands.selectCharRight) with Shift)\n - Ctrl-p: [`cursorLineUp`](https://codemirror.net/6/docs/ref/#commands.cursorLineUp) ([`selectLineUp`](https://codemirror.net/6/docs/ref/#commands.selectLineUp) with Shift)\n - Ctrl-n: [`cursorLineDown`](https://codemirror.net/6/docs/ref/#commands.cursorLineDown) ([`selectLineDown`](https://codemirror.net/6/docs/ref/#commands.selectLineDown) with Shift)\n - Ctrl-a: [`cursorLineStart`](https://codemirror.net/6/docs/ref/#commands.cursorLineStart) ([`selectLineStart`](https://codemirror.net/6/docs/ref/#commands.selectLineStart) with Shift)\n - Ctrl-e: [`cursorLineEnd`](https://codemirror.net/6/docs/ref/#commands.cursorLineEnd) ([`selectLineEnd`](https://codemirror.net/6/docs/ref/#commands.selectLineEnd) with Shift)\n - Ctrl-d: [`deleteCharForward`](https://codemirror.net/6/docs/ref/#commands.deleteCharForward)\n - Ctrl-h: [`deleteCharBackward`](https://codemirror.net/6/docs/ref/#commands.deleteCharBackward)\n - Ctrl-k: [`deleteToLineEnd`](https://codemirror.net/6/docs/ref/#commands.deleteToLineEnd)\n - Ctrl-Alt-h: [`deleteGroupBackward`](https://codemirror.net/6/docs/ref/#commands.deleteGroupBackward)\n - Ctrl-o: [`splitLine`](https://codemirror.net/6/docs/ref/#commands.splitLine)\n - Ctrl-t: [`transposeChars`](https://codemirror.net/6/docs/ref/#commands.transposeChars)\n - Ctrl-v: [`cursorPageDown`](https://codemirror.net/6/docs/ref/#commands.cursorPageDown)\n - Alt-v: [`cursorPageUp`](https://codemirror.net/6/docs/ref/#commands.cursorPageUp)\n*/\nconst emacsStyleKeymap = [\n    { key: \"Ctrl-b\", run: cursorCharLeft, shift: selectCharLeft, preventDefault: true },\n    { key: \"Ctrl-f\", run: cursorCharRight, shift: selectCharRight },\n    { key: \"Ctrl-p\", run: cursorLineUp, shift: selectLineUp },\n    { key: \"Ctrl-n\", run: cursorLineDown, shift: selectLineDown },\n    { key: \"Ctrl-a\", run: cursorLineStart, shift: selectLineStart },\n    { key: \"Ctrl-e\", run: cursorLineEnd, shift: selectLineEnd },\n    { key: \"Ctrl-d\", run: deleteCharForward },\n    { key: \"Ctrl-h\", run: deleteCharBackward },\n    { key: \"Ctrl-k\", run: deleteToLineEnd },\n    { key: \"Ctrl-Alt-h\", run: deleteGroupBackward },\n    { key: \"Ctrl-o\", run: splitLine },\n    { key: \"Ctrl-t\", run: transposeChars },\n    { key: \"Ctrl-v\", run: cursorPageDown },\n];\n/**\nAn array of key bindings closely sticking to platform-standard or\nwidely used bindings. (This includes the bindings from\n[`emacsStyleKeymap`](https://codemirror.net/6/docs/ref/#commands.emacsStyleKeymap), with their `key`\nproperty changed to `mac`.)\n\n - ArrowLeft: [`cursorCharLeft`](https://codemirror.net/6/docs/ref/#commands.cursorCharLeft) ([`selectCharLeft`](https://codemirror.net/6/docs/ref/#commands.selectCharLeft) with Shift)\n - ArrowRight: [`cursorCharRight`](https://codemirror.net/6/docs/ref/#commands.cursorCharRight) ([`selectCharRight`](https://codemirror.net/6/docs/ref/#commands.selectCharRight) with Shift)\n - Ctrl-ArrowLeft (Alt-ArrowLeft on macOS): [`cursorGroupLeft`](https://codemirror.net/6/docs/ref/#commands.cursorGroupLeft) ([`selectGroupLeft`](https://codemirror.net/6/docs/ref/#commands.selectGroupLeft) with Shift)\n - Ctrl-ArrowRight (Alt-ArrowRight on macOS): [`cursorGroupRight`](https://codemirror.net/6/docs/ref/#commands.cursorGroupRight) ([`selectGroupRight`](https://codemirror.net/6/docs/ref/#commands.selectGroupRight) with Shift)\n - Cmd-ArrowLeft (on macOS): [`cursorLineStart`](https://codemirror.net/6/docs/ref/#commands.cursorLineStart) ([`selectLineStart`](https://codemirror.net/6/docs/ref/#commands.selectLineStart) with Shift)\n - Cmd-ArrowRight (on macOS): [`cursorLineEnd`](https://codemirror.net/6/docs/ref/#commands.cursorLineEnd) ([`selectLineEnd`](https://codemirror.net/6/docs/ref/#commands.selectLineEnd) with Shift)\n - ArrowUp: [`cursorLineUp`](https://codemirror.net/6/docs/ref/#commands.cursorLineUp) ([`selectLineUp`](https://codemirror.net/6/docs/ref/#commands.selectLineUp) with Shift)\n - ArrowDown: [`cursorLineDown`](https://codemirror.net/6/docs/ref/#commands.cursorLineDown) ([`selectLineDown`](https://codemirror.net/6/docs/ref/#commands.selectLineDown) with Shift)\n - Cmd-ArrowUp (on macOS): [`cursorDocStart`](https://codemirror.net/6/docs/ref/#commands.cursorDocStart) ([`selectDocStart`](https://codemirror.net/6/docs/ref/#commands.selectDocStart) with Shift)\n - Cmd-ArrowDown (on macOS): [`cursorDocEnd`](https://codemirror.net/6/docs/ref/#commands.cursorDocEnd) ([`selectDocEnd`](https://codemirror.net/6/docs/ref/#commands.selectDocEnd) with Shift)\n - Ctrl-ArrowUp (on macOS): [`cursorPageUp`](https://codemirror.net/6/docs/ref/#commands.cursorPageUp) ([`selectPageUp`](https://codemirror.net/6/docs/ref/#commands.selectPageUp) with Shift)\n - Ctrl-ArrowDown (on macOS): [`cursorPageDown`](https://codemirror.net/6/docs/ref/#commands.cursorPageDown) ([`selectPageDown`](https://codemirror.net/6/docs/ref/#commands.selectPageDown) with Shift)\n - PageUp: [`cursorPageUp`](https://codemirror.net/6/docs/ref/#commands.cursorPageUp) ([`selectPageUp`](https://codemirror.net/6/docs/ref/#commands.selectPageUp) with Shift)\n - PageDown: [`cursorPageDown`](https://codemirror.net/6/docs/ref/#commands.cursorPageDown) ([`selectPageDown`](https://codemirror.net/6/docs/ref/#commands.selectPageDown) with Shift)\n - Home: [`cursorLineBoundaryBackward`](https://codemirror.net/6/docs/ref/#commands.cursorLineBoundaryBackward) ([`selectLineBoundaryBackward`](https://codemirror.net/6/docs/ref/#commands.selectLineBoundaryBackward) with Shift)\n - End: [`cursorLineBoundaryForward`](https://codemirror.net/6/docs/ref/#commands.cursorLineBoundaryForward) ([`selectLineBoundaryForward`](https://codemirror.net/6/docs/ref/#commands.selectLineBoundaryForward) with Shift)\n - Ctrl-Home (Cmd-Home on macOS): [`cursorDocStart`](https://codemirror.net/6/docs/ref/#commands.cursorDocStart) ([`selectDocStart`](https://codemirror.net/6/docs/ref/#commands.selectDocStart) with Shift)\n - Ctrl-End (Cmd-Home on macOS): [`cursorDocEnd`](https://codemirror.net/6/docs/ref/#commands.cursorDocEnd) ([`selectDocEnd`](https://codemirror.net/6/docs/ref/#commands.selectDocEnd) with Shift)\n - Enter: [`insertNewlineAndIndent`](https://codemirror.net/6/docs/ref/#commands.insertNewlineAndIndent)\n - Ctrl-a (Cmd-a on macOS): [`selectAll`](https://codemirror.net/6/docs/ref/#commands.selectAll)\n - Backspace: [`deleteCharBackward`](https://codemirror.net/6/docs/ref/#commands.deleteCharBackward)\n - Delete: [`deleteCharForward`](https://codemirror.net/6/docs/ref/#commands.deleteCharForward)\n - Ctrl-Backspace (Alt-Backspace on macOS): [`deleteGroupBackward`](https://codemirror.net/6/docs/ref/#commands.deleteGroupBackward)\n - Ctrl-Delete (Alt-Delete on macOS): [`deleteGroupForward`](https://codemirror.net/6/docs/ref/#commands.deleteGroupForward)\n - Cmd-Backspace (macOS): [`deleteToLineStart`](https://codemirror.net/6/docs/ref/#commands.deleteToLineStart).\n - Cmd-Delete (macOS): [`deleteToLineEnd`](https://codemirror.net/6/docs/ref/#commands.deleteToLineEnd).\n*/\nconst standardKeymap = /*@__PURE__*/[\n    { key: \"ArrowLeft\", run: cursorCharLeft, shift: selectCharLeft, preventDefault: true },\n    { key: \"Mod-ArrowLeft\", mac: \"Alt-ArrowLeft\", run: cursorGroupLeft, shift: selectGroupLeft, preventDefault: true },\n    { mac: \"Cmd-ArrowLeft\", run: cursorLineBoundaryLeft, shift: selectLineBoundaryLeft, preventDefault: true },\n    { key: \"ArrowRight\", run: cursorCharRight, shift: selectCharRight, preventDefault: true },\n    { key: \"Mod-ArrowRight\", mac: \"Alt-ArrowRight\", run: cursorGroupRight, shift: selectGroupRight, preventDefault: true },\n    { mac: \"Cmd-ArrowRight\", run: cursorLineBoundaryRight, shift: selectLineBoundaryRight, preventDefault: true },\n    { key: \"ArrowUp\", run: cursorLineUp, shift: selectLineUp, preventDefault: true },\n    { mac: \"Cmd-ArrowUp\", run: cursorDocStart, shift: selectDocStart },\n    { mac: \"Ctrl-ArrowUp\", run: cursorPageUp, shift: selectPageUp },\n    { key: \"ArrowDown\", run: cursorLineDown, shift: selectLineDown, preventDefault: true },\n    { mac: \"Cmd-ArrowDown\", run: cursorDocEnd, shift: selectDocEnd },\n    { mac: \"Ctrl-ArrowDown\", run: cursorPageDown, shift: selectPageDown },\n    { key: \"PageUp\", run: cursorPageUp, shift: selectPageUp },\n    { key: \"PageDown\", run: cursorPageDown, shift: selectPageDown },\n    { key: \"Home\", run: cursorLineBoundaryBackward, shift: selectLineBoundaryBackward, preventDefault: true },\n    { key: \"Mod-Home\", run: cursorDocStart, shift: selectDocStart },\n    { key: \"End\", run: cursorLineBoundaryForward, shift: selectLineBoundaryForward, preventDefault: true },\n    { key: \"Mod-End\", run: cursorDocEnd, shift: selectDocEnd },\n    { key: \"Enter\", run: insertNewlineAndIndent },\n    { key: \"Mod-a\", run: selectAll },\n    { key: \"Backspace\", run: deleteCharBackward, shift: deleteCharBackward },\n    { key: \"Delete\", run: deleteCharForward },\n    { key: \"Mod-Backspace\", mac: \"Alt-Backspace\", run: deleteGroupBackward },\n    { key: \"Mod-Delete\", mac: \"Alt-Delete\", run: deleteGroupForward },\n    { mac: \"Mod-Backspace\", run: deleteToLineStart },\n    { mac: \"Mod-Delete\", run: deleteToLineEnd }\n].concat(/*@__PURE__*/emacsStyleKeymap.map(b => ({ mac: b.key, run: b.run, shift: b.shift })));\n/**\nThe default keymap. Includes all bindings from\n[`standardKeymap`](https://codemirror.net/6/docs/ref/#commands.standardKeymap) plus the following:\n\n- Alt-ArrowLeft (Ctrl-ArrowLeft on macOS): [`cursorSyntaxLeft`](https://codemirror.net/6/docs/ref/#commands.cursorSyntaxLeft) ([`selectSyntaxLeft`](https://codemirror.net/6/docs/ref/#commands.selectSyntaxLeft) with Shift)\n- Alt-ArrowRight (Ctrl-ArrowRight on macOS): [`cursorSyntaxRight`](https://codemirror.net/6/docs/ref/#commands.cursorSyntaxRight) ([`selectSyntaxRight`](https://codemirror.net/6/docs/ref/#commands.selectSyntaxRight) with Shift)\n- Alt-ArrowUp: [`moveLineUp`](https://codemirror.net/6/docs/ref/#commands.moveLineUp)\n- Alt-ArrowDown: [`moveLineDown`](https://codemirror.net/6/docs/ref/#commands.moveLineDown)\n- Shift-Alt-ArrowUp: [`copyLineUp`](https://codemirror.net/6/docs/ref/#commands.copyLineUp)\n- Shift-Alt-ArrowDown: [`copyLineDown`](https://codemirror.net/6/docs/ref/#commands.copyLineDown)\n- Escape: [`simplifySelection`](https://codemirror.net/6/docs/ref/#commands.simplifySelection)\n- Ctrl-Enter (Comd-Enter on macOS): [`insertBlankLine`](https://codemirror.net/6/docs/ref/#commands.insertBlankLine)\n- Alt-l (Ctrl-l on macOS): [`selectLine`](https://codemirror.net/6/docs/ref/#commands.selectLine)\n- Ctrl-i (Cmd-i on macOS): [`selectParentSyntax`](https://codemirror.net/6/docs/ref/#commands.selectParentSyntax)\n- Ctrl-[ (Cmd-[ on macOS): [`indentLess`](https://codemirror.net/6/docs/ref/#commands.indentLess)\n- Ctrl-] (Cmd-] on macOS): [`indentMore`](https://codemirror.net/6/docs/ref/#commands.indentMore)\n- Ctrl-Alt-\\\\ (Cmd-Alt-\\\\ on macOS): [`indentSelection`](https://codemirror.net/6/docs/ref/#commands.indentSelection)\n- Shift-Ctrl-k (Shift-Cmd-k on macOS): [`deleteLine`](https://codemirror.net/6/docs/ref/#commands.deleteLine)\n- Shift-Ctrl-\\\\ (Shift-Cmd-\\\\ on macOS): [`cursorMatchingBracket`](https://codemirror.net/6/docs/ref/#commands.cursorMatchingBracket)\n- Ctrl-/ (Cmd-/ on macOS): [`toggleComment`](https://codemirror.net/6/docs/ref/#commands.toggleComment).\n- Shift-Alt-a: [`toggleBlockComment`](https://codemirror.net/6/docs/ref/#commands.toggleBlockComment).\n*/\nconst defaultKeymap = /*@__PURE__*/[\n    { key: \"Alt-ArrowLeft\", mac: \"Ctrl-ArrowLeft\", run: cursorSyntaxLeft, shift: selectSyntaxLeft },\n    { key: \"Alt-ArrowRight\", mac: \"Ctrl-ArrowRight\", run: cursorSyntaxRight, shift: selectSyntaxRight },\n    { key: \"Alt-ArrowUp\", run: moveLineUp },\n    { key: \"Shift-Alt-ArrowUp\", run: copyLineUp },\n    { key: \"Alt-ArrowDown\", run: moveLineDown },\n    { key: \"Shift-Alt-ArrowDown\", run: copyLineDown },\n    { key: \"Escape\", run: simplifySelection },\n    { key: \"Mod-Enter\", run: insertBlankLine },\n    { key: \"Alt-l\", mac: \"Ctrl-l\", run: selectLine },\n    { key: \"Mod-i\", run: selectParentSyntax, preventDefault: true },\n    { key: \"Mod-[\", run: indentLess },\n    { key: \"Mod-]\", run: indentMore },\n    { key: \"Mod-Alt-\\\\\", run: indentSelection },\n    { key: \"Shift-Mod-k\", run: deleteLine },\n    { key: \"Shift-Mod-\\\\\", run: cursorMatchingBracket },\n    { key: \"Mod-/\", run: toggleComment },\n    { key: \"Alt-A\", run: toggleBlockComment }\n].concat(standardKeymap);\n/**\nA binding that binds Tab to [`indentMore`](https://codemirror.net/6/docs/ref/#commands.indentMore) and\nShift-Tab to [`indentLess`](https://codemirror.net/6/docs/ref/#commands.indentLess).\nPlease see the [Tab example](../../examples/tab/) before using\nthis.\n*/\nconst indentWithTab = { key: \"Tab\", run: indentMore, shift: indentLess };\n\nexport { blockComment, blockUncomment, copyLineDown, copyLineUp, cursorCharBackward, cursorCharForward, cursorCharLeft, cursorCharRight, cursorDocEnd, cursorDocStart, cursorGroupBackward, cursorGroupForward, cursorGroupLeft, cursorGroupRight, cursorLineBoundaryBackward, cursorLineBoundaryForward, cursorLineBoundaryLeft, cursorLineBoundaryRight, cursorLineDown, cursorLineEnd, cursorLineStart, cursorLineUp, cursorMatchingBracket, cursorPageDown, cursorPageUp, cursorSubwordBackward, cursorSubwordForward, cursorSyntaxLeft, cursorSyntaxRight, defaultKeymap, deleteCharBackward, deleteCharForward, deleteGroupBackward, deleteGroupForward, deleteLine, deleteToLineEnd, deleteToLineStart, deleteTrailingWhitespace, emacsStyleKeymap, history, historyField, historyKeymap, indentLess, indentMore, indentSelection, indentWithTab, insertBlankLine, insertNewline, insertNewlineAndIndent, insertTab, invertedEffects, isolateHistory, lineComment, lineUncomment, moveLineDown, moveLineUp, redo, redoDepth, redoSelection, selectAll, selectCharBackward, selectCharForward, selectCharLeft, selectCharRight, selectDocEnd, selectDocStart, selectGroupBackward, selectGroupForward, selectGroupLeft, selectGroupRight, selectLine, selectLineBoundaryBackward, selectLineBoundaryForward, selectLineBoundaryLeft, selectLineBoundaryRight, selectLineDown, selectLineEnd, selectLineStart, selectLineUp, selectMatchingBracket, selectPageDown, selectPageUp, selectParentSyntax, selectSubwordBackward, selectSubwordForward, selectSyntaxLeft, selectSyntaxRight, simplifySelection, splitLine, standardKeymap, toggleBlockComment, toggleBlockCommentByLine, toggleComment, toggleLineComment, transposeChars, undo, undoDepth, undoSelection };\n","import { Parser, NodeProp, NodeSet, NodeType, DefaultBufferLength, Tree, IterMode } from '@lezer/common';\n\n/// A parse stack. These are used internally by the parser to track\n/// parsing progress. They also provide some properties and methods\n/// that external code such as a tokenizer can use to get information\n/// about the parse state.\nclass Stack {\n    /// @internal\n    constructor(\n    /// The parse that this stack is part of @internal\n    p, \n    /// Holds state, input pos, buffer index triplets for all but the\n    /// top state @internal\n    stack, \n    /// The current parse state @internal\n    state, \n    // The position at which the next reduce should take place. This\n    // can be less than `this.pos` when skipped expressions have been\n    // added to the stack (which should be moved outside of the next\n    // reduction)\n    /// @internal\n    reducePos, \n    /// The input position up to which this stack has parsed.\n    pos, \n    /// The dynamic score of the stack, including dynamic precedence\n    /// and error-recovery penalties\n    /// @internal\n    score, \n    // The output buffer. Holds (type, start, end, size) quads\n    // representing nodes created by the parser, where `size` is\n    // amount of buffer array entries covered by this node.\n    /// @internal\n    buffer, \n    // The base offset of the buffer. When stacks are split, the split\n    // instance shared the buffer history with its parent up to\n    // `bufferBase`, which is the absolute offset (including the\n    // offset of previous splits) into the buffer at which this stack\n    // starts writing.\n    /// @internal\n    bufferBase, \n    /// @internal\n    curContext, \n    /// @internal\n    lookAhead = 0, \n    // A parent stack from which this was split off, if any. This is\n    // set up so that it always points to a stack that has some\n    // additional buffer content, never to a stack with an equal\n    // `bufferBase`.\n    /// @internal\n    parent) {\n        this.p = p;\n        this.stack = stack;\n        this.state = state;\n        this.reducePos = reducePos;\n        this.pos = pos;\n        this.score = score;\n        this.buffer = buffer;\n        this.bufferBase = bufferBase;\n        this.curContext = curContext;\n        this.lookAhead = lookAhead;\n        this.parent = parent;\n    }\n    /// @internal\n    toString() {\n        return `[${this.stack.filter((_, i) => i % 3 == 0).concat(this.state)}]@${this.pos}${this.score ? \"!\" + this.score : \"\"}`;\n    }\n    // Start an empty stack\n    /// @internal\n    static start(p, state, pos = 0) {\n        let cx = p.parser.context;\n        return new Stack(p, [], state, pos, pos, 0, [], 0, cx ? new StackContext(cx, cx.start) : null, 0, null);\n    }\n    /// The stack's current [context](#lr.ContextTracker) value, if\n    /// any. Its type will depend on the context tracker's type\n    /// parameter, or it will be `null` if there is no context\n    /// tracker.\n    get context() { return this.curContext ? this.curContext.context : null; }\n    // Push a state onto the stack, tracking its start position as well\n    // as the buffer base at that point.\n    /// @internal\n    pushState(state, start) {\n        this.stack.push(this.state, start, this.bufferBase + this.buffer.length);\n        this.state = state;\n    }\n    // Apply a reduce action\n    /// @internal\n    reduce(action) {\n        var _a;\n        let depth = action >> 19 /* Action.ReduceDepthShift */, type = action & 65535 /* Action.ValueMask */;\n        let { parser } = this.p;\n        let dPrec = parser.dynamicPrecedence(type);\n        if (dPrec)\n            this.score += dPrec;\n        if (depth == 0) {\n            this.pushState(parser.getGoto(this.state, type, true), this.reducePos);\n            // Zero-depth reductions are a special case—they add stuff to\n            // the stack without popping anything off.\n            if (type < parser.minRepeatTerm)\n                this.storeNode(type, this.reducePos, this.reducePos, 4, true);\n            this.reduceContext(type, this.reducePos);\n            return;\n        }\n        // Find the base index into `this.stack`, content after which will\n        // be dropped. Note that with `StayFlag` reductions we need to\n        // consume two extra frames (the dummy parent node for the skipped\n        // expression and the state that we'll be staying in, which should\n        // be moved to `this.state`).\n        let base = this.stack.length - ((depth - 1) * 3) - (action & 262144 /* Action.StayFlag */ ? 6 : 0);\n        let start = base ? this.stack[base - 2] : this.p.ranges[0].from, size = this.reducePos - start;\n        // This is a kludge to try and detect overly deep left-associative\n        // trees, which will not increase the parse stack depth and thus\n        // won't be caught by the regular stack-depth limit check.\n        if (size >= 2000 /* Recover.MinBigReduction */ && !((_a = this.p.parser.nodeSet.types[type]) === null || _a === void 0 ? void 0 : _a.isAnonymous)) {\n            if (start == this.p.lastBigReductionStart) {\n                this.p.bigReductionCount++;\n                this.p.lastBigReductionSize = size;\n            }\n            else if (this.p.lastBigReductionSize < size) {\n                this.p.bigReductionCount = 1;\n                this.p.lastBigReductionStart = start;\n                this.p.lastBigReductionSize = size;\n            }\n        }\n        let bufferBase = base ? this.stack[base - 1] : 0, count = this.bufferBase + this.buffer.length - bufferBase;\n        // Store normal terms or `R -> R R` repeat reductions\n        if (type < parser.minRepeatTerm || (action & 131072 /* Action.RepeatFlag */)) {\n            let pos = parser.stateFlag(this.state, 1 /* StateFlag.Skipped */) ? this.pos : this.reducePos;\n            this.storeNode(type, start, pos, count + 4, true);\n        }\n        if (action & 262144 /* Action.StayFlag */) {\n            this.state = this.stack[base];\n        }\n        else {\n            let baseStateID = this.stack[base - 3];\n            this.state = parser.getGoto(baseStateID, type, true);\n        }\n        while (this.stack.length > base)\n            this.stack.pop();\n        this.reduceContext(type, start);\n    }\n    // Shift a value into the buffer\n    /// @internal\n    storeNode(term, start, end, size = 4, isReduce = false) {\n        if (term == 0 /* Term.Err */ &&\n            (!this.stack.length || this.stack[this.stack.length - 1] < this.buffer.length + this.bufferBase)) {\n            // Try to omit/merge adjacent error nodes\n            let cur = this, top = this.buffer.length;\n            if (top == 0 && cur.parent) {\n                top = cur.bufferBase - cur.parent.bufferBase;\n                cur = cur.parent;\n            }\n            if (top > 0 && cur.buffer[top - 4] == 0 /* Term.Err */ && cur.buffer[top - 1] > -1) {\n                if (start == end)\n                    return;\n                if (cur.buffer[top - 2] >= start) {\n                    cur.buffer[top - 2] = end;\n                    return;\n                }\n            }\n        }\n        if (!isReduce || this.pos == end) { // Simple case, just append\n            this.buffer.push(term, start, end, size);\n        }\n        else { // There may be skipped nodes that have to be moved forward\n            let index = this.buffer.length;\n            if (index > 0 && this.buffer[index - 4] != 0 /* Term.Err */)\n                while (index > 0 && this.buffer[index - 2] > end) {\n                    // Move this record forward\n                    this.buffer[index] = this.buffer[index - 4];\n                    this.buffer[index + 1] = this.buffer[index - 3];\n                    this.buffer[index + 2] = this.buffer[index - 2];\n                    this.buffer[index + 3] = this.buffer[index - 1];\n                    index -= 4;\n                    if (size > 4)\n                        size -= 4;\n                }\n            this.buffer[index] = term;\n            this.buffer[index + 1] = start;\n            this.buffer[index + 2] = end;\n            this.buffer[index + 3] = size;\n        }\n    }\n    // Apply a shift action\n    /// @internal\n    shift(action, next, nextEnd) {\n        let start = this.pos;\n        if (action & 131072 /* Action.GotoFlag */) {\n            this.pushState(action & 65535 /* Action.ValueMask */, this.pos);\n        }\n        else if ((action & 262144 /* Action.StayFlag */) == 0) { // Regular shift\n            let nextState = action, { parser } = this.p;\n            if (nextEnd > this.pos || next <= parser.maxNode) {\n                this.pos = nextEnd;\n                if (!parser.stateFlag(nextState, 1 /* StateFlag.Skipped */))\n                    this.reducePos = nextEnd;\n            }\n            this.pushState(nextState, start);\n            this.shiftContext(next, start);\n            if (next <= parser.maxNode)\n                this.buffer.push(next, start, nextEnd, 4);\n        }\n        else { // Shift-and-stay, which means this is a skipped token\n            this.pos = nextEnd;\n            this.shiftContext(next, start);\n            if (next <= this.p.parser.maxNode)\n                this.buffer.push(next, start, nextEnd, 4);\n        }\n    }\n    // Apply an action\n    /// @internal\n    apply(action, next, nextEnd) {\n        if (action & 65536 /* Action.ReduceFlag */)\n            this.reduce(action);\n        else\n            this.shift(action, next, nextEnd);\n    }\n    // Add a prebuilt (reused) node into the buffer.\n    /// @internal\n    useNode(value, next) {\n        let index = this.p.reused.length - 1;\n        if (index < 0 || this.p.reused[index] != value) {\n            this.p.reused.push(value);\n            index++;\n        }\n        let start = this.pos;\n        this.reducePos = this.pos = start + value.length;\n        this.pushState(next, start);\n        this.buffer.push(index, start, this.reducePos, -1 /* size == -1 means this is a reused value */);\n        if (this.curContext)\n            this.updateContext(this.curContext.tracker.reuse(this.curContext.context, value, this, this.p.stream.reset(this.pos - value.length)));\n    }\n    // Split the stack. Due to the buffer sharing and the fact\n    // that `this.stack` tends to stay quite shallow, this isn't very\n    // expensive.\n    /// @internal\n    split() {\n        let parent = this;\n        let off = parent.buffer.length;\n        // Because the top of the buffer (after this.pos) may be mutated\n        // to reorder reductions and skipped tokens, and shared buffers\n        // should be immutable, this copies any outstanding skipped tokens\n        // to the new buffer, and puts the base pointer before them.\n        while (off > 0 && parent.buffer[off - 2] > parent.reducePos)\n            off -= 4;\n        let buffer = parent.buffer.slice(off), base = parent.bufferBase + off;\n        // Make sure parent points to an actual parent with content, if there is such a parent.\n        while (parent && base == parent.bufferBase)\n            parent = parent.parent;\n        return new Stack(this.p, this.stack.slice(), this.state, this.reducePos, this.pos, this.score, buffer, base, this.curContext, this.lookAhead, parent);\n    }\n    // Try to recover from an error by 'deleting' (ignoring) one token.\n    /// @internal\n    recoverByDelete(next, nextEnd) {\n        let isNode = next <= this.p.parser.maxNode;\n        if (isNode)\n            this.storeNode(next, this.pos, nextEnd, 4);\n        this.storeNode(0 /* Term.Err */, this.pos, nextEnd, isNode ? 8 : 4);\n        this.pos = this.reducePos = nextEnd;\n        this.score -= 190 /* Recover.Delete */;\n    }\n    /// Check if the given term would be able to be shifted (optionally\n    /// after some reductions) on this stack. This can be useful for\n    /// external tokenizers that want to make sure they only provide a\n    /// given token when it applies.\n    canShift(term) {\n        for (let sim = new SimulatedStack(this);;) {\n            let action = this.p.parser.stateSlot(sim.state, 4 /* ParseState.DefaultReduce */) || this.p.parser.hasAction(sim.state, term);\n            if (action == 0)\n                return false;\n            if ((action & 65536 /* Action.ReduceFlag */) == 0)\n                return true;\n            sim.reduce(action);\n        }\n    }\n    // Apply up to Recover.MaxNext recovery actions that conceptually\n    // inserts some missing token or rule.\n    /// @internal\n    recoverByInsert(next) {\n        if (this.stack.length >= 300 /* Recover.MaxInsertStackDepth */)\n            return [];\n        let nextStates = this.p.parser.nextStates(this.state);\n        if (nextStates.length > 4 /* Recover.MaxNext */ << 1 || this.stack.length >= 120 /* Recover.DampenInsertStackDepth */) {\n            let best = [];\n            for (let i = 0, s; i < nextStates.length; i += 2) {\n                if ((s = nextStates[i + 1]) != this.state && this.p.parser.hasAction(s, next))\n                    best.push(nextStates[i], s);\n            }\n            if (this.stack.length < 120 /* Recover.DampenInsertStackDepth */)\n                for (let i = 0; best.length < 4 /* Recover.MaxNext */ << 1 && i < nextStates.length; i += 2) {\n                    let s = nextStates[i + 1];\n                    if (!best.some((v, i) => (i & 1) && v == s))\n                        best.push(nextStates[i], s);\n                }\n            nextStates = best;\n        }\n        let result = [];\n        for (let i = 0; i < nextStates.length && result.length < 4 /* Recover.MaxNext */; i += 2) {\n            let s = nextStates[i + 1];\n            if (s == this.state)\n                continue;\n            let stack = this.split();\n            stack.pushState(s, this.pos);\n            stack.storeNode(0 /* Term.Err */, stack.pos, stack.pos, 4, true);\n            stack.shiftContext(nextStates[i], this.pos);\n            stack.score -= 200 /* Recover.Insert */;\n            result.push(stack);\n        }\n        return result;\n    }\n    // Force a reduce, if possible. Return false if that can't\n    // be done.\n    /// @internal\n    forceReduce() {\n        let reduce = this.p.parser.stateSlot(this.state, 5 /* ParseState.ForcedReduce */);\n        if ((reduce & 65536 /* Action.ReduceFlag */) == 0)\n            return false;\n        let { parser } = this.p;\n        if (!parser.validAction(this.state, reduce)) {\n            let depth = reduce >> 19 /* Action.ReduceDepthShift */, term = reduce & 65535 /* Action.ValueMask */;\n            let target = this.stack.length - depth * 3;\n            if (target < 0 || parser.getGoto(this.stack[target], term, false) < 0)\n                return false;\n            this.storeNode(0 /* Term.Err */, this.reducePos, this.reducePos, 4, true);\n            this.score -= 100 /* Recover.Reduce */;\n        }\n        this.reducePos = this.pos;\n        this.reduce(reduce);\n        return true;\n    }\n    /// @internal\n    forceAll() {\n        while (!this.p.parser.stateFlag(this.state, 2 /* StateFlag.Accepting */)) {\n            if (!this.forceReduce()) {\n                this.storeNode(0 /* Term.Err */, this.pos, this.pos, 4, true);\n                break;\n            }\n        }\n        return this;\n    }\n    /// Check whether this state has no further actions (assumed to be a direct descendant of the\n    /// top state, since any other states must be able to continue\n    /// somehow). @internal\n    get deadEnd() {\n        if (this.stack.length != 3)\n            return false;\n        let { parser } = this.p;\n        return parser.data[parser.stateSlot(this.state, 1 /* ParseState.Actions */)] == 65535 /* Seq.End */ &&\n            !parser.stateSlot(this.state, 4 /* ParseState.DefaultReduce */);\n    }\n    /// Restart the stack (put it back in its start state). Only safe\n    /// when this.stack.length == 3 (state is directly below the top\n    /// state). @internal\n    restart() {\n        this.state = this.stack[0];\n        this.stack.length = 0;\n    }\n    /// @internal\n    sameState(other) {\n        if (this.state != other.state || this.stack.length != other.stack.length)\n            return false;\n        for (let i = 0; i < this.stack.length; i += 3)\n            if (this.stack[i] != other.stack[i])\n                return false;\n        return true;\n    }\n    /// Get the parser used by this stack.\n    get parser() { return this.p.parser; }\n    /// Test whether a given dialect (by numeric ID, as exported from\n    /// the terms file) is enabled.\n    dialectEnabled(dialectID) { return this.p.parser.dialect.flags[dialectID]; }\n    shiftContext(term, start) {\n        if (this.curContext)\n            this.updateContext(this.curContext.tracker.shift(this.curContext.context, term, this, this.p.stream.reset(start)));\n    }\n    reduceContext(term, start) {\n        if (this.curContext)\n            this.updateContext(this.curContext.tracker.reduce(this.curContext.context, term, this, this.p.stream.reset(start)));\n    }\n    /// @internal\n    emitContext() {\n        let last = this.buffer.length - 1;\n        if (last < 0 || this.buffer[last] != -3)\n            this.buffer.push(this.curContext.hash, this.reducePos, this.reducePos, -3);\n    }\n    /// @internal\n    emitLookAhead() {\n        let last = this.buffer.length - 1;\n        if (last < 0 || this.buffer[last] != -4)\n            this.buffer.push(this.lookAhead, this.reducePos, this.reducePos, -4);\n    }\n    updateContext(context) {\n        if (context != this.curContext.context) {\n            let newCx = new StackContext(this.curContext.tracker, context);\n            if (newCx.hash != this.curContext.hash)\n                this.emitContext();\n            this.curContext = newCx;\n        }\n    }\n    /// @internal\n    setLookAhead(lookAhead) {\n        if (lookAhead > this.lookAhead) {\n            this.emitLookAhead();\n            this.lookAhead = lookAhead;\n        }\n    }\n    /// @internal\n    close() {\n        if (this.curContext && this.curContext.tracker.strict)\n            this.emitContext();\n        if (this.lookAhead > 0)\n            this.emitLookAhead();\n    }\n}\nclass StackContext {\n    constructor(tracker, context) {\n        this.tracker = tracker;\n        this.context = context;\n        this.hash = tracker.strict ? tracker.hash(context) : 0;\n    }\n}\nvar Recover;\n(function (Recover) {\n    Recover[Recover[\"Insert\"] = 200] = \"Insert\";\n    Recover[Recover[\"Delete\"] = 190] = \"Delete\";\n    Recover[Recover[\"Reduce\"] = 100] = \"Reduce\";\n    Recover[Recover[\"MaxNext\"] = 4] = \"MaxNext\";\n    Recover[Recover[\"MaxInsertStackDepth\"] = 300] = \"MaxInsertStackDepth\";\n    Recover[Recover[\"DampenInsertStackDepth\"] = 120] = \"DampenInsertStackDepth\";\n    Recover[Recover[\"MinBigReduction\"] = 2000] = \"MinBigReduction\";\n})(Recover || (Recover = {}));\n// Used to cheaply run some reductions to scan ahead without mutating\n// an entire stack\nclass SimulatedStack {\n    constructor(start) {\n        this.start = start;\n        this.state = start.state;\n        this.stack = start.stack;\n        this.base = this.stack.length;\n    }\n    reduce(action) {\n        let term = action & 65535 /* Action.ValueMask */, depth = action >> 19 /* Action.ReduceDepthShift */;\n        if (depth == 0) {\n            if (this.stack == this.start.stack)\n                this.stack = this.stack.slice();\n            this.stack.push(this.state, 0, 0);\n            this.base += 3;\n        }\n        else {\n            this.base -= (depth - 1) * 3;\n        }\n        let goto = this.start.p.parser.getGoto(this.stack[this.base - 3], term, true);\n        this.state = goto;\n    }\n}\n// This is given to `Tree.build` to build a buffer, and encapsulates\n// the parent-stack-walking necessary to read the nodes.\nclass StackBufferCursor {\n    constructor(stack, pos, index) {\n        this.stack = stack;\n        this.pos = pos;\n        this.index = index;\n        this.buffer = stack.buffer;\n        if (this.index == 0)\n            this.maybeNext();\n    }\n    static create(stack, pos = stack.bufferBase + stack.buffer.length) {\n        return new StackBufferCursor(stack, pos, pos - stack.bufferBase);\n    }\n    maybeNext() {\n        let next = this.stack.parent;\n        if (next != null) {\n            this.index = this.stack.bufferBase - next.bufferBase;\n            this.stack = next;\n            this.buffer = next.buffer;\n        }\n    }\n    get id() { return this.buffer[this.index - 4]; }\n    get start() { return this.buffer[this.index - 3]; }\n    get end() { return this.buffer[this.index - 2]; }\n    get size() { return this.buffer[this.index - 1]; }\n    next() {\n        this.index -= 4;\n        this.pos -= 4;\n        if (this.index == 0)\n            this.maybeNext();\n    }\n    fork() {\n        return new StackBufferCursor(this.stack, this.pos, this.index);\n    }\n}\n\n// See lezer-generator/src/encode.ts for comments about the encoding\n// used here\nfunction decodeArray(input, Type = Uint16Array) {\n    if (typeof input != \"string\")\n        return input;\n    let array = null;\n    for (let pos = 0, out = 0; pos < input.length;) {\n        let value = 0;\n        for (;;) {\n            let next = input.charCodeAt(pos++), stop = false;\n            if (next == 126 /* Encode.BigValCode */) {\n                value = 65535 /* Encode.BigVal */;\n                break;\n            }\n            if (next >= 92 /* Encode.Gap2 */)\n                next--;\n            if (next >= 34 /* Encode.Gap1 */)\n                next--;\n            let digit = next - 32 /* Encode.Start */;\n            if (digit >= 46 /* Encode.Base */) {\n                digit -= 46 /* Encode.Base */;\n                stop = true;\n            }\n            value += digit;\n            if (stop)\n                break;\n            value *= 46 /* Encode.Base */;\n        }\n        if (array)\n            array[out++] = value;\n        else\n            array = new Type(value);\n    }\n    return array;\n}\n\nclass CachedToken {\n    constructor() {\n        this.start = -1;\n        this.value = -1;\n        this.end = -1;\n        this.extended = -1;\n        this.lookAhead = 0;\n        this.mask = 0;\n        this.context = 0;\n    }\n}\nconst nullToken = new CachedToken;\n/// [Tokenizers](#lr.ExternalTokenizer) interact with the input\n/// through this interface. It presents the input as a stream of\n/// characters, tracking lookahead and hiding the complexity of\n/// [ranges](#common.Parser.parse^ranges) from tokenizer code.\nclass InputStream {\n    /// @internal\n    constructor(\n    /// @internal\n    input, \n    /// @internal\n    ranges) {\n        this.input = input;\n        this.ranges = ranges;\n        /// @internal\n        this.chunk = \"\";\n        /// @internal\n        this.chunkOff = 0;\n        /// Backup chunk\n        this.chunk2 = \"\";\n        this.chunk2Pos = 0;\n        /// The character code of the next code unit in the input, or -1\n        /// when the stream is at the end of the input.\n        this.next = -1;\n        /// @internal\n        this.token = nullToken;\n        this.rangeIndex = 0;\n        this.pos = this.chunkPos = ranges[0].from;\n        this.range = ranges[0];\n        this.end = ranges[ranges.length - 1].to;\n        this.readNext();\n    }\n    /// @internal\n    resolveOffset(offset, assoc) {\n        let range = this.range, index = this.rangeIndex;\n        let pos = this.pos + offset;\n        while (pos < range.from) {\n            if (!index)\n                return null;\n            let next = this.ranges[--index];\n            pos -= range.from - next.to;\n            range = next;\n        }\n        while (assoc < 0 ? pos > range.to : pos >= range.to) {\n            if (index == this.ranges.length - 1)\n                return null;\n            let next = this.ranges[++index];\n            pos += next.from - range.to;\n            range = next;\n        }\n        return pos;\n    }\n    /// @internal\n    clipPos(pos) {\n        if (pos >= this.range.from && pos < this.range.to)\n            return pos;\n        for (let range of this.ranges)\n            if (range.to > pos)\n                return Math.max(pos, range.from);\n        return this.end;\n    }\n    /// Look at a code unit near the stream position. `.peek(0)` equals\n    /// `.next`, `.peek(-1)` gives you the previous character, and so\n    /// on.\n    ///\n    /// Note that looking around during tokenizing creates dependencies\n    /// on potentially far-away content, which may reduce the\n    /// effectiveness incremental parsing—when looking forward—or even\n    /// cause invalid reparses when looking backward more than 25 code\n    /// units, since the library does not track lookbehind.\n    peek(offset) {\n        let idx = this.chunkOff + offset, pos, result;\n        if (idx >= 0 && idx < this.chunk.length) {\n            pos = this.pos + offset;\n            result = this.chunk.charCodeAt(idx);\n        }\n        else {\n            let resolved = this.resolveOffset(offset, 1);\n            if (resolved == null)\n                return -1;\n            pos = resolved;\n            if (pos >= this.chunk2Pos && pos < this.chunk2Pos + this.chunk2.length) {\n                result = this.chunk2.charCodeAt(pos - this.chunk2Pos);\n            }\n            else {\n                let i = this.rangeIndex, range = this.range;\n                while (range.to <= pos)\n                    range = this.ranges[++i];\n                this.chunk2 = this.input.chunk(this.chunk2Pos = pos);\n                if (pos + this.chunk2.length > range.to)\n                    this.chunk2 = this.chunk2.slice(0, range.to - pos);\n                result = this.chunk2.charCodeAt(0);\n            }\n        }\n        if (pos >= this.token.lookAhead)\n            this.token.lookAhead = pos + 1;\n        return result;\n    }\n    /// Accept a token. By default, the end of the token is set to the\n    /// current stream position, but you can pass an offset (relative to\n    /// the stream position) to change that.\n    acceptToken(token, endOffset = 0) {\n        let end = endOffset ? this.resolveOffset(endOffset, -1) : this.pos;\n        if (end == null || end < this.token.start)\n            throw new RangeError(\"Token end out of bounds\");\n        this.token.value = token;\n        this.token.end = end;\n    }\n    getChunk() {\n        if (this.pos >= this.chunk2Pos && this.pos < this.chunk2Pos + this.chunk2.length) {\n            let { chunk, chunkPos } = this;\n            this.chunk = this.chunk2;\n            this.chunkPos = this.chunk2Pos;\n            this.chunk2 = chunk;\n            this.chunk2Pos = chunkPos;\n            this.chunkOff = this.pos - this.chunkPos;\n        }\n        else {\n            this.chunk2 = this.chunk;\n            this.chunk2Pos = this.chunkPos;\n            let nextChunk = this.input.chunk(this.pos);\n            let end = this.pos + nextChunk.length;\n            this.chunk = end > this.range.to ? nextChunk.slice(0, this.range.to - this.pos) : nextChunk;\n            this.chunkPos = this.pos;\n            this.chunkOff = 0;\n        }\n    }\n    readNext() {\n        if (this.chunkOff >= this.chunk.length) {\n            this.getChunk();\n            if (this.chunkOff == this.chunk.length)\n                return this.next = -1;\n        }\n        return this.next = this.chunk.charCodeAt(this.chunkOff);\n    }\n    /// Move the stream forward N (defaults to 1) code units. Returns\n    /// the new value of [`next`](#lr.InputStream.next).\n    advance(n = 1) {\n        this.chunkOff += n;\n        while (this.pos + n >= this.range.to) {\n            if (this.rangeIndex == this.ranges.length - 1)\n                return this.setDone();\n            n -= this.range.to - this.pos;\n            this.range = this.ranges[++this.rangeIndex];\n            this.pos = this.range.from;\n        }\n        this.pos += n;\n        if (this.pos >= this.token.lookAhead)\n            this.token.lookAhead = this.pos + 1;\n        return this.readNext();\n    }\n    setDone() {\n        this.pos = this.chunkPos = this.end;\n        this.range = this.ranges[this.rangeIndex = this.ranges.length - 1];\n        this.chunk = \"\";\n        return this.next = -1;\n    }\n    /// @internal\n    reset(pos, token) {\n        if (token) {\n            this.token = token;\n            token.start = pos;\n            token.lookAhead = pos + 1;\n            token.value = token.extended = -1;\n        }\n        else {\n            this.token = nullToken;\n        }\n        if (this.pos != pos) {\n            this.pos = pos;\n            if (pos == this.end) {\n                this.setDone();\n                return this;\n            }\n            while (pos < this.range.from)\n                this.range = this.ranges[--this.rangeIndex];\n            while (pos >= this.range.to)\n                this.range = this.ranges[++this.rangeIndex];\n            if (pos >= this.chunkPos && pos < this.chunkPos + this.chunk.length) {\n                this.chunkOff = pos - this.chunkPos;\n            }\n            else {\n                this.chunk = \"\";\n                this.chunkOff = 0;\n            }\n            this.readNext();\n        }\n        return this;\n    }\n    /// @internal\n    read(from, to) {\n        if (from >= this.chunkPos && to <= this.chunkPos + this.chunk.length)\n            return this.chunk.slice(from - this.chunkPos, to - this.chunkPos);\n        if (from >= this.chunk2Pos && to <= this.chunk2Pos + this.chunk2.length)\n            return this.chunk2.slice(from - this.chunk2Pos, to - this.chunk2Pos);\n        if (from >= this.range.from && to <= this.range.to)\n            return this.input.read(from, to);\n        let result = \"\";\n        for (let r of this.ranges) {\n            if (r.from >= to)\n                break;\n            if (r.to > from)\n                result += this.input.read(Math.max(r.from, from), Math.min(r.to, to));\n        }\n        return result;\n    }\n}\n/// @internal\nclass TokenGroup {\n    constructor(data, id) {\n        this.data = data;\n        this.id = id;\n    }\n    token(input, stack) {\n        let { parser } = stack.p;\n        readToken(this.data, input, stack, this.id, parser.data, parser.tokenPrecTable);\n    }\n}\nTokenGroup.prototype.contextual = TokenGroup.prototype.fallback = TokenGroup.prototype.extend = false;\n/// @hide\nclass LocalTokenGroup {\n    constructor(data, precTable, elseToken) {\n        this.precTable = precTable;\n        this.elseToken = elseToken;\n        this.data = typeof data == \"string\" ? decodeArray(data) : data;\n    }\n    token(input, stack) {\n        let start = input.pos, cur;\n        for (;;) {\n            cur = input.pos;\n            readToken(this.data, input, stack, 0, this.data, this.precTable);\n            if (input.token.value > -1)\n                break;\n            if (this.elseToken == null)\n                return;\n            if (input.next < 0)\n                break;\n            input.advance();\n            input.reset(cur + 1, input.token);\n        }\n        if (cur > start) {\n            input.reset(start, input.token);\n            input.acceptToken(this.elseToken, cur - start);\n        }\n    }\n}\nLocalTokenGroup.prototype.contextual = TokenGroup.prototype.fallback = TokenGroup.prototype.extend = false;\n/// `@external tokens` declarations in the grammar should resolve to\n/// an instance of this class.\nclass ExternalTokenizer {\n    /// Create a tokenizer. The first argument is the function that,\n    /// given an input stream, scans for the types of tokens it\n    /// recognizes at the stream's position, and calls\n    /// [`acceptToken`](#lr.InputStream.acceptToken) when it finds\n    /// one.\n    constructor(\n    /// @internal\n    token, options = {}) {\n        this.token = token;\n        this.contextual = !!options.contextual;\n        this.fallback = !!options.fallback;\n        this.extend = !!options.extend;\n    }\n}\n// Tokenizer data is stored a big uint16 array containing, for each\n// state:\n//\n//  - A group bitmask, indicating what token groups are reachable from\n//    this state, so that paths that can only lead to tokens not in\n//    any of the current groups can be cut off early.\n//\n//  - The position of the end of the state's sequence of accepting\n//    tokens\n//\n//  - The number of outgoing edges for the state\n//\n//  - The accepting tokens, as (token id, group mask) pairs\n//\n//  - The outgoing edges, as (start character, end character, state\n//    index) triples, with end character being exclusive\n//\n// This function interprets that data, running through a stream as\n// long as new states with the a matching group mask can be reached,\n// and updating `input.token` when it matches a token.\nfunction readToken(data, input, stack, group, precTable, precOffset) {\n    let state = 0, groupMask = 1 << group, { dialect } = stack.p.parser;\n    scan: for (;;) {\n        if ((groupMask & data[state]) == 0)\n            break;\n        let accEnd = data[state + 1];\n        // Check whether this state can lead to a token in the current group\n        // Accept tokens in this state, possibly overwriting\n        // lower-precedence / shorter tokens\n        for (let i = state + 3; i < accEnd; i += 2)\n            if ((data[i + 1] & groupMask) > 0) {\n                let term = data[i];\n                if (dialect.allows(term) &&\n                    (input.token.value == -1 || input.token.value == term ||\n                        overrides(term, input.token.value, precTable, precOffset))) {\n                    input.acceptToken(term);\n                    break;\n                }\n            }\n        let next = input.next, low = 0, high = data[state + 2];\n        // Special case for EOF\n        if (input.next < 0 && high > low && data[accEnd + high * 3 - 3] == 65535 /* Seq.End */ && data[accEnd + high * 3 - 3] == 65535 /* Seq.End */) {\n            state = data[accEnd + high * 3 - 1];\n            continue scan;\n        }\n        // Do a binary search on the state's edges\n        for (; low < high;) {\n            let mid = (low + high) >> 1;\n            let index = accEnd + mid + (mid << 1);\n            let from = data[index], to = data[index + 1] || 0x10000;\n            if (next < from)\n                high = mid;\n            else if (next >= to)\n                low = mid + 1;\n            else {\n                state = data[index + 2];\n                input.advance();\n                continue scan;\n            }\n        }\n        break;\n    }\n}\nfunction findOffset(data, start, term) {\n    for (let i = start, next; (next = data[i]) != 65535 /* Seq.End */; i++)\n        if (next == term)\n            return i - start;\n    return -1;\n}\nfunction overrides(token, prev, tableData, tableOffset) {\n    let iPrev = findOffset(tableData, tableOffset, prev);\n    return iPrev < 0 || findOffset(tableData, tableOffset, token) < iPrev;\n}\n\n// Environment variable used to control console output\nconst verbose = typeof process != \"undefined\" && process.env && /\\bparse\\b/.test(process.env.LOG);\nlet stackIDs = null;\nvar Safety;\n(function (Safety) {\n    Safety[Safety[\"Margin\"] = 25] = \"Margin\";\n})(Safety || (Safety = {}));\nfunction cutAt(tree, pos, side) {\n    let cursor = tree.cursor(IterMode.IncludeAnonymous);\n    cursor.moveTo(pos);\n    for (;;) {\n        if (!(side < 0 ? cursor.childBefore(pos) : cursor.childAfter(pos)))\n            for (;;) {\n                if ((side < 0 ? cursor.to < pos : cursor.from > pos) && !cursor.type.isError)\n                    return side < 0 ? Math.max(0, Math.min(cursor.to - 1, pos - 25 /* Safety.Margin */))\n                        : Math.min(tree.length, Math.max(cursor.from + 1, pos + 25 /* Safety.Margin */));\n                if (side < 0 ? cursor.prevSibling() : cursor.nextSibling())\n                    break;\n                if (!cursor.parent())\n                    return side < 0 ? 0 : tree.length;\n            }\n    }\n}\nclass FragmentCursor {\n    constructor(fragments, nodeSet) {\n        this.fragments = fragments;\n        this.nodeSet = nodeSet;\n        this.i = 0;\n        this.fragment = null;\n        this.safeFrom = -1;\n        this.safeTo = -1;\n        this.trees = [];\n        this.start = [];\n        this.index = [];\n        this.nextFragment();\n    }\n    nextFragment() {\n        let fr = this.fragment = this.i == this.fragments.length ? null : this.fragments[this.i++];\n        if (fr) {\n            this.safeFrom = fr.openStart ? cutAt(fr.tree, fr.from + fr.offset, 1) - fr.offset : fr.from;\n            this.safeTo = fr.openEnd ? cutAt(fr.tree, fr.to + fr.offset, -1) - fr.offset : fr.to;\n            while (this.trees.length) {\n                this.trees.pop();\n                this.start.pop();\n                this.index.pop();\n            }\n            this.trees.push(fr.tree);\n            this.start.push(-fr.offset);\n            this.index.push(0);\n            this.nextStart = this.safeFrom;\n        }\n        else {\n            this.nextStart = 1e9;\n        }\n    }\n    // `pos` must be >= any previously given `pos` for this cursor\n    nodeAt(pos) {\n        if (pos < this.nextStart)\n            return null;\n        while (this.fragment && this.safeTo <= pos)\n            this.nextFragment();\n        if (!this.fragment)\n            return null;\n        for (;;) {\n            let last = this.trees.length - 1;\n            if (last < 0) { // End of tree\n                this.nextFragment();\n                return null;\n            }\n            let top = this.trees[last], index = this.index[last];\n            if (index == top.children.length) {\n                this.trees.pop();\n                this.start.pop();\n                this.index.pop();\n                continue;\n            }\n            let next = top.children[index];\n            let start = this.start[last] + top.positions[index];\n            if (start > pos) {\n                this.nextStart = start;\n                return null;\n            }\n            if (next instanceof Tree) {\n                if (start == pos) {\n                    if (start < this.safeFrom)\n                        return null;\n                    let end = start + next.length;\n                    if (end <= this.safeTo) {\n                        let lookAhead = next.prop(NodeProp.lookAhead);\n                        if (!lookAhead || end + lookAhead < this.fragment.to)\n                            return next;\n                    }\n                }\n                this.index[last]++;\n                if (start + next.length >= Math.max(this.safeFrom, pos)) { // Enter this node\n                    this.trees.push(next);\n                    this.start.push(start);\n                    this.index.push(0);\n                }\n            }\n            else {\n                this.index[last]++;\n                this.nextStart = start + next.length;\n            }\n        }\n    }\n}\nclass TokenCache {\n    constructor(parser, stream) {\n        this.stream = stream;\n        this.tokens = [];\n        this.mainToken = null;\n        this.actions = [];\n        this.tokens = parser.tokenizers.map(_ => new CachedToken);\n    }\n    getActions(stack) {\n        let actionIndex = 0;\n        let main = null;\n        let { parser } = stack.p, { tokenizers } = parser;\n        let mask = parser.stateSlot(stack.state, 3 /* ParseState.TokenizerMask */);\n        let context = stack.curContext ? stack.curContext.hash : 0;\n        let lookAhead = 0;\n        for (let i = 0; i < tokenizers.length; i++) {\n            if (((1 << i) & mask) == 0)\n                continue;\n            let tokenizer = tokenizers[i], token = this.tokens[i];\n            if (main && !tokenizer.fallback)\n                continue;\n            if (tokenizer.contextual || token.start != stack.pos || token.mask != mask || token.context != context) {\n                this.updateCachedToken(token, tokenizer, stack);\n                token.mask = mask;\n                token.context = context;\n            }\n            if (token.lookAhead > token.end + 25 /* Safety.Margin */)\n                lookAhead = Math.max(token.lookAhead, lookAhead);\n            if (token.value != 0 /* Term.Err */) {\n                let startIndex = actionIndex;\n                if (token.extended > -1)\n                    actionIndex = this.addActions(stack, token.extended, token.end, actionIndex);\n                actionIndex = this.addActions(stack, token.value, token.end, actionIndex);\n                if (!tokenizer.extend) {\n                    main = token;\n                    if (actionIndex > startIndex)\n                        break;\n                }\n            }\n        }\n        while (this.actions.length > actionIndex)\n            this.actions.pop();\n        if (lookAhead)\n            stack.setLookAhead(lookAhead);\n        if (!main && stack.pos == this.stream.end) {\n            main = new CachedToken;\n            main.value = stack.p.parser.eofTerm;\n            main.start = main.end = stack.pos;\n            actionIndex = this.addActions(stack, main.value, main.end, actionIndex);\n        }\n        this.mainToken = main;\n        return this.actions;\n    }\n    getMainToken(stack) {\n        if (this.mainToken)\n            return this.mainToken;\n        let main = new CachedToken, { pos, p } = stack;\n        main.start = pos;\n        main.end = Math.min(pos + 1, p.stream.end);\n        main.value = pos == p.stream.end ? p.parser.eofTerm : 0 /* Term.Err */;\n        return main;\n    }\n    updateCachedToken(token, tokenizer, stack) {\n        let start = this.stream.clipPos(stack.pos);\n        tokenizer.token(this.stream.reset(start, token), stack);\n        if (token.value > -1) {\n            let { parser } = stack.p;\n            for (let i = 0; i < parser.specialized.length; i++)\n                if (parser.specialized[i] == token.value) {\n                    let result = parser.specializers[i](this.stream.read(token.start, token.end), stack);\n                    if (result >= 0 && stack.p.parser.dialect.allows(result >> 1)) {\n                        if ((result & 1) == 0 /* Specialize.Specialize */)\n                            token.value = result >> 1;\n                        else\n                            token.extended = result >> 1;\n                        break;\n                    }\n                }\n        }\n        else {\n            token.value = 0 /* Term.Err */;\n            token.end = this.stream.clipPos(start + 1);\n        }\n    }\n    putAction(action, token, end, index) {\n        // Don't add duplicate actions\n        for (let i = 0; i < index; i += 3)\n            if (this.actions[i] == action)\n                return index;\n        this.actions[index++] = action;\n        this.actions[index++] = token;\n        this.actions[index++] = end;\n        return index;\n    }\n    addActions(stack, token, end, index) {\n        let { state } = stack, { parser } = stack.p, { data } = parser;\n        for (let set = 0; set < 2; set++) {\n            for (let i = parser.stateSlot(state, set ? 2 /* ParseState.Skip */ : 1 /* ParseState.Actions */);; i += 3) {\n                if (data[i] == 65535 /* Seq.End */) {\n                    if (data[i + 1] == 1 /* Seq.Next */) {\n                        i = pair(data, i + 2);\n                    }\n                    else {\n                        if (index == 0 && data[i + 1] == 2 /* Seq.Other */)\n                            index = this.putAction(pair(data, i + 2), token, end, index);\n                        break;\n                    }\n                }\n                if (data[i] == token)\n                    index = this.putAction(pair(data, i + 1), token, end, index);\n            }\n        }\n        return index;\n    }\n}\nvar Rec;\n(function (Rec) {\n    Rec[Rec[\"Distance\"] = 5] = \"Distance\";\n    Rec[Rec[\"MaxRemainingPerStep\"] = 3] = \"MaxRemainingPerStep\";\n    // When two stacks have been running independently long enough to\n    // add this many elements to their buffers, prune one.\n    Rec[Rec[\"MinBufferLengthPrune\"] = 500] = \"MinBufferLengthPrune\";\n    Rec[Rec[\"ForceReduceLimit\"] = 10] = \"ForceReduceLimit\";\n    // Once a stack reaches this depth (in .stack.length) force-reduce\n    // it back to CutTo to avoid creating trees that overflow the stack\n    // on recursive traversal.\n    Rec[Rec[\"CutDepth\"] = 15000] = \"CutDepth\";\n    Rec[Rec[\"CutTo\"] = 9000] = \"CutTo\";\n    Rec[Rec[\"MaxLeftAssociativeReductionCount\"] = 300] = \"MaxLeftAssociativeReductionCount\";\n    // The maximum number of non-recovering stacks to explore (to avoid\n    // getting bogged down with exponentially multiplying stacks in\n    // ambiguous content)\n    Rec[Rec[\"MaxStackCount\"] = 12] = \"MaxStackCount\";\n})(Rec || (Rec = {}));\nclass Parse {\n    constructor(parser, input, fragments, ranges) {\n        this.parser = parser;\n        this.input = input;\n        this.ranges = ranges;\n        this.recovering = 0;\n        this.nextStackID = 0x2654; // ♔, ♕, ♖, ♗, ♘, ♙, ♠, ♡, ♢, ♣, ♤, ♥, ♦, ♧\n        this.minStackPos = 0;\n        this.reused = [];\n        this.stoppedAt = null;\n        this.lastBigReductionStart = -1;\n        this.lastBigReductionSize = 0;\n        this.bigReductionCount = 0;\n        this.stream = new InputStream(input, ranges);\n        this.tokens = new TokenCache(parser, this.stream);\n        this.topTerm = parser.top[1];\n        let { from } = ranges[0];\n        this.stacks = [Stack.start(this, parser.top[0], from)];\n        this.fragments = fragments.length && this.stream.end - from > parser.bufferLength * 4\n            ? new FragmentCursor(fragments, parser.nodeSet) : null;\n    }\n    get parsedPos() {\n        return this.minStackPos;\n    }\n    // Move the parser forward. This will process all parse stacks at\n    // `this.pos` and try to advance them to a further position. If no\n    // stack for such a position is found, it'll start error-recovery.\n    //\n    // When the parse is finished, this will return a syntax tree. When\n    // not, it returns `null`.\n    advance() {\n        let stacks = this.stacks, pos = this.minStackPos;\n        // This will hold stacks beyond `pos`.\n        let newStacks = this.stacks = [];\n        let stopped, stoppedTokens;\n        // If a large amount of reductions happened with the same start\n        // position, force the stack out of that production in order to\n        // avoid creating a tree too deep to recurse through.\n        // (This is an ugly kludge, because unfortunately there is no\n        // straightforward, cheap way to check for this happening, due to\n        // the history of reductions only being available in an\n        // expensive-to-access format in the stack buffers.)\n        if (this.bigReductionCount > 300 /* Rec.MaxLeftAssociativeReductionCount */ && stacks.length == 1) {\n            let [s] = stacks;\n            while (s.forceReduce() && s.stack.length && s.stack[s.stack.length - 2] >= this.lastBigReductionStart) { }\n            this.bigReductionCount = this.lastBigReductionSize = 0;\n        }\n        // Keep advancing any stacks at `pos` until they either move\n        // forward or can't be advanced. Gather stacks that can't be\n        // advanced further in `stopped`.\n        for (let i = 0; i < stacks.length; i++) {\n            let stack = stacks[i];\n            for (;;) {\n                this.tokens.mainToken = null;\n                if (stack.pos > pos) {\n                    newStacks.push(stack);\n                }\n                else if (this.advanceStack(stack, newStacks, stacks)) {\n                    continue;\n                }\n                else {\n                    if (!stopped) {\n                        stopped = [];\n                        stoppedTokens = [];\n                    }\n                    stopped.push(stack);\n                    let tok = this.tokens.getMainToken(stack);\n                    stoppedTokens.push(tok.value, tok.end);\n                }\n                break;\n            }\n        }\n        if (!newStacks.length) {\n            let finished = stopped && findFinished(stopped);\n            if (finished)\n                return this.stackToTree(finished);\n            if (this.parser.strict) {\n                if (verbose && stopped)\n                    console.log(\"Stuck with token \" + (this.tokens.mainToken ? this.parser.getName(this.tokens.mainToken.value) : \"none\"));\n                throw new SyntaxError(\"No parse at \" + pos);\n            }\n            if (!this.recovering)\n                this.recovering = 5 /* Rec.Distance */;\n        }\n        if (this.recovering && stopped) {\n            let finished = this.stoppedAt != null && stopped[0].pos > this.stoppedAt ? stopped[0]\n                : this.runRecovery(stopped, stoppedTokens, newStacks);\n            if (finished)\n                return this.stackToTree(finished.forceAll());\n        }\n        if (this.recovering) {\n            let maxRemaining = this.recovering == 1 ? 1 : this.recovering * 3 /* Rec.MaxRemainingPerStep */;\n            if (newStacks.length > maxRemaining) {\n                newStacks.sort((a, b) => b.score - a.score);\n                while (newStacks.length > maxRemaining)\n                    newStacks.pop();\n            }\n            if (newStacks.some(s => s.reducePos > pos))\n                this.recovering--;\n        }\n        else if (newStacks.length > 1) {\n            // Prune stacks that are in the same state, or that have been\n            // running without splitting for a while, to avoid getting stuck\n            // with multiple successful stacks running endlessly on.\n            outer: for (let i = 0; i < newStacks.length - 1; i++) {\n                let stack = newStacks[i];\n                for (let j = i + 1; j < newStacks.length; j++) {\n                    let other = newStacks[j];\n                    if (stack.sameState(other) ||\n                        stack.buffer.length > 500 /* Rec.MinBufferLengthPrune */ && other.buffer.length > 500 /* Rec.MinBufferLengthPrune */) {\n                        if (((stack.score - other.score) || (stack.buffer.length - other.buffer.length)) > 0) {\n                            newStacks.splice(j--, 1);\n                        }\n                        else {\n                            newStacks.splice(i--, 1);\n                            continue outer;\n                        }\n                    }\n                }\n            }\n            if (newStacks.length > 12 /* Rec.MaxStackCount */)\n                newStacks.splice(12 /* Rec.MaxStackCount */, newStacks.length - 12 /* Rec.MaxStackCount */);\n        }\n        this.minStackPos = newStacks[0].pos;\n        for (let i = 1; i < newStacks.length; i++)\n            if (newStacks[i].pos < this.minStackPos)\n                this.minStackPos = newStacks[i].pos;\n        return null;\n    }\n    stopAt(pos) {\n        if (this.stoppedAt != null && this.stoppedAt < pos)\n            throw new RangeError(\"Can't move stoppedAt forward\");\n        this.stoppedAt = pos;\n    }\n    // Returns an updated version of the given stack, or null if the\n    // stack can't advance normally. When `split` and `stacks` are\n    // given, stacks split off by ambiguous operations will be pushed to\n    // `split`, or added to `stacks` if they move `pos` forward.\n    advanceStack(stack, stacks, split) {\n        let start = stack.pos, { parser } = this;\n        let base = verbose ? this.stackID(stack) + \" -> \" : \"\";\n        if (this.stoppedAt != null && start > this.stoppedAt)\n            return stack.forceReduce() ? stack : null;\n        if (this.fragments) {\n            let strictCx = stack.curContext && stack.curContext.tracker.strict, cxHash = strictCx ? stack.curContext.hash : 0;\n            for (let cached = this.fragments.nodeAt(start); cached;) {\n                let match = this.parser.nodeSet.types[cached.type.id] == cached.type ? parser.getGoto(stack.state, cached.type.id) : -1;\n                if (match > -1 && cached.length && (!strictCx || (cached.prop(NodeProp.contextHash) || 0) == cxHash)) {\n                    stack.useNode(cached, match);\n                    if (verbose)\n                        console.log(base + this.stackID(stack) + ` (via reuse of ${parser.getName(cached.type.id)})`);\n                    return true;\n                }\n                if (!(cached instanceof Tree) || cached.children.length == 0 || cached.positions[0] > 0)\n                    break;\n                let inner = cached.children[0];\n                if (inner instanceof Tree && cached.positions[0] == 0)\n                    cached = inner;\n                else\n                    break;\n            }\n        }\n        let defaultReduce = parser.stateSlot(stack.state, 4 /* ParseState.DefaultReduce */);\n        if (defaultReduce > 0) {\n            stack.reduce(defaultReduce);\n            if (verbose)\n                console.log(base + this.stackID(stack) + ` (via always-reduce ${parser.getName(defaultReduce & 65535 /* Action.ValueMask */)})`);\n            return true;\n        }\n        if (stack.stack.length >= 15000 /* Rec.CutDepth */) {\n            while (stack.stack.length > 9000 /* Rec.CutTo */ && stack.forceReduce()) { }\n        }\n        let actions = this.tokens.getActions(stack);\n        for (let i = 0; i < actions.length;) {\n            let action = actions[i++], term = actions[i++], end = actions[i++];\n            let last = i == actions.length || !split;\n            let localStack = last ? stack : stack.split();\n            localStack.apply(action, term, end);\n            if (verbose)\n                console.log(base + this.stackID(localStack) + ` (via ${(action & 65536 /* Action.ReduceFlag */) == 0 ? \"shift\"\n                    : `reduce of ${parser.getName(action & 65535 /* Action.ValueMask */)}`} for ${parser.getName(term)} @ ${start}${localStack == stack ? \"\" : \", split\"})`);\n            if (last)\n                return true;\n            else if (localStack.pos > start)\n                stacks.push(localStack);\n            else\n                split.push(localStack);\n        }\n        return false;\n    }\n    // Advance a given stack forward as far as it will go. Returns the\n    // (possibly updated) stack if it got stuck, or null if it moved\n    // forward and was given to `pushStackDedup`.\n    advanceFully(stack, newStacks) {\n        let pos = stack.pos;\n        for (;;) {\n            if (!this.advanceStack(stack, null, null))\n                return false;\n            if (stack.pos > pos) {\n                pushStackDedup(stack, newStacks);\n                return true;\n            }\n        }\n    }\n    runRecovery(stacks, tokens, newStacks) {\n        let finished = null, restarted = false;\n        for (let i = 0; i < stacks.length; i++) {\n            let stack = stacks[i], token = tokens[i << 1], tokenEnd = tokens[(i << 1) + 1];\n            let base = verbose ? this.stackID(stack) + \" -> \" : \"\";\n            if (stack.deadEnd) {\n                if (restarted)\n                    continue;\n                restarted = true;\n                stack.restart();\n                if (verbose)\n                    console.log(base + this.stackID(stack) + \" (restarted)\");\n                let done = this.advanceFully(stack, newStacks);\n                if (done)\n                    continue;\n            }\n            let force = stack.split(), forceBase = base;\n            for (let j = 0; force.forceReduce() && j < 10 /* Rec.ForceReduceLimit */; j++) {\n                if (verbose)\n                    console.log(forceBase + this.stackID(force) + \" (via force-reduce)\");\n                let done = this.advanceFully(force, newStacks);\n                if (done)\n                    break;\n                if (verbose)\n                    forceBase = this.stackID(force) + \" -> \";\n            }\n            for (let insert of stack.recoverByInsert(token)) {\n                if (verbose)\n                    console.log(base + this.stackID(insert) + \" (via recover-insert)\");\n                this.advanceFully(insert, newStacks);\n            }\n            if (this.stream.end > stack.pos) {\n                if (tokenEnd == stack.pos) {\n                    tokenEnd++;\n                    token = 0 /* Term.Err */;\n                }\n                stack.recoverByDelete(token, tokenEnd);\n                if (verbose)\n                    console.log(base + this.stackID(stack) + ` (via recover-delete ${this.parser.getName(token)})`);\n                pushStackDedup(stack, newStacks);\n            }\n            else if (!finished || finished.score < stack.score) {\n                finished = stack;\n            }\n        }\n        return finished;\n    }\n    // Convert the stack's buffer to a syntax tree.\n    stackToTree(stack) {\n        stack.close();\n        return Tree.build({ buffer: StackBufferCursor.create(stack),\n            nodeSet: this.parser.nodeSet,\n            topID: this.topTerm,\n            maxBufferLength: this.parser.bufferLength,\n            reused: this.reused,\n            start: this.ranges[0].from,\n            length: stack.pos - this.ranges[0].from,\n            minRepeatType: this.parser.minRepeatTerm });\n    }\n    stackID(stack) {\n        let id = (stackIDs || (stackIDs = new WeakMap)).get(stack);\n        if (!id)\n            stackIDs.set(stack, id = String.fromCodePoint(this.nextStackID++));\n        return id + stack;\n    }\n}\nfunction pushStackDedup(stack, newStacks) {\n    for (let i = 0; i < newStacks.length; i++) {\n        let other = newStacks[i];\n        if (other.pos == stack.pos && other.sameState(stack)) {\n            if (newStacks[i].score < stack.score)\n                newStacks[i] = stack;\n            return;\n        }\n    }\n    newStacks.push(stack);\n}\nclass Dialect {\n    constructor(source, flags, disabled) {\n        this.source = source;\n        this.flags = flags;\n        this.disabled = disabled;\n    }\n    allows(term) { return !this.disabled || this.disabled[term] == 0; }\n}\nconst id = x => x;\n/// Context trackers are used to track stateful context (such as\n/// indentation in the Python grammar, or parent elements in the XML\n/// grammar) needed by external tokenizers. You declare them in a\n/// grammar file as `@context exportName from \"module\"`.\n///\n/// Context values should be immutable, and can be updated (replaced)\n/// on shift or reduce actions.\n///\n/// The export used in a `@context` declaration should be of this\n/// type.\nclass ContextTracker {\n    /// Define a context tracker.\n    constructor(spec) {\n        this.start = spec.start;\n        this.shift = spec.shift || id;\n        this.reduce = spec.reduce || id;\n        this.reuse = spec.reuse || id;\n        this.hash = spec.hash || (() => 0);\n        this.strict = spec.strict !== false;\n    }\n}\n/// Holds the parse tables for a given grammar, as generated by\n/// `lezer-generator`, and provides [methods](#common.Parser) to parse\n/// content with.\nclass LRParser extends Parser {\n    /// @internal\n    constructor(spec) {\n        super();\n        /// @internal\n        this.wrappers = [];\n        if (spec.version != 14 /* File.Version */)\n            throw new RangeError(`Parser version (${spec.version}) doesn't match runtime version (${14 /* File.Version */})`);\n        let nodeNames = spec.nodeNames.split(\" \");\n        this.minRepeatTerm = nodeNames.length;\n        for (let i = 0; i < spec.repeatNodeCount; i++)\n            nodeNames.push(\"\");\n        let topTerms = Object.keys(spec.topRules).map(r => spec.topRules[r][1]);\n        let nodeProps = [];\n        for (let i = 0; i < nodeNames.length; i++)\n            nodeProps.push([]);\n        function setProp(nodeID, prop, value) {\n            nodeProps[nodeID].push([prop, prop.deserialize(String(value))]);\n        }\n        if (spec.nodeProps)\n            for (let propSpec of spec.nodeProps) {\n                let prop = propSpec[0];\n                if (typeof prop == \"string\")\n                    prop = NodeProp[prop];\n                for (let i = 1; i < propSpec.length;) {\n                    let next = propSpec[i++];\n                    if (next >= 0) {\n                        setProp(next, prop, propSpec[i++]);\n                    }\n                    else {\n                        let value = propSpec[i + -next];\n                        for (let j = -next; j > 0; j--)\n                            setProp(propSpec[i++], prop, value);\n                        i++;\n                    }\n                }\n            }\n        this.nodeSet = new NodeSet(nodeNames.map((name, i) => NodeType.define({\n            name: i >= this.minRepeatTerm ? undefined : name,\n            id: i,\n            props: nodeProps[i],\n            top: topTerms.indexOf(i) > -1,\n            error: i == 0,\n            skipped: spec.skippedNodes && spec.skippedNodes.indexOf(i) > -1\n        })));\n        if (spec.propSources)\n            this.nodeSet = this.nodeSet.extend(...spec.propSources);\n        this.strict = false;\n        this.bufferLength = DefaultBufferLength;\n        let tokenArray = decodeArray(spec.tokenData);\n        this.context = spec.context;\n        this.specializerSpecs = spec.specialized || [];\n        this.specialized = new Uint16Array(this.specializerSpecs.length);\n        for (let i = 0; i < this.specializerSpecs.length; i++)\n            this.specialized[i] = this.specializerSpecs[i].term;\n        this.specializers = this.specializerSpecs.map(getSpecializer);\n        this.states = decodeArray(spec.states, Uint32Array);\n        this.data = decodeArray(spec.stateData);\n        this.goto = decodeArray(spec.goto);\n        this.maxTerm = spec.maxTerm;\n        this.tokenizers = spec.tokenizers.map(value => typeof value == \"number\" ? new TokenGroup(tokenArray, value) : value);\n        this.topRules = spec.topRules;\n        this.dialects = spec.dialects || {};\n        this.dynamicPrecedences = spec.dynamicPrecedences || null;\n        this.tokenPrecTable = spec.tokenPrec;\n        this.termNames = spec.termNames || null;\n        this.maxNode = this.nodeSet.types.length - 1;\n        this.dialect = this.parseDialect();\n        this.top = this.topRules[Object.keys(this.topRules)[0]];\n    }\n    createParse(input, fragments, ranges) {\n        let parse = new Parse(this, input, fragments, ranges);\n        for (let w of this.wrappers)\n            parse = w(parse, input, fragments, ranges);\n        return parse;\n    }\n    /// Get a goto table entry @internal\n    getGoto(state, term, loose = false) {\n        let table = this.goto;\n        if (term >= table[0])\n            return -1;\n        for (let pos = table[term + 1];;) {\n            let groupTag = table[pos++], last = groupTag & 1;\n            let target = table[pos++];\n            if (last && loose)\n                return target;\n            for (let end = pos + (groupTag >> 1); pos < end; pos++)\n                if (table[pos] == state)\n                    return target;\n            if (last)\n                return -1;\n        }\n    }\n    /// Check if this state has an action for a given terminal @internal\n    hasAction(state, terminal) {\n        let data = this.data;\n        for (let set = 0; set < 2; set++) {\n            for (let i = this.stateSlot(state, set ? 2 /* ParseState.Skip */ : 1 /* ParseState.Actions */), next;; i += 3) {\n                if ((next = data[i]) == 65535 /* Seq.End */) {\n                    if (data[i + 1] == 1 /* Seq.Next */)\n                        next = data[i = pair(data, i + 2)];\n                    else if (data[i + 1] == 2 /* Seq.Other */)\n                        return pair(data, i + 2);\n                    else\n                        break;\n                }\n                if (next == terminal || next == 0 /* Term.Err */)\n                    return pair(data, i + 1);\n            }\n        }\n        return 0;\n    }\n    /// @internal\n    stateSlot(state, slot) {\n        return this.states[(state * 6 /* ParseState.Size */) + slot];\n    }\n    /// @internal\n    stateFlag(state, flag) {\n        return (this.stateSlot(state, 0 /* ParseState.Flags */) & flag) > 0;\n    }\n    /// @internal\n    validAction(state, action) {\n        if (action == this.stateSlot(state, 4 /* ParseState.DefaultReduce */))\n            return true;\n        for (let i = this.stateSlot(state, 1 /* ParseState.Actions */);; i += 3) {\n            if (this.data[i] == 65535 /* Seq.End */) {\n                if (this.data[i + 1] == 1 /* Seq.Next */)\n                    i = pair(this.data, i + 2);\n                else\n                    return false;\n            }\n            if (action == pair(this.data, i + 1))\n                return true;\n        }\n    }\n    /// Get the states that can follow this one through shift actions or\n    /// goto jumps. @internal\n    nextStates(state) {\n        let result = [];\n        for (let i = this.stateSlot(state, 1 /* ParseState.Actions */);; i += 3) {\n            if (this.data[i] == 65535 /* Seq.End */) {\n                if (this.data[i + 1] == 1 /* Seq.Next */)\n                    i = pair(this.data, i + 2);\n                else\n                    break;\n            }\n            if ((this.data[i + 2] & (65536 /* Action.ReduceFlag */ >> 16)) == 0) {\n                let value = this.data[i + 1];\n                if (!result.some((v, i) => (i & 1) && v == value))\n                    result.push(this.data[i], value);\n            }\n        }\n        return result;\n    }\n    /// Configure the parser. Returns a new parser instance that has the\n    /// given settings modified. Settings not provided in `config` are\n    /// kept from the original parser.\n    configure(config) {\n        // Hideous reflection-based kludge to make it easy to create a\n        // slightly modified copy of a parser.\n        let copy = Object.assign(Object.create(LRParser.prototype), this);\n        if (config.props)\n            copy.nodeSet = this.nodeSet.extend(...config.props);\n        if (config.top) {\n            let info = this.topRules[config.top];\n            if (!info)\n                throw new RangeError(`Invalid top rule name ${config.top}`);\n            copy.top = info;\n        }\n        if (config.tokenizers)\n            copy.tokenizers = this.tokenizers.map(t => {\n                let found = config.tokenizers.find(r => r.from == t);\n                return found ? found.to : t;\n            });\n        if (config.specializers) {\n            copy.specializers = this.specializers.slice();\n            copy.specializerSpecs = this.specializerSpecs.map((s, i) => {\n                let found = config.specializers.find(r => r.from == s.external);\n                if (!found)\n                    return s;\n                let spec = Object.assign(Object.assign({}, s), { external: found.to });\n                copy.specializers[i] = getSpecializer(spec);\n                return spec;\n            });\n        }\n        if (config.contextTracker)\n            copy.context = config.contextTracker;\n        if (config.dialect)\n            copy.dialect = this.parseDialect(config.dialect);\n        if (config.strict != null)\n            copy.strict = config.strict;\n        if (config.wrap)\n            copy.wrappers = copy.wrappers.concat(config.wrap);\n        if (config.bufferLength != null)\n            copy.bufferLength = config.bufferLength;\n        return copy;\n    }\n    /// Tells you whether any [parse wrappers](#lr.ParserConfig.wrap)\n    /// are registered for this parser.\n    hasWrappers() {\n        return this.wrappers.length > 0;\n    }\n    /// Returns the name associated with a given term. This will only\n    /// work for all terms when the parser was generated with the\n    /// `--names` option. By default, only the names of tagged terms are\n    /// stored.\n    getName(term) {\n        return this.termNames ? this.termNames[term] : String(term <= this.maxNode && this.nodeSet.types[term].name || term);\n    }\n    /// The eof term id is always allocated directly after the node\n    /// types. @internal\n    get eofTerm() { return this.maxNode + 1; }\n    /// The type of top node produced by the parser.\n    get topNode() { return this.nodeSet.types[this.top[1]]; }\n    /// @internal\n    dynamicPrecedence(term) {\n        let prec = this.dynamicPrecedences;\n        return prec == null ? 0 : prec[term] || 0;\n    }\n    /// @internal\n    parseDialect(dialect) {\n        let values = Object.keys(this.dialects), flags = values.map(() => false);\n        if (dialect)\n            for (let part of dialect.split(\" \")) {\n                let id = values.indexOf(part);\n                if (id >= 0)\n                    flags[id] = true;\n            }\n        let disabled = null;\n        for (let i = 0; i < values.length; i++)\n            if (!flags[i]) {\n                for (let j = this.dialects[values[i]], id; (id = this.data[j++]) != 65535 /* Seq.End */;)\n                    (disabled || (disabled = new Uint8Array(this.maxTerm + 1)))[id] = 1;\n            }\n        return new Dialect(dialect, flags, disabled);\n    }\n    /// Used by the output of the parser generator. Not available to\n    /// user code. @hide\n    static deserialize(spec) {\n        return new LRParser(spec);\n    }\n}\nfunction pair(data, off) { return data[off] | (data[off + 1] << 16); }\nfunction findFinished(stacks) {\n    let best = null;\n    for (let stack of stacks) {\n        let stopped = stack.p.stoppedAt;\n        if ((stack.pos == stack.p.stream.end || stopped != null && stack.pos > stopped) &&\n            stack.p.parser.stateFlag(stack.state, 2 /* StateFlag.Accepting */) &&\n            (!best || best.score < stack.score))\n            best = stack;\n    }\n    return best;\n}\nfunction getSpecializer(spec) {\n    if (spec.external) {\n        let mask = spec.extend ? 1 /* Specialize.Extend */ : 0 /* Specialize.Specialize */;\n        return (value, stack) => (spec.external(value, stack) << 1) | mask;\n    }\n    return spec.get;\n}\n\nexport { ContextTracker, ExternalTokenizer, InputStream, LRParser, LocalTokenGroup, Stack };\n","import { ExternalTokenizer, LRParser } from '@lezer/lr';\nimport { styleTags, tags } from '@lezer/highlight';\n\n// This file was generated by lezer-generator. You probably shouldn't edit it.\nconst RawString = 1,\n  templateArgsEndFallback = 2,\n  MacroName = 3;\n\nconst R = 82, L = 76, u = 117, U = 85,\n      a = 97, z = 122, A = 65, Z = 90, Underscore = 95,\n      Zero = 48,\n      Quote = 34,\n      ParenL = 40, ParenR = 41,\n      Space = 32, GreaterThan = 62;\n\nconst rawString = new ExternalTokenizer(input => {\n  // Raw string literals can start with: R, LR, uR, UR, u8R\n  if (input.next == L || input.next == U) {\n    input.advance();\n  } else if (input.next == u) {\n    input.advance();\n    if (input.next == Zero + 8) input.advance();\n  }\n  if (input.next != R) return\n  input.advance();\n  if (input.next != Quote) return\n  input.advance();\n\n  let marker = \"\";\n  while (input.next != ParenL) {\n    if (input.next == Space || input.next <= 13 || input.next == ParenR) return\n    marker += String.fromCharCode(input.next);\n    input.advance();\n  }\n  input.advance();\n\n  for (;;) {\n    if (input.next < 0)\n      return input.acceptToken(RawString)\n    if (input.next == ParenR) {\n      let match = true;\n      for (let i = 0; match && i < marker.length; i++)\n        if (input.peek(i + 1) != marker.charCodeAt(i)) match = false;\n      if (match && input.peek(marker.length + 1) == Quote)\n        return input.acceptToken(RawString, 2 + marker.length)\n    }\n    input.advance();\n  }\n});\n\nconst fallback = new ExternalTokenizer(input => {\n  if (input.next == GreaterThan) {\n    // Provide a template-args-closing token when the next characters\n    // are \">>\", in which case the regular tokenizer will only see a\n    // bit shift op.\n    if (input.peek(1) == GreaterThan)\n      input.acceptToken(templateArgsEndFallback, 1);\n  } else {\n    // Notice all-uppercase identifiers\n    let sawLetter = false, i = 0;\n    for (;; i++) {\n      if (input.next >= A && input.next <= Z) sawLetter = true;\n      else if (input.next >= a && input.next <= z) return\n      else if (input.next != Underscore && !(input.next >= Zero && input.next <= Zero + 9)) break\n      input.advance();\n    }\n    if (sawLetter && i > 1) input.acceptToken(MacroName);\n  }\n}, {extend: true});\n\nconst cppHighlighting = styleTags({\n  \"typedef struct union enum class typename decltype auto template operator friend noexcept namespace using requires concept import export module __attribute__ __declspec __based\": tags.definitionKeyword,\n  \"extern MsCallModifier MsPointerModifier extern static register thread_local inline const volatile restrict _Atomic mutable constexpr constinit consteval virtual explicit VirtualSpecifier Access\": tags.modifier,\n  \"if else switch for while do case default return break continue goto throw try catch\": tags.controlKeyword,\n  \"co_return co_yield co_await\": tags.controlKeyword,\n  \"new sizeof delete static_assert\": tags.operatorKeyword,\n  \"NULL nullptr\": tags.null,\n  this: tags.self,\n  \"True False\": tags.bool,\n  \"TypeSize PrimitiveType\": tags.standard(tags.typeName),\n  TypeIdentifier: tags.typeName,\n  FieldIdentifier: tags.propertyName,\n  \"CallExpression/FieldExpression/FieldIdentifier\": tags.function(tags.propertyName),\n  \"ModuleName/Identifier\": tags.namespace,\n  \"PartitionName\": tags.labelName,\n  StatementIdentifier: tags.labelName,\n  \"Identifier DestructorName\": tags.variableName,\n  \"CallExpression/Identifier\": tags.function(tags.variableName),\n  \"CallExpression/ScopedIdentifier/Identifier\": tags.function(tags.variableName),\n  \"FunctionDeclarator/Identifier FunctionDeclarator/DestructorName\": tags.function(tags.definition(tags.variableName)),\n  NamespaceIdentifier: tags.namespace,\n  OperatorName: tags.operator,\n  ArithOp: tags.arithmeticOperator,\n  LogicOp: tags.logicOperator,\n  BitOp: tags.bitwiseOperator,\n  CompareOp: tags.compareOperator,\n  AssignOp: tags.definitionOperator,\n  UpdateOp: tags.updateOperator,\n  LineComment: tags.lineComment,\n  BlockComment: tags.blockComment,\n  Number: tags.number,\n  String: tags.string,\n  \"RawString SystemLibString\": tags.special(tags.string),\n  CharLiteral: tags.character,\n  EscapeSequence: tags.escape,\n  \"UserDefinedLiteral/Identifier\": tags.literal,\n  PreProcArg: tags.meta,\n  \"PreprocDirectiveName #include #ifdef #ifndef #if #define #else #endif #elif\": tags.processingInstruction,\n  MacroName: tags.special(tags.name),\n  \"( )\": tags.paren,\n  \"[ ]\": tags.squareBracket,\n  \"{ }\": tags.brace,\n  \"< >\": tags.angleBracket,\n  \". ->\": tags.derefOperator,\n  \", ;\": tags.separator\n});\n\n// This file was generated by lezer-generator. You probably shouldn't edit it.\nconst spec_identifier = {__proto__:null,bool:34, char:34, int:34, float:34, double:34, void:34, size_t:34, ssize_t:34, intptr_t:34, uintptr_t:34, charptr_t:34, int8_t:34, int16_t:34, int32_t:34, int64_t:34, uint8_t:34, uint16_t:34, uint32_t:34, uint64_t:34, char8_t:34, char16_t:34, char32_t:34, char64_t:34, const:68, volatile:70, restrict:72, _Atomic:74, mutable:76, constexpr:78, constinit:80, consteval:82, struct:86, __declspec:90, final:148, override:148, public:152, private:152, protected:152, virtual:154, extern:160, static:162, register:164, inline:166, thread_local:168, __attribute__:172, __based:178, __restrict:180, __uptr:180, __sptr:180, _unaligned:180, __unaligned:180, noexcept:194, requires:198, TRUE:786, true:786, FALSE:788, false:788, typename:218, class:220, template:234, throw:248, __cdecl:256, __clrcall:256, __stdcall:256, __fastcall:256, __thiscall:256, __vectorcall:256, try:260, catch:264, export:284, import:288, case:298, default:300, if:310, else:316, switch:320, do:324, while:326, for:332, return:336, break:340, continue:344, goto:348, co_return:352, co_yield:356, using:364, typedef:368, namespace:382, new:400, delete:402, co_await:404, concept:408, enum:412, static_assert:416, friend:424, union:426, explicit:432, operator:446, module:458, signed:520, unsigned:520, long:520, short:520, decltype:530, auto:532, sizeof:568, NULL:574, nullptr:588, this:590};\nconst spec_ = {__proto__:null,\"<\":131};\nconst spec_templateArgsEnd = {__proto__:null,\">\":135};\nconst spec_scopedIdentifier = {__proto__:null,operator:390, new:578, delete:584};\nconst parser = LRParser.deserialize({\n  version: 14,\n  states: \"$;fQ!QQVOOP'gOUOOO(XOWO'#CdO,RQUO'#CgO,]QUO'#FkO-sQbO'#CwO.UQUO'#CwO0TQUO'#K[O0[QUO'#CvO0gOpO'#DvO0oQ!dO'#D]OOQR'#JP'#JPO5XQVO'#GVO5fQUO'#JWOOQQ'#JW'#JWO8zQUO'#KnO<eQUO'#KnO>{QVO'#E^O?]QUO'#E^OOQQ'#Ed'#EdOOQQ'#Ee'#EeO?bQVO'#EfO@XQVO'#EiOBUQUO'#FPOBvQUO'#FiOOQR'#Fk'#FkOB{QUO'#FkOOQR'#LR'#LROOQR'#LQ'#LQOETQVO'#KROFxQUO'#LWOGVQUO'#KrOGkQUO'#LWOH]QUO'#LYOOQR'#HV'#HVOOQR'#HW'#HWOOQR'#HX'#HXOOQR'#K}'#K}OOQR'#J`'#J`Q!QQVOOOHkQVO'#F^OIWQUO'#EhOI_QUOOOKZQVO'#HhOKkQUO'#HhONVQUO'#KrONaQUO'#KrOOQQ'#Kr'#KrO!!_QUO'#KrOOQQ'#Jr'#JrO!!lQUO'#HyOOQQ'#K['#K[O!&^QUO'#K[O!&zQUO'#KRO!(zQVO'#I^O!(zQVO'#IaOCQQUO'#KROOQQ'#Iq'#IqOOQQ'#KR'#KRO!,}QUO'#K[OOQR'#KZ'#KZO!-UQUO'#DYO!/mQUO'#KoOOQQ'#Ko'#KoO!/tQUO'#KoO!/{QUO'#ETO!0QQUO'#EWO!0VQUO'#FRO8zQUO'#FPO!QQVO'#F_O!0[Q#vO'#FaO!0gQUO'#FlO!0oQUO'#FqO!0tQVO'#FsO!0oQUO'#FvO!3sQUO'#FwO!3xQVO'#FyO!4SQUO'#F{O!4XQUO'#F}O!4^QUO'#GPO!4cQVO'#GRO!(zQVO'#GTO!4jQUO'#GqO!4xQUO'#GZO!(zQVO'#FfO!6VQUO'#FfO!6[QVO'#GaO!6cQUO'#GbO!6nQUO'#GoO!6sQUO'#GsO!6xQUO'#G{O!7jQ&lO'#HjO!:mQUO'#GvO!:}QUO'#HYO!;YQUO'#H[O!;bQUO'#DWO!;bQUO'#HvO!;bQUO'#HwO!;yQUO'#HxO!<[QUO'#H}O!=PQUO'#IOO!>uQVO'#IcO!(zQVO'#IeO!?PQUO'#IhO!?WQVO'#IkP!@}{,UO'#CbP!6n{,UO'#CbP!AY{7[O'#CbP!6n{,UO'#CbP!A_{,UO'#CbP!AjOSO'#I{POOO)CEo)CEoOOOO'#I}'#I}O!AtOWO,59OOOQR,59O,59OO!(zQVO,59UOOQQ,59W,59WO!(zQVO,5;ROOQR,5<V,5<VO!BPQUO,59YO!(zQVO,5>rOOQR'#IY'#IYOOQR'#IZ'#IZOOQR'#I['#I[OOQR'#I]'#I]O!(zQVO,5>sO!(zQVO,5>sO!(zQVO,5>sO!(zQVO,5>sO!(zQVO,5>sO!(zQVO,5>sO!(zQVO,5>sO!(zQVO,5>sO!(zQVO,5>sO!(zQVO,5>sO!DOQVO,5>{OOQQ,5?X,5?XO!EqQVO'#ChO!IjQUO'#CyOOQQ,59c,59cOOQQ,59b,59bOOQQ,5=O,5=OO!IwQ&lO,5=nO!?PQUO,5?SO!LkQVO,5?VO!LrQbO,59cO!L}QVO'#FYOOQQ,5?Q,5?QO!M_QVO,59VO!MfO`O,5:bO!MkQbO'#D^O!M|QbO'#K_O!N[QbO,59wO!NdQbO'#CwO!NuQUO'#CwO!NzQUO'#K[O# UQUO'#CvOOQR-E<}-E<}O# aQUO,5ApO# hQVO'#EfO@XQVO'#EiOBUQUO,5;kOOQR,5<q,5<qO#$aQUO'#KRO#$hQUO'#KRO!(zQVO'#IVO8zQUO,5;kO#${Q&lO'#HjO#(SQUO'#CsO#*wQbO'#CwO#*|QUO'#CvO#.jQUO'#K[OOQQ-E=U-E=UO#0}QUO,5AYO#1XQUO'#K[O#1cQUO,5AYOOQR,5Ap,5ApOOQQ,5>m,5>mO#3gQUO'#CgO#4]QUO,5>qO#6OQUO'#IfOOQR'#JO'#JOO#6WQUO,5:xO#6tQUO,5:xO#7eQUO,5:xO#8YQUO'#CtO!0QQUO'#ClOOQQ'#JX'#JXO#6tQUO,5:xO#8bQUO,5;QO!4xQUO'#C}O#9kQUO,5;QO#9pQUO,5>RO#:|QUO'#C}O#;dQUO,5>|O#;iQUO'#KxO#<rQUO,5;TO#<zQVO,5;TO#=UQUO,5;TOOQQ,5;T,5;TO#>}QUO'#L]O#?UQUO,5>VO#?ZQbO'#CwO#?fQUO'#GdO#?kQUO'#E^O#@[QUO,5;kO#@sQUO'#LOO#@{QUO,5;rOKkQUO'#HgOBUQUO'#HhO#AQQUO'#KrO!6nQUO'#HkO#AxQUO'#CtO!0tQVO,5<TOOQQ'#Cg'#CgOOQR'#Ji'#JiO#A}QVO,5=aOOQQ,5?[,5?[O#DWQbO'#CwO#DcQUO'#GdOOQQ'#Jj'#JjOOQQ-E=h-E=hOGVQUO,5ArOGkQUO,5ArO#DhQUO,5AtO#DsQUO'#G}OOQR,5Ar,5ArO#DhQUO,5ArO#EOQUO'#HPO#EWQUO,5AtOOQR,5At,5AtOOQR,5Au,5AuO#EfQVO,5AuOOQR-E=^-E=^O#G`QVO,5;xOOQR,5;j,5;jO#IaQUO'#EjO#JfQUO'#EwO#K]QVO'#ExO#MoQUO'#EvO#MwQUO'#EyO#NvQUO'#EzOOQQ'#K{'#K{O$ mQUO,5;SO$!sQUO'#EvOOQQ,5;S,5;SO$#pQUO,5;SO$%cQUO,5:yO$'|QVO,5>QO$(WQUO'#E[O$(eQUO,5>SOOQQ,5>T,5>TO$,RQVO'#C{OOQQ-E=p-E=pOOQQ,5>e,5>eOOQQ,59`,59`O$,]QUO,5>xO$.]QUO,5>{O!6nQUO,59tO$.pQUO,5;qO$.}QUO,5<|O!0QQUO,5:oOOQQ,5:r,5:rO$/YQUO,5;mO$/_QUO'#KnOBUQUO,5;kOOQR,5;y,5;yO$0OQUO'#FcO$0^QUO'#FcO$0cQUO,5;{O$3|QVO'#FnO!0tQVO,5<WO!0oQUO,5<WO!0VQUO,5<]O$4TQVO'#GVO$7PQUO,5<_O!0tQVO,5<bO$:gQVO,5<cO$:tQUO,5<eOOQR,5<e,5<eO$;}QUO,5<eOOQR,5<g,5<gOOQR,5<i,5<iOOQQ'#Fj'#FjO$<SQUO,5<kO$<XQUO,5<mOOQR,5<m,5<mO$=_QUO,5<oO$>eQUO,5<sO$>pQUO,5=]O$>uQUO,5=]O!4xQUO,5<uO$>}QUO,5<uO$?cQUO,5<QO$@iQVO,5<QO$BzQUO,5<{OOQR,5<{,5<{O$DQQVO'#F^OOQR,5<|,5<|O$>uQUO,5<|O$DXQUO,5<|O$DdQUO,5=ZO!(zQVO,5=_O!(zQVO,5=gO#NeQUO,5=nOOQQ,5>U,5>UO$FiQUO,5>UO$FsQUO,5>UO$FxQUO,5>UO$F}QUO,5>UO!6nQUO,5>UO$H{QUO'#K[O$ISQUO,5=pO$I_QUO,5=bOKkQUO,5=pO$JXQUO,5=tOOQR,5=t,5=tO$JaQUO,5=tO$LlQVO'#H]OOQQ,5=v,5=vO!;]QUO,5=vO%#gQUO'#KkO%#nQUO'#K]O%$SQUO'#KkO%$^QUO'#DyO%$oQUO'#D|O%'lQUO'#K]OOQQ'#K]'#K]O%)_QUO'#K]O%#nQUO'#K]O%)dQUO'#K]OOQQ,59r,59rOOQQ,5>b,5>bOOQQ,5>c,5>cO%)lQUO'#H{O%)tQUO,5>dOOQQ,5>d,5>dO%-`QUO,5>dO%-kQUO,5>iO%1VQVO,5>jO%1^QUO,5>}O# hQVO'#EfO%4dQUO,5>}OOQQ,5>},5>}O%5TQUO,5?PO%7XQUO,5?SO!<[QUO,5?SO%9TQUO,5?VO%<pQVO,5?VP!A_{,UO,58|P%<w{,UO,58|P%=V{7[O,58|P%=]{,UO,58|PO{O'#Jv'#JvP%=b{,UO'#LdPOOO'#Ld'#LdP%=h{,UO'#LdPOOO,58|,58|POOO,5?g,5?gP%=mOSO,5?gOOOO-E<{-E<{OOQR1G.j1G.jO%=tQUO1G.pO%>zQUO1G0mOOQQ1G0m1G0mO%@WQUO'#CoO%BgQbO'#CwO%BrQUO'#CrO%BwQUO'#CrO%B|QUO1G.tO#AxQUO'#CqOOQQ1G.t1G.tO%EPQUO1G4^O%FVQUO1G4_O%GxQUO1G4_O%IkQUO1G4_O%K^QUO1G4_O%MPQUO1G4_O%NrQUO1G4_O&!eQUO1G4_O&$WQUO1G4_O&%yQUO1G4_O&'lQUO1G4_O&)_QUO1G4_O&+QQUO'#KQO&,ZQUO'#KQO&,cQUO,59SOOQQ,5=Q,5=QO&.kQUO,5=QO&.uQUO,5=QO&.zQUO,5=QO&/PQUO,5=QO!6nQUO,5=QO#NeQUO1G3YO&/ZQUO1G4nO!<[QUO1G4nO&1VQUO1G4qO&2xQVO1G4qOOQQ1G.}1G.}OOQQ1G.|1G.|OOQQ1G2j1G2jO!IwQ&lO1G3YO&3PQUO'#LPO@XQVO'#EiO&4YQUO'#F]OOQQ'#Jb'#JbO&4_QUO'#FZO&4jQUO'#LPO&4rQUO,5;tO&4wQUO1G.qOOQQ1G.q1G.qOOQR1G/|1G/|O&6jQ!dO'#JQO&6oQbO,59xO&9QQ!eO'#D`O&9XQ!dO'#JSO&9^QbO,5@yO&9^QbO,5@yOOQR1G/c1G/cO&9iQbO1G/cO&9nQ&lO'#GfO&:lQbO,59cOOQR1G7[1G7[O#@[QUO1G1VO&:wQUO1G1^OBUQUO1G1VO&=YQUO'#CyO#*wQbO,59cO&@{QUO1G6tOOQR-E<|-E<|O&B_QUO1G0dO#6WQUO1G0dOOQQ-E=V-E=VO#6tQUO1G0dOOQQ1G0l1G0lO&CSQUO,59iOOQQ1G3m1G3mO&CjQUO,59iO&DQQUO,59iO!M_QVO1G4hO!(zQVO'#JZO&DlQUO,5AdOOQQ1G0o1G0oO!(zQVO1G0oO!6nQUO'#JoO&DtQUO,5AwOOQQ1G3q1G3qOOQR1G1V1G1VO&J]QVO'#FOO!M_QVO,5;sOOQQ,5;s,5;sOBUQUO'#JdO&JmQUO,5AjO&JuQVO'#E[OOQR1G1^1G1^O&MdQUO'#L]OOQR1G1o1G1oOOQR-E=g-E=gOOQR1G7^1G7^O#DhQUO1G7^OGVQUO1G7^O#DhQUO1G7`OOQR1G7`1G7`O&MlQUO'#HOO&MtQUO'#LXOOQQ,5=i,5=iO&NSQUO,5=kO&NXQUO,5=lOOQR1G7a1G7aO#EfQVO1G7aO&N^QUO1G7aO' dQVO,5=lOOQR1G1U1G1UO$.vQUO'#E]O'!YQUO'#E]OOQQ'#Kz'#KzO'!sQUO'#KyO'#OQUO,5;UO'#WQUO'#ElO'#kQUO'#ElO'$OQUO'#EtOOQQ'#J]'#J]O'$TQUO,5;cO'$zQUO,5;cO'%uQUO,5;dO'&{QVO,5;dOOQQ,5;d,5;dO''VQVO,5;dO'&{QVO,5;dO''^QUO,5;bO'(ZQUO,5;eO'(fQUO'#KqO'(nQUO,5:vO'(sQUO,5;fOOQQ1G0n1G0nOOQQ'#J^'#J^O''^QUO,5;bO!4xQUO'#E}OOQQ,5;b,5;bO')nQUO'#E`O'+hQUO'#E{OHrQUO1G0nO'+mQUO'#EbOOQQ'#JY'#JYO'-VQUO'#KsOOQQ'#Ks'#KsO'.PQUO1G0eO'.wQUO1G3lO'/}QVO1G3lOOQQ1G3l1G3lO'0XQVO1G3lO'0`QUO'#L`O'1lQUO'#KYO'1zQUO'#KXO'2VQUO,59gO'2_QUO1G/`O'2dQUO'#FPOOQR1G1]1G1]OOQR1G2h1G2hO$>uQUO1G2hO'2nQUO1G2hO'2yQUO1G0ZOOQR'#Ja'#JaO'3OQVO1G1XO'8wQUO'#FTO'8|QUO1G1VO!6nQUO'#JeO'9[QUO,5;}O$0^QUO,5;}OOQQ'#Fd'#FdOOQQ,5;},5;}O'9jQUO1G1gOOQR1G1g1G1gO'9rQUO,5<YO$.vQUO'#FWOBUQUO'#FWO'9yQUO,5<YO!(zQVO,5<YO':RQUO,5<YO':WQVO1G1rO!0tQVO1G1rOOQR1G1w1G1wO'?vQUO1G1yOOQR1G1|1G1|O'?{QUO1G1}OBUQUO1G2^O'AUQVO1G1}O'CjQUO1G1}O'CoQUO'#GXO8zQUO1G2^OOQR1G2P1G2POOQR1G2V1G2VOOQR1G2X1G2XOOQR1G2Z1G2ZO'CtQUO1G2_O!4xQUO1G2_OOQR1G2w1G2wO'C|QUO1G2wO$>}QUO1G2aOOQQ'#Cu'#CuO'DRQUO'#G]O'D|QUO'#G]O'ERQUO'#LSO'EaQUO'#G`OOQQ'#LT'#LTO'EoQUO1G2aO'EtQVO1G1lO'HVQVO'#GVOBUQUO'#FWOOQR'#Jf'#JfO'EtQVO1G1lO'HaQUO'#FwOOQR1G2g1G2gOOQR,5;x,5;xO'HfQVO,5;xO'HmQUO1G2hO'HrQUO'#JhO'2nQUO1G2hO!(zQVO1G2uO'HzQUO1G2yO'JTQUO1G3RO'KZQUO1G3YOOQQ1G3p1G3pO'KoQUO1G3pOOQR1G3[1G3[O'KtQUO'#K[O'2dQUO'#LUOGkQUO'#LWOOQR'#Gz'#GzO#DhQUO'#LYOOQR'#HR'#HRO'LOQUO'#GwO'$OQUO'#GvOOQR1G2|1G2|O'L{QUO1G2|O'MrQUO1G3[O'M}QUO1G3`O'NSQUO1G3`OOQR1G3`1G3`O'N[QUO'#H^OOQR'#H^'#H^O( eQUO'#H^O!(zQVO'#HaO!(zQVO'#H`OOQR'#L['#L[O( jQUO'#L[OOQR'#Jl'#JlO( oQVO,5=wOOQQ,5=w,5=wO( vQUO'#H_O(!OQUO'#H[OOQQ1G3b1G3bO(!YQUO,5@wOOQQ,5@w,5@wO%)_QUO,5@wO%)dQUO,5@wO%$^QUO,5:eO(%wQUO'#KlO(&VQUO'#KlOOQQ,5:e,5:eOOQQ'#JT'#JTO(&bQUO'#D}O(&lQUO'#KrOGkQUO'#LWO('hQUO'#D}OOQQ'#Hq'#HqOOQQ'#Hs'#HsOOQQ'#Ht'#HtOOQQ'#Km'#KmOOQQ'#JV'#JVO('rQUO,5:hOOQQ,5:h,5:hO((oQUO'#LWO((|QUO'#HuO()dQUO,5@wO()kQUO'#H|O()vQUO'#L_O(*OQUO,5>gO(*TQUO'#L^OOQQ1G4O1G4OO(-zQUO1G4OO(.RQUO1G4OO(.YQUO1G4UO(/`QUO1G4UO(/eQUO,5A}O!6nQUO1G4iO!(zQVO'#IjOOQQ1G4n1G4nO(/jQUO1G4nO(1mQVO1G4qPOOO1G.h1G.hP!A_{,UO1G.hP(3mQUO'#LfP(3x{,UO1G.hP(3}{7[O1G.hPO{O-E=t-E=tPOOO,5BO,5BOP(4V{,UO,5BOPOOO1G5R1G5RO!(zQVO7+$[O(4[QUO'#CyOOQQ,59^,59^O(4gQbO,59cO(4rQbO,59^OOQQ,59],59]OOQQ7+)x7+)xO!M_QVO'#JuO(4}QUO,5@lOOQQ1G.n1G.nOOQQ1G2l1G2lO(5VQUO1G2lO(5[QUO7+(tOOQQ7+*Y7+*YO(7pQUO7+*YO(7wQUO7+*YO(1mQVO7+*]O#NeQUO7+(tO(8UQVO'#JcO(8iQUO,5AkO(8qQUO,5;vOOQQ'#Co'#CoOOQQ,5;w,5;wO!(zQVO'#F[OOQQ-E=`-E=`O!M_QVO,5;uOOQQ1G1`1G1`OOQQ,5?l,5?lOOQQ-E=O-E=OOOQR'#Dg'#DgOOQR'#Di'#DiOOQR'#Dl'#DlO(9zQ!eO'#K`O(:RQMkO'#K`O(:YQ!eO'#K`OOQR'#K`'#K`OOQR'#JR'#JRO(:aQ!eO,59zOOQQ,59z,59zO(:hQbO,5?nOOQQ-E=Q-E=QO(:vQbO1G6eOOQR7+$}7+$}OOQR7+&q7+&qOOQR7+&x7+&xO'8|QUO7+&qO(;RQUO7+&OO#6WQUO7+&OO(;vQUO1G/TO(<^QUO1G/TO(<xQUO7+*SOOQQ7+*W7+*WO(>kQUO,5?uOOQQ-E=X-E=XO(?tQUO7+&ZOOQQ,5@Z,5@ZOOQQ-E=m-E=mO(?yQUO'#LPO@XQVO'#EiO(AVQUO1G1_OOQQ1G1_1G1_O(B`QUO,5@OOOQQ,5@O,5@OOOQQ-E=b-E=bO(BtQUO'#KqOOQR7+,x7+,xO#DhQUO7+,xOOQR7+,z7+,zO(CRQUO,5=jO#DsQUO'#JkO(CdQUO,5AsOOQR1G3V1G3VOOQR1G3W1G3WO(CrQUO7+,{OOQR7+,{7+,{O(EjQUO,5:wO(GXQUO'#EwO!(zQVO,5;VO(GzQUO,5:wO(HUQUO'#EpO(HgQUO'#EzOOQQ,5;Z,5;ZO#K]QVO'#ExO(H}QUO,5:wO(IUQUO'#EyO#GgQUO'#J[O(JnQUO,5AeOOQQ1G0p1G0pO(JyQUO,5;WO!<[QUO,5;^O(KdQUO,5;_O(KrQUO,5;WO(NUQUO,5;`OOQQ-E=Z-E=ZO(N^QUO1G0}OOQQ1G1O1G1OO) XQUO1G1OO)!_QVO1G1OO)!fQVO1G1OO)!pQUO1G0|OOQQ1G0|1G0|OOQQ1G1P1G1PO)#mQUO'#JpO)#wQUO,5A]OOQQ1G0b1G0bOOQQ-E=[-E=[O)$PQUO,5;iO!<[QUO,5;iO)$|QVO,5:zO)%TQUO,5;gO$ mQUO7+&YOOQQ7+&Y7+&YO!(zQVO'#EfO)%[QUO,5:|OOQQ'#Kt'#KtOOQQ-E=W-E=WOOQQ,5A_,5A_OOQQ'#Jm'#JmO))PQUO7+&PPOQQ7+&P7+&POOQQ7+)W7+)WO))wQUO7+)WO)*}QVO7+)WOOQQ,5>n,5>nO$)YQVO'#JtO)+UQUO,5@sOOQQ1G/R1G/ROOQQ7+$z7+$zO)+aQUO7+(SO)+fQUO7+(SOOQR7+(S7+(SO$>uQUO7+(SOOQQ7+%u7+%uOOQR-E=_-E=_O!0VQUO,5;oOOQQ,5@P,5@POOQQ-E=c-E=cO$0^QUO1G1iOOQQ1G1i1G1iOOQR7+'R7+'ROOQR1G1t1G1tOBUQUO,5;rO),SQUO,5<ZO),ZQUO1G1tO)-dQUO1G1tO!0tQVO7+'^O)-iQVO7+'^O)3XQUO7+'eO)3^QVO7+'iO)5rQUO7+'xO)5|QUO7+'iO)7SQVO7+'iOKkQUO7+'xO$>hQUO,5<sO!4xQUO7+'yO)7ZQUO7+'yOOQR7+(c7+(cO)7`QUO7+'{O)7eQUO,5<wO'DRQUO,5<wO)8]QUO,5<wO'DRQUO,5<wOOQQ,5<x,5<xO)8nQVO,5<yO'EaQUO'#JgO)8xQUO,5AnO)9QQUO,5<zOOQR7+'{7+'{O)9]QVO7+'WO)5uQUO'#LOOOQR-E=d-E=dO);nQVO,5<cOOQR1G1d1G1dOOQQ,5@S,5@SO!6nQUO,5@SOOQQ-E=f-E=fO)>VQUO7+(aO)?]QUO7+(eO)?bQVO7+(eOOQQ7+(m7+(mOOQQ7+)[7+)[O)?jQUO'#KkO)?tQUO'#KkOOQR,5=c,5=cO)@RQUO,5=cO!;bQUO,5=cO!;bQUO,5=cO!;bQUO,5=cOOQR7+(h7+(hOOQR7+(v7+(vOOQR7+(z7+(zOOQR,5=x,5=xO)@WQUO,5={O)A^QUO,5=zOOQR,5Av,5AvOOQR-E=j-E=jOOQQ1G3c1G3cO)BdQUO,5=yO)BiQVO'#EfOOQQ1G6c1G6cO%)_QUO1G6cO%)dQUO1G6cOOQQ1G0P1G0POOQQ-E=R-E=RO)EQQUO,5AWO(%wQUO'#JUO)E]QUO,5AWO)E]QUO,5AWO)EeQUO,5:iO8zQUO,5:iOOQQ,5>^,5>^O)EoQUO,5ArO)EvQUO'#EVO)GQQUO'#EVO)GkQUO,5:iO)GuQUO'#HmO)GuQUO'#HnOOQQ'#Kp'#KpO)HdQUO'#KpO!(zQVO'#HoOOQQ,5:i,5:iO)IUQUO,5:iO!M_QVO,5:iOOQQ-E=T-E=TOOQQ1G0S1G0SOOQQ,5>a,5>aO)IZQUO1G6cO!(zQVO,5>hO)LxQUO'#JsO)MTQUO,5AyOOQQ1G4R1G4RO)M]QUO,5AxOOQQ,5Ax,5AxOOQQ7+)j7+)jO*!zQUO7+)jOOQQ7+)p7+)pO*'yQVO1G7iO*){QUO7+*TO**QQUO,5?UO*+WQUO7+*]POOO7+$S7+$SP*,yQUO'#LgP*-RQUO,5BQP*-W{,UO7+$SPOOO1G7j1G7jO*-]QUO<<GvOOQQ1G.x1G.xOOQQ'#IU'#IUO*/OQUO,5@aOOQQ,5@a,5@aOOQQ-E=s-E=sOOQQ7+(W7+(WOOQQ<<Mt<<MtO*0XQUO<<MtO*2[QUO<<MwO*3}QUO<<L`O*4cQUO,5?}OOQQ,5?},5?}OOQQ-E=a-E=aOOQQ1G1b1G1bO*5lQUO,5;vO*6rQUO1G1aOOQQ1G1a1G1aOOQR,5@z,5@zO*7{Q!eO,5@zO*8SQMkO,5@zO*8ZQ!eO,5@zOOQR-E=P-E=POOQQ1G/f1G/fO*8bQ!eO'#DwOOQQ1G5Y1G5YOOQR<<J]<<J]O*8iQUO<<IjO*9^QUO7+$oOOQQ<<Iu<<IuO(8UQVO,5;ROOQR<=!d<=!dOOQQ1G3U1G3UOOQQ,5@V,5@VOOQQ-E=i-E=iOOQR<=!g<=!gO*:ZQUO1G0cO*:bQUO'#EzO*:rQUO1G0cO*:yQUO'#JOO*<aQUO1G0qO!(zQVO1G0qOOQQ,5;[,5;[OOQQ,5;],5;]OOQQ,5?v,5?vOOQQ-E=Y-E=YO!<[QUO1G0xO*=pQUO1G0xOOQQ1G0y1G0yO*>RQUO'#ElOOQQ1G0z1G0zOOQQ7+&j7+&jO*>gQUO7+&jO*?mQVO7+&jOOQQ7+&h7+&hOOQQ,5@[,5@[OOQQ-E=n-E=nO*@iQUO1G1TO*@sQUO1G1TO*A^QUO1G0fOOQQ1G0f1G0fO*BdQUO'#K|O*BlQUO1G1ROOQQ<<It<<ItOOQQ'#Hc'#HcO'+mQUO,5=|OOQQ'#He'#HeO'+mQUO,5>OOOQQ-E=k-E=kPOQQ<<Ik<<IkPOQQ-E=l-E=lOOQQ<<Lr<<LrO*BqQUO'#LbO*C}QUO'#LaOOQQ,5@`,5@`OOQQ-E=r-E=rOOQR<<Kn<<KnO$>uQUO<<KnO*D]QUO<<KnOOQR1G1Z1G1ZOOQQ7+'T7+'TO!M_QVO1G1uO*DbQUO1G1uOOQR7+'`7+'`OOQR<<Jx<<JxO!0tQVO<<JxOOQR<<KP<<KPO*DmQUO<<KTO*EsQVO<<KTOKkQUO<<KdO!M_QVO<<KdO*EzQUO<<KTO!0tQVO<<KTO*GTQUO<<KTO*GYQUO<<KdO*GeQUO<<KeOOQR<<Ke<<KeOOQR<<Kg<<KgO*GjQUO1G2cO)7eQUO1G2cO'DRQUO1G2cO*G{QUO1G2eO*IRQVO1G2eOOQQ1G2e1G2eO*I]QVO1G2eO*IdQUO,5@ROOQQ-E=e-E=eOOQQ1G2f1G2fO*IrQUO1G1}O*J{QVO1G1}O*KSQUO1G1}OOQQ1G5n1G5nOOQR<<K{<<K{OOQR<<LP<<LPO*KXQVO<<LPO*KdQUO<<LPOOQR1G2}1G2}O*KiQUO1G2}O*KpQUO1G3fOOQR1G3e1G3eOOQQ7++}7++}O%)_QUO7++}O*K{QUO1G6rO*K{QUO1G6rO(%wQUO,5?pO*LTQUO,5?pOOQQ-E=S-E=SO*L`QUO1G0TOOQQ1G0T1G0TO*LjQUO1G0TO!M_QVO1G0TO*LoQUO1G0TOOQQ1G3x1G3xO*LyQUO,5:qO)EvQUO,5:qO*MgQUO,5:qO)EvQUO,5:qO$#uQUO,5:uO*NUQVO,5>WO)GuQUO'#JqO*N`QUO1G0TO*NqQVO1G0TOOQQ1G3v1G3vO*NxQUO,5>XO+ TQUO,5>YO+ rQUO,5>ZO+!xQUO1G0TO%)dQUO7++}O+$OQUO1G4SOOQQ,5@_,5@_OOQQ-E=q-E=qOOQQ<<MU<<MUOOQQ<<Mo<<MoO+%XQUO1G4pP+'[QUO'#JwP+'dQUO,5BRPO{O1G7l1G7lPOOO<<Gn<<GnOOQQANC`ANC`OOQR1G6f1G6fO+'lQ!eO,5:cOOQQ,5:c,5:cO+'sQUO1G0mO+)PQUO7+&]O+*`QUO7+&dO+*qQUO,5;WOOQQ<<JU<<JUO++PQUO7+&oOOQQ7+&Q7+&QO!4xQUO'#J_O++zQUO,5AhOOQQ7+&m7+&mOOQQ1G3h1G3hO+,SQUO1G3jOOQQ,5>o,5>oO+/wQUOANAYOOQRANAYANAYO+/|QUO7+'aOOQRAN@dAN@dO+1YQVOAN@oO+1aQUOAN@oO!0tQVOAN@oO+2jQUOAN@oO+2oQUOANAOO+2zQUOANAOO+4QQUOANAOOOQRAN@oAN@oO!M_QVOANAOOOQRANAPANAPO+4VQUO7+'}O)7eQUO7+'}OOQQ7+(P7+(PO+4hQUO7+(PO+5nQVO7+(PO+5uQVO7+'iO+5|QUOANAkOOQR7+(i7+(iOOQR7+)Q7+)QO+6RQUO7+)QO+6WQUO7+)QOOQQ<= i<= iO+6`QUO7+,^O+6hQUO1G5[OOQQ1G5[1G5[O+6sQUO7+%oOOQQ7+%o7+%oO+7UQUO7+%oO*NqQVO7+%oOOQQ7+)b7+)bO+7ZQUO7+%oO+8aQUO7+%oO!M_QVO7+%oO+8kQUO1G0]O*LyQUO1G0]O)EvQUO1G0]OOQQ1G0a1G0aO+9YQUO1G3rO+:`QVO1G3rOOQQ1G3r1G3rO+:jQVO1G3rO+:qQUO,5@]OOQQ-E=o-E=oOOQQ1G3s1G3sO%)_QUO<= iOOQQ7+*[7+*[POQQ,5@c,5@cPOQQ-E=u-E=uOOQQ1G/}1G/}OOQQ,5?y,5?yOOQQ-E=]-E=]OOQRG26tG26tO+;YQUOG26ZO!0tQVOG26ZO+<cQUOG26ZOOQRG26ZG26ZO!M_QVOG26jO!0tQVOG26jO+<hQUOG26jO+=nQUOG26jO+=sQUO<<KiOOQQ<<Kk<<KkOOQRG27VG27VOOQR<<Ll<<LlO+>UQUO<<LlOOQQ7+*v7+*vOOQQ<<IZ<<IZO+>ZQUO<<IZO!M_QVO<<IZO+>`QUO<<IZO+?fQUO<<IZO*NqQVO<<IZOOQQ<<L|<<L|O+?wQUO7+%wO*LyQUO7+%wOOQQ7+)^7+)^O+@fQUO7+)^O+AlQVO7+)^OOQQANETANETO!0tQVOLD+uOOQRLD+uLD+uO+AsQUOLD,UO+ByQUOLD,UOOQRLD,ULD,UO!0tQVOLD,UOOQRANBWANBWOOQQAN>uAN>uO+COQUOAN>uO+DUQUOAN>uO!M_QVOAN>uO+DZQUO<<IcOOQQ<<Lx<<LxOOQR!$( a!$( aO!0tQVO!$( pOOQR!$( p!$( pOOQQG24aG24aO+DxQUOG24aO+FOQUOG24aOOQR!)9E[!)9E[OOQQLD){LD){O+FTQUO'#CgO(dQUO'#CgO+JQQUO'#CyO+LqQUO'#CyO!E{QUO'#CyO+MjQUO'#CyO+M}QUO'#CyO,#pQUO'#CyO,$QQUO'#CyO,$_QUO'#CyO,$jQbO,59cO,$uQbO,59cO,%QQbO,59cO,%]QbO'#CwO,%nQbO'#CwO,&PQbO'#CwO,&bQUO'#CgO,(uQUO'#CgO,)SQUO'#CgO,+wQUO'#CgO,.zQUO'#CgO,/[QUO'#CgO,3TQUO'#CgO,3[QUO'#CgO,4[QUO'#CgO,6eQUO,5:xO#?kQUO,5:xO#?kQUO,5:xO#=ZQUO'#L]O,7RQbO'#CwO,7^QbO'#CwO,7iQbO'#CwO,7tQbO'#CwO#6tQUO'#E^O,8PQUO'#E^O,9^QUO'#HhO,:OQbO'#CwO,:ZQbO'#CwO,:fQUO'#CvO,:kQUO'#CvO,:pQUO'#CoO,;OQbO,59cO,;ZQbO,59cO,;fQbO,59cO,;qQbO,59cO,;|QbO,59cO,<XQbO,59cO,<dQbO,59cO,6eQUO1G0dO,<oQUO1G0dO#?kQUO1G0dO,8PQUO1G0dO,>|QUO'#K[O,?^QUO'#CyO,?lQbO,59cO,6eQUO7+&OO,<oQUO7+&OO,?wQUO'#EwO,@jQUO'#EzO,AZQUO'#E^O,A`QUO'#GdO,AeQUO'#CvO,AjQUO'#CwO,AoQUO'#CwO,AtQUO'#CvO,AyQUO'#GdO,BOQUO'#K[O,BlQUO'#K[O,BvQUO'#CvO,CRQUO'#CvO,C^QUO'#CvO,<oQUO,5:xO,8PQUO,5:xO,8PQUO,5:xO,CiQUO'#K[O,C|QbO'#CwO,DXQUO'#CrO,D^QUO'#E^\",\n  stateData: \",ES~O(oOSSOSTOSRPQVPQ'fPQ'hPQ'iPQ'jPQ'kPQ'lPQ'mPQ'nPQ~O*[OS~OPmO]eOa!]Od!POlTOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O{#RO}!_O!TxO!VfO!X!XO!Y!WO!i!YO!opO!r!`O!s!aO!t!aO!u!bO!v!aO!x!cO!{!dO#V#QO#a#VO#b#TO#i#OO#p!xO#t!fO#v!eO$S!gO$U!hO$Z!vO$[!wO$a!iO$f!jO$h!kO$i!lO$l!mO$n!nO$p!oO$r!pO$t!qO$v!rO$x!sO$|!tO%O!uO%V!yO%`#ZO%a#[O%b#YO%d!zO%f#UO%h!{O%m#SO%p!|O%w!}O%}#PO&n!RO&s#WO&t!TO'R!WO'S!WO'W#XO'Z![O'b![O'c![O(pQO(sRO)QYO)TaO)V|O)W{O)XiO)Y!ZO)ZXO)icO)jdO~OR#bOV#]O'f#^O'h#_O'i#`O'j#`O'k#aO'l#aO'm#_O'n#_O~OX#dO(q#dO(r#fO~O]ZX]iXdiXlgXpZXpiXriXsiXtiXuiXviXwiXxiXyiX}iX!TiX!VZX!ViX!XZX!YZX![ZX!^ZX!_ZX!aZX!bZX!cZX!eZX!fZX!gZX!hZX!riX!siX!tiX!uiX!viX!xiX!{iX%wiX&siX&tiX(siX(vZX(w$^X(xZX(yZX)TZX)TiX)UZX)VZX)ViX)WZX)WiX)XZX)YZX)kZX~O)XiX!UZX~P(dO]#}O!V#lO!X#{O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(v#gO(x#kO(y#kO)T#mO)U#oO)V#nO)W#pO)X#jO)Y#|O~Od$RO%Z$SO']$TO'`$UO(z$OO~Ol$VO~O!T$WO])OXd)OXr)OXs)OXt)OXu)OXv)OXw)OXx)OXy)OX})OX!V)OX!r)OX!s)OX!t)OX!u)OX!v)OX!x)OX!{)OX%w)OX&s)OX&t)OX(s)OX)T)OX)V)OX)W)OX)X)OX~Ol$VO~P.ZOl$VO!g$YO)k$YO~OX$ZO)[$ZO~O!R$[O)Y)RP)^)RP~OPmO]$eOa!]Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O{#RO}!_O!TxO!V$fO!X!XO!Y!WO!i!YO!r!aO!s!aO!t!aO!u!aO!v!aO!x!cO#V#QO#a#VO#b#TO#v!eO$Z!vO$[!wO$a!iO$f!jO$h!kO$i!lO$l!mO$n!nO$p!oO$r!pO$t!qO$v!rO$x!sO%`#ZO%a#[O%b#YO%f#UO%m#SO%w$mO&n!RO&s#WO&t!TO'R!WO'S!WO'W#XO'Z![O'b![O'c![O(pQO)QYO)T$kO)W$kO)XiO)Y!ZO)ZXO)icO)jdO~Ol$_O#t$lO(sRO~P0zO](^Xa'zXd(^Xl'zXl(^Xr'zXr(^Xs'zXs(^Xt'zXt(^Xu'zXu(^Xv'zXv(^Xw'zXw(^Xx'zXx(^Xy'zXy(^X{'zX}'zX!V(^X!o(^X!r'zX!r(^X!s'zX!s(^X!t'zX!t(^X!u'zX!u(^X!v'zX!v(^X!x'zX!x(^X!{(^X#a'zX#b'zX%f'zX%m'zX%p(^X%w(^X&n'zX&s'zX&t'zX(s'zX(s(^X)T(^X)V(^X)W(^X~Oa!TOl$oOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O{#RO}!_O!r!aO!s!aO!t!aO!u!aO!v!aO!x!cO#a#VO#b#TO%f#UO%m#SO&n!RO&s#WO&t!TO(s$nO~Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O}!_O!r!aO!s!aO!t!aO!u!aO!v!aO!x!cO&s#WO&t$wO])bXd)bXl)bX!V)bX!{)bX%w)bX(s)bX)T)bX)V)bX)W)bX~O)X$vO~P:nOPmO]eOd!POr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!VfO!X!XO!Y!WO!i!YO!{!dO#V#QO%`#ZO%a#[O%b#YO%w$mO'R!WO'S!WO'W#XO'Z![O'b![O'c![O(pQO)TaO)V|O)W{O)Y!ZO)ZXO)icO)jdO~Oa%QOl;OO!|%RO(s$xO~P<lO)T%SO~Oa!]Ol$_O{#RO#a#VO#b#TO%f#UO%m#SO&n!RO&s#WO&t!TO(s;RO~P<lOPmO]$eOa%QOl;OO!V$fO!W%_O!X!XO!Y!WO!i!YO#V#QO%`#ZO%a#[O%b#YO%w$mO'R!WO'S!WO'W#XO'Z![O'b![O'c![O(pQO(s$xO)T$kO)W%]O)Y!ZO)ZXO)icO)jdO)k%[O~O]%hOd!POl%bO!V%kO!{!dO%w$mO(s;SO)T%dO)V%iO)W%iO~O(w%mO~O)X#jO~O(s%nO](uX!V(uX!X(uX!Y(uX![(uX!^(uX!_(uX!a(uX!b(uX!c(uX!e(uX!f(uX!h(uX(v(uX(x(uX(y(uX)T(uX)U(uX)V(uX)W(uX)X(uX)Y(uX!g(uX)k(uX!O(uX!W(uX(w(uX!U(uXQ(uX!d(uX~OP%oO(pQO~PCQO]%hOd!POr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!V%kO!r!aO!s!aO!t!aO!u!aO!v!aO!x!cO!{!dO%p!|O%w!}O)T;dO)V|O)W|O~Ol%rO!o%wO(s$xO~PE_O!TxO#v!eO(w%yO)k%|O])fX!V)fX~O]%hOd!POl%rO!V%kO!{!dO%w!}O(s$xO)T;dO)V|O)W|O~O!TxO#v!eO)X&PO)k&QO~O!U&TO~P!QO]&YO!TxO!V&WO)T&VO)V&ZO)W&ZO~Op&UO~PHrO]&cO!V&bO~OPmO]eOd!PO!VfO!X!XO!Y!WO!i!YO!{!dO#V#QO%`#ZO%a#[O%b#YO'R!WO'S!WO'W#XO'Z![O'b![O'c![O(pQO)TaO)V|O)W{O)Y!ZO)ZXO)icO)jdO~Oa%QOl;OO%w$mO(s$xO~PIgO]%hOd!POl;`O!V%kO!{!dO%w$mO(s$xO)T;dO)V|O)W|O~Op&fO](uX])fX!V(uX!V)fX!X(uX!Y(uX![(uX!^(uX!_(uX!a(uX!b(uX!c(uX!e(uX!f(uX!h(uX(v(uX(x(uX(y(uX)T(uX)U(uX)V(uX)W(uX)X(uX)Y(uX!O(uX!O)fX!U(uX~O!g$YO)k$YO~PL]O!g(uX)k(uX~PL]O](uX!V(uX!X(uX!Y(uX![(uX!^(uX!_(uX!a(uX!b(uX!c(uX!e(uX!f(uX!h(uX(v(uX(x(uX(y(uX)T(uX)U(uX)V(uX)W(uX)X(uX)Y(uX!g(uX)k(uX!O(uX!U(uX~O])fX!V)fX!O)fX~PNkOa&hO&n!RO]&mXd&mXl&mXr&mXs&mXt&mXu&mXv&mXw&mXx&mXy&mX}&mX!V&mX!r&mX!s&mX!t&mX!u&mX!v&mX!x&mX!{&mX%w&mX&s&mX&t&mX(s&mX)T&mX)V&mX)W&mX)X&mX!O&mX!T&mX!X&mX!Y&mX![&mX!^&mX!_&mX!a&mX!b&mX!c&mX!e&mX!f&mX!h&mX(v&mX(x&mX(y&mX)U&mX)Y&mX!g&mX)k&mX!W&mXQ&mX!d&mX(w&mX!U&mX#v&mX~Op&fOl)OX!O)OXQ)OX!d)OX!h)OX)Y)OX)k)OX~P.ZO!g$YO)k$YO](uX!V(uX!X(uX!Y(uX![(uX!^(uX!_(uX!a(uX!b(uX!c(uX!e(uX!f(uX!h(uX(v(uX(x(uX(y(uX)T(uX)U(uX)V(uX)W(uX)X(uX)Y(uX!O(uX!W(uX(w(uX!U(uXQ(uX!d(uX~OPmO]$eOa%QOl;OO!V$fO!X!XO!Y!WO!i!YO#V#QO%`#ZO%a#[O%b#YO%w$mO'R!WO'S!WO'W#XO'Z![O'b![O'c![O(pQO(s$xO)T$kO)W$kO)Y!ZO)ZXO)icO)jdO~O])OXd)OXl)OXr)OXs)OXt)OXu)OXv)OXw)OXx)OXy)OX})OX!V)OX!r)OX!s)OX!t)OX!u)OX!v)OX!x)OX!{)OX%w)OX&s)OX&t)OX(s)OX)T)OX)V)OX)W)OX)X)OX!O)OXQ)OX!d)OX!h)OX)Y)OX)k)OX~O]#}O~P!*qO]&lO~O])cXa)cXd)cXl)cXr)cXs)cXt)cXu)cXv)cXw)cXx)cXy)cX{)cX})cX!V)cX!o)cX!r)cX!s)cX!t)cX!u)cX!v)cX!x)cX!{)cX#a)cX#b)cX%f)cX%m)cX%p)cX%w)cX&n)cX&s)cX&t)cX(s)cX)T)cX)V)cX)W)cX~O(pQO~P!-ZO%V&nO~P!-ZO]&oO~O]#}O~O!TxO~O$X&wO(s%nO(w&vO~O]&xOw&zO~O]&xO~OPmO]$eOa%QOl;OO!TxO!V$fO!X!XO!Y!WO!i!YO#V#QO#p!xO#v!eO$Z!vO$[!wO$a!iO$f!jO$h!kO$i!lO$l!mO$n!nO$p!oO$r!pO$t!qO$v!rO$x!sO%`#ZO%a#[O%b#YO%w$mO'R!WO'S!WO'W#XO'Z![O'b![O'c![O(pQO(s:qO)QYO)T$kO)W$kO)XiO)Y!ZO)ZXO)icO)jdO~O]'PO~O!T$WO)X'RO~P!(zO)X'TO~O)X'UO~O(s'VO~O)X'YO~P!(zOl;bO%V'^O%f'^O(s;TO~Oa!TOl$oOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O{#RO#a#VO#b#TO%f#UO%m#SO&n!RO&s#WO&t!TO(s$nO~O(w'bO~O)X'dO~P!(zO!T'eO(s%nO)k'gO~O(s%nO~O]'jO~O]'kOd%oXl%oX!V%oX!{%oX%w%oX(s%oX)T%oX)V%oX)W%oX~O]'oO!V'pO!X'mO!g'mO%['mO%]'mO%^'mO%_'mO%`'qO%a'qO%b'mO(y'nO)k'mO)y'rO~P8zO]%hOa!TOd!POr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O{#RO}!_O!V%kO!r!aO!s!aO!t!aO!u!aO!v!aO!x!cO!{!dO#a#VO#b#TO%f#UO%m#SO&n!RO&s#WO&t!TO)T;dO)V|O)W|O~Ol;cOp&UO%w$mO(s;UO~P!8jO(s%nO(w'wO)X'xO~O]&cO!T'zO~Ol$oO}!_O!T(RO!l(WO(s$nO(w(QO)QYO~Ol$oO{(_O!T([O#b(_O(s$nO~Oa!TOl$oO{#RO#a#VO#b#TO%f#UO%m#SO&n!RO&s#WO&t!TO(s$nO~O](aO~OPmOa%QOl;OO!V$fO!X!XO!Y!WO!i!YO#V#QO%`#ZO%a#[O%b#YO%w$mO'R!WO'S!WO'W#XO'Z![O'b![O'c![O(pQO(s$xO)T$kO)W$kO)ZXO)icO)jdO~O](cO)Y(dO~P!=UO]#}O~P!<[OPmO]$eOa%QOl;OO!V(jO!X!XO!Y!WO!i!YO#V#QO%`#ZO%a#[O%b#YO%w$mO'R!WO'S!WO'W#XO'Z![O'b![O'c![O(pQO(s$xO)T$kO)W$kO)Y!ZO)ZXO)icO)jdO~OY(kO(pQO(s%nO~O'g(nO~OS(rOT(oO*X(qO~O]#}O(o(uO~Q'oXX#dO(q#dO(r(wO~Od)ROl(|O&s#WO(s({O~O!Y'Ta!['Ta!^'Ta!_'Ta!a'Ta!b'Ta!c'Ta!e'Ta!f'Ta!h'Ta(v'Ta)T'Ta)U'Ta)V'Ta)W'Ta)X'Ta)Y'Ta!g'Ta)k'Ta!O'Ta!W'Ta(w'Ta!U'TaQ'Ta!d'Ta~OPmOa%QOl;OO!i!YO#V#QO%`#ZO%a#[O%b#YO%w$mO'R!WO'S!WO'W#XO'Z![O'b![O'c![O(pQO(s$xO)ZXO)icO)jdO]'Ta!V'Ta!X'Ta(x'Ta(y'Ta~P!B_O!T$WO!O(tP~P!(zO]nX]%XXdnXlmXpnXp%XXrnXsnXtnXunXvnXwnXxnXynX}nX!TnX!VnX!V%XX!X%XX!Y%XX![%XX!^%XX!_%XX!a%XX!b%XX!c%XX!e%XX!f%XX!gmX!h%XX!rnX!snX!tnX!unX!vnX!xnX!{nX%wnX&snX&tnX(snX(v%XX(x%XX(y%XX)TnX)T%XX)U%XX)VnX)V%XX)WnX)W%XX)X%XX)Y%XX)kmX!O%XX~O)XnX!OnX!U%XX~P!E{O])eO!V)fO!X)cO!g)cO%[)cO%])cO%^)cO%_)cO%`)gO%a)gO%b)cO(y)dO)k)cO)y)hO~P8zOPmO]$eOa%QOl;OO!X!XO!Y!WO!i!YO#V#QO%`#ZO%a#[O%b#YO%w$mO'R!WO'S!WO'W#XO'Z![O'b![O'c![O(pQO(s$xO)T$kO)W$kO)Y!ZO)ZXO)icO)jdO~O!V)mO~P!JwOd)pO%Z)qO(z$OO~O!T$WO!V)sO(x)tO!U)sP~P!JwO!T$WO~P!(zO)]){O~Ol)|O]!QX!h!QX)Y!QX)^!QX~O]*OO!h*PO)Y)RX)^)RX~O)Y*TO)^*SO~Od$RO%Z*UO']$TO'`$UO(z$OO~Ol*VO~Ol*VO!O)OX~P.ZOl*VO!g$YO)k$YO~O)X*WO~P:nOPmO]$eOa!]Ol$_Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O{#RO!V$fO!X!XO!Y!WO!i!YO#V#QO#a#VO#b#TO%`#ZO%a#[O%b#YO%f#UO%m#SO%w$mO&n!RO&s#WO&t!TO'R!WO'S!WO'W#XO'Z![O'b![O'c![O(pQO(s;RO)T$kO)W$kO)Y!ZO)ZXO)icO)jdO~Op&fO~P!&zOp&fO!W(uX(w(uXQ(uX!d(uX~PNkO]'oO!V'pO!X'mO!g'mO%['mO%]'mO%^'mO%_'mO%`'qO%a'qO%b'mO(y'nO)k'mO)y'rO~O]iXdiXlgXpiXriXsiXtiXuiXviXwiXxiXyiX}iX!ViX!riX!siX!tiX!uiX!viX!xiX!{iX%wiX&siX&tiX(siX)TiX)ViX)WiX!TiX!hiX)YiX)kiX!OiX~O!liX(wiX)XiX!XiX!YiX![iX!^iX!_iX!aiX!biX!ciX!eiX!fiX(viX(xiX(yiX)UiX!giX!WiXQiX!diX!UiX#viX#TiX#ViX#piXaiX{iX!oiX#aiX#biX#iiX#tiX$|iX%diX%fiX%liX%miX%piX&niX)QiX~P#%yO(z*[O~Ol*]O~O])OXd)OXr)OXs)OXt)OXu)OXv)OXw)OXx)OXy)OX})OX!V)OX!r)OX!s)OX!t)OX!u)OX!v)OX!x)OX!{)OX%w)OX&s)OX&t)OX(s)OX)T)OX)V)OX)W)OX)X)OX!T)OX!X)OX!Y)OX![)OX!^)OX!_)OX!a)OX!b)OX!c)OX!e)OX!f)OX!h)OX(v)OX(x)OX(y)OX)U)OX)Y)OX!g)OX)k)OX!O)OX!W)OXQ)OX!d)OX(w)OX!U)OX#v)OX~Ol*]O~P#+ROr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O}!_O!r!aO!s!aO!t!aO!u!aO!v!aO!x!cO])bad)bal)ba!V)ba!{)ba%w)ba(s)ba)T)ba)V)ba)W)baQ)ba!d)ba!h)ba)Y)ba)k)ba!O)ba!T)ba(w)ba)X)ba~O&s#WO&t$wO~P#.qOp&fOl)OX~P#+RO&s)ba~P#.qO]ZXlgXpZXpiX!TiX!VZX!XZX!YZX![ZX!^ZX!_ZX!aZX!bZX!cZX!eZX!fZX!gZX!hZX(vZX(xZX(yZX)TZX)UZX)VZX)WZX)XZX)YZX)kZX!OZX~O!WZX(wZX!UZXQZX!dZX~P#1jO]#}O!V#lO!X#{O(x#kO(y#kO~O!Y&ya![&ya!^&ya!_&ya!a&ya!b&ya!c&ya!e&ya!f&ya!g&ya!h&ya(v&ya)T&ya)U&ya)V&ya)W&ya)X&ya)Y&ya)k&ya!O&ya!W&ya(w&ya!U&yaQ&ya!d&ya~P#3zOl;lO!T$WO~Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O~PKkOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!|%RO~PKkO]&cO!V&bO!O#Qa!T#Qa!h#Qa#v#Qa)X#Qa)k#QaQ#Qa!d#Qa(w#Qa~Op&fO!T$WO~O!O*dO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|O~P#3zO!O*dO~O]&cO!O*fO!V&bO~O]&YOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!V&WO&s#WO&t$wO)T&VO)V&ZO)W&ZO~O!OqXQqX!dqX!hqX)YqX)XqX~P#9{O!O*iO~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h*jO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|O!W)lX~P#3zO!W*lO!h*mO~O!W*lO!h*mO~P!(zO!W*lO~Op&fO!g$YO!h*nO)k$YO](uX!V(uX!W(uX!W*PX!X(uX!Y(uX![(uX!^(uX!_(uX!a(uX!b(uX!c(uX!e(uX!f(uX(v(uX(x(uX(y(uX)T(uX)U(uX)V(uX)W(uX)Y(uX~O!h(uX~P#=ZO!W*pO~Od$RO%Z*UO(z:vO~Ol;oO~Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!|%RO~PBUO]*wO!T*rO!V&bO!h*uO#v!eO)k*sO)X)rX~O!h*uO)X)rX~O)X*xO~Op&fO])fX!T)fX!V)fX!h)fX#v)fX)X)fX)k)fX!O)fXQ)fX!d)fX(w)fX~Op&fO~OP%oO(pQO]%ia!V%ia!X%ia!Y%ia![%ia!^%ia!_%ia!a%ia!b%ia!c%ia!e%ia!f%ia!h%ia(s%ia(v%ia(x%ia(y%ia)T%ia)U%ia)V%ia)W%ia)X%ia)Y%ia!g%ia)k%ia!O%ia!W%ia(w%ia!U%iaQ%ia!d%ia~Od$RO%Z$SO(z:sO~Ol:{O~O!TxO#v!eO)k%|O~Ol<`O&s#WO(s;kO~O$[+UO%a+VO~O!TxO#v!eO)X+WO)k+XO~OPmO]$eOa%QOl;OO!V$fO!X!XO!Y!WO!i!YO#V#QO$[+UO%`#ZO%a+ZO%b#YO%w$mO'R!WO'S!WO'W#XO'Z![O'b![O'c![O(pQO(s$xO)T$kO)W$kO)Y!ZO)ZXO)icO)jdO~O!U+[O~P!QOa!TOl$oOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O{#RO}!_O!r!aO!s!aO!t!aO!u!aO!v!aO!x!cO#a+bO#b+cO#i+dO%f#UO%m#SO&n!RO&s#WO&t!TO(s$nO)QYO~OQ)mP!d)mP~P#GgO]&YOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!V&WO)T&VO)V&ZO)W&ZO~O!O#kX!T#kX#v#kX)X#kX)k#kXQ#kX!d#kX!h#kX)Y#kX!x#kX(w#kX~P#IkOPmO]$eOa%QOl;OOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!V$fO!W+jO!X!XO!Y!WO!i!YO#V#QO%`#ZO%a#[O%b#YO%w$mO'R!WO'S!WO'W#XO'Z![O'b![O'c![O(pQO(s$xO)T+kO)W$kO)Y!ZO)ZXO)icO)jdO~O]&cO!V+lO~O]&YO!V&WO)QYO)T&VO)V&ZO)W&ZO)Y+oO!O)eP~P8zO]&YO!V&WO)T&VO)V&ZO)W&ZO~O!O#nX!T#nX#v#nX)X#nX)k#nXQ#nX!d#nX!h#nX)Y#nX!x#nX(w#nX~P#NeO!TxO])oX!V)oX~Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O#T+wO#p+xO(y+uO)V+sO)W+sO~O]#jX!T#jX!V#jX!O#jX#v#jX)X#jX)k#jXQ#jX!d#jX!h#jX)Y#jX!x#jX(w#jX~P$ xO#V+zO~Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!l+{O#T+wO#V+zO#p+xO(y+uO)V+{O)W+{O])gP!T)gP!V)gP#v)gP(w)gP)k)gP!O)gP!h)gP)X)gP~O!x)gPQ)gP!d)gP~P$#uOPmO]$eOa%QOl;OOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!V$fO!X!XO!Y!WO!i!YO#V#QO%`#ZO%a#[O%b#YO%w$mO'R!WO'S!WO'W#XO'Z![O'b![O'c![O(pQO(s$xO)W$kO)Y!ZO)ZXO)icO)jdO~O!W,RO)T,SO~P$%pO)QYO)Y+oO!O)eP~P8zO]&cO!V&bO!O&[a!T&[a!h&[a#v&[a)X&[a)k&[aQ&[a!d&[a(w&[a~OPmO]$eOa!]Ol;QOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O{#RO!V$fO!X!XO!Y!WO!i!YO#V#QO#a#VO#b#TO%`#ZO%a#[O%b#YO%f#UO%m#SO%w$mO&n!RO&s#WO&t!TO'R!WO'S!WO'W#XO'Z![O'b![O'c![O(pQO(s;VO)T$kO)W$kO)Y!ZO)ZXO)icO)jdO~OQ({P!d({P~P$)YO]#}O!V#lO(x#kO(y#kO!X'Qa!Y'Qa!['Qa!^'Qa!_'Qa!a'Qa!b'Qa!c'Qa!e'Qa!f'Qa!h'Qa(v'Qa)T'Qa)U'Qa)V'Qa)W'Qa)X'Qa)Y'Qa!g'Qa)k'Qa!O'Qa!W'Qa(w'Qa!U'QaQ'Qa!d'Qa~O]#}O!V#lO!X#{O(x#kO(y#kO~P!B_O!T'eO#t!fO)QYO~P8zO!T'eO(s%nO)k,]O~O#x,bO~OQ)bX!d)bX!h)bX)Y)bX)k)bX!O)bX!T)bX(w)bX)X)bX~P:nO(w,fO(x,dO)Q$VX)X$VX~O(s,gO~O)QYO)X,jO~OPmO]$eOa!]Ol;POr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O{#RO}!_O!V$fO!X!XO!Y!WO!i!YO!r!aO!s!aO!t!aO!u!aO!v!aO!x!cO#V#QO#a#VO#b#TO%`#ZO%a#[O%b#YO%f#UO%m#SO%w$mO&n!RO&s#WO&t!TO'R!WO'S!WO'W#XO'Z![O'b![O'c![O(pQO)QYO)T$kO)W$kO)XiO)Y!ZO)ZXO)icO)jdO~O(s;WO~P$0kOPmO]$eOa%QOl;OO!TxO!V$fO!X!XO!Y!WO!i!YO#V#QO#v!eO$Z!vO$[!wO$a!iO$f!jO$h!kO$i!lO$l!mO$n!nO$p!oO$r!pO$t!qO$v!rO$x!sO%`#ZO%a#[O%b#YO%w$mO'R!WO'S!WO'W#XO'Z![O'b![O'c![O(pQO(s:qO)QYO)T$kO)W$kO)XiO)Y!ZO)ZXO)icO)jdO~O$i,tO~OPmO]$eOa!]Ol;POr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O{#RO}!_O!V$fO!X!XO!Y!WO!i!YO!r!aO!s!aO!t!aO!u!aO!v!aO!x!cO#V#QO#a#VO#b#TO%O!uO%`#ZO%a#[O%b#YO%f#UO%m#SO%w$mO&n!RO&s#WO&t!TO'R!WO'S!WO'W#XO'Z![O'b![O'c![O(pQO)QYO)T$kO)W$kO)Y!ZO)ZXO)icO)jdO~O$|,zO(s;RO)X,xO~P$7UO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(v#gO)T#mO)U#oO)V#nO)W#pO)X,|O)Y#|O~P#3zO)X,|O~O)X,}O~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)X-OO)Y#|O~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)X-PO)Y#|O~P#3zOp&fO)QYO)k-RO~O)X-SO~Ol;bO(s;TO~O]-ZO!{!dO&s#WO&t$wO(s-VO)T-WO~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO(w-^O)T#mO)U#oO)V#nO)W#pO)Y#|O~P#3zO!TxO$a!iO$f!jO$h!kO$i!lO$l-cO$n!nO$p!oO$r!pO$t!qO$v!rO$x!sO%O!uO(s:rOd$Ya!o$Ya!{$Ya#i$Ya#p$Ya#t$Ya#v$Ya$S$Ya$U$Ya$Z$Ya$[$Ya$|$Ya%V$Ya%d$Ya%h$Ya%p$Ya%}$Ya(l$Ya)V$Ya!U$Ya$d$Ya~P$0kO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)X-dO)Y#|O~P#3zO!U-eO~P!QOl-hO!T'eO)k,]O~O)k-jO~O]&^a!X&^a!Y&^a![&^a!^&^a!_&^a!a&^a!b&^a!c&^a!e&^a!f&^a!h&^a(v&^a(x&^a(y&^a)U&^a)V&^a)W&^a)X&^a)Y&^a!g&^a)k&^a!O&^a!W&^a!T&^a#v&^a(w&^a!U&^aQ&^a!d&^a~O)T-nO!V&^a~P$DiO!O-nO~O!W-nO~O!V-oO)T&^a~P$DiO])OXd)OXr)OXs)OXt)OXu)OXv)OXw)OXx)OXy)OX})OX!V)OX!r)OX!s)OX!t)OX!u)OX!v)OX!x)OX!{)OX%w)OX&s)OX&t)OX(s)OX)T)OX)V)OX)W)OX~Ol;qO~P$GXO]&cO!V&bO)X-pO~Ol;gO!o-sO#V+zO#i-xO#t!fO$|,zO%d!zO%l-wO%p!|O%w!}O(s;XO)QYO~P!8jO!n-|O(s,gO~O)QYO)X.OO~OPmO]$eOa%QOl;OO!T.TO!V$fO!X!XO!Y!WO!i!YO#V.[O#a.ZO%`#ZO%a#[O%b#YO%w$mO'R!WO'S!WO'W#XO'Z![O'b![O'c![O(pQO(s$xO(y.SO)T$kO)W$kO)X.QO)Y!ZO)ZXO)icO)jdO~O!U.YO~P$JiO])_Xd)_Xr)_Xs)_Xt)_Xu)_Xv)_Xw)_Xx)_Xy)_X})_X!T)_X!V)_X!l)_X!r)_X!s)_X!t)_X!u)_X!v)_X!x)_X!{)_X%w)_X&s)_X&t)_X(s)_X(w)_X)T)_X)V)_X)W)_X)X)_X!O)_X!h)_X)Y)_X!X)_X!Y)_X![)_X!^)_X!_)_X!a)_X!b)_X!c)_X!e)_X!f)_X(v)_X(x)_X(y)_X)U)_X!g)_X)k)_X!W)_XQ)_X!d)_X#T)_X#V)_X#p)_X#v)_Xa)_X{)_X!o)_X#a)_X#b)_X#i)_X#t)_X$|)_X%d)_X%f)_X%l)_X%m)_X%p)_X&n)_X)Q)_X!U)_X~Ol*]O~P$LsOl$oO!T(RO!l.aO(s$nO(w(QO)QYO~Op&fOl)_X~P$LsOl$oO!n.fO!o.fO(s$nO)QYO~Ol;hO!U.qO!n.sO!o.rO#i-xO$|!tO%O!uO%h!{O%l-wO%p!|O%w!}O(s;ZO)QYO~P!8jO!T(RO!l.aO(w(QO])PXd)PXl)PXr)PXs)PXt)PXu)PXv)PXw)PXx)PXy)PX})PX!V)PX!r)PX!s)PX!t)PX!u)PX!v)PX!x)PX!{)PX%w)PX&s)PX&t)PX(s)PX)T)PX)V)PX)W)PX~O)X)PX!O)PX!X)PX!Y)PX![)PX!^)PX!_)PX!a)PX!b)PX!c)PX!e)PX!f)PX!h)PX(v)PX(x)PX(y)PX)U)PX)Y)PX!g)PX)k)PX!W)PXQ)PX!d)PX!U)PX#v)PX~P%%lO!T(RO~O!T(RO(w(QO~O(s%nO!U*RP~O!T([O(w.xO]&lad&lal&lar&las&lat&lau&lav&law&lax&lay&la}&la!V&la!r&la!s&la!t&la!u&la!v&la!x&la!{&la%w&la&s&la&t&la(s&la)T&la)V&la)W&la)X&la!O&la!X&la!Y&la![&la!^&la!_&la!a&la!b&la!c&la!e&la!f&la!h&la(v&la(x&la(y&la)U&la)Y&la!g&la)k&la!W&laQ&la!d&la!U&la#v&la~Ol$oO!T([O(s$nO~O&s#WO&t$wO]&qad&qal&qar&qas&qat&qau&qav&qaw&qax&qay&qa}&qa!V&qa!r&qa!s&qa!t&qa!u&qa!v&qa!x&qa!{&qa%w&qa(s&qa)T&qa)V&qa)W&qa)X&qa!O&qa!T&qa!X&qa!Y&qa![&qa!^&qa!_&qa!a&qa!b&qa!c&qa!e&qa!f&qa!h&qa(v&qa(x&qa(y&qa)U&qa)Y&qa!g&qa)k&qa!W&qaQ&qa!d&qa(w&qa!U&qa#v&qa~O&t.}O~P!(zO!Y#qO![#rO!f#zO)T#mO!^'Va!_'Va!a'Va!b'Va!c'Va!e'Va!h'Va(v'Va)U'Va)V'Va)W'Va)X'Va)Y'Va!g'Va)k'Va!O'Va!W'Va(w'Va!U'VaQ'Va!d'Va~P#3zO!V'eX!X'eX!Y'eX!['eX!^'eX!_'eX!a'eX!b'eX!c'eX!e'eX!f'eX!h'eX(v'eX(x'eX(y'eX)T'eX)U'eX)V'eX)W'eX)Y'eX!O'eX~O]/PO)X'eX!g'eX)k'eX!W'eX(w'eX!U'eXQ'eX!d'eX~P%3PO!Y#qO![#rO!f#zO)T#mO!^'Xa!_'Xa!a'Xa!b'Xa!c'Xa!e'Xa!h'Xa(v'Xa)U'Xa)V'Xa)W'Xa)X'Xa)Y'Xa!g'Xa)k'Xa!O'Xa!W'Xa(w'Xa!U'XaQ'Xa!d'Xa~P#3zO]#}O!T$WO!V/QO&s#WO&t$wO~O!X'[a!Y'[a!['[a!^'[a!_'[a!a'[a!b'[a!c'[a!e'[a!f'[a!h'[a(v'[a(x'[a(y'[a)T'[a)U'[a)V'[a)W'[a)X'[a)Y'[a!g'[a)k'[a!O'[a!W'[a(w'[a!U'[aQ'[a!d'[a~P%6vO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|O!h'_a)X'_a!g'_a)k'_a!O'_a!W'_a(w'_a!U'_aQ'_a!d'_a~P#3zOPmO]$eOa%QOl;OO!V$fO!X!XO!Y!WO!i!YO#V#QO%`#ZO%a#[O%b#YO%w$mO'R!WO'S!WO'W#XO'Z![O'b![O'c![O(pQO(s$xO)T$kO)W%]O)Y!ZO)ZXO)icO)jdO)k%[O~O!W/TO~P%:vOS(rOT(oO]#}O*X(qO~O]/WO'g/XO*X/UO~OS/]OT(oO*X/[O~O]#}O~Q'oa!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO(w/_O)T#mO)U#oO)V#nO)W#pO)Y#|O~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|O)X#Zi!O#Zi~P#3zO]cXlgXpcXpiX!VcX!XcX!YcX![cX!^cX!_cX!acX!bcX!ccX!ecX!fcX!gcX!hcX(vcX(xcX(ycX)TcX)UcX)VcX)WcX)XcX)YcX)kcX!OcX!WcX(wcX!TcX#vcX!UcXQcX!dcX~Od/aO%Z*UO(z/`O~Ol/bO~Ol/cO~Op&fO]bi!Vbi!Xbi!Ybi![bi!^bi!_bi!abi!bbi!cbi!ebi!fbi!gbi!hbi(vbi(xbi(ybi)Tbi)Ubi)Vbi)Wbi)Xbi)Ybi)kbi!Obi!Wbi(wbi!UbiQbi!dbi~O!W/eO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|O~P#3zO![#rO)T#mO!Y&{i!^&{i!_&{i!a&{i!b&{i!c&{i!e&{i!f&{i!h&{i(v&{i)U&{i)V&{i)W&{i)X&{i)Y&{i!g&{i)k&{i!O&{i!W&{i(w&{i!U&{iQ&{i!d&{i~P#3zO!Y&{i![&{i!^&{i!_&{i!a&{i!b&{i!c&{i!e&{i!f&{i!h&{i(v&{i)T&{i)U&{i)V&{i)W&{i)X&{i)Y&{i!g&{i)k&{i!O&{i!W&{i(w&{i!U&{iQ&{i!d&{i~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO)T#mO)W#pO!h&{i(v&{i)U&{i)V&{i)X&{i)Y&{i!g&{i)k&{i!O&{i!W&{i(w&{i!U&{iQ&{i!d&{i~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO)T#mO)V#nO)W#pO!h&{i(v&{i)U&{i)X&{i)Y&{i!g&{i)k&{i!O&{i!W&{i(w&{i!U&{iQ&{i!d&{i~P#3zO!Y#qO![#rO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO)T#mO)W#pO!^&{i!h&{i(v&{i)U&{i)V&{i)X&{i)Y&{i!g&{i)k&{i!O&{i!W&{i(w&{i!U&{iQ&{i!d&{i~P#3zO!Y#qO![#rO!a#xO!b#yO!c#yO!e#yO!f#zO)T#mO)W#pO!^&{i!_&{i!h&{i(v&{i)U&{i)V&{i)X&{i)Y&{i!g&{i)k&{i!O&{i!W&{i(w&{i!U&{iQ&{i!d&{i~P#3zO!Y#qO![#rO!a#xO!b#yO!c#yO!e#yO!f#zO)T#mO!^&{i!_&{i!h&{i(v&{i)U&{i)V&{i)W&{i)X&{i)Y&{i!g&{i)k&{i!O&{i!W&{i(w&{i!U&{iQ&{i!d&{i~P#3zO!Y#qO![#rO!b#yO!c#yO!e#yO!f#zO)T#mO!^&{i!_&{i!a&{i!h&{i(v&{i)U&{i)V&{i)W&{i)X&{i)Y&{i!g&{i)k&{i!O&{i!W&{i(w&{i!U&{iQ&{i!d&{i~P#3zO!Y#qO![#rO!f#zO)T#mO!^&{i!_&{i!a&{i!b&{i!c&{i!e&{i!h&{i(v&{i)U&{i)V&{i)W&{i)X&{i)Y&{i!g&{i)k&{i!O&{i!W&{i(w&{i!U&{iQ&{i!d&{i~P#3zO!Y#qO![#rO)T#mO!^&{i!_&{i!a&{i!b&{i!c&{i!e&{i!f&{i!h&{i(v&{i)U&{i)V&{i)W&{i)X&{i)Y&{i!g&{i)k&{i!O&{i!W&{i(w&{i!U&{iQ&{i!d&{i~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO)T#mO)U#oO)V#nO)W#pO!h&{i(v&{i)X&{i)Y&{i!g&{i)k&{i!O&{i!W&{i(w&{i!U&{iQ&{i!d&{i~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h/fO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|O!O(tX~P#3zO!h/fO!O(tX~O!O/hO~O]%Yap%Ya!X%Ya!Y%Ya![%Ya!^%Ya!_%Ya!a%Ya!b%Ya!c%Ya!e%Ya!f%Ya!h%Ya(v%Ya(x%Ya(y%Ya)U%Ya)V%Ya)W%Ya)X%Ya)Y%Ya!g%Ya)k%Ya!O%Ya!W%Ya!T%Ya#v%Ya(w%Ya!U%YaQ%Ya!d%Ya~O)T/iO!V%Ya~P&,hO!O/iO~O!W/iO~O!V/jO)T%Ya~P&,hO!X'[i!Y'[i!['[i!^'[i!_'[i!a'[i!b'[i!c'[i!e'[i!f'[i!h'[i(v'[i(x'[i(y'[i)T'[i)U'[i)V'[i)W'[i)X'[i)Y'[i!g'[i)k'[i!O'[i!W'[i(w'[i!U'[iQ'[i!d'[i~P%6vO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|O!h'_i)X'_i!g'_i)k'_i!O'_i!W'_i(w'_i!U'_iQ'_i!d'_i~P#3zO!W/oO~P%:vO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h/qO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|O!U)sX~P#3zO(s/tO~O!V/vO(x)tO)k/xO~O!h/qO!U)sX~O!U/yO~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO)T#mO)U#oO)V#nO)W#pO)Y#|O!h_i(v_i)X_i!g_i)k_i!O_i!W_i(w_i!U_iQ_i!d_i~P#3zO!R/zO~Ol)|O]!Qa!h!Qa)Y!Qa)^!Qa~OP0SO]0ROl0SO!R0SO!T0PO!V0QO!X0SO!Y0SO![0SO!^0SO!_0SO!a0SO!b0SO!c0SO!e0SO!f0SO!g0SO!h0SO!i0SO(pQO(w0SO(x0SO(y0SO)T/|O)U/}O)V/}O)W0OO)X0SO)Y0SO)ZXO~O!O0VO~P&7QO!R$[O~O!h*PO)Y)Ra)^)Ra~O)^0ZO~O])eO!V)fO!X)cO!g)cO%[)cO%])cO%^)cO%_)cO%`)gO%a)gO%b)cO(y)dO)k)cO)y)hO~Od)pO%Z*UO(z$OO~O)X0]O~O]nXdnXlmXpnXrnXsnXtnXunXvnXwnXxnXynX}nX!VnX!rnX!snX!tnX!unX!vnX!xnX!{nX%wnX&snX&tnX(snX)TnX)VnX)WnX!TnX!hnX)YnX!OnXQnX!dnX~O!lnX(wnX)XnX!XnX!YnX![nX!^nX!_nX!anX!bnX!cnX!enX!fnX(vnX(xnX(ynX)UnX!gnX)knX!WnX!UnX#vnX#TnX#VnX#pnXanX{nX!onX#anX#bnX#inX#tnX$|nX%dnX%fnX%lnX%mnX%pnX&nnX)QnX~P&:|Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O}!_O!r!aO!s!aO!t!aO!u!aO!v!aO!x!cO~O])bid)bil)bi!V)bi!{)bi%w)bi(s)bi)T)bi)V)bi)W)biQ)bi!d)bi!h)bi)Y)bi)k)bi!O)bi!T)bi&s)bi(w)bi)X)bi~P&?zO]&cO!V&bO!O#Qi!T#Qi!h#Qi#v#Qi)X#Qi)k#QiQ#Qi!d#Qi(w#Qi~O!OqaQqa!dqa!hqa)Yqa)Xqa~P#9{O!OqaQqa!dqa!hqa)Yqa)Xqa~P#IkO]&cO!V+lO!OqaQqa!dqa!hqa)Yqa)Xqa~O!h*jO!W)la~O!h*nO!W*Pa~OPmO]eOa!]Od!POlTOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O{#RO}!_O!X!XO!Y!WO!i!YO!opO!r!`O!s!aO!t!aO!u!bO!v!aO!x!cO!{!dO#V#QO#a#VO#b#TO#i#OO#p!xO#t!fO#v!eO$S!gO$U!hO$Z!vO$[!wO$a!iO$f!jO$h!kO$i!lO$l!mO$n!nO$p!oO$r!pO$t!qO$v!rO$x!sO$|!tO%O!uO%V!yO%`#ZO%a#[O%b#YO%d!zO%f#UO%h!{O%m#SO%p!|O%w!}O%}#PO&n!RO&s#WO&t!TO'R!WO'S!WO'W#XO'Z![O'b![O'c![O(pQO(sRO)QYO)TaO)V|O)W{O)XiO)Y!ZO)ZXO)icO)jdO~O!T*rO!U&TO!V0kO(x)tO~P&D|O!h*uO)X)ra~OPmO]$eOa!]Ol;QO{#RO!T$WO!V$fO!X!XO!Y!WO!i!YO#V#QO#a#VO#b#TO%`#ZO%a#[O%b#YO%f#UO%m#SO%w$mO&n!RO&s#WO&t!TO'R!WO'S!WO'W#XO'Z![O'b![O'c![O(pQO(s;YO)QYO)T$kO)W$kO)Y0qO)ZXO)icO)jdO!O(tP!O)eP~P&?zO!h*nO!W*PX~O]#}O!T$WO~O!h0vO!T){X#v){X)k){X~O)X0xO~O)X0yO~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)X0{O)Y#|O~P#3zO)X0yO~P!?WO]1VOd!POl%bO!V1TO!{!dO%w$mO(s$xO)T0}O)Y1QO~O)V1RO)W1RO)k1OOQ#PX!d#PX!h#PX!O#PX~P' kO!h1WOQ)mX!d)mX~OQ1YO!d1YO~O)Y1]O)k1[OQ#`X!d#`X!h#`X~P!<[O)Y1]O)k1[OQ#`X!d#`X!h#`X~P!;bOp&UO~O!O#ka!T#ka#v#ka)X#ka)k#kaQ#ka!d#ka!h#ka)Y#ka!x#ka(w#ka~P#IkO]&cO!V+lO!O#ka!T#ka#v#ka)X#ka)k#kaQ#ka!d#ka!h#ka)Y#ka!x#ka(w#ka~O!W1bO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|O~P#3zO!W1bO)T1dO~P$%pO!W1bO~P!(zO]#ja!T#ja!V#ja!O#ja#v#ja)X#ja)k#jaQ#ja!d#ja!h#ja)Y#ja!x#ja(w#ja~P$ xO]&cO!O1hO!V+lO~O!h1iO!O)eX~O!O1kO~O]&cO!V+lO!O#na!T#na#v#na)X#na)k#naQ#na!d#na!h#na)Y#na!x#na(w#na~O]1oOr#SXs#SXt#SXu#SXv#SXw#SXx#SXy#SX!T#SX!V#SX#T#SX#p#SX(y#SX)V#SX)W#SX!l#SX!x#SX#V#SX#v#SX(w#SX)k#SX!O#SX!h#SX)X#SXQ#SX!d#SX)Y#SX~O]1pO~O]1sOl$oO!V$fO#V#QO(s$nO)icO)jdO~Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!l+{O#T+wO#V+zO#p+xO(y+uO)V+{O)W+{O~O])gX!T)gX!V)gX!x)gX#v)gX(w)gX)k)gX!O)gX!h)gX)X)gXQ)gX!d)gX~P',UO!x!cO]#Ri!T#Ri!V#Ri#v#Ri(w#Ri)k#Ri!O#Ri!h#Ri)X#RiQ#Ri!d#Ri~O!W1{O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|O~P#3zO!W1{O)T1}O~P$%pO!W1{O~P!(zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|OQ*SX!d*SX!h*SX~P#3zO)Y2OOQ(|X!d(|X!h(|X~O!h2POQ({X!d({X~OQ2RO!d2RO~O!O2SO~O#t$lO)QYO~P8zOl-hO!T'eO)k2WO~O!O2XO~O#x,bOP#ui]#uia#uid#uil#uir#uis#uit#uiu#uiv#uiw#uix#uiy#ui{#ui}#ui!T#ui!V#ui!X#ui!Y#ui!i#ui!o#ui!r#ui!s#ui!t#ui!u#ui!v#ui!x#ui!{#ui#V#ui#a#ui#b#ui#i#ui#p#ui#t#ui#v#ui$S#ui$U#ui$Z#ui$[#ui$a#ui$f#ui$h#ui$i#ui$l#ui$n#ui$p#ui$r#ui$t#ui$v#ui$x#ui$|#ui%O#ui%V#ui%`#ui%a#ui%b#ui%d#ui%f#ui%h#ui%m#ui%p#ui%w#ui%}#ui&n#ui&s#ui&t#ui'R#ui'S#ui'W#ui'Z#ui'b#ui'c#ui(l#ui(p#ui(s#ui)Q#ui)T#ui)V#ui)W#ui)X#ui)Y#ui)Z#ui)i#ui)j#ui!U#ui$d#ui!n#ui%l#ui~O]&cO~O]&cO!TxO!V&bO#v!eO~O(w2^O(x,dO)Q$Va)X$Va~O)QYO)X2`O~O!O2aO~P,]O!O2aO)X#jO~O!O2aO~O$d2fOP$`i]$`ia$`id$`il$`ir$`is$`it$`iu$`iv$`iw$`ix$`iy$`i{$`i}$`i!T$`i!V$`i!X$`i!Y$`i!i$`i!o$`i!r$`i!s$`i!t$`i!u$`i!v$`i!x$`i!{$`i#V$`i#a$`i#b$`i#i$`i#p$`i#t$`i#v$`i$S$`i$U$`i$Z$`i$[$`i$a$`i$f$`i$h$`i$i$`i$l$`i$n$`i$p$`i$r$`i$t$`i$v$`i$x$`i$|$`i%O$`i%V$`i%`$`i%a$`i%b$`i%d$`i%f$`i%h$`i%m$`i%p$`i%w$`i%}$`i&n$`i&s$`i&t$`i'R$`i'S$`i'W$`i'Z$`i'b$`i'c$`i(l$`i(p$`i(s$`i)Q$`i)T$`i)V$`i)W$`i)X$`i)Y$`i)Z$`i)i$`i)j$`i!U$`i~O]1sO~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(v#gO)T#mO)U#oO)V#nO)W#pO)X2iO)Y#|O~P#3zOPmO]$eOa!]Ol;PO{#RO!V$fO!X!XO!Y!WO!i!YO#V#QO#a#VO#b#TO%`#ZO%a#[O%b#YO%f#UO%m#SO%w$mO&n!RO&s#WO&t!TO'R!WO'S!WO'W#XO'Z![O'b![O'c![O(pQO(s;RO)T$kO)W$kO)X2lO)Y!ZO)ZXO)icO)jdO~P&?zO)X2iO~O(s-VO~O)QYO)k2oO~O)X2qO~O]-ZOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!{!dO!|%RO(s-VO)T-WO~O)T2vO~O]&cO!V2xO!h2yO)X)vX~O]-ZO!{!dO(s-VO)T-WO~O)X2|O~O!TxO$a!iO$f!jO$h!kO$i!lO$l-cO$n!nO$p!oO$r!pO$t!qO$v!rO$x!sO%O!uO(s:rOd$Yi!o$Yi!{$Yi#i$Yi#p$Yi#t$Yi#v$Yi$S$Yi$U$Yi$Z$Yi$[$Yi$|$Yi%V$Yi%d$Yi%h$Yi%p$Yi%}$Yi(l$Yi)V$Yi!U$Yi$d$Yi~P$0kOl;PO(s:rO~P0zO]3QO~O!U3RO~P!QO)X2VO~O!u3TO(s%nO~O!O3WO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h3XO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|O~P#3zO!O3YO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|O~P#3zO]&cO!V+lO!T%vi#v%vi)X%vi)k%vi~O!W3ZO~Ol:}O)X)OX~P$GXOa!TOl$oO{3aO#a#VO#b3`O#t!fO%f#UO%m3bO&n!RO&s#WO&t!TO(s$nO)QYO~P&?zOl;gO!o-sO#i-xO#t!fO$|,zO%d!zO%l-wO%p!|O%w!}O(s;XO)QYO~P!8jO]&cO!V&bO)X3dO~O)X3eO~O)QYO)X3eO~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(v#gO)T#mO)U#oO)V#nO)W#pO)X3fO)Y#|O~P#3zO)X3fO~O)X3iO~O!U3kO~P$JiOl$oO(s$nO~O]3mO!T'zO~P'+pO!T(RO!l3pO(w(QO])Pad)Pal)Par)Pas)Pat)Pau)Pav)Paw)Pax)Pay)Pa})Pa!V)Pa!r)Pa!s)Pa!t)Pa!u)Pa!v)Pa!x)Pa!{)Pa%w)Pa&s)Pa&t)Pa(s)Pa)T)Pa)V)Pa)W)Pa)X)Pa!O)Pa!X)Pa!Y)Pa![)Pa!^)Pa!_)Pa!a)Pa!b)Pa!c)Pa!e)Pa!f)Pa!h)Pa(v)Pa(x)Pa(y)Pa)U)Pa)Y)Pa!g)Pa)k)Pa!W)PaQ)Pa!d)Pa!U)Pa#v)Pa~Ol$oO!n.fO!o.fO(s$nO~O!h3tO)Y3vO!T)`X~O!o3xO)QYO~P8zO)X3yO~PGVO]4OOl(|O!T$WO!{!dO%w$mO&s#WO(s({O(w4SO)T3{O)V4PO)W4PO~O)X4TO)k4VO~P(&sOl;hO!U4XO!n.sO!o.rO#i-xO$|!tO%O!uO%h!{O%l-wO%p!|O%w!}O(s;ZO)QYO~P!8jOl;hO%w!}O(s;ZO~P!8jO(w4YO~Ol$oO!T(RO(s$nO(w(QO)QYO~O!l3pO~P()RO)k4[O!U&pX!h&pX~O!h4]O!U*RX~O!U4_O~Oa4aOl$oO&n!RO(s$nO~O!T([O]&lid&lil&lir&lis&lit&liu&liv&liw&lix&liy&li}&li!V&li!r&li!s&li!t&li!u&li!v&li!x&li!{&li%w&li&s&li&t&li(s&li)T&li)V&li)W&li)X&li!O&li!X&li!Y&li![&li!^&li!_&li!a&li!b&li!c&li!e&li!f&li!h&li(v&li(x&li(y&li)U&li)Y&li!g&li)k&li!W&liQ&li!d&li!U&li#v&li~O(w&li~P(*cO(w.xO~P(*cO!O4dO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|O~P#3zO!O4dO~O!O4eO~O]#}O!T$WO!V'[i!X'[i!Y'[i!['[i!^'[i!_'[i!a'[i!b'[i!c'[i!e'[i!f'[i!h'[i(v'[i(x'[i(y'[i)T'[i)U'[i)V'[i)W'[i)X'[i)Y'[i!g'[i)k'[i!O'[i!W'[i(w'[i!U'[iQ'[i!d'[i~OPmOa%QOl;OO!X!XO!Y!WO!i!YO#V#QO%`#ZO%a#[O%b#YO%w$mO'R!WO'S!WO'W#XO'Z![O'b![O'c![O(pQO(s$xO)Y!ZO)ZXO)icO)jdO]#]ap#]a!T#]a!V#]a)T#]a)V#]a)W#]a~O(s%nO)Y4jO!O*ZP~O*X4iO~O'g4lO*X4iO~O*X4mO~OlmXpnXp&xX~Od4oO%Z*UO(z/`O~Od4oO%Z*UO(z4pO~O!h/fO!O(ta~O!W4tO~O]&cO!V+lO!T%vq#v%vq)X%vq)k%vq~O]#}O!T$WO!X'[q!Y'[q!['[q!^'[q!_'[q!a'[q!b'[q!c'[q!e'[q!f'[q!h'[q(v'[q(x'[q(y'[q)T'[q)U'[q)V'[q)W'[q)X'[q)Y'[q!g'[q)k'[q!O'[q!W'[q(w'[q!U'[qQ'[q!d'[q~O!V'[q~P(5pO!V/QO&s#WO&t$wO~P(5pO!T$WO!V)sO(x)tO!U(VX!h(VX~P!JwO!h/qO!U)sa~O!W4|O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h*jO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|O~P#3zO!U5QO~P&7QO!W5QO~P&7QO!O5QO~P&7QO!O5VO~P&7QO]5WO!h'va)Y'va)^'va~O!h*PO)Y)Ri)^)Ri~O]&cO!V&bO!O#Qq!T#Qq!h#Qq#v#Qq)X#Qq)k#QqQ#Qq!d#Qq(w#Qq~O!OqiQqi!dqi!hqi)Yqi)Xqi~P#IkO]&cO!V+lO!OqiQqi!dqi!hqi)Yqi)Xqi~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|O!h'Uq)X'Uq!g'Uq)k'Uq!O'Uq!W'Uq(w'Uq!U'UqQ'Uq!d'Uq~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|O!W'}a!h'}a~P#3zO!W5]O~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h5^O(v#gO)T#mO)U#oO)V#nO)W#pO)X#jO)Y#|O!U)sX~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|O!h#{i)X#{i~P#3zO]*wO!T$WO!V&bO)k*sO!h(Wa)X(Wa~O!h1iO]'eX!O)eX~P%3PO)Y5`O!T%ra!h%ra#v%ra)k%ra~O!h0vO!T){a#v){a)k){a~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)X5cO)Y#|O~P#3zO]1VOd!POl;`O!V1TO!{!dO%w$mO(s$xO)T;|O)V5eO)W5eO~OQ#Pa!d#Pa!h#Pa!O#Pa~P(DxO]1VOd!POr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!V1TO!{!dO!|%RO%w$mO(s$xOQ#kX!d#kX!h#kX!O#kX~Ol%bO)T0}O)V;}O)W;}O~P(EzO]&cOQ#Pa!d#Pa!h#Pa!O#Pa~O!V&bO)k5iO~P(GiO(s%nOQ#dX!d#dX!h#dX!O#dX~O)V;}O)W;}OQ#nX!d#nX!h#nX!O#nX~P' kO!V+lO~P(GiO]1VOa!TOd!POl;aO{#RO!V1TO!{!dO#a#VO#b#TO%f#UO%m#SO%w$mO&n!RO&s#WO&t!TO(s;UO)QYO)T;|O)V5eO)W5eO)Y+oO!O)eP~P&?zO!h1WOQ)ma!d)ma~Op&fO)k5nOQ#`al)OX!d#`a!h#`a)Y)OX~P$GXO(s-VOQ#ga!d#ga!h#ga~Op&fO)k5nOQ#`a])_Xd)_Xl)_Xr)_Xs)_Xt)_Xu)_Xv)_Xw)_Xx)_Xy)_X})_X!T)_X!V)_X!d#`a!h#`a!l)_X!r)_X!s)_X!t)_X!u)_X!v)_X!x)_X!{)_X%w)_X&s)_X&t)_X(s)_X(w)_X)T)_X)V)_X)W)_X)Y)_X~O#a5qO#b5qO~O]&cO!V+lO!O#ki!T#ki#v#ki)X#ki)k#kiQ#ki!d#ki!h#ki)Y#ki!x#ki(w#ki~O!W5sO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|O~P#3zO!W5sO~P!(zO!W5sO)T5uO~P$%pO]#ji!T#ji!V#ji!O#ji#v#ji)X#ji)k#jiQ#ji!d#ji!h#ji)Y#ji!x#ji(w#ji~P$ xO)QYO)Y5wO~P8zO!h1iO!O)ea~O&s#WO&t$wO!T#qa!x#qa#v#qa(w#qa)k#qa!O#qa!h#qa)X#qaQ#qa!d#qa)Y#qa~P#NeO!O5|O~P!(zO!O)pP~P!4xO)U6SO)V6QO]#Ua!T#Ua!V#Ua)T#Ua)W#Uar#Uas#Uat#Uau#Uav#Uaw#Uax#Uay#Ua!l#Ua!x#Ua#T#Ua#V#Ua#p#Ua#v#Ua(w#Ua(y#Ua)k#Uaa#Uad#Ual#Ua{#Ua}#Ua!o#Ua!r#Ua!s#Ua!t#Ua!u#Ua!v#Ua!{#Ua#a#Ua#b#Ua#i#Ua#t#Ua$|#Ua%d#Ua%f#Ua%l#Ua%m#Ua%p#Ua%w#Ua&n#Ua&s#Ua&t#Ua(s#Ua)Q#Ua)X#Ua!O#Ua!h#UaQ#Ua!d#Ua~O!x!cO]#Rq!T#Rq!V#Rq#v#Rq(w#Rq)k#Rq!O#Rq!h#Rq)X#RqQ#Rq!d#Rq~O!W6XO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|O~P#3zO!W6XO~P!(zO!h2POQ({a!d({a~O)X6^O~Ol-hO!T'eO)k6_O~O]*wO!T$WO!V&bO!h*uO)X)rX~O)k6cO~P)+qO!O6eO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|O~P#3zO!O6eO~O$d6gOP$`q]$`qa$`qd$`ql$`qr$`qs$`qt$`qu$`qv$`qw$`qx$`qy$`q{$`q}$`q!T$`q!V$`q!X$`q!Y$`q!i$`q!o$`q!r$`q!s$`q!t$`q!u$`q!v$`q!x$`q!{$`q#V$`q#a$`q#b$`q#i$`q#p$`q#t$`q#v$`q$S$`q$U$`q$Z$`q$[$`q$a$`q$f$`q$h$`q$i$`q$l$`q$n$`q$p$`q$r$`q$t$`q$v$`q$x$`q$|$`q%O$`q%V$`q%`$`q%a$`q%b$`q%d$`q%f$`q%h$`q%m$`q%p$`q%w$`q%}$`q&n$`q&s$`q&t$`q'R$`q'S$`q'W$`q'Z$`q'b$`q'c$`q(l$`q(p$`q(s$`q)Q$`q)T$`q)V$`q)W$`q)X$`q)Y$`q)Z$`q)i$`q)j$`q!U$`q~O)X6hO~OPmO]$eOa!]Ol;PO{#RO!V$fO!X!XO!Y!WO!i!YO#V#QO#a#VO#b#TO%`#ZO%a#[O%b#YO%f#UO%m#SO%w$mO&n!RO&s#WO&t!TO'R!WO'S!WO'W#XO'Z![O'b![O'c![O(pQO(s;RO)T$kO)W$kO)X6jO)Y!ZO)ZXO)icO)jdO~P&?zO(w6lO)k*sO~P)+qO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)X6jO)Y#|O~P#3zO!O6nO~P!(zO)X6rO~O)X6sO~O]-ZOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!{!dO(s-VO)T-WO~O]&cO!V2xO!h%Pa)X%Pa!O%Pa~O!W6yO)T6zO~P$%pO!h2yO)X)va~O]&cO!O6}O!V2xO~O!TxO$a!iO$f!jO$h!kO$i!lO$l-cO$n!nO$p!oO$r!pO$t!qO$v!rO$x!sO%O!uO(s:rOd$Yq!o$Yq!{$Yq#i$Yq#p$Yq#t$Yq#v$Yq$S$Yq$U$Yq$Z$Yq$[$Yq$|$Yq%V$Yq%d$Yq%h$Yq%p$Yq%}$Yq(l$Yq)V$Yq!U$Yq$d$Yq~P$0kOPmO]$eOa!]Ol;PO{#RO!V$fO!X!XO!Y!WO!i!YO#V#QO#a#VO#b#TO%`#ZO%a#[O%b#YO%f#UO%m#SO%w$mO&n!RO&s#WO&t!TO'R!WO'S!WO'W#XO'Z![O'b![O'c![O(pQO(s;RO)QYO)T$kO)W$kO)X7PO)Y!ZO)ZXO)icO)jdO~P&?zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)X7SO)Y#|O~P#3zO)X7TO~OP7UO(pQO~Ol*]O)X)_X~P$GXOp&fOl)OX)X)_X~P$GXO)X7WO~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|O)X&Ta~P#3zO!U7YO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|O~P#3zO)X7ZO~OPmO]$eOa!]Ol;QO{#RO!V$fO!X!XO!Y!WO!i!YO#V#QO#a#VO#b#TO%`#ZO%a#[O%b#YO%f#UO%m#SO%w$mO&n!RO&s#WO&t!TO'R!WO'S!WO'W#XO'Z![O'b![O'c![O(pQO(s;YO)QYO)T$kO)W$kO)Y0qO)ZXO)icO)jdO!O)eP~P&?zO!h3tO)Y7_O!T)`a~O!h3tO!T)`a~O)X7dO)k7fO~P(&sO)X7hO~PGVO]4OOl(|Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!{!dO!|%RO%w$mO&s#WO(s({O)T3{O)V4PO)W4PO~O)T7lO~O]&cO!T*rO!V7nO!h7oO#v!eO(w4SO~O)X7dO)k7qO~P)GVO]4OOl(|O!{!dO%w$mO&s#WO(s({O)T3{O)V4PO)W4PO~Op&fO])dX!T)dX!V)dX!h)dX#v)dX(w)dX)X)dX)k)dX!O)dX~O)X7dO~O!T(RO!l7wO(w(QO])Pid)Pil)Pir)Pis)Pit)Piu)Piv)Piw)Pix)Piy)Pi})Pi!V)Pi!r)Pi!s)Pi!t)Pi!u)Pi!v)Pi!x)Pi!{)Pi%w)Pi&s)Pi&t)Pi(s)Pi)T)Pi)V)Pi)W)Pi)X)Pi!O)Pi!X)Pi!Y)Pi![)Pi!^)Pi!_)Pi!a)Pi!b)Pi!c)Pi!e)Pi!f)Pi!h)Pi(v)Pi(x)Pi(y)Pi)U)Pi)Y)Pi!g)Pi)k)Pi!W)PiQ)Pi!d)Pi!U)Pi#v)Pi~O(s%nO!U(gX!h(gX~O!h4]O!U*Ra~Op&fO]*Qad*Qal*Qar*Qas*Qat*Qau*Qav*Qaw*Qax*Qay*Qa}*Qa!T*Qa!V*Qa!r*Qa!s*Qa!t*Qa!u*Qa!v*Qa!x*Qa!{*Qa%w*Qa&s*Qa&t*Qa(s*Qa)T*Qa)V*Qa)W*Qa)X*Qa!O*Qa!X*Qa!Y*Qa![*Qa!^*Qa!_*Qa!a*Qa!b*Qa!c*Qa!e*Qa!f*Qa!h*Qa(v*Qa(x*Qa(y*Qa)U*Qa)Y*Qa!g*Qa)k*Qa!W*QaQ*Qa!d*Qa(w*Qa!U*Qa#v*Qa~O!T([O]&lqd&lql&lqr&lqs&lqt&lqu&lqv&lqw&lqx&lqy&lq}&lq!V&lq!r&lq!s&lq!t&lq!u&lq!v&lq!x&lq!{&lq%w&lq&s&lq&t&lq(s&lq)T&lq)V&lq)W&lq)X&lq!O&lq!X&lq!Y&lq![&lq!^&lq!_&lq!a&lq!b&lq!c&lq!e&lq!f&lq!h&lq(v&lq(x&lq(y&lq)U&lq)Y&lq!g&lq)k&lq!W&lqQ&lq!d&lq(w&lq!U&lq#v&lq~OPmOa%QOl;OO!T$WO!i!YO#V#QO%`#ZO%a#[O%b#YO%w$mO'R!WO'S!WO'W#XO'Z![O'b![O'c![O(pQO(s$xO)ZXO)icO)jdO~O]*Vi!V*Vi!X*Vi!Y*Vi![*Vi!^*Vi!_*Vi!a*Vi!b*Vi!c*Vi!e*Vi!f*Vi!h*Vi(v*Vi(x*Vi(y*Vi)T*Vi)U*Vi)V*Vi)W*Vi)X*Vi)Y*Vi!g*Vi)k*Vi!O*Vi!W*Vi(w*Vi!U*ViQ*Vi!d*Vi~P*&fO!O7|O~O!W7}O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|O~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|O!h'_q)X'_q!g'_q)k'_q!O'_q!W'_q(w'_q!U'_qQ'_q!d'_q~P#3zO!h8OO!O*ZX~O!O8QO~O*X8RO~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|O!h^y)X^y!g^y)k^y!O^y!W^y(w^y!U^yQ^y!d^y~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|O!O(ia!h(ia~P#3zO]#}O!T$WO!V'[y!X'[y!Y'[y!['[y!^'[y!_'[y!a'[y!b'[y!c'[y!e'[y!f'[y!h'[y(v'[y(x'[y(y'[y)T'[y)U'[y)V'[y)W'[y)X'[y)Y'[y!g'[y)k'[y!O'[y!W'[y(w'[y!U'[yQ'[y!d'[y~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|O!h'_y)X'_y!g'_y)k'_y!O'_y!W'_y(w'_y!U'_yQ'_y!d'_y~P#3zO]&cO!V+lO!T%vy#v%vy)X%vy)k%vy~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|O!U(Va!h(Va~P#3zO!W4|O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|O~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|O!U#}i!h#}i~P#3zO!U8TO~P&7QO!W8TO~P&7QO!O8TO~P&7QO!O8VO~P&7QO]&cO!V&bO!O#Qy!T#Qy!h#Qy#v#Qy)X#Qy)k#QyQ#Qy!d#Qy(w#Qy~O]&cO!V+lO!OqqQqq!dqq!hqq)Yqq)Xqq~O]&cOQ#Pi!d#Pi!h#Pi!O#Pi~O!V+lO~P*9xOQ#nX!d#nX!h#nX!O#nX~P(DxO!V&bO~P*9xOQ(PX](PXd'rXl'rXr(PXs(PXt(PXu(PXv(PXw(PXx(PXy(PX!V(PX!d(PX!h(PX!{'rX%w'rX(s'rX)T(PX)V(PX)W(PX!O(PX~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|OQ#_i!d#_i!h#_i!O#_i~P#3zO&s#WO&t$wOQ#fi!d#fi!h#fi~O(s-VO)Y1]O)k1[OQ#`X!d#`X!h#`X~O!W8[O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|O~P#3zO!W8[O~P!(zO!T#qi!x#qi#v#qi(w#qi)k#qi!O#qi!h#qi)X#qiQ#qi!d#qi)Y#qi~O]&cO!V+lO~P*?tO]&YO!V&WO&s#WO&t$wO)T&VO)V&ZO)W&ZO~P*?tO!O8^O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|O~P#3zO!h8_O!O)pX~O!O8aO~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|OQ*UX!d*UX!h*UX~P#3zO)Y8dOQ*TX!d*TX!h*TX~O)X8fO~O!O$ci!h#{a)X#{a~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)X8iO)Y#|O~P#3zO!O8kO~P!(zO!O8kO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|O~P#3zO!O8kO~O]&cO!V&bO(w8qO~O)X8rO~O]&cO!V2xO!h%Pi)X%Pi!O%Pi~O!W8uO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|O~P#3zO!W8uO)T8wO~P$%pO!W8uO~P!(zO]&cO!V2xO!h(Za)X(Za~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(v#gO)T#mO)U#oO)V#nO)W#pO)X8xO)Y#|O~P#3zO)X2lO~P!(zO)X8xO~OP%oO!O8yO(pQO~O!O8yO~O)X8zO~P%%lO#T8}O(y.SO)X8{O~O!h3tO!T)`i~O)Y9RO!T'xa!h'xa~O)X9TO)k9VO~P)GVO)X9TO~O)X9TO)k9ZO~P(&sOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O~P)GuO]&cO!V7nO!T!ya!h!ya#v!ya(w!ya)X!ya)k!ya!O!ya~O!W9bO)T9cO~P$%pO!T$WO!h7oO(w4SO)X9TO)k9ZO~O!T$WO~P#EfO]&cO!O9fO!V7nO~O]&cO!V7nO!T&ba!h&ba#v&ba(w&ba)X&ba)k&ba!O&ba~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|O)X&ca~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)X9TO)Y#|O~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|O!U&pi!h&pi~P#3zO!V/QO]'^i!T'^i!X'^i!Y'^i!['^i!^'^i!_'^i!a'^i!b'^i!c'^i!e'^i!f'^i!h'^i(v'^i(x'^i(y'^i)T'^i)U'^i)V'^i)W'^i)X'^i)Y'^i!g'^i)k'^i!O'^i!W'^i(w'^i!U'^iQ'^i!d'^i~O(s%nO)Y9iO~O!h8OO!O*Za~O!O9kO~P&7QO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|O!U(Va)X#Zi~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|OQ#_q!d#_q!h#_q!O#_q~P#3zO&s#WO&t$wOQ#fq!d#fq!h#fq~O)k5nOQ#`a!d#`a!h#`a~O]&cO!V+lO!T#qq!x#qq#v#qq(w#qq)k#qq!O#qq!h#qq)X#qqQ#qq!d#qq)Y#qq~O!h8_O!O)pa~O)V6QO]&Wi!T&Wi!V&Wi)T&Wi)U&Wi)W&Wir&Wis&Wit&Wiu&Wiv&Wiw&Wix&Wiy&Wi!l&Wi!x&Wi#T&Wi#V&Wi#p&Wi#v&Wi(w&Wi(y&Wi)k&Wia&Wid&Wil&Wi{&Wi}&Wi!o&Wi!r&Wi!s&Wi!t&Wi!u&Wi!v&Wi!{&Wi#a&Wi#b&Wi#i&Wi#t&Wi$|&Wi%d&Wi%f&Wi%l&Wi%m&Wi%p&Wi%w&Wi&n&Wi&s&Wi&t&Wi(s&Wi)Q&Wi)X&Wi!O&Wi!h&WiQ&Wi!d&Wi~O)X9nO~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|O!O$cq!h#{i)X#{i~P#3zO!O9pO~P!(zO!O9pO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|O~P#3zO!O9pO~O]&cO!V&bO(w9sO~O!O9tO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|O~P#3zO!O9tO~O]&cO!V2xO!h%Pq)X%Pq!O%Pq~O!W9xO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|O~P#3zO!W9xO~P!(zO)X6jO~P!(zO)X9yO~O)X9zO~O(y.SO)X9zO~O!h3tO!T)`q~O)Y9|O!T'xi!h'xi~O!T$WO!h7oO(w4SO)X9}O)k:PO~O)X9}O~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)X9}O)Y#|O~P#3zO)X9}O)k:SO~P)GVO]&cO!V7nO!T!yi!h!yi#v!yi(w!yi)X!yi)k!yi!O!yi~O!W:WO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|O~P#3zO!W:WO)T:YO~P$%pO!W:WO~P!(zO]&cO!V7nO!T(ea!h(ea(w(ea)X(ea)k(ea~O!O:[O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|O~P#3zO!O:[O~O!O:aO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|O~P#3zO!O:aO~O]&cO!V2xO!h%Py)X%Py!O%Py~O)X:bO~O)X:cO~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)X:cO)Y#|O~P#3zO!T$WO!h7oO(w4SO)X:cO)k:fO~O]&cO!V7nO!T!yq!h!yq#v!yq(w!yq)X!yq)k!yq!O!yq~O!W:hO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|O~P#3zO!W:hO~P!(zO!O:jO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)Y#|O~P#3zO!O:jO~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)X:lO)Y#|O~P#3zO)X:lO~O]&cO!V7nO!T!yy!h!yy#v!yy(w!yy)X!yy)k!yy!O!yy~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(v#gO)T#mO)U#oO)V#nO)W#pO)X:pO)Y#|O~P#3zO)X:pO~O]ZXlgXpZXpiX!TiX!VZX!XZX!YZX![ZX!^ZX!_ZX!aZX!bZX!cZX!eZX!fZX!gZX!hZX(vZX(w$^X(xZX(yZX)TZX)UZX)VZX)WZX)XZX)YZX)kZX~O]%XXlmXpnXp%XX!TnX!V%XX!X%XX!Y%XX![%XX!^%XX!_%XX!a%XX!b%XX!c%XX!e%XX!f%XX!gmX!h%XX(v%XX(x%XX(y%XX)T%XX)U%XX)V%XX)W%XX)Y%XX)kmX!O%XXQ%XX!d%XX~O)X%XX!W%XX(w%XX!U%XX~P+HQO]nX]%XXdnXlmXpnXp%XXrnXsnXtnXunXvnXwnXxnXynX}nX!VnX!V%XX!rnX!snX!tnX!unX!vnX!xnX!{nX%wnX&snX&tnX(snX)TnX)VnX)WnX!OnX!O%XX!hnX)YnX~O)XnX)knX~P+JbO]%XXlmXpnXp%XX!V%XX!h%XXQ%XX!d%XX!O%XX~O!T%XX#v%XX)X%XX)k%XX(w%XX~P+L{OQnXQ%XX!TnX!X%XX!Y%XX![%XX!^%XX!_%XX!a%XX!b%XX!c%XX!dnX!d%XX!e%XX!f%XX!gmX!h%XX(v%XX(x%XX(y%XX)T%XX)U%XX)V%XX)W%XX)Y%XX)kmX~P+JbO]nX]%XXlmXpnXp%XXrnXsnXtnXunXvnXwnXxnXynX}nX!V%XX!rnX!snX!tnX!unX!vnX!xnX!{nX%wnX&snX&tnX(snX)TnX)VnX)WnX~O!TnX(wnX)XnX)knX~P, sOdnX!VnX)X%XX~P, sOlmXpnX)X%XX~Od)pO%Z)qO(z:sO~Od)pO%Z)qO(z:xO~Od)pO%Z)qO(z:tO~Od$RO%Z*UO']$TO'`$UO(z:sO~Od$RO%Z*UO']$TO'`$UO(z:uO~Od$RO%Z*UO']$TO'`$UO(z:wO~O]iXriXsiXtiXuiXviXwiXxiXyiX!OiX!ViX&siX&tiX)TiX)ViX)WiXdiX}iX!riX!siX!tiX!uiX!viX!xiX!{iX%wiX(siX~P#1jO]ZXlgXpZXpiX!VZX!hZX)XZX)kZX~O!TZX#vZX(wZX~P,(ZOlgXpiX)QiX)XZX)kiX~O]ZX]iXdiXlgXpZXpiXriXsiXtiXuiXviXwiXxiXyiX}iX!VZX!ViX!riX!siX!tiX!uiX!viX!xiX!{iX%wiX&siX&tiX(siX)TiX)ViX)WiX!OZX!OiX!hiX)YiX)kiX~O)XZX~P,)eO]ZX]iXlgXpZXpiXriXsiXtiXuiXviXwiXxiXyiX!TiX!VZX!ViX!XZX!YZX![ZX!^ZX!_ZX!aZX!bZX!cZX!eZX!fZX!gZX!hZX!hiX&siX&tiX(vZX(xZX(yZX)TZX)TiX)UZX)VZX)ViX)WZX)WiX)YZX)YiX)kZX~OQZXQiX!dZX!diX~P,,OO]iXdiXriXsiXtiXuiXviXwiXxiXyiX}iX!ViX!riX!siX!tiX!uiX!viX!xiX!{iX%wiX&siX&tiX(siX)TiX)ViX)WiX~P#1jO]ZX]iXdiXlgXpZXpiXriXsiXtiXuiXviXwiXxiXyiX}iX!VZX!ViX!riX!siX!tiX!uiX!viX!xiX!{iX%wiX&siX&tiX(siX)TiX)ViX)WiX~O)XiX~P,1QOdiX}iX!OZX!OiX!riX!siX!tiX!uiX!viX!xiX!{iX%wiX(siX)kiX~P,,OO]ZX]iXlgXpZXpiXriXsiXtiXuiXviXwiXxiXyiX}iX!TiX!VZX!riX!siX!tiX!uiX!viX!xiX!{iX%wiX&siX&tiX(siX(wiX)TiX)ViX)WiX)XiX)kiX~Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O~PBUOd$RO%Z*UO(z:sO~Od$RO%Z*UO(z:tO~Od$RO%Z*UO(z:zO~Od$RO%Z*UO(z:yO~O]%hOd!POl%bOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!V%kO!{!dO!|%RO%w$mO(s$xO)T;eO)V;fO)W;fO~O]%hOd!POl%bO!V%kO!{!dO%w$mO(s$xO)T;eO)V;fO)W;fO~Od$RO%Z$SO(z:tO~Od$RO%Z$SO(z:xO~Ol:}O~Ol:|O~O]cXlgXpiX!TcX~Od)pO%Z*UO(z:sO~Od)pO%Z*UO(z:tO~Od)pO%Z*UO(z:uO~Od)pO%Z*UO(z:vO~Od)pO%Z*UO(z:wO~Od)pO%Z*UO(z:yO~Od)pO%Z*UO(z:zO~Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O~P,9^O])OXr)OXs)OXt)OXu)OXv)OXw)OXx)OXy)OX})OX!r)OX!s)OX!t)OX!u)OX!v)OX!x)OX!{)OX%w)OX&s)OX&t)OX(s)OX)T)OX)V)OX)W)OX)k)OX~Ol:|O!T)OX(w)OX)X)OX~P,=]O]&xXlmXpnX!T&xX~Od4oO%Z*UO(z;xO~Ol;`O)T;|O)V5eO)W5eO~P(EzOd!POl%bO!{!dO%w$mO(s$xO~O]1VO!V1TO)T0}O)V;}O)W;}OQ#nX!d#nX!h#nX!O#nX~P,@XO)T;^O~Ol;lO~Ol;mO~Ol;nO~Ol;pO~Ol;qO~Ol;rO~Ol;pO!T$WOQ)OX!d)OX!h)OX)Y)OX!O)OX)k)OX~P$GXOl;nO!T$WO~P$GXOl;lO!g$YO)k$YO~Ol;nO!g$YO)k$YO~Ol;pO!g$YO)k$YO~Ol;mO!O)OX!h)OX)Y)OX)k)OX~P$GXOd/aO%Z*UO(z;xO~Ol;yO~O)T<^O~OV'f'i'j'h(p)Z!R(sST%[!Y!['kd%]!i'S!f]'g*['l(x!^!_'m'n'm~\",\n  goto: \"%8]*[PPPPPP*]P*`PP.W4nP7o7o:{P:{>XP>r?U?jFdMf!&l!-UP!4Q!4u!5jP!6UPPPPPPPP!6oP!8ZPP!9n!;YP!;`PPPPPP!;cP!;cPP!;cPPPPPPPPP!;o!?XP!?[PP!?x!@mPPPPP!@qP>u!BUPP>u!D_!F`!Fn!HV!IxP!JTP!Jd!Jd!Mv##X#$q#(P#+]!F`#+gPP!F`#+n#+t#+g#+g#+wP#+{#,j#,j#,j#,j!IxP#-T#-f#/lP#0SP#1qP#1u#2P#2v#3R#5a#5i#5i#5p#1uP#1uP#6U#6[P#6fPP#7T#7t#8h#7TP#9[#9hP#7TP#7TPP#7T#7TP#7TP#7TP#7TP#7TP#7TP#7TP#9k#6f#:ZP#:rP#;Z#;Z#;Z#;Z#;h#1uP#<Q#AO#AmPPPPPPPP#BeP#BuP#BuP#CT#Fd#:hPP#Bo#FxP#G_#Gj#Gp#Gp#Bo#HfP#1u#1u#1u#1u#1uP!Jd#IS#IZ#IZ#IZ#I_!Mp#Ii!Mp#Im!Fn!Fn!Fn#Ip#N[!Fn>u>u>u$%V!@m!@m!@m!@m!@m!@m!6o!6o!6o$%jP$'X$'g!6o$'mPP!6o$)}$*Q#B[$*T:{7o$-]$/W$0w$2g7oPP7o$4Z7oP7o7oP7oP$7c7oP7oPP7o$7oPPPPPPPPP*]P$:y$;P$=h$?p$?v$@^$@h$@s$AS$AY$Bj$Ci$Cp$Cw$C}$DV$Da$Dg$Dv$D|$EV$E_$Ej$Ep$Ez$FQ$F[$Fc$Ft$Fz$GQP$GW$G`$Gg$Gu$Ie$Ik$Iq$Ix$JRPPPPPPPP$JX$J]PPPPP%#a$)}%#d%&n%(xP%)V%)YPPPPPPPPPP%)f%*i%*o%*s%,l%-{%.n%.u%1W%1^PPP%1h%1s%1v%1|%3T%3W%3d%3n%3r%4x%5m%5s#BeP%6^%6p%6s%7V%7e%7i%7o%7u$)}$*Q$*Q%7x%7{P%8V%8YR#cP'dmO[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'e'j'k'z(a(c(j)m)s*i*j*m*r*s*w+X+Z+i+k+l,Q,S,o,r,x-^-_-b-f-j.S.T.X/Q/T/_/f/o/q/v/x0k1O1T1d1e1o1s1}2P2f2i2l2x2}3Q3m4S4V4[4e5^5i5u6c6g6j6l6n6x6z7P7f7n7q8i8k8q8w8x9V9Z9a9c9p9s9t:P:S:Y:[:a:f:jU%om%p7UQ&m!`Q(k#]d0S*O0P0Q0R0U5R5S5T5W8UR7U3Xf}Oaewx{!g&S'e*r-f&v$i[!W!X!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$e$f$k%]%m&Q&W&b&f&x&y&|'O'P'b'j'k'z(a(c(j)m)s*i*j*m*s*w+X+Z+i+k+l,Q,S,o,r,x-^-_-b-j.S.T.X/Q/T/_/f/o/q/v/x1O1d1e1o1s1}2P2f2i2l2x2}3Q3m4S4V4[4e5^5i5u6c6g6j6l6n6x6z7P7f7n7q8i8k8q8w8x9V9Z9a9c9p9s9t:P:S:Y:[:a:f:jS%`f0k#d%jgnp|#O$g$|$}%S%d%h%i%w&s'u'v(R*Z*a*c*u+^,m,w-`-s-z.i.p.r0`0|0}1R1V2b2m5e6k;[;];^;d;e;f;s;t;u;v;z;{;|;}<[<]<^S%qm!YS&u!h#PQ']!tQ'h!yQ'i!zQ(k#`Q(l#]Q(m#^Q*y%kQ,X&lQ,^&nQ-T'^Q-g'gQ-n'rS.u([4]Q/i)hQ0h*nQ2T,]Q2[,dQ3S-hQ4f/PQ4j/WQ5j1QQ6`2WQ7R3TQ8e6_Q9i8OR;_1T$|#hS!]$y%Q%T%Z&j&k'Q'X'Z'a'c(b(f(i(x(y)S)T)U)V)W)X)Y)Z)[)])^)_)`)l)r)y+Y+h,P,T,k,v-k-l.P.|/s0c0e0j0l0z1c1|2d2k3V3g3h4g4h4n4q4w4y4}5O5h5t5{6Y6i6m6w7O7u7v7x8W8X8g8j8n8v9X9`9o9u:Q:X:^:d:mQ&p!dQ(h#ZQ(t#bQ)k$T[*t%e*X0n2c2j3OQ,_&oQ/R(gQ/V(lQ/^(uS/l)j/SQ0u+RS4u/m/nR8S4v'e![O[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'e'j'k'z(a(c(j)m)s*i*j*m*r*s*w+X+Z+i+k+l,Q,S,o,r,x-^-_-b-f-j.S.T.X/Q/T/_/f/o/q/v/x0k1O1T1d1e1o1s1}2P2f2i2l2x2}3Q3m4S4V4[4e5^5i5u6c6g6j6l6n6x6z7P7f7n7q8i8k8q8w8x9V9Z9a9c9p9s9t:P:S:Y:[:a:f:j'e!VO[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'e'j'k'z(a(c(j)m)s*i*j*m*r*s*w+X+Z+i+k+l,Q,S,o,r,x-^-_-b-f-j.S.T.X/Q/T/_/f/o/q/v/x0k1O1T1d1e1o1s1}2P2f2i2l2x2}3Q3m4S4V4[4e5^5i5u6c6g6j6l6n6x6z7P7f7n7q8i8k8q8w8x9V9Z9a9c9p9s9t:P:S:Y:[:a:f:jQ)P#kS+R%y0vQ/u)tk4R.j3w3{4O4P7g7i7j7l7o9]9^:VQ)R#kk4Q.j3w3{4O4P7g7i7j7l7o9]9^:Vl)Q#k.j3w3{4O4P7g7i7j7l7o9]9^:VT+R%y0v`UOwx!g&S'e*r-fW$`[e$e(c#l$p_!f!u!}#R#S#T#U#V#Z$S$T$l%U&U&Y&c&m'_(O(Q(V(_(h)k)q+]+b+c+u+z,Y,l,{-R-r-w.Z.[.b.c.g.t.x1W1[1i1n1p2o3`3a3b3t3x5n6R6T7`8_![%cg$g%d%i&s*Z*u+^,m,w-`0}1R2b;[;];^;e;f;s;t;u;v;z;{;}<[<]<^Y%snp%w-s.il(}#k.j3w3{4O4P7g7i7j7l7o9]9^:VS;i'u-zU;j(R.p.r&|<Paf{|!W!X!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$f$k$|$}%S%]%h%m&Q&W&b&y&|'O'j'k'v'z(a(j)m)s*a*c*i*j*m*s+X+Z+i+k+l,Q,S,o,r-j.S.T.X/Q/T/_/f/o/q/v/x0`0k0|1O1T1d1e1o1s1}2f2l2m2x4S4V4[4e5^5e5i5u6c6g6j6k6l6n6x6z7P7f7n7q8i8k8q8w8x9V9Z9a9c9p9s9t:P:S:Y:[:a:f:j;d;|Q<Q1Vd<R&x'P'b,x-^-_-b2i2}3QW<S&f*w2P3mQ<T#O[<U!t'^'g,]2W6_T<a%y0v`VOwx!g&S'e*r-fW$a[e$e(cQ$p.x!j$q_!f!u!}#V#Z$S$T$l%U&U&Y&c&m'_(h)k)q+]+b+u,Y,l,{-R-r.g1W1[1i1n1p2o3x5n8_&^$zaf{!W!X!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$f$k%]%m&Q&W&b&y&|'O'j'k'z(a(j)m)s*i*j*m*s+X+Z+i+k+l,Q,S,o,r-j.S.T.X/Q/T/_/f/o/q/v/x0k1O1T1d1e1o1s1}2f2l2x4S4V4[4e5^5i5u6c6g6j6l6n6x6z7P7f7n7q8i8k8q8w8x9V9Z9a9c9p9s9t:P:S:Y:[:a:f:j![%cg$g%d%i&s*Z*u+^,m,w-`0}1R2b;[;];^;e;f;s;t;u;v;z;{;}<[<]<^Y%snp%w-s.iQ's#O|'}#R#S#T#U(O(Q(V(_+c+z.Z.[.b.c.t3`3a3b3t6R6T7`l(}#k.j3w3{4O4P7g7i7j7l7o9]9^:VS-q'u-zQ3[-wU;w(R.p.rn<P|$|$}%S%h'v*a*c0`0|2m5e6k;d;|[<U!t'^'g,]2W6_W<V&f*w2P3md<W&x'P'b,x-^-_-b2i2}3QQ<_1VT<a%y0v!U!UO[ewx!g$e&S&f&x'P'b'e(c*r*w,x-^-_-b-f2P2i2}3Q3m!v$t_!f!u!}#O#V#Z$S$T$l%U&U&Y&c&m'_'u(R(h)k)q+]+u,Y,l,{-R-r-z.g.p.r1V1W1[1i1n1p2o3x5n8_&^%Paf{!W!X!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$f$k%]%m&Q&W&b&y&|'O'j'k'z(a(j)m)s*i*j*m*s+X+Z+i+k+l,Q,S,o,r-j.S.T.X/Q/T/_/f/o/q/v/x0k1O1T1d1e1o1s1}2f2l2x4S4V4[4e5^5i5u6c6g6j6l6n6x6z7P7f7n7q8i8k8q8w8x9V9Z9a9c9p9s9t:P:S:Y:[:a:f:j$Q%lgnp|#k$g$|$}%S%d%h%i%w%y&s'^'g'v*Z*a*c*u+^,],m,w-`-s.i.j0`0v0|0}1R2W2b2m3w3{4O4P5e6_6k7g7i7j7l7o9]9^:V;[;];^;d;e;f;s;t;u;v;z;{;|;}<[<]<^Q'[!tz(P#R#S#T#U(O(Q(V(_+z.Z.[.b.c.t3`3a3b3t6R6T7`f-['`-U-W-Z2s2t2v2y6u6v8tQ1Z+bQ1^+cQ2n,zQ3]-wQ4`.xQ5p1]R8Z5q!U!UO[ewx!g$e&S&f&x'P'b'e(c*r*w,x-^-_-b-f2P2i2}3Q3m!x$t_!f!u!}#O#V#Z$S$T$l%U&U&Y&c&m'_'u(R(h)k)q+]+b+u,Y,l,{-R-r-z.g.p.r1V1W1[1i1n1p2o3x5n8_&^%Paf{!W!X!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$f$k%]%m&Q&W&b&y&|'O'j'k'z(a(j)m)s*i*j*m*s+X+Z+i+k+l,Q,S,o,r-j.S.T.X/Q/T/_/f/o/q/v/x0k1O1T1d1e1o1s1}2f2l2x4S4V4[4e5^5i5u6c6g6j6l6n6x6z7P7f7n7q8i8k8q8w8x9V9Z9a9c9p9s9t:P:S:Y:[:a:f:j$S%lgnp|!t#k$g$|$}%S%d%h%i%w%y&s'^'g'v*Z*a*c*u+^,],m,w-`-s.i.j0`0v0|0}1R2W2b2m3w3{4O4P5e6_6k7g7i7j7l7o9]9^:V;[;];^;d;e;f;s;t;u;v;z;{;|;}<[<]<^|(P#R#S#T#U(O(Q(V(_+c+z.Z.[.b.c.t3`3a3b3t6R6T7`Q3]-wR4`.x`WOwx!g&S'e*r-fW$b[e$e(c#l$p_!f!u!}#R#S#T#U#V#Z$S$T$l%U&U&Y&c&m'_(O(Q(V(_(h)k)q+]+b+c+u+z,Y,l,{-R-r-w.Z.[.b.c.g.t.x1W1[1i1n1p2o3`3a3b3t3x5n6R6T7`8_![%cg$g%d%i&s*Z*u+^,m,w-`0}1R2b;[;];^;e;f;s;t;u;v;z;{;}<[<]<^Y%snp%w-s.il(}#k.j3w3{4O4P7g7i7j7l7o9]9^:VS;i'u-zU;j(R.p.rn<P|$|$}%S%h'v*a*c0`0|2m5e6k;d;|Q<Q1VQ<T#O[<U!t'^'g,]2W6_&^<Xaf{!W!X!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$f$k%]%m&Q&W&b&y&|'O'j'k'z(a(j)m)s*i*j*m*s+X+Z+i+k+l,Q,S,o,r-j.S.T.X/Q/T/_/f/o/q/v/x0k1O1T1d1e1o1s1}2f2l2x4S4V4[4e5^5i5u6c6g6j6l6n6x6z7P7f7n7q8i8k8q8w8x9V9Z9a9c9p9s9t:P:S:Y:[:a:f:jd<Y&x'P'b,x-^-_-b2i2}3QW<Z&f*w2P3mT<a%y0vp$PT$_$o%b%r(|;O;P;Q;`;a;b;c;g;h<`o)n$V*V*]/b:{:|:};l;m;n;o;p;q;r;yp$QT$_$o%b%r(|;O;P;Q;`;a;b;c;g;h<`o)o$V*V*]/b:{:|:};l;m;n;o;p;q;r;y^&e}!O$i$j%`%j;_d&i!U$t%P%l'[(P1Z1^3]4`V/d)P)Q4RS%Ye$eQ,U&fQ/O(cQ2p-RQ5}1pQ6Z2PQ6q2oR9l8_$R!TO[_ewx!f!g!u!}#O#V#Z$S$T$e$l%U&S&U&Y&c&f&m&x'P'_'b'e'u(R(c(h)k)q*r*w+]+b+u,Y,l,x,{-R-^-_-b-f-r-w-z.g.p.r1V1W1[1i1n1p2P2i2o2}3Q3m3x5n8_#`^O[_`wx!f!g!}#O$S$d$l$s$u&S&U&Y&c&m&r&x'P'b'e'u(R)q*^*r*w+],Y,l,x,{-^-_-b-f-r-w-z.g.p.r1V1W1i2i2}3Q3m3x_(V#R#S#T+c3`3a3b$RZO[wx!g!k#R#S#T%m&S&U&Y&c&m&w&x&y&|'O'P'['b'e'u'y(O(Q(R(V*r*w+]+c,Y,i,l,r-Q-^-_-b-f-r-w-z-}.b.g.p.t1V1W1i2f2n2}3Q3`3a3b3m6g6n8k9p9t:[:a:jQ$]YR0W*PR*R$]e0S*O0P0Q0R0U5R5S5T5W8U'd!YO[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'e'j'k'z(a(c(j)m)s*i*j*m*r*s*w+X+Z+i+k+l,Q,S,o,r,x-^-_-b-f-j.S.T.X/Q/T/_/f/o/q/v/x0k1O1T1d1e1o1s1}2P2f2i2l2x2}3Q3m4S4V4[4e5^5i5u6c6g6j6l6n6x6z7P7f7n7q8i8k8q8w8x9V9Z9a9c9p9s9t:P:S:Y:[:a:f:je0S*O0P0Q0R0U5R5S5T5W8UR5X0W^(U#R#S#T+c3`3a3bY.`(O(S(V(W7XU3o.^.a.tS7]3p4ZR9g7w^(T#R#S#T+c3`3a3b[._(O(S(U(V(W7XW3n.^.`.a.tU7[3o3p4ZS9O7]7wR:Z9gT.n(R.ph]Owx!g&S'e'u(R*r-f-z.p!v^[_`!f!}#O$S$d$l$s$u&U&Y&c&m&r&x'P'b)q*^*w+],Y,l,x,{-^-_-b-r-w.g.r1V1W1i2i2}3Q3m3xQ%tnT1x,O1y!nbOaenpwx{|!g#O$|$}%S%h%w&S'e'u'v(R*a*c*r-f-s-z.i.p.r0`0|1V2m5e6k;d;|f-X'`-U-W-Z2s2t2v2y6u6v8tj3|.j3w3{4O4P7g7i7j7l7o9]9^:Vr<Og$g%d%i&s*Z*u,m,w-`2b;[;];^;s;u;zi<b+^0}1R;e;f;t;v;{;}<[<]<^!O&^y%X&V&Y&Z'l)i*e*g+^+f+y/p0a0|0}1R1V1m5e5z;|;}z&az%O%W%e&d't*X*`,c-{0^0_0n1P2c2j3O5Z5f6p8mS'|#Q.[n+m&X*h+g+n+q-m/k0b1U1a4x5[5d5y8]Q2Z,b^2w-Y2u2{6t6{8s9we7m3}7c7k7s7t9Y9[9d:U:gS+_&U1WY+o&Y&c*w1V3mR5w1i#{!POaegnpwx{|!g#O$g$|$}%S%d%h%i%w&S&s'e'u'v(R*Z*a*c*r*u+^,m,w-`-f-s-z.i.p.r0`0|0}1R1V2b2m5e6k;[;];^;d;e;f;s;t;u;v;z;{;|;}<[<]<^doOwx!g&S'e'u*r-f-z#U!Paeg{|#O$g$|$}%S%d%h%i&s'v*Z*a*c*u+^,m,w-`0`0|0}1R1V2b2m5e6k;[;];^;d;e;f;s;t;u;v;z;{;|;}<[<]<^U%vnp-sQ+O%wS.h(R.pT3z.i.rW+s&^+m+t1fV+{&a+|7mQ+y&`U+{&a+|7mQ-z'uT.V'z.X'd![O[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'e'j'k'z(a(c(j)m)s*i*j*m*r*s*w+X+Z+i+k+l,Q,S,o,r,x-^-_-b-f-j.S.T.X/Q/T/_/f/o/q/v/x0k1O1T1d1e1o1s1}2P2f2i2l2x2}3Q3m4S4V4[4e5^5i5u6c6g6j6l6n6x6z7P7f7n7q8i8k8q8w8x9V9Z9a9c9p9s9t:P:S:Y:[:a:f:jX1u+z.[6R6T'[!VO[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'e'j'k'z(a(c(j)m)s*i*j*m*r*s*w+X+Z+i+k+l,Q,S,o,r,x-^-_-b-f-j.S.T.X/Q/_/f/q/v/x0k1O1T1d1e1o1s1}2P2f2i2l2x2}3Q3m4S4V4[5^5i5u6c6g6j6l6n6x6z7P7f7n7q8i8k8q8w8x9V9Z9a9c9p9s9t:P:S:Y:[:a:f:jW1u+z.[6R6TR2h,t![jO[wx!g!k%m&S&y&|'O'b'e*r,r-^-_-b-f2f2}6g6n8k9p9t:[:a:jY%Ve$e(c1s3mQ'S!nS(z#i5^Q,n&xQ,y'PS.R'z.XQ2e,oQ6o2lQ7Q3QQ8l6jR9q8i'[![O[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'e'j'k'z(a(c(j)m)s*i*j*m*r*s*w+X+Z+i+k+l,Q,S,o,r,x-^-_-b-f-j.S.T.X/Q/_/f/q/v/x0k1O1T1d1e1o1s1}2P2f2i2l2x2}3Q3m4S4V4[5^5i5u6c6g6j6l6n6x6z7P7f7n7q8i8k8q8w8x9V9Z9a9c9p9s9t:P:S:Y:[:a:f:jX1u+z.[6R6T'eyO[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'e'j'k'z(a(c(j)m)s*i*j*m*r*s*w+X+Z+i+k+l+z,Q,S,o,r,x-^-_-b-f-j.S.T.X.[/Q/_/f/q/v/x0k1O1T1d1e1o1s1}2P2f2i2l2x2}3Q3m4S4V4[5^5i5u6R6T6c6g6j6l6n6x6z7P7f7n7q8i8k8q8w8x9V9Z9a9c9p9s9t:P:S:Y:[:a:f:jQ&`yS'u#O-xR1_+dS+_&U1WR5r1_Q1S+^R5k1RR1S+^T+_&U1Wz&[%X&V&Y&Z'l)i*e*g+^+f/p0a0|0}1R1V1m5e5z;|;}Q&]yR1q+y!P&[y%X&V&Y&Z'l)i*e*g+^+f+y/p0a0|0}1R1V1m5e5z;|;}Q+v&^S+}&a7mS1g+m+tQ1w+|R5v1f![kO[wx!g!k%m&S&y&|'O'b'e*r,r-^-_-b-f2f2}6g6n8k9p9t:[:a:jS%zo.hS&Oq-uQ&_yQ&q!eQ*q%eU*|%v%{3zS+Q%x%}Q+r&]Q,s&{S0[*X,cS0r*}+OQ0t+PQ1r+yQ5Y0^Q5_0sQ6P1qQ6a2ZQ7r3}Q9W7cR:T9Y`uOwx!g&S'e*r-fQ,Z&mQ-y'uQ3^-wR3c-z|lOwx!g!k%m&S&y'O'e*r,r-f2f6g6n8k9p9t:[:a:jU$h[&|-_S%zo.hS&Oq-uQ*q%eU*|%v%{3zS+Q%x%}S0[*X,cS0r*}+OQ0t+PQ5Y0^Q5_0sQ7r3}Q9W7cR:T9YT,`&q,aauOwx!g&S'e*r-f`uOwx!g&S'e*r-fQ,Z&mQ,o&xQ,x'PW-a'b-^-b2}Q-y'uQ3^-wQ3c-zR7P3Q[%fg$g,m,w-`2bR0o*u^$XV!U$a$z%P<V<WQ'S!nS)a#}*wS)w$W*rQ)z$YY*t%e*X0n2j3OQ/R(gS/l)j/SS0d*i4eS0m*s6cQ0u+RQ4U.jQ4r/fS4u/m/nS4z/q5^Q5P/xQ6d2cU7e3w3}4VQ8S4vQ8o6lY9U7c7f7g7p7qQ9v8qW:O9S9V9Y9ZQ:_9sU:e:P:R:SR:n:fS)w$W*rT4z/q5^Z)u$W)v*r/q5^Q&t!gQ'f!yQ,Z&mS,[&n'hS2V,^-iR6^2UQ&w!hR'y#PS,h&v'wQ2_,fR6b2^|lOwx!g!k%m&S&y'O'e*r,r-f2f6g6n8k9p9t:[:a:jV$h[&|-_!]kO[wx!g!k%m&S&y&|'O'b'e*r,r-^-_-b-f2f2}6g6n8k9p9t:[:a:j![hO[wx!g!k%m&S&y&|'O'b'e*r,r-^-_-b-f2f2}6g6n8k9p9t:[:a:jR'W!q![kO[wx!g!k%m&S&y&|'O'b'e*r,r-^-_-b-f2f2}6g6n8k9p9t:[:a:jR,o&xQ&y!iQ&{!jQ'O!lR,r&zR,p&x|lOwx!g!k%m&S&y'O'e*r,r-f2f6g6n8k9p9t:[:a:jX-a'b-^-b2}`uOwx!g&S'e*r-fQ,{'PQ-y'uS.n(R.pR3c-z`uOwx!g&S'e*r-fQ,{'PW-a'b-^-b2}T.n(R.pg-['`-U-W-Z2s2t2v2y6u6v8t}lOwx!g!k%m&S&y'O'e*r,r-f2f6g6n8k9p9t:[:a:jf!OOaewx{!g&S'e*r-f&|$j[f!W!X!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$e$f$k%]%m&Q&W&b&f&x&y&|'O'P'b'j'k'z(a(c(j)m)s*i*j*m*s*w+X+Z+i+k+l,Q,S,o,r,x-^-_-b-j.S.T.X/Q/T/_/f/o/q/v/x0k1O1T1d1e1o1s1}2P2f2i2l2x2}3Q3m4S4V4[4e5^5i5u6c6g6j6l6n6x6z7P7f7n7q8i8k8q8w8x9V9Z9a9c9p9s9t:P:S:Y:[:a:f:j#d%jgnp|#O$g$|$}%S%d%h%i%w&s'u'v(R*Z*a*c*u+^,m,w-`-s-z.i.p.r0`0|0}1R1V2b2m5e6k;[;];^;d;e;f;s;t;u;v;z;{;|;}<[<]<^Q']!tQ-T'^Q-g'gQ2T,]Q6`2WR8e6_j$RT$_%b%r;O;P;Q;`;a;b;c;g;hi)p$V*V:{:|:};l;m;n;o;p;q;rj$RT$_%b%r;O;P;Q;`;a;b;c;g;hh)p$V*V:{:|:};l;m;n;o;p;q;rS/a(|<`V4o/b/c;y`uOwx!g&S'e*r-fQ-y'uR3c-z`uOwx!g&S'e*r-fT.n(R.p'd!YO[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'e'j'k'z(a(c(j)m)s*i*j*m*r*s*w+X+Z+i+k+l,Q,S,o,r,x-^-_-b-f-j.S.T.X/Q/T/_/f/o/q/v/x0k1O1T1d1e1o1s1}2P2f2i2l2x2}3Q3m4S4V4[4e5^5i5u6c6g6j6l6n6x6z7P7f7n7q8i8k8q8w8x9V9Z9a9c9p9s9t:P:S:Y:[:a:f:jR7V3X`uOwx!g&S'e*r-fQ-y'uS.n(R.pR3c-z`pOwx!g&S'e*r-fQ%wnS-s'u-zT.i(R.pS%{o.hS*}%v3zR0s+OQ+S%yR5a0vS%zo.hS&Oq-uU*|%v%{3zS+Q%x%}S0r*}+OQ0t+PQ5_0sQ7r3}Q9W7cR:T9YdqOwx!g&S'e(R*r-f.pS%xn-sU%}p.i.rQ+P%wT-u'u-zS'{#Q.[R.]'|T.U'z.XS.V'z.XQ8|7YR9{8}T6R1t8cR6T1t#d!Pgnp|#O$g$|$}%S%d%h%i%w&s'u'v(R*Z*a*c*u+^,m,w-`-s-z.i.p.r0`0|0}1R1V2b2m5e6k;[;];^;d;e;f;s;t;u;v;z;{;|;}<[<]<^f!QOaewx{!g&S'e*r-f&}![[f!W!X!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$e$f$k%]%m&Q&W&b&f&x&y&|'O'P'b'j'k'z(a(c(j)m)s*i*j*m*s*w+X+Z+i+k+l,Q,S,o,r,x-^-_-b-j.S.T.X/Q/T/_/f/o/q/v/x0k1O1T1d1e1o1s1}2P2f2i2l2x2}3Q3m4S4V4[4e5^5i5u6c6g6j6l6n6x6z7P7f7n7q8i8k8q8w8x9V9Z9a9c9p9s9t:P:S:Y:[:a:f:j#d!Pgnp|#O$g$|$}%S%d%h%i%w&s'u'v(R*Z*a*c*u+^,m,w-`-s-z.i.p.r0`0|0}1R1V2b2m5e6k;[;];^;d;e;f;s;t;u;v;z;{;|;}<[<]<^f!QOaewx{!g&S'e*r-f&|![[f!W!X!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$e$f$k%]%m&Q&W&b&f&x&y&|'O'P'b'j'k'z(a(c(j)m)s*i*j*m*s*w+X+Z+i+k+l,Q,S,o,r,x-^-_-b-j.S.T.X/Q/T/_/f/o/q/v/x0k1O1T1d1e1o1s1}2P2f2i2l2x2}3Q3m4S4V4[4e5^5i5u6c6g6j6l6n6x6z7P7f7n7q8i8k8q8w8x9V9Z9a9c9p9s9t:P:S:Y:[:a:f:jk4Q.j3w3{4O4P7g7i7j7l7o9]9^:VQ4U.jS7e3w3}U9U7c7g7pS:O9S9YR:e:R$Q!TO[_ewx!f!g!u!}#O#V#Z$S$T$e$l%U&S&U&Y&c&f&m&x'P'_'b'e'u(R(c(h)k)q*r*w+]+b+u,Y,l,x,{-R-^-_-b-f-r-w-z.g.p.r1V1W1[1i1n1p2P2i2o2}3Q3m3x5n8_R4a.xQ(^#US.y(](_S4b.z.{R7{4cQ.v([R7y4]$Q!TO[_ewx!f!g!u!}#O#V#Z$S$T$e$l%U&S&U&Y&c&f&m&x'P'_'b'e'u(R(c(h)k)q*r*w+]+b+u,Y,l,x,{-R-^-_-b-f-r-w-z.g.p.r1V1W1[1i1n1p2P2i2o2}3Q3m3x5n8_p$w`$d$s%X&r'`(`(g)j*e-U/n1m5o5z8Yq)O#k%y.j0v3w3{4O4P7g7i7j7l7o9]9^:VR,V&fR6[2P']!VO[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'e'j'k'z(a(c(j)m)s*i*j*m*r*s*w+X+Z+i+k+l,Q,S,o,r,x-^-_-b-f-j.S.T.X/Q/_/f/q/v/x0k1O1T1d1e1o1s1}2P2f2i2l2x2}3Q3m4S4V4[5^5i5u6c6g6j6l6n6x6z7P7f7n7q8i8k8q8w8x9V9Z9a9c9p9s9t:P:S:Y:[:a:f:j$q#rS%T%Z'Q'X'Z'a'c(b(f(i(x(y)S)T)V)W)X)Y)Z)[)])^)_)`)l)r)y+Y+h,P,T,k,v-k-l.P.|/s0c0e0j0l0z1c1|2d2k3V3g3h4g4h4n4q4w4y4}5O5h5t5{6Y6i6m6w7O7u7v7x8W8X8g8j8n8v9X9`9o9u:Q:X:^:d:m$]#sS%T%Z'Q'X'Z'a'c(i(x(y)S)W)_)`)l)r)y+Y+h,P,T,k,v-k-l.P.|/s0c0e0j0l0z1c1|2d2k3V3g3h4g4h4n4q4w4y4}5O5h5t5{6Y6i6m6w7O7u7v7x8W8X8g8j8n8v9X9`9o9u:Q:X:^:d:m$Z#tS%T%Z'Q'X'Z'a'c(i(x(y)S)_)`)l)r)y+Y+h,P,T,k,v-k-l.P.|/s0c0e0j0l0z1c1|2d2k3V3g3h4g4h4n4q4w4y4}5O5h5t5{6Y6i6m6w7O7u7v7x8W8X8g8j8n8v9X9`9o9u:Q:X:^:d:m$c#wS%T%Z'Q'X'Z'a'c(i(x(y)S)V)W)X)Y)_)`)l)r)y+Y+h,P,T,k,v-k-l.P.|/s0c0e0j0l0z1c1|2d2k3V3g3h4g4h4n4q4w4y4}5O5h5t5{6Y6i6m6w7O7u7v7x8W8X8g8j8n8v9X9`9o9u:Q:X:^:d:m']![O[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'e'j'k'z(a(c(j)m)s*i*j*m*r*s*w+X+Z+i+k+l,Q,S,o,r,x-^-_-b-f-j.S.T.X/Q/_/f/q/v/x0k1O1T1d1e1o1s1}2P2f2i2l2x2}3Q3m4S4V4[5^5i5u6c6g6j6l6n6x6z7P7f7n7q8i8k8q8w8x9V9Z9a9c9p9s9t:P:S:Y:[:a:f:jQ/S(gQ/m)jQ4v/nR9h7}'a![O[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'e'j'k'z(a(c(j)m)s*i*j*m*r*s*w+X+Z+i+k+l,Q,S,o,r,x-^-_-b-f-j.S.T.X/Q/T/_/f/o/q/v/x0k1O1T1d1e1o1s1}2P2f2i2l2x2}3Q3m4S4V4[5^5i5u6c6g6j6l6n6x6z7P7f7n7q8i8k8q8w8x9V9Z9a9c9p9s9t:P:S:Y:[:a:f:jQ#eQR(v#eU$|a;d;|b%Ue$e&f(c-R1p2P2o8_Q'_!u!Q*_$|%U'_*a*g+i,Q0`0a1e2s6u6x7i8t9]9a:V;[;s;t;z;{<[S*a$}%SQ*g%XS+i&W1TQ,Q&bQ0`*cQ0a*eQ1e+lQ2s-WS6u2t2vQ6x2xQ7i3{Q8t6vS9]7j7lQ9a7nQ:V9^Q;[%dS;s;];^S;t<]<^Q;z;uQ;{;vT<[0};e`[Owx!g&S'e*r-fl$c[&|(O+],Y,i,l-Q-_-r-}.b.g.tl&|!k%m&y'O,r2f6g6n8k9p9t:[:a:j^(O#R#S#T+c3`3a3b`+]&U&Y&c*w1V1W1i3mS,Y&m-wQ,i&wU,l&x'P3QS-Q'[2nW-_'b-^-b2}S-r'u-zQ-}'yQ.b(QS.g(R.pR.t(VQ)}$[R/{)}Q0U*OQ5R0PQ5S0QQ5T0RY5U0U5R5S5T8UR8U5WQ*Q$]S0X*Q0YR0Y*RS.c(Q.bS3r.c7`R7`3tQ3u.dS7^3s3vU7b3u7^9PR9P7_Q.p(RR4W.p#Q_O[wx!f!g!}#O$S$l&S&U&Y&c&m&x'P'b'e'u(R)q*r*w+],Y,l,x,{-^-_-b-f-r-w-z.g.p.r1V1W1i2i2}3Q3m3xU$r_$u*^U$u`$d&rR*^$sU$}a;d;|d*b$}*c2t6v7j9^;];u;v<]Q*c%SQ2t-WQ6v2vQ7j3{Q9^7lQ;]%dQ;u;^Q;v<^T<]0};eS+|&a7mR1v+|S*k%Z/sR0f*kQ1X+`R5m1XU+f&V0};|R1`+fQ+t&^Q1f+mT1l+t1fQ8`5}R9m8`QwOU&Rw&S-fS&Sx*rR-f'eQ,a&qR2Y,aW)v$W*r/q5^R/w)vU/r)r)w0jR4{/r[*v%e%f*X2c2j3OR0p*vQ,e&uR2],eQ-b'bQ2}-^T3P-b2}Q2z-YR6|2zQ-i'hQ2U,^T3U-i2US%pm7UR*{%phnOwx!g&S'e'u(R*r-f-z.pR%unQ0w+SR5b0wQ.X'zR3j.XQ1y,OR6U1yU*o%`*y;_R0i*oS1j+o0qR5x1jQ7p3}Q9S7cU9e7p9S:RR:R9Y$S!SO[_ewx!f!g!u!}#O#V#Z$S$T$e$l%U&S&U&Y&c&f&m&x'P'_'b'e'u(R(c(h)k)q*r*w+]+b+u,Y,l,x,{-R-^-_-b-f-r-w-z.g.p.r.x1V1W1[1i1n1p2P2i2o2}3Q3m3x5n8_R&g!SQ4^.vR7z4^Q2Q,VR6]2QS/g)`)aR4s/gW(p#a(k(l/VR/Z(pQ8P4jR9j8PT)b#}*w!YSO[wx!g!k%m&S&y&|'O'b'e,r-^-_-b-f2f2}6g6n8k9p9t:[:a:jj$ya{$k%]+k,S1d1}5u6z8w9c:YY%Te$e(c1s3mY%Zf$f(j)m*mQ&j!WQ&k!XQ'Q!nQ'X!rQ'Z!sQ'a!vQ'c!xQ(b#XQ(f#YS(i#[+ZQ(x#gQ(y#iQ)S#lQ)T#qQ)U#rQ)V#sQ)W#tQ)X#uQ)Y#vQ)Z#wQ)[#xQ)]#yQ)^#zQ)_#{S)`#}*wQ)l$UQ)r$WQ)y$YQ+Y&QS+h&W1TQ,P&bQ,T&fQ,k&xQ,v'PQ-k'jQ-l'kS.P'z.XQ.|(aS/s)s0kS0c*i4eQ0e*jQ0j*rQ0l*sQ0z+XS1c+i+lQ1|,QQ2d,oS2k,x7PQ3V-jQ3g.SQ3h.TQ4g/QQ4h/TQ4n/_Q4q/fQ4w/oQ4y/qQ4}/vQ5O/xQ5h1OQ5t1eQ5{1oQ6Y2PS6i2i8xQ6m2lQ6w2xQ7O3QQ7u4SQ7v4VQ7x4[Q8W5^Q8X5iQ8g6cQ8j6jQ8n6lQ8v6xS9X7f7qQ9`7nQ9o8iQ9u8qS:Q9V9ZQ:X9aQ:^9sS:d:P:SR:m:fR,W&fh]Owx!g&S'e'u(R*r-f-z.p!v^[_`!f!}#O$S$d$l$s$u&U&Y&c&m&r&x'P'b)q*^*w+],Y,l,x,{-^-_-b-r-w.g.r1V1W1i2i2}3Q3m3x#r${ae!u$e$|$}%S%U%X%d&W&b&f'_(c*a*c*e*g+i+l,Q-R-W0`0a1T1e1p2P2o2s2t2v2x3{6u6v6x7i7j7l7n8_8t9]9^9a:V;[;];^;d;e;s;t;u;v;z;{<[<]<^Q%tnS+e&V+fW+s&^+m+t1fU+{&a+|7mQ1n+uT5g0};|d`Owx!g&S'e'u*r-f-zS$d[-rQ$s_b%Xe$e&f(c-R1p2P2o8_!h&r!f!}#O$S$l&U&Y&c&m&x'P'b(R)q*w+],Y,l,x,{-^-_-b-w.g.p.r1V1W1i2i2}3Q3m3xQ'`!uS(`#V+bQ(g#ZS)j$T(hQ*e%UQ-U'_Q/n)kQ1m+uQ5o1[Q5z1nR8Y5nS(X#R3aS(Y#S3bV(Z#T+c3`R$^Ye0T*O0P0Q0R0U5R5S5T5W8UW(S#R#S#T+cQ(]#US.^(O(VS.d(Q.bQ.{(_W1u+z.[6R6TQ3_-wQ3l.ZQ3s.cQ4Z.tU7X3`3a3bQ7a3tR9Q7`Q.e(QR3q.bT.o(R.phgOwx!g&S&m'e'u*r-f-w-zU$g[,Y-rQ&s!fQ'l!}Q'v#OQ)i$SQ*Z$l`+^&U&Y&c*w1V1W1i3mQ,m&xQ,w'PY-`'b-^-b2}3QS.j(R.pQ/p)qQ0|+]S2b,l-_S2m,x,{S3w.g.rQ6k2iR7g3xh]Owx!g&S'e'u(R*r-f-z.p!v^[_`!f!}#O$S$d$l$s$u&U&Y&c&m&r&x'P'b)q*^*w+],Y,l,x,{-^-_-b-r-w.g.r1V1W1i2i2}3Q3m3xR%tnQ3}.jQ7c3wQ7k3{Q7s4OQ7t4PQ9Y7gU9[7i7j7lQ9d7oS:U9]9^R:g:VZ+p&Y&c*w1V3mtzOnpwx!g%w&S'e'u(R*r-f-s-z.i.p.r[%Oa%d0};d;e;|U%We%h1VQ%eg^&d{|%i1R5e;f;}Q't#OQ*X$gb*`$|$}%S;[;];^<[<]<^Q,c&sQ-{'vQ0^*Z[0_*a*c;s;t;u;vQ0n*uQ1P+^Q2c,mQ2j,wS3O-`2bU5Z0`;z;{Q5f0|Q6p2mR8m6kQ,O&aR9_7mS1t+z.[Q8b6RR8c6T[%^f$f(j)m)s0kR0g*mR+a&UQ+`&UR5l1WS&Xy+yQ*h%XU+g&V0};|S+n&Y1VW+q&Z1R5e;}Q-m'lQ/k)iS0b*e*gQ1U+^Q1a+fQ4x/pQ5[0aQ5d0|Q5y1mR8]5zR6O1p^vOwx&S'e*r-fR&t!gW%gg,m,w-`T*Y$g2bT)x$W*r`uOwx!g&S'e*r-fQ&}!kQ*z%mQ,q&yQ,u'OQ2g,rQ6f2fQ8h6gQ8p6nQ9r8kQ:]9pQ:`9tQ:i:[Q:k:aR:o:j|lOwx!g!k%m&S&y'O'e*r,r-f2f6g6n8k9p9t:[:a:jU$h[&|-_X-a'b-^-b2}Q-]'`R2r-US-Y'`-UQ2u-WQ2{-ZU6t2s2t2vQ6{2yS8s6u6vR9w8t`rOwx!g&S'e*r-fS-t'u-zT.k(R.pR+T%y`sOwx!g&S'e*r-fS-v'u-zT.l(R.p`tOwx!g&S'e*r-fT.m(R.pT.W'z.XX%af%k0k1TQ.z(]R4c.{R.w([R(e#XQ(s#aS/U(k(lR4i/VR/Y(mR4k/W\",\n  nodeNames: \"⚠ RawString > MacroName LineComment BlockComment PreprocDirective #include String EscapeSequence SystemLibString Identifier ArgumentList ( ConditionalExpression AssignmentExpression CallExpression PrimitiveType FieldExpression FieldIdentifier DestructorName TemplateMethod ScopedFieldIdentifier NamespaceIdentifier TemplateType TypeIdentifier ScopedTypeIdentifier ScopedNamespaceIdentifier :: NamespaceIdentifier TypeIdentifier TemplateArgumentList < TypeDescriptor const volatile restrict _Atomic mutable constexpr constinit consteval StructSpecifier struct MsDeclspecModifier __declspec ) Attribute AttributeName Identifier AttributeArgs { } [ ] UpdateOp ArithOp ArithOp ArithOp LogicOp BitOp BitOp BitOp CompareOp CompareOp CompareOp > CompareOp BitOp UpdateOp , Number CharLiteral AttributeArgs VirtualSpecifier BaseClassClause Access virtual FieldDeclarationList FieldDeclaration extern static register inline thread_local AttributeSpecifier __attribute__ PointerDeclarator MsBasedModifier __based MsPointerModifier FunctionDeclarator ParameterList ParameterDeclaration PointerDeclarator FunctionDeclarator Noexcept noexcept RequiresClause requires True False ParenthesizedExpression CommaExpression LambdaExpression LambdaCaptureSpecifier TemplateParameterList OptionalParameterDeclaration TypeParameterDeclaration typename class VariadicParameterDeclaration VariadicDeclarator ReferenceDeclarator OptionalTypeParameterDeclaration VariadicTypeParameterDeclaration TemplateTemplateParameterDeclaration template AbstractFunctionDeclarator AbstractPointerDeclarator AbstractArrayDeclarator AbstractParenthesizedDeclarator AbstractReferenceDeclarator ThrowSpecifier throw TrailingReturnType CompoundStatement FunctionDefinition MsCallModifier TryStatement try CatchClause catch LinkageSpecification Declaration InitDeclarator InitializerList InitializerPair SubscriptDesignator FieldDesignator DeclarationList ExportDeclaration export ImportDeclaration import ModuleName PartitionName HeaderName CaseStatement case default LabeledStatement StatementIdentifier ExpressionStatement IfStatement if ConditionClause Declaration else SwitchStatement switch DoStatement do while WhileStatement ForStatement for ReturnStatement return BreakStatement break ContinueStatement continue GotoStatement goto CoReturnStatement co_return CoYieldStatement co_yield AttributeStatement ForRangeLoop AliasDeclaration using TypeDefinition typedef PointerDeclarator FunctionDeclarator ArrayDeclarator ParenthesizedDeclarator ThrowStatement NamespaceDefinition namespace ScopedIdentifier Identifier OperatorName operator ArithOp BitOp CompareOp LogicOp new delete co_await ConceptDefinition concept UsingDeclaration enum StaticAssertDeclaration static_assert ConcatenatedString TemplateDeclaration FriendDeclaration friend union FunctionDefinition ExplicitFunctionSpecifier explicit FieldInitializerList FieldInitializer DefaultMethodClause DeleteMethodClause FunctionDefinition OperatorCast operator TemplateInstantiation FunctionDefinition FunctionDefinition Declaration ModuleDeclaration module RequiresExpression RequirementList SimpleRequirement TypeRequirement CompoundRequirement ReturnTypeRequirement ConstraintConjuction LogicOp ConstraintDisjunction LogicOp ArrayDeclarator ParenthesizedDeclarator ReferenceDeclarator TemplateFunction OperatorName StructuredBindingDeclarator ArrayDeclarator ParenthesizedDeclarator ReferenceDeclarator BitfieldClause FunctionDefinition FunctionDefinition Declaration FunctionDefinition Declaration AccessSpecifier UnionSpecifier ClassSpecifier EnumSpecifier SizedTypeSpecifier TypeSize EnumeratorList Enumerator DependentType Decltype decltype auto PlaceholderTypeSpecifier ParameterPackExpansion ParameterPackExpansion FieldIdentifier PointerExpression SubscriptExpression BinaryExpression ArithOp LogicOp LogicOp BitOp UnaryExpression LogicOp BitOp UpdateExpression CastExpression SizeofExpression sizeof CoAwaitExpression CompoundLiteralExpression NULL NewExpression new NewDeclarator DeleteExpression delete ParameterPackExpansion nullptr this UserDefinedLiteral ParamPack #define PreprocArg #if #ifdef #ifndef #else #endif #elif PreprocDirectiveName Macro Program\",\n  maxTerm: 426,\n  nodeProps: [\n    [\"group\", -35,1,8,11,14,15,16,18,71,72,100,101,102,104,192,209,230,243,244,271,272,273,278,281,282,283,285,286,287,288,291,293,294,295,296,297,\"Expression\",-13,17,24,25,26,42,256,257,258,259,263,264,266,267,\"Type\",-19,126,129,148,151,153,154,159,161,164,165,167,169,171,173,175,177,179,180,189,\"Statement\"]\n  ],\n  propSources: [cppHighlighting],\n  skippedNodes: [0,3,4,5,6,7,10,298,299,300,301,302,303,304,305,306,307,348,349],\n  repeatNodeCount: 41,\n  tokenData: \"&*r7ZR!UOX$eXY({YZ.gZ]$e]^+P^p$epq({qr.}rs0}st2ktu$euv!7dvw!9bwx!;exy!<Yyz!=Tz{!>O{|!?R|}!AV}!O!BQ!O!P!DX!P!Q#+y!Q!R#Az!R![$(x![!]$Ag!]!^$Cc!^!_$D^!_!`%1W!`!a%2X!a!b%5_!b!c$e!c!n%6Y!n!o%7q!o!w%6Y!w!x%7q!x!}%6Y!}#O%:n#O#P%<g#P#Q%Kz#Q#R%Ms#R#S%6Y#S#T$e#T#i%6Y#i#j%Nv#j#o%6Y#o#p&!e#p#q&#`#q#r&%f#r#s&&a#s;'S$e;'S;=`(u<%lO$e&t$nY)[W(qQ'g&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e&r%eW)[W'g&jOY%^Zw%^wx%}x#O%^#O#P&f#P;'S%^;'S;=`'x<%lO%^&j&SU'g&jOY%}Z#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}&j&kX'g&jOY%}YZ%}Z]%}]^'W^#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}&j']V'g&jOY%}YZ%}Z#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}&j'uP;=`<%l%}&r'{P;=`<%l%^&l(VW(qQ'g&jOY(OZr(Ors%}s#O(O#O#P&f#P;'S(O;'S;=`(o<%lO(O&l(rP;=`<%l(O&t(xP;=`<%l$e7Z)Y`)[W(qQ(o.o'g&j*[)`OX$eXY({YZ*[Z]$e]^+P^p$epq({qr$ers%^sw$ewx(Ox#O$e#O#P,^#P;'S$e;'S;=`(u<%lO$e.o*aT(o.oXY*[YZ*[]^*[pq*[#O#P*p.o*sQYZ*[]^*y.o*|PYZ*[4e+[`)[W(qQ(o.o'g&jOX$eXY+PYZ*[Z]$e]^+P^p$epq+Pqr$ers%^sw$ewx(Ox#O$e#O#P,^#P;'S$e;'S;=`(u<%lO$e4Z,cX'g&jOY%}YZ-OZ]%}]^-{^#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}4Z-V[(o.o'g&jOX%}XY-OYZ*[Z]%}]^-O^p%}pq-Oq#O%}#O#P,^#P;'S%};'S;=`'r<%lO%}4Z.QV'g&jOY%}YZ-OZ#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}7P.nT*X)`(o.oXY*[YZ*[]^*[pq*[#O#P*p3o/[[%_!b'RP)[W(qQ'g&jOY$eZr$ers%^sw$ewx(Ox!_$e!_!`0Q!`#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o0_Y%^!b!a,g)[W(qQ'g&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e6e1YY)[W(rQ(p/]'g&jOY%^Zr%^rs1xsw%^wx%}x#O%^#O#P&f#P;'S%^;'S;=`'x<%lO%^(U2RW)y!b)[W'g&jOY%^Zw%^wx%}x#O%^#O#P&f#P;'S%^;'S;=`'x<%lO%^4e2tf)[W(qQ'g&jOX$eXY2kZp$epq2kqr$ers%^sw$ewx(Ox!c$e!c!}4Y!}#O$e#O#P&f#P#T$e#T#W4Y#W#X5m#X#Y>u#Y#]4Y#]#^NZ#^#o4Y#o;'S$e;'S;=`(u<%lO$e4e4eb)[W(qQ'g&j'n.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#o4Y#o;'S$e;'S;=`(u<%lO$e4e5xd)[W(qQ'g&j'n.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#X4Y#X#Y7W#Y#o4Y#o;'S$e;'S;=`(u<%lO$e4e7cd)[W(qQ'g&j'n.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#Y4Y#Y#Z8q#Z#o4Y#o;'S$e;'S;=`(u<%lO$e4e8|d)[W(qQ'g&j'n.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#]4Y#]#^:[#^#o4Y#o;'S$e;'S;=`(u<%lO$e4e:gd)[W(qQ'g&j'n.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#b4Y#b#c;u#c#o4Y#o;'S$e;'S;=`(u<%lO$e4e<Qd)[W(qQ'g&j'n.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#X4Y#X#Y=`#Y#o4Y#o;'S$e;'S;=`(u<%lO$e4e=mb)[W(qQ'f.o'g&j'n.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#o4Y#o;'S$e;'S;=`(u<%lO$e4e?Qf)[W(qQ'g&j'n.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#`4Y#`#a@f#a#b4Y#b#cHV#c#o4Y#o;'S$e;'S;=`(u<%lO$e4e@qf)[W(qQ'g&j'n.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#]4Y#]#^BV#^#g4Y#g#hEV#h#o4Y#o;'S$e;'S;=`(u<%lO$e4eBbd)[W(qQ'g&j'n.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#Y4Y#Y#ZCp#Z#o4Y#o;'S$e;'S;=`(u<%lO$e4eC}b)[W(qQ'g&j'm.o'n.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#o4Y#o;'S$e;'S;=`(u<%lO$e4eEbd)[W(qQ'g&j'n.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#X4Y#X#YFp#Y#o4Y#o;'S$e;'S;=`(u<%lO$e4eF}b)[W(qQ'k.o'g&j'n.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#o4Y#o;'S$e;'S;=`(u<%lO$e4eHbd)[W(qQ'g&j'n.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#W4Y#W#XIp#X#o4Y#o;'S$e;'S;=`(u<%lO$e4eI{d)[W(qQ'g&j'n.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#]4Y#]#^KZ#^#o4Y#o;'S$e;'S;=`(u<%lO$e4eKfd)[W(qQ'g&j'n.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#Y4Y#Y#ZLt#Z#o4Y#o;'S$e;'S;=`(u<%lO$e4eMRb)[W(qQ'g&j'l.o'n.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#o4Y#o;'S$e;'S;=`(u<%lO$e4eNff)[W(qQ'g&j'n.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#Y4Y#Y#Z! z#Z#b4Y#b#c!.[#c#o4Y#o;'S$e;'S;=`(u<%lO$e4e!!Xf)[W(qQ'h.o'g&j'n.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#W4Y#W#X!#m#X#b4Y#b#c!(W#c#o4Y#o;'S$e;'S;=`(u<%lO$e4e!#xd)[W(qQ'g&j'n.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#X4Y#X#Y!%W#Y#o4Y#o;'S$e;'S;=`(u<%lO$e4e!%cd)[W(qQ'g&j'n.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#Y4Y#Y#Z!&q#Z#o4Y#o;'S$e;'S;=`(u<%lO$e4e!'Ob)[W(qQ'i.o'g&j'n.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#o4Y#o;'S$e;'S;=`(u<%lO$e4e!(cd)[W(qQ'g&j'n.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#W4Y#W#X!)q#X#o4Y#o;'S$e;'S;=`(u<%lO$e4e!)|d)[W(qQ'g&j'n.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#X4Y#X#Y!+[#Y#o4Y#o;'S$e;'S;=`(u<%lO$e4e!+gd)[W(qQ'g&j'n.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#Y4Y#Y#Z!,u#Z#o4Y#o;'S$e;'S;=`(u<%lO$e4e!-Sb)[W(qQ'j.o'g&j'n.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#o4Y#o;'S$e;'S;=`(u<%lO$e4e!.gd)[W(qQ'g&j'n.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#V4Y#V#W!/u#W#o4Y#o;'S$e;'S;=`(u<%lO$e4e!0Qd)[W(qQ'g&j'n.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#`4Y#`#a!1`#a#o4Y#o;'S$e;'S;=`(u<%lO$e4e!1kd)[W(qQ'g&j'n.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#i4Y#i#j!2y#j#o4Y#o;'S$e;'S;=`(u<%lO$e4e!3Ud)[W(qQ'g&j'n.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#W4Y#W#X!4d#X#o4Y#o;'S$e;'S;=`(u<%lO$e4e!4od)[W(qQ'g&j'n.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#X4Y#X#Y!5}#Y#o4Y#o;'S$e;'S;=`(u<%lO$e4e!6[b)[W(qQV.o'g&j'n.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#o4Y#o;'S$e;'S;=`(u<%lO$e3o!7q[)[W(qQ%[!b![,g'g&jOY$eZr$ers%^sw$ewx(Ox!_$e!_!`!8g!`#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o!8rY!g-y)[W(qQ'g&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o!9o])W,g)[W(qQ%]!b'g&jOY$eZr$ers%^sv$evw!:hwx(Ox!_$e!_!`!8g!`#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o!:uY)V,g%_!b)[W(qQ'g&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e2X!;pW)]S(qQ)Z,g'g&jOY(OZr(Ors%}s#O(O#O#P&f#P;'S(O;'S;=`(o<%lO(O6i!<eY)[W(qQ]6_'g&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e'V!=`Y!Oa)[W(qQ'g&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o!>][)T,g)[W(qQ%[!b'g&jOY$eZr$ers%^sw$ewx(Ox!_$e!_!`!8g!`#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o!?`^)[W(qQ%[!b!Y,g'g&jOY$eZr$ers%^sw$ewx(Ox{$e{|!@[|!_$e!_!`!8g!`#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o!@gY)[W!X-y(qQ'g&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e2a!AbY!h,k)[W(qQ'g&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o!B__)[W(qQ%[!b!Y,g'g&jOY$eZr$ers%^sw$ewx(Ox}$e}!O!@[!O!_$e!_!`!8g!`!a!C^!a#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o!CiY(y-y)[W(qQ'g&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e2a!Dd^)[W(qQ'g&j(x,gOY$eZr$ers%^sw$ewx(Ox!O$e!O!P!E`!P!Q$e!Q![!GY![#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e2a!Ei[)[W(qQ'g&jOY$eZr$ers%^sw$ewx(Ox!O$e!O!P!F_!P#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e2a!FjY)Y,k)[W(qQ'g&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e2]!Gen)[W(qQ!i,g'g&jOY$eZr$ers%^sw$ewx!Icx!Q$e!Q![!GY![!g$e!g!h#$w!h!i#*Y!i!n$e!n!o#*Y!o!r$e!r!s#$w!s!w$e!w!x#*Y!x#O$e#O#P&f#P#X$e#X#Y#$w#Y#Z#*Y#Z#`$e#`#a#*Y#a#d$e#d#e#$w#e#i$e#i#j#*Y#j;'S$e;'S;=`(u<%lO$e2T!IjY(qQ'g&jOY(OZr(Ors%}s!Q(O!Q![!JY![#O(O#O#P&f#P;'S(O;'S;=`(o<%lO(O2T!Jcn(qQ!i,g'g&jOY(OZr(Ors%}sw(Owx!Icx!Q(O!Q![!JY![!g(O!g!h!La!h!i##`!i!n(O!n!o##`!o!r(O!r!s!La!s!w(O!w!x##`!x#O(O#O#P&f#P#X(O#X#Y!La#Y#Z##`#Z#`(O#`#a##`#a#d(O#d#e!La#e#i(O#i#j##`#j;'S(O;'S;=`(o<%lO(O2T!Ljl(qQ!i,g'g&jOY(OZr(Ors%}s{(O{|!Nb|}(O}!O!Nb!O!Q(O!Q![# e![!c(O!c!h# e!h!i# e!i!n(O!n!o##`!o!w(O!w!x##`!x#O(O#O#P&f#P#T(O#T#Y# e#Y#Z# e#Z#`(O#`#a##`#a#i(O#i#j##`#j;'S(O;'S;=`(o<%lO(O2T!Ni^(qQ'g&jOY(OZr(Ors%}s!Q(O!Q![# e![!c(O!c!i# e!i#O(O#O#P&f#P#T(O#T#Z# e#Z;'S(O;'S;=`(o<%lO(O2T# nj(qQ!i,g'g&jOY(OZr(Ors%}sw(Owx!Nbx!Q(O!Q![# e![!c(O!c!h# e!h!i# e!i!n(O!n!o##`!o!w(O!w!x##`!x#O(O#O#P&f#P#T(O#T#Y# e#Y#Z# e#Z#`(O#`#a##`#a#i(O#i#j##`#j;'S(O;'S;=`(o<%lO(O2T##id(qQ!i,g'g&jOY(OZr(Ors%}s!h(O!h!i##`!i!n(O!n!o##`!o!w(O!w!x##`!x#O(O#O#P&f#P#Y(O#Y#Z##`#Z#`(O#`#a##`#a#i(O#i#j##`#j;'S(O;'S;=`(o<%lO(O2]#%Sn)[W(qQ!i,g'g&jOY$eZr$ers%^sw$ewx(Ox{$e{|#'Q|}$e}!O#'Q!O!Q$e!Q![#(]![!c$e!c!h#(]!h!i#(]!i!n$e!n!o#*Y!o!w$e!w!x#*Y!x#O$e#O#P&f#P#T$e#T#Y#(]#Y#Z#(]#Z#`$e#`#a#*Y#a#i$e#i#j#*Y#j;'S$e;'S;=`(u<%lO$e2]#'Z`)[W(qQ'g&jOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![#(]![!c$e!c!i#(]!i#O$e#O#P&f#P#T$e#T#Z#(]#Z;'S$e;'S;=`(u<%lO$e2]#(hj)[W(qQ!i,g'g&jOY$eZr$ers%^sw$ewx!Nbx!Q$e!Q![#(]![!c$e!c!h#(]!h!i#(]!i!n$e!n!o#*Y!o!w$e!w!x#*Y!x#O$e#O#P&f#P#T$e#T#Y#(]#Y#Z#(]#Z#`$e#`#a#*Y#a#i$e#i#j#*Y#j;'S$e;'S;=`(u<%lO$e2]#*ef)[W(qQ!i,g'g&jOY$eZr$ers%^sw$ewx(Ox!h$e!h!i#*Y!i!n$e!n!o#*Y!o!w$e!w!x#*Y!x#O$e#O#P&f#P#Y$e#Y#Z#*Y#Z#`$e#`#a#*Y#a#i$e#i#j#*Y#j;'S$e;'S;=`(u<%lO$e7Z#,W`)[W(qQ%[!b![,g'g&jOY$eZr$ers%^sw$ewx(Oxz$ez{#-Y{!P$e!P!Q#:s!Q!_$e!_!`!8g!`#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e7Z#-c])[W(qQ'g&jOY#-YYZ#.[Zr#-Yrs#/csw#-Ywx#5wxz#-Yz{#8j{#O#-Y#O#P#2`#P;'S#-Y;'S;=`#:m<%lO#-Y1e#._TOz#.[z{#.n{;'S#.[;'S;=`#/]<%lO#.[1e#.qVOz#.[z{#.n{!P#.[!P!Q#/W!Q;'S#.[;'S;=`#/]<%lO#.[1e#/]OT1e1e#/`P;=`<%l#.[7X#/jZ)[W'g&jOY#/cYZ#.[Zw#/cwx#0]xz#/cz{#4O{#O#/c#O#P#2`#P;'S#/c;'S;=`#5q<%lO#/c7P#0bX'g&jOY#0]YZ#.[Zz#0]z{#0}{#O#0]#O#P#2`#P;'S#0];'S;=`#3x<%lO#0]7P#1SZ'g&jOY#0]YZ#.[Zz#0]z{#0}{!P#0]!P!Q#1u!Q#O#0]#O#P#2`#P;'S#0];'S;=`#3x<%lO#0]7P#1|UT1e'g&jOY%}Z#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}7P#2eZ'g&jOY#0]YZ#0]Z]#0]]^#3W^z#0]z{#0}{#O#0]#O#P#2`#P;'S#0];'S;=`#3x<%lO#0]7P#3]X'g&jOY#0]YZ#0]Zz#0]z{#0}{#O#0]#O#P#2`#P;'S#0];'S;=`#3x<%lO#0]7P#3{P;=`<%l#0]7X#4V])[W'g&jOY#/cYZ#.[Zw#/cwx#0]xz#/cz{#4O{!P#/c!P!Q#5O!Q#O#/c#O#P#2`#P;'S#/c;'S;=`#5q<%lO#/c7X#5XW)[WT1e'g&jOY%^Zw%^wx%}x#O%^#O#P&f#P;'S%^;'S;=`'x<%lO%^7X#5tP;=`<%l#/c7R#6OZ(qQ'g&jOY#5wYZ#.[Zr#5wrs#0]sz#5wz{#6q{#O#5w#O#P#2`#P;'S#5w;'S;=`#8d<%lO#5w7R#6x](qQ'g&jOY#5wYZ#.[Zr#5wrs#0]sz#5wz{#6q{!P#5w!P!Q#7q!Q#O#5w#O#P#2`#P;'S#5w;'S;=`#8d<%lO#5w7R#7zW(qQT1e'g&jOY(OZr(Ors%}s#O(O#O#P&f#P;'S(O;'S;=`(o<%lO(O7R#8gP;=`<%l#5w7Z#8s_)[W(qQ'g&jOY#-YYZ#.[Zr#-Yrs#/csw#-Ywx#5wxz#-Yz{#8j{!P#-Y!P!Q#9r!Q#O#-Y#O#P#2`#P;'S#-Y;'S;=`#:m<%lO#-Y7Z#9}Y)[W(qQT1e'g&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e7Z#:pP;=`<%l#-Y7Z#;OY)[W(qQS1e'g&jOY#:sZr#:srs#;nsw#:swx#@{x#O#:s#O#P#<z#P;'S#:s;'S;=`#At<%lO#:s7X#;wW)[WS1e'g&jOY#;nZw#;nwx#<ax#O#;n#O#P#<z#P;'S#;n;'S;=`#@u<%lO#;n7P#<hUS1e'g&jOY#<aZ#O#<a#O#P#<z#P;'S#<a;'S;=`#>[<%lO#<a7P#=RXS1e'g&jOY#<aYZ%}Z]#<a]^#=n^#O#<a#O#P#>b#P;'S#<a;'S;=`#>[<%lO#<a7P#=uVS1e'g&jOY#<aYZ%}Z#O#<a#O#P#<z#P;'S#<a;'S;=`#>[<%lO#<a7P#>_P;=`<%l#<a7P#>i]S1e'g&jOY#<aYZ%}Z]#<a]^#=n^#O#<a#O#P#>b#P#b#<a#b#c#<a#c#f#<a#f#g#?b#g;'S#<a;'S;=`#>[<%lO#<a7P#?iUS1e'g&jOY#<aZ#O#<a#O#P#?{#P;'S#<a;'S;=`#>[<%lO#<a7P#@SZS1e'g&jOY#<aYZ%}Z]#<a]^#=n^#O#<a#O#P#>b#P#b#<a#b#c#<a#c;'S#<a;'S;=`#>[<%lO#<a7X#@xP;=`<%l#;n7R#AUW(qQS1e'g&jOY#@{Zr#@{rs#<as#O#@{#O#P#<z#P;'S#@{;'S;=`#An<%lO#@{7R#AqP;=`<%l#@{7Z#AwP;=`<%l#:s2]#BVt)[W(qQ!i,g'g&jOY$eZr$ers%^sw$ewx#Dgx!O$e!O!P$ m!P!Q$e!Q![$(x![!g$e!g!h#$w!h!i#*Y!i!n$e!n!o#*Y!o!r$e!r!s#$w!s!w$e!w!x#*Y!x#O$e#O#P&f#P#U$e#U#V$+X#V#X$e#X#Y#$w#Y#Z#*Y#Z#`$e#`#a#*Y#a#d$e#d#e#$w#e#i$e#i#j#*Y#j#l$e#l#m$=`#m;'S$e;'S;=`(u<%lO$e2T#DnY(qQ'g&jOY(OZr(Ors%}s!Q(O!Q![#E^![#O(O#O#P&f#P;'S(O;'S;=`(o<%lO(O2T#Egp(qQ!i,g'g&jOY(OZr(Ors%}sw(Owx#Dgx!O(O!O!P#Gk!P!Q(O!Q![#E^![!g(O!g!h!La!h!i##`!i!n(O!n!o##`!o!r(O!r!s!La!s!w(O!w!x##`!x#O(O#O#P&f#P#X(O#X#Y!La#Y#Z##`#Z#`(O#`#a##`#a#d(O#d#e!La#e#i(O#i#j##`#j;'S(O;'S;=`(o<%lO(O2T#Gtn(qQ!i,g'g&jOY(OZr(Ors%}s!Q(O!Q![#Ir![!c(O!c!g#Ir!g!h#MS!h!i#Ir!i!n(O!n!o##`!o!r(O!r!s!La!s!w(O!w!x##`!x#O(O#O#P&f#P#T(O#T#X#Ir#X#Y#MS#Y#Z#Ir#Z#`(O#`#a##`#a#d(O#d#e!La#e#i(O#i#j##`#j;'S(O;'S;=`(o<%lO(O2T#I{p(qQ!i,g'g&jOY(OZr(Ors%}sw(Owx#LPx!Q(O!Q![#Ir![!c(O!c!g#Ir!g!h#MS!h!i#Ir!i!n(O!n!o##`!o!r(O!r!s!La!s!w(O!w!x##`!x#O(O#O#P&f#P#T(O#T#X#Ir#X#Y#MS#Y#Z#Ir#Z#`(O#`#a##`#a#d(O#d#e!La#e#i(O#i#j##`#j;'S(O;'S;=`(o<%lO(O2T#LW^(qQ'g&jOY(OZr(Ors%}s!Q(O!Q![#Ir![!c(O!c!i#Ir!i#O(O#O#P&f#P#T(O#T#Z#Ir#Z;'S(O;'S;=`(o<%lO(O2T#M]t(qQ!i,g'g&jOY(OZr(Ors%}sw(Owx#LPx{(O{|!Nb|}(O}!O!Nb!O!Q(O!Q![#Ir![!c(O!c!g#Ir!g!h#MS!h!i#Ir!i!n(O!n!o##`!o!r(O!r!s!La!s!w(O!w!x##`!x#O(O#O#P&f#P#T(O#T#X#Ir#X#Y#MS#Y#Z#Ir#Z#`(O#`#a##`#a#d(O#d#e!La#e#i(O#i#j##`#j;'S(O;'S;=`(o<%lO(O2]$ xp)[W(qQ!i,g'g&jOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![$#|![!c$e!c!g$#|!g!h$&]!h!i$#|!i!n$e!n!o#*Y!o!r$e!r!s#$w!s!w$e!w!x#*Y!x#O$e#O#P&f#P#T$e#T#X$#|#X#Y$&]#Y#Z$#|#Z#`$e#`#a#*Y#a#d$e#d#e#$w#e#i$e#i#j#*Y#j;'S$e;'S;=`(u<%lO$e2]$$Xp)[W(qQ!i,g'g&jOY$eZr$ers%^sw$ewx#LPx!Q$e!Q![$#|![!c$e!c!g$#|!g!h$&]!h!i$#|!i!n$e!n!o#*Y!o!r$e!r!s#$w!s!w$e!w!x#*Y!x#O$e#O#P&f#P#T$e#T#X$#|#X#Y$&]#Y#Z$#|#Z#`$e#`#a#*Y#a#d$e#d#e#$w#e#i$e#i#j#*Y#j;'S$e;'S;=`(u<%lO$e2]$&ht)[W(qQ!i,g'g&jOY$eZr$ers%^sw$ewx#LPx{$e{|#'Q|}$e}!O#'Q!O!Q$e!Q![$#|![!c$e!c!g$#|!g!h$&]!h!i$#|!i!n$e!n!o#*Y!o!r$e!r!s#$w!s!w$e!w!x#*Y!x#O$e#O#P&f#P#T$e#T#X$#|#X#Y$&]#Y#Z$#|#Z#`$e#`#a#*Y#a#d$e#d#e#$w#e#i$e#i#j#*Y#j;'S$e;'S;=`(u<%lO$e2]$)Tp)[W(qQ!i,g'g&jOY$eZr$ers%^sw$ewx#Dgx!O$e!O!P$ m!P!Q$e!Q![$(x![!g$e!g!h#$w!h!i#*Y!i!n$e!n!o#*Y!o!r$e!r!s#$w!s!w$e!w!x#*Y!x#O$e#O#P&f#P#X$e#X#Y#$w#Y#Z#*Y#Z#`$e#`#a#*Y#a#d$e#d#e#$w#e#i$e#i#j#*Y#j;'S$e;'S;=`(u<%lO$e2]$+b_)[W(qQ'g&jOY$eZr$ers%^sw$ewx(Ox!O$e!O!P$,a!P!Q$e!Q!R$-`!R![$(x![#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e2]$,j[)[W(qQ'g&jOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![!GY![#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e2]$-kt)[W(qQ!i,g'g&jOY$eZr$ers%^sw$ewx#Dgx!O$e!O!P$ m!P!Q$e!Q![$(x![!g$e!g!h#$w!h!i#*Y!i!n$e!n!o#*Y!o!r$e!r!s#$w!s!w$e!w!x#*Y!x#O$e#O#P&f#P#U$e#U#V$/{#V#X$e#X#Y#$w#Y#Z#*Y#Z#`$e#`#a#*Y#a#d$e#d#e#$w#e#i$e#i#j#*Y#j#l$e#l#m$0z#m;'S$e;'S;=`(u<%lO$e2]$0U[)[W(qQ'g&jOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![$(x![#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e2]$1T`)[W(qQ'g&jOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![$2V![!c$e!c!i$2V!i#O$e#O#P&f#P#T$e#T#Z$2V#Z;'S$e;'S;=`(u<%lO$e2]$2br)[W(qQ!i,g'g&jOY$eZr$ers%^sw$ewx$4lx!O$e!O!P$ m!P!Q$e!Q![$2V![!c$e!c!g$2V!g!h$:p!h!i$2V!i!n$e!n!o#*Y!o!r$e!r!s#$w!s!w$e!w!x#*Y!x#O$e#O#P&f#P#T$e#T#X$2V#X#Y$:p#Y#Z$2V#Z#`$e#`#a#*Y#a#d$e#d#e#$w#e#i$e#i#j#*Y#j;'S$e;'S;=`(u<%lO$e2T$4s^(qQ'g&jOY(OZr(Ors%}s!Q(O!Q![$5o![!c(O!c!i$5o!i#O(O#O#P&f#P#T(O#T#Z$5o#Z;'S(O;'S;=`(o<%lO(O2T$5xr(qQ!i,g'g&jOY(OZr(Ors%}sw(Owx$4lx!O(O!O!P#Gk!P!Q(O!Q![$5o![!c(O!c!g$5o!g!h$8S!h!i$5o!i!n(O!n!o##`!o!r(O!r!s!La!s!w(O!w!x##`!x#O(O#O#P&f#P#T(O#T#X$5o#X#Y$8S#Y#Z$5o#Z#`(O#`#a##`#a#d(O#d#e!La#e#i(O#i#j##`#j;'S(O;'S;=`(o<%lO(O2T$8]u(qQ!i,g'g&jOY(OZr(Ors%}sw(Owx$4lx{(O{|!Nb|}(O}!O!Nb!O!P#Gk!P!Q(O!Q![$5o![!c(O!c!g$5o!g!h$8S!h!i$5o!i!n(O!n!o##`!o!r(O!r!s!La!s!w(O!w!x##`!x#O(O#O#P&f#P#T(O#T#X$5o#X#Y$8S#Y#Z$5o#Z#`(O#`#a##`#a#d(O#d#e!La#e#i(O#i#j##`#j;'S(O;'S;=`(o<%lO(O2]$:{u)[W(qQ!i,g'g&jOY$eZr$ers%^sw$ewx$4lx{$e{|#'Q|}$e}!O#'Q!O!P$ m!P!Q$e!Q![$2V![!c$e!c!g$2V!g!h$:p!h!i$2V!i!n$e!n!o#*Y!o!r$e!r!s#$w!s!w$e!w!x#*Y!x#O$e#O#P&f#P#T$e#T#X$2V#X#Y$:p#Y#Z$2V#Z#`$e#`#a#*Y#a#d$e#d#e#$w#e#i$e#i#j#*Y#j;'S$e;'S;=`(u<%lO$e2]$=ic)[W(qQ'g&jOY$eZr$ers%^sw$ewx(Ox!O$e!O!P$,a!P!Q$e!Q!R$>t!R![$2V![!c$e!c!i$2V!i#O$e#O#P&f#P#T$e#T#Z$2V#Z;'S$e;'S;=`(u<%lO$e2]$?Pv)[W(qQ!i,g'g&jOY$eZr$ers%^sw$ewx$4lx!O$e!O!P$ m!P!Q$e!Q![$2V![!c$e!c!g$2V!g!h$:p!h!i$2V!i!n$e!n!o#*Y!o!r$e!r!s#$w!s!w$e!w!x#*Y!x#O$e#O#P&f#P#T$e#T#U$2V#U#V$2V#V#X$2V#X#Y$:p#Y#Z$2V#Z#`$e#`#a#*Y#a#d$e#d#e#$w#e#i$e#i#j#*Y#j#l$e#l#m$0z#m;'S$e;'S;=`(u<%lO$e4e$Ar[(w-X)[W(qQ'g&jOY$eZr$ers%^sw$ewx(Ox![$e![!]$Bh!]#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3s$BsYl-})[W(qQ'g&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e2]$CnY)X,g)[W(qQ'g&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e7V$Dk_p,g%^!b)[W(qQ'g&jOY$EjYZ$FlZr$Ejrs$GZsw$Ejwx%)Px!^$Ej!^!_%+w!_!`%.U!`!a%0]!a#O$Ej#O#P$Ib#P;'S$Ej;'S;=`%+q<%lO$Ej*[$Es])[W(qQ'g&jOY$EjYZ$FlZr$Ejrs$GZsw$Ejwx%)Px!`$Ej!`!a%*t!a#O$Ej#O#P$Ib#P;'S$Ej;'S;=`%+q<%lO$Ejp$FoTO!`$Fl!`!a$GO!a;'S$Fl;'S;=`$GT<%lO$Flp$GTO$Xpp$GWP;=`<%l$Fl*Y$GbZ)[W'g&jOY$GZYZ$FlZw$GZwx$HTx!`$GZ!`!a%(U!a#O$GZ#O#P$Ib#P;'S$GZ;'S;=`%(y<%lO$GZ*Q$HYX'g&jOY$HTYZ$FlZ!`$HT!`!a$Hu!a#O$HT#O#P$Ib#P;'S$HT;'S;=`$Mx<%lO$HT*Q$IOU$XpY#t'g&jOY%}Z#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}*Q$Ig['g&jOY$HTYZ$HTZ]$HT]^$J]^!`$HT!`!a$NO!a#O$HT#O#P%&n#P;'S$HT;'S;=`%'f;=`<%l%$z<%lO$HT*Q$JbX'g&jOY$HTYZ$J}Z!`$HT!`!a$Hu!a#O$HT#O#P$Ib#P;'S$HT;'S;=`$Mx<%lO$HT'[$KSX'g&jOY$J}YZ$FlZ!`$J}!`!a$Ko!a#O$J}#O#P$LY#P;'S$J};'S;=`$Mr<%lO$J}'[$KvU$Xp'g&jOY%}Z#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}'[$L_Z'g&jOY$J}YZ$J}Z]$J}]^$MQ^!`$J}!`!a$Ko!a#O$J}#O#P$LY#P;'S$J};'S;=`$Mr<%lO$J}'[$MVX'g&jOY$J}YZ$J}Z!`$J}!`!a$Ko!a#O$J}#O#P$LY#P;'S$J};'S;=`$Mr<%lO$J}'[$MuP;=`<%l$J}*Q$M{P;=`<%l$HT*Q$NVW$Xp'g&jOY$NoZ!`$No!`!a% ^!a#O$No#O#P% w#P;'S$No;'S;=`%#^<%lO$No)`$NtW'g&jOY$NoZ!`$No!`!a% ^!a#O$No#O#P% w#P;'S$No;'S;=`%#^<%lO$No)`% eUY#t'g&jOY%}Z#O%}#O#P&f#P;'S%};'S;=`'r<%lO%})`% |Y'g&jOY$NoYZ$NoZ]$No]^%!l^#O$No#O#P%#d#P;'S$No;'S;=`%$[;=`<%l%$z<%lO$No)`%!qX'g&jOY$NoYZ%}Z!`$No!`!a% ^!a#O$No#O#P% w#P;'S$No;'S;=`%#^<%lO$No)`%#aP;=`<%l$No)`%#iZ'g&jOY$NoYZ%}Z]$No]^%!l^!`$No!`!a% ^!a#O$No#O#P% w#P;'S$No;'S;=`%#^<%lO$No)`%$_XOY%$zZ!`%$z!`!a%%g!a#O%$z#O#P%%l#P;'S%$z;'S;=`%&h;=`<%l$No<%lO%$z#t%$}WOY%$zZ!`%$z!`!a%%g!a#O%$z#O#P%%l#P;'S%$z;'S;=`%&h<%lO%$z#t%%lOY#t#t%%oRO;'S%$z;'S;=`%%x;=`O%$z#t%%{XOY%$zZ!`%$z!`!a%%g!a#O%$z#O#P%%l#P;'S%$z;'S;=`%&h;=`<%l%$z<%lO%$z#t%&kP;=`<%l%$z*Q%&sZ'g&jOY$HTYZ$J}Z]$HT]^$J]^!`$HT!`!a$Hu!a#O$HT#O#P$Ib#P;'S$HT;'S;=`$Mx<%lO$HT*Q%'iXOY%$zZ!`%$z!`!a%%g!a#O%$z#O#P%%l#P;'S%$z;'S;=`%&h;=`<%l$HT<%lO%$z*Y%(aW$XpY#t)[W'g&jOY%^Zw%^wx%}x#O%^#O#P&f#P;'S%^;'S;=`'x<%lO%^*Y%(|P;=`<%l$GZ*S%)WZ(qQ'g&jOY%)PYZ$FlZr%)Prs$HTs!`%)P!`!a%)y!a#O%)P#O#P$Ib#P;'S%)P;'S;=`%*n<%lO%)P*S%*UW$XpY#t(qQ'g&jOY(OZr(Ors%}s#O(O#O#P&f#P;'S(O;'S;=`(o<%lO(O*S%*qP;=`<%l%)P*[%+RY$XpY#t)[W(qQ'g&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e*[%+tP;=`<%l$Ej7V%,U^)[W(qQ%]!b!f,g'g&jOY$EjYZ$FlZr$Ejrs$GZsw$Ejwx%)Px!_$Ej!_!`%-Q!`!a%*t!a#O$Ej#O#P$Ib#P;'S$Ej;'S;=`%+q<%lO$Ej7V%-]]!g-y)[W(qQ'g&jOY$EjYZ$FlZr$Ejrs$GZsw$Ejwx%)Px!`$Ej!`!a%*t!a#O$Ej#O#P$Ib#P;'S$Ej;'S;=`%+q<%lO$Ej7V%.c]%^!b!b,g)[W(qQ'g&jOY$EjYZ$FlZr$Ejrs$GZsw$Ejwx%)Px!`$Ej!`!a%/[!a#O$Ej#O#P$Ib#P;'S$Ej;'S;=`%+q<%lO$Ej7V%/mY%^!b!b,g$XpY#t)[W(qQ'g&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e)j%0hYY#t)[W(qQ'g&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o%1c[)k!c)[W(qQ'g&jOY$eZr$ers%^sw$ewx(Ox!_$e!_!`0Q!`#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o%2f]%^!b)[W(qQ!d,g'g&jOY$eZr$ers%^sw$ewx(Ox!_$e!_!`%3_!`!a%4[!a#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o%3lY%^!b!b,g)[W(qQ'g&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o%4i[)[W(qQ%]!b!f,g'g&jOY$eZr$ers%^sw$ewx(Ox!_$e!_!`!8g!`#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e&u%5jY(vP)[W(qQ'g&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e7Z%6ib)[W(zS(qQ!R,f(s%y'g&jOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![%6Y![!c$e!c!}%6Y!}#O$e#O#P&f#P#R$e#R#S%6Y#S#T$e#T#o%6Y#o;'S$e;'S;=`(u<%lO$e7Z%8Qb)[W(zS(qQ!R,f(s%y'g&jOY$eZr$ers%9Ysw$ewx%9{x!Q$e!Q![%6Y![!c$e!c!}%6Y!}#O$e#O#P&f#P#R$e#R#S%6Y#S#T$e#T#o%6Y#o;'S$e;'S;=`(u<%lO$e5P%9cW)[W(p/]'g&jOY%^Zw%^wx%}x#O%^#O#P&f#P;'S%^;'S;=`'x<%lO%^2T%:UW(qQ)Z,g'g&jOY(OZr(Ors%}s#O(O#O#P&f#P;'S(O;'S;=`(o<%lO(O3o%:yZ!V-y)[W(qQ'g&jOY$eZr$ers%^sw$ewx(Ox!}$e!}#O%;l#O#P&f#P;'S$e;'S;=`(u<%lO$e&u%;wY)QP)[W(qQ'g&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e4e%<la'g&jOY%=qYZ%>[Z]%=q]^%?Z^!Q%=q!Q![%?w![!w%=q!w!x%AX!x#O%=q#O#P%H_#P#i%=q#i#j%Ds#j#l%=q#l#m%IR#m;'S%=q;'S;=`%Kt<%lO%=q&t%=xUXY'g&jOY%}Z#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}4e%>e[XY(o.o'g&jOX%}XY-OYZ*[Z]%}]^-O^p%}pq-Oq#O%}#O#P,^#P;'S%};'S;=`'r<%lO%}4e%?bVXY'g&jOY%}YZ-OZ#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}&t%@OWXY'g&jOY%}Z!Q%}!Q![%@h![#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}&t%@oWXY'g&jOY%}Z!Q%}!Q![%=q![#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}&t%A^['g&jOY%}Z!Q%}!Q![%BS![!c%}!c!i%BS!i#O%}#O#P&f#P#T%}#T#Z%BS#Z;'S%};'S;=`'r<%lO%}&t%BX['g&jOY%}Z!Q%}!Q![%B}![!c%}!c!i%B}!i#O%}#O#P&f#P#T%}#T#Z%B}#Z;'S%};'S;=`'r<%lO%}&t%CS['g&jOY%}Z!Q%}!Q![%Cx![!c%}!c!i%Cx!i#O%}#O#P&f#P#T%}#T#Z%Cx#Z;'S%};'S;=`'r<%lO%}&t%C}['g&jOY%}Z!Q%}!Q![%Ds![!c%}!c!i%Ds!i#O%}#O#P&f#P#T%}#T#Z%Ds#Z;'S%};'S;=`'r<%lO%}&t%Dx['g&jOY%}Z!Q%}!Q![%En![!c%}!c!i%En!i#O%}#O#P&f#P#T%}#T#Z%En#Z;'S%};'S;=`'r<%lO%}&t%Es['g&jOY%}Z!Q%}!Q![%Fi![!c%}!c!i%Fi!i#O%}#O#P&f#P#T%}#T#Z%Fi#Z;'S%};'S;=`'r<%lO%}&t%Fn['g&jOY%}Z!Q%}!Q![%Gd![!c%}!c!i%Gd!i#O%}#O#P&f#P#T%}#T#Z%Gd#Z;'S%};'S;=`'r<%lO%}&t%Gi['g&jOY%}Z!Q%}!Q![%=q![!c%}!c!i%=q!i#O%}#O#P&f#P#T%}#T#Z%=q#Z;'S%};'S;=`'r<%lO%}&t%HfXXY'g&jOY%}YZ%}Z]%}]^'W^#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}&t%IW['g&jOY%}Z!Q%}!Q![%I|![!c%}!c!i%I|!i#O%}#O#P&f#P#T%}#T#Z%I|#Z;'S%};'S;=`'r<%lO%}&t%JR['g&jOY%}Z!Q%}!Q![%Jw![!c%}!c!i%Jw!i#O%}#O#P&f#P#T%}#T#Z%Jw#Z;'S%};'S;=`'r<%lO%}&t%KO[XY'g&jOY%}Z!Q%}!Q![%Jw![!c%}!c!i%Jw!i#O%}#O#P&f#P#T%}#T#Z%Jw#Z;'S%};'S;=`'r<%lO%}&t%KwP;=`<%l%=q2a%LVZ!W,V)[W(qQ'g&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P#Q%Lx#Q;'S$e;'S;=`(u<%lO$e'Y%MTY)^d)[W(qQ'g&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o%NQ[)[W(qQ%]!b'g&j!_,gOY$eZr$ers%^sw$ewx(Ox!_$e!_!`!8g!`#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e7Z& Vd)[W(zS(qQ!R,f(s%y'g&jOY$eZr$ers%9Ysw$ewx%9{x!Q$e!Q!Y%6Y!Y!Z%7q!Z![%6Y![!c$e!c!}%6Y!}#O$e#O#P&f#P#R$e#R#S%6Y#S#T$e#T#o%6Y#o;'S$e;'S;=`(u<%lO$e2]&!pY!T,g)[W(qQ'g&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o&#m^)[W(qQ%]!b'g&j!^,gOY$eZr$ers%^sw$ewx(Ox!_$e!_!`!8g!`#O$e#O#P&f#P#p$e#p#q&$i#q;'S$e;'S;=`(u<%lO$e3o&$vY)U,g%_!b)[W(qQ'g&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e'V&%qY!Ua)[W(qQ'g&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e(]&&nc)[W(qQ%]!b'SP'g&jOX$eXY&'yZp$epq&'yqr$ers%^sw$ewx(Ox!c$e!c!}&)_!}#O$e#O#P&f#P#R$e#R#S&)_#S#T$e#T#o&)_#o;'S$e;'S;=`(u<%lO$e&y&(Sc)[W(qQ'g&jOX$eXY&'yZp$epq&'yqr$ers%^sw$ewx(Ox!c$e!c!}&)_!}#O$e#O#P&f#P#R$e#R#S&)_#S#T$e#T#o&)_#o;'S$e;'S;=`(u<%lO$e&y&)jb)[W(qQdT'g&jOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![&)_![!c$e!c!}&)_!}#O$e#O#P&f#P#R$e#R#S&)_#S#T$e#T#o&)_#o;'S$e;'S;=`(u<%lO$e\",\n  tokenizers: [rawString, fallback, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9],\n  topRules: {\"Program\":[0,308]},\n  dynamicPrecedences: {\"87\":1,\"94\":1,\"119\":1,\"185\":1,\"188\":-10,\"241\":-10,\"242\":1,\"245\":-1,\"247\":-10,\"248\":1,\"263\":-1,\"268\":2,\"269\":2,\"307\":-10,\"366\":3,\"418\":1,\"419\":3,\"420\":1,\"421\":1},\n  specialized: [{term: 357, get: value => spec_identifier[value] || -1},{term: 32, get: value => spec_[value] || -1},{term: 66, get: value => spec_templateArgsEnd[value] || -1},{term: 364, get: value => spec_scopedIdentifier[value] || -1}],\n  tokenPrec: 24905\n});\n\nexport { parser };\n","import { parser } from '@lezer/cpp';\nimport { LRLanguage, indentNodeProp, continuedIndent, flatIndent, delimitedIndent, foldNodeProp, foldInside, LanguageSupport } from '@codemirror/language';\n\n/**\nA language provider based on the [Lezer C++\nparser](https://github.com/lezer-parser/cpp), extended with\nhighlighting and indentation information.\n*/\nconst cppLanguage = /*@__PURE__*/LRLanguage.define({\n    name: \"cpp\",\n    parser: /*@__PURE__*/parser.configure({\n        props: [\n            /*@__PURE__*/indentNodeProp.add({\n                IfStatement: /*@__PURE__*/continuedIndent({ except: /^\\s*({|else\\b)/ }),\n                TryStatement: /*@__PURE__*/continuedIndent({ except: /^\\s*({|catch)\\b/ }),\n                LabeledStatement: flatIndent,\n                CaseStatement: context => context.baseIndent + context.unit,\n                BlockComment: () => null,\n                CompoundStatement: /*@__PURE__*/delimitedIndent({ closing: \"}\" }),\n                Statement: /*@__PURE__*/continuedIndent({ except: /^{/ })\n            }),\n            /*@__PURE__*/foldNodeProp.add({\n                \"DeclarationList CompoundStatement EnumeratorList FieldDeclarationList InitializerList\": foldInside,\n                BlockComment(tree) { return { from: tree.from + 2, to: tree.to - 2 }; }\n            })\n        ]\n    }),\n    languageData: {\n        commentTokens: { line: \"//\", block: { open: \"/*\", close: \"*/\" } },\n        indentOnInput: /^\\s*(?:case |default:|\\{|\\})$/,\n        closeBrackets: { stringPrefixes: [\"L\", \"u\", \"U\", \"u8\", \"LR\", \"UR\", \"uR\", \"u8R\", \"R\"] }\n    }\n});\n/**\nLanguage support for C++.\n*/\nfunction cpp() {\n    return new LanguageSupport(cppLanguage);\n}\n\nexport { cpp, cppLanguage };\n","import Main from \"./Main.js\"\r\nimport Fragment01 from './shaders/01-uv-black-white.glsl'\r\nimport Fragment02 from './shaders/02-uv-color.glsl'\r\n\r\nexport default class FragmentList {\r\n    constructor() {\r\n        // Get the main singleton\r\n        this.main   = new Main();\r\n        this.editor = this.main.editor;\r\n\r\n        // Get the html select tag \r\n        this.select = document.getElementById(\"shaders\");\r\n\r\n        this.list = [ \r\n            { name : \"01-uv-black-white\", code : Fragment01 },\r\n            { name : \"02-uv-color\"      , code : Fragment02 }\r\n        ];\r\n\r\n        this.select.addEventListener('change', (event) => {\r\n            for (let i = 0; i < this.list.length; i++) {\r\n                if (this.list[i].name === event.target.value) {\r\n                    this.main.editor.setCode(this.list[i].code);\r\n                    break;\r\n                }\r\n            }            \r\n        });\r\n\r\n        this.generateSelect();\r\n    }\r\n\r\n    getByPos(pos = 0) {\r\n        return this.list[pos].code;\r\n    }\r\n\r\n    generateSelect() {\r\n        let innerHtml = \"\";\r\n        for (let i = 0; i < this.list.length; i++) {\r\n            innerHtml = innerHtml + \"<option value=\" + this.list[i].name + \">\" + this.list[i].name + \"</option>\";\r\n        }\r\n\r\n        this.select.innerHTML = innerHtml;\r\n    }\r\n}","import {basicSetup} from \"codemirror\"\r\nimport {EditorState, Compartment} from \"@codemirror/state\"\r\nimport {EditorView, drawSelection, keymap, lineNumbers} from \"@codemirror/view\"\r\nimport {defaultKeymap, history, historyKeymap} from \"@codemirror/commands\"\r\nimport {syntaxHighlighting, defaultHighlightStyle} from \"@codemirror/language\"\r\nimport {cpp} from '@codemirror/lang-cpp'\r\nimport Main from \"./Main.js\"\r\nimport FragmentList from \"./FragmentList.js\"\r\n\r\n//import Fragment01 from './shaders/01-uv-color.glsl'\r\n\r\n\r\nexport default class Editor {\r\n    constructor() {\r\n        // Link to the main object\r\n        this.main = new Main();\r\n        this.view = this.main.view;\r\n\r\n        this.fragments = new FragmentList();\r\n\r\n        this.start();\r\n    }\r\n\r\n    // Builds and starts the editor\r\n    start() {\r\n\r\n        // setup the theme\r\n/*        this.theme = EditorView.theme({\r\n            \".cm-content, .cm-gutter\" : { \"min-height\" : \"150px\" },\r\n            \".cm-gutters\"             : { \"margin\"     : \"1px\" },\r\n            \".cm-scroller\"            : { \"overflow\"   : \"auto\" },\r\n            \".cm-wrap\"                : { \"border\"     : \"1px solid silver\" }\r\n        }, { dark : false });*/\r\n\r\n        // setup codemirror options\r\n        this.language = new Compartment;\r\n\r\n        this.extensions = [\r\n            keymap.of([...defaultKeymap, ...historyKeymap]),\r\n            history(),\r\n            drawSelection(),\r\n            syntaxHighlighting(defaultHighlightStyle),\r\n            lineNumbers(),\r\n            this.language.of(cpp()),\r\n            EditorView.updateListener.of((v , ViewUpdate) => {\r\n                // Document changed\r\n                if (v.docChanged) {\r\n                    // Clear the console\r\n                    console.clear();\r\n                    \r\n                    this.updateFragment();\r\n                }\r\n            })\r\n        ];\r\n\r\n        this.startState = EditorState.create({\r\n            doc : this.fragments.getByPos(0),\r\n            extensions: this.extensions\r\n        })\r\n\r\n        \r\n        // start codemirror inside of #CodeMirrorDiv \r\n        this.editorView = new EditorView({\r\n            state: this.startState,\r\n            parent: document.getElementById(\"CodeMirrorDiv\")\r\n        })\r\n\r\n        // update the view material code\r\n        this.updateFragment();\r\n    }\r\n\r\n    setCode(code) {\r\n//       this.editorView.setValue(code);\r\n        this.editorView.setState(EditorState.create({ doc: code, extensions: this.extensions }));\r\n\r\n        this.updateFragment();\r\n    }\r\n\r\n    // Apply the updated code to the fragment shader\r\n    updateFragment() {\r\n        this.view.material.fragmentShader = this.editorView.state.doc.toString();    \r\n        this.view.material.needsUpdate = true;\r\n    }\r\n\r\n}","/**\n * @license\n * Copyright 2010-2022 Three.js Authors\n * SPDX-License-Identifier: MIT\n */\nconst REVISION = '148';\nconst MOUSE = { LEFT: 0, MIDDLE: 1, RIGHT: 2, ROTATE: 0, DOLLY: 1, PAN: 2 };\nconst TOUCH = { ROTATE: 0, PAN: 1, DOLLY_PAN: 2, DOLLY_ROTATE: 3 };\nconst CullFaceNone = 0;\nconst CullFaceBack = 1;\nconst CullFaceFront = 2;\nconst CullFaceFrontBack = 3;\nconst BasicShadowMap = 0;\nconst PCFShadowMap = 1;\nconst PCFSoftShadowMap = 2;\nconst VSMShadowMap = 3;\nconst FrontSide = 0;\nconst BackSide = 1;\nconst DoubleSide = 2;\nconst TwoPassDoubleSide = 3;\nconst NoBlending = 0;\nconst NormalBlending = 1;\nconst AdditiveBlending = 2;\nconst SubtractiveBlending = 3;\nconst MultiplyBlending = 4;\nconst CustomBlending = 5;\nconst AddEquation = 100;\nconst SubtractEquation = 101;\nconst ReverseSubtractEquation = 102;\nconst MinEquation = 103;\nconst MaxEquation = 104;\nconst ZeroFactor = 200;\nconst OneFactor = 201;\nconst SrcColorFactor = 202;\nconst OneMinusSrcColorFactor = 203;\nconst SrcAlphaFactor = 204;\nconst OneMinusSrcAlphaFactor = 205;\nconst DstAlphaFactor = 206;\nconst OneMinusDstAlphaFactor = 207;\nconst DstColorFactor = 208;\nconst OneMinusDstColorFactor = 209;\nconst SrcAlphaSaturateFactor = 210;\nconst NeverDepth = 0;\nconst AlwaysDepth = 1;\nconst LessDepth = 2;\nconst LessEqualDepth = 3;\nconst EqualDepth = 4;\nconst GreaterEqualDepth = 5;\nconst GreaterDepth = 6;\nconst NotEqualDepth = 7;\nconst MultiplyOperation = 0;\nconst MixOperation = 1;\nconst AddOperation = 2;\nconst NoToneMapping = 0;\nconst LinearToneMapping = 1;\nconst ReinhardToneMapping = 2;\nconst CineonToneMapping = 3;\nconst ACESFilmicToneMapping = 4;\nconst CustomToneMapping = 5;\n\nconst UVMapping = 300;\nconst CubeReflectionMapping = 301;\nconst CubeRefractionMapping = 302;\nconst EquirectangularReflectionMapping = 303;\nconst EquirectangularRefractionMapping = 304;\nconst CubeUVReflectionMapping = 306;\nconst RepeatWrapping = 1000;\nconst ClampToEdgeWrapping = 1001;\nconst MirroredRepeatWrapping = 1002;\nconst NearestFilter = 1003;\nconst NearestMipmapNearestFilter = 1004;\nconst NearestMipMapNearestFilter = 1004;\nconst NearestMipmapLinearFilter = 1005;\nconst NearestMipMapLinearFilter = 1005;\nconst LinearFilter = 1006;\nconst LinearMipmapNearestFilter = 1007;\nconst LinearMipMapNearestFilter = 1007;\nconst LinearMipmapLinearFilter = 1008;\nconst LinearMipMapLinearFilter = 1008;\nconst UnsignedByteType = 1009;\nconst ByteType = 1010;\nconst ShortType = 1011;\nconst UnsignedShortType = 1012;\nconst IntType = 1013;\nconst UnsignedIntType = 1014;\nconst FloatType = 1015;\nconst HalfFloatType = 1016;\nconst UnsignedShort4444Type = 1017;\nconst UnsignedShort5551Type = 1018;\nconst UnsignedInt248Type = 1020;\nconst AlphaFormat = 1021;\nconst RGBFormat = 1022; // @deprecated since r137\nconst RGBAFormat = 1023;\nconst LuminanceFormat = 1024;\nconst LuminanceAlphaFormat = 1025;\nconst DepthFormat = 1026;\nconst DepthStencilFormat = 1027;\nconst RedFormat = 1028;\nconst RedIntegerFormat = 1029;\nconst RGFormat = 1030;\nconst RGIntegerFormat = 1031;\nconst RGBAIntegerFormat = 1033;\n\nconst RGB_S3TC_DXT1_Format = 33776;\nconst RGBA_S3TC_DXT1_Format = 33777;\nconst RGBA_S3TC_DXT3_Format = 33778;\nconst RGBA_S3TC_DXT5_Format = 33779;\nconst RGB_PVRTC_4BPPV1_Format = 35840;\nconst RGB_PVRTC_2BPPV1_Format = 35841;\nconst RGBA_PVRTC_4BPPV1_Format = 35842;\nconst RGBA_PVRTC_2BPPV1_Format = 35843;\nconst RGB_ETC1_Format = 36196;\nconst RGB_ETC2_Format = 37492;\nconst RGBA_ETC2_EAC_Format = 37496;\nconst RGBA_ASTC_4x4_Format = 37808;\nconst RGBA_ASTC_5x4_Format = 37809;\nconst RGBA_ASTC_5x5_Format = 37810;\nconst RGBA_ASTC_6x5_Format = 37811;\nconst RGBA_ASTC_6x6_Format = 37812;\nconst RGBA_ASTC_8x5_Format = 37813;\nconst RGBA_ASTC_8x6_Format = 37814;\nconst RGBA_ASTC_8x8_Format = 37815;\nconst RGBA_ASTC_10x5_Format = 37816;\nconst RGBA_ASTC_10x6_Format = 37817;\nconst RGBA_ASTC_10x8_Format = 37818;\nconst RGBA_ASTC_10x10_Format = 37819;\nconst RGBA_ASTC_12x10_Format = 37820;\nconst RGBA_ASTC_12x12_Format = 37821;\nconst RGBA_BPTC_Format = 36492;\nconst LoopOnce = 2200;\nconst LoopRepeat = 2201;\nconst LoopPingPong = 2202;\nconst InterpolateDiscrete = 2300;\nconst InterpolateLinear = 2301;\nconst InterpolateSmooth = 2302;\nconst ZeroCurvatureEnding = 2400;\nconst ZeroSlopeEnding = 2401;\nconst WrapAroundEnding = 2402;\nconst NormalAnimationBlendMode = 2500;\nconst AdditiveAnimationBlendMode = 2501;\nconst TrianglesDrawMode = 0;\nconst TriangleStripDrawMode = 1;\nconst TriangleFanDrawMode = 2;\nconst LinearEncoding = 3000;\nconst sRGBEncoding = 3001;\nconst BasicDepthPacking = 3200;\nconst RGBADepthPacking = 3201;\nconst TangentSpaceNormalMap = 0;\nconst ObjectSpaceNormalMap = 1;\n\n// Color space string identifiers, matching CSS Color Module Level 4 and WebGPU names where available.\nconst NoColorSpace = '';\nconst SRGBColorSpace = 'srgb';\nconst LinearSRGBColorSpace = 'srgb-linear';\n\nconst ZeroStencilOp = 0;\nconst KeepStencilOp = 7680;\nconst ReplaceStencilOp = 7681;\nconst IncrementStencilOp = 7682;\nconst DecrementStencilOp = 7683;\nconst IncrementWrapStencilOp = 34055;\nconst DecrementWrapStencilOp = 34056;\nconst InvertStencilOp = 5386;\n\nconst NeverStencilFunc = 512;\nconst LessStencilFunc = 513;\nconst EqualStencilFunc = 514;\nconst LessEqualStencilFunc = 515;\nconst GreaterStencilFunc = 516;\nconst NotEqualStencilFunc = 517;\nconst GreaterEqualStencilFunc = 518;\nconst AlwaysStencilFunc = 519;\n\nconst StaticDrawUsage = 35044;\nconst DynamicDrawUsage = 35048;\nconst StreamDrawUsage = 35040;\nconst StaticReadUsage = 35045;\nconst DynamicReadUsage = 35049;\nconst StreamReadUsage = 35041;\nconst StaticCopyUsage = 35046;\nconst DynamicCopyUsage = 35050;\nconst StreamCopyUsage = 35042;\n\nconst GLSL1 = '100';\nconst GLSL3 = '300 es';\n\nconst _SRGBAFormat = 1035; // fallback for WebGL 1\n\n/**\n * https://github.com/mrdoob/eventdispatcher.js/\n */\n\nclass EventDispatcher {\n\n\taddEventListener( type, listener ) {\n\n\t\tif ( this._listeners === undefined ) this._listeners = {};\n\n\t\tconst listeners = this._listeners;\n\n\t\tif ( listeners[ type ] === undefined ) {\n\n\t\t\tlisteners[ type ] = [];\n\n\t\t}\n\n\t\tif ( listeners[ type ].indexOf( listener ) === - 1 ) {\n\n\t\t\tlisteners[ type ].push( listener );\n\n\t\t}\n\n\t}\n\n\thasEventListener( type, listener ) {\n\n\t\tif ( this._listeners === undefined ) return false;\n\n\t\tconst listeners = this._listeners;\n\n\t\treturn listeners[ type ] !== undefined && listeners[ type ].indexOf( listener ) !== - 1;\n\n\t}\n\n\tremoveEventListener( type, listener ) {\n\n\t\tif ( this._listeners === undefined ) return;\n\n\t\tconst listeners = this._listeners;\n\t\tconst listenerArray = listeners[ type ];\n\n\t\tif ( listenerArray !== undefined ) {\n\n\t\t\tconst index = listenerArray.indexOf( listener );\n\n\t\t\tif ( index !== - 1 ) {\n\n\t\t\t\tlistenerArray.splice( index, 1 );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tdispatchEvent( event ) {\n\n\t\tif ( this._listeners === undefined ) return;\n\n\t\tconst listeners = this._listeners;\n\t\tconst listenerArray = listeners[ event.type ];\n\n\t\tif ( listenerArray !== undefined ) {\n\n\t\t\tevent.target = this;\n\n\t\t\t// Make a copy, in case listeners are removed while iterating.\n\t\t\tconst array = listenerArray.slice( 0 );\n\n\t\t\tfor ( let i = 0, l = array.length; i < l; i ++ ) {\n\n\t\t\t\tarray[ i ].call( this, event );\n\n\t\t\t}\n\n\t\t\tevent.target = null;\n\n\t\t}\n\n\t}\n\n}\n\nconst _lut = [ '00', '01', '02', '03', '04', '05', '06', '07', '08', '09', '0a', '0b', '0c', '0d', '0e', '0f', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '1a', '1b', '1c', '1d', '1e', '1f', '20', '21', '22', '23', '24', '25', '26', '27', '28', '29', '2a', '2b', '2c', '2d', '2e', '2f', '30', '31', '32', '33', '34', '35', '36', '37', '38', '39', '3a', '3b', '3c', '3d', '3e', '3f', '40', '41', '42', '43', '44', '45', '46', '47', '48', '49', '4a', '4b', '4c', '4d', '4e', '4f', '50', '51', '52', '53', '54', '55', '56', '57', '58', '59', '5a', '5b', '5c', '5d', '5e', '5f', '60', '61', '62', '63', '64', '65', '66', '67', '68', '69', '6a', '6b', '6c', '6d', '6e', '6f', '70', '71', '72', '73', '74', '75', '76', '77', '78', '79', '7a', '7b', '7c', '7d', '7e', '7f', '80', '81', '82', '83', '84', '85', '86', '87', '88', '89', '8a', '8b', '8c', '8d', '8e', '8f', '90', '91', '92', '93', '94', '95', '96', '97', '98', '99', '9a', '9b', '9c', '9d', '9e', '9f', 'a0', 'a1', 'a2', 'a3', 'a4', 'a5', 'a6', 'a7', 'a8', 'a9', 'aa', 'ab', 'ac', 'ad', 'ae', 'af', 'b0', 'b1', 'b2', 'b3', 'b4', 'b5', 'b6', 'b7', 'b8', 'b9', 'ba', 'bb', 'bc', 'bd', 'be', 'bf', 'c0', 'c1', 'c2', 'c3', 'c4', 'c5', 'c6', 'c7', 'c8', 'c9', 'ca', 'cb', 'cc', 'cd', 'ce', 'cf', 'd0', 'd1', 'd2', 'd3', 'd4', 'd5', 'd6', 'd7', 'd8', 'd9', 'da', 'db', 'dc', 'dd', 'de', 'df', 'e0', 'e1', 'e2', 'e3', 'e4', 'e5', 'e6', 'e7', 'e8', 'e9', 'ea', 'eb', 'ec', 'ed', 'ee', 'ef', 'f0', 'f1', 'f2', 'f3', 'f4', 'f5', 'f6', 'f7', 'f8', 'f9', 'fa', 'fb', 'fc', 'fd', 'fe', 'ff' ];\n\nlet _seed = 1234567;\n\n\nconst DEG2RAD = Math.PI / 180;\nconst RAD2DEG = 180 / Math.PI;\n\n// http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript/21963136#21963136\nfunction generateUUID() {\n\n\tconst d0 = Math.random() * 0xffffffff | 0;\n\tconst d1 = Math.random() * 0xffffffff | 0;\n\tconst d2 = Math.random() * 0xffffffff | 0;\n\tconst d3 = Math.random() * 0xffffffff | 0;\n\tconst uuid = _lut[ d0 & 0xff ] + _lut[ d0 >> 8 & 0xff ] + _lut[ d0 >> 16 & 0xff ] + _lut[ d0 >> 24 & 0xff ] + '-' +\n\t\t\t_lut[ d1 & 0xff ] + _lut[ d1 >> 8 & 0xff ] + '-' + _lut[ d1 >> 16 & 0x0f | 0x40 ] + _lut[ d1 >> 24 & 0xff ] + '-' +\n\t\t\t_lut[ d2 & 0x3f | 0x80 ] + _lut[ d2 >> 8 & 0xff ] + '-' + _lut[ d2 >> 16 & 0xff ] + _lut[ d2 >> 24 & 0xff ] +\n\t\t\t_lut[ d3 & 0xff ] + _lut[ d3 >> 8 & 0xff ] + _lut[ d3 >> 16 & 0xff ] + _lut[ d3 >> 24 & 0xff ];\n\n\t// .toLowerCase() here flattens concatenated strings to save heap memory space.\n\treturn uuid.toLowerCase();\n\n}\n\nfunction clamp( value, min, max ) {\n\n\treturn Math.max( min, Math.min( max, value ) );\n\n}\n\n// compute euclidean modulo of m % n\n// https://en.wikipedia.org/wiki/Modulo_operation\nfunction euclideanModulo( n, m ) {\n\n\treturn ( ( n % m ) + m ) % m;\n\n}\n\n// Linear mapping from range <a1, a2> to range <b1, b2>\nfunction mapLinear( x, a1, a2, b1, b2 ) {\n\n\treturn b1 + ( x - a1 ) * ( b2 - b1 ) / ( a2 - a1 );\n\n}\n\n// https://www.gamedev.net/tutorials/programming/general-and-gameplay-programming/inverse-lerp-a-super-useful-yet-often-overlooked-function-r5230/\nfunction inverseLerp( x, y, value ) {\n\n\tif ( x !== y ) {\n\n\t\treturn ( value - x ) / ( y - x );\n\n\t} else {\n\n\t\treturn 0;\n\n\t}\n\n}\n\n// https://en.wikipedia.org/wiki/Linear_interpolation\nfunction lerp( x, y, t ) {\n\n\treturn ( 1 - t ) * x + t * y;\n\n}\n\n// http://www.rorydriscoll.com/2016/03/07/frame-rate-independent-damping-using-lerp/\nfunction damp( x, y, lambda, dt ) {\n\n\treturn lerp( x, y, 1 - Math.exp( - lambda * dt ) );\n\n}\n\n// https://www.desmos.com/calculator/vcsjnyz7x4\nfunction pingpong( x, length = 1 ) {\n\n\treturn length - Math.abs( euclideanModulo( x, length * 2 ) - length );\n\n}\n\n// http://en.wikipedia.org/wiki/Smoothstep\nfunction smoothstep( x, min, max ) {\n\n\tif ( x <= min ) return 0;\n\tif ( x >= max ) return 1;\n\n\tx = ( x - min ) / ( max - min );\n\n\treturn x * x * ( 3 - 2 * x );\n\n}\n\nfunction smootherstep( x, min, max ) {\n\n\tif ( x <= min ) return 0;\n\tif ( x >= max ) return 1;\n\n\tx = ( x - min ) / ( max - min );\n\n\treturn x * x * x * ( x * ( x * 6 - 15 ) + 10 );\n\n}\n\n// Random integer from <low, high> interval\nfunction randInt( low, high ) {\n\n\treturn low + Math.floor( Math.random() * ( high - low + 1 ) );\n\n}\n\n// Random float from <low, high> interval\nfunction randFloat( low, high ) {\n\n\treturn low + Math.random() * ( high - low );\n\n}\n\n// Random float from <-range/2, range/2> interval\nfunction randFloatSpread( range ) {\n\n\treturn range * ( 0.5 - Math.random() );\n\n}\n\n// Deterministic pseudo-random float in the interval [ 0, 1 ]\nfunction seededRandom( s ) {\n\n\tif ( s !== undefined ) _seed = s;\n\n\t// Mulberry32 generator\n\n\tlet t = _seed += 0x6D2B79F5;\n\n\tt = Math.imul( t ^ t >>> 15, t | 1 );\n\n\tt ^= t + Math.imul( t ^ t >>> 7, t | 61 );\n\n\treturn ( ( t ^ t >>> 14 ) >>> 0 ) / 4294967296;\n\n}\n\nfunction degToRad( degrees ) {\n\n\treturn degrees * DEG2RAD;\n\n}\n\nfunction radToDeg( radians ) {\n\n\treturn radians * RAD2DEG;\n\n}\n\nfunction isPowerOfTwo( value ) {\n\n\treturn ( value & ( value - 1 ) ) === 0 && value !== 0;\n\n}\n\nfunction ceilPowerOfTwo( value ) {\n\n\treturn Math.pow( 2, Math.ceil( Math.log( value ) / Math.LN2 ) );\n\n}\n\nfunction floorPowerOfTwo( value ) {\n\n\treturn Math.pow( 2, Math.floor( Math.log( value ) / Math.LN2 ) );\n\n}\n\nfunction setQuaternionFromProperEuler( q, a, b, c, order ) {\n\n\t// Intrinsic Proper Euler Angles - see https://en.wikipedia.org/wiki/Euler_angles\n\n\t// rotations are applied to the axes in the order specified by 'order'\n\t// rotation by angle 'a' is applied first, then by angle 'b', then by angle 'c'\n\t// angles are in radians\n\n\tconst cos = Math.cos;\n\tconst sin = Math.sin;\n\n\tconst c2 = cos( b / 2 );\n\tconst s2 = sin( b / 2 );\n\n\tconst c13 = cos( ( a + c ) / 2 );\n\tconst s13 = sin( ( a + c ) / 2 );\n\n\tconst c1_3 = cos( ( a - c ) / 2 );\n\tconst s1_3 = sin( ( a - c ) / 2 );\n\n\tconst c3_1 = cos( ( c - a ) / 2 );\n\tconst s3_1 = sin( ( c - a ) / 2 );\n\n\tswitch ( order ) {\n\n\t\tcase 'XYX':\n\t\t\tq.set( c2 * s13, s2 * c1_3, s2 * s1_3, c2 * c13 );\n\t\t\tbreak;\n\n\t\tcase 'YZY':\n\t\t\tq.set( s2 * s1_3, c2 * s13, s2 * c1_3, c2 * c13 );\n\t\t\tbreak;\n\n\t\tcase 'ZXZ':\n\t\t\tq.set( s2 * c1_3, s2 * s1_3, c2 * s13, c2 * c13 );\n\t\t\tbreak;\n\n\t\tcase 'XZX':\n\t\t\tq.set( c2 * s13, s2 * s3_1, s2 * c3_1, c2 * c13 );\n\t\t\tbreak;\n\n\t\tcase 'YXY':\n\t\t\tq.set( s2 * c3_1, c2 * s13, s2 * s3_1, c2 * c13 );\n\t\t\tbreak;\n\n\t\tcase 'ZYZ':\n\t\t\tq.set( s2 * s3_1, s2 * c3_1, c2 * s13, c2 * c13 );\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tconsole.warn( 'THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: ' + order );\n\n\t}\n\n}\n\nfunction denormalize( value, array ) {\n\n\tswitch ( array.constructor ) {\n\n\t\tcase Float32Array:\n\n\t\t\treturn value;\n\n\t\tcase Uint16Array:\n\n\t\t\treturn value / 65535.0;\n\n\t\tcase Uint8Array:\n\n\t\t\treturn value / 255.0;\n\n\t\tcase Int16Array:\n\n\t\t\treturn Math.max( value / 32767.0, - 1.0 );\n\n\t\tcase Int8Array:\n\n\t\t\treturn Math.max( value / 127.0, - 1.0 );\n\n\t\tdefault:\n\n\t\t\tthrow new Error( 'Invalid component type.' );\n\n\t}\n\n}\n\nfunction normalize( value, array ) {\n\n\tswitch ( array.constructor ) {\n\n\t\tcase Float32Array:\n\n\t\t\treturn value;\n\n\t\tcase Uint16Array:\n\n\t\t\treturn Math.round( value * 65535.0 );\n\n\t\tcase Uint8Array:\n\n\t\t\treturn Math.round( value * 255.0 );\n\n\t\tcase Int16Array:\n\n\t\t\treturn Math.round( value * 32767.0 );\n\n\t\tcase Int8Array:\n\n\t\t\treturn Math.round( value * 127.0 );\n\n\t\tdefault:\n\n\t\t\tthrow new Error( 'Invalid component type.' );\n\n\t}\n\n}\n\nvar MathUtils = /*#__PURE__*/Object.freeze({\n\t__proto__: null,\n\tDEG2RAD: DEG2RAD,\n\tRAD2DEG: RAD2DEG,\n\tgenerateUUID: generateUUID,\n\tclamp: clamp,\n\teuclideanModulo: euclideanModulo,\n\tmapLinear: mapLinear,\n\tinverseLerp: inverseLerp,\n\tlerp: lerp,\n\tdamp: damp,\n\tpingpong: pingpong,\n\tsmoothstep: smoothstep,\n\tsmootherstep: smootherstep,\n\trandInt: randInt,\n\trandFloat: randFloat,\n\trandFloatSpread: randFloatSpread,\n\tseededRandom: seededRandom,\n\tdegToRad: degToRad,\n\tradToDeg: radToDeg,\n\tisPowerOfTwo: isPowerOfTwo,\n\tceilPowerOfTwo: ceilPowerOfTwo,\n\tfloorPowerOfTwo: floorPowerOfTwo,\n\tsetQuaternionFromProperEuler: setQuaternionFromProperEuler,\n\tnormalize: normalize,\n\tdenormalize: denormalize\n});\n\nclass Vector2 {\n\n\tconstructor( x = 0, y = 0 ) {\n\n\t\tVector2.prototype.isVector2 = true;\n\n\t\tthis.x = x;\n\t\tthis.y = y;\n\n\t}\n\n\tget width() {\n\n\t\treturn this.x;\n\n\t}\n\n\tset width( value ) {\n\n\t\tthis.x = value;\n\n\t}\n\n\tget height() {\n\n\t\treturn this.y;\n\n\t}\n\n\tset height( value ) {\n\n\t\tthis.y = value;\n\n\t}\n\n\tset( x, y ) {\n\n\t\tthis.x = x;\n\t\tthis.y = y;\n\n\t\treturn this;\n\n\t}\n\n\tsetScalar( scalar ) {\n\n\t\tthis.x = scalar;\n\t\tthis.y = scalar;\n\n\t\treturn this;\n\n\t}\n\n\tsetX( x ) {\n\n\t\tthis.x = x;\n\n\t\treturn this;\n\n\t}\n\n\tsetY( y ) {\n\n\t\tthis.y = y;\n\n\t\treturn this;\n\n\t}\n\n\tsetComponent( index, value ) {\n\n\t\tswitch ( index ) {\n\n\t\t\tcase 0: this.x = value; break;\n\t\t\tcase 1: this.y = value; break;\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tgetComponent( index ) {\n\n\t\tswitch ( index ) {\n\n\t\t\tcase 0: return this.x;\n\t\t\tcase 1: return this.y;\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t}\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this.x, this.y );\n\n\t}\n\n\tcopy( v ) {\n\n\t\tthis.x = v.x;\n\t\tthis.y = v.y;\n\n\t\treturn this;\n\n\t}\n\n\tadd( v ) {\n\n\t\tthis.x += v.x;\n\t\tthis.y += v.y;\n\n\t\treturn this;\n\n\t}\n\n\taddScalar( s ) {\n\n\t\tthis.x += s;\n\t\tthis.y += s;\n\n\t\treturn this;\n\n\t}\n\n\taddVectors( a, b ) {\n\n\t\tthis.x = a.x + b.x;\n\t\tthis.y = a.y + b.y;\n\n\t\treturn this;\n\n\t}\n\n\taddScaledVector( v, s ) {\n\n\t\tthis.x += v.x * s;\n\t\tthis.y += v.y * s;\n\n\t\treturn this;\n\n\t}\n\n\tsub( v ) {\n\n\t\tthis.x -= v.x;\n\t\tthis.y -= v.y;\n\n\t\treturn this;\n\n\t}\n\n\tsubScalar( s ) {\n\n\t\tthis.x -= s;\n\t\tthis.y -= s;\n\n\t\treturn this;\n\n\t}\n\n\tsubVectors( a, b ) {\n\n\t\tthis.x = a.x - b.x;\n\t\tthis.y = a.y - b.y;\n\n\t\treturn this;\n\n\t}\n\n\tmultiply( v ) {\n\n\t\tthis.x *= v.x;\n\t\tthis.y *= v.y;\n\n\t\treturn this;\n\n\t}\n\n\tmultiplyScalar( scalar ) {\n\n\t\tthis.x *= scalar;\n\t\tthis.y *= scalar;\n\n\t\treturn this;\n\n\t}\n\n\tdivide( v ) {\n\n\t\tthis.x /= v.x;\n\t\tthis.y /= v.y;\n\n\t\treturn this;\n\n\t}\n\n\tdivideScalar( scalar ) {\n\n\t\treturn this.multiplyScalar( 1 / scalar );\n\n\t}\n\n\tapplyMatrix3( m ) {\n\n\t\tconst x = this.x, y = this.y;\n\t\tconst e = m.elements;\n\n\t\tthis.x = e[ 0 ] * x + e[ 3 ] * y + e[ 6 ];\n\t\tthis.y = e[ 1 ] * x + e[ 4 ] * y + e[ 7 ];\n\n\t\treturn this;\n\n\t}\n\n\tmin( v ) {\n\n\t\tthis.x = Math.min( this.x, v.x );\n\t\tthis.y = Math.min( this.y, v.y );\n\n\t\treturn this;\n\n\t}\n\n\tmax( v ) {\n\n\t\tthis.x = Math.max( this.x, v.x );\n\t\tthis.y = Math.max( this.y, v.y );\n\n\t\treturn this;\n\n\t}\n\n\tclamp( min, max ) {\n\n\t\t// assumes min < max, componentwise\n\n\t\tthis.x = Math.max( min.x, Math.min( max.x, this.x ) );\n\t\tthis.y = Math.max( min.y, Math.min( max.y, this.y ) );\n\n\t\treturn this;\n\n\t}\n\n\tclampScalar( minVal, maxVal ) {\n\n\t\tthis.x = Math.max( minVal, Math.min( maxVal, this.x ) );\n\t\tthis.y = Math.max( minVal, Math.min( maxVal, this.y ) );\n\n\t\treturn this;\n\n\t}\n\n\tclampLength( min, max ) {\n\n\t\tconst length = this.length();\n\n\t\treturn this.divideScalar( length || 1 ).multiplyScalar( Math.max( min, Math.min( max, length ) ) );\n\n\t}\n\n\tfloor() {\n\n\t\tthis.x = Math.floor( this.x );\n\t\tthis.y = Math.floor( this.y );\n\n\t\treturn this;\n\n\t}\n\n\tceil() {\n\n\t\tthis.x = Math.ceil( this.x );\n\t\tthis.y = Math.ceil( this.y );\n\n\t\treturn this;\n\n\t}\n\n\tround() {\n\n\t\tthis.x = Math.round( this.x );\n\t\tthis.y = Math.round( this.y );\n\n\t\treturn this;\n\n\t}\n\n\troundToZero() {\n\n\t\tthis.x = ( this.x < 0 ) ? Math.ceil( this.x ) : Math.floor( this.x );\n\t\tthis.y = ( this.y < 0 ) ? Math.ceil( this.y ) : Math.floor( this.y );\n\n\t\treturn this;\n\n\t}\n\n\tnegate() {\n\n\t\tthis.x = - this.x;\n\t\tthis.y = - this.y;\n\n\t\treturn this;\n\n\t}\n\n\tdot( v ) {\n\n\t\treturn this.x * v.x + this.y * v.y;\n\n\t}\n\n\tcross( v ) {\n\n\t\treturn this.x * v.y - this.y * v.x;\n\n\t}\n\n\tlengthSq() {\n\n\t\treturn this.x * this.x + this.y * this.y;\n\n\t}\n\n\tlength() {\n\n\t\treturn Math.sqrt( this.x * this.x + this.y * this.y );\n\n\t}\n\n\tmanhattanLength() {\n\n\t\treturn Math.abs( this.x ) + Math.abs( this.y );\n\n\t}\n\n\tnormalize() {\n\n\t\treturn this.divideScalar( this.length() || 1 );\n\n\t}\n\n\tangle() {\n\n\t\t// computes the angle in radians with respect to the positive x-axis\n\n\t\tconst angle = Math.atan2( - this.y, - this.x ) + Math.PI;\n\n\t\treturn angle;\n\n\t}\n\n\tdistanceTo( v ) {\n\n\t\treturn Math.sqrt( this.distanceToSquared( v ) );\n\n\t}\n\n\tdistanceToSquared( v ) {\n\n\t\tconst dx = this.x - v.x, dy = this.y - v.y;\n\t\treturn dx * dx + dy * dy;\n\n\t}\n\n\tmanhattanDistanceTo( v ) {\n\n\t\treturn Math.abs( this.x - v.x ) + Math.abs( this.y - v.y );\n\n\t}\n\n\tsetLength( length ) {\n\n\t\treturn this.normalize().multiplyScalar( length );\n\n\t}\n\n\tlerp( v, alpha ) {\n\n\t\tthis.x += ( v.x - this.x ) * alpha;\n\t\tthis.y += ( v.y - this.y ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tlerpVectors( v1, v2, alpha ) {\n\n\t\tthis.x = v1.x + ( v2.x - v1.x ) * alpha;\n\t\tthis.y = v1.y + ( v2.y - v1.y ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tequals( v ) {\n\n\t\treturn ( ( v.x === this.x ) && ( v.y === this.y ) );\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tthis.x = array[ offset ];\n\t\tthis.y = array[ offset + 1 ];\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tarray[ offset ] = this.x;\n\t\tarray[ offset + 1 ] = this.y;\n\n\t\treturn array;\n\n\t}\n\n\tfromBufferAttribute( attribute, index ) {\n\n\t\tthis.x = attribute.getX( index );\n\t\tthis.y = attribute.getY( index );\n\n\t\treturn this;\n\n\t}\n\n\trotateAround( center, angle ) {\n\n\t\tconst c = Math.cos( angle ), s = Math.sin( angle );\n\n\t\tconst x = this.x - center.x;\n\t\tconst y = this.y - center.y;\n\n\t\tthis.x = x * c - y * s + center.x;\n\t\tthis.y = x * s + y * c + center.y;\n\n\t\treturn this;\n\n\t}\n\n\trandom() {\n\n\t\tthis.x = Math.random();\n\t\tthis.y = Math.random();\n\n\t\treturn this;\n\n\t}\n\n\t*[ Symbol.iterator ]() {\n\n\t\tyield this.x;\n\t\tyield this.y;\n\n\t}\n\n}\n\nclass Matrix3 {\n\n\tconstructor() {\n\n\t\tMatrix3.prototype.isMatrix3 = true;\n\n\t\tthis.elements = [\n\n\t\t\t1, 0, 0,\n\t\t\t0, 1, 0,\n\t\t\t0, 0, 1\n\n\t\t];\n\n\t}\n\n\tset( n11, n12, n13, n21, n22, n23, n31, n32, n33 ) {\n\n\t\tconst te = this.elements;\n\n\t\tte[ 0 ] = n11; te[ 1 ] = n21; te[ 2 ] = n31;\n\t\tte[ 3 ] = n12; te[ 4 ] = n22; te[ 5 ] = n32;\n\t\tte[ 6 ] = n13; te[ 7 ] = n23; te[ 8 ] = n33;\n\n\t\treturn this;\n\n\t}\n\n\tidentity() {\n\n\t\tthis.set(\n\n\t\t\t1, 0, 0,\n\t\t\t0, 1, 0,\n\t\t\t0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tcopy( m ) {\n\n\t\tconst te = this.elements;\n\t\tconst me = m.elements;\n\n\t\tte[ 0 ] = me[ 0 ]; te[ 1 ] = me[ 1 ]; te[ 2 ] = me[ 2 ];\n\t\tte[ 3 ] = me[ 3 ]; te[ 4 ] = me[ 4 ]; te[ 5 ] = me[ 5 ];\n\t\tte[ 6 ] = me[ 6 ]; te[ 7 ] = me[ 7 ]; te[ 8 ] = me[ 8 ];\n\n\t\treturn this;\n\n\t}\n\n\textractBasis( xAxis, yAxis, zAxis ) {\n\n\t\txAxis.setFromMatrix3Column( this, 0 );\n\t\tyAxis.setFromMatrix3Column( this, 1 );\n\t\tzAxis.setFromMatrix3Column( this, 2 );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromMatrix4( m ) {\n\n\t\tconst me = m.elements;\n\n\t\tthis.set(\n\n\t\t\tme[ 0 ], me[ 4 ], me[ 8 ],\n\t\t\tme[ 1 ], me[ 5 ], me[ 9 ],\n\t\t\tme[ 2 ], me[ 6 ], me[ 10 ]\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tmultiply( m ) {\n\n\t\treturn this.multiplyMatrices( this, m );\n\n\t}\n\n\tpremultiply( m ) {\n\n\t\treturn this.multiplyMatrices( m, this );\n\n\t}\n\n\tmultiplyMatrices( a, b ) {\n\n\t\tconst ae = a.elements;\n\t\tconst be = b.elements;\n\t\tconst te = this.elements;\n\n\t\tconst a11 = ae[ 0 ], a12 = ae[ 3 ], a13 = ae[ 6 ];\n\t\tconst a21 = ae[ 1 ], a22 = ae[ 4 ], a23 = ae[ 7 ];\n\t\tconst a31 = ae[ 2 ], a32 = ae[ 5 ], a33 = ae[ 8 ];\n\n\t\tconst b11 = be[ 0 ], b12 = be[ 3 ], b13 = be[ 6 ];\n\t\tconst b21 = be[ 1 ], b22 = be[ 4 ], b23 = be[ 7 ];\n\t\tconst b31 = be[ 2 ], b32 = be[ 5 ], b33 = be[ 8 ];\n\n\t\tte[ 0 ] = a11 * b11 + a12 * b21 + a13 * b31;\n\t\tte[ 3 ] = a11 * b12 + a12 * b22 + a13 * b32;\n\t\tte[ 6 ] = a11 * b13 + a12 * b23 + a13 * b33;\n\n\t\tte[ 1 ] = a21 * b11 + a22 * b21 + a23 * b31;\n\t\tte[ 4 ] = a21 * b12 + a22 * b22 + a23 * b32;\n\t\tte[ 7 ] = a21 * b13 + a22 * b23 + a23 * b33;\n\n\t\tte[ 2 ] = a31 * b11 + a32 * b21 + a33 * b31;\n\t\tte[ 5 ] = a31 * b12 + a32 * b22 + a33 * b32;\n\t\tte[ 8 ] = a31 * b13 + a32 * b23 + a33 * b33;\n\n\t\treturn this;\n\n\t}\n\n\tmultiplyScalar( s ) {\n\n\t\tconst te = this.elements;\n\n\t\tte[ 0 ] *= s; te[ 3 ] *= s; te[ 6 ] *= s;\n\t\tte[ 1 ] *= s; te[ 4 ] *= s; te[ 7 ] *= s;\n\t\tte[ 2 ] *= s; te[ 5 ] *= s; te[ 8 ] *= s;\n\n\t\treturn this;\n\n\t}\n\n\tdeterminant() {\n\n\t\tconst te = this.elements;\n\n\t\tconst a = te[ 0 ], b = te[ 1 ], c = te[ 2 ],\n\t\t\td = te[ 3 ], e = te[ 4 ], f = te[ 5 ],\n\t\t\tg = te[ 6 ], h = te[ 7 ], i = te[ 8 ];\n\n\t\treturn a * e * i - a * f * h - b * d * i + b * f * g + c * d * h - c * e * g;\n\n\t}\n\n\tinvert() {\n\n\t\tconst te = this.elements,\n\n\t\t\tn11 = te[ 0 ], n21 = te[ 1 ], n31 = te[ 2 ],\n\t\t\tn12 = te[ 3 ], n22 = te[ 4 ], n32 = te[ 5 ],\n\t\t\tn13 = te[ 6 ], n23 = te[ 7 ], n33 = te[ 8 ],\n\n\t\t\tt11 = n33 * n22 - n32 * n23,\n\t\t\tt12 = n32 * n13 - n33 * n12,\n\t\t\tt13 = n23 * n12 - n22 * n13,\n\n\t\t\tdet = n11 * t11 + n21 * t12 + n31 * t13;\n\n\t\tif ( det === 0 ) return this.set( 0, 0, 0, 0, 0, 0, 0, 0, 0 );\n\n\t\tconst detInv = 1 / det;\n\n\t\tte[ 0 ] = t11 * detInv;\n\t\tte[ 1 ] = ( n31 * n23 - n33 * n21 ) * detInv;\n\t\tte[ 2 ] = ( n32 * n21 - n31 * n22 ) * detInv;\n\n\t\tte[ 3 ] = t12 * detInv;\n\t\tte[ 4 ] = ( n33 * n11 - n31 * n13 ) * detInv;\n\t\tte[ 5 ] = ( n31 * n12 - n32 * n11 ) * detInv;\n\n\t\tte[ 6 ] = t13 * detInv;\n\t\tte[ 7 ] = ( n21 * n13 - n23 * n11 ) * detInv;\n\t\tte[ 8 ] = ( n22 * n11 - n21 * n12 ) * detInv;\n\n\t\treturn this;\n\n\t}\n\n\ttranspose() {\n\n\t\tlet tmp;\n\t\tconst m = this.elements;\n\n\t\ttmp = m[ 1 ]; m[ 1 ] = m[ 3 ]; m[ 3 ] = tmp;\n\t\ttmp = m[ 2 ]; m[ 2 ] = m[ 6 ]; m[ 6 ] = tmp;\n\t\ttmp = m[ 5 ]; m[ 5 ] = m[ 7 ]; m[ 7 ] = tmp;\n\n\t\treturn this;\n\n\t}\n\n\tgetNormalMatrix( matrix4 ) {\n\n\t\treturn this.setFromMatrix4( matrix4 ).invert().transpose();\n\n\t}\n\n\ttransposeIntoArray( r ) {\n\n\t\tconst m = this.elements;\n\n\t\tr[ 0 ] = m[ 0 ];\n\t\tr[ 1 ] = m[ 3 ];\n\t\tr[ 2 ] = m[ 6 ];\n\t\tr[ 3 ] = m[ 1 ];\n\t\tr[ 4 ] = m[ 4 ];\n\t\tr[ 5 ] = m[ 7 ];\n\t\tr[ 6 ] = m[ 2 ];\n\t\tr[ 7 ] = m[ 5 ];\n\t\tr[ 8 ] = m[ 8 ];\n\n\t\treturn this;\n\n\t}\n\n\tsetUvTransform( tx, ty, sx, sy, rotation, cx, cy ) {\n\n\t\tconst c = Math.cos( rotation );\n\t\tconst s = Math.sin( rotation );\n\n\t\tthis.set(\n\t\t\tsx * c, sx * s, - sx * ( c * cx + s * cy ) + cx + tx,\n\t\t\t- sy * s, sy * c, - sy * ( - s * cx + c * cy ) + cy + ty,\n\t\t\t0, 0, 1\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\t//\n\n\tscale( sx, sy ) {\n\n\t\tthis.premultiply( _m3.makeScale( sx, sy ) );\n\n\t\treturn this;\n\n\t}\n\n\trotate( theta ) {\n\n\t\tthis.premultiply( _m3.makeRotation( - theta ) );\n\n\t\treturn this;\n\n\t}\n\n\ttranslate( tx, ty ) {\n\n\t\tthis.premultiply( _m3.makeTranslation( tx, ty ) );\n\n\t\treturn this;\n\n\t}\n\n\t// for 2D Transforms\n\n\tmakeTranslation( x, y ) {\n\n\t\tthis.set(\n\n\t\t\t1, 0, x,\n\t\t\t0, 1, y,\n\t\t\t0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tmakeRotation( theta ) {\n\n\t\t// counterclockwise\n\n\t\tconst c = Math.cos( theta );\n\t\tconst s = Math.sin( theta );\n\n\t\tthis.set(\n\n\t\t\tc, - s, 0,\n\t\t\ts, c, 0,\n\t\t\t0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tmakeScale( x, y ) {\n\n\t\tthis.set(\n\n\t\t\tx, 0, 0,\n\t\t\t0, y, 0,\n\t\t\t0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\t//\n\n\tequals( matrix ) {\n\n\t\tconst te = this.elements;\n\t\tconst me = matrix.elements;\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tif ( te[ i ] !== me[ i ] ) return false;\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tthis.elements[ i ] = array[ i + offset ];\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tconst te = this.elements;\n\n\t\tarray[ offset ] = te[ 0 ];\n\t\tarray[ offset + 1 ] = te[ 1 ];\n\t\tarray[ offset + 2 ] = te[ 2 ];\n\n\t\tarray[ offset + 3 ] = te[ 3 ];\n\t\tarray[ offset + 4 ] = te[ 4 ];\n\t\tarray[ offset + 5 ] = te[ 5 ];\n\n\t\tarray[ offset + 6 ] = te[ 6 ];\n\t\tarray[ offset + 7 ] = te[ 7 ];\n\t\tarray[ offset + 8 ] = te[ 8 ];\n\n\t\treturn array;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().fromArray( this.elements );\n\n\t}\n\n}\n\nconst _m3 = /*@__PURE__*/ new Matrix3();\n\nfunction arrayNeedsUint32( array ) {\n\n\t// assumes larger values usually on last\n\n\tfor ( let i = array.length - 1; i >= 0; -- i ) {\n\n\t\tif ( array[ i ] >= 65535 ) return true; // account for PRIMITIVE_RESTART_FIXED_INDEX, #24565\n\n\t}\n\n\treturn false;\n\n}\n\nconst TYPED_ARRAYS = {\n\tInt8Array: Int8Array,\n\tUint8Array: Uint8Array,\n\tUint8ClampedArray: Uint8ClampedArray,\n\tInt16Array: Int16Array,\n\tUint16Array: Uint16Array,\n\tInt32Array: Int32Array,\n\tUint32Array: Uint32Array,\n\tFloat32Array: Float32Array,\n\tFloat64Array: Float64Array\n};\n\nfunction getTypedArray( type, buffer ) {\n\n\treturn new TYPED_ARRAYS[ type ]( buffer );\n\n}\n\nfunction createElementNS( name ) {\n\n\treturn document.createElementNS( 'http://www.w3.org/1999/xhtml', name );\n\n}\n\nfunction SRGBToLinear( c ) {\n\n\treturn ( c < 0.04045 ) ? c * 0.0773993808 : Math.pow( c * 0.9478672986 + 0.0521327014, 2.4 );\n\n}\n\nfunction LinearToSRGB( c ) {\n\n\treturn ( c < 0.0031308 ) ? c * 12.92 : 1.055 * ( Math.pow( c, 0.41666 ) ) - 0.055;\n\n}\n\n// JavaScript RGB-to-RGB transforms, defined as\n// FN[InputColorSpace][OutputColorSpace] callback functions.\nconst FN = {\n\t[ SRGBColorSpace ]: { [ LinearSRGBColorSpace ]: SRGBToLinear },\n\t[ LinearSRGBColorSpace ]: { [ SRGBColorSpace ]: LinearToSRGB },\n};\n\nconst ColorManagement = {\n\n\tlegacyMode: true,\n\n\tget workingColorSpace() {\n\n\t\treturn LinearSRGBColorSpace;\n\n\t},\n\n\tset workingColorSpace( colorSpace ) {\n\n\t\tconsole.warn( 'THREE.ColorManagement: .workingColorSpace is readonly.' );\n\n\t},\n\n\tconvert: function ( color, sourceColorSpace, targetColorSpace ) {\n\n\t\tif ( this.legacyMode || sourceColorSpace === targetColorSpace || ! sourceColorSpace || ! targetColorSpace ) {\n\n\t\t\treturn color;\n\n\t\t}\n\n\t\tif ( FN[ sourceColorSpace ] && FN[ sourceColorSpace ][ targetColorSpace ] !== undefined ) {\n\n\t\t\tconst fn = FN[ sourceColorSpace ][ targetColorSpace ];\n\n\t\t\tcolor.r = fn( color.r );\n\t\t\tcolor.g = fn( color.g );\n\t\t\tcolor.b = fn( color.b );\n\n\t\t\treturn color;\n\n\t\t}\n\n\t\tthrow new Error( 'Unsupported color space conversion.' );\n\n\t},\n\n\tfromWorkingColorSpace: function ( color, targetColorSpace ) {\n\n\t\treturn this.convert( color, this.workingColorSpace, targetColorSpace );\n\n\t},\n\n\ttoWorkingColorSpace: function ( color, sourceColorSpace ) {\n\n\t\treturn this.convert( color, sourceColorSpace, this.workingColorSpace );\n\n\t},\n\n};\n\nconst _colorKeywords = { 'aliceblue': 0xF0F8FF, 'antiquewhite': 0xFAEBD7, 'aqua': 0x00FFFF, 'aquamarine': 0x7FFFD4, 'azure': 0xF0FFFF,\n\t'beige': 0xF5F5DC, 'bisque': 0xFFE4C4, 'black': 0x000000, 'blanchedalmond': 0xFFEBCD, 'blue': 0x0000FF, 'blueviolet': 0x8A2BE2,\n\t'brown': 0xA52A2A, 'burlywood': 0xDEB887, 'cadetblue': 0x5F9EA0, 'chartreuse': 0x7FFF00, 'chocolate': 0xD2691E, 'coral': 0xFF7F50,\n\t'cornflowerblue': 0x6495ED, 'cornsilk': 0xFFF8DC, 'crimson': 0xDC143C, 'cyan': 0x00FFFF, 'darkblue': 0x00008B, 'darkcyan': 0x008B8B,\n\t'darkgoldenrod': 0xB8860B, 'darkgray': 0xA9A9A9, 'darkgreen': 0x006400, 'darkgrey': 0xA9A9A9, 'darkkhaki': 0xBDB76B, 'darkmagenta': 0x8B008B,\n\t'darkolivegreen': 0x556B2F, 'darkorange': 0xFF8C00, 'darkorchid': 0x9932CC, 'darkred': 0x8B0000, 'darksalmon': 0xE9967A, 'darkseagreen': 0x8FBC8F,\n\t'darkslateblue': 0x483D8B, 'darkslategray': 0x2F4F4F, 'darkslategrey': 0x2F4F4F, 'darkturquoise': 0x00CED1, 'darkviolet': 0x9400D3,\n\t'deeppink': 0xFF1493, 'deepskyblue': 0x00BFFF, 'dimgray': 0x696969, 'dimgrey': 0x696969, 'dodgerblue': 0x1E90FF, 'firebrick': 0xB22222,\n\t'floralwhite': 0xFFFAF0, 'forestgreen': 0x228B22, 'fuchsia': 0xFF00FF, 'gainsboro': 0xDCDCDC, 'ghostwhite': 0xF8F8FF, 'gold': 0xFFD700,\n\t'goldenrod': 0xDAA520, 'gray': 0x808080, 'green': 0x008000, 'greenyellow': 0xADFF2F, 'grey': 0x808080, 'honeydew': 0xF0FFF0, 'hotpink': 0xFF69B4,\n\t'indianred': 0xCD5C5C, 'indigo': 0x4B0082, 'ivory': 0xFFFFF0, 'khaki': 0xF0E68C, 'lavender': 0xE6E6FA, 'lavenderblush': 0xFFF0F5, 'lawngreen': 0x7CFC00,\n\t'lemonchiffon': 0xFFFACD, 'lightblue': 0xADD8E6, 'lightcoral': 0xF08080, 'lightcyan': 0xE0FFFF, 'lightgoldenrodyellow': 0xFAFAD2, 'lightgray': 0xD3D3D3,\n\t'lightgreen': 0x90EE90, 'lightgrey': 0xD3D3D3, 'lightpink': 0xFFB6C1, 'lightsalmon': 0xFFA07A, 'lightseagreen': 0x20B2AA, 'lightskyblue': 0x87CEFA,\n\t'lightslategray': 0x778899, 'lightslategrey': 0x778899, 'lightsteelblue': 0xB0C4DE, 'lightyellow': 0xFFFFE0, 'lime': 0x00FF00, 'limegreen': 0x32CD32,\n\t'linen': 0xFAF0E6, 'magenta': 0xFF00FF, 'maroon': 0x800000, 'mediumaquamarine': 0x66CDAA, 'mediumblue': 0x0000CD, 'mediumorchid': 0xBA55D3,\n\t'mediumpurple': 0x9370DB, 'mediumseagreen': 0x3CB371, 'mediumslateblue': 0x7B68EE, 'mediumspringgreen': 0x00FA9A, 'mediumturquoise': 0x48D1CC,\n\t'mediumvioletred': 0xC71585, 'midnightblue': 0x191970, 'mintcream': 0xF5FFFA, 'mistyrose': 0xFFE4E1, 'moccasin': 0xFFE4B5, 'navajowhite': 0xFFDEAD,\n\t'navy': 0x000080, 'oldlace': 0xFDF5E6, 'olive': 0x808000, 'olivedrab': 0x6B8E23, 'orange': 0xFFA500, 'orangered': 0xFF4500, 'orchid': 0xDA70D6,\n\t'palegoldenrod': 0xEEE8AA, 'palegreen': 0x98FB98, 'paleturquoise': 0xAFEEEE, 'palevioletred': 0xDB7093, 'papayawhip': 0xFFEFD5, 'peachpuff': 0xFFDAB9,\n\t'peru': 0xCD853F, 'pink': 0xFFC0CB, 'plum': 0xDDA0DD, 'powderblue': 0xB0E0E6, 'purple': 0x800080, 'rebeccapurple': 0x663399, 'red': 0xFF0000, 'rosybrown': 0xBC8F8F,\n\t'royalblue': 0x4169E1, 'saddlebrown': 0x8B4513, 'salmon': 0xFA8072, 'sandybrown': 0xF4A460, 'seagreen': 0x2E8B57, 'seashell': 0xFFF5EE,\n\t'sienna': 0xA0522D, 'silver': 0xC0C0C0, 'skyblue': 0x87CEEB, 'slateblue': 0x6A5ACD, 'slategray': 0x708090, 'slategrey': 0x708090, 'snow': 0xFFFAFA,\n\t'springgreen': 0x00FF7F, 'steelblue': 0x4682B4, 'tan': 0xD2B48C, 'teal': 0x008080, 'thistle': 0xD8BFD8, 'tomato': 0xFF6347, 'turquoise': 0x40E0D0,\n\t'violet': 0xEE82EE, 'wheat': 0xF5DEB3, 'white': 0xFFFFFF, 'whitesmoke': 0xF5F5F5, 'yellow': 0xFFFF00, 'yellowgreen': 0x9ACD32 };\n\nconst _rgb$1 = { r: 0, g: 0, b: 0 };\nconst _hslA = { h: 0, s: 0, l: 0 };\nconst _hslB = { h: 0, s: 0, l: 0 };\n\nfunction hue2rgb( p, q, t ) {\n\n\tif ( t < 0 ) t += 1;\n\tif ( t > 1 ) t -= 1;\n\tif ( t < 1 / 6 ) return p + ( q - p ) * 6 * t;\n\tif ( t < 1 / 2 ) return q;\n\tif ( t < 2 / 3 ) return p + ( q - p ) * 6 * ( 2 / 3 - t );\n\treturn p;\n\n}\n\nfunction toComponents( source, target ) {\n\n\ttarget.r = source.r;\n\ttarget.g = source.g;\n\ttarget.b = source.b;\n\n\treturn target;\n\n}\n\nclass Color {\n\n\tconstructor( r, g, b ) {\n\n\t\tthis.isColor = true;\n\n\t\tthis.r = 1;\n\t\tthis.g = 1;\n\t\tthis.b = 1;\n\n\t\tif ( g === undefined && b === undefined ) {\n\n\t\t\t// r is THREE.Color, hex or string\n\t\t\treturn this.set( r );\n\n\t\t}\n\n\t\treturn this.setRGB( r, g, b );\n\n\t}\n\n\tset( value ) {\n\n\t\tif ( value && value.isColor ) {\n\n\t\t\tthis.copy( value );\n\n\t\t} else if ( typeof value === 'number' ) {\n\n\t\t\tthis.setHex( value );\n\n\t\t} else if ( typeof value === 'string' ) {\n\n\t\t\tthis.setStyle( value );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetScalar( scalar ) {\n\n\t\tthis.r = scalar;\n\t\tthis.g = scalar;\n\t\tthis.b = scalar;\n\n\t\treturn this;\n\n\t}\n\n\tsetHex( hex, colorSpace = SRGBColorSpace ) {\n\n\t\thex = Math.floor( hex );\n\n\t\tthis.r = ( hex >> 16 & 255 ) / 255;\n\t\tthis.g = ( hex >> 8 & 255 ) / 255;\n\t\tthis.b = ( hex & 255 ) / 255;\n\n\t\tColorManagement.toWorkingColorSpace( this, colorSpace );\n\n\t\treturn this;\n\n\t}\n\n\tsetRGB( r, g, b, colorSpace = ColorManagement.workingColorSpace ) {\n\n\t\tthis.r = r;\n\t\tthis.g = g;\n\t\tthis.b = b;\n\n\t\tColorManagement.toWorkingColorSpace( this, colorSpace );\n\n\t\treturn this;\n\n\t}\n\n\tsetHSL( h, s, l, colorSpace = ColorManagement.workingColorSpace ) {\n\n\t\t// h,s,l ranges are in 0.0 - 1.0\n\t\th = euclideanModulo( h, 1 );\n\t\ts = clamp( s, 0, 1 );\n\t\tl = clamp( l, 0, 1 );\n\n\t\tif ( s === 0 ) {\n\n\t\t\tthis.r = this.g = this.b = l;\n\n\t\t} else {\n\n\t\t\tconst p = l <= 0.5 ? l * ( 1 + s ) : l + s - ( l * s );\n\t\t\tconst q = ( 2 * l ) - p;\n\n\t\t\tthis.r = hue2rgb( q, p, h + 1 / 3 );\n\t\t\tthis.g = hue2rgb( q, p, h );\n\t\t\tthis.b = hue2rgb( q, p, h - 1 / 3 );\n\n\t\t}\n\n\t\tColorManagement.toWorkingColorSpace( this, colorSpace );\n\n\t\treturn this;\n\n\t}\n\n\tsetStyle( style, colorSpace = SRGBColorSpace ) {\n\n\t\tfunction handleAlpha( string ) {\n\n\t\t\tif ( string === undefined ) return;\n\n\t\t\tif ( parseFloat( string ) < 1 ) {\n\n\t\t\t\tconsole.warn( 'THREE.Color: Alpha component of ' + style + ' will be ignored.' );\n\n\t\t\t}\n\n\t\t}\n\n\n\t\tlet m;\n\n\t\tif ( m = /^((?:rgb|hsl)a?)\\(([^\\)]*)\\)/.exec( style ) ) {\n\n\t\t\t// rgb / hsl\n\n\t\t\tlet color;\n\t\t\tconst name = m[ 1 ];\n\t\t\tconst components = m[ 2 ];\n\n\t\t\tswitch ( name ) {\n\n\t\t\t\tcase 'rgb':\n\t\t\t\tcase 'rgba':\n\n\t\t\t\t\tif ( color = /^\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*(?:,\\s*(\\d*\\.?\\d+)\\s*)?$/.exec( components ) ) {\n\n\t\t\t\t\t\t// rgb(255,0,0) rgba(255,0,0,0.5)\n\t\t\t\t\t\tthis.r = Math.min( 255, parseInt( color[ 1 ], 10 ) ) / 255;\n\t\t\t\t\t\tthis.g = Math.min( 255, parseInt( color[ 2 ], 10 ) ) / 255;\n\t\t\t\t\t\tthis.b = Math.min( 255, parseInt( color[ 3 ], 10 ) ) / 255;\n\n\t\t\t\t\t\tColorManagement.toWorkingColorSpace( this, colorSpace );\n\n\t\t\t\t\t\thandleAlpha( color[ 4 ] );\n\n\t\t\t\t\t\treturn this;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( color = /^\\s*(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*(?:,\\s*(\\d*\\.?\\d+)\\s*)?$/.exec( components ) ) {\n\n\t\t\t\t\t\t// rgb(100%,0%,0%) rgba(100%,0%,0%,0.5)\n\t\t\t\t\t\tthis.r = Math.min( 100, parseInt( color[ 1 ], 10 ) ) / 100;\n\t\t\t\t\t\tthis.g = Math.min( 100, parseInt( color[ 2 ], 10 ) ) / 100;\n\t\t\t\t\t\tthis.b = Math.min( 100, parseInt( color[ 3 ], 10 ) ) / 100;\n\n\t\t\t\t\t\tColorManagement.toWorkingColorSpace( this, colorSpace );\n\n\t\t\t\t\t\thandleAlpha( color[ 4 ] );\n\n\t\t\t\t\t\treturn this;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'hsl':\n\t\t\t\tcase 'hsla':\n\n\t\t\t\t\tif ( color = /^\\s*(\\d*\\.?\\d+)\\s*,\\s*(\\d*\\.?\\d+)\\%\\s*,\\s*(\\d*\\.?\\d+)\\%\\s*(?:,\\s*(\\d*\\.?\\d+)\\s*)?$/.exec( components ) ) {\n\n\t\t\t\t\t\t// hsl(120,50%,50%) hsla(120,50%,50%,0.5)\n\t\t\t\t\t\tconst h = parseFloat( color[ 1 ] ) / 360;\n\t\t\t\t\t\tconst s = parseFloat( color[ 2 ] ) / 100;\n\t\t\t\t\t\tconst l = parseFloat( color[ 3 ] ) / 100;\n\n\t\t\t\t\t\thandleAlpha( color[ 4 ] );\n\n\t\t\t\t\t\treturn this.setHSL( h, s, l, colorSpace );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t} else if ( m = /^\\#([A-Fa-f\\d]+)$/.exec( style ) ) {\n\n\t\t\t// hex color\n\n\t\t\tconst hex = m[ 1 ];\n\t\t\tconst size = hex.length;\n\n\t\t\tif ( size === 3 ) {\n\n\t\t\t\t// #ff0\n\t\t\t\tthis.r = parseInt( hex.charAt( 0 ) + hex.charAt( 0 ), 16 ) / 255;\n\t\t\t\tthis.g = parseInt( hex.charAt( 1 ) + hex.charAt( 1 ), 16 ) / 255;\n\t\t\t\tthis.b = parseInt( hex.charAt( 2 ) + hex.charAt( 2 ), 16 ) / 255;\n\n\t\t\t\tColorManagement.toWorkingColorSpace( this, colorSpace );\n\n\t\t\t\treturn this;\n\n\t\t\t} else if ( size === 6 ) {\n\n\t\t\t\t// #ff0000\n\t\t\t\tthis.r = parseInt( hex.charAt( 0 ) + hex.charAt( 1 ), 16 ) / 255;\n\t\t\t\tthis.g = parseInt( hex.charAt( 2 ) + hex.charAt( 3 ), 16 ) / 255;\n\t\t\t\tthis.b = parseInt( hex.charAt( 4 ) + hex.charAt( 5 ), 16 ) / 255;\n\n\t\t\t\tColorManagement.toWorkingColorSpace( this, colorSpace );\n\n\t\t\t\treturn this;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( style && style.length > 0 ) {\n\n\t\t\treturn this.setColorName( style, colorSpace );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetColorName( style, colorSpace = SRGBColorSpace ) {\n\n\t\t// color keywords\n\t\tconst hex = _colorKeywords[ style.toLowerCase() ];\n\n\t\tif ( hex !== undefined ) {\n\n\t\t\t// red\n\t\t\tthis.setHex( hex, colorSpace );\n\n\t\t} else {\n\n\t\t\t// unknown color\n\t\t\tconsole.warn( 'THREE.Color: Unknown color ' + style );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this.r, this.g, this.b );\n\n\t}\n\n\tcopy( color ) {\n\n\t\tthis.r = color.r;\n\t\tthis.g = color.g;\n\t\tthis.b = color.b;\n\n\t\treturn this;\n\n\t}\n\n\tcopySRGBToLinear( color ) {\n\n\t\tthis.r = SRGBToLinear( color.r );\n\t\tthis.g = SRGBToLinear( color.g );\n\t\tthis.b = SRGBToLinear( color.b );\n\n\t\treturn this;\n\n\t}\n\n\tcopyLinearToSRGB( color ) {\n\n\t\tthis.r = LinearToSRGB( color.r );\n\t\tthis.g = LinearToSRGB( color.g );\n\t\tthis.b = LinearToSRGB( color.b );\n\n\t\treturn this;\n\n\t}\n\n\tconvertSRGBToLinear() {\n\n\t\tthis.copySRGBToLinear( this );\n\n\t\treturn this;\n\n\t}\n\n\tconvertLinearToSRGB() {\n\n\t\tthis.copyLinearToSRGB( this );\n\n\t\treturn this;\n\n\t}\n\n\tgetHex( colorSpace = SRGBColorSpace ) {\n\n\t\tColorManagement.fromWorkingColorSpace( toComponents( this, _rgb$1 ), colorSpace );\n\n\t\treturn clamp( _rgb$1.r * 255, 0, 255 ) << 16 ^ clamp( _rgb$1.g * 255, 0, 255 ) << 8 ^ clamp( _rgb$1.b * 255, 0, 255 ) << 0;\n\n\t}\n\n\tgetHexString( colorSpace = SRGBColorSpace ) {\n\n\t\treturn ( '000000' + this.getHex( colorSpace ).toString( 16 ) ).slice( - 6 );\n\n\t}\n\n\tgetHSL( target, colorSpace = ColorManagement.workingColorSpace ) {\n\n\t\t// h,s,l ranges are in 0.0 - 1.0\n\n\t\tColorManagement.fromWorkingColorSpace( toComponents( this, _rgb$1 ), colorSpace );\n\n\t\tconst r = _rgb$1.r, g = _rgb$1.g, b = _rgb$1.b;\n\n\t\tconst max = Math.max( r, g, b );\n\t\tconst min = Math.min( r, g, b );\n\n\t\tlet hue, saturation;\n\t\tconst lightness = ( min + max ) / 2.0;\n\n\t\tif ( min === max ) {\n\n\t\t\thue = 0;\n\t\t\tsaturation = 0;\n\n\t\t} else {\n\n\t\t\tconst delta = max - min;\n\n\t\t\tsaturation = lightness <= 0.5 ? delta / ( max + min ) : delta / ( 2 - max - min );\n\n\t\t\tswitch ( max ) {\n\n\t\t\t\tcase r: hue = ( g - b ) / delta + ( g < b ? 6 : 0 ); break;\n\t\t\t\tcase g: hue = ( b - r ) / delta + 2; break;\n\t\t\t\tcase b: hue = ( r - g ) / delta + 4; break;\n\n\t\t\t}\n\n\t\t\thue /= 6;\n\n\t\t}\n\n\t\ttarget.h = hue;\n\t\ttarget.s = saturation;\n\t\ttarget.l = lightness;\n\n\t\treturn target;\n\n\t}\n\n\tgetRGB( target, colorSpace = ColorManagement.workingColorSpace ) {\n\n\t\tColorManagement.fromWorkingColorSpace( toComponents( this, _rgb$1 ), colorSpace );\n\n\t\ttarget.r = _rgb$1.r;\n\t\ttarget.g = _rgb$1.g;\n\t\ttarget.b = _rgb$1.b;\n\n\t\treturn target;\n\n\t}\n\n\tgetStyle( colorSpace = SRGBColorSpace ) {\n\n\t\tColorManagement.fromWorkingColorSpace( toComponents( this, _rgb$1 ), colorSpace );\n\n\t\tif ( colorSpace !== SRGBColorSpace ) {\n\n\t\t\t// Requires CSS Color Module Level 4 (https://www.w3.org/TR/css-color-4/).\n\t\t\treturn `color(${ colorSpace } ${ _rgb$1.r } ${ _rgb$1.g } ${ _rgb$1.b })`;\n\n\t\t}\n\n\t\treturn `rgb(${( _rgb$1.r * 255 ) | 0},${( _rgb$1.g * 255 ) | 0},${( _rgb$1.b * 255 ) | 0})`;\n\n\t}\n\n\toffsetHSL( h, s, l ) {\n\n\t\tthis.getHSL( _hslA );\n\n\t\t_hslA.h += h; _hslA.s += s; _hslA.l += l;\n\n\t\tthis.setHSL( _hslA.h, _hslA.s, _hslA.l );\n\n\t\treturn this;\n\n\t}\n\n\tadd( color ) {\n\n\t\tthis.r += color.r;\n\t\tthis.g += color.g;\n\t\tthis.b += color.b;\n\n\t\treturn this;\n\n\t}\n\n\taddColors( color1, color2 ) {\n\n\t\tthis.r = color1.r + color2.r;\n\t\tthis.g = color1.g + color2.g;\n\t\tthis.b = color1.b + color2.b;\n\n\t\treturn this;\n\n\t}\n\n\taddScalar( s ) {\n\n\t\tthis.r += s;\n\t\tthis.g += s;\n\t\tthis.b += s;\n\n\t\treturn this;\n\n\t}\n\n\tsub( color ) {\n\n\t\tthis.r = Math.max( 0, this.r - color.r );\n\t\tthis.g = Math.max( 0, this.g - color.g );\n\t\tthis.b = Math.max( 0, this.b - color.b );\n\n\t\treturn this;\n\n\t}\n\n\tmultiply( color ) {\n\n\t\tthis.r *= color.r;\n\t\tthis.g *= color.g;\n\t\tthis.b *= color.b;\n\n\t\treturn this;\n\n\t}\n\n\tmultiplyScalar( s ) {\n\n\t\tthis.r *= s;\n\t\tthis.g *= s;\n\t\tthis.b *= s;\n\n\t\treturn this;\n\n\t}\n\n\tlerp( color, alpha ) {\n\n\t\tthis.r += ( color.r - this.r ) * alpha;\n\t\tthis.g += ( color.g - this.g ) * alpha;\n\t\tthis.b += ( color.b - this.b ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tlerpColors( color1, color2, alpha ) {\n\n\t\tthis.r = color1.r + ( color2.r - color1.r ) * alpha;\n\t\tthis.g = color1.g + ( color2.g - color1.g ) * alpha;\n\t\tthis.b = color1.b + ( color2.b - color1.b ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tlerpHSL( color, alpha ) {\n\n\t\tthis.getHSL( _hslA );\n\t\tcolor.getHSL( _hslB );\n\n\t\tconst h = lerp( _hslA.h, _hslB.h, alpha );\n\t\tconst s = lerp( _hslA.s, _hslB.s, alpha );\n\t\tconst l = lerp( _hslA.l, _hslB.l, alpha );\n\n\t\tthis.setHSL( h, s, l );\n\n\t\treturn this;\n\n\t}\n\n\tequals( c ) {\n\n\t\treturn ( c.r === this.r ) && ( c.g === this.g ) && ( c.b === this.b );\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tthis.r = array[ offset ];\n\t\tthis.g = array[ offset + 1 ];\n\t\tthis.b = array[ offset + 2 ];\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tarray[ offset ] = this.r;\n\t\tarray[ offset + 1 ] = this.g;\n\t\tarray[ offset + 2 ] = this.b;\n\n\t\treturn array;\n\n\t}\n\n\tfromBufferAttribute( attribute, index ) {\n\n\t\tthis.r = attribute.getX( index );\n\t\tthis.g = attribute.getY( index );\n\t\tthis.b = attribute.getZ( index );\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\treturn this.getHex();\n\n\t}\n\n\t*[ Symbol.iterator ]() {\n\n\t\tyield this.r;\n\t\tyield this.g;\n\t\tyield this.b;\n\n\t}\n\n}\n\nColor.NAMES = _colorKeywords;\n\nlet _canvas;\n\nclass ImageUtils {\n\n\tstatic getDataURL( image ) {\n\n\t\tif ( /^data:/i.test( image.src ) ) {\n\n\t\t\treturn image.src;\n\n\t\t}\n\n\t\tif ( typeof HTMLCanvasElement == 'undefined' ) {\n\n\t\t\treturn image.src;\n\n\t\t}\n\n\t\tlet canvas;\n\n\t\tif ( image instanceof HTMLCanvasElement ) {\n\n\t\t\tcanvas = image;\n\n\t\t} else {\n\n\t\t\tif ( _canvas === undefined ) _canvas = createElementNS( 'canvas' );\n\n\t\t\t_canvas.width = image.width;\n\t\t\t_canvas.height = image.height;\n\n\t\t\tconst context = _canvas.getContext( '2d' );\n\n\t\t\tif ( image instanceof ImageData ) {\n\n\t\t\t\tcontext.putImageData( image, 0, 0 );\n\n\t\t\t} else {\n\n\t\t\t\tcontext.drawImage( image, 0, 0, image.width, image.height );\n\n\t\t\t}\n\n\t\t\tcanvas = _canvas;\n\n\t\t}\n\n\t\tif ( canvas.width > 2048 || canvas.height > 2048 ) {\n\n\t\t\tconsole.warn( 'THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons', image );\n\n\t\t\treturn canvas.toDataURL( 'image/jpeg', 0.6 );\n\n\t\t} else {\n\n\t\t\treturn canvas.toDataURL( 'image/png' );\n\n\t\t}\n\n\t}\n\n\tstatic sRGBToLinear( image ) {\n\n\t\tif ( ( typeof HTMLImageElement !== 'undefined' && image instanceof HTMLImageElement ) ||\n\t\t\t( typeof HTMLCanvasElement !== 'undefined' && image instanceof HTMLCanvasElement ) ||\n\t\t\t( typeof ImageBitmap !== 'undefined' && image instanceof ImageBitmap ) ) {\n\n\t\t\tconst canvas = createElementNS( 'canvas' );\n\n\t\t\tcanvas.width = image.width;\n\t\t\tcanvas.height = image.height;\n\n\t\t\tconst context = canvas.getContext( '2d' );\n\t\t\tcontext.drawImage( image, 0, 0, image.width, image.height );\n\n\t\t\tconst imageData = context.getImageData( 0, 0, image.width, image.height );\n\t\t\tconst data = imageData.data;\n\n\t\t\tfor ( let i = 0; i < data.length; i ++ ) {\n\n\t\t\t\tdata[ i ] = SRGBToLinear( data[ i ] / 255 ) * 255;\n\n\t\t\t}\n\n\t\t\tcontext.putImageData( imageData, 0, 0 );\n\n\t\t\treturn canvas;\n\n\t\t} else if ( image.data ) {\n\n\t\t\tconst data = image.data.slice( 0 );\n\n\t\t\tfor ( let i = 0; i < data.length; i ++ ) {\n\n\t\t\t\tif ( data instanceof Uint8Array || data instanceof Uint8ClampedArray ) {\n\n\t\t\t\t\tdata[ i ] = Math.floor( SRGBToLinear( data[ i ] / 255 ) * 255 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// assuming float\n\n\t\t\t\t\tdata[ i ] = SRGBToLinear( data[ i ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tdata: data,\n\t\t\t\twidth: image.width,\n\t\t\t\theight: image.height\n\t\t\t};\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied.' );\n\t\t\treturn image;\n\n\t\t}\n\n\t}\n\n}\n\nclass Source {\n\n\tconstructor( data = null ) {\n\n\t\tthis.isSource = true;\n\n\t\tthis.uuid = generateUUID();\n\n\t\tthis.data = data;\n\n\t\tthis.version = 0;\n\n\t}\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) this.version ++;\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst isRootObject = ( meta === undefined || typeof meta === 'string' );\n\n\t\tif ( ! isRootObject && meta.images[ this.uuid ] !== undefined ) {\n\n\t\t\treturn meta.images[ this.uuid ];\n\n\t\t}\n\n\t\tconst output = {\n\t\t\tuuid: this.uuid,\n\t\t\turl: ''\n\t\t};\n\n\t\tconst data = this.data;\n\n\t\tif ( data !== null ) {\n\n\t\t\tlet url;\n\n\t\t\tif ( Array.isArray( data ) ) {\n\n\t\t\t\t// cube texture\n\n\t\t\t\turl = [];\n\n\t\t\t\tfor ( let i = 0, l = data.length; i < l; i ++ ) {\n\n\t\t\t\t\tif ( data[ i ].isDataTexture ) {\n\n\t\t\t\t\t\turl.push( serializeImage( data[ i ].image ) );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\turl.push( serializeImage( data[ i ] ) );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t// texture\n\n\t\t\t\turl = serializeImage( data );\n\n\t\t\t}\n\n\t\t\toutput.url = url;\n\n\t\t}\n\n\t\tif ( ! isRootObject ) {\n\n\t\t\tmeta.images[ this.uuid ] = output;\n\n\t\t}\n\n\t\treturn output;\n\n\t}\n\n}\n\nfunction serializeImage( image ) {\n\n\tif ( ( typeof HTMLImageElement !== 'undefined' && image instanceof HTMLImageElement ) ||\n\t\t( typeof HTMLCanvasElement !== 'undefined' && image instanceof HTMLCanvasElement ) ||\n\t\t( typeof ImageBitmap !== 'undefined' && image instanceof ImageBitmap ) ) {\n\n\t\t// default images\n\n\t\treturn ImageUtils.getDataURL( image );\n\n\t} else {\n\n\t\tif ( image.data ) {\n\n\t\t\t// images of DataTexture\n\n\t\t\treturn {\n\t\t\t\tdata: Array.from( image.data ),\n\t\t\t\twidth: image.width,\n\t\t\t\theight: image.height,\n\t\t\t\ttype: image.data.constructor.name\n\t\t\t};\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.Texture: Unable to serialize Texture.' );\n\t\t\treturn {};\n\n\t\t}\n\n\t}\n\n}\n\nlet textureId = 0;\n\nclass Texture extends EventDispatcher {\n\n\tconstructor( image = Texture.DEFAULT_IMAGE, mapping = Texture.DEFAULT_MAPPING, wrapS = ClampToEdgeWrapping, wrapT = ClampToEdgeWrapping, magFilter = LinearFilter, minFilter = LinearMipmapLinearFilter, format = RGBAFormat, type = UnsignedByteType, anisotropy = Texture.DEFAULT_ANISOTROPY, encoding = LinearEncoding ) {\n\n\t\tsuper();\n\n\t\tthis.isTexture = true;\n\n\t\tObject.defineProperty( this, 'id', { value: textureId ++ } );\n\n\t\tthis.uuid = generateUUID();\n\n\t\tthis.name = '';\n\n\t\tthis.source = new Source( image );\n\t\tthis.mipmaps = [];\n\n\t\tthis.mapping = mapping;\n\n\t\tthis.wrapS = wrapS;\n\t\tthis.wrapT = wrapT;\n\n\t\tthis.magFilter = magFilter;\n\t\tthis.minFilter = minFilter;\n\n\t\tthis.anisotropy = anisotropy;\n\n\t\tthis.format = format;\n\t\tthis.internalFormat = null;\n\t\tthis.type = type;\n\n\t\tthis.offset = new Vector2( 0, 0 );\n\t\tthis.repeat = new Vector2( 1, 1 );\n\t\tthis.center = new Vector2( 0, 0 );\n\t\tthis.rotation = 0;\n\n\t\tthis.matrixAutoUpdate = true;\n\t\tthis.matrix = new Matrix3();\n\n\t\tthis.generateMipmaps = true;\n\t\tthis.premultiplyAlpha = false;\n\t\tthis.flipY = true;\n\t\tthis.unpackAlignment = 4;\t// valid values: 1, 2, 4, 8 (see http://www.khronos.org/opengles/sdk/docs/man/xhtml/glPixelStorei.xml)\n\n\t\t// Values of encoding !== THREE.LinearEncoding only supported on map, envMap and emissiveMap.\n\t\t//\n\t\t// Also changing the encoding after already used by a Material will not automatically make the Material\n\t\t// update. You need to explicitly call Material.needsUpdate to trigger it to recompile.\n\t\tthis.encoding = encoding;\n\n\t\tthis.userData = {};\n\n\t\tthis.version = 0;\n\t\tthis.onUpdate = null;\n\n\t\tthis.isRenderTargetTexture = false; // indicates whether a texture belongs to a render target or not\n\t\tthis.needsPMREMUpdate = false; // indicates whether this texture should be processed by PMREMGenerator or not (only relevant for render target textures)\n\n\t}\n\n\tget image() {\n\n\t\treturn this.source.data;\n\n\t}\n\n\tset image( value ) {\n\n\t\tthis.source.data = value;\n\n\t}\n\n\tupdateMatrix() {\n\n\t\tthis.matrix.setUvTransform( this.offset.x, this.offset.y, this.repeat.x, this.repeat.y, this.rotation, this.center.x, this.center.y );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.name = source.name;\n\n\t\tthis.source = source.source;\n\t\tthis.mipmaps = source.mipmaps.slice( 0 );\n\n\t\tthis.mapping = source.mapping;\n\n\t\tthis.wrapS = source.wrapS;\n\t\tthis.wrapT = source.wrapT;\n\n\t\tthis.magFilter = source.magFilter;\n\t\tthis.minFilter = source.minFilter;\n\n\t\tthis.anisotropy = source.anisotropy;\n\n\t\tthis.format = source.format;\n\t\tthis.internalFormat = source.internalFormat;\n\t\tthis.type = source.type;\n\n\t\tthis.offset.copy( source.offset );\n\t\tthis.repeat.copy( source.repeat );\n\t\tthis.center.copy( source.center );\n\t\tthis.rotation = source.rotation;\n\n\t\tthis.matrixAutoUpdate = source.matrixAutoUpdate;\n\t\tthis.matrix.copy( source.matrix );\n\n\t\tthis.generateMipmaps = source.generateMipmaps;\n\t\tthis.premultiplyAlpha = source.premultiplyAlpha;\n\t\tthis.flipY = source.flipY;\n\t\tthis.unpackAlignment = source.unpackAlignment;\n\t\tthis.encoding = source.encoding;\n\n\t\tthis.userData = JSON.parse( JSON.stringify( source.userData ) );\n\n\t\tthis.needsUpdate = true;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst isRootObject = ( meta === undefined || typeof meta === 'string' );\n\n\t\tif ( ! isRootObject && meta.textures[ this.uuid ] !== undefined ) {\n\n\t\t\treturn meta.textures[ this.uuid ];\n\n\t\t}\n\n\t\tconst output = {\n\n\t\t\tmetadata: {\n\t\t\t\tversion: 4.5,\n\t\t\t\ttype: 'Texture',\n\t\t\t\tgenerator: 'Texture.toJSON'\n\t\t\t},\n\n\t\t\tuuid: this.uuid,\n\t\t\tname: this.name,\n\n\t\t\timage: this.source.toJSON( meta ).uuid,\n\n\t\t\tmapping: this.mapping,\n\n\t\t\trepeat: [ this.repeat.x, this.repeat.y ],\n\t\t\toffset: [ this.offset.x, this.offset.y ],\n\t\t\tcenter: [ this.center.x, this.center.y ],\n\t\t\trotation: this.rotation,\n\n\t\t\twrap: [ this.wrapS, this.wrapT ],\n\n\t\t\tformat: this.format,\n\t\t\ttype: this.type,\n\t\t\tencoding: this.encoding,\n\n\t\t\tminFilter: this.minFilter,\n\t\t\tmagFilter: this.magFilter,\n\t\t\tanisotropy: this.anisotropy,\n\n\t\t\tflipY: this.flipY,\n\n\t\t\tgenerateMipmaps: this.generateMipmaps,\n\t\t\tpremultiplyAlpha: this.premultiplyAlpha,\n\t\t\tunpackAlignment: this.unpackAlignment\n\n\t\t};\n\n\t\tif ( Object.keys( this.userData ).length > 0 ) output.userData = this.userData;\n\n\t\tif ( ! isRootObject ) {\n\n\t\t\tmeta.textures[ this.uuid ] = output;\n\n\t\t}\n\n\t\treturn output;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t}\n\n\ttransformUv( uv ) {\n\n\t\tif ( this.mapping !== UVMapping ) return uv;\n\n\t\tuv.applyMatrix3( this.matrix );\n\n\t\tif ( uv.x < 0 || uv.x > 1 ) {\n\n\t\t\tswitch ( this.wrapS ) {\n\n\t\t\t\tcase RepeatWrapping:\n\n\t\t\t\t\tuv.x = uv.x - Math.floor( uv.x );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase ClampToEdgeWrapping:\n\n\t\t\t\t\tuv.x = uv.x < 0 ? 0 : 1;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MirroredRepeatWrapping:\n\n\t\t\t\t\tif ( Math.abs( Math.floor( uv.x ) % 2 ) === 1 ) {\n\n\t\t\t\t\t\tuv.x = Math.ceil( uv.x ) - uv.x;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tuv.x = uv.x - Math.floor( uv.x );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( uv.y < 0 || uv.y > 1 ) {\n\n\t\t\tswitch ( this.wrapT ) {\n\n\t\t\t\tcase RepeatWrapping:\n\n\t\t\t\t\tuv.y = uv.y - Math.floor( uv.y );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase ClampToEdgeWrapping:\n\n\t\t\t\t\tuv.y = uv.y < 0 ? 0 : 1;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MirroredRepeatWrapping:\n\n\t\t\t\t\tif ( Math.abs( Math.floor( uv.y ) % 2 ) === 1 ) {\n\n\t\t\t\t\t\tuv.y = Math.ceil( uv.y ) - uv.y;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tuv.y = uv.y - Math.floor( uv.y );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( this.flipY ) {\n\n\t\t\tuv.y = 1 - uv.y;\n\n\t\t}\n\n\t\treturn uv;\n\n\t}\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) {\n\n\t\t\tthis.version ++;\n\t\t\tthis.source.needsUpdate = true;\n\n\t\t}\n\n\t}\n\n}\n\nTexture.DEFAULT_IMAGE = null;\nTexture.DEFAULT_MAPPING = UVMapping;\nTexture.DEFAULT_ANISOTROPY = 1;\n\nclass Vector4 {\n\n\tconstructor( x = 0, y = 0, z = 0, w = 1 ) {\n\n\t\tVector4.prototype.isVector4 = true;\n\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.z = z;\n\t\tthis.w = w;\n\n\t}\n\n\tget width() {\n\n\t\treturn this.z;\n\n\t}\n\n\tset width( value ) {\n\n\t\tthis.z = value;\n\n\t}\n\n\tget height() {\n\n\t\treturn this.w;\n\n\t}\n\n\tset height( value ) {\n\n\t\tthis.w = value;\n\n\t}\n\n\tset( x, y, z, w ) {\n\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.z = z;\n\t\tthis.w = w;\n\n\t\treturn this;\n\n\t}\n\n\tsetScalar( scalar ) {\n\n\t\tthis.x = scalar;\n\t\tthis.y = scalar;\n\t\tthis.z = scalar;\n\t\tthis.w = scalar;\n\n\t\treturn this;\n\n\t}\n\n\tsetX( x ) {\n\n\t\tthis.x = x;\n\n\t\treturn this;\n\n\t}\n\n\tsetY( y ) {\n\n\t\tthis.y = y;\n\n\t\treturn this;\n\n\t}\n\n\tsetZ( z ) {\n\n\t\tthis.z = z;\n\n\t\treturn this;\n\n\t}\n\n\tsetW( w ) {\n\n\t\tthis.w = w;\n\n\t\treturn this;\n\n\t}\n\n\tsetComponent( index, value ) {\n\n\t\tswitch ( index ) {\n\n\t\t\tcase 0: this.x = value; break;\n\t\t\tcase 1: this.y = value; break;\n\t\t\tcase 2: this.z = value; break;\n\t\t\tcase 3: this.w = value; break;\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tgetComponent( index ) {\n\n\t\tswitch ( index ) {\n\n\t\t\tcase 0: return this.x;\n\t\t\tcase 1: return this.y;\n\t\t\tcase 2: return this.z;\n\t\t\tcase 3: return this.w;\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t}\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this.x, this.y, this.z, this.w );\n\n\t}\n\n\tcopy( v ) {\n\n\t\tthis.x = v.x;\n\t\tthis.y = v.y;\n\t\tthis.z = v.z;\n\t\tthis.w = ( v.w !== undefined ) ? v.w : 1;\n\n\t\treturn this;\n\n\t}\n\n\tadd( v ) {\n\n\t\tthis.x += v.x;\n\t\tthis.y += v.y;\n\t\tthis.z += v.z;\n\t\tthis.w += v.w;\n\n\t\treturn this;\n\n\t}\n\n\taddScalar( s ) {\n\n\t\tthis.x += s;\n\t\tthis.y += s;\n\t\tthis.z += s;\n\t\tthis.w += s;\n\n\t\treturn this;\n\n\t}\n\n\taddVectors( a, b ) {\n\n\t\tthis.x = a.x + b.x;\n\t\tthis.y = a.y + b.y;\n\t\tthis.z = a.z + b.z;\n\t\tthis.w = a.w + b.w;\n\n\t\treturn this;\n\n\t}\n\n\taddScaledVector( v, s ) {\n\n\t\tthis.x += v.x * s;\n\t\tthis.y += v.y * s;\n\t\tthis.z += v.z * s;\n\t\tthis.w += v.w * s;\n\n\t\treturn this;\n\n\t}\n\n\tsub( v ) {\n\n\t\tthis.x -= v.x;\n\t\tthis.y -= v.y;\n\t\tthis.z -= v.z;\n\t\tthis.w -= v.w;\n\n\t\treturn this;\n\n\t}\n\n\tsubScalar( s ) {\n\n\t\tthis.x -= s;\n\t\tthis.y -= s;\n\t\tthis.z -= s;\n\t\tthis.w -= s;\n\n\t\treturn this;\n\n\t}\n\n\tsubVectors( a, b ) {\n\n\t\tthis.x = a.x - b.x;\n\t\tthis.y = a.y - b.y;\n\t\tthis.z = a.z - b.z;\n\t\tthis.w = a.w - b.w;\n\n\t\treturn this;\n\n\t}\n\n\tmultiply( v ) {\n\n\t\tthis.x *= v.x;\n\t\tthis.y *= v.y;\n\t\tthis.z *= v.z;\n\t\tthis.w *= v.w;\n\n\t\treturn this;\n\n\t}\n\n\tmultiplyScalar( scalar ) {\n\n\t\tthis.x *= scalar;\n\t\tthis.y *= scalar;\n\t\tthis.z *= scalar;\n\t\tthis.w *= scalar;\n\n\t\treturn this;\n\n\t}\n\n\tapplyMatrix4( m ) {\n\n\t\tconst x = this.x, y = this.y, z = this.z, w = this.w;\n\t\tconst e = m.elements;\n\n\t\tthis.x = e[ 0 ] * x + e[ 4 ] * y + e[ 8 ] * z + e[ 12 ] * w;\n\t\tthis.y = e[ 1 ] * x + e[ 5 ] * y + e[ 9 ] * z + e[ 13 ] * w;\n\t\tthis.z = e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z + e[ 14 ] * w;\n\t\tthis.w = e[ 3 ] * x + e[ 7 ] * y + e[ 11 ] * z + e[ 15 ] * w;\n\n\t\treturn this;\n\n\t}\n\n\tdivideScalar( scalar ) {\n\n\t\treturn this.multiplyScalar( 1 / scalar );\n\n\t}\n\n\tsetAxisAngleFromQuaternion( q ) {\n\n\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/quaternionToAngle/index.htm\n\n\t\t// q is assumed to be normalized\n\n\t\tthis.w = 2 * Math.acos( q.w );\n\n\t\tconst s = Math.sqrt( 1 - q.w * q.w );\n\n\t\tif ( s < 0.0001 ) {\n\n\t\t\tthis.x = 1;\n\t\t\tthis.y = 0;\n\t\t\tthis.z = 0;\n\n\t\t} else {\n\n\t\t\tthis.x = q.x / s;\n\t\t\tthis.y = q.y / s;\n\t\t\tthis.z = q.z / s;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetAxisAngleFromRotationMatrix( m ) {\n\n\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToAngle/index.htm\n\n\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\n\n\t\tlet angle, x, y, z; // variables for result\n\t\tconst epsilon = 0.01,\t\t// margin to allow for rounding errors\n\t\t\tepsilon2 = 0.1,\t\t// margin to distinguish between 0 and 180 degrees\n\n\t\t\tte = m.elements,\n\n\t\t\tm11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ],\n\t\t\tm21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ],\n\t\t\tm31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ];\n\n\t\tif ( ( Math.abs( m12 - m21 ) < epsilon ) &&\n\t\t     ( Math.abs( m13 - m31 ) < epsilon ) &&\n\t\t     ( Math.abs( m23 - m32 ) < epsilon ) ) {\n\n\t\t\t// singularity found\n\t\t\t// first check for identity matrix which must have +1 for all terms\n\t\t\t// in leading diagonal and zero in other terms\n\n\t\t\tif ( ( Math.abs( m12 + m21 ) < epsilon2 ) &&\n\t\t\t     ( Math.abs( m13 + m31 ) < epsilon2 ) &&\n\t\t\t     ( Math.abs( m23 + m32 ) < epsilon2 ) &&\n\t\t\t     ( Math.abs( m11 + m22 + m33 - 3 ) < epsilon2 ) ) {\n\n\t\t\t\t// this singularity is identity matrix so angle = 0\n\n\t\t\t\tthis.set( 1, 0, 0, 0 );\n\n\t\t\t\treturn this; // zero angle, arbitrary axis\n\n\t\t\t}\n\n\t\t\t// otherwise this singularity is angle = 180\n\n\t\t\tangle = Math.PI;\n\n\t\t\tconst xx = ( m11 + 1 ) / 2;\n\t\t\tconst yy = ( m22 + 1 ) / 2;\n\t\t\tconst zz = ( m33 + 1 ) / 2;\n\t\t\tconst xy = ( m12 + m21 ) / 4;\n\t\t\tconst xz = ( m13 + m31 ) / 4;\n\t\t\tconst yz = ( m23 + m32 ) / 4;\n\n\t\t\tif ( ( xx > yy ) && ( xx > zz ) ) {\n\n\t\t\t\t// m11 is the largest diagonal term\n\n\t\t\t\tif ( xx < epsilon ) {\n\n\t\t\t\t\tx = 0;\n\t\t\t\t\ty = 0.707106781;\n\t\t\t\t\tz = 0.707106781;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tx = Math.sqrt( xx );\n\t\t\t\t\ty = xy / x;\n\t\t\t\t\tz = xz / x;\n\n\t\t\t\t}\n\n\t\t\t} else if ( yy > zz ) {\n\n\t\t\t\t// m22 is the largest diagonal term\n\n\t\t\t\tif ( yy < epsilon ) {\n\n\t\t\t\t\tx = 0.707106781;\n\t\t\t\t\ty = 0;\n\t\t\t\t\tz = 0.707106781;\n\n\t\t\t\t} else {\n\n\t\t\t\t\ty = Math.sqrt( yy );\n\t\t\t\t\tx = xy / y;\n\t\t\t\t\tz = yz / y;\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t// m33 is the largest diagonal term so base result on this\n\n\t\t\t\tif ( zz < epsilon ) {\n\n\t\t\t\t\tx = 0.707106781;\n\t\t\t\t\ty = 0.707106781;\n\t\t\t\t\tz = 0;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tz = Math.sqrt( zz );\n\t\t\t\t\tx = xz / z;\n\t\t\t\t\ty = yz / z;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis.set( x, y, z, angle );\n\n\t\t\treturn this; // return 180 deg rotation\n\n\t\t}\n\n\t\t// as we have reached here there are no singularities so we can handle normally\n\n\t\tlet s = Math.sqrt( ( m32 - m23 ) * ( m32 - m23 ) +\n\t\t\t( m13 - m31 ) * ( m13 - m31 ) +\n\t\t\t( m21 - m12 ) * ( m21 - m12 ) ); // used to normalize\n\n\t\tif ( Math.abs( s ) < 0.001 ) s = 1;\n\n\t\t// prevent divide by zero, should not happen if matrix is orthogonal and should be\n\t\t// caught by singularity test above, but I've left it in just in case\n\n\t\tthis.x = ( m32 - m23 ) / s;\n\t\tthis.y = ( m13 - m31 ) / s;\n\t\tthis.z = ( m21 - m12 ) / s;\n\t\tthis.w = Math.acos( ( m11 + m22 + m33 - 1 ) / 2 );\n\n\t\treturn this;\n\n\t}\n\n\tmin( v ) {\n\n\t\tthis.x = Math.min( this.x, v.x );\n\t\tthis.y = Math.min( this.y, v.y );\n\t\tthis.z = Math.min( this.z, v.z );\n\t\tthis.w = Math.min( this.w, v.w );\n\n\t\treturn this;\n\n\t}\n\n\tmax( v ) {\n\n\t\tthis.x = Math.max( this.x, v.x );\n\t\tthis.y = Math.max( this.y, v.y );\n\t\tthis.z = Math.max( this.z, v.z );\n\t\tthis.w = Math.max( this.w, v.w );\n\n\t\treturn this;\n\n\t}\n\n\tclamp( min, max ) {\n\n\t\t// assumes min < max, componentwise\n\n\t\tthis.x = Math.max( min.x, Math.min( max.x, this.x ) );\n\t\tthis.y = Math.max( min.y, Math.min( max.y, this.y ) );\n\t\tthis.z = Math.max( min.z, Math.min( max.z, this.z ) );\n\t\tthis.w = Math.max( min.w, Math.min( max.w, this.w ) );\n\n\t\treturn this;\n\n\t}\n\n\tclampScalar( minVal, maxVal ) {\n\n\t\tthis.x = Math.max( minVal, Math.min( maxVal, this.x ) );\n\t\tthis.y = Math.max( minVal, Math.min( maxVal, this.y ) );\n\t\tthis.z = Math.max( minVal, Math.min( maxVal, this.z ) );\n\t\tthis.w = Math.max( minVal, Math.min( maxVal, this.w ) );\n\n\t\treturn this;\n\n\t}\n\n\tclampLength( min, max ) {\n\n\t\tconst length = this.length();\n\n\t\treturn this.divideScalar( length || 1 ).multiplyScalar( Math.max( min, Math.min( max, length ) ) );\n\n\t}\n\n\tfloor() {\n\n\t\tthis.x = Math.floor( this.x );\n\t\tthis.y = Math.floor( this.y );\n\t\tthis.z = Math.floor( this.z );\n\t\tthis.w = Math.floor( this.w );\n\n\t\treturn this;\n\n\t}\n\n\tceil() {\n\n\t\tthis.x = Math.ceil( this.x );\n\t\tthis.y = Math.ceil( this.y );\n\t\tthis.z = Math.ceil( this.z );\n\t\tthis.w = Math.ceil( this.w );\n\n\t\treturn this;\n\n\t}\n\n\tround() {\n\n\t\tthis.x = Math.round( this.x );\n\t\tthis.y = Math.round( this.y );\n\t\tthis.z = Math.round( this.z );\n\t\tthis.w = Math.round( this.w );\n\n\t\treturn this;\n\n\t}\n\n\troundToZero() {\n\n\t\tthis.x = ( this.x < 0 ) ? Math.ceil( this.x ) : Math.floor( this.x );\n\t\tthis.y = ( this.y < 0 ) ? Math.ceil( this.y ) : Math.floor( this.y );\n\t\tthis.z = ( this.z < 0 ) ? Math.ceil( this.z ) : Math.floor( this.z );\n\t\tthis.w = ( this.w < 0 ) ? Math.ceil( this.w ) : Math.floor( this.w );\n\n\t\treturn this;\n\n\t}\n\n\tnegate() {\n\n\t\tthis.x = - this.x;\n\t\tthis.y = - this.y;\n\t\tthis.z = - this.z;\n\t\tthis.w = - this.w;\n\n\t\treturn this;\n\n\t}\n\n\tdot( v ) {\n\n\t\treturn this.x * v.x + this.y * v.y + this.z * v.z + this.w * v.w;\n\n\t}\n\n\tlengthSq() {\n\n\t\treturn this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w;\n\n\t}\n\n\tlength() {\n\n\t\treturn Math.sqrt( this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w );\n\n\t}\n\n\tmanhattanLength() {\n\n\t\treturn Math.abs( this.x ) + Math.abs( this.y ) + Math.abs( this.z ) + Math.abs( this.w );\n\n\t}\n\n\tnormalize() {\n\n\t\treturn this.divideScalar( this.length() || 1 );\n\n\t}\n\n\tsetLength( length ) {\n\n\t\treturn this.normalize().multiplyScalar( length );\n\n\t}\n\n\tlerp( v, alpha ) {\n\n\t\tthis.x += ( v.x - this.x ) * alpha;\n\t\tthis.y += ( v.y - this.y ) * alpha;\n\t\tthis.z += ( v.z - this.z ) * alpha;\n\t\tthis.w += ( v.w - this.w ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tlerpVectors( v1, v2, alpha ) {\n\n\t\tthis.x = v1.x + ( v2.x - v1.x ) * alpha;\n\t\tthis.y = v1.y + ( v2.y - v1.y ) * alpha;\n\t\tthis.z = v1.z + ( v2.z - v1.z ) * alpha;\n\t\tthis.w = v1.w + ( v2.w - v1.w ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tequals( v ) {\n\n\t\treturn ( ( v.x === this.x ) && ( v.y === this.y ) && ( v.z === this.z ) && ( v.w === this.w ) );\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tthis.x = array[ offset ];\n\t\tthis.y = array[ offset + 1 ];\n\t\tthis.z = array[ offset + 2 ];\n\t\tthis.w = array[ offset + 3 ];\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tarray[ offset ] = this.x;\n\t\tarray[ offset + 1 ] = this.y;\n\t\tarray[ offset + 2 ] = this.z;\n\t\tarray[ offset + 3 ] = this.w;\n\n\t\treturn array;\n\n\t}\n\n\tfromBufferAttribute( attribute, index ) {\n\n\t\tthis.x = attribute.getX( index );\n\t\tthis.y = attribute.getY( index );\n\t\tthis.z = attribute.getZ( index );\n\t\tthis.w = attribute.getW( index );\n\n\t\treturn this;\n\n\t}\n\n\trandom() {\n\n\t\tthis.x = Math.random();\n\t\tthis.y = Math.random();\n\t\tthis.z = Math.random();\n\t\tthis.w = Math.random();\n\n\t\treturn this;\n\n\t}\n\n\t*[ Symbol.iterator ]() {\n\n\t\tyield this.x;\n\t\tyield this.y;\n\t\tyield this.z;\n\t\tyield this.w;\n\n\t}\n\n}\n\n/*\n In options, we can specify:\n * Texture parameters for an auto-generated target texture\n * depthBuffer/stencilBuffer: Booleans to indicate if we should generate these buffers\n*/\nclass WebGLRenderTarget extends EventDispatcher {\n\n\tconstructor( width = 1, height = 1, options = {} ) {\n\n\t\tsuper();\n\n\t\tthis.isWebGLRenderTarget = true;\n\n\t\tthis.width = width;\n\t\tthis.height = height;\n\t\tthis.depth = 1;\n\n\t\tthis.scissor = new Vector4( 0, 0, width, height );\n\t\tthis.scissorTest = false;\n\n\t\tthis.viewport = new Vector4( 0, 0, width, height );\n\n\t\tconst image = { width: width, height: height, depth: 1 };\n\n\t\tthis.texture = new Texture( image, options.mapping, options.wrapS, options.wrapT, options.magFilter, options.minFilter, options.format, options.type, options.anisotropy, options.encoding );\n\t\tthis.texture.isRenderTargetTexture = true;\n\n\t\tthis.texture.flipY = false;\n\t\tthis.texture.generateMipmaps = options.generateMipmaps !== undefined ? options.generateMipmaps : false;\n\t\tthis.texture.internalFormat = options.internalFormat !== undefined ? options.internalFormat : null;\n\t\tthis.texture.minFilter = options.minFilter !== undefined ? options.minFilter : LinearFilter;\n\n\t\tthis.depthBuffer = options.depthBuffer !== undefined ? options.depthBuffer : true;\n\t\tthis.stencilBuffer = options.stencilBuffer !== undefined ? options.stencilBuffer : false;\n\n\t\tthis.depthTexture = options.depthTexture !== undefined ? options.depthTexture : null;\n\n\t\tthis.samples = options.samples !== undefined ? options.samples : 0;\n\n\t}\n\n\tsetSize( width, height, depth = 1 ) {\n\n\t\tif ( this.width !== width || this.height !== height || this.depth !== depth ) {\n\n\t\t\tthis.width = width;\n\t\t\tthis.height = height;\n\t\t\tthis.depth = depth;\n\n\t\t\tthis.texture.image.width = width;\n\t\t\tthis.texture.image.height = height;\n\t\t\tthis.texture.image.depth = depth;\n\n\t\t\tthis.dispose();\n\n\t\t}\n\n\t\tthis.viewport.set( 0, 0, width, height );\n\t\tthis.scissor.set( 0, 0, width, height );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.width = source.width;\n\t\tthis.height = source.height;\n\t\tthis.depth = source.depth;\n\n\t\tthis.viewport.copy( source.viewport );\n\n\t\tthis.texture = source.texture.clone();\n\t\tthis.texture.isRenderTargetTexture = true;\n\n\t\t// ensure image object is not shared, see #20328\n\n\t\tconst image = Object.assign( {}, source.texture.image );\n\t\tthis.texture.source = new Source( image );\n\n\t\tthis.depthBuffer = source.depthBuffer;\n\t\tthis.stencilBuffer = source.stencilBuffer;\n\n\t\tif ( source.depthTexture !== null ) this.depthTexture = source.depthTexture.clone();\n\n\t\tthis.samples = source.samples;\n\n\t\treturn this;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t}\n\n}\n\nclass DataArrayTexture extends Texture {\n\n\tconstructor( data = null, width = 1, height = 1, depth = 1 ) {\n\n\t\tsuper( null );\n\n\t\tthis.isDataArrayTexture = true;\n\n\t\tthis.image = { data, width, height, depth };\n\n\t\tthis.magFilter = NearestFilter;\n\t\tthis.minFilter = NearestFilter;\n\n\t\tthis.wrapR = ClampToEdgeWrapping;\n\n\t\tthis.generateMipmaps = false;\n\t\tthis.flipY = false;\n\t\tthis.unpackAlignment = 1;\n\n\t}\n\n}\n\nclass WebGLArrayRenderTarget extends WebGLRenderTarget {\n\n\tconstructor( width = 1, height = 1, depth = 1 ) {\n\n\t\tsuper( width, height );\n\n\t\tthis.isWebGLArrayRenderTarget = true;\n\n\t\tthis.depth = depth;\n\n\t\tthis.texture = new DataArrayTexture( null, width, height, depth );\n\n\t\tthis.texture.isRenderTargetTexture = true;\n\n\t}\n\n}\n\nclass Data3DTexture extends Texture {\n\n\tconstructor( data = null, width = 1, height = 1, depth = 1 ) {\n\n\t\t// We're going to add .setXXX() methods for setting properties later.\n\t\t// Users can still set in DataTexture3D directly.\n\t\t//\n\t\t//\tconst texture = new THREE.DataTexture3D( data, width, height, depth );\n\t\t// \ttexture.anisotropy = 16;\n\t\t//\n\t\t// See #14839\n\n\t\tsuper( null );\n\n\t\tthis.isData3DTexture = true;\n\n\t\tthis.image = { data, width, height, depth };\n\n\t\tthis.magFilter = NearestFilter;\n\t\tthis.minFilter = NearestFilter;\n\n\t\tthis.wrapR = ClampToEdgeWrapping;\n\n\t\tthis.generateMipmaps = false;\n\t\tthis.flipY = false;\n\t\tthis.unpackAlignment = 1;\n\n\t}\n\n}\n\nclass WebGL3DRenderTarget extends WebGLRenderTarget {\n\n\tconstructor( width = 1, height = 1, depth = 1 ) {\n\n\t\tsuper( width, height );\n\n\t\tthis.isWebGL3DRenderTarget = true;\n\n\t\tthis.depth = depth;\n\n\t\tthis.texture = new Data3DTexture( null, width, height, depth );\n\n\t\tthis.texture.isRenderTargetTexture = true;\n\n\t}\n\n}\n\nclass WebGLMultipleRenderTargets extends WebGLRenderTarget {\n\n\tconstructor( width = 1, height = 1, count = 1, options = {} ) {\n\n\t\tsuper( width, height, options );\n\n\t\tthis.isWebGLMultipleRenderTargets = true;\n\n\t\tconst texture = this.texture;\n\n\t\tthis.texture = [];\n\n\t\tfor ( let i = 0; i < count; i ++ ) {\n\n\t\t\tthis.texture[ i ] = texture.clone();\n\t\t\tthis.texture[ i ].isRenderTargetTexture = true;\n\n\t\t}\n\n\t}\n\n\tsetSize( width, height, depth = 1 ) {\n\n\t\tif ( this.width !== width || this.height !== height || this.depth !== depth ) {\n\n\t\t\tthis.width = width;\n\t\t\tthis.height = height;\n\t\t\tthis.depth = depth;\n\n\t\t\tfor ( let i = 0, il = this.texture.length; i < il; i ++ ) {\n\n\t\t\t\tthis.texture[ i ].image.width = width;\n\t\t\t\tthis.texture[ i ].image.height = height;\n\t\t\t\tthis.texture[ i ].image.depth = depth;\n\n\t\t\t}\n\n\t\t\tthis.dispose();\n\n\t\t}\n\n\t\tthis.viewport.set( 0, 0, width, height );\n\t\tthis.scissor.set( 0, 0, width, height );\n\n\t\treturn this;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.dispose();\n\n\t\tthis.width = source.width;\n\t\tthis.height = source.height;\n\t\tthis.depth = source.depth;\n\n\t\tthis.viewport.set( 0, 0, this.width, this.height );\n\t\tthis.scissor.set( 0, 0, this.width, this.height );\n\n\t\tthis.depthBuffer = source.depthBuffer;\n\t\tthis.stencilBuffer = source.stencilBuffer;\n\n\t\tif ( source.depthTexture !== null ) this.depthTexture = source.depthTexture.clone();\n\n\t\tthis.texture.length = 0;\n\n\t\tfor ( let i = 0, il = source.texture.length; i < il; i ++ ) {\n\n\t\t\tthis.texture[ i ] = source.texture[ i ].clone();\n\t\t\tthis.texture[ i ].isRenderTargetTexture = true;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass Quaternion {\n\n\tconstructor( x = 0, y = 0, z = 0, w = 1 ) {\n\n\t\tthis.isQuaternion = true;\n\n\t\tthis._x = x;\n\t\tthis._y = y;\n\t\tthis._z = z;\n\t\tthis._w = w;\n\n\t}\n\n\tstatic slerpFlat( dst, dstOffset, src0, srcOffset0, src1, srcOffset1, t ) {\n\n\t\t// fuzz-free, array-based Quaternion SLERP operation\n\n\t\tlet x0 = src0[ srcOffset0 + 0 ],\n\t\t\ty0 = src0[ srcOffset0 + 1 ],\n\t\t\tz0 = src0[ srcOffset0 + 2 ],\n\t\t\tw0 = src0[ srcOffset0 + 3 ];\n\n\t\tconst x1 = src1[ srcOffset1 + 0 ],\n\t\t\ty1 = src1[ srcOffset1 + 1 ],\n\t\t\tz1 = src1[ srcOffset1 + 2 ],\n\t\t\tw1 = src1[ srcOffset1 + 3 ];\n\n\t\tif ( t === 0 ) {\n\n\t\t\tdst[ dstOffset + 0 ] = x0;\n\t\t\tdst[ dstOffset + 1 ] = y0;\n\t\t\tdst[ dstOffset + 2 ] = z0;\n\t\t\tdst[ dstOffset + 3 ] = w0;\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( t === 1 ) {\n\n\t\t\tdst[ dstOffset + 0 ] = x1;\n\t\t\tdst[ dstOffset + 1 ] = y1;\n\t\t\tdst[ dstOffset + 2 ] = z1;\n\t\t\tdst[ dstOffset + 3 ] = w1;\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( w0 !== w1 || x0 !== x1 || y0 !== y1 || z0 !== z1 ) {\n\n\t\t\tlet s = 1 - t;\n\t\t\tconst cos = x0 * x1 + y0 * y1 + z0 * z1 + w0 * w1,\n\t\t\t\tdir = ( cos >= 0 ? 1 : - 1 ),\n\t\t\t\tsqrSin = 1 - cos * cos;\n\n\t\t\t// Skip the Slerp for tiny steps to avoid numeric problems:\n\t\t\tif ( sqrSin > Number.EPSILON ) {\n\n\t\t\t\tconst sin = Math.sqrt( sqrSin ),\n\t\t\t\t\tlen = Math.atan2( sin, cos * dir );\n\n\t\t\t\ts = Math.sin( s * len ) / sin;\n\t\t\t\tt = Math.sin( t * len ) / sin;\n\n\t\t\t}\n\n\t\t\tconst tDir = t * dir;\n\n\t\t\tx0 = x0 * s + x1 * tDir;\n\t\t\ty0 = y0 * s + y1 * tDir;\n\t\t\tz0 = z0 * s + z1 * tDir;\n\t\t\tw0 = w0 * s + w1 * tDir;\n\n\t\t\t// Normalize in case we just did a lerp:\n\t\t\tif ( s === 1 - t ) {\n\n\t\t\t\tconst f = 1 / Math.sqrt( x0 * x0 + y0 * y0 + z0 * z0 + w0 * w0 );\n\n\t\t\t\tx0 *= f;\n\t\t\t\ty0 *= f;\n\t\t\t\tz0 *= f;\n\t\t\t\tw0 *= f;\n\n\t\t\t}\n\n\t\t}\n\n\t\tdst[ dstOffset ] = x0;\n\t\tdst[ dstOffset + 1 ] = y0;\n\t\tdst[ dstOffset + 2 ] = z0;\n\t\tdst[ dstOffset + 3 ] = w0;\n\n\t}\n\n\tstatic multiplyQuaternionsFlat( dst, dstOffset, src0, srcOffset0, src1, srcOffset1 ) {\n\n\t\tconst x0 = src0[ srcOffset0 ];\n\t\tconst y0 = src0[ srcOffset0 + 1 ];\n\t\tconst z0 = src0[ srcOffset0 + 2 ];\n\t\tconst w0 = src0[ srcOffset0 + 3 ];\n\n\t\tconst x1 = src1[ srcOffset1 ];\n\t\tconst y1 = src1[ srcOffset1 + 1 ];\n\t\tconst z1 = src1[ srcOffset1 + 2 ];\n\t\tconst w1 = src1[ srcOffset1 + 3 ];\n\n\t\tdst[ dstOffset ] = x0 * w1 + w0 * x1 + y0 * z1 - z0 * y1;\n\t\tdst[ dstOffset + 1 ] = y0 * w1 + w0 * y1 + z0 * x1 - x0 * z1;\n\t\tdst[ dstOffset + 2 ] = z0 * w1 + w0 * z1 + x0 * y1 - y0 * x1;\n\t\tdst[ dstOffset + 3 ] = w0 * w1 - x0 * x1 - y0 * y1 - z0 * z1;\n\n\t\treturn dst;\n\n\t}\n\n\tget x() {\n\n\t\treturn this._x;\n\n\t}\n\n\tset x( value ) {\n\n\t\tthis._x = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tget y() {\n\n\t\treturn this._y;\n\n\t}\n\n\tset y( value ) {\n\n\t\tthis._y = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tget z() {\n\n\t\treturn this._z;\n\n\t}\n\n\tset z( value ) {\n\n\t\tthis._z = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tget w() {\n\n\t\treturn this._w;\n\n\t}\n\n\tset w( value ) {\n\n\t\tthis._w = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tset( x, y, z, w ) {\n\n\t\tthis._x = x;\n\t\tthis._y = y;\n\t\tthis._z = z;\n\t\tthis._w = w;\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this._x, this._y, this._z, this._w );\n\n\t}\n\n\tcopy( quaternion ) {\n\n\t\tthis._x = quaternion.x;\n\t\tthis._y = quaternion.y;\n\t\tthis._z = quaternion.z;\n\t\tthis._w = quaternion.w;\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tsetFromEuler( euler, update ) {\n\n\t\tconst x = euler._x, y = euler._y, z = euler._z, order = euler._order;\n\n\t\t// http://www.mathworks.com/matlabcentral/fileexchange/\n\t\t// \t20696-function-to-convert-between-dcm-euler-angles-quaternions-and-euler-vectors/\n\t\t//\tcontent/SpinCalc.m\n\n\t\tconst cos = Math.cos;\n\t\tconst sin = Math.sin;\n\n\t\tconst c1 = cos( x / 2 );\n\t\tconst c2 = cos( y / 2 );\n\t\tconst c3 = cos( z / 2 );\n\n\t\tconst s1 = sin( x / 2 );\n\t\tconst s2 = sin( y / 2 );\n\t\tconst s3 = sin( z / 2 );\n\n\t\tswitch ( order ) {\n\n\t\t\tcase 'XYZ':\n\t\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\n\t\t\t\tbreak;\n\n\t\t\tcase 'YXZ':\n\t\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\n\t\t\t\tbreak;\n\n\t\t\tcase 'ZXY':\n\t\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\n\t\t\t\tbreak;\n\n\t\t\tcase 'ZYX':\n\t\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\n\t\t\t\tbreak;\n\n\t\t\tcase 'YZX':\n\t\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\n\t\t\t\tbreak;\n\n\t\t\tcase 'XZY':\n\t\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tconsole.warn( 'THREE.Quaternion: .setFromEuler() encountered an unknown order: ' + order );\n\n\t\t}\n\n\t\tif ( update !== false ) this._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tsetFromAxisAngle( axis, angle ) {\n\n\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/angleToQuaternion/index.htm\n\n\t\t// assumes axis is normalized\n\n\t\tconst halfAngle = angle / 2, s = Math.sin( halfAngle );\n\n\t\tthis._x = axis.x * s;\n\t\tthis._y = axis.y * s;\n\t\tthis._z = axis.z * s;\n\t\tthis._w = Math.cos( halfAngle );\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tsetFromRotationMatrix( m ) {\n\n\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToQuaternion/index.htm\n\n\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\n\n\t\tconst te = m.elements,\n\n\t\t\tm11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ],\n\t\t\tm21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ],\n\t\t\tm31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ],\n\n\t\t\ttrace = m11 + m22 + m33;\n\n\t\tif ( trace > 0 ) {\n\n\t\t\tconst s = 0.5 / Math.sqrt( trace + 1.0 );\n\n\t\t\tthis._w = 0.25 / s;\n\t\t\tthis._x = ( m32 - m23 ) * s;\n\t\t\tthis._y = ( m13 - m31 ) * s;\n\t\t\tthis._z = ( m21 - m12 ) * s;\n\n\t\t} else if ( m11 > m22 && m11 > m33 ) {\n\n\t\t\tconst s = 2.0 * Math.sqrt( 1.0 + m11 - m22 - m33 );\n\n\t\t\tthis._w = ( m32 - m23 ) / s;\n\t\t\tthis._x = 0.25 * s;\n\t\t\tthis._y = ( m12 + m21 ) / s;\n\t\t\tthis._z = ( m13 + m31 ) / s;\n\n\t\t} else if ( m22 > m33 ) {\n\n\t\t\tconst s = 2.0 * Math.sqrt( 1.0 + m22 - m11 - m33 );\n\n\t\t\tthis._w = ( m13 - m31 ) / s;\n\t\t\tthis._x = ( m12 + m21 ) / s;\n\t\t\tthis._y = 0.25 * s;\n\t\t\tthis._z = ( m23 + m32 ) / s;\n\n\t\t} else {\n\n\t\t\tconst s = 2.0 * Math.sqrt( 1.0 + m33 - m11 - m22 );\n\n\t\t\tthis._w = ( m21 - m12 ) / s;\n\t\t\tthis._x = ( m13 + m31 ) / s;\n\t\t\tthis._y = ( m23 + m32 ) / s;\n\t\t\tthis._z = 0.25 * s;\n\n\t\t}\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tsetFromUnitVectors( vFrom, vTo ) {\n\n\t\t// assumes direction vectors vFrom and vTo are normalized\n\n\t\tlet r = vFrom.dot( vTo ) + 1;\n\n\t\tif ( r < Number.EPSILON ) {\n\n\t\t\t// vFrom and vTo point in opposite directions\n\n\t\t\tr = 0;\n\n\t\t\tif ( Math.abs( vFrom.x ) > Math.abs( vFrom.z ) ) {\n\n\t\t\t\tthis._x = - vFrom.y;\n\t\t\t\tthis._y = vFrom.x;\n\t\t\t\tthis._z = 0;\n\t\t\t\tthis._w = r;\n\n\t\t\t} else {\n\n\t\t\t\tthis._x = 0;\n\t\t\t\tthis._y = - vFrom.z;\n\t\t\t\tthis._z = vFrom.y;\n\t\t\t\tthis._w = r;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\t// crossVectors( vFrom, vTo ); // inlined to avoid cyclic dependency on Vector3\n\n\t\t\tthis._x = vFrom.y * vTo.z - vFrom.z * vTo.y;\n\t\t\tthis._y = vFrom.z * vTo.x - vFrom.x * vTo.z;\n\t\t\tthis._z = vFrom.x * vTo.y - vFrom.y * vTo.x;\n\t\t\tthis._w = r;\n\n\t\t}\n\n\t\treturn this.normalize();\n\n\t}\n\n\tangleTo( q ) {\n\n\t\treturn 2 * Math.acos( Math.abs( clamp( this.dot( q ), - 1, 1 ) ) );\n\n\t}\n\n\trotateTowards( q, step ) {\n\n\t\tconst angle = this.angleTo( q );\n\n\t\tif ( angle === 0 ) return this;\n\n\t\tconst t = Math.min( 1, step / angle );\n\n\t\tthis.slerp( q, t );\n\n\t\treturn this;\n\n\t}\n\n\tidentity() {\n\n\t\treturn this.set( 0, 0, 0, 1 );\n\n\t}\n\n\tinvert() {\n\n\t\t// quaternion is assumed to have unit length\n\n\t\treturn this.conjugate();\n\n\t}\n\n\tconjugate() {\n\n\t\tthis._x *= - 1;\n\t\tthis._y *= - 1;\n\t\tthis._z *= - 1;\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tdot( v ) {\n\n\t\treturn this._x * v._x + this._y * v._y + this._z * v._z + this._w * v._w;\n\n\t}\n\n\tlengthSq() {\n\n\t\treturn this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w;\n\n\t}\n\n\tlength() {\n\n\t\treturn Math.sqrt( this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w );\n\n\t}\n\n\tnormalize() {\n\n\t\tlet l = this.length();\n\n\t\tif ( l === 0 ) {\n\n\t\t\tthis._x = 0;\n\t\t\tthis._y = 0;\n\t\t\tthis._z = 0;\n\t\t\tthis._w = 1;\n\n\t\t} else {\n\n\t\t\tl = 1 / l;\n\n\t\t\tthis._x = this._x * l;\n\t\t\tthis._y = this._y * l;\n\t\t\tthis._z = this._z * l;\n\t\t\tthis._w = this._w * l;\n\n\t\t}\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tmultiply( q ) {\n\n\t\treturn this.multiplyQuaternions( this, q );\n\n\t}\n\n\tpremultiply( q ) {\n\n\t\treturn this.multiplyQuaternions( q, this );\n\n\t}\n\n\tmultiplyQuaternions( a, b ) {\n\n\t\t// from http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/code/index.htm\n\n\t\tconst qax = a._x, qay = a._y, qaz = a._z, qaw = a._w;\n\t\tconst qbx = b._x, qby = b._y, qbz = b._z, qbw = b._w;\n\n\t\tthis._x = qax * qbw + qaw * qbx + qay * qbz - qaz * qby;\n\t\tthis._y = qay * qbw + qaw * qby + qaz * qbx - qax * qbz;\n\t\tthis._z = qaz * qbw + qaw * qbz + qax * qby - qay * qbx;\n\t\tthis._w = qaw * qbw - qax * qbx - qay * qby - qaz * qbz;\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tslerp( qb, t ) {\n\n\t\tif ( t === 0 ) return this;\n\t\tif ( t === 1 ) return this.copy( qb );\n\n\t\tconst x = this._x, y = this._y, z = this._z, w = this._w;\n\n\t\t// http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/slerp/\n\n\t\tlet cosHalfTheta = w * qb._w + x * qb._x + y * qb._y + z * qb._z;\n\n\t\tif ( cosHalfTheta < 0 ) {\n\n\t\t\tthis._w = - qb._w;\n\t\t\tthis._x = - qb._x;\n\t\t\tthis._y = - qb._y;\n\t\t\tthis._z = - qb._z;\n\n\t\t\tcosHalfTheta = - cosHalfTheta;\n\n\t\t} else {\n\n\t\t\tthis.copy( qb );\n\n\t\t}\n\n\t\tif ( cosHalfTheta >= 1.0 ) {\n\n\t\t\tthis._w = w;\n\t\t\tthis._x = x;\n\t\t\tthis._y = y;\n\t\t\tthis._z = z;\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\tconst sqrSinHalfTheta = 1.0 - cosHalfTheta * cosHalfTheta;\n\n\t\tif ( sqrSinHalfTheta <= Number.EPSILON ) {\n\n\t\t\tconst s = 1 - t;\n\t\t\tthis._w = s * w + t * this._w;\n\t\t\tthis._x = s * x + t * this._x;\n\t\t\tthis._y = s * y + t * this._y;\n\t\t\tthis._z = s * z + t * this._z;\n\n\t\t\tthis.normalize();\n\t\t\tthis._onChangeCallback();\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\tconst sinHalfTheta = Math.sqrt( sqrSinHalfTheta );\n\t\tconst halfTheta = Math.atan2( sinHalfTheta, cosHalfTheta );\n\t\tconst ratioA = Math.sin( ( 1 - t ) * halfTheta ) / sinHalfTheta,\n\t\t\tratioB = Math.sin( t * halfTheta ) / sinHalfTheta;\n\n\t\tthis._w = ( w * ratioA + this._w * ratioB );\n\t\tthis._x = ( x * ratioA + this._x * ratioB );\n\t\tthis._y = ( y * ratioA + this._y * ratioB );\n\t\tthis._z = ( z * ratioA + this._z * ratioB );\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tslerpQuaternions( qa, qb, t ) {\n\n\t\treturn this.copy( qa ).slerp( qb, t );\n\n\t}\n\n\trandom() {\n\n\t\t// Derived from http://planning.cs.uiuc.edu/node198.html\n\t\t// Note, this source uses w, x, y, z ordering,\n\t\t// so we swap the order below.\n\n\t\tconst u1 = Math.random();\n\t\tconst sqrt1u1 = Math.sqrt( 1 - u1 );\n\t\tconst sqrtu1 = Math.sqrt( u1 );\n\n\t\tconst u2 = 2 * Math.PI * Math.random();\n\n\t\tconst u3 = 2 * Math.PI * Math.random();\n\n\t\treturn this.set(\n\t\t\tsqrt1u1 * Math.cos( u2 ),\n\t\t\tsqrtu1 * Math.sin( u3 ),\n\t\t\tsqrtu1 * Math.cos( u3 ),\n\t\t\tsqrt1u1 * Math.sin( u2 ),\n\t\t);\n\n\t}\n\n\tequals( quaternion ) {\n\n\t\treturn ( quaternion._x === this._x ) && ( quaternion._y === this._y ) && ( quaternion._z === this._z ) && ( quaternion._w === this._w );\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tthis._x = array[ offset ];\n\t\tthis._y = array[ offset + 1 ];\n\t\tthis._z = array[ offset + 2 ];\n\t\tthis._w = array[ offset + 3 ];\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tarray[ offset ] = this._x;\n\t\tarray[ offset + 1 ] = this._y;\n\t\tarray[ offset + 2 ] = this._z;\n\t\tarray[ offset + 3 ] = this._w;\n\n\t\treturn array;\n\n\t}\n\n\tfromBufferAttribute( attribute, index ) {\n\n\t\tthis._x = attribute.getX( index );\n\t\tthis._y = attribute.getY( index );\n\t\tthis._z = attribute.getZ( index );\n\t\tthis._w = attribute.getW( index );\n\n\t\treturn this;\n\n\t}\n\n\t_onChange( callback ) {\n\n\t\tthis._onChangeCallback = callback;\n\n\t\treturn this;\n\n\t}\n\n\t_onChangeCallback() {}\n\n\t*[ Symbol.iterator ]() {\n\n\t\tyield this._x;\n\t\tyield this._y;\n\t\tyield this._z;\n\t\tyield this._w;\n\n\t}\n\n}\n\nclass Vector3 {\n\n\tconstructor( x = 0, y = 0, z = 0 ) {\n\n\t\tVector3.prototype.isVector3 = true;\n\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.z = z;\n\n\t}\n\n\tset( x, y, z ) {\n\n\t\tif ( z === undefined ) z = this.z; // sprite.scale.set(x,y)\n\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.z = z;\n\n\t\treturn this;\n\n\t}\n\n\tsetScalar( scalar ) {\n\n\t\tthis.x = scalar;\n\t\tthis.y = scalar;\n\t\tthis.z = scalar;\n\n\t\treturn this;\n\n\t}\n\n\tsetX( x ) {\n\n\t\tthis.x = x;\n\n\t\treturn this;\n\n\t}\n\n\tsetY( y ) {\n\n\t\tthis.y = y;\n\n\t\treturn this;\n\n\t}\n\n\tsetZ( z ) {\n\n\t\tthis.z = z;\n\n\t\treturn this;\n\n\t}\n\n\tsetComponent( index, value ) {\n\n\t\tswitch ( index ) {\n\n\t\t\tcase 0: this.x = value; break;\n\t\t\tcase 1: this.y = value; break;\n\t\t\tcase 2: this.z = value; break;\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tgetComponent( index ) {\n\n\t\tswitch ( index ) {\n\n\t\t\tcase 0: return this.x;\n\t\t\tcase 1: return this.y;\n\t\t\tcase 2: return this.z;\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t}\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this.x, this.y, this.z );\n\n\t}\n\n\tcopy( v ) {\n\n\t\tthis.x = v.x;\n\t\tthis.y = v.y;\n\t\tthis.z = v.z;\n\n\t\treturn this;\n\n\t}\n\n\tadd( v ) {\n\n\t\tthis.x += v.x;\n\t\tthis.y += v.y;\n\t\tthis.z += v.z;\n\n\t\treturn this;\n\n\t}\n\n\taddScalar( s ) {\n\n\t\tthis.x += s;\n\t\tthis.y += s;\n\t\tthis.z += s;\n\n\t\treturn this;\n\n\t}\n\n\taddVectors( a, b ) {\n\n\t\tthis.x = a.x + b.x;\n\t\tthis.y = a.y + b.y;\n\t\tthis.z = a.z + b.z;\n\n\t\treturn this;\n\n\t}\n\n\taddScaledVector( v, s ) {\n\n\t\tthis.x += v.x * s;\n\t\tthis.y += v.y * s;\n\t\tthis.z += v.z * s;\n\n\t\treturn this;\n\n\t}\n\n\tsub( v ) {\n\n\t\tthis.x -= v.x;\n\t\tthis.y -= v.y;\n\t\tthis.z -= v.z;\n\n\t\treturn this;\n\n\t}\n\n\tsubScalar( s ) {\n\n\t\tthis.x -= s;\n\t\tthis.y -= s;\n\t\tthis.z -= s;\n\n\t\treturn this;\n\n\t}\n\n\tsubVectors( a, b ) {\n\n\t\tthis.x = a.x - b.x;\n\t\tthis.y = a.y - b.y;\n\t\tthis.z = a.z - b.z;\n\n\t\treturn this;\n\n\t}\n\n\tmultiply( v ) {\n\n\t\tthis.x *= v.x;\n\t\tthis.y *= v.y;\n\t\tthis.z *= v.z;\n\n\t\treturn this;\n\n\t}\n\n\tmultiplyScalar( scalar ) {\n\n\t\tthis.x *= scalar;\n\t\tthis.y *= scalar;\n\t\tthis.z *= scalar;\n\n\t\treturn this;\n\n\t}\n\n\tmultiplyVectors( a, b ) {\n\n\t\tthis.x = a.x * b.x;\n\t\tthis.y = a.y * b.y;\n\t\tthis.z = a.z * b.z;\n\n\t\treturn this;\n\n\t}\n\n\tapplyEuler( euler ) {\n\n\t\treturn this.applyQuaternion( _quaternion$4.setFromEuler( euler ) );\n\n\t}\n\n\tapplyAxisAngle( axis, angle ) {\n\n\t\treturn this.applyQuaternion( _quaternion$4.setFromAxisAngle( axis, angle ) );\n\n\t}\n\n\tapplyMatrix3( m ) {\n\n\t\tconst x = this.x, y = this.y, z = this.z;\n\t\tconst e = m.elements;\n\n\t\tthis.x = e[ 0 ] * x + e[ 3 ] * y + e[ 6 ] * z;\n\t\tthis.y = e[ 1 ] * x + e[ 4 ] * y + e[ 7 ] * z;\n\t\tthis.z = e[ 2 ] * x + e[ 5 ] * y + e[ 8 ] * z;\n\n\t\treturn this;\n\n\t}\n\n\tapplyNormalMatrix( m ) {\n\n\t\treturn this.applyMatrix3( m ).normalize();\n\n\t}\n\n\tapplyMatrix4( m ) {\n\n\t\tconst x = this.x, y = this.y, z = this.z;\n\t\tconst e = m.elements;\n\n\t\tconst w = 1 / ( e[ 3 ] * x + e[ 7 ] * y + e[ 11 ] * z + e[ 15 ] );\n\n\t\tthis.x = ( e[ 0 ] * x + e[ 4 ] * y + e[ 8 ] * z + e[ 12 ] ) * w;\n\t\tthis.y = ( e[ 1 ] * x + e[ 5 ] * y + e[ 9 ] * z + e[ 13 ] ) * w;\n\t\tthis.z = ( e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z + e[ 14 ] ) * w;\n\n\t\treturn this;\n\n\t}\n\n\tapplyQuaternion( q ) {\n\n\t\tconst x = this.x, y = this.y, z = this.z;\n\t\tconst qx = q.x, qy = q.y, qz = q.z, qw = q.w;\n\n\t\t// calculate quat * vector\n\n\t\tconst ix = qw * x + qy * z - qz * y;\n\t\tconst iy = qw * y + qz * x - qx * z;\n\t\tconst iz = qw * z + qx * y - qy * x;\n\t\tconst iw = - qx * x - qy * y - qz * z;\n\n\t\t// calculate result * inverse quat\n\n\t\tthis.x = ix * qw + iw * - qx + iy * - qz - iz * - qy;\n\t\tthis.y = iy * qw + iw * - qy + iz * - qx - ix * - qz;\n\t\tthis.z = iz * qw + iw * - qz + ix * - qy - iy * - qx;\n\n\t\treturn this;\n\n\t}\n\n\tproject( camera ) {\n\n\t\treturn this.applyMatrix4( camera.matrixWorldInverse ).applyMatrix4( camera.projectionMatrix );\n\n\t}\n\n\tunproject( camera ) {\n\n\t\treturn this.applyMatrix4( camera.projectionMatrixInverse ).applyMatrix4( camera.matrixWorld );\n\n\t}\n\n\ttransformDirection( m ) {\n\n\t\t// input: THREE.Matrix4 affine matrix\n\t\t// vector interpreted as a direction\n\n\t\tconst x = this.x, y = this.y, z = this.z;\n\t\tconst e = m.elements;\n\n\t\tthis.x = e[ 0 ] * x + e[ 4 ] * y + e[ 8 ] * z;\n\t\tthis.y = e[ 1 ] * x + e[ 5 ] * y + e[ 9 ] * z;\n\t\tthis.z = e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z;\n\n\t\treturn this.normalize();\n\n\t}\n\n\tdivide( v ) {\n\n\t\tthis.x /= v.x;\n\t\tthis.y /= v.y;\n\t\tthis.z /= v.z;\n\n\t\treturn this;\n\n\t}\n\n\tdivideScalar( scalar ) {\n\n\t\treturn this.multiplyScalar( 1 / scalar );\n\n\t}\n\n\tmin( v ) {\n\n\t\tthis.x = Math.min( this.x, v.x );\n\t\tthis.y = Math.min( this.y, v.y );\n\t\tthis.z = Math.min( this.z, v.z );\n\n\t\treturn this;\n\n\t}\n\n\tmax( v ) {\n\n\t\tthis.x = Math.max( this.x, v.x );\n\t\tthis.y = Math.max( this.y, v.y );\n\t\tthis.z = Math.max( this.z, v.z );\n\n\t\treturn this;\n\n\t}\n\n\tclamp( min, max ) {\n\n\t\t// assumes min < max, componentwise\n\n\t\tthis.x = Math.max( min.x, Math.min( max.x, this.x ) );\n\t\tthis.y = Math.max( min.y, Math.min( max.y, this.y ) );\n\t\tthis.z = Math.max( min.z, Math.min( max.z, this.z ) );\n\n\t\treturn this;\n\n\t}\n\n\tclampScalar( minVal, maxVal ) {\n\n\t\tthis.x = Math.max( minVal, Math.min( maxVal, this.x ) );\n\t\tthis.y = Math.max( minVal, Math.min( maxVal, this.y ) );\n\t\tthis.z = Math.max( minVal, Math.min( maxVal, this.z ) );\n\n\t\treturn this;\n\n\t}\n\n\tclampLength( min, max ) {\n\n\t\tconst length = this.length();\n\n\t\treturn this.divideScalar( length || 1 ).multiplyScalar( Math.max( min, Math.min( max, length ) ) );\n\n\t}\n\n\tfloor() {\n\n\t\tthis.x = Math.floor( this.x );\n\t\tthis.y = Math.floor( this.y );\n\t\tthis.z = Math.floor( this.z );\n\n\t\treturn this;\n\n\t}\n\n\tceil() {\n\n\t\tthis.x = Math.ceil( this.x );\n\t\tthis.y = Math.ceil( this.y );\n\t\tthis.z = Math.ceil( this.z );\n\n\t\treturn this;\n\n\t}\n\n\tround() {\n\n\t\tthis.x = Math.round( this.x );\n\t\tthis.y = Math.round( this.y );\n\t\tthis.z = Math.round( this.z );\n\n\t\treturn this;\n\n\t}\n\n\troundToZero() {\n\n\t\tthis.x = ( this.x < 0 ) ? Math.ceil( this.x ) : Math.floor( this.x );\n\t\tthis.y = ( this.y < 0 ) ? Math.ceil( this.y ) : Math.floor( this.y );\n\t\tthis.z = ( this.z < 0 ) ? Math.ceil( this.z ) : Math.floor( this.z );\n\n\t\treturn this;\n\n\t}\n\n\tnegate() {\n\n\t\tthis.x = - this.x;\n\t\tthis.y = - this.y;\n\t\tthis.z = - this.z;\n\n\t\treturn this;\n\n\t}\n\n\tdot( v ) {\n\n\t\treturn this.x * v.x + this.y * v.y + this.z * v.z;\n\n\t}\n\n\t// TODO lengthSquared?\n\n\tlengthSq() {\n\n\t\treturn this.x * this.x + this.y * this.y + this.z * this.z;\n\n\t}\n\n\tlength() {\n\n\t\treturn Math.sqrt( this.x * this.x + this.y * this.y + this.z * this.z );\n\n\t}\n\n\tmanhattanLength() {\n\n\t\treturn Math.abs( this.x ) + Math.abs( this.y ) + Math.abs( this.z );\n\n\t}\n\n\tnormalize() {\n\n\t\treturn this.divideScalar( this.length() || 1 );\n\n\t}\n\n\tsetLength( length ) {\n\n\t\treturn this.normalize().multiplyScalar( length );\n\n\t}\n\n\tlerp( v, alpha ) {\n\n\t\tthis.x += ( v.x - this.x ) * alpha;\n\t\tthis.y += ( v.y - this.y ) * alpha;\n\t\tthis.z += ( v.z - this.z ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tlerpVectors( v1, v2, alpha ) {\n\n\t\tthis.x = v1.x + ( v2.x - v1.x ) * alpha;\n\t\tthis.y = v1.y + ( v2.y - v1.y ) * alpha;\n\t\tthis.z = v1.z + ( v2.z - v1.z ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tcross( v ) {\n\n\t\treturn this.crossVectors( this, v );\n\n\t}\n\n\tcrossVectors( a, b ) {\n\n\t\tconst ax = a.x, ay = a.y, az = a.z;\n\t\tconst bx = b.x, by = b.y, bz = b.z;\n\n\t\tthis.x = ay * bz - az * by;\n\t\tthis.y = az * bx - ax * bz;\n\t\tthis.z = ax * by - ay * bx;\n\n\t\treturn this;\n\n\t}\n\n\tprojectOnVector( v ) {\n\n\t\tconst denominator = v.lengthSq();\n\n\t\tif ( denominator === 0 ) return this.set( 0, 0, 0 );\n\n\t\tconst scalar = v.dot( this ) / denominator;\n\n\t\treturn this.copy( v ).multiplyScalar( scalar );\n\n\t}\n\n\tprojectOnPlane( planeNormal ) {\n\n\t\t_vector$c.copy( this ).projectOnVector( planeNormal );\n\n\t\treturn this.sub( _vector$c );\n\n\t}\n\n\treflect( normal ) {\n\n\t\t// reflect incident vector off plane orthogonal to normal\n\t\t// normal is assumed to have unit length\n\n\t\treturn this.sub( _vector$c.copy( normal ).multiplyScalar( 2 * this.dot( normal ) ) );\n\n\t}\n\n\tangleTo( v ) {\n\n\t\tconst denominator = Math.sqrt( this.lengthSq() * v.lengthSq() );\n\n\t\tif ( denominator === 0 ) return Math.PI / 2;\n\n\t\tconst theta = this.dot( v ) / denominator;\n\n\t\t// clamp, to handle numerical problems\n\n\t\treturn Math.acos( clamp( theta, - 1, 1 ) );\n\n\t}\n\n\tdistanceTo( v ) {\n\n\t\treturn Math.sqrt( this.distanceToSquared( v ) );\n\n\t}\n\n\tdistanceToSquared( v ) {\n\n\t\tconst dx = this.x - v.x, dy = this.y - v.y, dz = this.z - v.z;\n\n\t\treturn dx * dx + dy * dy + dz * dz;\n\n\t}\n\n\tmanhattanDistanceTo( v ) {\n\n\t\treturn Math.abs( this.x - v.x ) + Math.abs( this.y - v.y ) + Math.abs( this.z - v.z );\n\n\t}\n\n\tsetFromSpherical( s ) {\n\n\t\treturn this.setFromSphericalCoords( s.radius, s.phi, s.theta );\n\n\t}\n\n\tsetFromSphericalCoords( radius, phi, theta ) {\n\n\t\tconst sinPhiRadius = Math.sin( phi ) * radius;\n\n\t\tthis.x = sinPhiRadius * Math.sin( theta );\n\t\tthis.y = Math.cos( phi ) * radius;\n\t\tthis.z = sinPhiRadius * Math.cos( theta );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromCylindrical( c ) {\n\n\t\treturn this.setFromCylindricalCoords( c.radius, c.theta, c.y );\n\n\t}\n\n\tsetFromCylindricalCoords( radius, theta, y ) {\n\n\t\tthis.x = radius * Math.sin( theta );\n\t\tthis.y = y;\n\t\tthis.z = radius * Math.cos( theta );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromMatrixPosition( m ) {\n\n\t\tconst e = m.elements;\n\n\t\tthis.x = e[ 12 ];\n\t\tthis.y = e[ 13 ];\n\t\tthis.z = e[ 14 ];\n\n\t\treturn this;\n\n\t}\n\n\tsetFromMatrixScale( m ) {\n\n\t\tconst sx = this.setFromMatrixColumn( m, 0 ).length();\n\t\tconst sy = this.setFromMatrixColumn( m, 1 ).length();\n\t\tconst sz = this.setFromMatrixColumn( m, 2 ).length();\n\n\t\tthis.x = sx;\n\t\tthis.y = sy;\n\t\tthis.z = sz;\n\n\t\treturn this;\n\n\t}\n\n\tsetFromMatrixColumn( m, index ) {\n\n\t\treturn this.fromArray( m.elements, index * 4 );\n\n\t}\n\n\tsetFromMatrix3Column( m, index ) {\n\n\t\treturn this.fromArray( m.elements, index * 3 );\n\n\t}\n\n\tsetFromEuler( e ) {\n\n\t\tthis.x = e._x;\n\t\tthis.y = e._y;\n\t\tthis.z = e._z;\n\n\t\treturn this;\n\n\t}\n\n\tequals( v ) {\n\n\t\treturn ( ( v.x === this.x ) && ( v.y === this.y ) && ( v.z === this.z ) );\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tthis.x = array[ offset ];\n\t\tthis.y = array[ offset + 1 ];\n\t\tthis.z = array[ offset + 2 ];\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tarray[ offset ] = this.x;\n\t\tarray[ offset + 1 ] = this.y;\n\t\tarray[ offset + 2 ] = this.z;\n\n\t\treturn array;\n\n\t}\n\n\tfromBufferAttribute( attribute, index ) {\n\n\t\tthis.x = attribute.getX( index );\n\t\tthis.y = attribute.getY( index );\n\t\tthis.z = attribute.getZ( index );\n\n\t\treturn this;\n\n\t}\n\n\trandom() {\n\n\t\tthis.x = Math.random();\n\t\tthis.y = Math.random();\n\t\tthis.z = Math.random();\n\n\t\treturn this;\n\n\t}\n\n\trandomDirection() {\n\n\t\t// Derived from https://mathworld.wolfram.com/SpherePointPicking.html\n\n\t\tconst u = ( Math.random() - 0.5 ) * 2;\n\t\tconst t = Math.random() * Math.PI * 2;\n\t\tconst f = Math.sqrt( 1 - u ** 2 );\n\n\t\tthis.x = f * Math.cos( t );\n\t\tthis.y = f * Math.sin( t );\n\t\tthis.z = u;\n\n\t\treturn this;\n\n\t}\n\n\t*[ Symbol.iterator ]() {\n\n\t\tyield this.x;\n\t\tyield this.y;\n\t\tyield this.z;\n\n\t}\n\n}\n\nconst _vector$c = /*@__PURE__*/ new Vector3();\nconst _quaternion$4 = /*@__PURE__*/ new Quaternion();\n\nclass Box3 {\n\n\tconstructor( min = new Vector3( + Infinity, + Infinity, + Infinity ), max = new Vector3( - Infinity, - Infinity, - Infinity ) ) {\n\n\t\tthis.isBox3 = true;\n\n\t\tthis.min = min;\n\t\tthis.max = max;\n\n\t}\n\n\tset( min, max ) {\n\n\t\tthis.min.copy( min );\n\t\tthis.max.copy( max );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromArray( array ) {\n\n\t\tlet minX = + Infinity;\n\t\tlet minY = + Infinity;\n\t\tlet minZ = + Infinity;\n\n\t\tlet maxX = - Infinity;\n\t\tlet maxY = - Infinity;\n\t\tlet maxZ = - Infinity;\n\n\t\tfor ( let i = 0, l = array.length; i < l; i += 3 ) {\n\n\t\t\tconst x = array[ i ];\n\t\t\tconst y = array[ i + 1 ];\n\t\t\tconst z = array[ i + 2 ];\n\n\t\t\tif ( x < minX ) minX = x;\n\t\t\tif ( y < minY ) minY = y;\n\t\t\tif ( z < minZ ) minZ = z;\n\n\t\t\tif ( x > maxX ) maxX = x;\n\t\t\tif ( y > maxY ) maxY = y;\n\t\t\tif ( z > maxZ ) maxZ = z;\n\n\t\t}\n\n\t\tthis.min.set( minX, minY, minZ );\n\t\tthis.max.set( maxX, maxY, maxZ );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromBufferAttribute( attribute ) {\n\n\t\tlet minX = + Infinity;\n\t\tlet minY = + Infinity;\n\t\tlet minZ = + Infinity;\n\n\t\tlet maxX = - Infinity;\n\t\tlet maxY = - Infinity;\n\t\tlet maxZ = - Infinity;\n\n\t\tfor ( let i = 0, l = attribute.count; i < l; i ++ ) {\n\n\t\t\tconst x = attribute.getX( i );\n\t\t\tconst y = attribute.getY( i );\n\t\t\tconst z = attribute.getZ( i );\n\n\t\t\tif ( x < minX ) minX = x;\n\t\t\tif ( y < minY ) minY = y;\n\t\t\tif ( z < minZ ) minZ = z;\n\n\t\t\tif ( x > maxX ) maxX = x;\n\t\t\tif ( y > maxY ) maxY = y;\n\t\t\tif ( z > maxZ ) maxZ = z;\n\n\t\t}\n\n\t\tthis.min.set( minX, minY, minZ );\n\t\tthis.max.set( maxX, maxY, maxZ );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromPoints( points ) {\n\n\t\tthis.makeEmpty();\n\n\t\tfor ( let i = 0, il = points.length; i < il; i ++ ) {\n\n\t\t\tthis.expandByPoint( points[ i ] );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetFromCenterAndSize( center, size ) {\n\n\t\tconst halfSize = _vector$b.copy( size ).multiplyScalar( 0.5 );\n\n\t\tthis.min.copy( center ).sub( halfSize );\n\t\tthis.max.copy( center ).add( halfSize );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromObject( object, precise = false ) {\n\n\t\tthis.makeEmpty();\n\n\t\treturn this.expandByObject( object, precise );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\tcopy( box ) {\n\n\t\tthis.min.copy( box.min );\n\t\tthis.max.copy( box.max );\n\n\t\treturn this;\n\n\t}\n\n\tmakeEmpty() {\n\n\t\tthis.min.x = this.min.y = this.min.z = + Infinity;\n\t\tthis.max.x = this.max.y = this.max.z = - Infinity;\n\n\t\treturn this;\n\n\t}\n\n\tisEmpty() {\n\n\t\t// this is a more robust check for empty than ( volume <= 0 ) because volume can get positive with two negative axes\n\n\t\treturn ( this.max.x < this.min.x ) || ( this.max.y < this.min.y ) || ( this.max.z < this.min.z );\n\n\t}\n\n\tgetCenter( target ) {\n\n\t\treturn this.isEmpty() ? target.set( 0, 0, 0 ) : target.addVectors( this.min, this.max ).multiplyScalar( 0.5 );\n\n\t}\n\n\tgetSize( target ) {\n\n\t\treturn this.isEmpty() ? target.set( 0, 0, 0 ) : target.subVectors( this.max, this.min );\n\n\t}\n\n\texpandByPoint( point ) {\n\n\t\tthis.min.min( point );\n\t\tthis.max.max( point );\n\n\t\treturn this;\n\n\t}\n\n\texpandByVector( vector ) {\n\n\t\tthis.min.sub( vector );\n\t\tthis.max.add( vector );\n\n\t\treturn this;\n\n\t}\n\n\texpandByScalar( scalar ) {\n\n\t\tthis.min.addScalar( - scalar );\n\t\tthis.max.addScalar( scalar );\n\n\t\treturn this;\n\n\t}\n\n\texpandByObject( object, precise = false ) {\n\n\t\t// Computes the world-axis-aligned bounding box of an object (including its children),\n\t\t// accounting for both the object's, and children's, world transforms\n\n\t\tobject.updateWorldMatrix( false, false );\n\n\t\tconst geometry = object.geometry;\n\n\t\tif ( geometry !== undefined ) {\n\n\t\t\tif ( precise && geometry.attributes != undefined && geometry.attributes.position !== undefined ) {\n\n\t\t\t\tconst position = geometry.attributes.position;\n\t\t\t\tfor ( let i = 0, l = position.count; i < l; i ++ ) {\n\n\t\t\t\t\t_vector$b.fromBufferAttribute( position, i ).applyMatrix4( object.matrixWorld );\n\t\t\t\t\tthis.expandByPoint( _vector$b );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tif ( geometry.boundingBox === null ) {\n\n\t\t\t\t\tgeometry.computeBoundingBox();\n\n\t\t\t\t}\n\n\t\t\t\t_box$3.copy( geometry.boundingBox );\n\t\t\t\t_box$3.applyMatrix4( object.matrixWorld );\n\n\t\t\t\tthis.union( _box$3 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst children = object.children;\n\n\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\tthis.expandByObject( children[ i ], precise );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tcontainsPoint( point ) {\n\n\t\treturn point.x < this.min.x || point.x > this.max.x ||\n\t\t\tpoint.y < this.min.y || point.y > this.max.y ||\n\t\t\tpoint.z < this.min.z || point.z > this.max.z ? false : true;\n\n\t}\n\n\tcontainsBox( box ) {\n\n\t\treturn this.min.x <= box.min.x && box.max.x <= this.max.x &&\n\t\t\tthis.min.y <= box.min.y && box.max.y <= this.max.y &&\n\t\t\tthis.min.z <= box.min.z && box.max.z <= this.max.z;\n\n\t}\n\n\tgetParameter( point, target ) {\n\n\t\t// This can potentially have a divide by zero if the box\n\t\t// has a size dimension of 0.\n\n\t\treturn target.set(\n\t\t\t( point.x - this.min.x ) / ( this.max.x - this.min.x ),\n\t\t\t( point.y - this.min.y ) / ( this.max.y - this.min.y ),\n\t\t\t( point.z - this.min.z ) / ( this.max.z - this.min.z )\n\t\t);\n\n\t}\n\n\tintersectsBox( box ) {\n\n\t\t// using 6 splitting planes to rule out intersections.\n\t\treturn box.max.x < this.min.x || box.min.x > this.max.x ||\n\t\t\tbox.max.y < this.min.y || box.min.y > this.max.y ||\n\t\t\tbox.max.z < this.min.z || box.min.z > this.max.z ? false : true;\n\n\t}\n\n\tintersectsSphere( sphere ) {\n\n\t\t// Find the point on the AABB closest to the sphere center.\n\t\tthis.clampPoint( sphere.center, _vector$b );\n\n\t\t// If that point is inside the sphere, the AABB and sphere intersect.\n\t\treturn _vector$b.distanceToSquared( sphere.center ) <= ( sphere.radius * sphere.radius );\n\n\t}\n\n\tintersectsPlane( plane ) {\n\n\t\t// We compute the minimum and maximum dot product values. If those values\n\t\t// are on the same side (back or front) of the plane, then there is no intersection.\n\n\t\tlet min, max;\n\n\t\tif ( plane.normal.x > 0 ) {\n\n\t\t\tmin = plane.normal.x * this.min.x;\n\t\t\tmax = plane.normal.x * this.max.x;\n\n\t\t} else {\n\n\t\t\tmin = plane.normal.x * this.max.x;\n\t\t\tmax = plane.normal.x * this.min.x;\n\n\t\t}\n\n\t\tif ( plane.normal.y > 0 ) {\n\n\t\t\tmin += plane.normal.y * this.min.y;\n\t\t\tmax += plane.normal.y * this.max.y;\n\n\t\t} else {\n\n\t\t\tmin += plane.normal.y * this.max.y;\n\t\t\tmax += plane.normal.y * this.min.y;\n\n\t\t}\n\n\t\tif ( plane.normal.z > 0 ) {\n\n\t\t\tmin += plane.normal.z * this.min.z;\n\t\t\tmax += plane.normal.z * this.max.z;\n\n\t\t} else {\n\n\t\t\tmin += plane.normal.z * this.max.z;\n\t\t\tmax += plane.normal.z * this.min.z;\n\n\t\t}\n\n\t\treturn ( min <= - plane.constant && max >= - plane.constant );\n\n\t}\n\n\tintersectsTriangle( triangle ) {\n\n\t\tif ( this.isEmpty() ) {\n\n\t\t\treturn false;\n\n\t\t}\n\n\t\t// compute box center and extents\n\t\tthis.getCenter( _center );\n\t\t_extents.subVectors( this.max, _center );\n\n\t\t// translate triangle to aabb origin\n\t\t_v0$2.subVectors( triangle.a, _center );\n\t\t_v1$7.subVectors( triangle.b, _center );\n\t\t_v2$4.subVectors( triangle.c, _center );\n\n\t\t// compute edge vectors for triangle\n\t\t_f0.subVectors( _v1$7, _v0$2 );\n\t\t_f1.subVectors( _v2$4, _v1$7 );\n\t\t_f2.subVectors( _v0$2, _v2$4 );\n\n\t\t// test against axes that are given by cross product combinations of the edges of the triangle and the edges of the aabb\n\t\t// make an axis testing of each of the 3 sides of the aabb against each of the 3 sides of the triangle = 9 axis of separation\n\t\t// axis_ij = u_i x f_j (u0, u1, u2 = face normals of aabb = x,y,z axes vectors since aabb is axis aligned)\n\t\tlet axes = [\n\t\t\t0, - _f0.z, _f0.y, 0, - _f1.z, _f1.y, 0, - _f2.z, _f2.y,\n\t\t\t_f0.z, 0, - _f0.x, _f1.z, 0, - _f1.x, _f2.z, 0, - _f2.x,\n\t\t\t- _f0.y, _f0.x, 0, - _f1.y, _f1.x, 0, - _f2.y, _f2.x, 0\n\t\t];\n\t\tif ( ! satForAxes( axes, _v0$2, _v1$7, _v2$4, _extents ) ) {\n\n\t\t\treturn false;\n\n\t\t}\n\n\t\t// test 3 face normals from the aabb\n\t\taxes = [ 1, 0, 0, 0, 1, 0, 0, 0, 1 ];\n\t\tif ( ! satForAxes( axes, _v0$2, _v1$7, _v2$4, _extents ) ) {\n\n\t\t\treturn false;\n\n\t\t}\n\n\t\t// finally testing the face normal of the triangle\n\t\t// use already existing triangle edge vectors here\n\t\t_triangleNormal.crossVectors( _f0, _f1 );\n\t\taxes = [ _triangleNormal.x, _triangleNormal.y, _triangleNormal.z ];\n\n\t\treturn satForAxes( axes, _v0$2, _v1$7, _v2$4, _extents );\n\n\t}\n\n\tclampPoint( point, target ) {\n\n\t\treturn target.copy( point ).clamp( this.min, this.max );\n\n\t}\n\n\tdistanceToPoint( point ) {\n\n\t\tconst clampedPoint = _vector$b.copy( point ).clamp( this.min, this.max );\n\n\t\treturn clampedPoint.sub( point ).length();\n\n\t}\n\n\tgetBoundingSphere( target ) {\n\n\t\tthis.getCenter( target.center );\n\n\t\ttarget.radius = this.getSize( _vector$b ).length() * 0.5;\n\n\t\treturn target;\n\n\t}\n\n\tintersect( box ) {\n\n\t\tthis.min.max( box.min );\n\t\tthis.max.min( box.max );\n\n\t\t// ensure that if there is no overlap, the result is fully empty, not slightly empty with non-inf/+inf values that will cause subsequence intersects to erroneously return valid values.\n\t\tif ( this.isEmpty() ) this.makeEmpty();\n\n\t\treturn this;\n\n\t}\n\n\tunion( box ) {\n\n\t\tthis.min.min( box.min );\n\t\tthis.max.max( box.max );\n\n\t\treturn this;\n\n\t}\n\n\tapplyMatrix4( matrix ) {\n\n\t\t// transform of empty box is an empty box.\n\t\tif ( this.isEmpty() ) return this;\n\n\t\t// NOTE: I am using a binary pattern to specify all 2^3 combinations below\n\t\t_points[ 0 ].set( this.min.x, this.min.y, this.min.z ).applyMatrix4( matrix ); // 000\n\t\t_points[ 1 ].set( this.min.x, this.min.y, this.max.z ).applyMatrix4( matrix ); // 001\n\t\t_points[ 2 ].set( this.min.x, this.max.y, this.min.z ).applyMatrix4( matrix ); // 010\n\t\t_points[ 3 ].set( this.min.x, this.max.y, this.max.z ).applyMatrix4( matrix ); // 011\n\t\t_points[ 4 ].set( this.max.x, this.min.y, this.min.z ).applyMatrix4( matrix ); // 100\n\t\t_points[ 5 ].set( this.max.x, this.min.y, this.max.z ).applyMatrix4( matrix ); // 101\n\t\t_points[ 6 ].set( this.max.x, this.max.y, this.min.z ).applyMatrix4( matrix ); // 110\n\t\t_points[ 7 ].set( this.max.x, this.max.y, this.max.z ).applyMatrix4( matrix ); // 111\n\n\t\tthis.setFromPoints( _points );\n\n\t\treturn this;\n\n\t}\n\n\ttranslate( offset ) {\n\n\t\tthis.min.add( offset );\n\t\tthis.max.add( offset );\n\n\t\treturn this;\n\n\t}\n\n\tequals( box ) {\n\n\t\treturn box.min.equals( this.min ) && box.max.equals( this.max );\n\n\t}\n\n}\n\nconst _points = [\n\t/*@__PURE__*/ new Vector3(),\n\t/*@__PURE__*/ new Vector3(),\n\t/*@__PURE__*/ new Vector3(),\n\t/*@__PURE__*/ new Vector3(),\n\t/*@__PURE__*/ new Vector3(),\n\t/*@__PURE__*/ new Vector3(),\n\t/*@__PURE__*/ new Vector3(),\n\t/*@__PURE__*/ new Vector3()\n];\n\nconst _vector$b = /*@__PURE__*/ new Vector3();\n\nconst _box$3 = /*@__PURE__*/ new Box3();\n\n// triangle centered vertices\n\nconst _v0$2 = /*@__PURE__*/ new Vector3();\nconst _v1$7 = /*@__PURE__*/ new Vector3();\nconst _v2$4 = /*@__PURE__*/ new Vector3();\n\n// triangle edge vectors\n\nconst _f0 = /*@__PURE__*/ new Vector3();\nconst _f1 = /*@__PURE__*/ new Vector3();\nconst _f2 = /*@__PURE__*/ new Vector3();\n\nconst _center = /*@__PURE__*/ new Vector3();\nconst _extents = /*@__PURE__*/ new Vector3();\nconst _triangleNormal = /*@__PURE__*/ new Vector3();\nconst _testAxis = /*@__PURE__*/ new Vector3();\n\nfunction satForAxes( axes, v0, v1, v2, extents ) {\n\n\tfor ( let i = 0, j = axes.length - 3; i <= j; i += 3 ) {\n\n\t\t_testAxis.fromArray( axes, i );\n\t\t// project the aabb onto the separating axis\n\t\tconst r = extents.x * Math.abs( _testAxis.x ) + extents.y * Math.abs( _testAxis.y ) + extents.z * Math.abs( _testAxis.z );\n\t\t// project all 3 vertices of the triangle onto the separating axis\n\t\tconst p0 = v0.dot( _testAxis );\n\t\tconst p1 = v1.dot( _testAxis );\n\t\tconst p2 = v2.dot( _testAxis );\n\t\t// actual test, basically see if either of the most extreme of the triangle points intersects r\n\t\tif ( Math.max( - Math.max( p0, p1, p2 ), Math.min( p0, p1, p2 ) ) > r ) {\n\n\t\t\t// points of the projected triangle are outside the projected half-length of the aabb\n\t\t\t// the axis is separating and we can exit\n\t\t\treturn false;\n\n\t\t}\n\n\t}\n\n\treturn true;\n\n}\n\nconst _box$2 = /*@__PURE__*/ new Box3();\nconst _v1$6 = /*@__PURE__*/ new Vector3();\nconst _v2$3 = /*@__PURE__*/ new Vector3();\n\nclass Sphere {\n\n\tconstructor( center = new Vector3(), radius = - 1 ) {\n\n\t\tthis.center = center;\n\t\tthis.radius = radius;\n\n\t}\n\n\tset( center, radius ) {\n\n\t\tthis.center.copy( center );\n\t\tthis.radius = radius;\n\n\t\treturn this;\n\n\t}\n\n\tsetFromPoints( points, optionalCenter ) {\n\n\t\tconst center = this.center;\n\n\t\tif ( optionalCenter !== undefined ) {\n\n\t\t\tcenter.copy( optionalCenter );\n\n\t\t} else {\n\n\t\t\t_box$2.setFromPoints( points ).getCenter( center );\n\n\t\t}\n\n\t\tlet maxRadiusSq = 0;\n\n\t\tfor ( let i = 0, il = points.length; i < il; i ++ ) {\n\n\t\t\tmaxRadiusSq = Math.max( maxRadiusSq, center.distanceToSquared( points[ i ] ) );\n\n\t\t}\n\n\t\tthis.radius = Math.sqrt( maxRadiusSq );\n\n\t\treturn this;\n\n\t}\n\n\tcopy( sphere ) {\n\n\t\tthis.center.copy( sphere.center );\n\t\tthis.radius = sphere.radius;\n\n\t\treturn this;\n\n\t}\n\n\tisEmpty() {\n\n\t\treturn ( this.radius < 0 );\n\n\t}\n\n\tmakeEmpty() {\n\n\t\tthis.center.set( 0, 0, 0 );\n\t\tthis.radius = - 1;\n\n\t\treturn this;\n\n\t}\n\n\tcontainsPoint( point ) {\n\n\t\treturn ( point.distanceToSquared( this.center ) <= ( this.radius * this.radius ) );\n\n\t}\n\n\tdistanceToPoint( point ) {\n\n\t\treturn ( point.distanceTo( this.center ) - this.radius );\n\n\t}\n\n\tintersectsSphere( sphere ) {\n\n\t\tconst radiusSum = this.radius + sphere.radius;\n\n\t\treturn sphere.center.distanceToSquared( this.center ) <= ( radiusSum * radiusSum );\n\n\t}\n\n\tintersectsBox( box ) {\n\n\t\treturn box.intersectsSphere( this );\n\n\t}\n\n\tintersectsPlane( plane ) {\n\n\t\treturn Math.abs( plane.distanceToPoint( this.center ) ) <= this.radius;\n\n\t}\n\n\tclampPoint( point, target ) {\n\n\t\tconst deltaLengthSq = this.center.distanceToSquared( point );\n\n\t\ttarget.copy( point );\n\n\t\tif ( deltaLengthSq > ( this.radius * this.radius ) ) {\n\n\t\t\ttarget.sub( this.center ).normalize();\n\t\t\ttarget.multiplyScalar( this.radius ).add( this.center );\n\n\t\t}\n\n\t\treturn target;\n\n\t}\n\n\tgetBoundingBox( target ) {\n\n\t\tif ( this.isEmpty() ) {\n\n\t\t\t// Empty sphere produces empty bounding box\n\t\t\ttarget.makeEmpty();\n\t\t\treturn target;\n\n\t\t}\n\n\t\ttarget.set( this.center, this.center );\n\t\ttarget.expandByScalar( this.radius );\n\n\t\treturn target;\n\n\t}\n\n\tapplyMatrix4( matrix ) {\n\n\t\tthis.center.applyMatrix4( matrix );\n\t\tthis.radius = this.radius * matrix.getMaxScaleOnAxis();\n\n\t\treturn this;\n\n\t}\n\n\ttranslate( offset ) {\n\n\t\tthis.center.add( offset );\n\n\t\treturn this;\n\n\t}\n\n\texpandByPoint( point ) {\n\n\t\tif ( this.isEmpty() ) {\n\n\t\t\tthis.center.copy( point );\n\n\t\t\tthis.radius = 0;\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\t_v1$6.subVectors( point, this.center );\n\n\t\tconst lengthSq = _v1$6.lengthSq();\n\n\t\tif ( lengthSq > ( this.radius * this.radius ) ) {\n\n\t\t\t// calculate the minimal sphere\n\n\t\t\tconst length = Math.sqrt( lengthSq );\n\n\t\t\tconst delta = ( length - this.radius ) * 0.5;\n\n\t\t\tthis.center.addScaledVector( _v1$6, delta / length );\n\n\t\t\tthis.radius += delta;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tunion( sphere ) {\n\n\t\tif ( sphere.isEmpty() ) {\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\tif ( this.isEmpty() ) {\n\n\t\t\tthis.copy( sphere );\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\tif ( this.center.equals( sphere.center ) === true ) {\n\n\t\t\t this.radius = Math.max( this.radius, sphere.radius );\n\n\t\t} else {\n\n\t\t\t_v2$3.subVectors( sphere.center, this.center ).setLength( sphere.radius );\n\n\t\t\tthis.expandByPoint( _v1$6.copy( sphere.center ).add( _v2$3 ) );\n\n\t\t\tthis.expandByPoint( _v1$6.copy( sphere.center ).sub( _v2$3 ) );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tequals( sphere ) {\n\n\t\treturn sphere.center.equals( this.center ) && ( sphere.radius === this.radius );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n}\n\nconst _vector$a = /*@__PURE__*/ new Vector3();\nconst _segCenter = /*@__PURE__*/ new Vector3();\nconst _segDir = /*@__PURE__*/ new Vector3();\nconst _diff = /*@__PURE__*/ new Vector3();\n\nconst _edge1 = /*@__PURE__*/ new Vector3();\nconst _edge2 = /*@__PURE__*/ new Vector3();\nconst _normal$1 = /*@__PURE__*/ new Vector3();\n\nclass Ray {\n\n\tconstructor( origin = new Vector3(), direction = new Vector3( 0, 0, - 1 ) ) {\n\n\t\tthis.origin = origin;\n\t\tthis.direction = direction;\n\n\t}\n\n\tset( origin, direction ) {\n\n\t\tthis.origin.copy( origin );\n\t\tthis.direction.copy( direction );\n\n\t\treturn this;\n\n\t}\n\n\tcopy( ray ) {\n\n\t\tthis.origin.copy( ray.origin );\n\t\tthis.direction.copy( ray.direction );\n\n\t\treturn this;\n\n\t}\n\n\tat( t, target ) {\n\n\t\treturn target.copy( this.direction ).multiplyScalar( t ).add( this.origin );\n\n\t}\n\n\tlookAt( v ) {\n\n\t\tthis.direction.copy( v ).sub( this.origin ).normalize();\n\n\t\treturn this;\n\n\t}\n\n\trecast( t ) {\n\n\t\tthis.origin.copy( this.at( t, _vector$a ) );\n\n\t\treturn this;\n\n\t}\n\n\tclosestPointToPoint( point, target ) {\n\n\t\ttarget.subVectors( point, this.origin );\n\n\t\tconst directionDistance = target.dot( this.direction );\n\n\t\tif ( directionDistance < 0 ) {\n\n\t\t\treturn target.copy( this.origin );\n\n\t\t}\n\n\t\treturn target.copy( this.direction ).multiplyScalar( directionDistance ).add( this.origin );\n\n\t}\n\n\tdistanceToPoint( point ) {\n\n\t\treturn Math.sqrt( this.distanceSqToPoint( point ) );\n\n\t}\n\n\tdistanceSqToPoint( point ) {\n\n\t\tconst directionDistance = _vector$a.subVectors( point, this.origin ).dot( this.direction );\n\n\t\t// point behind the ray\n\n\t\tif ( directionDistance < 0 ) {\n\n\t\t\treturn this.origin.distanceToSquared( point );\n\n\t\t}\n\n\t\t_vector$a.copy( this.direction ).multiplyScalar( directionDistance ).add( this.origin );\n\n\t\treturn _vector$a.distanceToSquared( point );\n\n\t}\n\n\tdistanceSqToSegment( v0, v1, optionalPointOnRay, optionalPointOnSegment ) {\n\n\t\t// from https://github.com/pmjoniak/GeometricTools/blob/master/GTEngine/Include/Mathematics/GteDistRaySegment.h\n\t\t// It returns the min distance between the ray and the segment\n\t\t// defined by v0 and v1\n\t\t// It can also set two optional targets :\n\t\t// - The closest point on the ray\n\t\t// - The closest point on the segment\n\n\t\t_segCenter.copy( v0 ).add( v1 ).multiplyScalar( 0.5 );\n\t\t_segDir.copy( v1 ).sub( v0 ).normalize();\n\t\t_diff.copy( this.origin ).sub( _segCenter );\n\n\t\tconst segExtent = v0.distanceTo( v1 ) * 0.5;\n\t\tconst a01 = - this.direction.dot( _segDir );\n\t\tconst b0 = _diff.dot( this.direction );\n\t\tconst b1 = - _diff.dot( _segDir );\n\t\tconst c = _diff.lengthSq();\n\t\tconst det = Math.abs( 1 - a01 * a01 );\n\t\tlet s0, s1, sqrDist, extDet;\n\n\t\tif ( det > 0 ) {\n\n\t\t\t// The ray and segment are not parallel.\n\n\t\t\ts0 = a01 * b1 - b0;\n\t\t\ts1 = a01 * b0 - b1;\n\t\t\textDet = segExtent * det;\n\n\t\t\tif ( s0 >= 0 ) {\n\n\t\t\t\tif ( s1 >= - extDet ) {\n\n\t\t\t\t\tif ( s1 <= extDet ) {\n\n\t\t\t\t\t\t// region 0\n\t\t\t\t\t\t// Minimum at interior points of ray and segment.\n\n\t\t\t\t\t\tconst invDet = 1 / det;\n\t\t\t\t\t\ts0 *= invDet;\n\t\t\t\t\t\ts1 *= invDet;\n\t\t\t\t\t\tsqrDist = s0 * ( s0 + a01 * s1 + 2 * b0 ) + s1 * ( a01 * s0 + s1 + 2 * b1 ) + c;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// region 1\n\n\t\t\t\t\t\ts1 = segExtent;\n\t\t\t\t\t\ts0 = Math.max( 0, - ( a01 * s1 + b0 ) );\n\t\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// region 5\n\n\t\t\t\t\ts1 = - segExtent;\n\t\t\t\t\ts0 = Math.max( 0, - ( a01 * s1 + b0 ) );\n\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tif ( s1 <= - extDet ) {\n\n\t\t\t\t\t// region 4\n\n\t\t\t\t\ts0 = Math.max( 0, - ( - a01 * segExtent + b0 ) );\n\t\t\t\t\ts1 = ( s0 > 0 ) ? - segExtent : Math.min( Math.max( - segExtent, - b1 ), segExtent );\n\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t\t\t} else if ( s1 <= extDet ) {\n\n\t\t\t\t\t// region 3\n\n\t\t\t\t\ts0 = 0;\n\t\t\t\t\ts1 = Math.min( Math.max( - segExtent, - b1 ), segExtent );\n\t\t\t\t\tsqrDist = s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// region 2\n\n\t\t\t\t\ts0 = Math.max( 0, - ( a01 * segExtent + b0 ) );\n\t\t\t\t\ts1 = ( s0 > 0 ) ? segExtent : Math.min( Math.max( - segExtent, - b1 ), segExtent );\n\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\t// Ray and segment are parallel.\n\n\t\t\ts1 = ( a01 > 0 ) ? - segExtent : segExtent;\n\t\t\ts0 = Math.max( 0, - ( a01 * s1 + b0 ) );\n\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t}\n\n\t\tif ( optionalPointOnRay ) {\n\n\t\t\toptionalPointOnRay.copy( this.direction ).multiplyScalar( s0 ).add( this.origin );\n\n\t\t}\n\n\t\tif ( optionalPointOnSegment ) {\n\n\t\t\toptionalPointOnSegment.copy( _segDir ).multiplyScalar( s1 ).add( _segCenter );\n\n\t\t}\n\n\t\treturn sqrDist;\n\n\t}\n\n\tintersectSphere( sphere, target ) {\n\n\t\t_vector$a.subVectors( sphere.center, this.origin );\n\t\tconst tca = _vector$a.dot( this.direction );\n\t\tconst d2 = _vector$a.dot( _vector$a ) - tca * tca;\n\t\tconst radius2 = sphere.radius * sphere.radius;\n\n\t\tif ( d2 > radius2 ) return null;\n\n\t\tconst thc = Math.sqrt( radius2 - d2 );\n\n\t\t// t0 = first intersect point - entrance on front of sphere\n\t\tconst t0 = tca - thc;\n\n\t\t// t1 = second intersect point - exit point on back of sphere\n\t\tconst t1 = tca + thc;\n\n\t\t// test to see if both t0 and t1 are behind the ray - if so, return null\n\t\tif ( t0 < 0 && t1 < 0 ) return null;\n\n\t\t// test to see if t0 is behind the ray:\n\t\t// if it is, the ray is inside the sphere, so return the second exit point scaled by t1,\n\t\t// in order to always return an intersect point that is in front of the ray.\n\t\tif ( t0 < 0 ) return this.at( t1, target );\n\n\t\t// else t0 is in front of the ray, so return the first collision point scaled by t0\n\t\treturn this.at( t0, target );\n\n\t}\n\n\tintersectsSphere( sphere ) {\n\n\t\treturn this.distanceSqToPoint( sphere.center ) <= ( sphere.radius * sphere.radius );\n\n\t}\n\n\tdistanceToPlane( plane ) {\n\n\t\tconst denominator = plane.normal.dot( this.direction );\n\n\t\tif ( denominator === 0 ) {\n\n\t\t\t// line is coplanar, return origin\n\t\t\tif ( plane.distanceToPoint( this.origin ) === 0 ) {\n\n\t\t\t\treturn 0;\n\n\t\t\t}\n\n\t\t\t// Null is preferable to undefined since undefined means.... it is undefined\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst t = - ( this.origin.dot( plane.normal ) + plane.constant ) / denominator;\n\n\t\t// Return if the ray never intersects the plane\n\n\t\treturn t >= 0 ? t : null;\n\n\t}\n\n\tintersectPlane( plane, target ) {\n\n\t\tconst t = this.distanceToPlane( plane );\n\n\t\tif ( t === null ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\treturn this.at( t, target );\n\n\t}\n\n\tintersectsPlane( plane ) {\n\n\t\t// check if the ray lies on the plane first\n\n\t\tconst distToPoint = plane.distanceToPoint( this.origin );\n\n\t\tif ( distToPoint === 0 ) {\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\tconst denominator = plane.normal.dot( this.direction );\n\n\t\tif ( denominator * distToPoint < 0 ) {\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\t// ray origin is behind the plane (and is pointing behind it)\n\n\t\treturn false;\n\n\t}\n\n\tintersectBox( box, target ) {\n\n\t\tlet tmin, tmax, tymin, tymax, tzmin, tzmax;\n\n\t\tconst invdirx = 1 / this.direction.x,\n\t\t\tinvdiry = 1 / this.direction.y,\n\t\t\tinvdirz = 1 / this.direction.z;\n\n\t\tconst origin = this.origin;\n\n\t\tif ( invdirx >= 0 ) {\n\n\t\t\ttmin = ( box.min.x - origin.x ) * invdirx;\n\t\t\ttmax = ( box.max.x - origin.x ) * invdirx;\n\n\t\t} else {\n\n\t\t\ttmin = ( box.max.x - origin.x ) * invdirx;\n\t\t\ttmax = ( box.min.x - origin.x ) * invdirx;\n\n\t\t}\n\n\t\tif ( invdiry >= 0 ) {\n\n\t\t\ttymin = ( box.min.y - origin.y ) * invdiry;\n\t\t\ttymax = ( box.max.y - origin.y ) * invdiry;\n\n\t\t} else {\n\n\t\t\ttymin = ( box.max.y - origin.y ) * invdiry;\n\t\t\ttymax = ( box.min.y - origin.y ) * invdiry;\n\n\t\t}\n\n\t\tif ( ( tmin > tymax ) || ( tymin > tmax ) ) return null;\n\n\t\tif ( tymin > tmin || isNaN( tmin ) ) tmin = tymin;\n\n\t\tif ( tymax < tmax || isNaN( tmax ) ) tmax = tymax;\n\n\t\tif ( invdirz >= 0 ) {\n\n\t\t\ttzmin = ( box.min.z - origin.z ) * invdirz;\n\t\t\ttzmax = ( box.max.z - origin.z ) * invdirz;\n\n\t\t} else {\n\n\t\t\ttzmin = ( box.max.z - origin.z ) * invdirz;\n\t\t\ttzmax = ( box.min.z - origin.z ) * invdirz;\n\n\t\t}\n\n\t\tif ( ( tmin > tzmax ) || ( tzmin > tmax ) ) return null;\n\n\t\tif ( tzmin > tmin || tmin !== tmin ) tmin = tzmin;\n\n\t\tif ( tzmax < tmax || tmax !== tmax ) tmax = tzmax;\n\n\t\t//return point closest to the ray (positive side)\n\n\t\tif ( tmax < 0 ) return null;\n\n\t\treturn this.at( tmin >= 0 ? tmin : tmax, target );\n\n\t}\n\n\tintersectsBox( box ) {\n\n\t\treturn this.intersectBox( box, _vector$a ) !== null;\n\n\t}\n\n\tintersectTriangle( a, b, c, backfaceCulling, target ) {\n\n\t\t// Compute the offset origin, edges, and normal.\n\n\t\t// from https://github.com/pmjoniak/GeometricTools/blob/master/GTEngine/Include/Mathematics/GteIntrRay3Triangle3.h\n\n\t\t_edge1.subVectors( b, a );\n\t\t_edge2.subVectors( c, a );\n\t\t_normal$1.crossVectors( _edge1, _edge2 );\n\n\t\t// Solve Q + t*D = b1*E1 + b2*E2 (Q = kDiff, D = ray direction,\n\t\t// E1 = kEdge1, E2 = kEdge2, N = Cross(E1,E2)) by\n\t\t//   |Dot(D,N)|*b1 = sign(Dot(D,N))*Dot(D,Cross(Q,E2))\n\t\t//   |Dot(D,N)|*b2 = sign(Dot(D,N))*Dot(D,Cross(E1,Q))\n\t\t//   |Dot(D,N)|*t = -sign(Dot(D,N))*Dot(Q,N)\n\t\tlet DdN = this.direction.dot( _normal$1 );\n\t\tlet sign;\n\n\t\tif ( DdN > 0 ) {\n\n\t\t\tif ( backfaceCulling ) return null;\n\t\t\tsign = 1;\n\n\t\t} else if ( DdN < 0 ) {\n\n\t\t\tsign = - 1;\n\t\t\tDdN = - DdN;\n\n\t\t} else {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\t_diff.subVectors( this.origin, a );\n\t\tconst DdQxE2 = sign * this.direction.dot( _edge2.crossVectors( _diff, _edge2 ) );\n\n\t\t// b1 < 0, no intersection\n\t\tif ( DdQxE2 < 0 ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst DdE1xQ = sign * this.direction.dot( _edge1.cross( _diff ) );\n\n\t\t// b2 < 0, no intersection\n\t\tif ( DdE1xQ < 0 ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\t// b1+b2 > 1, no intersection\n\t\tif ( DdQxE2 + DdE1xQ > DdN ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\t// Line intersects triangle, check if ray does.\n\t\tconst QdN = - sign * _diff.dot( _normal$1 );\n\n\t\t// t < 0, no intersection\n\t\tif ( QdN < 0 ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\t// Ray intersects triangle.\n\t\treturn this.at( QdN / DdN, target );\n\n\t}\n\n\tapplyMatrix4( matrix4 ) {\n\n\t\tthis.origin.applyMatrix4( matrix4 );\n\t\tthis.direction.transformDirection( matrix4 );\n\n\t\treturn this;\n\n\t}\n\n\tequals( ray ) {\n\n\t\treturn ray.origin.equals( this.origin ) && ray.direction.equals( this.direction );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n}\n\nclass Matrix4 {\n\n\tconstructor() {\n\n\t\tMatrix4.prototype.isMatrix4 = true;\n\n\t\tthis.elements = [\n\n\t\t\t1, 0, 0, 0,\n\t\t\t0, 1, 0, 0,\n\t\t\t0, 0, 1, 0,\n\t\t\t0, 0, 0, 1\n\n\t\t];\n\n\t}\n\n\tset( n11, n12, n13, n14, n21, n22, n23, n24, n31, n32, n33, n34, n41, n42, n43, n44 ) {\n\n\t\tconst te = this.elements;\n\n\t\tte[ 0 ] = n11; te[ 4 ] = n12; te[ 8 ] = n13; te[ 12 ] = n14;\n\t\tte[ 1 ] = n21; te[ 5 ] = n22; te[ 9 ] = n23; te[ 13 ] = n24;\n\t\tte[ 2 ] = n31; te[ 6 ] = n32; te[ 10 ] = n33; te[ 14 ] = n34;\n\t\tte[ 3 ] = n41; te[ 7 ] = n42; te[ 11 ] = n43; te[ 15 ] = n44;\n\n\t\treturn this;\n\n\t}\n\n\tidentity() {\n\n\t\tthis.set(\n\n\t\t\t1, 0, 0, 0,\n\t\t\t0, 1, 0, 0,\n\t\t\t0, 0, 1, 0,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new Matrix4().fromArray( this.elements );\n\n\t}\n\n\tcopy( m ) {\n\n\t\tconst te = this.elements;\n\t\tconst me = m.elements;\n\n\t\tte[ 0 ] = me[ 0 ]; te[ 1 ] = me[ 1 ]; te[ 2 ] = me[ 2 ]; te[ 3 ] = me[ 3 ];\n\t\tte[ 4 ] = me[ 4 ]; te[ 5 ] = me[ 5 ]; te[ 6 ] = me[ 6 ]; te[ 7 ] = me[ 7 ];\n\t\tte[ 8 ] = me[ 8 ]; te[ 9 ] = me[ 9 ]; te[ 10 ] = me[ 10 ]; te[ 11 ] = me[ 11 ];\n\t\tte[ 12 ] = me[ 12 ]; te[ 13 ] = me[ 13 ]; te[ 14 ] = me[ 14 ]; te[ 15 ] = me[ 15 ];\n\n\t\treturn this;\n\n\t}\n\n\tcopyPosition( m ) {\n\n\t\tconst te = this.elements, me = m.elements;\n\n\t\tte[ 12 ] = me[ 12 ];\n\t\tte[ 13 ] = me[ 13 ];\n\t\tte[ 14 ] = me[ 14 ];\n\n\t\treturn this;\n\n\t}\n\n\tsetFromMatrix3( m ) {\n\n\t\tconst me = m.elements;\n\n\t\tthis.set(\n\n\t\t\tme[ 0 ], me[ 3 ], me[ 6 ], 0,\n\t\t\tme[ 1 ], me[ 4 ], me[ 7 ], 0,\n\t\t\tme[ 2 ], me[ 5 ], me[ 8 ], 0,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\textractBasis( xAxis, yAxis, zAxis ) {\n\n\t\txAxis.setFromMatrixColumn( this, 0 );\n\t\tyAxis.setFromMatrixColumn( this, 1 );\n\t\tzAxis.setFromMatrixColumn( this, 2 );\n\n\t\treturn this;\n\n\t}\n\n\tmakeBasis( xAxis, yAxis, zAxis ) {\n\n\t\tthis.set(\n\t\t\txAxis.x, yAxis.x, zAxis.x, 0,\n\t\t\txAxis.y, yAxis.y, zAxis.y, 0,\n\t\t\txAxis.z, yAxis.z, zAxis.z, 0,\n\t\t\t0, 0, 0, 1\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\textractRotation( m ) {\n\n\t\t// this method does not support reflection matrices\n\n\t\tconst te = this.elements;\n\t\tconst me = m.elements;\n\n\t\tconst scaleX = 1 / _v1$5.setFromMatrixColumn( m, 0 ).length();\n\t\tconst scaleY = 1 / _v1$5.setFromMatrixColumn( m, 1 ).length();\n\t\tconst scaleZ = 1 / _v1$5.setFromMatrixColumn( m, 2 ).length();\n\n\t\tte[ 0 ] = me[ 0 ] * scaleX;\n\t\tte[ 1 ] = me[ 1 ] * scaleX;\n\t\tte[ 2 ] = me[ 2 ] * scaleX;\n\t\tte[ 3 ] = 0;\n\n\t\tte[ 4 ] = me[ 4 ] * scaleY;\n\t\tte[ 5 ] = me[ 5 ] * scaleY;\n\t\tte[ 6 ] = me[ 6 ] * scaleY;\n\t\tte[ 7 ] = 0;\n\n\t\tte[ 8 ] = me[ 8 ] * scaleZ;\n\t\tte[ 9 ] = me[ 9 ] * scaleZ;\n\t\tte[ 10 ] = me[ 10 ] * scaleZ;\n\t\tte[ 11 ] = 0;\n\n\t\tte[ 12 ] = 0;\n\t\tte[ 13 ] = 0;\n\t\tte[ 14 ] = 0;\n\t\tte[ 15 ] = 1;\n\n\t\treturn this;\n\n\t}\n\n\tmakeRotationFromEuler( euler ) {\n\n\t\tconst te = this.elements;\n\n\t\tconst x = euler.x, y = euler.y, z = euler.z;\n\t\tconst a = Math.cos( x ), b = Math.sin( x );\n\t\tconst c = Math.cos( y ), d = Math.sin( y );\n\t\tconst e = Math.cos( z ), f = Math.sin( z );\n\n\t\tif ( euler.order === 'XYZ' ) {\n\n\t\t\tconst ae = a * e, af = a * f, be = b * e, bf = b * f;\n\n\t\t\tte[ 0 ] = c * e;\n\t\t\tte[ 4 ] = - c * f;\n\t\t\tte[ 8 ] = d;\n\n\t\t\tte[ 1 ] = af + be * d;\n\t\t\tte[ 5 ] = ae - bf * d;\n\t\t\tte[ 9 ] = - b * c;\n\n\t\t\tte[ 2 ] = bf - ae * d;\n\t\t\tte[ 6 ] = be + af * d;\n\t\t\tte[ 10 ] = a * c;\n\n\t\t} else if ( euler.order === 'YXZ' ) {\n\n\t\t\tconst ce = c * e, cf = c * f, de = d * e, df = d * f;\n\n\t\t\tte[ 0 ] = ce + df * b;\n\t\t\tte[ 4 ] = de * b - cf;\n\t\t\tte[ 8 ] = a * d;\n\n\t\t\tte[ 1 ] = a * f;\n\t\t\tte[ 5 ] = a * e;\n\t\t\tte[ 9 ] = - b;\n\n\t\t\tte[ 2 ] = cf * b - de;\n\t\t\tte[ 6 ] = df + ce * b;\n\t\t\tte[ 10 ] = a * c;\n\n\t\t} else if ( euler.order === 'ZXY' ) {\n\n\t\t\tconst ce = c * e, cf = c * f, de = d * e, df = d * f;\n\n\t\t\tte[ 0 ] = ce - df * b;\n\t\t\tte[ 4 ] = - a * f;\n\t\t\tte[ 8 ] = de + cf * b;\n\n\t\t\tte[ 1 ] = cf + de * b;\n\t\t\tte[ 5 ] = a * e;\n\t\t\tte[ 9 ] = df - ce * b;\n\n\t\t\tte[ 2 ] = - a * d;\n\t\t\tte[ 6 ] = b;\n\t\t\tte[ 10 ] = a * c;\n\n\t\t} else if ( euler.order === 'ZYX' ) {\n\n\t\t\tconst ae = a * e, af = a * f, be = b * e, bf = b * f;\n\n\t\t\tte[ 0 ] = c * e;\n\t\t\tte[ 4 ] = be * d - af;\n\t\t\tte[ 8 ] = ae * d + bf;\n\n\t\t\tte[ 1 ] = c * f;\n\t\t\tte[ 5 ] = bf * d + ae;\n\t\t\tte[ 9 ] = af * d - be;\n\n\t\t\tte[ 2 ] = - d;\n\t\t\tte[ 6 ] = b * c;\n\t\t\tte[ 10 ] = a * c;\n\n\t\t} else if ( euler.order === 'YZX' ) {\n\n\t\t\tconst ac = a * c, ad = a * d, bc = b * c, bd = b * d;\n\n\t\t\tte[ 0 ] = c * e;\n\t\t\tte[ 4 ] = bd - ac * f;\n\t\t\tte[ 8 ] = bc * f + ad;\n\n\t\t\tte[ 1 ] = f;\n\t\t\tte[ 5 ] = a * e;\n\t\t\tte[ 9 ] = - b * e;\n\n\t\t\tte[ 2 ] = - d * e;\n\t\t\tte[ 6 ] = ad * f + bc;\n\t\t\tte[ 10 ] = ac - bd * f;\n\n\t\t} else if ( euler.order === 'XZY' ) {\n\n\t\t\tconst ac = a * c, ad = a * d, bc = b * c, bd = b * d;\n\n\t\t\tte[ 0 ] = c * e;\n\t\t\tte[ 4 ] = - f;\n\t\t\tte[ 8 ] = d * e;\n\n\t\t\tte[ 1 ] = ac * f + bd;\n\t\t\tte[ 5 ] = a * e;\n\t\t\tte[ 9 ] = ad * f - bc;\n\n\t\t\tte[ 2 ] = bc * f - ad;\n\t\t\tte[ 6 ] = b * e;\n\t\t\tte[ 10 ] = bd * f + ac;\n\n\t\t}\n\n\t\t// bottom row\n\t\tte[ 3 ] = 0;\n\t\tte[ 7 ] = 0;\n\t\tte[ 11 ] = 0;\n\n\t\t// last column\n\t\tte[ 12 ] = 0;\n\t\tte[ 13 ] = 0;\n\t\tte[ 14 ] = 0;\n\t\tte[ 15 ] = 1;\n\n\t\treturn this;\n\n\t}\n\n\tmakeRotationFromQuaternion( q ) {\n\n\t\treturn this.compose( _zero, q, _one );\n\n\t}\n\n\tlookAt( eye, target, up ) {\n\n\t\tconst te = this.elements;\n\n\t\t_z.subVectors( eye, target );\n\n\t\tif ( _z.lengthSq() === 0 ) {\n\n\t\t\t// eye and target are in the same position\n\n\t\t\t_z.z = 1;\n\n\t\t}\n\n\t\t_z.normalize();\n\t\t_x.crossVectors( up, _z );\n\n\t\tif ( _x.lengthSq() === 0 ) {\n\n\t\t\t// up and z are parallel\n\n\t\t\tif ( Math.abs( up.z ) === 1 ) {\n\n\t\t\t\t_z.x += 0.0001;\n\n\t\t\t} else {\n\n\t\t\t\t_z.z += 0.0001;\n\n\t\t\t}\n\n\t\t\t_z.normalize();\n\t\t\t_x.crossVectors( up, _z );\n\n\t\t}\n\n\t\t_x.normalize();\n\t\t_y.crossVectors( _z, _x );\n\n\t\tte[ 0 ] = _x.x; te[ 4 ] = _y.x; te[ 8 ] = _z.x;\n\t\tte[ 1 ] = _x.y; te[ 5 ] = _y.y; te[ 9 ] = _z.y;\n\t\tte[ 2 ] = _x.z; te[ 6 ] = _y.z; te[ 10 ] = _z.z;\n\n\t\treturn this;\n\n\t}\n\n\tmultiply( m ) {\n\n\t\treturn this.multiplyMatrices( this, m );\n\n\t}\n\n\tpremultiply( m ) {\n\n\t\treturn this.multiplyMatrices( m, this );\n\n\t}\n\n\tmultiplyMatrices( a, b ) {\n\n\t\tconst ae = a.elements;\n\t\tconst be = b.elements;\n\t\tconst te = this.elements;\n\n\t\tconst a11 = ae[ 0 ], a12 = ae[ 4 ], a13 = ae[ 8 ], a14 = ae[ 12 ];\n\t\tconst a21 = ae[ 1 ], a22 = ae[ 5 ], a23 = ae[ 9 ], a24 = ae[ 13 ];\n\t\tconst a31 = ae[ 2 ], a32 = ae[ 6 ], a33 = ae[ 10 ], a34 = ae[ 14 ];\n\t\tconst a41 = ae[ 3 ], a42 = ae[ 7 ], a43 = ae[ 11 ], a44 = ae[ 15 ];\n\n\t\tconst b11 = be[ 0 ], b12 = be[ 4 ], b13 = be[ 8 ], b14 = be[ 12 ];\n\t\tconst b21 = be[ 1 ], b22 = be[ 5 ], b23 = be[ 9 ], b24 = be[ 13 ];\n\t\tconst b31 = be[ 2 ], b32 = be[ 6 ], b33 = be[ 10 ], b34 = be[ 14 ];\n\t\tconst b41 = be[ 3 ], b42 = be[ 7 ], b43 = be[ 11 ], b44 = be[ 15 ];\n\n\t\tte[ 0 ] = a11 * b11 + a12 * b21 + a13 * b31 + a14 * b41;\n\t\tte[ 4 ] = a11 * b12 + a12 * b22 + a13 * b32 + a14 * b42;\n\t\tte[ 8 ] = a11 * b13 + a12 * b23 + a13 * b33 + a14 * b43;\n\t\tte[ 12 ] = a11 * b14 + a12 * b24 + a13 * b34 + a14 * b44;\n\n\t\tte[ 1 ] = a21 * b11 + a22 * b21 + a23 * b31 + a24 * b41;\n\t\tte[ 5 ] = a21 * b12 + a22 * b22 + a23 * b32 + a24 * b42;\n\t\tte[ 9 ] = a21 * b13 + a22 * b23 + a23 * b33 + a24 * b43;\n\t\tte[ 13 ] = a21 * b14 + a22 * b24 + a23 * b34 + a24 * b44;\n\n\t\tte[ 2 ] = a31 * b11 + a32 * b21 + a33 * b31 + a34 * b41;\n\t\tte[ 6 ] = a31 * b12 + a32 * b22 + a33 * b32 + a34 * b42;\n\t\tte[ 10 ] = a31 * b13 + a32 * b23 + a33 * b33 + a34 * b43;\n\t\tte[ 14 ] = a31 * b14 + a32 * b24 + a33 * b34 + a34 * b44;\n\n\t\tte[ 3 ] = a41 * b11 + a42 * b21 + a43 * b31 + a44 * b41;\n\t\tte[ 7 ] = a41 * b12 + a42 * b22 + a43 * b32 + a44 * b42;\n\t\tte[ 11 ] = a41 * b13 + a42 * b23 + a43 * b33 + a44 * b43;\n\t\tte[ 15 ] = a41 * b14 + a42 * b24 + a43 * b34 + a44 * b44;\n\n\t\treturn this;\n\n\t}\n\n\tmultiplyScalar( s ) {\n\n\t\tconst te = this.elements;\n\n\t\tte[ 0 ] *= s; te[ 4 ] *= s; te[ 8 ] *= s; te[ 12 ] *= s;\n\t\tte[ 1 ] *= s; te[ 5 ] *= s; te[ 9 ] *= s; te[ 13 ] *= s;\n\t\tte[ 2 ] *= s; te[ 6 ] *= s; te[ 10 ] *= s; te[ 14 ] *= s;\n\t\tte[ 3 ] *= s; te[ 7 ] *= s; te[ 11 ] *= s; te[ 15 ] *= s;\n\n\t\treturn this;\n\n\t}\n\n\tdeterminant() {\n\n\t\tconst te = this.elements;\n\n\t\tconst n11 = te[ 0 ], n12 = te[ 4 ], n13 = te[ 8 ], n14 = te[ 12 ];\n\t\tconst n21 = te[ 1 ], n22 = te[ 5 ], n23 = te[ 9 ], n24 = te[ 13 ];\n\t\tconst n31 = te[ 2 ], n32 = te[ 6 ], n33 = te[ 10 ], n34 = te[ 14 ];\n\t\tconst n41 = te[ 3 ], n42 = te[ 7 ], n43 = te[ 11 ], n44 = te[ 15 ];\n\n\t\t//TODO: make this more efficient\n\t\t//( based on http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm )\n\n\t\treturn (\n\t\t\tn41 * (\n\t\t\t\t+ n14 * n23 * n32\n\t\t\t\t - n13 * n24 * n32\n\t\t\t\t - n14 * n22 * n33\n\t\t\t\t + n12 * n24 * n33\n\t\t\t\t + n13 * n22 * n34\n\t\t\t\t - n12 * n23 * n34\n\t\t\t) +\n\t\t\tn42 * (\n\t\t\t\t+ n11 * n23 * n34\n\t\t\t\t - n11 * n24 * n33\n\t\t\t\t + n14 * n21 * n33\n\t\t\t\t - n13 * n21 * n34\n\t\t\t\t + n13 * n24 * n31\n\t\t\t\t - n14 * n23 * n31\n\t\t\t) +\n\t\t\tn43 * (\n\t\t\t\t+ n11 * n24 * n32\n\t\t\t\t - n11 * n22 * n34\n\t\t\t\t - n14 * n21 * n32\n\t\t\t\t + n12 * n21 * n34\n\t\t\t\t + n14 * n22 * n31\n\t\t\t\t - n12 * n24 * n31\n\t\t\t) +\n\t\t\tn44 * (\n\t\t\t\t- n13 * n22 * n31\n\t\t\t\t - n11 * n23 * n32\n\t\t\t\t + n11 * n22 * n33\n\t\t\t\t + n13 * n21 * n32\n\t\t\t\t - n12 * n21 * n33\n\t\t\t\t + n12 * n23 * n31\n\t\t\t)\n\n\t\t);\n\n\t}\n\n\ttranspose() {\n\n\t\tconst te = this.elements;\n\t\tlet tmp;\n\n\t\ttmp = te[ 1 ]; te[ 1 ] = te[ 4 ]; te[ 4 ] = tmp;\n\t\ttmp = te[ 2 ]; te[ 2 ] = te[ 8 ]; te[ 8 ] = tmp;\n\t\ttmp = te[ 6 ]; te[ 6 ] = te[ 9 ]; te[ 9 ] = tmp;\n\n\t\ttmp = te[ 3 ]; te[ 3 ] = te[ 12 ]; te[ 12 ] = tmp;\n\t\ttmp = te[ 7 ]; te[ 7 ] = te[ 13 ]; te[ 13 ] = tmp;\n\t\ttmp = te[ 11 ]; te[ 11 ] = te[ 14 ]; te[ 14 ] = tmp;\n\n\t\treturn this;\n\n\t}\n\n\tsetPosition( x, y, z ) {\n\n\t\tconst te = this.elements;\n\n\t\tif ( x.isVector3 ) {\n\n\t\t\tte[ 12 ] = x.x;\n\t\t\tte[ 13 ] = x.y;\n\t\t\tte[ 14 ] = x.z;\n\n\t\t} else {\n\n\t\t\tte[ 12 ] = x;\n\t\t\tte[ 13 ] = y;\n\t\t\tte[ 14 ] = z;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tinvert() {\n\n\t\t// based on http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm\n\t\tconst te = this.elements,\n\n\t\t\tn11 = te[ 0 ], n21 = te[ 1 ], n31 = te[ 2 ], n41 = te[ 3 ],\n\t\t\tn12 = te[ 4 ], n22 = te[ 5 ], n32 = te[ 6 ], n42 = te[ 7 ],\n\t\t\tn13 = te[ 8 ], n23 = te[ 9 ], n33 = te[ 10 ], n43 = te[ 11 ],\n\t\t\tn14 = te[ 12 ], n24 = te[ 13 ], n34 = te[ 14 ], n44 = te[ 15 ],\n\n\t\t\tt11 = n23 * n34 * n42 - n24 * n33 * n42 + n24 * n32 * n43 - n22 * n34 * n43 - n23 * n32 * n44 + n22 * n33 * n44,\n\t\t\tt12 = n14 * n33 * n42 - n13 * n34 * n42 - n14 * n32 * n43 + n12 * n34 * n43 + n13 * n32 * n44 - n12 * n33 * n44,\n\t\t\tt13 = n13 * n24 * n42 - n14 * n23 * n42 + n14 * n22 * n43 - n12 * n24 * n43 - n13 * n22 * n44 + n12 * n23 * n44,\n\t\t\tt14 = n14 * n23 * n32 - n13 * n24 * n32 - n14 * n22 * n33 + n12 * n24 * n33 + n13 * n22 * n34 - n12 * n23 * n34;\n\n\t\tconst det = n11 * t11 + n21 * t12 + n31 * t13 + n41 * t14;\n\n\t\tif ( det === 0 ) return this.set( 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 );\n\n\t\tconst detInv = 1 / det;\n\n\t\tte[ 0 ] = t11 * detInv;\n\t\tte[ 1 ] = ( n24 * n33 * n41 - n23 * n34 * n41 - n24 * n31 * n43 + n21 * n34 * n43 + n23 * n31 * n44 - n21 * n33 * n44 ) * detInv;\n\t\tte[ 2 ] = ( n22 * n34 * n41 - n24 * n32 * n41 + n24 * n31 * n42 - n21 * n34 * n42 - n22 * n31 * n44 + n21 * n32 * n44 ) * detInv;\n\t\tte[ 3 ] = ( n23 * n32 * n41 - n22 * n33 * n41 - n23 * n31 * n42 + n21 * n33 * n42 + n22 * n31 * n43 - n21 * n32 * n43 ) * detInv;\n\n\t\tte[ 4 ] = t12 * detInv;\n\t\tte[ 5 ] = ( n13 * n34 * n41 - n14 * n33 * n41 + n14 * n31 * n43 - n11 * n34 * n43 - n13 * n31 * n44 + n11 * n33 * n44 ) * detInv;\n\t\tte[ 6 ] = ( n14 * n32 * n41 - n12 * n34 * n41 - n14 * n31 * n42 + n11 * n34 * n42 + n12 * n31 * n44 - n11 * n32 * n44 ) * detInv;\n\t\tte[ 7 ] = ( n12 * n33 * n41 - n13 * n32 * n41 + n13 * n31 * n42 - n11 * n33 * n42 - n12 * n31 * n43 + n11 * n32 * n43 ) * detInv;\n\n\t\tte[ 8 ] = t13 * detInv;\n\t\tte[ 9 ] = ( n14 * n23 * n41 - n13 * n24 * n41 - n14 * n21 * n43 + n11 * n24 * n43 + n13 * n21 * n44 - n11 * n23 * n44 ) * detInv;\n\t\tte[ 10 ] = ( n12 * n24 * n41 - n14 * n22 * n41 + n14 * n21 * n42 - n11 * n24 * n42 - n12 * n21 * n44 + n11 * n22 * n44 ) * detInv;\n\t\tte[ 11 ] = ( n13 * n22 * n41 - n12 * n23 * n41 - n13 * n21 * n42 + n11 * n23 * n42 + n12 * n21 * n43 - n11 * n22 * n43 ) * detInv;\n\n\t\tte[ 12 ] = t14 * detInv;\n\t\tte[ 13 ] = ( n13 * n24 * n31 - n14 * n23 * n31 + n14 * n21 * n33 - n11 * n24 * n33 - n13 * n21 * n34 + n11 * n23 * n34 ) * detInv;\n\t\tte[ 14 ] = ( n14 * n22 * n31 - n12 * n24 * n31 - n14 * n21 * n32 + n11 * n24 * n32 + n12 * n21 * n34 - n11 * n22 * n34 ) * detInv;\n\t\tte[ 15 ] = ( n12 * n23 * n31 - n13 * n22 * n31 + n13 * n21 * n32 - n11 * n23 * n32 - n12 * n21 * n33 + n11 * n22 * n33 ) * detInv;\n\n\t\treturn this;\n\n\t}\n\n\tscale( v ) {\n\n\t\tconst te = this.elements;\n\t\tconst x = v.x, y = v.y, z = v.z;\n\n\t\tte[ 0 ] *= x; te[ 4 ] *= y; te[ 8 ] *= z;\n\t\tte[ 1 ] *= x; te[ 5 ] *= y; te[ 9 ] *= z;\n\t\tte[ 2 ] *= x; te[ 6 ] *= y; te[ 10 ] *= z;\n\t\tte[ 3 ] *= x; te[ 7 ] *= y; te[ 11 ] *= z;\n\n\t\treturn this;\n\n\t}\n\n\tgetMaxScaleOnAxis() {\n\n\t\tconst te = this.elements;\n\n\t\tconst scaleXSq = te[ 0 ] * te[ 0 ] + te[ 1 ] * te[ 1 ] + te[ 2 ] * te[ 2 ];\n\t\tconst scaleYSq = te[ 4 ] * te[ 4 ] + te[ 5 ] * te[ 5 ] + te[ 6 ] * te[ 6 ];\n\t\tconst scaleZSq = te[ 8 ] * te[ 8 ] + te[ 9 ] * te[ 9 ] + te[ 10 ] * te[ 10 ];\n\n\t\treturn Math.sqrt( Math.max( scaleXSq, scaleYSq, scaleZSq ) );\n\n\t}\n\n\tmakeTranslation( x, y, z ) {\n\n\t\tthis.set(\n\n\t\t\t1, 0, 0, x,\n\t\t\t0, 1, 0, y,\n\t\t\t0, 0, 1, z,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tmakeRotationX( theta ) {\n\n\t\tconst c = Math.cos( theta ), s = Math.sin( theta );\n\n\t\tthis.set(\n\n\t\t\t1, 0, 0, 0,\n\t\t\t0, c, - s, 0,\n\t\t\t0, s, c, 0,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tmakeRotationY( theta ) {\n\n\t\tconst c = Math.cos( theta ), s = Math.sin( theta );\n\n\t\tthis.set(\n\n\t\t\t c, 0, s, 0,\n\t\t\t 0, 1, 0, 0,\n\t\t\t- s, 0, c, 0,\n\t\t\t 0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tmakeRotationZ( theta ) {\n\n\t\tconst c = Math.cos( theta ), s = Math.sin( theta );\n\n\t\tthis.set(\n\n\t\t\tc, - s, 0, 0,\n\t\t\ts, c, 0, 0,\n\t\t\t0, 0, 1, 0,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tmakeRotationAxis( axis, angle ) {\n\n\t\t// Based on http://www.gamedev.net/reference/articles/article1199.asp\n\n\t\tconst c = Math.cos( angle );\n\t\tconst s = Math.sin( angle );\n\t\tconst t = 1 - c;\n\t\tconst x = axis.x, y = axis.y, z = axis.z;\n\t\tconst tx = t * x, ty = t * y;\n\n\t\tthis.set(\n\n\t\t\ttx * x + c, tx * y - s * z, tx * z + s * y, 0,\n\t\t\ttx * y + s * z, ty * y + c, ty * z - s * x, 0,\n\t\t\ttx * z - s * y, ty * z + s * x, t * z * z + c, 0,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tmakeScale( x, y, z ) {\n\n\t\tthis.set(\n\n\t\t\tx, 0, 0, 0,\n\t\t\t0, y, 0, 0,\n\t\t\t0, 0, z, 0,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tmakeShear( xy, xz, yx, yz, zx, zy ) {\n\n\t\tthis.set(\n\n\t\t\t1, yx, zx, 0,\n\t\t\txy, 1, zy, 0,\n\t\t\txz, yz, 1, 0,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tcompose( position, quaternion, scale ) {\n\n\t\tconst te = this.elements;\n\n\t\tconst x = quaternion._x, y = quaternion._y, z = quaternion._z, w = quaternion._w;\n\t\tconst x2 = x + x,\ty2 = y + y, z2 = z + z;\n\t\tconst xx = x * x2, xy = x * y2, xz = x * z2;\n\t\tconst yy = y * y2, yz = y * z2, zz = z * z2;\n\t\tconst wx = w * x2, wy = w * y2, wz = w * z2;\n\n\t\tconst sx = scale.x, sy = scale.y, sz = scale.z;\n\n\t\tte[ 0 ] = ( 1 - ( yy + zz ) ) * sx;\n\t\tte[ 1 ] = ( xy + wz ) * sx;\n\t\tte[ 2 ] = ( xz - wy ) * sx;\n\t\tte[ 3 ] = 0;\n\n\t\tte[ 4 ] = ( xy - wz ) * sy;\n\t\tte[ 5 ] = ( 1 - ( xx + zz ) ) * sy;\n\t\tte[ 6 ] = ( yz + wx ) * sy;\n\t\tte[ 7 ] = 0;\n\n\t\tte[ 8 ] = ( xz + wy ) * sz;\n\t\tte[ 9 ] = ( yz - wx ) * sz;\n\t\tte[ 10 ] = ( 1 - ( xx + yy ) ) * sz;\n\t\tte[ 11 ] = 0;\n\n\t\tte[ 12 ] = position.x;\n\t\tte[ 13 ] = position.y;\n\t\tte[ 14 ] = position.z;\n\t\tte[ 15 ] = 1;\n\n\t\treturn this;\n\n\t}\n\n\tdecompose( position, quaternion, scale ) {\n\n\t\tconst te = this.elements;\n\n\t\tlet sx = _v1$5.set( te[ 0 ], te[ 1 ], te[ 2 ] ).length();\n\t\tconst sy = _v1$5.set( te[ 4 ], te[ 5 ], te[ 6 ] ).length();\n\t\tconst sz = _v1$5.set( te[ 8 ], te[ 9 ], te[ 10 ] ).length();\n\n\t\t// if determine is negative, we need to invert one scale\n\t\tconst det = this.determinant();\n\t\tif ( det < 0 ) sx = - sx;\n\n\t\tposition.x = te[ 12 ];\n\t\tposition.y = te[ 13 ];\n\t\tposition.z = te[ 14 ];\n\n\t\t// scale the rotation part\n\t\t_m1$2.copy( this );\n\n\t\tconst invSX = 1 / sx;\n\t\tconst invSY = 1 / sy;\n\t\tconst invSZ = 1 / sz;\n\n\t\t_m1$2.elements[ 0 ] *= invSX;\n\t\t_m1$2.elements[ 1 ] *= invSX;\n\t\t_m1$2.elements[ 2 ] *= invSX;\n\n\t\t_m1$2.elements[ 4 ] *= invSY;\n\t\t_m1$2.elements[ 5 ] *= invSY;\n\t\t_m1$2.elements[ 6 ] *= invSY;\n\n\t\t_m1$2.elements[ 8 ] *= invSZ;\n\t\t_m1$2.elements[ 9 ] *= invSZ;\n\t\t_m1$2.elements[ 10 ] *= invSZ;\n\n\t\tquaternion.setFromRotationMatrix( _m1$2 );\n\n\t\tscale.x = sx;\n\t\tscale.y = sy;\n\t\tscale.z = sz;\n\n\t\treturn this;\n\n\t}\n\n\tmakePerspective( left, right, top, bottom, near, far ) {\n\n\t\tconst te = this.elements;\n\t\tconst x = 2 * near / ( right - left );\n\t\tconst y = 2 * near / ( top - bottom );\n\n\t\tconst a = ( right + left ) / ( right - left );\n\t\tconst b = ( top + bottom ) / ( top - bottom );\n\t\tconst c = - ( far + near ) / ( far - near );\n\t\tconst d = - 2 * far * near / ( far - near );\n\n\t\tte[ 0 ] = x;\tte[ 4 ] = 0;\tte[ 8 ] = a;\tte[ 12 ] = 0;\n\t\tte[ 1 ] = 0;\tte[ 5 ] = y;\tte[ 9 ] = b;\tte[ 13 ] = 0;\n\t\tte[ 2 ] = 0;\tte[ 6 ] = 0;\tte[ 10 ] = c;\tte[ 14 ] = d;\n\t\tte[ 3 ] = 0;\tte[ 7 ] = 0;\tte[ 11 ] = - 1;\tte[ 15 ] = 0;\n\n\t\treturn this;\n\n\t}\n\n\tmakeOrthographic( left, right, top, bottom, near, far ) {\n\n\t\tconst te = this.elements;\n\t\tconst w = 1.0 / ( right - left );\n\t\tconst h = 1.0 / ( top - bottom );\n\t\tconst p = 1.0 / ( far - near );\n\n\t\tconst x = ( right + left ) * w;\n\t\tconst y = ( top + bottom ) * h;\n\t\tconst z = ( far + near ) * p;\n\n\t\tte[ 0 ] = 2 * w;\tte[ 4 ] = 0;\tte[ 8 ] = 0;\tte[ 12 ] = - x;\n\t\tte[ 1 ] = 0;\tte[ 5 ] = 2 * h;\tte[ 9 ] = 0;\tte[ 13 ] = - y;\n\t\tte[ 2 ] = 0;\tte[ 6 ] = 0;\tte[ 10 ] = - 2 * p;\tte[ 14 ] = - z;\n\t\tte[ 3 ] = 0;\tte[ 7 ] = 0;\tte[ 11 ] = 0;\tte[ 15 ] = 1;\n\n\t\treturn this;\n\n\t}\n\n\tequals( matrix ) {\n\n\t\tconst te = this.elements;\n\t\tconst me = matrix.elements;\n\n\t\tfor ( let i = 0; i < 16; i ++ ) {\n\n\t\t\tif ( te[ i ] !== me[ i ] ) return false;\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tfor ( let i = 0; i < 16; i ++ ) {\n\n\t\t\tthis.elements[ i ] = array[ i + offset ];\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tconst te = this.elements;\n\n\t\tarray[ offset ] = te[ 0 ];\n\t\tarray[ offset + 1 ] = te[ 1 ];\n\t\tarray[ offset + 2 ] = te[ 2 ];\n\t\tarray[ offset + 3 ] = te[ 3 ];\n\n\t\tarray[ offset + 4 ] = te[ 4 ];\n\t\tarray[ offset + 5 ] = te[ 5 ];\n\t\tarray[ offset + 6 ] = te[ 6 ];\n\t\tarray[ offset + 7 ] = te[ 7 ];\n\n\t\tarray[ offset + 8 ] = te[ 8 ];\n\t\tarray[ offset + 9 ] = te[ 9 ];\n\t\tarray[ offset + 10 ] = te[ 10 ];\n\t\tarray[ offset + 11 ] = te[ 11 ];\n\n\t\tarray[ offset + 12 ] = te[ 12 ];\n\t\tarray[ offset + 13 ] = te[ 13 ];\n\t\tarray[ offset + 14 ] = te[ 14 ];\n\t\tarray[ offset + 15 ] = te[ 15 ];\n\n\t\treturn array;\n\n\t}\n\n}\n\nconst _v1$5 = /*@__PURE__*/ new Vector3();\nconst _m1$2 = /*@__PURE__*/ new Matrix4();\nconst _zero = /*@__PURE__*/ new Vector3( 0, 0, 0 );\nconst _one = /*@__PURE__*/ new Vector3( 1, 1, 1 );\nconst _x = /*@__PURE__*/ new Vector3();\nconst _y = /*@__PURE__*/ new Vector3();\nconst _z = /*@__PURE__*/ new Vector3();\n\nconst _matrix$1 = /*@__PURE__*/ new Matrix4();\nconst _quaternion$3 = /*@__PURE__*/ new Quaternion();\n\nclass Euler {\n\n\tconstructor( x = 0, y = 0, z = 0, order = Euler.DefaultOrder ) {\n\n\t\tthis.isEuler = true;\n\n\t\tthis._x = x;\n\t\tthis._y = y;\n\t\tthis._z = z;\n\t\tthis._order = order;\n\n\t}\n\n\tget x() {\n\n\t\treturn this._x;\n\n\t}\n\n\tset x( value ) {\n\n\t\tthis._x = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tget y() {\n\n\t\treturn this._y;\n\n\t}\n\n\tset y( value ) {\n\n\t\tthis._y = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tget z() {\n\n\t\treturn this._z;\n\n\t}\n\n\tset z( value ) {\n\n\t\tthis._z = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tget order() {\n\n\t\treturn this._order;\n\n\t}\n\n\tset order( value ) {\n\n\t\tthis._order = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tset( x, y, z, order = this._order ) {\n\n\t\tthis._x = x;\n\t\tthis._y = y;\n\t\tthis._z = z;\n\t\tthis._order = order;\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this._x, this._y, this._z, this._order );\n\n\t}\n\n\tcopy( euler ) {\n\n\t\tthis._x = euler._x;\n\t\tthis._y = euler._y;\n\t\tthis._z = euler._z;\n\t\tthis._order = euler._order;\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tsetFromRotationMatrix( m, order = this._order, update = true ) {\n\n\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\n\n\t\tconst te = m.elements;\n\t\tconst m11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ];\n\t\tconst m21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ];\n\t\tconst m31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ];\n\n\t\tswitch ( order ) {\n\n\t\t\tcase 'XYZ':\n\n\t\t\t\tthis._y = Math.asin( clamp( m13, - 1, 1 ) );\n\n\t\t\t\tif ( Math.abs( m13 ) < 0.9999999 ) {\n\n\t\t\t\t\tthis._x = Math.atan2( - m23, m33 );\n\t\t\t\t\tthis._z = Math.atan2( - m12, m11 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._x = Math.atan2( m32, m22 );\n\t\t\t\t\tthis._z = 0;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'YXZ':\n\n\t\t\t\tthis._x = Math.asin( - clamp( m23, - 1, 1 ) );\n\n\t\t\t\tif ( Math.abs( m23 ) < 0.9999999 ) {\n\n\t\t\t\t\tthis._y = Math.atan2( m13, m33 );\n\t\t\t\t\tthis._z = Math.atan2( m21, m22 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._y = Math.atan2( - m31, m11 );\n\t\t\t\t\tthis._z = 0;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'ZXY':\n\n\t\t\t\tthis._x = Math.asin( clamp( m32, - 1, 1 ) );\n\n\t\t\t\tif ( Math.abs( m32 ) < 0.9999999 ) {\n\n\t\t\t\t\tthis._y = Math.atan2( - m31, m33 );\n\t\t\t\t\tthis._z = Math.atan2( - m12, m22 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._y = 0;\n\t\t\t\t\tthis._z = Math.atan2( m21, m11 );\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'ZYX':\n\n\t\t\t\tthis._y = Math.asin( - clamp( m31, - 1, 1 ) );\n\n\t\t\t\tif ( Math.abs( m31 ) < 0.9999999 ) {\n\n\t\t\t\t\tthis._x = Math.atan2( m32, m33 );\n\t\t\t\t\tthis._z = Math.atan2( m21, m11 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._x = 0;\n\t\t\t\t\tthis._z = Math.atan2( - m12, m22 );\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'YZX':\n\n\t\t\t\tthis._z = Math.asin( clamp( m21, - 1, 1 ) );\n\n\t\t\t\tif ( Math.abs( m21 ) < 0.9999999 ) {\n\n\t\t\t\t\tthis._x = Math.atan2( - m23, m22 );\n\t\t\t\t\tthis._y = Math.atan2( - m31, m11 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._x = 0;\n\t\t\t\t\tthis._y = Math.atan2( m13, m33 );\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'XZY':\n\n\t\t\t\tthis._z = Math.asin( - clamp( m12, - 1, 1 ) );\n\n\t\t\t\tif ( Math.abs( m12 ) < 0.9999999 ) {\n\n\t\t\t\t\tthis._x = Math.atan2( m32, m22 );\n\t\t\t\t\tthis._y = Math.atan2( m13, m11 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._x = Math.atan2( - m23, m33 );\n\t\t\t\t\tthis._y = 0;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tconsole.warn( 'THREE.Euler: .setFromRotationMatrix() encountered an unknown order: ' + order );\n\n\t\t}\n\n\t\tthis._order = order;\n\n\t\tif ( update === true ) this._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tsetFromQuaternion( q, order, update ) {\n\n\t\t_matrix$1.makeRotationFromQuaternion( q );\n\n\t\treturn this.setFromRotationMatrix( _matrix$1, order, update );\n\n\t}\n\n\tsetFromVector3( v, order = this._order ) {\n\n\t\treturn this.set( v.x, v.y, v.z, order );\n\n\t}\n\n\treorder( newOrder ) {\n\n\t\t// WARNING: this discards revolution information -bhouston\n\n\t\t_quaternion$3.setFromEuler( this );\n\n\t\treturn this.setFromQuaternion( _quaternion$3, newOrder );\n\n\t}\n\n\tequals( euler ) {\n\n\t\treturn ( euler._x === this._x ) && ( euler._y === this._y ) && ( euler._z === this._z ) && ( euler._order === this._order );\n\n\t}\n\n\tfromArray( array ) {\n\n\t\tthis._x = array[ 0 ];\n\t\tthis._y = array[ 1 ];\n\t\tthis._z = array[ 2 ];\n\t\tif ( array[ 3 ] !== undefined ) this._order = array[ 3 ];\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tarray[ offset ] = this._x;\n\t\tarray[ offset + 1 ] = this._y;\n\t\tarray[ offset + 2 ] = this._z;\n\t\tarray[ offset + 3 ] = this._order;\n\n\t\treturn array;\n\n\t}\n\n\t_onChange( callback ) {\n\n\t\tthis._onChangeCallback = callback;\n\n\t\treturn this;\n\n\t}\n\n\t_onChangeCallback() {}\n\n\t*[ Symbol.iterator ]() {\n\n\t\tyield this._x;\n\t\tyield this._y;\n\t\tyield this._z;\n\t\tyield this._order;\n\n\t}\n\n\t// @deprecated since r138, 02cf0df1cb4575d5842fef9c85bb5a89fe020d53\n\n\ttoVector3() {\n\n\t\tconsole.error( 'THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead' );\n\n\t}\n\n}\n\nEuler.DefaultOrder = 'XYZ';\nEuler.RotationOrders = [ 'XYZ', 'YZX', 'ZXY', 'XZY', 'YXZ', 'ZYX' ];\n\nclass Layers {\n\n\tconstructor() {\n\n\t\tthis.mask = 1 | 0;\n\n\t}\n\n\tset( channel ) {\n\n\t\tthis.mask = ( 1 << channel | 0 ) >>> 0;\n\n\t}\n\n\tenable( channel ) {\n\n\t\tthis.mask |= 1 << channel | 0;\n\n\t}\n\n\tenableAll() {\n\n\t\tthis.mask = 0xffffffff | 0;\n\n\t}\n\n\ttoggle( channel ) {\n\n\t\tthis.mask ^= 1 << channel | 0;\n\n\t}\n\n\tdisable( channel ) {\n\n\t\tthis.mask &= ~ ( 1 << channel | 0 );\n\n\t}\n\n\tdisableAll() {\n\n\t\tthis.mask = 0;\n\n\t}\n\n\ttest( layers ) {\n\n\t\treturn ( this.mask & layers.mask ) !== 0;\n\n\t}\n\n\tisEnabled( channel ) {\n\n\t\treturn ( this.mask & ( 1 << channel | 0 ) ) !== 0;\n\n\t}\n\n}\n\nlet _object3DId = 0;\n\nconst _v1$4 = /*@__PURE__*/ new Vector3();\nconst _q1 = /*@__PURE__*/ new Quaternion();\nconst _m1$1 = /*@__PURE__*/ new Matrix4();\nconst _target = /*@__PURE__*/ new Vector3();\n\nconst _position$3 = /*@__PURE__*/ new Vector3();\nconst _scale$2 = /*@__PURE__*/ new Vector3();\nconst _quaternion$2 = /*@__PURE__*/ new Quaternion();\n\nconst _xAxis = /*@__PURE__*/ new Vector3( 1, 0, 0 );\nconst _yAxis = /*@__PURE__*/ new Vector3( 0, 1, 0 );\nconst _zAxis = /*@__PURE__*/ new Vector3( 0, 0, 1 );\n\nconst _addedEvent = { type: 'added' };\nconst _removedEvent = { type: 'removed' };\n\nclass Object3D extends EventDispatcher {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.isObject3D = true;\n\n\t\tObject.defineProperty( this, 'id', { value: _object3DId ++ } );\n\n\t\tthis.uuid = generateUUID();\n\n\t\tthis.name = '';\n\t\tthis.type = 'Object3D';\n\n\t\tthis.parent = null;\n\t\tthis.children = [];\n\n\t\tthis.up = Object3D.DefaultUp.clone();\n\n\t\tconst position = new Vector3();\n\t\tconst rotation = new Euler();\n\t\tconst quaternion = new Quaternion();\n\t\tconst scale = new Vector3( 1, 1, 1 );\n\n\t\tfunction onRotationChange() {\n\n\t\t\tquaternion.setFromEuler( rotation, false );\n\n\t\t}\n\n\t\tfunction onQuaternionChange() {\n\n\t\t\trotation.setFromQuaternion( quaternion, undefined, false );\n\n\t\t}\n\n\t\trotation._onChange( onRotationChange );\n\t\tquaternion._onChange( onQuaternionChange );\n\n\t\tObject.defineProperties( this, {\n\t\t\tposition: {\n\t\t\t\tconfigurable: true,\n\t\t\t\tenumerable: true,\n\t\t\t\tvalue: position\n\t\t\t},\n\t\t\trotation: {\n\t\t\t\tconfigurable: true,\n\t\t\t\tenumerable: true,\n\t\t\t\tvalue: rotation\n\t\t\t},\n\t\t\tquaternion: {\n\t\t\t\tconfigurable: true,\n\t\t\t\tenumerable: true,\n\t\t\t\tvalue: quaternion\n\t\t\t},\n\t\t\tscale: {\n\t\t\t\tconfigurable: true,\n\t\t\t\tenumerable: true,\n\t\t\t\tvalue: scale\n\t\t\t},\n\t\t\tmodelViewMatrix: {\n\t\t\t\tvalue: new Matrix4()\n\t\t\t},\n\t\t\tnormalMatrix: {\n\t\t\t\tvalue: new Matrix3()\n\t\t\t}\n\t\t} );\n\n\t\tthis.matrix = new Matrix4();\n\t\tthis.matrixWorld = new Matrix4();\n\n\t\tthis.matrixAutoUpdate = Object3D.DefaultMatrixAutoUpdate;\n\t\tthis.matrixWorldNeedsUpdate = false;\n\n\t\tthis.matrixWorldAutoUpdate = Object3D.DefaultMatrixWorldAutoUpdate; // checked by the renderer\n\n\t\tthis.layers = new Layers();\n\t\tthis.visible = true;\n\n\t\tthis.castShadow = false;\n\t\tthis.receiveShadow = false;\n\n\t\tthis.frustumCulled = true;\n\t\tthis.renderOrder = 0;\n\n\t\tthis.animations = [];\n\n\t\tthis.userData = {};\n\n\t}\n\n\tonBeforeRender( /* renderer, scene, camera, geometry, material, group */ ) {}\n\n\tonAfterRender( /* renderer, scene, camera, geometry, material, group */ ) {}\n\n\tapplyMatrix4( matrix ) {\n\n\t\tif ( this.matrixAutoUpdate ) this.updateMatrix();\n\n\t\tthis.matrix.premultiply( matrix );\n\n\t\tthis.matrix.decompose( this.position, this.quaternion, this.scale );\n\n\t}\n\n\tapplyQuaternion( q ) {\n\n\t\tthis.quaternion.premultiply( q );\n\n\t\treturn this;\n\n\t}\n\n\tsetRotationFromAxisAngle( axis, angle ) {\n\n\t\t// assumes axis is normalized\n\n\t\tthis.quaternion.setFromAxisAngle( axis, angle );\n\n\t}\n\n\tsetRotationFromEuler( euler ) {\n\n\t\tthis.quaternion.setFromEuler( euler, true );\n\n\t}\n\n\tsetRotationFromMatrix( m ) {\n\n\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\n\n\t\tthis.quaternion.setFromRotationMatrix( m );\n\n\t}\n\n\tsetRotationFromQuaternion( q ) {\n\n\t\t// assumes q is normalized\n\n\t\tthis.quaternion.copy( q );\n\n\t}\n\n\trotateOnAxis( axis, angle ) {\n\n\t\t// rotate object on axis in object space\n\t\t// axis is assumed to be normalized\n\n\t\t_q1.setFromAxisAngle( axis, angle );\n\n\t\tthis.quaternion.multiply( _q1 );\n\n\t\treturn this;\n\n\t}\n\n\trotateOnWorldAxis( axis, angle ) {\n\n\t\t// rotate object on axis in world space\n\t\t// axis is assumed to be normalized\n\t\t// method assumes no rotated parent\n\n\t\t_q1.setFromAxisAngle( axis, angle );\n\n\t\tthis.quaternion.premultiply( _q1 );\n\n\t\treturn this;\n\n\t}\n\n\trotateX( angle ) {\n\n\t\treturn this.rotateOnAxis( _xAxis, angle );\n\n\t}\n\n\trotateY( angle ) {\n\n\t\treturn this.rotateOnAxis( _yAxis, angle );\n\n\t}\n\n\trotateZ( angle ) {\n\n\t\treturn this.rotateOnAxis( _zAxis, angle );\n\n\t}\n\n\ttranslateOnAxis( axis, distance ) {\n\n\t\t// translate object by distance along axis in object space\n\t\t// axis is assumed to be normalized\n\n\t\t_v1$4.copy( axis ).applyQuaternion( this.quaternion );\n\n\t\tthis.position.add( _v1$4.multiplyScalar( distance ) );\n\n\t\treturn this;\n\n\t}\n\n\ttranslateX( distance ) {\n\n\t\treturn this.translateOnAxis( _xAxis, distance );\n\n\t}\n\n\ttranslateY( distance ) {\n\n\t\treturn this.translateOnAxis( _yAxis, distance );\n\n\t}\n\n\ttranslateZ( distance ) {\n\n\t\treturn this.translateOnAxis( _zAxis, distance );\n\n\t}\n\n\tlocalToWorld( vector ) {\n\n\t\tthis.updateWorldMatrix( true, false );\n\n\t\treturn vector.applyMatrix4( this.matrixWorld );\n\n\t}\n\n\tworldToLocal( vector ) {\n\n\t\tthis.updateWorldMatrix( true, false );\n\n\t\treturn vector.applyMatrix4( _m1$1.copy( this.matrixWorld ).invert() );\n\n\t}\n\n\tlookAt( x, y, z ) {\n\n\t\t// This method does not support objects having non-uniformly-scaled parent(s)\n\n\t\tif ( x.isVector3 ) {\n\n\t\t\t_target.copy( x );\n\n\t\t} else {\n\n\t\t\t_target.set( x, y, z );\n\n\t\t}\n\n\t\tconst parent = this.parent;\n\n\t\tthis.updateWorldMatrix( true, false );\n\n\t\t_position$3.setFromMatrixPosition( this.matrixWorld );\n\n\t\tif ( this.isCamera || this.isLight ) {\n\n\t\t\t_m1$1.lookAt( _position$3, _target, this.up );\n\n\t\t} else {\n\n\t\t\t_m1$1.lookAt( _target, _position$3, this.up );\n\n\t\t}\n\n\t\tthis.quaternion.setFromRotationMatrix( _m1$1 );\n\n\t\tif ( parent ) {\n\n\t\t\t_m1$1.extractRotation( parent.matrixWorld );\n\t\t\t_q1.setFromRotationMatrix( _m1$1 );\n\t\t\tthis.quaternion.premultiply( _q1.invert() );\n\n\t\t}\n\n\t}\n\n\tadd( object ) {\n\n\t\tif ( arguments.length > 1 ) {\n\n\t\t\tfor ( let i = 0; i < arguments.length; i ++ ) {\n\n\t\t\t\tthis.add( arguments[ i ] );\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\tif ( object === this ) {\n\n\t\t\tconsole.error( 'THREE.Object3D.add: object can\\'t be added as a child of itself.', object );\n\t\t\treturn this;\n\n\t\t}\n\n\t\tif ( object && object.isObject3D ) {\n\n\t\t\tif ( object.parent !== null ) {\n\n\t\t\t\tobject.parent.remove( object );\n\n\t\t\t}\n\n\t\t\tobject.parent = this;\n\t\t\tthis.children.push( object );\n\n\t\t\tobject.dispatchEvent( _addedEvent );\n\n\t\t} else {\n\n\t\t\tconsole.error( 'THREE.Object3D.add: object not an instance of THREE.Object3D.', object );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tremove( object ) {\n\n\t\tif ( arguments.length > 1 ) {\n\n\t\t\tfor ( let i = 0; i < arguments.length; i ++ ) {\n\n\t\t\t\tthis.remove( arguments[ i ] );\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\tconst index = this.children.indexOf( object );\n\n\t\tif ( index !== - 1 ) {\n\n\t\t\tobject.parent = null;\n\t\t\tthis.children.splice( index, 1 );\n\n\t\t\tobject.dispatchEvent( _removedEvent );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tremoveFromParent() {\n\n\t\tconst parent = this.parent;\n\n\t\tif ( parent !== null ) {\n\n\t\t\tparent.remove( this );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tclear() {\n\n\t\tfor ( let i = 0; i < this.children.length; i ++ ) {\n\n\t\t\tconst object = this.children[ i ];\n\n\t\t\tobject.parent = null;\n\n\t\t\tobject.dispatchEvent( _removedEvent );\n\n\t\t}\n\n\t\tthis.children.length = 0;\n\n\t\treturn this;\n\n\n\t}\n\n\tattach( object ) {\n\n\t\t// adds object as a child of this, while maintaining the object's world transform\n\n\t\t// Note: This method does not support scene graphs having non-uniformly-scaled nodes(s)\n\n\t\tthis.updateWorldMatrix( true, false );\n\n\t\t_m1$1.copy( this.matrixWorld ).invert();\n\n\t\tif ( object.parent !== null ) {\n\n\t\t\tobject.parent.updateWorldMatrix( true, false );\n\n\t\t\t_m1$1.multiply( object.parent.matrixWorld );\n\n\t\t}\n\n\t\tobject.applyMatrix4( _m1$1 );\n\n\t\tthis.add( object );\n\n\t\tobject.updateWorldMatrix( false, true );\n\n\t\treturn this;\n\n\t}\n\n\tgetObjectById( id ) {\n\n\t\treturn this.getObjectByProperty( 'id', id );\n\n\t}\n\n\tgetObjectByName( name ) {\n\n\t\treturn this.getObjectByProperty( 'name', name );\n\n\t}\n\n\tgetObjectByProperty( name, value ) {\n\n\t\tif ( this[ name ] === value ) return this;\n\n\t\tfor ( let i = 0, l = this.children.length; i < l; i ++ ) {\n\n\t\t\tconst child = this.children[ i ];\n\t\t\tconst object = child.getObjectByProperty( name, value );\n\n\t\t\tif ( object !== undefined ) {\n\n\t\t\t\treturn object;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn undefined;\n\n\t}\n\n\tgetObjectsByProperty( name, value ) {\n\n\t\tlet result = [];\n\n\t\tif ( this[ name ] === value ) result.push( this );\n\n\t\tfor ( let i = 0, l = this.children.length; i < l; i ++ ) {\n\n\t\t\tconst childResult = this.children[ i ].getObjectsByProperty( name, value );\n\n\t\t\tif ( childResult.length > 0 ) {\n\n\t\t\t\tresult = result.concat( childResult );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n\tgetWorldPosition( target ) {\n\n\t\tthis.updateWorldMatrix( true, false );\n\n\t\treturn target.setFromMatrixPosition( this.matrixWorld );\n\n\t}\n\n\tgetWorldQuaternion( target ) {\n\n\t\tthis.updateWorldMatrix( true, false );\n\n\t\tthis.matrixWorld.decompose( _position$3, target, _scale$2 );\n\n\t\treturn target;\n\n\t}\n\n\tgetWorldScale( target ) {\n\n\t\tthis.updateWorldMatrix( true, false );\n\n\t\tthis.matrixWorld.decompose( _position$3, _quaternion$2, target );\n\n\t\treturn target;\n\n\t}\n\n\tgetWorldDirection( target ) {\n\n\t\tthis.updateWorldMatrix( true, false );\n\n\t\tconst e = this.matrixWorld.elements;\n\n\t\treturn target.set( e[ 8 ], e[ 9 ], e[ 10 ] ).normalize();\n\n\t}\n\n\traycast( /* raycaster, intersects */ ) {}\n\n\ttraverse( callback ) {\n\n\t\tcallback( this );\n\n\t\tconst children = this.children;\n\n\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\tchildren[ i ].traverse( callback );\n\n\t\t}\n\n\t}\n\n\ttraverseVisible( callback ) {\n\n\t\tif ( this.visible === false ) return;\n\n\t\tcallback( this );\n\n\t\tconst children = this.children;\n\n\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\tchildren[ i ].traverseVisible( callback );\n\n\t\t}\n\n\t}\n\n\ttraverseAncestors( callback ) {\n\n\t\tconst parent = this.parent;\n\n\t\tif ( parent !== null ) {\n\n\t\t\tcallback( parent );\n\n\t\t\tparent.traverseAncestors( callback );\n\n\t\t}\n\n\t}\n\n\tupdateMatrix() {\n\n\t\tthis.matrix.compose( this.position, this.quaternion, this.scale );\n\n\t\tthis.matrixWorldNeedsUpdate = true;\n\n\t}\n\n\tupdateMatrixWorld( force ) {\n\n\t\tif ( this.matrixAutoUpdate ) this.updateMatrix();\n\n\t\tif ( this.matrixWorldNeedsUpdate || force ) {\n\n\t\t\tif ( this.parent === null ) {\n\n\t\t\t\tthis.matrixWorld.copy( this.matrix );\n\n\t\t\t} else {\n\n\t\t\t\tthis.matrixWorld.multiplyMatrices( this.parent.matrixWorld, this.matrix );\n\n\t\t\t}\n\n\t\t\tthis.matrixWorldNeedsUpdate = false;\n\n\t\t\tforce = true;\n\n\t\t}\n\n\t\t// update children\n\n\t\tconst children = this.children;\n\n\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\tconst child = children[ i ];\n\n\t\t\tif ( child.matrixWorldAutoUpdate === true || force === true ) {\n\n\t\t\t\tchild.updateMatrixWorld( force );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tupdateWorldMatrix( updateParents, updateChildren ) {\n\n\t\tconst parent = this.parent;\n\n\t\tif ( updateParents === true && parent !== null && parent.matrixWorldAutoUpdate === true ) {\n\n\t\t\tparent.updateWorldMatrix( true, false );\n\n\t\t}\n\n\t\tif ( this.matrixAutoUpdate ) this.updateMatrix();\n\n\t\tif ( this.parent === null ) {\n\n\t\t\tthis.matrixWorld.copy( this.matrix );\n\n\t\t} else {\n\n\t\t\tthis.matrixWorld.multiplyMatrices( this.parent.matrixWorld, this.matrix );\n\n\t\t}\n\n\t\t// update children\n\n\t\tif ( updateChildren === true ) {\n\n\t\t\tconst children = this.children;\n\n\t\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\t\tconst child = children[ i ];\n\n\t\t\t\tif ( child.matrixWorldAutoUpdate === true ) {\n\n\t\t\t\t\tchild.updateWorldMatrix( false, true );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\t// meta is a string when called from JSON.stringify\n\t\tconst isRootObject = ( meta === undefined || typeof meta === 'string' );\n\n\t\tconst output = {};\n\n\t\t// meta is a hash used to collect geometries, materials.\n\t\t// not providing it implies that this is the root object\n\t\t// being serialized.\n\t\tif ( isRootObject ) {\n\n\t\t\t// initialize meta obj\n\t\t\tmeta = {\n\t\t\t\tgeometries: {},\n\t\t\t\tmaterials: {},\n\t\t\t\ttextures: {},\n\t\t\t\timages: {},\n\t\t\t\tshapes: {},\n\t\t\t\tskeletons: {},\n\t\t\t\tanimations: {},\n\t\t\t\tnodes: {}\n\t\t\t};\n\n\t\t\toutput.metadata = {\n\t\t\t\tversion: 4.5,\n\t\t\t\ttype: 'Object',\n\t\t\t\tgenerator: 'Object3D.toJSON'\n\t\t\t};\n\n\t\t}\n\n\t\t// standard Object3D serialization\n\n\t\tconst object = {};\n\n\t\tobject.uuid = this.uuid;\n\t\tobject.type = this.type;\n\n\t\tif ( this.name !== '' ) object.name = this.name;\n\t\tif ( this.castShadow === true ) object.castShadow = true;\n\t\tif ( this.receiveShadow === true ) object.receiveShadow = true;\n\t\tif ( this.visible === false ) object.visible = false;\n\t\tif ( this.frustumCulled === false ) object.frustumCulled = false;\n\t\tif ( this.renderOrder !== 0 ) object.renderOrder = this.renderOrder;\n\t\tif ( Object.keys( this.userData ).length > 0 ) object.userData = this.userData;\n\n\t\tobject.layers = this.layers.mask;\n\t\tobject.matrix = this.matrix.toArray();\n\n\t\tif ( this.matrixAutoUpdate === false ) object.matrixAutoUpdate = false;\n\n\t\t// object specific properties\n\n\t\tif ( this.isInstancedMesh ) {\n\n\t\t\tobject.type = 'InstancedMesh';\n\t\t\tobject.count = this.count;\n\t\t\tobject.instanceMatrix = this.instanceMatrix.toJSON();\n\t\t\tif ( this.instanceColor !== null ) object.instanceColor = this.instanceColor.toJSON();\n\n\t\t}\n\n\t\t//\n\n\t\tfunction serialize( library, element ) {\n\n\t\t\tif ( library[ element.uuid ] === undefined ) {\n\n\t\t\t\tlibrary[ element.uuid ] = element.toJSON( meta );\n\n\t\t\t}\n\n\t\t\treturn element.uuid;\n\n\t\t}\n\n\t\tif ( this.isScene ) {\n\n\t\t\tif ( this.background ) {\n\n\t\t\t\tif ( this.background.isColor ) {\n\n\t\t\t\t\tobject.background = this.background.toJSON();\n\n\t\t\t\t} else if ( this.background.isTexture ) {\n\n\t\t\t\t\tobject.background = this.background.toJSON( meta ).uuid;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( this.environment && this.environment.isTexture && this.environment.isRenderTargetTexture !== true ) {\n\n\t\t\t\tobject.environment = this.environment.toJSON( meta ).uuid;\n\n\t\t\t}\n\n\t\t} else if ( this.isMesh || this.isLine || this.isPoints ) {\n\n\t\t\tobject.geometry = serialize( meta.geometries, this.geometry );\n\n\t\t\tconst parameters = this.geometry.parameters;\n\n\t\t\tif ( parameters !== undefined && parameters.shapes !== undefined ) {\n\n\t\t\t\tconst shapes = parameters.shapes;\n\n\t\t\t\tif ( Array.isArray( shapes ) ) {\n\n\t\t\t\t\tfor ( let i = 0, l = shapes.length; i < l; i ++ ) {\n\n\t\t\t\t\t\tconst shape = shapes[ i ];\n\n\t\t\t\t\t\tserialize( meta.shapes, shape );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tserialize( meta.shapes, shapes );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( this.isSkinnedMesh ) {\n\n\t\t\tobject.bindMode = this.bindMode;\n\t\t\tobject.bindMatrix = this.bindMatrix.toArray();\n\n\t\t\tif ( this.skeleton !== undefined ) {\n\n\t\t\t\tserialize( meta.skeletons, this.skeleton );\n\n\t\t\t\tobject.skeleton = this.skeleton.uuid;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( this.material !== undefined ) {\n\n\t\t\tif ( Array.isArray( this.material ) ) {\n\n\t\t\t\tconst uuids = [];\n\n\t\t\t\tfor ( let i = 0, l = this.material.length; i < l; i ++ ) {\n\n\t\t\t\t\tuuids.push( serialize( meta.materials, this.material[ i ] ) );\n\n\t\t\t\t}\n\n\t\t\t\tobject.material = uuids;\n\n\t\t\t} else {\n\n\t\t\t\tobject.material = serialize( meta.materials, this.material );\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tif ( this.children.length > 0 ) {\n\n\t\t\tobject.children = [];\n\n\t\t\tfor ( let i = 0; i < this.children.length; i ++ ) {\n\n\t\t\t\tobject.children.push( this.children[ i ].toJSON( meta ).object );\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tif ( this.animations.length > 0 ) {\n\n\t\t\tobject.animations = [];\n\n\t\t\tfor ( let i = 0; i < this.animations.length; i ++ ) {\n\n\t\t\t\tconst animation = this.animations[ i ];\n\n\t\t\t\tobject.animations.push( serialize( meta.animations, animation ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( isRootObject ) {\n\n\t\t\tconst geometries = extractFromCache( meta.geometries );\n\t\t\tconst materials = extractFromCache( meta.materials );\n\t\t\tconst textures = extractFromCache( meta.textures );\n\t\t\tconst images = extractFromCache( meta.images );\n\t\t\tconst shapes = extractFromCache( meta.shapes );\n\t\t\tconst skeletons = extractFromCache( meta.skeletons );\n\t\t\tconst animations = extractFromCache( meta.animations );\n\t\t\tconst nodes = extractFromCache( meta.nodes );\n\n\t\t\tif ( geometries.length > 0 ) output.geometries = geometries;\n\t\t\tif ( materials.length > 0 ) output.materials = materials;\n\t\t\tif ( textures.length > 0 ) output.textures = textures;\n\t\t\tif ( images.length > 0 ) output.images = images;\n\t\t\tif ( shapes.length > 0 ) output.shapes = shapes;\n\t\t\tif ( skeletons.length > 0 ) output.skeletons = skeletons;\n\t\t\tif ( animations.length > 0 ) output.animations = animations;\n\t\t\tif ( nodes.length > 0 ) output.nodes = nodes;\n\n\t\t}\n\n\t\toutput.object = object;\n\n\t\treturn output;\n\n\t\t// extract data from the cache hash\n\t\t// remove metadata on each item\n\t\t// and return as array\n\t\tfunction extractFromCache( cache ) {\n\n\t\t\tconst values = [];\n\t\t\tfor ( const key in cache ) {\n\n\t\t\t\tconst data = cache[ key ];\n\t\t\t\tdelete data.metadata;\n\t\t\t\tvalues.push( data );\n\n\t\t\t}\n\n\t\t\treturn values;\n\n\t\t}\n\n\t}\n\n\tclone( recursive ) {\n\n\t\treturn new this.constructor().copy( this, recursive );\n\n\t}\n\n\tcopy( source, recursive = true ) {\n\n\t\tthis.name = source.name;\n\n\t\tthis.up.copy( source.up );\n\n\t\tthis.position.copy( source.position );\n\t\tthis.rotation.order = source.rotation.order;\n\t\tthis.quaternion.copy( source.quaternion );\n\t\tthis.scale.copy( source.scale );\n\n\t\tthis.matrix.copy( source.matrix );\n\t\tthis.matrixWorld.copy( source.matrixWorld );\n\n\t\tthis.matrixAutoUpdate = source.matrixAutoUpdate;\n\t\tthis.matrixWorldNeedsUpdate = source.matrixWorldNeedsUpdate;\n\n\t\tthis.matrixWorldAutoUpdate = source.matrixWorldAutoUpdate;\n\n\t\tthis.layers.mask = source.layers.mask;\n\t\tthis.visible = source.visible;\n\n\t\tthis.castShadow = source.castShadow;\n\t\tthis.receiveShadow = source.receiveShadow;\n\n\t\tthis.frustumCulled = source.frustumCulled;\n\t\tthis.renderOrder = source.renderOrder;\n\n\t\tthis.userData = JSON.parse( JSON.stringify( source.userData ) );\n\n\t\tif ( recursive === true ) {\n\n\t\t\tfor ( let i = 0; i < source.children.length; i ++ ) {\n\n\t\t\t\tconst child = source.children[ i ];\n\t\t\t\tthis.add( child.clone() );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n}\n\nObject3D.DefaultUp = /*@__PURE__*/ new Vector3( 0, 1, 0 );\nObject3D.DefaultMatrixAutoUpdate = true;\nObject3D.DefaultMatrixWorldAutoUpdate = true;\n\nconst _v0$1 = /*@__PURE__*/ new Vector3();\nconst _v1$3 = /*@__PURE__*/ new Vector3();\nconst _v2$2 = /*@__PURE__*/ new Vector3();\nconst _v3$1 = /*@__PURE__*/ new Vector3();\n\nconst _vab = /*@__PURE__*/ new Vector3();\nconst _vac = /*@__PURE__*/ new Vector3();\nconst _vbc = /*@__PURE__*/ new Vector3();\nconst _vap = /*@__PURE__*/ new Vector3();\nconst _vbp = /*@__PURE__*/ new Vector3();\nconst _vcp = /*@__PURE__*/ new Vector3();\n\nclass Triangle {\n\n\tconstructor( a = new Vector3(), b = new Vector3(), c = new Vector3() ) {\n\n\t\tthis.a = a;\n\t\tthis.b = b;\n\t\tthis.c = c;\n\n\t}\n\n\tstatic getNormal( a, b, c, target ) {\n\n\t\ttarget.subVectors( c, b );\n\t\t_v0$1.subVectors( a, b );\n\t\ttarget.cross( _v0$1 );\n\n\t\tconst targetLengthSq = target.lengthSq();\n\t\tif ( targetLengthSq > 0 ) {\n\n\t\t\treturn target.multiplyScalar( 1 / Math.sqrt( targetLengthSq ) );\n\n\t\t}\n\n\t\treturn target.set( 0, 0, 0 );\n\n\t}\n\n\t// static/instance method to calculate barycentric coordinates\n\t// based on: http://www.blackpawn.com/texts/pointinpoly/default.html\n\tstatic getBarycoord( point, a, b, c, target ) {\n\n\t\t_v0$1.subVectors( c, a );\n\t\t_v1$3.subVectors( b, a );\n\t\t_v2$2.subVectors( point, a );\n\n\t\tconst dot00 = _v0$1.dot( _v0$1 );\n\t\tconst dot01 = _v0$1.dot( _v1$3 );\n\t\tconst dot02 = _v0$1.dot( _v2$2 );\n\t\tconst dot11 = _v1$3.dot( _v1$3 );\n\t\tconst dot12 = _v1$3.dot( _v2$2 );\n\n\t\tconst denom = ( dot00 * dot11 - dot01 * dot01 );\n\n\t\t// collinear or singular triangle\n\t\tif ( denom === 0 ) {\n\n\t\t\t// arbitrary location outside of triangle?\n\t\t\t// not sure if this is the best idea, maybe should be returning undefined\n\t\t\treturn target.set( - 2, - 1, - 1 );\n\n\t\t}\n\n\t\tconst invDenom = 1 / denom;\n\t\tconst u = ( dot11 * dot02 - dot01 * dot12 ) * invDenom;\n\t\tconst v = ( dot00 * dot12 - dot01 * dot02 ) * invDenom;\n\n\t\t// barycentric coordinates must always sum to 1\n\t\treturn target.set( 1 - u - v, v, u );\n\n\t}\n\n\tstatic containsPoint( point, a, b, c ) {\n\n\t\tthis.getBarycoord( point, a, b, c, _v3$1 );\n\n\t\treturn ( _v3$1.x >= 0 ) && ( _v3$1.y >= 0 ) && ( ( _v3$1.x + _v3$1.y ) <= 1 );\n\n\t}\n\n\tstatic getUV( point, p1, p2, p3, uv1, uv2, uv3, target ) {\n\n\t\tthis.getBarycoord( point, p1, p2, p3, _v3$1 );\n\n\t\ttarget.set( 0, 0 );\n\t\ttarget.addScaledVector( uv1, _v3$1.x );\n\t\ttarget.addScaledVector( uv2, _v3$1.y );\n\t\ttarget.addScaledVector( uv3, _v3$1.z );\n\n\t\treturn target;\n\n\t}\n\n\tstatic isFrontFacing( a, b, c, direction ) {\n\n\t\t_v0$1.subVectors( c, b );\n\t\t_v1$3.subVectors( a, b );\n\n\t\t// strictly front facing\n\t\treturn ( _v0$1.cross( _v1$3 ).dot( direction ) < 0 ) ? true : false;\n\n\t}\n\n\tset( a, b, c ) {\n\n\t\tthis.a.copy( a );\n\t\tthis.b.copy( b );\n\t\tthis.c.copy( c );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromPointsAndIndices( points, i0, i1, i2 ) {\n\n\t\tthis.a.copy( points[ i0 ] );\n\t\tthis.b.copy( points[ i1 ] );\n\t\tthis.c.copy( points[ i2 ] );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromAttributeAndIndices( attribute, i0, i1, i2 ) {\n\n\t\tthis.a.fromBufferAttribute( attribute, i0 );\n\t\tthis.b.fromBufferAttribute( attribute, i1 );\n\t\tthis.c.fromBufferAttribute( attribute, i2 );\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\tcopy( triangle ) {\n\n\t\tthis.a.copy( triangle.a );\n\t\tthis.b.copy( triangle.b );\n\t\tthis.c.copy( triangle.c );\n\n\t\treturn this;\n\n\t}\n\n\tgetArea() {\n\n\t\t_v0$1.subVectors( this.c, this.b );\n\t\t_v1$3.subVectors( this.a, this.b );\n\n\t\treturn _v0$1.cross( _v1$3 ).length() * 0.5;\n\n\t}\n\n\tgetMidpoint( target ) {\n\n\t\treturn target.addVectors( this.a, this.b ).add( this.c ).multiplyScalar( 1 / 3 );\n\n\t}\n\n\tgetNormal( target ) {\n\n\t\treturn Triangle.getNormal( this.a, this.b, this.c, target );\n\n\t}\n\n\tgetPlane( target ) {\n\n\t\treturn target.setFromCoplanarPoints( this.a, this.b, this.c );\n\n\t}\n\n\tgetBarycoord( point, target ) {\n\n\t\treturn Triangle.getBarycoord( point, this.a, this.b, this.c, target );\n\n\t}\n\n\tgetUV( point, uv1, uv2, uv3, target ) {\n\n\t\treturn Triangle.getUV( point, this.a, this.b, this.c, uv1, uv2, uv3, target );\n\n\t}\n\n\tcontainsPoint( point ) {\n\n\t\treturn Triangle.containsPoint( point, this.a, this.b, this.c );\n\n\t}\n\n\tisFrontFacing( direction ) {\n\n\t\treturn Triangle.isFrontFacing( this.a, this.b, this.c, direction );\n\n\t}\n\n\tintersectsBox( box ) {\n\n\t\treturn box.intersectsTriangle( this );\n\n\t}\n\n\tclosestPointToPoint( p, target ) {\n\n\t\tconst a = this.a, b = this.b, c = this.c;\n\t\tlet v, w;\n\n\t\t// algorithm thanks to Real-Time Collision Detection by Christer Ericson,\n\t\t// published by Morgan Kaufmann Publishers, (c) 2005 Elsevier Inc.,\n\t\t// under the accompanying license; see chapter 5.1.5 for detailed explanation.\n\t\t// basically, we're distinguishing which of the voronoi regions of the triangle\n\t\t// the point lies in with the minimum amount of redundant computation.\n\n\t\t_vab.subVectors( b, a );\n\t\t_vac.subVectors( c, a );\n\t\t_vap.subVectors( p, a );\n\t\tconst d1 = _vab.dot( _vap );\n\t\tconst d2 = _vac.dot( _vap );\n\t\tif ( d1 <= 0 && d2 <= 0 ) {\n\n\t\t\t// vertex region of A; barycentric coords (1, 0, 0)\n\t\t\treturn target.copy( a );\n\n\t\t}\n\n\t\t_vbp.subVectors( p, b );\n\t\tconst d3 = _vab.dot( _vbp );\n\t\tconst d4 = _vac.dot( _vbp );\n\t\tif ( d3 >= 0 && d4 <= d3 ) {\n\n\t\t\t// vertex region of B; barycentric coords (0, 1, 0)\n\t\t\treturn target.copy( b );\n\n\t\t}\n\n\t\tconst vc = d1 * d4 - d3 * d2;\n\t\tif ( vc <= 0 && d1 >= 0 && d3 <= 0 ) {\n\n\t\t\tv = d1 / ( d1 - d3 );\n\t\t\t// edge region of AB; barycentric coords (1-v, v, 0)\n\t\t\treturn target.copy( a ).addScaledVector( _vab, v );\n\n\t\t}\n\n\t\t_vcp.subVectors( p, c );\n\t\tconst d5 = _vab.dot( _vcp );\n\t\tconst d6 = _vac.dot( _vcp );\n\t\tif ( d6 >= 0 && d5 <= d6 ) {\n\n\t\t\t// vertex region of C; barycentric coords (0, 0, 1)\n\t\t\treturn target.copy( c );\n\n\t\t}\n\n\t\tconst vb = d5 * d2 - d1 * d6;\n\t\tif ( vb <= 0 && d2 >= 0 && d6 <= 0 ) {\n\n\t\t\tw = d2 / ( d2 - d6 );\n\t\t\t// edge region of AC; barycentric coords (1-w, 0, w)\n\t\t\treturn target.copy( a ).addScaledVector( _vac, w );\n\n\t\t}\n\n\t\tconst va = d3 * d6 - d5 * d4;\n\t\tif ( va <= 0 && ( d4 - d3 ) >= 0 && ( d5 - d6 ) >= 0 ) {\n\n\t\t\t_vbc.subVectors( c, b );\n\t\t\tw = ( d4 - d3 ) / ( ( d4 - d3 ) + ( d5 - d6 ) );\n\t\t\t// edge region of BC; barycentric coords (0, 1-w, w)\n\t\t\treturn target.copy( b ).addScaledVector( _vbc, w ); // edge region of BC\n\n\t\t}\n\n\t\t// face region\n\t\tconst denom = 1 / ( va + vb + vc );\n\t\t// u = va * denom\n\t\tv = vb * denom;\n\t\tw = vc * denom;\n\n\t\treturn target.copy( a ).addScaledVector( _vab, v ).addScaledVector( _vac, w );\n\n\t}\n\n\tequals( triangle ) {\n\n\t\treturn triangle.a.equals( this.a ) && triangle.b.equals( this.b ) && triangle.c.equals( this.c );\n\n\t}\n\n}\n\nlet materialId = 0;\n\nclass Material extends EventDispatcher {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.isMaterial = true;\n\n\t\tObject.defineProperty( this, 'id', { value: materialId ++ } );\n\n\t\tthis.uuid = generateUUID();\n\n\t\tthis.name = '';\n\t\tthis.type = 'Material';\n\n\t\tthis.blending = NormalBlending;\n\t\tthis.side = FrontSide;\n\t\tthis.vertexColors = false;\n\n\t\tthis.opacity = 1;\n\t\tthis.transparent = false;\n\n\t\tthis.blendSrc = SrcAlphaFactor;\n\t\tthis.blendDst = OneMinusSrcAlphaFactor;\n\t\tthis.blendEquation = AddEquation;\n\t\tthis.blendSrcAlpha = null;\n\t\tthis.blendDstAlpha = null;\n\t\tthis.blendEquationAlpha = null;\n\n\t\tthis.depthFunc = LessEqualDepth;\n\t\tthis.depthTest = true;\n\t\tthis.depthWrite = true;\n\n\t\tthis.stencilWriteMask = 0xff;\n\t\tthis.stencilFunc = AlwaysStencilFunc;\n\t\tthis.stencilRef = 0;\n\t\tthis.stencilFuncMask = 0xff;\n\t\tthis.stencilFail = KeepStencilOp;\n\t\tthis.stencilZFail = KeepStencilOp;\n\t\tthis.stencilZPass = KeepStencilOp;\n\t\tthis.stencilWrite = false;\n\n\t\tthis.clippingPlanes = null;\n\t\tthis.clipIntersection = false;\n\t\tthis.clipShadows = false;\n\n\t\tthis.shadowSide = null;\n\n\t\tthis.colorWrite = true;\n\n\t\tthis.precision = null; // override the renderer's default precision for this material\n\n\t\tthis.polygonOffset = false;\n\t\tthis.polygonOffsetFactor = 0;\n\t\tthis.polygonOffsetUnits = 0;\n\n\t\tthis.dithering = false;\n\n\t\tthis.alphaToCoverage = false;\n\t\tthis.premultipliedAlpha = false;\n\n\t\tthis.visible = true;\n\n\t\tthis.toneMapped = true;\n\n\t\tthis.userData = {};\n\n\t\tthis.version = 0;\n\n\t\tthis._alphaTest = 0;\n\n\t}\n\n\tget alphaTest() {\n\n\t\treturn this._alphaTest;\n\n\t}\n\n\tset alphaTest( value ) {\n\n\t\tif ( this._alphaTest > 0 !== value > 0 ) {\n\n\t\t\tthis.version ++;\n\n\t\t}\n\n\t\tthis._alphaTest = value;\n\n\t}\n\n\tonBuild( /* shaderobject, renderer */ ) {}\n\n\tonBeforeRender( /* renderer, scene, camera, geometry, object, group */ ) {}\n\n\tonBeforeCompile( /* shaderobject, renderer */ ) {}\n\n\tcustomProgramCacheKey() {\n\n\t\treturn this.onBeforeCompile.toString();\n\n\t}\n\n\tsetValues( values ) {\n\n\t\tif ( values === undefined ) return;\n\n\t\tfor ( const key in values ) {\n\n\t\t\tconst newValue = values[ key ];\n\n\t\t\tif ( newValue === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.Material: \\'' + key + '\\' parameter is undefined.' );\n\t\t\t\tcontinue;\n\n\t\t\t}\n\n\t\t\tconst currentValue = this[ key ];\n\n\t\t\tif ( currentValue === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.' + this.type + ': \\'' + key + '\\' is not a property of this material.' );\n\t\t\t\tcontinue;\n\n\t\t\t}\n\n\t\t\tif ( currentValue && currentValue.isColor ) {\n\n\t\t\t\tcurrentValue.set( newValue );\n\n\t\t\t} else if ( ( currentValue && currentValue.isVector3 ) && ( newValue && newValue.isVector3 ) ) {\n\n\t\t\t\tcurrentValue.copy( newValue );\n\n\t\t\t} else {\n\n\t\t\t\tthis[ key ] = newValue;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst isRootObject = ( meta === undefined || typeof meta === 'string' );\n\n\t\tif ( isRootObject ) {\n\n\t\t\tmeta = {\n\t\t\t\ttextures: {},\n\t\t\t\timages: {}\n\t\t\t};\n\n\t\t}\n\n\t\tconst data = {\n\t\t\tmetadata: {\n\t\t\t\tversion: 4.5,\n\t\t\t\ttype: 'Material',\n\t\t\t\tgenerator: 'Material.toJSON'\n\t\t\t}\n\t\t};\n\n\t\t// standard Material serialization\n\t\tdata.uuid = this.uuid;\n\t\tdata.type = this.type;\n\n\t\tif ( this.name !== '' ) data.name = this.name;\n\n\t\tif ( this.color && this.color.isColor ) data.color = this.color.getHex();\n\n\t\tif ( this.roughness !== undefined ) data.roughness = this.roughness;\n\t\tif ( this.metalness !== undefined ) data.metalness = this.metalness;\n\n\t\tif ( this.sheen !== undefined ) data.sheen = this.sheen;\n\t\tif ( this.sheenColor && this.sheenColor.isColor ) data.sheenColor = this.sheenColor.getHex();\n\t\tif ( this.sheenRoughness !== undefined ) data.sheenRoughness = this.sheenRoughness;\n\t\tif ( this.emissive && this.emissive.isColor ) data.emissive = this.emissive.getHex();\n\t\tif ( this.emissiveIntensity && this.emissiveIntensity !== 1 ) data.emissiveIntensity = this.emissiveIntensity;\n\n\t\tif ( this.specular && this.specular.isColor ) data.specular = this.specular.getHex();\n\t\tif ( this.specularIntensity !== undefined ) data.specularIntensity = this.specularIntensity;\n\t\tif ( this.specularColor && this.specularColor.isColor ) data.specularColor = this.specularColor.getHex();\n\t\tif ( this.shininess !== undefined ) data.shininess = this.shininess;\n\t\tif ( this.clearcoat !== undefined ) data.clearcoat = this.clearcoat;\n\t\tif ( this.clearcoatRoughness !== undefined ) data.clearcoatRoughness = this.clearcoatRoughness;\n\n\t\tif ( this.clearcoatMap && this.clearcoatMap.isTexture ) {\n\n\t\t\tdata.clearcoatMap = this.clearcoatMap.toJSON( meta ).uuid;\n\n\t\t}\n\n\t\tif ( this.clearcoatRoughnessMap && this.clearcoatRoughnessMap.isTexture ) {\n\n\t\t\tdata.clearcoatRoughnessMap = this.clearcoatRoughnessMap.toJSON( meta ).uuid;\n\n\t\t}\n\n\t\tif ( this.clearcoatNormalMap && this.clearcoatNormalMap.isTexture ) {\n\n\t\t\tdata.clearcoatNormalMap = this.clearcoatNormalMap.toJSON( meta ).uuid;\n\t\t\tdata.clearcoatNormalScale = this.clearcoatNormalScale.toArray();\n\n\t\t}\n\n\t\tif ( this.iridescence !== undefined ) data.iridescence = this.iridescence;\n\t\tif ( this.iridescenceIOR !== undefined ) data.iridescenceIOR = this.iridescenceIOR;\n\t\tif ( this.iridescenceThicknessRange !== undefined ) data.iridescenceThicknessRange = this.iridescenceThicknessRange;\n\n\t\tif ( this.iridescenceMap && this.iridescenceMap.isTexture ) {\n\n\t\t\tdata.iridescenceMap = this.iridescenceMap.toJSON( meta ).uuid;\n\n\t\t}\n\n\t\tif ( this.iridescenceThicknessMap && this.iridescenceThicknessMap.isTexture ) {\n\n\t\t\tdata.iridescenceThicknessMap = this.iridescenceThicknessMap.toJSON( meta ).uuid;\n\n\t\t}\n\n\t\tif ( this.map && this.map.isTexture ) data.map = this.map.toJSON( meta ).uuid;\n\t\tif ( this.matcap && this.matcap.isTexture ) data.matcap = this.matcap.toJSON( meta ).uuid;\n\t\tif ( this.alphaMap && this.alphaMap.isTexture ) data.alphaMap = this.alphaMap.toJSON( meta ).uuid;\n\n\t\tif ( this.lightMap && this.lightMap.isTexture ) {\n\n\t\t\tdata.lightMap = this.lightMap.toJSON( meta ).uuid;\n\t\t\tdata.lightMapIntensity = this.lightMapIntensity;\n\n\t\t}\n\n\t\tif ( this.aoMap && this.aoMap.isTexture ) {\n\n\t\t\tdata.aoMap = this.aoMap.toJSON( meta ).uuid;\n\t\t\tdata.aoMapIntensity = this.aoMapIntensity;\n\n\t\t}\n\n\t\tif ( this.bumpMap && this.bumpMap.isTexture ) {\n\n\t\t\tdata.bumpMap = this.bumpMap.toJSON( meta ).uuid;\n\t\t\tdata.bumpScale = this.bumpScale;\n\n\t\t}\n\n\t\tif ( this.normalMap && this.normalMap.isTexture ) {\n\n\t\t\tdata.normalMap = this.normalMap.toJSON( meta ).uuid;\n\t\t\tdata.normalMapType = this.normalMapType;\n\t\t\tdata.normalScale = this.normalScale.toArray();\n\n\t\t}\n\n\t\tif ( this.displacementMap && this.displacementMap.isTexture ) {\n\n\t\t\tdata.displacementMap = this.displacementMap.toJSON( meta ).uuid;\n\t\t\tdata.displacementScale = this.displacementScale;\n\t\t\tdata.displacementBias = this.displacementBias;\n\n\t\t}\n\n\t\tif ( this.roughnessMap && this.roughnessMap.isTexture ) data.roughnessMap = this.roughnessMap.toJSON( meta ).uuid;\n\t\tif ( this.metalnessMap && this.metalnessMap.isTexture ) data.metalnessMap = this.metalnessMap.toJSON( meta ).uuid;\n\n\t\tif ( this.emissiveMap && this.emissiveMap.isTexture ) data.emissiveMap = this.emissiveMap.toJSON( meta ).uuid;\n\t\tif ( this.specularMap && this.specularMap.isTexture ) data.specularMap = this.specularMap.toJSON( meta ).uuid;\n\t\tif ( this.specularIntensityMap && this.specularIntensityMap.isTexture ) data.specularIntensityMap = this.specularIntensityMap.toJSON( meta ).uuid;\n\t\tif ( this.specularColorMap && this.specularColorMap.isTexture ) data.specularColorMap = this.specularColorMap.toJSON( meta ).uuid;\n\n\t\tif ( this.envMap && this.envMap.isTexture ) {\n\n\t\t\tdata.envMap = this.envMap.toJSON( meta ).uuid;\n\n\t\t\tif ( this.combine !== undefined ) data.combine = this.combine;\n\n\t\t}\n\n\t\tif ( this.envMapIntensity !== undefined ) data.envMapIntensity = this.envMapIntensity;\n\t\tif ( this.reflectivity !== undefined ) data.reflectivity = this.reflectivity;\n\t\tif ( this.refractionRatio !== undefined ) data.refractionRatio = this.refractionRatio;\n\n\t\tif ( this.gradientMap && this.gradientMap.isTexture ) {\n\n\t\t\tdata.gradientMap = this.gradientMap.toJSON( meta ).uuid;\n\n\t\t}\n\n\t\tif ( this.transmission !== undefined ) data.transmission = this.transmission;\n\t\tif ( this.transmissionMap && this.transmissionMap.isTexture ) data.transmissionMap = this.transmissionMap.toJSON( meta ).uuid;\n\t\tif ( this.thickness !== undefined ) data.thickness = this.thickness;\n\t\tif ( this.thicknessMap && this.thicknessMap.isTexture ) data.thicknessMap = this.thicknessMap.toJSON( meta ).uuid;\n\t\tif ( this.attenuationDistance !== undefined && this.attenuationDistance !== Infinity ) data.attenuationDistance = this.attenuationDistance;\n\t\tif ( this.attenuationColor !== undefined ) data.attenuationColor = this.attenuationColor.getHex();\n\n\t\tif ( this.size !== undefined ) data.size = this.size;\n\t\tif ( this.shadowSide !== null ) data.shadowSide = this.shadowSide;\n\t\tif ( this.sizeAttenuation !== undefined ) data.sizeAttenuation = this.sizeAttenuation;\n\n\t\tif ( this.blending !== NormalBlending ) data.blending = this.blending;\n\t\tif ( this.side !== FrontSide ) data.side = this.side;\n\t\tif ( this.vertexColors ) data.vertexColors = true;\n\n\t\tif ( this.opacity < 1 ) data.opacity = this.opacity;\n\t\tif ( this.transparent === true ) data.transparent = this.transparent;\n\n\t\tdata.depthFunc = this.depthFunc;\n\t\tdata.depthTest = this.depthTest;\n\t\tdata.depthWrite = this.depthWrite;\n\t\tdata.colorWrite = this.colorWrite;\n\n\t\tdata.stencilWrite = this.stencilWrite;\n\t\tdata.stencilWriteMask = this.stencilWriteMask;\n\t\tdata.stencilFunc = this.stencilFunc;\n\t\tdata.stencilRef = this.stencilRef;\n\t\tdata.stencilFuncMask = this.stencilFuncMask;\n\t\tdata.stencilFail = this.stencilFail;\n\t\tdata.stencilZFail = this.stencilZFail;\n\t\tdata.stencilZPass = this.stencilZPass;\n\n\t\t// rotation (SpriteMaterial)\n\t\tif ( this.rotation !== undefined && this.rotation !== 0 ) data.rotation = this.rotation;\n\n\t\tif ( this.polygonOffset === true ) data.polygonOffset = true;\n\t\tif ( this.polygonOffsetFactor !== 0 ) data.polygonOffsetFactor = this.polygonOffsetFactor;\n\t\tif ( this.polygonOffsetUnits !== 0 ) data.polygonOffsetUnits = this.polygonOffsetUnits;\n\n\t\tif ( this.linewidth !== undefined && this.linewidth !== 1 ) data.linewidth = this.linewidth;\n\t\tif ( this.dashSize !== undefined ) data.dashSize = this.dashSize;\n\t\tif ( this.gapSize !== undefined ) data.gapSize = this.gapSize;\n\t\tif ( this.scale !== undefined ) data.scale = this.scale;\n\n\t\tif ( this.dithering === true ) data.dithering = true;\n\n\t\tif ( this.alphaTest > 0 ) data.alphaTest = this.alphaTest;\n\t\tif ( this.alphaToCoverage === true ) data.alphaToCoverage = this.alphaToCoverage;\n\t\tif ( this.premultipliedAlpha === true ) data.premultipliedAlpha = this.premultipliedAlpha;\n\n\t\tif ( this.wireframe === true ) data.wireframe = this.wireframe;\n\t\tif ( this.wireframeLinewidth > 1 ) data.wireframeLinewidth = this.wireframeLinewidth;\n\t\tif ( this.wireframeLinecap !== 'round' ) data.wireframeLinecap = this.wireframeLinecap;\n\t\tif ( this.wireframeLinejoin !== 'round' ) data.wireframeLinejoin = this.wireframeLinejoin;\n\n\t\tif ( this.flatShading === true ) data.flatShading = this.flatShading;\n\n\t\tif ( this.visible === false ) data.visible = false;\n\n\t\tif ( this.toneMapped === false ) data.toneMapped = false;\n\n\t\tif ( this.fog === false ) data.fog = false;\n\n\t\tif ( Object.keys( this.userData ).length > 0 ) data.userData = this.userData;\n\n\t\t// TODO: Copied from Object3D.toJSON\n\n\t\tfunction extractFromCache( cache ) {\n\n\t\t\tconst values = [];\n\n\t\t\tfor ( const key in cache ) {\n\n\t\t\t\tconst data = cache[ key ];\n\t\t\t\tdelete data.metadata;\n\t\t\t\tvalues.push( data );\n\n\t\t\t}\n\n\t\t\treturn values;\n\n\t\t}\n\n\t\tif ( isRootObject ) {\n\n\t\t\tconst textures = extractFromCache( meta.textures );\n\t\t\tconst images = extractFromCache( meta.images );\n\n\t\t\tif ( textures.length > 0 ) data.textures = textures;\n\t\t\tif ( images.length > 0 ) data.images = images;\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.name = source.name;\n\n\t\tthis.blending = source.blending;\n\t\tthis.side = source.side;\n\t\tthis.vertexColors = source.vertexColors;\n\n\t\tthis.opacity = source.opacity;\n\t\tthis.transparent = source.transparent;\n\n\t\tthis.blendSrc = source.blendSrc;\n\t\tthis.blendDst = source.blendDst;\n\t\tthis.blendEquation = source.blendEquation;\n\t\tthis.blendSrcAlpha = source.blendSrcAlpha;\n\t\tthis.blendDstAlpha = source.blendDstAlpha;\n\t\tthis.blendEquationAlpha = source.blendEquationAlpha;\n\n\t\tthis.depthFunc = source.depthFunc;\n\t\tthis.depthTest = source.depthTest;\n\t\tthis.depthWrite = source.depthWrite;\n\n\t\tthis.stencilWriteMask = source.stencilWriteMask;\n\t\tthis.stencilFunc = source.stencilFunc;\n\t\tthis.stencilRef = source.stencilRef;\n\t\tthis.stencilFuncMask = source.stencilFuncMask;\n\t\tthis.stencilFail = source.stencilFail;\n\t\tthis.stencilZFail = source.stencilZFail;\n\t\tthis.stencilZPass = source.stencilZPass;\n\t\tthis.stencilWrite = source.stencilWrite;\n\n\t\tconst srcPlanes = source.clippingPlanes;\n\t\tlet dstPlanes = null;\n\n\t\tif ( srcPlanes !== null ) {\n\n\t\t\tconst n = srcPlanes.length;\n\t\t\tdstPlanes = new Array( n );\n\n\t\t\tfor ( let i = 0; i !== n; ++ i ) {\n\n\t\t\t\tdstPlanes[ i ] = srcPlanes[ i ].clone();\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.clippingPlanes = dstPlanes;\n\t\tthis.clipIntersection = source.clipIntersection;\n\t\tthis.clipShadows = source.clipShadows;\n\n\t\tthis.shadowSide = source.shadowSide;\n\n\t\tthis.colorWrite = source.colorWrite;\n\n\t\tthis.precision = source.precision;\n\n\t\tthis.polygonOffset = source.polygonOffset;\n\t\tthis.polygonOffsetFactor = source.polygonOffsetFactor;\n\t\tthis.polygonOffsetUnits = source.polygonOffsetUnits;\n\n\t\tthis.dithering = source.dithering;\n\n\t\tthis.alphaTest = source.alphaTest;\n\t\tthis.alphaToCoverage = source.alphaToCoverage;\n\t\tthis.premultipliedAlpha = source.premultipliedAlpha;\n\n\t\tthis.visible = source.visible;\n\n\t\tthis.toneMapped = source.toneMapped;\n\n\t\tthis.userData = JSON.parse( JSON.stringify( source.userData ) );\n\n\t\treturn this;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t}\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) this.version ++;\n\n\t}\n\n}\n\nclass MeshBasicMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshBasicMaterial = true;\n\n\t\tthis.type = 'MeshBasicMaterial';\n\n\t\tthis.color = new Color( 0xffffff ); // emissive\n\n\t\tthis.map = null;\n\n\t\tthis.lightMap = null;\n\t\tthis.lightMapIntensity = 1.0;\n\n\t\tthis.aoMap = null;\n\t\tthis.aoMapIntensity = 1.0;\n\n\t\tthis.specularMap = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.envMap = null;\n\t\tthis.combine = MultiplyOperation;\n\t\tthis.reflectivity = 1;\n\t\tthis.refractionRatio = 0.98;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\t\tthis.wireframeLinecap = 'round';\n\t\tthis.wireframeLinejoin = 'round';\n\n\t\tthis.fog = true;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\n\t\tthis.map = source.map;\n\n\t\tthis.lightMap = source.lightMap;\n\t\tthis.lightMapIntensity = source.lightMapIntensity;\n\n\t\tthis.aoMap = source.aoMap;\n\t\tthis.aoMapIntensity = source.aoMapIntensity;\n\n\t\tthis.specularMap = source.specularMap;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.envMap = source.envMap;\n\t\tthis.combine = source.combine;\n\t\tthis.reflectivity = source.reflectivity;\n\t\tthis.refractionRatio = source.refractionRatio;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\t\tthis.wireframeLinecap = source.wireframeLinecap;\n\t\tthis.wireframeLinejoin = source.wireframeLinejoin;\n\n\t\tthis.fog = source.fog;\n\n\t\treturn this;\n\n\t}\n\n}\n\nconst _vector$9 = /*@__PURE__*/ new Vector3();\nconst _vector2$1 = /*@__PURE__*/ new Vector2();\n\nclass BufferAttribute {\n\n\tconstructor( array, itemSize, normalized = false ) {\n\n\t\tif ( Array.isArray( array ) ) {\n\n\t\t\tthrow new TypeError( 'THREE.BufferAttribute: array should be a Typed Array.' );\n\n\t\t}\n\n\t\tthis.isBufferAttribute = true;\n\n\t\tthis.name = '';\n\n\t\tthis.array = array;\n\t\tthis.itemSize = itemSize;\n\t\tthis.count = array !== undefined ? array.length / itemSize : 0;\n\t\tthis.normalized = normalized;\n\n\t\tthis.usage = StaticDrawUsage;\n\t\tthis.updateRange = { offset: 0, count: - 1 };\n\n\t\tthis.version = 0;\n\n\t}\n\n\tonUploadCallback() {}\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) this.version ++;\n\n\t}\n\n\tsetUsage( value ) {\n\n\t\tthis.usage = value;\n\n\t\treturn this;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.name = source.name;\n\t\tthis.array = new source.array.constructor( source.array );\n\t\tthis.itemSize = source.itemSize;\n\t\tthis.count = source.count;\n\t\tthis.normalized = source.normalized;\n\n\t\tthis.usage = source.usage;\n\n\t\treturn this;\n\n\t}\n\n\tcopyAt( index1, attribute, index2 ) {\n\n\t\tindex1 *= this.itemSize;\n\t\tindex2 *= attribute.itemSize;\n\n\t\tfor ( let i = 0, l = this.itemSize; i < l; i ++ ) {\n\n\t\t\tthis.array[ index1 + i ] = attribute.array[ index2 + i ];\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tcopyArray( array ) {\n\n\t\tthis.array.set( array );\n\n\t\treturn this;\n\n\t}\n\n\tapplyMatrix3( m ) {\n\n\t\tif ( this.itemSize === 2 ) {\n\n\t\t\tfor ( let i = 0, l = this.count; i < l; i ++ ) {\n\n\t\t\t\t_vector2$1.fromBufferAttribute( this, i );\n\t\t\t\t_vector2$1.applyMatrix3( m );\n\n\t\t\t\tthis.setXY( i, _vector2$1.x, _vector2$1.y );\n\n\t\t\t}\n\n\t\t} else if ( this.itemSize === 3 ) {\n\n\t\t\tfor ( let i = 0, l = this.count; i < l; i ++ ) {\n\n\t\t\t\t_vector$9.fromBufferAttribute( this, i );\n\t\t\t\t_vector$9.applyMatrix3( m );\n\n\t\t\t\tthis.setXYZ( i, _vector$9.x, _vector$9.y, _vector$9.z );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tapplyMatrix4( m ) {\n\n\t\tfor ( let i = 0, l = this.count; i < l; i ++ ) {\n\n\t\t\t_vector$9.fromBufferAttribute( this, i );\n\n\t\t\t_vector$9.applyMatrix4( m );\n\n\t\t\tthis.setXYZ( i, _vector$9.x, _vector$9.y, _vector$9.z );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tapplyNormalMatrix( m ) {\n\n\t\tfor ( let i = 0, l = this.count; i < l; i ++ ) {\n\n\t\t\t_vector$9.fromBufferAttribute( this, i );\n\n\t\t\t_vector$9.applyNormalMatrix( m );\n\n\t\t\tthis.setXYZ( i, _vector$9.x, _vector$9.y, _vector$9.z );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\ttransformDirection( m ) {\n\n\t\tfor ( let i = 0, l = this.count; i < l; i ++ ) {\n\n\t\t\t_vector$9.fromBufferAttribute( this, i );\n\n\t\t\t_vector$9.transformDirection( m );\n\n\t\t\tthis.setXYZ( i, _vector$9.x, _vector$9.y, _vector$9.z );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tset( value, offset = 0 ) {\n\n\t\t// Matching BufferAttribute constructor, do not normalize the array.\n\t\tthis.array.set( value, offset );\n\n\t\treturn this;\n\n\t}\n\n\tgetX( index ) {\n\n\t\tlet x = this.array[ index * this.itemSize ];\n\n\t\tif ( this.normalized ) x = denormalize( x, this.array );\n\n\t\treturn x;\n\n\t}\n\n\tsetX( index, x ) {\n\n\t\tif ( this.normalized ) x = normalize( x, this.array );\n\n\t\tthis.array[ index * this.itemSize ] = x;\n\n\t\treturn this;\n\n\t}\n\n\tgetY( index ) {\n\n\t\tlet y = this.array[ index * this.itemSize + 1 ];\n\n\t\tif ( this.normalized ) y = denormalize( y, this.array );\n\n\t\treturn y;\n\n\t}\n\n\tsetY( index, y ) {\n\n\t\tif ( this.normalized ) y = normalize( y, this.array );\n\n\t\tthis.array[ index * this.itemSize + 1 ] = y;\n\n\t\treturn this;\n\n\t}\n\n\tgetZ( index ) {\n\n\t\tlet z = this.array[ index * this.itemSize + 2 ];\n\n\t\tif ( this.normalized ) z = denormalize( z, this.array );\n\n\t\treturn z;\n\n\t}\n\n\tsetZ( index, z ) {\n\n\t\tif ( this.normalized ) z = normalize( z, this.array );\n\n\t\tthis.array[ index * this.itemSize + 2 ] = z;\n\n\t\treturn this;\n\n\t}\n\n\tgetW( index ) {\n\n\t\tlet w = this.array[ index * this.itemSize + 3 ];\n\n\t\tif ( this.normalized ) w = denormalize( w, this.array );\n\n\t\treturn w;\n\n\t}\n\n\tsetW( index, w ) {\n\n\t\tif ( this.normalized ) w = normalize( w, this.array );\n\n\t\tthis.array[ index * this.itemSize + 3 ] = w;\n\n\t\treturn this;\n\n\t}\n\n\tsetXY( index, x, y ) {\n\n\t\tindex *= this.itemSize;\n\n\t\tif ( this.normalized ) {\n\n\t\t\tx = normalize( x, this.array );\n\t\t\ty = normalize( y, this.array );\n\n\t\t}\n\n\t\tthis.array[ index + 0 ] = x;\n\t\tthis.array[ index + 1 ] = y;\n\n\t\treturn this;\n\n\t}\n\n\tsetXYZ( index, x, y, z ) {\n\n\t\tindex *= this.itemSize;\n\n\t\tif ( this.normalized ) {\n\n\t\t\tx = normalize( x, this.array );\n\t\t\ty = normalize( y, this.array );\n\t\t\tz = normalize( z, this.array );\n\n\t\t}\n\n\t\tthis.array[ index + 0 ] = x;\n\t\tthis.array[ index + 1 ] = y;\n\t\tthis.array[ index + 2 ] = z;\n\n\t\treturn this;\n\n\t}\n\n\tsetXYZW( index, x, y, z, w ) {\n\n\t\tindex *= this.itemSize;\n\n\t\tif ( this.normalized ) {\n\n\t\t\tx = normalize( x, this.array );\n\t\t\ty = normalize( y, this.array );\n\t\t\tz = normalize( z, this.array );\n\t\t\tw = normalize( w, this.array );\n\n\t\t}\n\n\t\tthis.array[ index + 0 ] = x;\n\t\tthis.array[ index + 1 ] = y;\n\t\tthis.array[ index + 2 ] = z;\n\t\tthis.array[ index + 3 ] = w;\n\n\t\treturn this;\n\n\t}\n\n\tonUpload( callback ) {\n\n\t\tthis.onUploadCallback = callback;\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this.array, this.itemSize ).copy( this );\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = {\n\t\t\titemSize: this.itemSize,\n\t\t\ttype: this.array.constructor.name,\n\t\t\tarray: Array.from( this.array ),\n\t\t\tnormalized: this.normalized\n\t\t};\n\n\t\tif ( this.name !== '' ) data.name = this.name;\n\t\tif ( this.usage !== StaticDrawUsage ) data.usage = this.usage;\n\t\tif ( this.updateRange.offset !== 0 || this.updateRange.count !== - 1 ) data.updateRange = this.updateRange;\n\n\t\treturn data;\n\n\t}\n\n\t// @deprecated\n\n\tcopyColorsArray() {\n\n\t\tconsole.error( 'THREE.BufferAttribute: copyColorsArray() was removed in r144.' );\n\n\t}\n\n\tcopyVector2sArray() {\n\n\t\tconsole.error( 'THREE.BufferAttribute: copyVector2sArray() was removed in r144.' );\n\n\t}\n\n\tcopyVector3sArray() {\n\n\t\tconsole.error( 'THREE.BufferAttribute: copyVector3sArray() was removed in r144.' );\n\n\t}\n\n\tcopyVector4sArray() {\n\n\t\tconsole.error( 'THREE.BufferAttribute: copyVector4sArray() was removed in r144.' );\n\n\t}\n\n}\n\n//\n\nclass Int8BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Int8Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\nclass Uint8BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Uint8Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\nclass Uint8ClampedBufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Uint8ClampedArray( array ), itemSize, normalized );\n\n\t}\n\n}\n\nclass Int16BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Int16Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\nclass Uint16BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Uint16Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\nclass Int32BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Int32Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\nclass Uint32BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Uint32Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\nclass Float16BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Uint16Array( array ), itemSize, normalized );\n\n\t\tthis.isFloat16BufferAttribute = true;\n\n\t}\n\n}\n\n\nclass Float32BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Float32Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\nclass Float64BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Float64Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\nlet _id$1 = 0;\n\nconst _m1 = /*@__PURE__*/ new Matrix4();\nconst _obj = /*@__PURE__*/ new Object3D();\nconst _offset = /*@__PURE__*/ new Vector3();\nconst _box$1 = /*@__PURE__*/ new Box3();\nconst _boxMorphTargets = /*@__PURE__*/ new Box3();\nconst _vector$8 = /*@__PURE__*/ new Vector3();\n\nclass BufferGeometry extends EventDispatcher {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.isBufferGeometry = true;\n\n\t\tObject.defineProperty( this, 'id', { value: _id$1 ++ } );\n\n\t\tthis.uuid = generateUUID();\n\n\t\tthis.name = '';\n\t\tthis.type = 'BufferGeometry';\n\n\t\tthis.index = null;\n\t\tthis.attributes = {};\n\n\t\tthis.morphAttributes = {};\n\t\tthis.morphTargetsRelative = false;\n\n\t\tthis.groups = [];\n\n\t\tthis.boundingBox = null;\n\t\tthis.boundingSphere = null;\n\n\t\tthis.drawRange = { start: 0, count: Infinity };\n\n\t\tthis.userData = {};\n\n\t}\n\n\tgetIndex() {\n\n\t\treturn this.index;\n\n\t}\n\n\tsetIndex( index ) {\n\n\t\tif ( Array.isArray( index ) ) {\n\n\t\t\tthis.index = new ( arrayNeedsUint32( index ) ? Uint32BufferAttribute : Uint16BufferAttribute )( index, 1 );\n\n\t\t} else {\n\n\t\t\tthis.index = index;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tgetAttribute( name ) {\n\n\t\treturn this.attributes[ name ];\n\n\t}\n\n\tsetAttribute( name, attribute ) {\n\n\t\tthis.attributes[ name ] = attribute;\n\n\t\treturn this;\n\n\t}\n\n\tdeleteAttribute( name ) {\n\n\t\tdelete this.attributes[ name ];\n\n\t\treturn this;\n\n\t}\n\n\thasAttribute( name ) {\n\n\t\treturn this.attributes[ name ] !== undefined;\n\n\t}\n\n\taddGroup( start, count, materialIndex = 0 ) {\n\n\t\tthis.groups.push( {\n\n\t\t\tstart: start,\n\t\t\tcount: count,\n\t\t\tmaterialIndex: materialIndex\n\n\t\t} );\n\n\t}\n\n\tclearGroups() {\n\n\t\tthis.groups = [];\n\n\t}\n\n\tsetDrawRange( start, count ) {\n\n\t\tthis.drawRange.start = start;\n\t\tthis.drawRange.count = count;\n\n\t}\n\n\tapplyMatrix4( matrix ) {\n\n\t\tconst position = this.attributes.position;\n\n\t\tif ( position !== undefined ) {\n\n\t\t\tposition.applyMatrix4( matrix );\n\n\t\t\tposition.needsUpdate = true;\n\n\t\t}\n\n\t\tconst normal = this.attributes.normal;\n\n\t\tif ( normal !== undefined ) {\n\n\t\t\tconst normalMatrix = new Matrix3().getNormalMatrix( matrix );\n\n\t\t\tnormal.applyNormalMatrix( normalMatrix );\n\n\t\t\tnormal.needsUpdate = true;\n\n\t\t}\n\n\t\tconst tangent = this.attributes.tangent;\n\n\t\tif ( tangent !== undefined ) {\n\n\t\t\ttangent.transformDirection( matrix );\n\n\t\t\ttangent.needsUpdate = true;\n\n\t\t}\n\n\t\tif ( this.boundingBox !== null ) {\n\n\t\t\tthis.computeBoundingBox();\n\n\t\t}\n\n\t\tif ( this.boundingSphere !== null ) {\n\n\t\t\tthis.computeBoundingSphere();\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tapplyQuaternion( q ) {\n\n\t\t_m1.makeRotationFromQuaternion( q );\n\n\t\tthis.applyMatrix4( _m1 );\n\n\t\treturn this;\n\n\t}\n\n\trotateX( angle ) {\n\n\t\t// rotate geometry around world x-axis\n\n\t\t_m1.makeRotationX( angle );\n\n\t\tthis.applyMatrix4( _m1 );\n\n\t\treturn this;\n\n\t}\n\n\trotateY( angle ) {\n\n\t\t// rotate geometry around world y-axis\n\n\t\t_m1.makeRotationY( angle );\n\n\t\tthis.applyMatrix4( _m1 );\n\n\t\treturn this;\n\n\t}\n\n\trotateZ( angle ) {\n\n\t\t// rotate geometry around world z-axis\n\n\t\t_m1.makeRotationZ( angle );\n\n\t\tthis.applyMatrix4( _m1 );\n\n\t\treturn this;\n\n\t}\n\n\ttranslate( x, y, z ) {\n\n\t\t// translate geometry\n\n\t\t_m1.makeTranslation( x, y, z );\n\n\t\tthis.applyMatrix4( _m1 );\n\n\t\treturn this;\n\n\t}\n\n\tscale( x, y, z ) {\n\n\t\t// scale geometry\n\n\t\t_m1.makeScale( x, y, z );\n\n\t\tthis.applyMatrix4( _m1 );\n\n\t\treturn this;\n\n\t}\n\n\tlookAt( vector ) {\n\n\t\t_obj.lookAt( vector );\n\n\t\t_obj.updateMatrix();\n\n\t\tthis.applyMatrix4( _obj.matrix );\n\n\t\treturn this;\n\n\t}\n\n\tcenter() {\n\n\t\tthis.computeBoundingBox();\n\n\t\tthis.boundingBox.getCenter( _offset ).negate();\n\n\t\tthis.translate( _offset.x, _offset.y, _offset.z );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromPoints( points ) {\n\n\t\tconst position = [];\n\n\t\tfor ( let i = 0, l = points.length; i < l; i ++ ) {\n\n\t\t\tconst point = points[ i ];\n\t\t\tposition.push( point.x, point.y, point.z || 0 );\n\n\t\t}\n\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( position, 3 ) );\n\n\t\treturn this;\n\n\t}\n\n\tcomputeBoundingBox() {\n\n\t\tif ( this.boundingBox === null ) {\n\n\t\t\tthis.boundingBox = new Box3();\n\n\t\t}\n\n\t\tconst position = this.attributes.position;\n\t\tconst morphAttributesPosition = this.morphAttributes.position;\n\n\t\tif ( position && position.isGLBufferAttribute ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set \"mesh.frustumCulled\" to \"false\".', this );\n\n\t\t\tthis.boundingBox.set(\n\t\t\t\tnew Vector3( - Infinity, - Infinity, - Infinity ),\n\t\t\t\tnew Vector3( + Infinity, + Infinity, + Infinity )\n\t\t\t);\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( position !== undefined ) {\n\n\t\t\tthis.boundingBox.setFromBufferAttribute( position );\n\n\t\t\t// process morph attributes if present\n\n\t\t\tif ( morphAttributesPosition ) {\n\n\t\t\t\tfor ( let i = 0, il = morphAttributesPosition.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst morphAttribute = morphAttributesPosition[ i ];\n\t\t\t\t\t_box$1.setFromBufferAttribute( morphAttribute );\n\n\t\t\t\t\tif ( this.morphTargetsRelative ) {\n\n\t\t\t\t\t\t_vector$8.addVectors( this.boundingBox.min, _box$1.min );\n\t\t\t\t\t\tthis.boundingBox.expandByPoint( _vector$8 );\n\n\t\t\t\t\t\t_vector$8.addVectors( this.boundingBox.max, _box$1.max );\n\t\t\t\t\t\tthis.boundingBox.expandByPoint( _vector$8 );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tthis.boundingBox.expandByPoint( _box$1.min );\n\t\t\t\t\t\tthis.boundingBox.expandByPoint( _box$1.max );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tthis.boundingBox.makeEmpty();\n\n\t\t}\n\n\t\tif ( isNaN( this.boundingBox.min.x ) || isNaN( this.boundingBox.min.y ) || isNaN( this.boundingBox.min.z ) ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The \"position\" attribute is likely to have NaN values.', this );\n\n\t\t}\n\n\t}\n\n\tcomputeBoundingSphere() {\n\n\t\tif ( this.boundingSphere === null ) {\n\n\t\t\tthis.boundingSphere = new Sphere();\n\n\t\t}\n\n\t\tconst position = this.attributes.position;\n\t\tconst morphAttributesPosition = this.morphAttributes.position;\n\n\t\tif ( position && position.isGLBufferAttribute ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set \"mesh.frustumCulled\" to \"false\".', this );\n\n\t\t\tthis.boundingSphere.set( new Vector3(), Infinity );\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( position ) {\n\n\t\t\t// first, find the center of the bounding sphere\n\n\t\t\tconst center = this.boundingSphere.center;\n\n\t\t\t_box$1.setFromBufferAttribute( position );\n\n\t\t\t// process morph attributes if present\n\n\t\t\tif ( morphAttributesPosition ) {\n\n\t\t\t\tfor ( let i = 0, il = morphAttributesPosition.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst morphAttribute = morphAttributesPosition[ i ];\n\t\t\t\t\t_boxMorphTargets.setFromBufferAttribute( morphAttribute );\n\n\t\t\t\t\tif ( this.morphTargetsRelative ) {\n\n\t\t\t\t\t\t_vector$8.addVectors( _box$1.min, _boxMorphTargets.min );\n\t\t\t\t\t\t_box$1.expandByPoint( _vector$8 );\n\n\t\t\t\t\t\t_vector$8.addVectors( _box$1.max, _boxMorphTargets.max );\n\t\t\t\t\t\t_box$1.expandByPoint( _vector$8 );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t_box$1.expandByPoint( _boxMorphTargets.min );\n\t\t\t\t\t\t_box$1.expandByPoint( _boxMorphTargets.max );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t_box$1.getCenter( center );\n\n\t\t\t// second, try to find a boundingSphere with a radius smaller than the\n\t\t\t// boundingSphere of the boundingBox: sqrt(3) smaller in the best case\n\n\t\t\tlet maxRadiusSq = 0;\n\n\t\t\tfor ( let i = 0, il = position.count; i < il; i ++ ) {\n\n\t\t\t\t_vector$8.fromBufferAttribute( position, i );\n\n\t\t\t\tmaxRadiusSq = Math.max( maxRadiusSq, center.distanceToSquared( _vector$8 ) );\n\n\t\t\t}\n\n\t\t\t// process morph attributes if present\n\n\t\t\tif ( morphAttributesPosition ) {\n\n\t\t\t\tfor ( let i = 0, il = morphAttributesPosition.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst morphAttribute = morphAttributesPosition[ i ];\n\t\t\t\t\tconst morphTargetsRelative = this.morphTargetsRelative;\n\n\t\t\t\t\tfor ( let j = 0, jl = morphAttribute.count; j < jl; j ++ ) {\n\n\t\t\t\t\t\t_vector$8.fromBufferAttribute( morphAttribute, j );\n\n\t\t\t\t\t\tif ( morphTargetsRelative ) {\n\n\t\t\t\t\t\t\t_offset.fromBufferAttribute( position, j );\n\t\t\t\t\t\t\t_vector$8.add( _offset );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tmaxRadiusSq = Math.max( maxRadiusSq, center.distanceToSquared( _vector$8 ) );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis.boundingSphere.radius = Math.sqrt( maxRadiusSq );\n\n\t\t\tif ( isNaN( this.boundingSphere.radius ) ) {\n\n\t\t\t\tconsole.error( 'THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The \"position\" attribute is likely to have NaN values.', this );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tcomputeTangents() {\n\n\t\tconst index = this.index;\n\t\tconst attributes = this.attributes;\n\n\t\t// based on http://www.terathon.com/code/tangent.html\n\t\t// (per vertex tangents)\n\n\t\tif ( index === null ||\n\t\t\t attributes.position === undefined ||\n\t\t\t attributes.normal === undefined ||\n\t\t\t attributes.uv === undefined ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tconst indices = index.array;\n\t\tconst positions = attributes.position.array;\n\t\tconst normals = attributes.normal.array;\n\t\tconst uvs = attributes.uv.array;\n\n\t\tconst nVertices = positions.length / 3;\n\n\t\tif ( this.hasAttribute( 'tangent' ) === false ) {\n\n\t\t\tthis.setAttribute( 'tangent', new BufferAttribute( new Float32Array( 4 * nVertices ), 4 ) );\n\n\t\t}\n\n\t\tconst tangents = this.getAttribute( 'tangent' ).array;\n\n\t\tconst tan1 = [], tan2 = [];\n\n\t\tfor ( let i = 0; i < nVertices; i ++ ) {\n\n\t\t\ttan1[ i ] = new Vector3();\n\t\t\ttan2[ i ] = new Vector3();\n\n\t\t}\n\n\t\tconst vA = new Vector3(),\n\t\t\tvB = new Vector3(),\n\t\t\tvC = new Vector3(),\n\n\t\t\tuvA = new Vector2(),\n\t\t\tuvB = new Vector2(),\n\t\t\tuvC = new Vector2(),\n\n\t\t\tsdir = new Vector3(),\n\t\t\ttdir = new Vector3();\n\n\t\tfunction handleTriangle( a, b, c ) {\n\n\t\t\tvA.fromArray( positions, a * 3 );\n\t\t\tvB.fromArray( positions, b * 3 );\n\t\t\tvC.fromArray( positions, c * 3 );\n\n\t\t\tuvA.fromArray( uvs, a * 2 );\n\t\t\tuvB.fromArray( uvs, b * 2 );\n\t\t\tuvC.fromArray( uvs, c * 2 );\n\n\t\t\tvB.sub( vA );\n\t\t\tvC.sub( vA );\n\n\t\t\tuvB.sub( uvA );\n\t\t\tuvC.sub( uvA );\n\n\t\t\tconst r = 1.0 / ( uvB.x * uvC.y - uvC.x * uvB.y );\n\n\t\t\t// silently ignore degenerate uv triangles having coincident or colinear vertices\n\n\t\t\tif ( ! isFinite( r ) ) return;\n\n\t\t\tsdir.copy( vB ).multiplyScalar( uvC.y ).addScaledVector( vC, - uvB.y ).multiplyScalar( r );\n\t\t\ttdir.copy( vC ).multiplyScalar( uvB.x ).addScaledVector( vB, - uvC.x ).multiplyScalar( r );\n\n\t\t\ttan1[ a ].add( sdir );\n\t\t\ttan1[ b ].add( sdir );\n\t\t\ttan1[ c ].add( sdir );\n\n\t\t\ttan2[ a ].add( tdir );\n\t\t\ttan2[ b ].add( tdir );\n\t\t\ttan2[ c ].add( tdir );\n\n\t\t}\n\n\t\tlet groups = this.groups;\n\n\t\tif ( groups.length === 0 ) {\n\n\t\t\tgroups = [ {\n\t\t\t\tstart: 0,\n\t\t\t\tcount: indices.length\n\t\t\t} ];\n\n\t\t}\n\n\t\tfor ( let i = 0, il = groups.length; i < il; ++ i ) {\n\n\t\t\tconst group = groups[ i ];\n\n\t\t\tconst start = group.start;\n\t\t\tconst count = group.count;\n\n\t\t\tfor ( let j = start, jl = start + count; j < jl; j += 3 ) {\n\n\t\t\t\thandleTriangle(\n\t\t\t\t\tindices[ j + 0 ],\n\t\t\t\t\tindices[ j + 1 ],\n\t\t\t\t\tindices[ j + 2 ]\n\t\t\t\t);\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst tmp = new Vector3(), tmp2 = new Vector3();\n\t\tconst n = new Vector3(), n2 = new Vector3();\n\n\t\tfunction handleVertex( v ) {\n\n\t\t\tn.fromArray( normals, v * 3 );\n\t\t\tn2.copy( n );\n\n\t\t\tconst t = tan1[ v ];\n\n\t\t\t// Gram-Schmidt orthogonalize\n\n\t\t\ttmp.copy( t );\n\t\t\ttmp.sub( n.multiplyScalar( n.dot( t ) ) ).normalize();\n\n\t\t\t// Calculate handedness\n\n\t\t\ttmp2.crossVectors( n2, t );\n\t\t\tconst test = tmp2.dot( tan2[ v ] );\n\t\t\tconst w = ( test < 0.0 ) ? - 1.0 : 1.0;\n\n\t\t\ttangents[ v * 4 ] = tmp.x;\n\t\t\ttangents[ v * 4 + 1 ] = tmp.y;\n\t\t\ttangents[ v * 4 + 2 ] = tmp.z;\n\t\t\ttangents[ v * 4 + 3 ] = w;\n\n\t\t}\n\n\t\tfor ( let i = 0, il = groups.length; i < il; ++ i ) {\n\n\t\t\tconst group = groups[ i ];\n\n\t\t\tconst start = group.start;\n\t\t\tconst count = group.count;\n\n\t\t\tfor ( let j = start, jl = start + count; j < jl; j += 3 ) {\n\n\t\t\t\thandleVertex( indices[ j + 0 ] );\n\t\t\t\thandleVertex( indices[ j + 1 ] );\n\t\t\t\thandleVertex( indices[ j + 2 ] );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tcomputeVertexNormals() {\n\n\t\tconst index = this.index;\n\t\tconst positionAttribute = this.getAttribute( 'position' );\n\n\t\tif ( positionAttribute !== undefined ) {\n\n\t\t\tlet normalAttribute = this.getAttribute( 'normal' );\n\n\t\t\tif ( normalAttribute === undefined ) {\n\n\t\t\t\tnormalAttribute = new BufferAttribute( new Float32Array( positionAttribute.count * 3 ), 3 );\n\t\t\t\tthis.setAttribute( 'normal', normalAttribute );\n\n\t\t\t} else {\n\n\t\t\t\t// reset existing normals to zero\n\n\t\t\t\tfor ( let i = 0, il = normalAttribute.count; i < il; i ++ ) {\n\n\t\t\t\t\tnormalAttribute.setXYZ( i, 0, 0, 0 );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tconst pA = new Vector3(), pB = new Vector3(), pC = new Vector3();\n\t\t\tconst nA = new Vector3(), nB = new Vector3(), nC = new Vector3();\n\t\t\tconst cb = new Vector3(), ab = new Vector3();\n\n\t\t\t// indexed elements\n\n\t\t\tif ( index ) {\n\n\t\t\t\tfor ( let i = 0, il = index.count; i < il; i += 3 ) {\n\n\t\t\t\t\tconst vA = index.getX( i + 0 );\n\t\t\t\t\tconst vB = index.getX( i + 1 );\n\t\t\t\t\tconst vC = index.getX( i + 2 );\n\n\t\t\t\t\tpA.fromBufferAttribute( positionAttribute, vA );\n\t\t\t\t\tpB.fromBufferAttribute( positionAttribute, vB );\n\t\t\t\t\tpC.fromBufferAttribute( positionAttribute, vC );\n\n\t\t\t\t\tcb.subVectors( pC, pB );\n\t\t\t\t\tab.subVectors( pA, pB );\n\t\t\t\t\tcb.cross( ab );\n\n\t\t\t\t\tnA.fromBufferAttribute( normalAttribute, vA );\n\t\t\t\t\tnB.fromBufferAttribute( normalAttribute, vB );\n\t\t\t\t\tnC.fromBufferAttribute( normalAttribute, vC );\n\n\t\t\t\t\tnA.add( cb );\n\t\t\t\t\tnB.add( cb );\n\t\t\t\t\tnC.add( cb );\n\n\t\t\t\t\tnormalAttribute.setXYZ( vA, nA.x, nA.y, nA.z );\n\t\t\t\t\tnormalAttribute.setXYZ( vB, nB.x, nB.y, nB.z );\n\t\t\t\t\tnormalAttribute.setXYZ( vC, nC.x, nC.y, nC.z );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t// non-indexed elements (unconnected triangle soup)\n\n\t\t\t\tfor ( let i = 0, il = positionAttribute.count; i < il; i += 3 ) {\n\n\t\t\t\t\tpA.fromBufferAttribute( positionAttribute, i + 0 );\n\t\t\t\t\tpB.fromBufferAttribute( positionAttribute, i + 1 );\n\t\t\t\t\tpC.fromBufferAttribute( positionAttribute, i + 2 );\n\n\t\t\t\t\tcb.subVectors( pC, pB );\n\t\t\t\t\tab.subVectors( pA, pB );\n\t\t\t\t\tcb.cross( ab );\n\n\t\t\t\t\tnormalAttribute.setXYZ( i + 0, cb.x, cb.y, cb.z );\n\t\t\t\t\tnormalAttribute.setXYZ( i + 1, cb.x, cb.y, cb.z );\n\t\t\t\t\tnormalAttribute.setXYZ( i + 2, cb.x, cb.y, cb.z );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis.normalizeNormals();\n\n\t\t\tnormalAttribute.needsUpdate = true;\n\n\t\t}\n\n\t}\n\n\t// @deprecated since r144\n\n\tmerge() {\n\n\t\tconsole.error( 'THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead.' );\n\t\treturn this;\n\n\t}\n\n\tnormalizeNormals() {\n\n\t\tconst normals = this.attributes.normal;\n\n\t\tfor ( let i = 0, il = normals.count; i < il; i ++ ) {\n\n\t\t\t_vector$8.fromBufferAttribute( normals, i );\n\n\t\t\t_vector$8.normalize();\n\n\t\t\tnormals.setXYZ( i, _vector$8.x, _vector$8.y, _vector$8.z );\n\n\t\t}\n\n\t}\n\n\ttoNonIndexed() {\n\n\t\tfunction convertBufferAttribute( attribute, indices ) {\n\n\t\t\tconst array = attribute.array;\n\t\t\tconst itemSize = attribute.itemSize;\n\t\t\tconst normalized = attribute.normalized;\n\n\t\t\tconst array2 = new array.constructor( indices.length * itemSize );\n\n\t\t\tlet index = 0, index2 = 0;\n\n\t\t\tfor ( let i = 0, l = indices.length; i < l; i ++ ) {\n\n\t\t\t\tif ( attribute.isInterleavedBufferAttribute ) {\n\n\t\t\t\t\tindex = indices[ i ] * attribute.data.stride + attribute.offset;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tindex = indices[ i ] * itemSize;\n\n\t\t\t\t}\n\n\t\t\t\tfor ( let j = 0; j < itemSize; j ++ ) {\n\n\t\t\t\t\tarray2[ index2 ++ ] = array[ index ++ ];\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn new BufferAttribute( array2, itemSize, normalized );\n\n\t\t}\n\n\t\t//\n\n\t\tif ( this.index === null ) {\n\n\t\t\tconsole.warn( 'THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed.' );\n\t\t\treturn this;\n\n\t\t}\n\n\t\tconst geometry2 = new BufferGeometry();\n\n\t\tconst indices = this.index.array;\n\t\tconst attributes = this.attributes;\n\n\t\t// attributes\n\n\t\tfor ( const name in attributes ) {\n\n\t\t\tconst attribute = attributes[ name ];\n\n\t\t\tconst newAttribute = convertBufferAttribute( attribute, indices );\n\n\t\t\tgeometry2.setAttribute( name, newAttribute );\n\n\t\t}\n\n\t\t// morph attributes\n\n\t\tconst morphAttributes = this.morphAttributes;\n\n\t\tfor ( const name in morphAttributes ) {\n\n\t\t\tconst morphArray = [];\n\t\t\tconst morphAttribute = morphAttributes[ name ]; // morphAttribute: array of Float32BufferAttributes\n\n\t\t\tfor ( let i = 0, il = morphAttribute.length; i < il; i ++ ) {\n\n\t\t\t\tconst attribute = morphAttribute[ i ];\n\n\t\t\t\tconst newAttribute = convertBufferAttribute( attribute, indices );\n\n\t\t\t\tmorphArray.push( newAttribute );\n\n\t\t\t}\n\n\t\t\tgeometry2.morphAttributes[ name ] = morphArray;\n\n\t\t}\n\n\t\tgeometry2.morphTargetsRelative = this.morphTargetsRelative;\n\n\t\t// groups\n\n\t\tconst groups = this.groups;\n\n\t\tfor ( let i = 0, l = groups.length; i < l; i ++ ) {\n\n\t\t\tconst group = groups[ i ];\n\t\t\tgeometry2.addGroup( group.start, group.count, group.materialIndex );\n\n\t\t}\n\n\t\treturn geometry2;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = {\n\t\t\tmetadata: {\n\t\t\t\tversion: 4.5,\n\t\t\t\ttype: 'BufferGeometry',\n\t\t\t\tgenerator: 'BufferGeometry.toJSON'\n\t\t\t}\n\t\t};\n\n\t\t// standard BufferGeometry serialization\n\n\t\tdata.uuid = this.uuid;\n\t\tdata.type = this.type;\n\t\tif ( this.name !== '' ) data.name = this.name;\n\t\tif ( Object.keys( this.userData ).length > 0 ) data.userData = this.userData;\n\n\t\tif ( this.parameters !== undefined ) {\n\n\t\t\tconst parameters = this.parameters;\n\n\t\t\tfor ( const key in parameters ) {\n\n\t\t\t\tif ( parameters[ key ] !== undefined ) data[ key ] = parameters[ key ];\n\n\t\t\t}\n\n\t\t\treturn data;\n\n\t\t}\n\n\t\t// for simplicity the code assumes attributes are not shared across geometries, see #15811\n\n\t\tdata.data = { attributes: {} };\n\n\t\tconst index = this.index;\n\n\t\tif ( index !== null ) {\n\n\t\t\tdata.data.index = {\n\t\t\t\ttype: index.array.constructor.name,\n\t\t\t\tarray: Array.prototype.slice.call( index.array )\n\t\t\t};\n\n\t\t}\n\n\t\tconst attributes = this.attributes;\n\n\t\tfor ( const key in attributes ) {\n\n\t\t\tconst attribute = attributes[ key ];\n\n\t\t\tdata.data.attributes[ key ] = attribute.toJSON( data.data );\n\n\t\t}\n\n\t\tconst morphAttributes = {};\n\t\tlet hasMorphAttributes = false;\n\n\t\tfor ( const key in this.morphAttributes ) {\n\n\t\t\tconst attributeArray = this.morphAttributes[ key ];\n\n\t\t\tconst array = [];\n\n\t\t\tfor ( let i = 0, il = attributeArray.length; i < il; i ++ ) {\n\n\t\t\t\tconst attribute = attributeArray[ i ];\n\n\t\t\t\tarray.push( attribute.toJSON( data.data ) );\n\n\t\t\t}\n\n\t\t\tif ( array.length > 0 ) {\n\n\t\t\t\tmorphAttributes[ key ] = array;\n\n\t\t\t\thasMorphAttributes = true;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( hasMorphAttributes ) {\n\n\t\t\tdata.data.morphAttributes = morphAttributes;\n\t\t\tdata.data.morphTargetsRelative = this.morphTargetsRelative;\n\n\t\t}\n\n\t\tconst groups = this.groups;\n\n\t\tif ( groups.length > 0 ) {\n\n\t\t\tdata.data.groups = JSON.parse( JSON.stringify( groups ) );\n\n\t\t}\n\n\t\tconst boundingSphere = this.boundingSphere;\n\n\t\tif ( boundingSphere !== null ) {\n\n\t\t\tdata.data.boundingSphere = {\n\t\t\t\tcenter: boundingSphere.center.toArray(),\n\t\t\t\tradius: boundingSphere.radius\n\t\t\t};\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\tcopy( source ) {\n\n\t\t// reset\n\n\t\tthis.index = null;\n\t\tthis.attributes = {};\n\t\tthis.morphAttributes = {};\n\t\tthis.groups = [];\n\t\tthis.boundingBox = null;\n\t\tthis.boundingSphere = null;\n\n\t\t// used for storing cloned, shared data\n\n\t\tconst data = {};\n\n\t\t// name\n\n\t\tthis.name = source.name;\n\n\t\t// index\n\n\t\tconst index = source.index;\n\n\t\tif ( index !== null ) {\n\n\t\t\tthis.setIndex( index.clone( data ) );\n\n\t\t}\n\n\t\t// attributes\n\n\t\tconst attributes = source.attributes;\n\n\t\tfor ( const name in attributes ) {\n\n\t\t\tconst attribute = attributes[ name ];\n\t\t\tthis.setAttribute( name, attribute.clone( data ) );\n\n\t\t}\n\n\t\t// morph attributes\n\n\t\tconst morphAttributes = source.morphAttributes;\n\n\t\tfor ( const name in morphAttributes ) {\n\n\t\t\tconst array = [];\n\t\t\tconst morphAttribute = morphAttributes[ name ]; // morphAttribute: array of Float32BufferAttributes\n\n\t\t\tfor ( let i = 0, l = morphAttribute.length; i < l; i ++ ) {\n\n\t\t\t\tarray.push( morphAttribute[ i ].clone( data ) );\n\n\t\t\t}\n\n\t\t\tthis.morphAttributes[ name ] = array;\n\n\t\t}\n\n\t\tthis.morphTargetsRelative = source.morphTargetsRelative;\n\n\t\t// groups\n\n\t\tconst groups = source.groups;\n\n\t\tfor ( let i = 0, l = groups.length; i < l; i ++ ) {\n\n\t\t\tconst group = groups[ i ];\n\t\t\tthis.addGroup( group.start, group.count, group.materialIndex );\n\n\t\t}\n\n\t\t// bounding box\n\n\t\tconst boundingBox = source.boundingBox;\n\n\t\tif ( boundingBox !== null ) {\n\n\t\t\tthis.boundingBox = boundingBox.clone();\n\n\t\t}\n\n\t\t// bounding sphere\n\n\t\tconst boundingSphere = source.boundingSphere;\n\n\t\tif ( boundingSphere !== null ) {\n\n\t\t\tthis.boundingSphere = boundingSphere.clone();\n\n\t\t}\n\n\t\t// draw range\n\n\t\tthis.drawRange.start = source.drawRange.start;\n\t\tthis.drawRange.count = source.drawRange.count;\n\n\t\t// user data\n\n\t\tthis.userData = source.userData;\n\n\t\t// geometry generator parameters\n\n\t\tif ( source.parameters !== undefined ) this.parameters = Object.assign( {}, source.parameters );\n\n\t\treturn this;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t}\n\n}\n\nconst _inverseMatrix$2 = /*@__PURE__*/ new Matrix4();\nconst _ray$2 = /*@__PURE__*/ new Ray();\nconst _sphere$3 = /*@__PURE__*/ new Sphere();\n\nconst _vA$1 = /*@__PURE__*/ new Vector3();\nconst _vB$1 = /*@__PURE__*/ new Vector3();\nconst _vC$1 = /*@__PURE__*/ new Vector3();\n\nconst _tempA = /*@__PURE__*/ new Vector3();\nconst _morphA = /*@__PURE__*/ new Vector3();\n\nconst _uvA$1 = /*@__PURE__*/ new Vector2();\nconst _uvB$1 = /*@__PURE__*/ new Vector2();\nconst _uvC$1 = /*@__PURE__*/ new Vector2();\n\nconst _intersectionPoint = /*@__PURE__*/ new Vector3();\nconst _intersectionPointWorld = /*@__PURE__*/ new Vector3();\n\nclass Mesh extends Object3D {\n\n\tconstructor( geometry = new BufferGeometry(), material = new MeshBasicMaterial() ) {\n\n\t\tsuper();\n\n\t\tthis.isMesh = true;\n\n\t\tthis.type = 'Mesh';\n\n\t\tthis.geometry = geometry;\n\t\tthis.material = material;\n\n\t\tthis.updateMorphTargets();\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tif ( source.morphTargetInfluences !== undefined ) {\n\n\t\t\tthis.morphTargetInfluences = source.morphTargetInfluences.slice();\n\n\t\t}\n\n\t\tif ( source.morphTargetDictionary !== undefined ) {\n\n\t\t\tthis.morphTargetDictionary = Object.assign( {}, source.morphTargetDictionary );\n\n\t\t}\n\n\t\tthis.material = source.material;\n\t\tthis.geometry = source.geometry;\n\n\t\treturn this;\n\n\t}\n\n\tupdateMorphTargets() {\n\n\t\tconst geometry = this.geometry;\n\n\t\tconst morphAttributes = geometry.morphAttributes;\n\t\tconst keys = Object.keys( morphAttributes );\n\n\t\tif ( keys.length > 0 ) {\n\n\t\t\tconst morphAttribute = morphAttributes[ keys[ 0 ] ];\n\n\t\t\tif ( morphAttribute !== undefined ) {\n\n\t\t\t\tthis.morphTargetInfluences = [];\n\t\t\t\tthis.morphTargetDictionary = {};\n\n\t\t\t\tfor ( let m = 0, ml = morphAttribute.length; m < ml; m ++ ) {\n\n\t\t\t\t\tconst name = morphAttribute[ m ].name || String( m );\n\n\t\t\t\t\tthis.morphTargetInfluences.push( 0 );\n\t\t\t\t\tthis.morphTargetDictionary[ name ] = m;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tgetVertexPosition( vert, target ) {\n\n\t\tconst geometry = this.geometry;\n\t\tconst position = geometry.attributes.position;\n\t\tconst morphPosition = geometry.morphAttributes.position;\n\t\tconst morphTargetsRelative = geometry.morphTargetsRelative;\n\n\t\ttarget.fromBufferAttribute( position, vert );\n\n\t\tconst morphInfluences = this.morphTargetInfluences;\n\n\t\tif ( morphPosition && morphInfluences ) {\n\n\t\t\t_morphA.set( 0, 0, 0 );\n\n\t\t\tfor ( let i = 0, il = morphPosition.length; i < il; i ++ ) {\n\n\t\t\t\tconst influence = morphInfluences[ i ];\n\t\t\t\tconst morphAttribute = morphPosition[ i ];\n\n\t\t\t\tif ( influence === 0 ) continue;\n\n\t\t\t\t_tempA.fromBufferAttribute( morphAttribute, vert );\n\n\t\t\t\tif ( morphTargetsRelative ) {\n\n\t\t\t\t\t_morphA.addScaledVector( _tempA, influence );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t_morphA.addScaledVector( _tempA.sub( target ), influence );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\ttarget.add( _morphA );\n\n\t\t}\n\n\t\tif ( this.isSkinnedMesh ) {\n\n\t\t\tthis.boneTransform( vert, target );\n\n\t\t}\n\n\t\treturn target;\n\n\t}\n\n\traycast( raycaster, intersects ) {\n\n\t\tconst geometry = this.geometry;\n\t\tconst material = this.material;\n\t\tconst matrixWorld = this.matrixWorld;\n\n\t\tif ( material === undefined ) return;\n\n\t\t// Checking boundingSphere distance to ray\n\n\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\n\n\t\t_sphere$3.copy( geometry.boundingSphere );\n\t\t_sphere$3.applyMatrix4( matrixWorld );\n\n\t\tif ( raycaster.ray.intersectsSphere( _sphere$3 ) === false ) return;\n\n\t\t//\n\n\t\t_inverseMatrix$2.copy( matrixWorld ).invert();\n\t\t_ray$2.copy( raycaster.ray ).applyMatrix4( _inverseMatrix$2 );\n\n\t\t// Check boundingBox before continuing\n\n\t\tif ( geometry.boundingBox !== null ) {\n\n\t\t\tif ( _ray$2.intersectsBox( geometry.boundingBox ) === false ) return;\n\n\t\t}\n\n\t\tlet intersection;\n\n\t\tconst index = geometry.index;\n\t\tconst position = geometry.attributes.position;\n\t\tconst uv = geometry.attributes.uv;\n\t\tconst uv2 = geometry.attributes.uv2;\n\t\tconst groups = geometry.groups;\n\t\tconst drawRange = geometry.drawRange;\n\n\t\tif ( index !== null ) {\n\n\t\t\t// indexed buffer geometry\n\n\t\t\tif ( Array.isArray( material ) ) {\n\n\t\t\t\tfor ( let i = 0, il = groups.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst group = groups[ i ];\n\t\t\t\t\tconst groupMaterial = material[ group.materialIndex ];\n\n\t\t\t\t\tconst start = Math.max( group.start, drawRange.start );\n\t\t\t\t\tconst end = Math.min( index.count, Math.min( ( group.start + group.count ), ( drawRange.start + drawRange.count ) ) );\n\n\t\t\t\t\tfor ( let j = start, jl = end; j < jl; j += 3 ) {\n\n\t\t\t\t\t\tconst a = index.getX( j );\n\t\t\t\t\t\tconst b = index.getX( j + 1 );\n\t\t\t\t\t\tconst c = index.getX( j + 2 );\n\n\t\t\t\t\t\tintersection = checkBufferGeometryIntersection( this, groupMaterial, raycaster, _ray$2, uv, uv2, a, b, c );\n\n\t\t\t\t\t\tif ( intersection ) {\n\n\t\t\t\t\t\t\tintersection.faceIndex = Math.floor( j / 3 ); // triangle number in indexed buffer semantics\n\t\t\t\t\t\t\tintersection.face.materialIndex = group.materialIndex;\n\t\t\t\t\t\t\tintersects.push( intersection );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tconst start = Math.max( 0, drawRange.start );\n\t\t\t\tconst end = Math.min( index.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\t\tfor ( let i = start, il = end; i < il; i += 3 ) {\n\n\t\t\t\t\tconst a = index.getX( i );\n\t\t\t\t\tconst b = index.getX( i + 1 );\n\t\t\t\t\tconst c = index.getX( i + 2 );\n\n\t\t\t\t\tintersection = checkBufferGeometryIntersection( this, material, raycaster, _ray$2, uv, uv2, a, b, c );\n\n\t\t\t\t\tif ( intersection ) {\n\n\t\t\t\t\t\tintersection.faceIndex = Math.floor( i / 3 ); // triangle number in indexed buffer semantics\n\t\t\t\t\t\tintersects.push( intersection );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else if ( position !== undefined ) {\n\n\t\t\t// non-indexed buffer geometry\n\n\t\t\tif ( Array.isArray( material ) ) {\n\n\t\t\t\tfor ( let i = 0, il = groups.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst group = groups[ i ];\n\t\t\t\t\tconst groupMaterial = material[ group.materialIndex ];\n\n\t\t\t\t\tconst start = Math.max( group.start, drawRange.start );\n\t\t\t\t\tconst end = Math.min( position.count, Math.min( ( group.start + group.count ), ( drawRange.start + drawRange.count ) ) );\n\n\t\t\t\t\tfor ( let j = start, jl = end; j < jl; j += 3 ) {\n\n\t\t\t\t\t\tconst a = j;\n\t\t\t\t\t\tconst b = j + 1;\n\t\t\t\t\t\tconst c = j + 2;\n\n\t\t\t\t\t\tintersection = checkBufferGeometryIntersection( this, groupMaterial, raycaster, _ray$2, uv, uv2, a, b, c );\n\n\t\t\t\t\t\tif ( intersection ) {\n\n\t\t\t\t\t\t\tintersection.faceIndex = Math.floor( j / 3 ); // triangle number in non-indexed buffer semantics\n\t\t\t\t\t\t\tintersection.face.materialIndex = group.materialIndex;\n\t\t\t\t\t\t\tintersects.push( intersection );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tconst start = Math.max( 0, drawRange.start );\n\t\t\t\tconst end = Math.min( position.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\t\tfor ( let i = start, il = end; i < il; i += 3 ) {\n\n\t\t\t\t\tconst a = i;\n\t\t\t\t\tconst b = i + 1;\n\t\t\t\t\tconst c = i + 2;\n\n\t\t\t\t\tintersection = checkBufferGeometryIntersection( this, material, raycaster, _ray$2, uv, uv2, a, b, c );\n\n\t\t\t\t\tif ( intersection ) {\n\n\t\t\t\t\t\tintersection.faceIndex = Math.floor( i / 3 ); // triangle number in non-indexed buffer semantics\n\t\t\t\t\t\tintersects.push( intersection );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}\n\nfunction checkIntersection( object, material, raycaster, ray, pA, pB, pC, point ) {\n\n\tlet intersect;\n\n\tif ( material.side === BackSide ) {\n\n\t\tintersect = ray.intersectTriangle( pC, pB, pA, true, point );\n\n\t} else {\n\n\t\tintersect = ray.intersectTriangle( pA, pB, pC, ( material.side === FrontSide ), point );\n\n\t}\n\n\tif ( intersect === null ) return null;\n\n\t_intersectionPointWorld.copy( point );\n\t_intersectionPointWorld.applyMatrix4( object.matrixWorld );\n\n\tconst distance = raycaster.ray.origin.distanceTo( _intersectionPointWorld );\n\n\tif ( distance < raycaster.near || distance > raycaster.far ) return null;\n\n\treturn {\n\t\tdistance: distance,\n\t\tpoint: _intersectionPointWorld.clone(),\n\t\tobject: object\n\t};\n\n}\n\nfunction checkBufferGeometryIntersection( object, material, raycaster, ray, uv, uv2, a, b, c ) {\n\n\tobject.getVertexPosition( a, _vA$1 );\n\tobject.getVertexPosition( b, _vB$1 );\n\tobject.getVertexPosition( c, _vC$1 );\n\n\tconst intersection = checkIntersection( object, material, raycaster, ray, _vA$1, _vB$1, _vC$1, _intersectionPoint );\n\n\tif ( intersection ) {\n\n\t\tif ( uv ) {\n\n\t\t\t_uvA$1.fromBufferAttribute( uv, a );\n\t\t\t_uvB$1.fromBufferAttribute( uv, b );\n\t\t\t_uvC$1.fromBufferAttribute( uv, c );\n\n\t\t\tintersection.uv = Triangle.getUV( _intersectionPoint, _vA$1, _vB$1, _vC$1, _uvA$1, _uvB$1, _uvC$1, new Vector2() );\n\n\t\t}\n\n\t\tif ( uv2 ) {\n\n\t\t\t_uvA$1.fromBufferAttribute( uv2, a );\n\t\t\t_uvB$1.fromBufferAttribute( uv2, b );\n\t\t\t_uvC$1.fromBufferAttribute( uv2, c );\n\n\t\t\tintersection.uv2 = Triangle.getUV( _intersectionPoint, _vA$1, _vB$1, _vC$1, _uvA$1, _uvB$1, _uvC$1, new Vector2() );\n\n\t\t}\n\n\t\tconst face = {\n\t\t\ta: a,\n\t\t\tb: b,\n\t\t\tc: c,\n\t\t\tnormal: new Vector3(),\n\t\t\tmaterialIndex: 0\n\t\t};\n\n\t\tTriangle.getNormal( _vA$1, _vB$1, _vC$1, face.normal );\n\n\t\tintersection.face = face;\n\n\t}\n\n\treturn intersection;\n\n}\n\nclass BoxGeometry extends BufferGeometry {\n\n\tconstructor( width = 1, height = 1, depth = 1, widthSegments = 1, heightSegments = 1, depthSegments = 1 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'BoxGeometry';\n\n\t\tthis.parameters = {\n\t\t\twidth: width,\n\t\t\theight: height,\n\t\t\tdepth: depth,\n\t\t\twidthSegments: widthSegments,\n\t\t\theightSegments: heightSegments,\n\t\t\tdepthSegments: depthSegments\n\t\t};\n\n\t\tconst scope = this;\n\n\t\t// segments\n\n\t\twidthSegments = Math.floor( widthSegments );\n\t\theightSegments = Math.floor( heightSegments );\n\t\tdepthSegments = Math.floor( depthSegments );\n\n\t\t// buffers\n\n\t\tconst indices = [];\n\t\tconst vertices = [];\n\t\tconst normals = [];\n\t\tconst uvs = [];\n\n\t\t// helper variables\n\n\t\tlet numberOfVertices = 0;\n\t\tlet groupStart = 0;\n\n\t\t// build each side of the box geometry\n\n\t\tbuildPlane( 'z', 'y', 'x', - 1, - 1, depth, height, width, depthSegments, heightSegments, 0 ); // px\n\t\tbuildPlane( 'z', 'y', 'x', 1, - 1, depth, height, - width, depthSegments, heightSegments, 1 ); // nx\n\t\tbuildPlane( 'x', 'z', 'y', 1, 1, width, depth, height, widthSegments, depthSegments, 2 ); // py\n\t\tbuildPlane( 'x', 'z', 'y', 1, - 1, width, depth, - height, widthSegments, depthSegments, 3 ); // ny\n\t\tbuildPlane( 'x', 'y', 'z', 1, - 1, width, height, depth, widthSegments, heightSegments, 4 ); // pz\n\t\tbuildPlane( 'x', 'y', 'z', - 1, - 1, width, height, - depth, widthSegments, heightSegments, 5 ); // nz\n\n\t\t// build geometry\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\t\tfunction buildPlane( u, v, w, udir, vdir, width, height, depth, gridX, gridY, materialIndex ) {\n\n\t\t\tconst segmentWidth = width / gridX;\n\t\t\tconst segmentHeight = height / gridY;\n\n\t\t\tconst widthHalf = width / 2;\n\t\t\tconst heightHalf = height / 2;\n\t\t\tconst depthHalf = depth / 2;\n\n\t\t\tconst gridX1 = gridX + 1;\n\t\t\tconst gridY1 = gridY + 1;\n\n\t\t\tlet vertexCounter = 0;\n\t\t\tlet groupCount = 0;\n\n\t\t\tconst vector = new Vector3();\n\n\t\t\t// generate vertices, normals and uvs\n\n\t\t\tfor ( let iy = 0; iy < gridY1; iy ++ ) {\n\n\t\t\t\tconst y = iy * segmentHeight - heightHalf;\n\n\t\t\t\tfor ( let ix = 0; ix < gridX1; ix ++ ) {\n\n\t\t\t\t\tconst x = ix * segmentWidth - widthHalf;\n\n\t\t\t\t\t// set values to correct vector component\n\n\t\t\t\t\tvector[ u ] = x * udir;\n\t\t\t\t\tvector[ v ] = y * vdir;\n\t\t\t\t\tvector[ w ] = depthHalf;\n\n\t\t\t\t\t// now apply vector to vertex buffer\n\n\t\t\t\t\tvertices.push( vector.x, vector.y, vector.z );\n\n\t\t\t\t\t// set values to correct vector component\n\n\t\t\t\t\tvector[ u ] = 0;\n\t\t\t\t\tvector[ v ] = 0;\n\t\t\t\t\tvector[ w ] = depth > 0 ? 1 : - 1;\n\n\t\t\t\t\t// now apply vector to normal buffer\n\n\t\t\t\t\tnormals.push( vector.x, vector.y, vector.z );\n\n\t\t\t\t\t// uvs\n\n\t\t\t\t\tuvs.push( ix / gridX );\n\t\t\t\t\tuvs.push( 1 - ( iy / gridY ) );\n\n\t\t\t\t\t// counters\n\n\t\t\t\t\tvertexCounter += 1;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// indices\n\n\t\t\t// 1. you need three indices to draw a single face\n\t\t\t// 2. a single segment consists of two faces\n\t\t\t// 3. so we need to generate six (2*3) indices per segment\n\n\t\t\tfor ( let iy = 0; iy < gridY; iy ++ ) {\n\n\t\t\t\tfor ( let ix = 0; ix < gridX; ix ++ ) {\n\n\t\t\t\t\tconst a = numberOfVertices + ix + gridX1 * iy;\n\t\t\t\t\tconst b = numberOfVertices + ix + gridX1 * ( iy + 1 );\n\t\t\t\t\tconst c = numberOfVertices + ( ix + 1 ) + gridX1 * ( iy + 1 );\n\t\t\t\t\tconst d = numberOfVertices + ( ix + 1 ) + gridX1 * iy;\n\n\t\t\t\t\t// faces\n\n\t\t\t\t\tindices.push( a, b, d );\n\t\t\t\t\tindices.push( b, c, d );\n\n\t\t\t\t\t// increase counter\n\n\t\t\t\t\tgroupCount += 6;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// add a group to the geometry. this will ensure multi material support\n\n\t\t\tscope.addGroup( groupStart, groupCount, materialIndex );\n\n\t\t\t// calculate new start value for groups\n\n\t\t\tgroupStart += groupCount;\n\n\t\t\t// update total number of vertices\n\n\t\t\tnumberOfVertices += vertexCounter;\n\n\t\t}\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new BoxGeometry( data.width, data.height, data.depth, data.widthSegments, data.heightSegments, data.depthSegments );\n\n\t}\n\n}\n\n/**\n * Uniform Utilities\n */\n\nfunction cloneUniforms( src ) {\n\n\tconst dst = {};\n\n\tfor ( const u in src ) {\n\n\t\tdst[ u ] = {};\n\n\t\tfor ( const p in src[ u ] ) {\n\n\t\t\tconst property = src[ u ][ p ];\n\n\t\t\tif ( property && ( property.isColor ||\n\t\t\t\tproperty.isMatrix3 || property.isMatrix4 ||\n\t\t\t\tproperty.isVector2 || property.isVector3 || property.isVector4 ||\n\t\t\t\tproperty.isTexture || property.isQuaternion ) ) {\n\n\t\t\t\tdst[ u ][ p ] = property.clone();\n\n\t\t\t} else if ( Array.isArray( property ) ) {\n\n\t\t\t\tdst[ u ][ p ] = property.slice();\n\n\t\t\t} else {\n\n\t\t\t\tdst[ u ][ p ] = property;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\treturn dst;\n\n}\n\nfunction mergeUniforms( uniforms ) {\n\n\tconst merged = {};\n\n\tfor ( let u = 0; u < uniforms.length; u ++ ) {\n\n\t\tconst tmp = cloneUniforms( uniforms[ u ] );\n\n\t\tfor ( const p in tmp ) {\n\n\t\t\tmerged[ p ] = tmp[ p ];\n\n\t\t}\n\n\t}\n\n\treturn merged;\n\n}\n\nfunction cloneUniformsGroups( src ) {\n\n\tconst dst = [];\n\n\tfor ( let u = 0; u < src.length; u ++ ) {\n\n\t\tdst.push( src[ u ].clone() );\n\n\t}\n\n\treturn dst;\n\n}\n\nfunction getUnlitUniformColorSpace( renderer ) {\n\n\tif ( renderer.getRenderTarget() === null ) {\n\n\t\t// https://github.com/mrdoob/three.js/pull/23937#issuecomment-1111067398\n\t\treturn renderer.outputEncoding === sRGBEncoding ? SRGBColorSpace : LinearSRGBColorSpace;\n\n\t}\n\n\treturn LinearSRGBColorSpace;\n\n}\n\n// Legacy\n\nconst UniformsUtils = { clone: cloneUniforms, merge: mergeUniforms };\n\nvar default_vertex = \"void main() {\\n\\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\\n}\";\n\nvar default_fragment = \"void main() {\\n\\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\\n}\";\n\nclass ShaderMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isShaderMaterial = true;\n\n\t\tthis.type = 'ShaderMaterial';\n\n\t\tthis.defines = {};\n\t\tthis.uniforms = {};\n\t\tthis.uniformsGroups = [];\n\n\t\tthis.vertexShader = default_vertex;\n\t\tthis.fragmentShader = default_fragment;\n\n\t\tthis.linewidth = 1;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\n\t\tthis.fog = false; // set to use scene fog\n\t\tthis.lights = false; // set to use scene lights\n\t\tthis.clipping = false; // set to use user-defined clipping planes\n\n\t\tthis.extensions = {\n\t\t\tderivatives: false, // set to use derivatives\n\t\t\tfragDepth: false, // set to use fragment depth values\n\t\t\tdrawBuffers: false, // set to use draw buffers\n\t\t\tshaderTextureLOD: false // set to use shader texture LOD\n\t\t};\n\n\t\t// When rendered geometry doesn't include these attributes but the material does,\n\t\t// use these default values in WebGL. This avoids errors when buffer data is missing.\n\t\tthis.defaultAttributeValues = {\n\t\t\t'color': [ 1, 1, 1 ],\n\t\t\t'uv': [ 0, 0 ],\n\t\t\t'uv2': [ 0, 0 ]\n\t\t};\n\n\t\tthis.index0AttributeName = undefined;\n\t\tthis.uniformsNeedUpdate = false;\n\n\t\tthis.glslVersion = null;\n\n\t\tif ( parameters !== undefined ) {\n\n\t\t\tthis.setValues( parameters );\n\n\t\t}\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.fragmentShader = source.fragmentShader;\n\t\tthis.vertexShader = source.vertexShader;\n\n\t\tthis.uniforms = cloneUniforms( source.uniforms );\n\t\tthis.uniformsGroups = cloneUniformsGroups( source.uniformsGroups );\n\n\t\tthis.defines = Object.assign( {}, source.defines );\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\n\t\tthis.fog = source.fog;\n\t\tthis.lights = source.lights;\n\t\tthis.clipping = source.clipping;\n\n\t\tthis.extensions = Object.assign( {}, source.extensions );\n\n\t\tthis.glslVersion = source.glslVersion;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst data = super.toJSON( meta );\n\n\t\tdata.glslVersion = this.glslVersion;\n\t\tdata.uniforms = {};\n\n\t\tfor ( const name in this.uniforms ) {\n\n\t\t\tconst uniform = this.uniforms[ name ];\n\t\t\tconst value = uniform.value;\n\n\t\t\tif ( value && value.isTexture ) {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\ttype: 't',\n\t\t\t\t\tvalue: value.toJSON( meta ).uuid\n\t\t\t\t};\n\n\t\t\t} else if ( value && value.isColor ) {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\ttype: 'c',\n\t\t\t\t\tvalue: value.getHex()\n\t\t\t\t};\n\n\t\t\t} else if ( value && value.isVector2 ) {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\ttype: 'v2',\n\t\t\t\t\tvalue: value.toArray()\n\t\t\t\t};\n\n\t\t\t} else if ( value && value.isVector3 ) {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\ttype: 'v3',\n\t\t\t\t\tvalue: value.toArray()\n\t\t\t\t};\n\n\t\t\t} else if ( value && value.isVector4 ) {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\ttype: 'v4',\n\t\t\t\t\tvalue: value.toArray()\n\t\t\t\t};\n\n\t\t\t} else if ( value && value.isMatrix3 ) {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\ttype: 'm3',\n\t\t\t\t\tvalue: value.toArray()\n\t\t\t\t};\n\n\t\t\t} else if ( value && value.isMatrix4 ) {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\ttype: 'm4',\n\t\t\t\t\tvalue: value.toArray()\n\t\t\t\t};\n\n\t\t\t} else {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\tvalue: value\n\t\t\t\t};\n\n\t\t\t\t// note: the array variants v2v, v3v, v4v, m4v and tv are not supported so far\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( Object.keys( this.defines ).length > 0 ) data.defines = this.defines;\n\n\t\tdata.vertexShader = this.vertexShader;\n\t\tdata.fragmentShader = this.fragmentShader;\n\n\t\tconst extensions = {};\n\n\t\tfor ( const key in this.extensions ) {\n\n\t\t\tif ( this.extensions[ key ] === true ) extensions[ key ] = true;\n\n\t\t}\n\n\t\tif ( Object.keys( extensions ).length > 0 ) data.extensions = extensions;\n\n\t\treturn data;\n\n\t}\n\n}\n\nclass Camera extends Object3D {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.isCamera = true;\n\n\t\tthis.type = 'Camera';\n\n\t\tthis.matrixWorldInverse = new Matrix4();\n\n\t\tthis.projectionMatrix = new Matrix4();\n\t\tthis.projectionMatrixInverse = new Matrix4();\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.matrixWorldInverse.copy( source.matrixWorldInverse );\n\n\t\tthis.projectionMatrix.copy( source.projectionMatrix );\n\t\tthis.projectionMatrixInverse.copy( source.projectionMatrixInverse );\n\n\t\treturn this;\n\n\t}\n\n\tgetWorldDirection( target ) {\n\n\t\tthis.updateWorldMatrix( true, false );\n\n\t\tconst e = this.matrixWorld.elements;\n\n\t\treturn target.set( - e[ 8 ], - e[ 9 ], - e[ 10 ] ).normalize();\n\n\t}\n\n\tupdateMatrixWorld( force ) {\n\n\t\tsuper.updateMatrixWorld( force );\n\n\t\tthis.matrixWorldInverse.copy( this.matrixWorld ).invert();\n\n\t}\n\n\tupdateWorldMatrix( updateParents, updateChildren ) {\n\n\t\tsuper.updateWorldMatrix( updateParents, updateChildren );\n\n\t\tthis.matrixWorldInverse.copy( this.matrixWorld ).invert();\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n}\n\nclass PerspectiveCamera extends Camera {\n\n\tconstructor( fov = 50, aspect = 1, near = 0.1, far = 2000 ) {\n\n\t\tsuper();\n\n\t\tthis.isPerspectiveCamera = true;\n\n\t\tthis.type = 'PerspectiveCamera';\n\n\t\tthis.fov = fov;\n\t\tthis.zoom = 1;\n\n\t\tthis.near = near;\n\t\tthis.far = far;\n\t\tthis.focus = 10;\n\n\t\tthis.aspect = aspect;\n\t\tthis.view = null;\n\n\t\tthis.filmGauge = 35;\t// width of the film (default in millimeters)\n\t\tthis.filmOffset = 0;\t// horizontal film offset (same unit as gauge)\n\n\t\tthis.updateProjectionMatrix();\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.fov = source.fov;\n\t\tthis.zoom = source.zoom;\n\n\t\tthis.near = source.near;\n\t\tthis.far = source.far;\n\t\tthis.focus = source.focus;\n\n\t\tthis.aspect = source.aspect;\n\t\tthis.view = source.view === null ? null : Object.assign( {}, source.view );\n\n\t\tthis.filmGauge = source.filmGauge;\n\t\tthis.filmOffset = source.filmOffset;\n\n\t\treturn this;\n\n\t}\n\n\t/**\n\t * Sets the FOV by focal length in respect to the current .filmGauge.\n\t *\n\t * The default film gauge is 35, so that the focal length can be specified for\n\t * a 35mm (full frame) camera.\n\t *\n\t * Values for focal length and film gauge must have the same unit.\n\t */\n\tsetFocalLength( focalLength ) {\n\n\t\t/** see {@link http://www.bobatkins.com/photography/technical/field_of_view.html} */\n\t\tconst vExtentSlope = 0.5 * this.getFilmHeight() / focalLength;\n\n\t\tthis.fov = RAD2DEG * 2 * Math.atan( vExtentSlope );\n\t\tthis.updateProjectionMatrix();\n\n\t}\n\n\t/**\n\t * Calculates the focal length from the current .fov and .filmGauge.\n\t */\n\tgetFocalLength() {\n\n\t\tconst vExtentSlope = Math.tan( DEG2RAD * 0.5 * this.fov );\n\n\t\treturn 0.5 * this.getFilmHeight() / vExtentSlope;\n\n\t}\n\n\tgetEffectiveFOV() {\n\n\t\treturn RAD2DEG * 2 * Math.atan(\n\t\t\tMath.tan( DEG2RAD * 0.5 * this.fov ) / this.zoom );\n\n\t}\n\n\tgetFilmWidth() {\n\n\t\t// film not completely covered in portrait format (aspect < 1)\n\t\treturn this.filmGauge * Math.min( this.aspect, 1 );\n\n\t}\n\n\tgetFilmHeight() {\n\n\t\t// film not completely covered in landscape format (aspect > 1)\n\t\treturn this.filmGauge / Math.max( this.aspect, 1 );\n\n\t}\n\n\t/**\n\t * Sets an offset in a larger frustum. This is useful for multi-window or\n\t * multi-monitor/multi-machine setups.\n\t *\n\t * For example, if you have 3x2 monitors and each monitor is 1920x1080 and\n\t * the monitors are in grid like this\n\t *\n\t *   +---+---+---+\n\t *   | A | B | C |\n\t *   +---+---+---+\n\t *   | D | E | F |\n\t *   +---+---+---+\n\t *\n\t * then for each monitor you would call it like this\n\t *\n\t *   const w = 1920;\n\t *   const h = 1080;\n\t *   const fullWidth = w * 3;\n\t *   const fullHeight = h * 2;\n\t *\n\t *   --A--\n\t *   camera.setViewOffset( fullWidth, fullHeight, w * 0, h * 0, w, h );\n\t *   --B--\n\t *   camera.setViewOffset( fullWidth, fullHeight, w * 1, h * 0, w, h );\n\t *   --C--\n\t *   camera.setViewOffset( fullWidth, fullHeight, w * 2, h * 0, w, h );\n\t *   --D--\n\t *   camera.setViewOffset( fullWidth, fullHeight, w * 0, h * 1, w, h );\n\t *   --E--\n\t *   camera.setViewOffset( fullWidth, fullHeight, w * 1, h * 1, w, h );\n\t *   --F--\n\t *   camera.setViewOffset( fullWidth, fullHeight, w * 2, h * 1, w, h );\n\t *\n\t *   Note there is no reason monitors have to be the same size or in a grid.\n\t */\n\tsetViewOffset( fullWidth, fullHeight, x, y, width, height ) {\n\n\t\tthis.aspect = fullWidth / fullHeight;\n\n\t\tif ( this.view === null ) {\n\n\t\t\tthis.view = {\n\t\t\t\tenabled: true,\n\t\t\t\tfullWidth: 1,\n\t\t\t\tfullHeight: 1,\n\t\t\t\toffsetX: 0,\n\t\t\t\toffsetY: 0,\n\t\t\t\twidth: 1,\n\t\t\t\theight: 1\n\t\t\t};\n\n\t\t}\n\n\t\tthis.view.enabled = true;\n\t\tthis.view.fullWidth = fullWidth;\n\t\tthis.view.fullHeight = fullHeight;\n\t\tthis.view.offsetX = x;\n\t\tthis.view.offsetY = y;\n\t\tthis.view.width = width;\n\t\tthis.view.height = height;\n\n\t\tthis.updateProjectionMatrix();\n\n\t}\n\n\tclearViewOffset() {\n\n\t\tif ( this.view !== null ) {\n\n\t\t\tthis.view.enabled = false;\n\n\t\t}\n\n\t\tthis.updateProjectionMatrix();\n\n\t}\n\n\tupdateProjectionMatrix() {\n\n\t\tconst near = this.near;\n\t\tlet top = near * Math.tan( DEG2RAD * 0.5 * this.fov ) / this.zoom;\n\t\tlet height = 2 * top;\n\t\tlet width = this.aspect * height;\n\t\tlet left = - 0.5 * width;\n\t\tconst view = this.view;\n\n\t\tif ( this.view !== null && this.view.enabled ) {\n\n\t\t\tconst fullWidth = view.fullWidth,\n\t\t\t\tfullHeight = view.fullHeight;\n\n\t\t\tleft += view.offsetX * width / fullWidth;\n\t\t\ttop -= view.offsetY * height / fullHeight;\n\t\t\twidth *= view.width / fullWidth;\n\t\t\theight *= view.height / fullHeight;\n\n\t\t}\n\n\t\tconst skew = this.filmOffset;\n\t\tif ( skew !== 0 ) left += near * skew / this.getFilmWidth();\n\n\t\tthis.projectionMatrix.makePerspective( left, left + width, top, top - height, near, this.far );\n\n\t\tthis.projectionMatrixInverse.copy( this.projectionMatrix ).invert();\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst data = super.toJSON( meta );\n\n\t\tdata.object.fov = this.fov;\n\t\tdata.object.zoom = this.zoom;\n\n\t\tdata.object.near = this.near;\n\t\tdata.object.far = this.far;\n\t\tdata.object.focus = this.focus;\n\n\t\tdata.object.aspect = this.aspect;\n\n\t\tif ( this.view !== null ) data.object.view = Object.assign( {}, this.view );\n\n\t\tdata.object.filmGauge = this.filmGauge;\n\t\tdata.object.filmOffset = this.filmOffset;\n\n\t\treturn data;\n\n\t}\n\n}\n\nconst fov = - 90; // negative fov is not an error\nconst aspect = 1;\n\nclass CubeCamera extends Object3D {\n\n\tconstructor( near, far, renderTarget ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'CubeCamera';\n\n\t\tthis.renderTarget = renderTarget;\n\n\t\tconst cameraPX = new PerspectiveCamera( fov, aspect, near, far );\n\t\tcameraPX.layers = this.layers;\n\t\tcameraPX.up.set( 0, 1, 0 );\n\t\tcameraPX.lookAt( 1, 0, 0 );\n\t\tthis.add( cameraPX );\n\n\t\tconst cameraNX = new PerspectiveCamera( fov, aspect, near, far );\n\t\tcameraNX.layers = this.layers;\n\t\tcameraNX.up.set( 0, 1, 0 );\n\t\tcameraNX.lookAt( - 1, 0, 0 );\n\t\tthis.add( cameraNX );\n\n\t\tconst cameraPY = new PerspectiveCamera( fov, aspect, near, far );\n\t\tcameraPY.layers = this.layers;\n\t\tcameraPY.up.set( 0, 0, - 1 );\n\t\tcameraPY.lookAt( 0, 1, 0 );\n\t\tthis.add( cameraPY );\n\n\t\tconst cameraNY = new PerspectiveCamera( fov, aspect, near, far );\n\t\tcameraNY.layers = this.layers;\n\t\tcameraNY.up.set( 0, 0, 1 );\n\t\tcameraNY.lookAt( 0, - 1, 0 );\n\t\tthis.add( cameraNY );\n\n\t\tconst cameraPZ = new PerspectiveCamera( fov, aspect, near, far );\n\t\tcameraPZ.layers = this.layers;\n\t\tcameraPZ.up.set( 0, 1, 0 );\n\t\tcameraPZ.lookAt( 0, 0, 1 );\n\t\tthis.add( cameraPZ );\n\n\t\tconst cameraNZ = new PerspectiveCamera( fov, aspect, near, far );\n\t\tcameraNZ.layers = this.layers;\n\t\tcameraNZ.up.set( 0, 1, 0 );\n\t\tcameraNZ.lookAt( 0, 0, - 1 );\n\t\tthis.add( cameraNZ );\n\n\t}\n\n\tupdate( renderer, scene ) {\n\n\t\tif ( this.parent === null ) this.updateMatrixWorld();\n\n\t\tconst renderTarget = this.renderTarget;\n\n\t\tconst [ cameraPX, cameraNX, cameraPY, cameraNY, cameraPZ, cameraNZ ] = this.children;\n\n\t\tconst currentRenderTarget = renderer.getRenderTarget();\n\n\t\tconst currentToneMapping = renderer.toneMapping;\n\t\tconst currentXrEnabled = renderer.xr.enabled;\n\n\t\trenderer.toneMapping = NoToneMapping;\n\t\trenderer.xr.enabled = false;\n\n\t\tconst generateMipmaps = renderTarget.texture.generateMipmaps;\n\n\t\trenderTarget.texture.generateMipmaps = false;\n\n\t\trenderer.setRenderTarget( renderTarget, 0 );\n\t\trenderer.render( scene, cameraPX );\n\n\t\trenderer.setRenderTarget( renderTarget, 1 );\n\t\trenderer.render( scene, cameraNX );\n\n\t\trenderer.setRenderTarget( renderTarget, 2 );\n\t\trenderer.render( scene, cameraPY );\n\n\t\trenderer.setRenderTarget( renderTarget, 3 );\n\t\trenderer.render( scene, cameraNY );\n\n\t\trenderer.setRenderTarget( renderTarget, 4 );\n\t\trenderer.render( scene, cameraPZ );\n\n\t\trenderTarget.texture.generateMipmaps = generateMipmaps;\n\n\t\trenderer.setRenderTarget( renderTarget, 5 );\n\t\trenderer.render( scene, cameraNZ );\n\n\t\trenderer.setRenderTarget( currentRenderTarget );\n\n\t\trenderer.toneMapping = currentToneMapping;\n\t\trenderer.xr.enabled = currentXrEnabled;\n\n\t\trenderTarget.texture.needsPMREMUpdate = true;\n\n\t}\n\n}\n\nclass CubeTexture extends Texture {\n\n\tconstructor( images, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy, encoding ) {\n\n\t\timages = images !== undefined ? images : [];\n\t\tmapping = mapping !== undefined ? mapping : CubeReflectionMapping;\n\n\t\tsuper( images, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy, encoding );\n\n\t\tthis.isCubeTexture = true;\n\n\t\tthis.flipY = false;\n\n\t}\n\n\tget images() {\n\n\t\treturn this.image;\n\n\t}\n\n\tset images( value ) {\n\n\t\tthis.image = value;\n\n\t}\n\n}\n\nclass WebGLCubeRenderTarget extends WebGLRenderTarget {\n\n\tconstructor( size = 1, options = {} ) {\n\n\t\tsuper( size, size, options );\n\n\t\tthis.isWebGLCubeRenderTarget = true;\n\n\t\tconst image = { width: size, height: size, depth: 1 };\n\t\tconst images = [ image, image, image, image, image, image ];\n\n\t\tthis.texture = new CubeTexture( images, options.mapping, options.wrapS, options.wrapT, options.magFilter, options.minFilter, options.format, options.type, options.anisotropy, options.encoding );\n\n\t\t// By convention -- likely based on the RenderMan spec from the 1990's -- cube maps are specified by WebGL (and three.js)\n\t\t// in a coordinate system in which positive-x is to the right when looking up the positive-z axis -- in other words,\n\t\t// in a left-handed coordinate system. By continuing this convention, preexisting cube maps continued to render correctly.\n\n\t\t// three.js uses a right-handed coordinate system. So environment maps used in three.js appear to have px and nx swapped\n\t\t// and the flag isRenderTargetTexture controls this conversion. The flip is not required when using WebGLCubeRenderTarget.texture\n\t\t// as a cube texture (this is detected when isRenderTargetTexture is set to true for cube textures).\n\n\t\tthis.texture.isRenderTargetTexture = true;\n\n\t\tthis.texture.generateMipmaps = options.generateMipmaps !== undefined ? options.generateMipmaps : false;\n\t\tthis.texture.minFilter = options.minFilter !== undefined ? options.minFilter : LinearFilter;\n\n\t}\n\n\tfromEquirectangularTexture( renderer, texture ) {\n\n\t\tthis.texture.type = texture.type;\n\t\tthis.texture.encoding = texture.encoding;\n\n\t\tthis.texture.generateMipmaps = texture.generateMipmaps;\n\t\tthis.texture.minFilter = texture.minFilter;\n\t\tthis.texture.magFilter = texture.magFilter;\n\n\t\tconst shader = {\n\n\t\t\tuniforms: {\n\t\t\t\ttEquirect: { value: null },\n\t\t\t},\n\n\t\t\tvertexShader: /* glsl */`\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t`,\n\n\t\t\tfragmentShader: /* glsl */`\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t`\n\t\t};\n\n\t\tconst geometry = new BoxGeometry( 5, 5, 5 );\n\n\t\tconst material = new ShaderMaterial( {\n\n\t\t\tname: 'CubemapFromEquirect',\n\n\t\t\tuniforms: cloneUniforms( shader.uniforms ),\n\t\t\tvertexShader: shader.vertexShader,\n\t\t\tfragmentShader: shader.fragmentShader,\n\t\t\tside: BackSide,\n\t\t\tblending: NoBlending\n\n\t\t} );\n\n\t\tmaterial.uniforms.tEquirect.value = texture;\n\n\t\tconst mesh = new Mesh( geometry, material );\n\n\t\tconst currentMinFilter = texture.minFilter;\n\n\t\t// Avoid blurred poles\n\t\tif ( texture.minFilter === LinearMipmapLinearFilter ) texture.minFilter = LinearFilter;\n\n\t\tconst camera = new CubeCamera( 1, 10, this );\n\t\tcamera.update( renderer, mesh );\n\n\t\ttexture.minFilter = currentMinFilter;\n\n\t\tmesh.geometry.dispose();\n\t\tmesh.material.dispose();\n\n\t\treturn this;\n\n\t}\n\n\tclear( renderer, color, depth, stencil ) {\n\n\t\tconst currentRenderTarget = renderer.getRenderTarget();\n\n\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\trenderer.setRenderTarget( this, i );\n\n\t\t\trenderer.clear( color, depth, stencil );\n\n\t\t}\n\n\t\trenderer.setRenderTarget( currentRenderTarget );\n\n\t}\n\n}\n\nconst _vector1 = /*@__PURE__*/ new Vector3();\nconst _vector2 = /*@__PURE__*/ new Vector3();\nconst _normalMatrix = /*@__PURE__*/ new Matrix3();\n\nclass Plane {\n\n\tconstructor( normal = new Vector3( 1, 0, 0 ), constant = 0 ) {\n\n\t\tthis.isPlane = true;\n\n\t\t// normal is assumed to be normalized\n\n\t\tthis.normal = normal;\n\t\tthis.constant = constant;\n\n\t}\n\n\tset( normal, constant ) {\n\n\t\tthis.normal.copy( normal );\n\t\tthis.constant = constant;\n\n\t\treturn this;\n\n\t}\n\n\tsetComponents( x, y, z, w ) {\n\n\t\tthis.normal.set( x, y, z );\n\t\tthis.constant = w;\n\n\t\treturn this;\n\n\t}\n\n\tsetFromNormalAndCoplanarPoint( normal, point ) {\n\n\t\tthis.normal.copy( normal );\n\t\tthis.constant = - point.dot( this.normal );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromCoplanarPoints( a, b, c ) {\n\n\t\tconst normal = _vector1.subVectors( c, b ).cross( _vector2.subVectors( a, b ) ).normalize();\n\n\t\t// Q: should an error be thrown if normal is zero (e.g. degenerate plane)?\n\n\t\tthis.setFromNormalAndCoplanarPoint( normal, a );\n\n\t\treturn this;\n\n\t}\n\n\tcopy( plane ) {\n\n\t\tthis.normal.copy( plane.normal );\n\t\tthis.constant = plane.constant;\n\n\t\treturn this;\n\n\t}\n\n\tnormalize() {\n\n\t\t// Note: will lead to a divide by zero if the plane is invalid.\n\n\t\tconst inverseNormalLength = 1.0 / this.normal.length();\n\t\tthis.normal.multiplyScalar( inverseNormalLength );\n\t\tthis.constant *= inverseNormalLength;\n\n\t\treturn this;\n\n\t}\n\n\tnegate() {\n\n\t\tthis.constant *= - 1;\n\t\tthis.normal.negate();\n\n\t\treturn this;\n\n\t}\n\n\tdistanceToPoint( point ) {\n\n\t\treturn this.normal.dot( point ) + this.constant;\n\n\t}\n\n\tdistanceToSphere( sphere ) {\n\n\t\treturn this.distanceToPoint( sphere.center ) - sphere.radius;\n\n\t}\n\n\tprojectPoint( point, target ) {\n\n\t\treturn target.copy( this.normal ).multiplyScalar( - this.distanceToPoint( point ) ).add( point );\n\n\t}\n\n\tintersectLine( line, target ) {\n\n\t\tconst direction = line.delta( _vector1 );\n\n\t\tconst denominator = this.normal.dot( direction );\n\n\t\tif ( denominator === 0 ) {\n\n\t\t\t// line is coplanar, return origin\n\t\t\tif ( this.distanceToPoint( line.start ) === 0 ) {\n\n\t\t\t\treturn target.copy( line.start );\n\n\t\t\t}\n\n\t\t\t// Unsure if this is the correct method to handle this case.\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst t = - ( line.start.dot( this.normal ) + this.constant ) / denominator;\n\n\t\tif ( t < 0 || t > 1 ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\treturn target.copy( direction ).multiplyScalar( t ).add( line.start );\n\n\t}\n\n\tintersectsLine( line ) {\n\n\t\t// Note: this tests if a line intersects the plane, not whether it (or its end-points) are coplanar with it.\n\n\t\tconst startSign = this.distanceToPoint( line.start );\n\t\tconst endSign = this.distanceToPoint( line.end );\n\n\t\treturn ( startSign < 0 && endSign > 0 ) || ( endSign < 0 && startSign > 0 );\n\n\t}\n\n\tintersectsBox( box ) {\n\n\t\treturn box.intersectsPlane( this );\n\n\t}\n\n\tintersectsSphere( sphere ) {\n\n\t\treturn sphere.intersectsPlane( this );\n\n\t}\n\n\tcoplanarPoint( target ) {\n\n\t\treturn target.copy( this.normal ).multiplyScalar( - this.constant );\n\n\t}\n\n\tapplyMatrix4( matrix, optionalNormalMatrix ) {\n\n\t\tconst normalMatrix = optionalNormalMatrix || _normalMatrix.getNormalMatrix( matrix );\n\n\t\tconst referencePoint = this.coplanarPoint( _vector1 ).applyMatrix4( matrix );\n\n\t\tconst normal = this.normal.applyMatrix3( normalMatrix ).normalize();\n\n\t\tthis.constant = - referencePoint.dot( normal );\n\n\t\treturn this;\n\n\t}\n\n\ttranslate( offset ) {\n\n\t\tthis.constant -= offset.dot( this.normal );\n\n\t\treturn this;\n\n\t}\n\n\tequals( plane ) {\n\n\t\treturn plane.normal.equals( this.normal ) && ( plane.constant === this.constant );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n}\n\nconst _sphere$2 = /*@__PURE__*/ new Sphere();\nconst _vector$7 = /*@__PURE__*/ new Vector3();\n\nclass Frustum {\n\n\tconstructor( p0 = new Plane(), p1 = new Plane(), p2 = new Plane(), p3 = new Plane(), p4 = new Plane(), p5 = new Plane() ) {\n\n\t\tthis.planes = [ p0, p1, p2, p3, p4, p5 ];\n\n\t}\n\n\tset( p0, p1, p2, p3, p4, p5 ) {\n\n\t\tconst planes = this.planes;\n\n\t\tplanes[ 0 ].copy( p0 );\n\t\tplanes[ 1 ].copy( p1 );\n\t\tplanes[ 2 ].copy( p2 );\n\t\tplanes[ 3 ].copy( p3 );\n\t\tplanes[ 4 ].copy( p4 );\n\t\tplanes[ 5 ].copy( p5 );\n\n\t\treturn this;\n\n\t}\n\n\tcopy( frustum ) {\n\n\t\tconst planes = this.planes;\n\n\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\tplanes[ i ].copy( frustum.planes[ i ] );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetFromProjectionMatrix( m ) {\n\n\t\tconst planes = this.planes;\n\t\tconst me = m.elements;\n\t\tconst me0 = me[ 0 ], me1 = me[ 1 ], me2 = me[ 2 ], me3 = me[ 3 ];\n\t\tconst me4 = me[ 4 ], me5 = me[ 5 ], me6 = me[ 6 ], me7 = me[ 7 ];\n\t\tconst me8 = me[ 8 ], me9 = me[ 9 ], me10 = me[ 10 ], me11 = me[ 11 ];\n\t\tconst me12 = me[ 12 ], me13 = me[ 13 ], me14 = me[ 14 ], me15 = me[ 15 ];\n\n\t\tplanes[ 0 ].setComponents( me3 - me0, me7 - me4, me11 - me8, me15 - me12 ).normalize();\n\t\tplanes[ 1 ].setComponents( me3 + me0, me7 + me4, me11 + me8, me15 + me12 ).normalize();\n\t\tplanes[ 2 ].setComponents( me3 + me1, me7 + me5, me11 + me9, me15 + me13 ).normalize();\n\t\tplanes[ 3 ].setComponents( me3 - me1, me7 - me5, me11 - me9, me15 - me13 ).normalize();\n\t\tplanes[ 4 ].setComponents( me3 - me2, me7 - me6, me11 - me10, me15 - me14 ).normalize();\n\t\tplanes[ 5 ].setComponents( me3 + me2, me7 + me6, me11 + me10, me15 + me14 ).normalize();\n\n\t\treturn this;\n\n\t}\n\n\tintersectsObject( object ) {\n\n\t\tconst geometry = object.geometry;\n\n\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\n\n\t\t_sphere$2.copy( geometry.boundingSphere ).applyMatrix4( object.matrixWorld );\n\n\t\treturn this.intersectsSphere( _sphere$2 );\n\n\t}\n\n\tintersectsSprite( sprite ) {\n\n\t\t_sphere$2.center.set( 0, 0, 0 );\n\t\t_sphere$2.radius = 0.7071067811865476;\n\t\t_sphere$2.applyMatrix4( sprite.matrixWorld );\n\n\t\treturn this.intersectsSphere( _sphere$2 );\n\n\t}\n\n\tintersectsSphere( sphere ) {\n\n\t\tconst planes = this.planes;\n\t\tconst center = sphere.center;\n\t\tconst negRadius = - sphere.radius;\n\n\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\tconst distance = planes[ i ].distanceToPoint( center );\n\n\t\t\tif ( distance < negRadius ) {\n\n\t\t\t\treturn false;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tintersectsBox( box ) {\n\n\t\tconst planes = this.planes;\n\n\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\tconst plane = planes[ i ];\n\n\t\t\t// corner at max distance\n\n\t\t\t_vector$7.x = plane.normal.x > 0 ? box.max.x : box.min.x;\n\t\t\t_vector$7.y = plane.normal.y > 0 ? box.max.y : box.min.y;\n\t\t\t_vector$7.z = plane.normal.z > 0 ? box.max.z : box.min.z;\n\n\t\t\tif ( plane.distanceToPoint( _vector$7 ) < 0 ) {\n\n\t\t\t\treturn false;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tcontainsPoint( point ) {\n\n\t\tconst planes = this.planes;\n\n\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\tif ( planes[ i ].distanceToPoint( point ) < 0 ) {\n\n\t\t\t\treturn false;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n}\n\nfunction WebGLAnimation() {\n\n\tlet context = null;\n\tlet isAnimating = false;\n\tlet animationLoop = null;\n\tlet requestId = null;\n\n\tfunction onAnimationFrame( time, frame ) {\n\n\t\tanimationLoop( time, frame );\n\n\t\trequestId = context.requestAnimationFrame( onAnimationFrame );\n\n\t}\n\n\treturn {\n\n\t\tstart: function () {\n\n\t\t\tif ( isAnimating === true ) return;\n\t\t\tif ( animationLoop === null ) return;\n\n\t\t\trequestId = context.requestAnimationFrame( onAnimationFrame );\n\n\t\t\tisAnimating = true;\n\n\t\t},\n\n\t\tstop: function () {\n\n\t\t\tcontext.cancelAnimationFrame( requestId );\n\n\t\t\tisAnimating = false;\n\n\t\t},\n\n\t\tsetAnimationLoop: function ( callback ) {\n\n\t\t\tanimationLoop = callback;\n\n\t\t},\n\n\t\tsetContext: function ( value ) {\n\n\t\t\tcontext = value;\n\n\t\t}\n\n\t};\n\n}\n\nfunction WebGLAttributes( gl, capabilities ) {\n\n\tconst isWebGL2 = capabilities.isWebGL2;\n\n\tconst buffers = new WeakMap();\n\n\tfunction createBuffer( attribute, bufferType ) {\n\n\t\tconst array = attribute.array;\n\t\tconst usage = attribute.usage;\n\n\t\tconst buffer = gl.createBuffer();\n\n\t\tgl.bindBuffer( bufferType, buffer );\n\t\tgl.bufferData( bufferType, array, usage );\n\n\t\tattribute.onUploadCallback();\n\n\t\tlet type;\n\n\t\tif ( array instanceof Float32Array ) {\n\n\t\t\ttype = 5126;\n\n\t\t} else if ( array instanceof Uint16Array ) {\n\n\t\t\tif ( attribute.isFloat16BufferAttribute ) {\n\n\t\t\t\tif ( isWebGL2 ) {\n\n\t\t\t\t\ttype = 5131;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthrow new Error( 'THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.' );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\ttype = 5123;\n\n\t\t\t}\n\n\t\t} else if ( array instanceof Int16Array ) {\n\n\t\t\ttype = 5122;\n\n\t\t} else if ( array instanceof Uint32Array ) {\n\n\t\t\ttype = 5125;\n\n\t\t} else if ( array instanceof Int32Array ) {\n\n\t\t\ttype = 5124;\n\n\t\t} else if ( array instanceof Int8Array ) {\n\n\t\t\ttype = 5120;\n\n\t\t} else if ( array instanceof Uint8Array ) {\n\n\t\t\ttype = 5121;\n\n\t\t} else if ( array instanceof Uint8ClampedArray ) {\n\n\t\t\ttype = 5121;\n\n\t\t} else {\n\n\t\t\tthrow new Error( 'THREE.WebGLAttributes: Unsupported buffer data format: ' + array );\n\n\t\t}\n\n\t\treturn {\n\t\t\tbuffer: buffer,\n\t\t\ttype: type,\n\t\t\tbytesPerElement: array.BYTES_PER_ELEMENT,\n\t\t\tversion: attribute.version\n\t\t};\n\n\t}\n\n\tfunction updateBuffer( buffer, attribute, bufferType ) {\n\n\t\tconst array = attribute.array;\n\t\tconst updateRange = attribute.updateRange;\n\n\t\tgl.bindBuffer( bufferType, buffer );\n\n\t\tif ( updateRange.count === - 1 ) {\n\n\t\t\t// Not using update ranges\n\n\t\t\tgl.bufferSubData( bufferType, 0, array );\n\n\t\t} else {\n\n\t\t\tif ( isWebGL2 ) {\n\n\t\t\t\tgl.bufferSubData( bufferType, updateRange.offset * array.BYTES_PER_ELEMENT,\n\t\t\t\t\tarray, updateRange.offset, updateRange.count );\n\n\t\t\t} else {\n\n\t\t\t\tgl.bufferSubData( bufferType, updateRange.offset * array.BYTES_PER_ELEMENT,\n\t\t\t\t\tarray.subarray( updateRange.offset, updateRange.offset + updateRange.count ) );\n\n\t\t\t}\n\n\t\t\tupdateRange.count = - 1; // reset range\n\n\t\t}\n\n\t\tattribute.onUploadCallback();\n\n\t}\n\n\t//\n\n\tfunction get( attribute ) {\n\n\t\tif ( attribute.isInterleavedBufferAttribute ) attribute = attribute.data;\n\n\t\treturn buffers.get( attribute );\n\n\t}\n\n\tfunction remove( attribute ) {\n\n\t\tif ( attribute.isInterleavedBufferAttribute ) attribute = attribute.data;\n\n\t\tconst data = buffers.get( attribute );\n\n\t\tif ( data ) {\n\n\t\t\tgl.deleteBuffer( data.buffer );\n\n\t\t\tbuffers.delete( attribute );\n\n\t\t}\n\n\t}\n\n\tfunction update( attribute, bufferType ) {\n\n\t\tif ( attribute.isGLBufferAttribute ) {\n\n\t\t\tconst cached = buffers.get( attribute );\n\n\t\t\tif ( ! cached || cached.version < attribute.version ) {\n\n\t\t\t\tbuffers.set( attribute, {\n\t\t\t\t\tbuffer: attribute.buffer,\n\t\t\t\t\ttype: attribute.type,\n\t\t\t\t\tbytesPerElement: attribute.elementSize,\n\t\t\t\t\tversion: attribute.version\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( attribute.isInterleavedBufferAttribute ) attribute = attribute.data;\n\n\t\tconst data = buffers.get( attribute );\n\n\t\tif ( data === undefined ) {\n\n\t\t\tbuffers.set( attribute, createBuffer( attribute, bufferType ) );\n\n\t\t} else if ( data.version < attribute.version ) {\n\n\t\t\tupdateBuffer( data.buffer, attribute, bufferType );\n\n\t\t\tdata.version = attribute.version;\n\n\t\t}\n\n\t}\n\n\treturn {\n\n\t\tget: get,\n\t\tremove: remove,\n\t\tupdate: update\n\n\t};\n\n}\n\nclass PlaneGeometry extends BufferGeometry {\n\n\tconstructor( width = 1, height = 1, widthSegments = 1, heightSegments = 1 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'PlaneGeometry';\n\n\t\tthis.parameters = {\n\t\t\twidth: width,\n\t\t\theight: height,\n\t\t\twidthSegments: widthSegments,\n\t\t\theightSegments: heightSegments\n\t\t};\n\n\t\tconst width_half = width / 2;\n\t\tconst height_half = height / 2;\n\n\t\tconst gridX = Math.floor( widthSegments );\n\t\tconst gridY = Math.floor( heightSegments );\n\n\t\tconst gridX1 = gridX + 1;\n\t\tconst gridY1 = gridY + 1;\n\n\t\tconst segment_width = width / gridX;\n\t\tconst segment_height = height / gridY;\n\n\t\t//\n\n\t\tconst indices = [];\n\t\tconst vertices = [];\n\t\tconst normals = [];\n\t\tconst uvs = [];\n\n\t\tfor ( let iy = 0; iy < gridY1; iy ++ ) {\n\n\t\t\tconst y = iy * segment_height - height_half;\n\n\t\t\tfor ( let ix = 0; ix < gridX1; ix ++ ) {\n\n\t\t\t\tconst x = ix * segment_width - width_half;\n\n\t\t\t\tvertices.push( x, - y, 0 );\n\n\t\t\t\tnormals.push( 0, 0, 1 );\n\n\t\t\t\tuvs.push( ix / gridX );\n\t\t\t\tuvs.push( 1 - ( iy / gridY ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfor ( let iy = 0; iy < gridY; iy ++ ) {\n\n\t\t\tfor ( let ix = 0; ix < gridX; ix ++ ) {\n\n\t\t\t\tconst a = ix + gridX1 * iy;\n\t\t\t\tconst b = ix + gridX1 * ( iy + 1 );\n\t\t\t\tconst c = ( ix + 1 ) + gridX1 * ( iy + 1 );\n\t\t\t\tconst d = ( ix + 1 ) + gridX1 * iy;\n\n\t\t\t\tindices.push( a, b, d );\n\t\t\t\tindices.push( b, c, d );\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new PlaneGeometry( data.width, data.height, data.widthSegments, data.heightSegments );\n\n\t}\n\n}\n\nvar alphamap_fragment = \"#ifdef USE_ALPHAMAP\\n\\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\\n#endif\";\n\nvar alphamap_pars_fragment = \"#ifdef USE_ALPHAMAP\\n\\tuniform sampler2D alphaMap;\\n#endif\";\n\nvar alphatest_fragment = \"#ifdef USE_ALPHATEST\\n\\tif ( diffuseColor.a < alphaTest ) discard;\\n#endif\";\n\nvar alphatest_pars_fragment = \"#ifdef USE_ALPHATEST\\n\\tuniform float alphaTest;\\n#endif\";\n\nvar aomap_fragment = \"#ifdef USE_AOMAP\\n\\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\\n\\treflectedLight.indirectDiffuse *= ambientOcclusion;\\n\\t#if defined( USE_ENVMAP ) && defined( STANDARD )\\n\\t\\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\\n\\t\\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\\n\\t#endif\\n#endif\";\n\nvar aomap_pars_fragment = \"#ifdef USE_AOMAP\\n\\tuniform sampler2D aoMap;\\n\\tuniform float aoMapIntensity;\\n#endif\";\n\nvar begin_vertex = \"vec3 transformed = vec3( position );\";\n\nvar beginnormal_vertex = \"vec3 objectNormal = vec3( normal );\\n#ifdef USE_TANGENT\\n\\tvec3 objectTangent = vec3( tangent.xyz );\\n#endif\";\n\nvar bsdfs = \"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\\n\\treturn RECIPROCAL_PI * diffuseColor;\\n}\\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\\n\\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\\n\\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\\n}\\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\\n\\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\\n\\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\\n}\\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\\n    float x2 = x * x;\\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\\n}\\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\\n\\tfloat a2 = pow2( alpha );\\n\\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\\n\\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\\n\\treturn 0.5 / max( gv + gl, EPSILON );\\n}\\nfloat D_GGX( const in float alpha, const in float dotNH ) {\\n\\tfloat a2 = pow2( alpha );\\n\\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\\n\\treturn RECIPROCAL_PI * a2 / pow2( denom );\\n}\\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\\n\\tfloat alpha = pow2( roughness );\\n\\tvec3 halfDir = normalize( lightDir + viewDir );\\n\\tfloat dotNL = saturate( dot( normal, lightDir ) );\\n\\tfloat dotNV = saturate( dot( normal, viewDir ) );\\n\\tfloat dotNH = saturate( dot( normal, halfDir ) );\\n\\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\\n\\tvec3 F = F_Schlick( f0, f90, dotVH );\\n\\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\\n\\tfloat D = D_GGX( alpha, dotNH );\\n\\treturn F * ( V * D );\\n}\\n#ifdef USE_IRIDESCENCE\\n\\tvec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {\\n\\t\\tfloat alpha = pow2( roughness );\\n\\t\\tvec3 halfDir = normalize( lightDir + viewDir );\\n\\t\\tfloat dotNL = saturate( dot( normal, lightDir ) );\\n\\t\\tfloat dotNV = saturate( dot( normal, viewDir ) );\\n\\t\\tfloat dotNH = saturate( dot( normal, halfDir ) );\\n\\t\\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\\n\\t\\tvec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );\\n\\t\\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\\n\\t\\tfloat D = D_GGX( alpha, dotNH );\\n\\t\\treturn F * ( V * D );\\n\\t}\\n#endif\\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\\n\\tconst float LUT_SIZE = 64.0;\\n\\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\\n\\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\\n\\tfloat dotNV = saturate( dot( N, V ) );\\n\\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\\n\\tuv = uv * LUT_SCALE + LUT_BIAS;\\n\\treturn uv;\\n}\\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\\n\\tfloat l = length( f );\\n\\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\\n}\\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\\n\\tfloat x = dot( v1, v2 );\\n\\tfloat y = abs( x );\\n\\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\\n\\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\\n\\tfloat v = a / b;\\n\\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\\n\\treturn cross( v1, v2 ) * theta_sintheta;\\n}\\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\\n\\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\\n\\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\\n\\tvec3 lightNormal = cross( v1, v2 );\\n\\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\\n\\tvec3 T1, T2;\\n\\tT1 = normalize( V - N * dot( V, N ) );\\n\\tT2 = - cross( N, T1 );\\n\\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\\n\\tvec3 coords[ 4 ];\\n\\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\\n\\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\\n\\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\\n\\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\\n\\tcoords[ 0 ] = normalize( coords[ 0 ] );\\n\\tcoords[ 1 ] = normalize( coords[ 1 ] );\\n\\tcoords[ 2 ] = normalize( coords[ 2 ] );\\n\\tcoords[ 3 ] = normalize( coords[ 3 ] );\\n\\tvec3 vectorFormFactor = vec3( 0.0 );\\n\\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\\n\\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\\n\\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\\n\\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\\n\\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\\n\\treturn vec3( result );\\n}\\nfloat G_BlinnPhong_Implicit( ) {\\n\\treturn 0.25;\\n}\\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\\n\\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\\n}\\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\\n\\tvec3 halfDir = normalize( lightDir + viewDir );\\n\\tfloat dotNH = saturate( dot( normal, halfDir ) );\\n\\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\\n\\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\\n\\tfloat G = G_BlinnPhong_Implicit( );\\n\\tfloat D = D_BlinnPhong( shininess, dotNH );\\n\\treturn F * ( G * D );\\n}\\n#if defined( USE_SHEEN )\\nfloat D_Charlie( float roughness, float dotNH ) {\\n\\tfloat alpha = pow2( roughness );\\n\\tfloat invAlpha = 1.0 / alpha;\\n\\tfloat cos2h = dotNH * dotNH;\\n\\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\\n\\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\\n}\\nfloat V_Neubelt( float dotNV, float dotNL ) {\\n\\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\\n}\\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\\n\\tvec3 halfDir = normalize( lightDir + viewDir );\\n\\tfloat dotNL = saturate( dot( normal, lightDir ) );\\n\\tfloat dotNV = saturate( dot( normal, viewDir ) );\\n\\tfloat dotNH = saturate( dot( normal, halfDir ) );\\n\\tfloat D = D_Charlie( sheenRoughness, dotNH );\\n\\tfloat V = V_Neubelt( dotNV, dotNL );\\n\\treturn sheenColor * ( D * V );\\n}\\n#endif\";\n\nvar iridescence_fragment = \"#ifdef USE_IRIDESCENCE\\n\\tconst mat3 XYZ_TO_REC709 = mat3(\\n\\t\\t 3.2404542, -0.9692660,  0.0556434,\\n\\t\\t-1.5371385,  1.8760108, -0.2040259,\\n\\t\\t-0.4985314,  0.0415560,  1.0572252\\n\\t);\\n\\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\\n\\t\\tvec3 sqrtF0 = sqrt( fresnel0 );\\n\\t\\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\\n\\t}\\n\\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\\n\\t\\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\\n\\t}\\n\\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\\n\\t\\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\\n\\t}\\n\\tvec3 evalSensitivity( float OPD, vec3 shift ) {\\n\\t\\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\\n\\t\\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\\n\\t\\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\\n\\t\\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\\n\\t\\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\\n\\t\\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\\n\\t\\txyz /= 1.0685e-7;\\n\\t\\tvec3 rgb = XYZ_TO_REC709 * xyz;\\n\\t\\treturn rgb;\\n\\t}\\n\\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\\n\\t\\tvec3 I;\\n\\t\\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\\n\\t\\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\\n\\t\\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\\n\\t\\tif ( cosTheta2Sq < 0.0 ) {\\n\\t\\t\\t return vec3( 1.0 );\\n\\t\\t}\\n\\t\\tfloat cosTheta2 = sqrt( cosTheta2Sq );\\n\\t\\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\\n\\t\\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\\n\\t\\tfloat R21 = R12;\\n\\t\\tfloat T121 = 1.0 - R12;\\n\\t\\tfloat phi12 = 0.0;\\n\\t\\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\\n\\t\\tfloat phi21 = PI - phi12;\\n\\t\\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\\t\\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\\n\\t\\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\\n\\t\\tvec3 phi23 = vec3( 0.0 );\\n\\t\\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\\n\\t\\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\\n\\t\\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\\n\\t\\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\\n\\t\\tvec3 phi = vec3( phi21 ) + phi23;\\n\\t\\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\\n\\t\\tvec3 r123 = sqrt( R123 );\\n\\t\\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\\n\\t\\tvec3 C0 = R12 + Rs;\\n\\t\\tI = C0;\\n\\t\\tvec3 Cm = Rs - T121;\\n\\t\\tfor ( int m = 1; m <= 2; ++ m ) {\\n\\t\\t\\tCm *= r123;\\n\\t\\t\\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\\n\\t\\t\\tI += Cm * Sm;\\n\\t\\t}\\n\\t\\treturn max( I, vec3( 0.0 ) );\\n\\t}\\n#endif\";\n\nvar bumpmap_pars_fragment = \"#ifdef USE_BUMPMAP\\n\\tuniform sampler2D bumpMap;\\n\\tuniform float bumpScale;\\n\\tvec2 dHdxy_fwd() {\\n\\t\\tvec2 dSTdx = dFdx( vUv );\\n\\t\\tvec2 dSTdy = dFdy( vUv );\\n\\t\\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\\n\\t\\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\\n\\t\\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\\n\\t\\treturn vec2( dBx, dBy );\\n\\t}\\n\\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\\n\\t\\tvec3 vSigmaX = dFdx( surf_pos.xyz );\\n\\t\\tvec3 vSigmaY = dFdy( surf_pos.xyz );\\n\\t\\tvec3 vN = surf_norm;\\n\\t\\tvec3 R1 = cross( vSigmaY, vN );\\n\\t\\tvec3 R2 = cross( vN, vSigmaX );\\n\\t\\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\\n\\t\\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\\n\\t\\treturn normalize( abs( fDet ) * surf_norm - vGrad );\\n\\t}\\n#endif\";\n\nvar clipping_planes_fragment = \"#if NUM_CLIPPING_PLANES > 0\\n\\tvec4 plane;\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\\n\\t\\tplane = clippingPlanes[ i ];\\n\\t\\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\\n\\t}\\n\\t#pragma unroll_loop_end\\n\\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\\n\\t\\tbool clipped = true;\\n\\t\\t#pragma unroll_loop_start\\n\\t\\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\\n\\t\\t\\tplane = clippingPlanes[ i ];\\n\\t\\t\\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\\n\\t\\t}\\n\\t\\t#pragma unroll_loop_end\\n\\t\\tif ( clipped ) discard;\\n\\t#endif\\n#endif\";\n\nvar clipping_planes_pars_fragment = \"#if NUM_CLIPPING_PLANES > 0\\n\\tvarying vec3 vClipPosition;\\n\\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\\n#endif\";\n\nvar clipping_planes_pars_vertex = \"#if NUM_CLIPPING_PLANES > 0\\n\\tvarying vec3 vClipPosition;\\n#endif\";\n\nvar clipping_planes_vertex = \"#if NUM_CLIPPING_PLANES > 0\\n\\tvClipPosition = - mvPosition.xyz;\\n#endif\";\n\nvar color_fragment = \"#if defined( USE_COLOR_ALPHA )\\n\\tdiffuseColor *= vColor;\\n#elif defined( USE_COLOR )\\n\\tdiffuseColor.rgb *= vColor;\\n#endif\";\n\nvar color_pars_fragment = \"#if defined( USE_COLOR_ALPHA )\\n\\tvarying vec4 vColor;\\n#elif defined( USE_COLOR )\\n\\tvarying vec3 vColor;\\n#endif\";\n\nvar color_pars_vertex = \"#if defined( USE_COLOR_ALPHA )\\n\\tvarying vec4 vColor;\\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\\n\\tvarying vec3 vColor;\\n#endif\";\n\nvar color_vertex = \"#if defined( USE_COLOR_ALPHA )\\n\\tvColor = vec4( 1.0 );\\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\\n\\tvColor = vec3( 1.0 );\\n#endif\\n#ifdef USE_COLOR\\n\\tvColor *= color;\\n#endif\\n#ifdef USE_INSTANCING_COLOR\\n\\tvColor.xyz *= instanceColor.xyz;\\n#endif\";\n\nvar common = \"#define PI 3.141592653589793\\n#define PI2 6.283185307179586\\n#define PI_HALF 1.5707963267948966\\n#define RECIPROCAL_PI 0.3183098861837907\\n#define RECIPROCAL_PI2 0.15915494309189535\\n#define EPSILON 1e-6\\n#ifndef saturate\\n#define saturate( a ) clamp( a, 0.0, 1.0 )\\n#endif\\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\\nfloat pow2( const in float x ) { return x*x; }\\nvec3 pow2( const in vec3 x ) { return x*x; }\\nfloat pow3( const in float x ) { return x*x*x; }\\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\\nhighp float rand( const in vec2 uv ) {\\n\\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\\n\\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\\n\\treturn fract( sin( sn ) * c );\\n}\\n#ifdef HIGH_PRECISION\\n\\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\\n#else\\n\\tfloat precisionSafeLength( vec3 v ) {\\n\\t\\tfloat maxComponent = max3( abs( v ) );\\n\\t\\treturn length( v / maxComponent ) * maxComponent;\\n\\t}\\n#endif\\nstruct IncidentLight {\\n\\tvec3 color;\\n\\tvec3 direction;\\n\\tbool visible;\\n};\\nstruct ReflectedLight {\\n\\tvec3 directDiffuse;\\n\\tvec3 directSpecular;\\n\\tvec3 indirectDiffuse;\\n\\tvec3 indirectSpecular;\\n};\\nstruct GeometricContext {\\n\\tvec3 position;\\n\\tvec3 normal;\\n\\tvec3 viewDir;\\n#ifdef USE_CLEARCOAT\\n\\tvec3 clearcoatNormal;\\n#endif\\n};\\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\\n\\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\\n}\\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\\n\\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\\n}\\nmat3 transposeMat3( const in mat3 m ) {\\n\\tmat3 tmp;\\n\\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\\n\\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\\n\\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\\n\\treturn tmp;\\n}\\nfloat luminance( const in vec3 rgb ) {\\n\\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\\n\\treturn dot( weights, rgb );\\n}\\nbool isPerspectiveMatrix( mat4 m ) {\\n\\treturn m[ 2 ][ 3 ] == - 1.0;\\n}\\nvec2 equirectUv( in vec3 dir ) {\\n\\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\\n\\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\\n\\treturn vec2( u, v );\\n}\";\n\nvar cube_uv_reflection_fragment = \"#ifdef ENVMAP_TYPE_CUBE_UV\\n\\t#define cubeUV_minMipLevel 4.0\\n\\t#define cubeUV_minTileSize 16.0\\n\\tfloat getFace( vec3 direction ) {\\n\\t\\tvec3 absDirection = abs( direction );\\n\\t\\tfloat face = - 1.0;\\n\\t\\tif ( absDirection.x > absDirection.z ) {\\n\\t\\t\\tif ( absDirection.x > absDirection.y )\\n\\t\\t\\t\\tface = direction.x > 0.0 ? 0.0 : 3.0;\\n\\t\\t\\telse\\n\\t\\t\\t\\tface = direction.y > 0.0 ? 1.0 : 4.0;\\n\\t\\t} else {\\n\\t\\t\\tif ( absDirection.z > absDirection.y )\\n\\t\\t\\t\\tface = direction.z > 0.0 ? 2.0 : 5.0;\\n\\t\\t\\telse\\n\\t\\t\\t\\tface = direction.y > 0.0 ? 1.0 : 4.0;\\n\\t\\t}\\n\\t\\treturn face;\\n\\t}\\n\\tvec2 getUV( vec3 direction, float face ) {\\n\\t\\tvec2 uv;\\n\\t\\tif ( face == 0.0 ) {\\n\\t\\t\\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\\n\\t\\t} else if ( face == 1.0 ) {\\n\\t\\t\\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\\n\\t\\t} else if ( face == 2.0 ) {\\n\\t\\t\\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\\n\\t\\t} else if ( face == 3.0 ) {\\n\\t\\t\\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\\n\\t\\t} else if ( face == 4.0 ) {\\n\\t\\t\\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\\n\\t\\t} else {\\n\\t\\t\\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\\n\\t\\t}\\n\\t\\treturn 0.5 * ( uv + 1.0 );\\n\\t}\\n\\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\\n\\t\\tfloat face = getFace( direction );\\n\\t\\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\\n\\t\\tmipInt = max( mipInt, cubeUV_minMipLevel );\\n\\t\\tfloat faceSize = exp2( mipInt );\\n\\t\\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\\n\\t\\tif ( face > 2.0 ) {\\n\\t\\t\\tuv.y += faceSize;\\n\\t\\t\\tface -= 3.0;\\n\\t\\t}\\n\\t\\tuv.x += face * faceSize;\\n\\t\\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\\n\\t\\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\\n\\t\\tuv.x *= CUBEUV_TEXEL_WIDTH;\\n\\t\\tuv.y *= CUBEUV_TEXEL_HEIGHT;\\n\\t\\t#ifdef texture2DGradEXT\\n\\t\\t\\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\\n\\t\\t#else\\n\\t\\t\\treturn texture2D( envMap, uv ).rgb;\\n\\t\\t#endif\\n\\t}\\n\\t#define cubeUV_r0 1.0\\n\\t#define cubeUV_v0 0.339\\n\\t#define cubeUV_m0 - 2.0\\n\\t#define cubeUV_r1 0.8\\n\\t#define cubeUV_v1 0.276\\n\\t#define cubeUV_m1 - 1.0\\n\\t#define cubeUV_r4 0.4\\n\\t#define cubeUV_v4 0.046\\n\\t#define cubeUV_m4 2.0\\n\\t#define cubeUV_r5 0.305\\n\\t#define cubeUV_v5 0.016\\n\\t#define cubeUV_m5 3.0\\n\\t#define cubeUV_r6 0.21\\n\\t#define cubeUV_v6 0.0038\\n\\t#define cubeUV_m6 4.0\\n\\tfloat roughnessToMip( float roughness ) {\\n\\t\\tfloat mip = 0.0;\\n\\t\\tif ( roughness >= cubeUV_r1 ) {\\n\\t\\t\\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\\n\\t\\t} else if ( roughness >= cubeUV_r4 ) {\\n\\t\\t\\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\\n\\t\\t} else if ( roughness >= cubeUV_r5 ) {\\n\\t\\t\\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\\n\\t\\t} else if ( roughness >= cubeUV_r6 ) {\\n\\t\\t\\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\\n\\t\\t} else {\\n\\t\\t\\tmip = - 2.0 * log2( 1.16 * roughness );\\t\\t}\\n\\t\\treturn mip;\\n\\t}\\n\\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\\n\\t\\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\\n\\t\\tfloat mipF = fract( mip );\\n\\t\\tfloat mipInt = floor( mip );\\n\\t\\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\\n\\t\\tif ( mipF == 0.0 ) {\\n\\t\\t\\treturn vec4( color0, 1.0 );\\n\\t\\t} else {\\n\\t\\t\\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\\n\\t\\t\\treturn vec4( mix( color0, color1, mipF ), 1.0 );\\n\\t\\t}\\n\\t}\\n#endif\";\n\nvar defaultnormal_vertex = \"vec3 transformedNormal = objectNormal;\\n#ifdef USE_INSTANCING\\n\\tmat3 m = mat3( instanceMatrix );\\n\\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\\n\\ttransformedNormal = m * transformedNormal;\\n#endif\\ntransformedNormal = normalMatrix * transformedNormal;\\n#ifdef FLIP_SIDED\\n\\ttransformedNormal = - transformedNormal;\\n#endif\\n#ifdef USE_TANGENT\\n\\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\\n\\t#ifdef FLIP_SIDED\\n\\t\\ttransformedTangent = - transformedTangent;\\n\\t#endif\\n#endif\";\n\nvar displacementmap_pars_vertex = \"#ifdef USE_DISPLACEMENTMAP\\n\\tuniform sampler2D displacementMap;\\n\\tuniform float displacementScale;\\n\\tuniform float displacementBias;\\n#endif\";\n\nvar displacementmap_vertex = \"#ifdef USE_DISPLACEMENTMAP\\n\\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\\n#endif\";\n\nvar emissivemap_fragment = \"#ifdef USE_EMISSIVEMAP\\n\\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\\n\\ttotalEmissiveRadiance *= emissiveColor.rgb;\\n#endif\";\n\nvar emissivemap_pars_fragment = \"#ifdef USE_EMISSIVEMAP\\n\\tuniform sampler2D emissiveMap;\\n#endif\";\n\nvar encodings_fragment = \"gl_FragColor = linearToOutputTexel( gl_FragColor );\";\n\nvar encodings_pars_fragment = \"vec4 LinearToLinear( in vec4 value ) {\\n\\treturn value;\\n}\\nvec4 LinearTosRGB( in vec4 value ) {\\n\\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\\n}\";\n\nvar envmap_fragment = \"#ifdef USE_ENVMAP\\n\\t#ifdef ENV_WORLDPOS\\n\\t\\tvec3 cameraToFrag;\\n\\t\\tif ( isOrthographic ) {\\n\\t\\t\\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\\n\\t\\t} else {\\n\\t\\t\\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\\n\\t\\t}\\n\\t\\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\\n\\t\\t#ifdef ENVMAP_MODE_REFLECTION\\n\\t\\t\\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\\n\\t\\t#else\\n\\t\\t\\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\\n\\t\\t#endif\\n\\t#else\\n\\t\\tvec3 reflectVec = vReflect;\\n\\t#endif\\n\\t#ifdef ENVMAP_TYPE_CUBE\\n\\t\\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\\n\\t#else\\n\\t\\tvec4 envColor = vec4( 0.0 );\\n\\t#endif\\n\\t#ifdef ENVMAP_BLENDING_MULTIPLY\\n\\t\\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\\n\\t#elif defined( ENVMAP_BLENDING_MIX )\\n\\t\\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\\n\\t#elif defined( ENVMAP_BLENDING_ADD )\\n\\t\\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\\n\\t#endif\\n#endif\";\n\nvar envmap_common_pars_fragment = \"#ifdef USE_ENVMAP\\n\\tuniform float envMapIntensity;\\n\\tuniform float flipEnvMap;\\n\\t#ifdef ENVMAP_TYPE_CUBE\\n\\t\\tuniform samplerCube envMap;\\n\\t#else\\n\\t\\tuniform sampler2D envMap;\\n\\t#endif\\n\\t\\n#endif\";\n\nvar envmap_pars_fragment = \"#ifdef USE_ENVMAP\\n\\tuniform float reflectivity;\\n\\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\\n\\t\\t#define ENV_WORLDPOS\\n\\t#endif\\n\\t#ifdef ENV_WORLDPOS\\n\\t\\tvarying vec3 vWorldPosition;\\n\\t\\tuniform float refractionRatio;\\n\\t#else\\n\\t\\tvarying vec3 vReflect;\\n\\t#endif\\n#endif\";\n\nvar envmap_pars_vertex = \"#ifdef USE_ENVMAP\\n\\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\\n\\t\\t#define ENV_WORLDPOS\\n\\t#endif\\n\\t#ifdef ENV_WORLDPOS\\n\\t\\t\\n\\t\\tvarying vec3 vWorldPosition;\\n\\t#else\\n\\t\\tvarying vec3 vReflect;\\n\\t\\tuniform float refractionRatio;\\n\\t#endif\\n#endif\";\n\nvar envmap_vertex = \"#ifdef USE_ENVMAP\\n\\t#ifdef ENV_WORLDPOS\\n\\t\\tvWorldPosition = worldPosition.xyz;\\n\\t#else\\n\\t\\tvec3 cameraToVertex;\\n\\t\\tif ( isOrthographic ) {\\n\\t\\t\\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\\n\\t\\t} else {\\n\\t\\t\\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\\n\\t\\t}\\n\\t\\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\\n\\t\\t#ifdef ENVMAP_MODE_REFLECTION\\n\\t\\t\\tvReflect = reflect( cameraToVertex, worldNormal );\\n\\t\\t#else\\n\\t\\t\\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\\n\\t\\t#endif\\n\\t#endif\\n#endif\";\n\nvar fog_vertex = \"#ifdef USE_FOG\\n\\tvFogDepth = - mvPosition.z;\\n#endif\";\n\nvar fog_pars_vertex = \"#ifdef USE_FOG\\n\\tvarying float vFogDepth;\\n#endif\";\n\nvar fog_fragment = \"#ifdef USE_FOG\\n\\t#ifdef FOG_EXP2\\n\\t\\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\\n\\t#else\\n\\t\\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\\n\\t#endif\\n\\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\\n#endif\";\n\nvar fog_pars_fragment = \"#ifdef USE_FOG\\n\\tuniform vec3 fogColor;\\n\\tvarying float vFogDepth;\\n\\t#ifdef FOG_EXP2\\n\\t\\tuniform float fogDensity;\\n\\t#else\\n\\t\\tuniform float fogNear;\\n\\t\\tuniform float fogFar;\\n\\t#endif\\n#endif\";\n\nvar gradientmap_pars_fragment = \"#ifdef USE_GRADIENTMAP\\n\\tuniform sampler2D gradientMap;\\n#endif\\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\\n\\tfloat dotNL = dot( normal, lightDirection );\\n\\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\\n\\t#ifdef USE_GRADIENTMAP\\n\\t\\treturn vec3( texture2D( gradientMap, coord ).r );\\n\\t#else\\n\\t\\tvec2 fw = fwidth( coord ) * 0.5;\\n\\t\\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\\n\\t#endif\\n}\";\n\nvar lightmap_fragment = \"#ifdef USE_LIGHTMAP\\n\\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\\n\\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\\n\\treflectedLight.indirectDiffuse += lightMapIrradiance;\\n#endif\";\n\nvar lightmap_pars_fragment = \"#ifdef USE_LIGHTMAP\\n\\tuniform sampler2D lightMap;\\n\\tuniform float lightMapIntensity;\\n#endif\";\n\nvar lights_lambert_fragment = \"LambertMaterial material;\\nmaterial.diffuseColor = diffuseColor.rgb;\\nmaterial.specularStrength = specularStrength;\";\n\nvar lights_lambert_pars_fragment = \"varying vec3 vViewPosition;\\nstruct LambertMaterial {\\n\\tvec3 diffuseColor;\\n\\tfloat specularStrength;\\n};\\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\\n\\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\\n\\tvec3 irradiance = dotNL * directLight.color;\\n\\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\\n}\\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\\n\\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\\n}\\n#define RE_Direct\\t\\t\\t\\tRE_Direct_Lambert\\n#define RE_IndirectDiffuse\\t\\tRE_IndirectDiffuse_Lambert\";\n\nvar lights_pars_begin = \"uniform bool receiveShadow;\\nuniform vec3 ambientLightColor;\\nuniform vec3 lightProbe[ 9 ];\\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\\n\\tfloat x = normal.x, y = normal.y, z = normal.z;\\n\\tvec3 result = shCoefficients[ 0 ] * 0.886227;\\n\\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\\n\\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\\n\\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\\n\\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\\n\\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\\n\\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\\n\\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\\n\\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\\n\\treturn result;\\n}\\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\\n\\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\\n\\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\\n\\treturn irradiance;\\n}\\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\\n\\tvec3 irradiance = ambientLightColor;\\n\\treturn irradiance;\\n}\\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\\n\\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\\n\\t\\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\\n\\t\\tif ( cutoffDistance > 0.0 ) {\\n\\t\\t\\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\\n\\t\\t}\\n\\t\\treturn distanceFalloff;\\n\\t#else\\n\\t\\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\\n\\t\\t\\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\\n\\t\\t}\\n\\t\\treturn 1.0;\\n\\t#endif\\n}\\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\\n\\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\\n}\\n#if NUM_DIR_LIGHTS > 0\\n\\tstruct DirectionalLight {\\n\\t\\tvec3 direction;\\n\\t\\tvec3 color;\\n\\t};\\n\\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\\n\\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\\n\\t\\tlight.color = directionalLight.color;\\n\\t\\tlight.direction = directionalLight.direction;\\n\\t\\tlight.visible = true;\\n\\t}\\n#endif\\n#if NUM_POINT_LIGHTS > 0\\n\\tstruct PointLight {\\n\\t\\tvec3 position;\\n\\t\\tvec3 color;\\n\\t\\tfloat distance;\\n\\t\\tfloat decay;\\n\\t};\\n\\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\\n\\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\\n\\t\\tvec3 lVector = pointLight.position - geometry.position;\\n\\t\\tlight.direction = normalize( lVector );\\n\\t\\tfloat lightDistance = length( lVector );\\n\\t\\tlight.color = pointLight.color;\\n\\t\\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\\n\\t\\tlight.visible = ( light.color != vec3( 0.0 ) );\\n\\t}\\n#endif\\n#if NUM_SPOT_LIGHTS > 0\\n\\tstruct SpotLight {\\n\\t\\tvec3 position;\\n\\t\\tvec3 direction;\\n\\t\\tvec3 color;\\n\\t\\tfloat distance;\\n\\t\\tfloat decay;\\n\\t\\tfloat coneCos;\\n\\t\\tfloat penumbraCos;\\n\\t};\\n\\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\\n\\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\\n\\t\\tvec3 lVector = spotLight.position - geometry.position;\\n\\t\\tlight.direction = normalize( lVector );\\n\\t\\tfloat angleCos = dot( light.direction, spotLight.direction );\\n\\t\\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\\n\\t\\tif ( spotAttenuation > 0.0 ) {\\n\\t\\t\\tfloat lightDistance = length( lVector );\\n\\t\\t\\tlight.color = spotLight.color * spotAttenuation;\\n\\t\\t\\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\\n\\t\\t\\tlight.visible = ( light.color != vec3( 0.0 ) );\\n\\t\\t} else {\\n\\t\\t\\tlight.color = vec3( 0.0 );\\n\\t\\t\\tlight.visible = false;\\n\\t\\t}\\n\\t}\\n#endif\\n#if NUM_RECT_AREA_LIGHTS > 0\\n\\tstruct RectAreaLight {\\n\\t\\tvec3 color;\\n\\t\\tvec3 position;\\n\\t\\tvec3 halfWidth;\\n\\t\\tvec3 halfHeight;\\n\\t};\\n\\tuniform sampler2D ltc_1;\\tuniform sampler2D ltc_2;\\n\\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\\n#endif\\n#if NUM_HEMI_LIGHTS > 0\\n\\tstruct HemisphereLight {\\n\\t\\tvec3 direction;\\n\\t\\tvec3 skyColor;\\n\\t\\tvec3 groundColor;\\n\\t};\\n\\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\\n\\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\\n\\t\\tfloat dotNL = dot( normal, hemiLight.direction );\\n\\t\\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\\n\\t\\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\\n\\t\\treturn irradiance;\\n\\t}\\n#endif\";\n\nvar envmap_physical_pars_fragment = \"#if defined( USE_ENVMAP )\\n\\tvec3 getIBLIrradiance( const in vec3 normal ) {\\n\\t\\t#if defined( ENVMAP_TYPE_CUBE_UV )\\n\\t\\t\\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\\n\\t\\t\\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\\n\\t\\t\\treturn PI * envMapColor.rgb * envMapIntensity;\\n\\t\\t#else\\n\\t\\t\\treturn vec3( 0.0 );\\n\\t\\t#endif\\n\\t}\\n\\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\\n\\t\\t#if defined( ENVMAP_TYPE_CUBE_UV )\\n\\t\\t\\tvec3 reflectVec = reflect( - viewDir, normal );\\n\\t\\t\\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\\n\\t\\t\\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\\n\\t\\t\\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\\n\\t\\t\\treturn envMapColor.rgb * envMapIntensity;\\n\\t\\t#else\\n\\t\\t\\treturn vec3( 0.0 );\\n\\t\\t#endif\\n\\t}\\n#endif\";\n\nvar lights_toon_fragment = \"ToonMaterial material;\\nmaterial.diffuseColor = diffuseColor.rgb;\";\n\nvar lights_toon_pars_fragment = \"varying vec3 vViewPosition;\\nstruct ToonMaterial {\\n\\tvec3 diffuseColor;\\n};\\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\\n\\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\\n\\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\\n}\\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\\n\\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\\n}\\n#define RE_Direct\\t\\t\\t\\tRE_Direct_Toon\\n#define RE_IndirectDiffuse\\t\\tRE_IndirectDiffuse_Toon\";\n\nvar lights_phong_fragment = \"BlinnPhongMaterial material;\\nmaterial.diffuseColor = diffuseColor.rgb;\\nmaterial.specularColor = specular;\\nmaterial.specularShininess = shininess;\\nmaterial.specularStrength = specularStrength;\";\n\nvar lights_phong_pars_fragment = \"varying vec3 vViewPosition;\\nstruct BlinnPhongMaterial {\\n\\tvec3 diffuseColor;\\n\\tvec3 specularColor;\\n\\tfloat specularShininess;\\n\\tfloat specularStrength;\\n};\\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\\n\\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\\n\\tvec3 irradiance = dotNL * directLight.color;\\n\\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\\n\\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\\n}\\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\\n\\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\\n}\\n#define RE_Direct\\t\\t\\t\\tRE_Direct_BlinnPhong\\n#define RE_IndirectDiffuse\\t\\tRE_IndirectDiffuse_BlinnPhong\";\n\nvar lights_physical_fragment = \"PhysicalMaterial material;\\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\\nmaterial.roughness = min( material.roughness, 1.0 );\\n#ifdef IOR\\n\\tmaterial.ior = ior;\\n\\t#ifdef SPECULAR\\n\\t\\tfloat specularIntensityFactor = specularIntensity;\\n\\t\\tvec3 specularColorFactor = specularColor;\\n\\t\\t#ifdef USE_SPECULARINTENSITYMAP\\n\\t\\t\\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\\n\\t\\t#endif\\n\\t\\t#ifdef USE_SPECULARCOLORMAP\\n\\t\\t\\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\\n\\t\\t#endif\\n\\t\\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\\n\\t#else\\n\\t\\tfloat specularIntensityFactor = 1.0;\\n\\t\\tvec3 specularColorFactor = vec3( 1.0 );\\n\\t\\tmaterial.specularF90 = 1.0;\\n\\t#endif\\n\\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\\n#else\\n\\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\\n\\tmaterial.specularF90 = 1.0;\\n#endif\\n#ifdef USE_CLEARCOAT\\n\\tmaterial.clearcoat = clearcoat;\\n\\tmaterial.clearcoatRoughness = clearcoatRoughness;\\n\\tmaterial.clearcoatF0 = vec3( 0.04 );\\n\\tmaterial.clearcoatF90 = 1.0;\\n\\t#ifdef USE_CLEARCOATMAP\\n\\t\\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\\n\\t#endif\\n\\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\\n\\t\\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\\n\\t#endif\\n\\tmaterial.clearcoat = saturate( material.clearcoat );\\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\\n\\tmaterial.clearcoatRoughness += geometryRoughness;\\n\\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\\n#endif\\n#ifdef USE_IRIDESCENCE\\n\\tmaterial.iridescence = iridescence;\\n\\tmaterial.iridescenceIOR = iridescenceIOR;\\n\\t#ifdef USE_IRIDESCENCEMAP\\n\\t\\tmaterial.iridescence *= texture2D( iridescenceMap, vUv ).r;\\n\\t#endif\\n\\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\\n\\t\\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;\\n\\t#else\\n\\t\\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\\n\\t#endif\\n#endif\\n#ifdef USE_SHEEN\\n\\tmaterial.sheenColor = sheenColor;\\n\\t#ifdef USE_SHEENCOLORMAP\\n\\t\\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\\n\\t#endif\\n\\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\\n\\t#ifdef USE_SHEENROUGHNESSMAP\\n\\t\\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\\n\\t#endif\\n#endif\";\n\nvar lights_physical_pars_fragment = \"struct PhysicalMaterial {\\n\\tvec3 diffuseColor;\\n\\tfloat roughness;\\n\\tvec3 specularColor;\\n\\tfloat specularF90;\\n\\t#ifdef USE_CLEARCOAT\\n\\t\\tfloat clearcoat;\\n\\t\\tfloat clearcoatRoughness;\\n\\t\\tvec3 clearcoatF0;\\n\\t\\tfloat clearcoatF90;\\n\\t#endif\\n\\t#ifdef USE_IRIDESCENCE\\n\\t\\tfloat iridescence;\\n\\t\\tfloat iridescenceIOR;\\n\\t\\tfloat iridescenceThickness;\\n\\t\\tvec3 iridescenceFresnel;\\n\\t\\tvec3 iridescenceF0;\\n\\t#endif\\n\\t#ifdef USE_SHEEN\\n\\t\\tvec3 sheenColor;\\n\\t\\tfloat sheenRoughness;\\n\\t#endif\\n\\t#ifdef IOR\\n\\t\\tfloat ior;\\n\\t#endif\\n\\t#ifdef USE_TRANSMISSION\\n\\t\\tfloat transmission;\\n\\t\\tfloat transmissionAlpha;\\n\\t\\tfloat thickness;\\n\\t\\tfloat attenuationDistance;\\n\\t\\tvec3 attenuationColor;\\n\\t#endif\\n};\\nvec3 clearcoatSpecular = vec3( 0.0 );\\nvec3 sheenSpecular = vec3( 0.0 );\\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\\n\\tfloat dotNV = saturate( dot( normal, viewDir ) );\\n\\tfloat r2 = roughness * roughness;\\n\\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\\n\\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\\n\\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\\n\\treturn saturate( DG * RECIPROCAL_PI );\\n}\\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\\n\\tfloat dotNV = saturate( dot( normal, viewDir ) );\\n\\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\\n\\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\\n\\tvec4 r = roughness * c0 + c1;\\n\\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\\n\\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\\n\\treturn fab;\\n}\\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\\n\\tvec2 fab = DFGApprox( normal, viewDir, roughness );\\n\\treturn specularColor * fab.x + specularF90 * fab.y;\\n}\\n#ifdef USE_IRIDESCENCE\\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\\n#else\\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\\n#endif\\n\\tvec2 fab = DFGApprox( normal, viewDir, roughness );\\n\\t#ifdef USE_IRIDESCENCE\\n\\t\\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\\n\\t#else\\n\\t\\tvec3 Fr = specularColor;\\n\\t#endif\\n\\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\\n\\tfloat Ess = fab.x + fab.y;\\n\\tfloat Ems = 1.0 - Ess;\\n\\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\\n\\tsingleScatter += FssEss;\\n\\tmultiScatter += Fms * Ems;\\n}\\n#if NUM_RECT_AREA_LIGHTS > 0\\n\\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\\n\\t\\tvec3 normal = geometry.normal;\\n\\t\\tvec3 viewDir = geometry.viewDir;\\n\\t\\tvec3 position = geometry.position;\\n\\t\\tvec3 lightPos = rectAreaLight.position;\\n\\t\\tvec3 halfWidth = rectAreaLight.halfWidth;\\n\\t\\tvec3 halfHeight = rectAreaLight.halfHeight;\\n\\t\\tvec3 lightColor = rectAreaLight.color;\\n\\t\\tfloat roughness = material.roughness;\\n\\t\\tvec3 rectCoords[ 4 ];\\n\\t\\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\\t\\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\\n\\t\\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\\n\\t\\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\\n\\t\\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\\n\\t\\tvec4 t1 = texture2D( ltc_1, uv );\\n\\t\\tvec4 t2 = texture2D( ltc_2, uv );\\n\\t\\tmat3 mInv = mat3(\\n\\t\\t\\tvec3( t1.x, 0, t1.y ),\\n\\t\\t\\tvec3(    0, 1,    0 ),\\n\\t\\t\\tvec3( t1.z, 0, t1.w )\\n\\t\\t);\\n\\t\\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\\n\\t\\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\\n\\t\\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\\n\\t}\\n#endif\\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\\n\\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\\n\\tvec3 irradiance = dotNL * directLight.color;\\n\\t#ifdef USE_CLEARCOAT\\n\\t\\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\\n\\t\\tvec3 ccIrradiance = dotNLcc * directLight.color;\\n\\t\\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\\n\\t#endif\\n\\t#ifdef USE_SHEEN\\n\\t\\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\\n\\t#endif\\n\\t#ifdef USE_IRIDESCENCE\\n\\t\\treflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );\\n\\t#else\\n\\t\\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\\n\\t#endif\\n\\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\\n}\\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\\n\\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\\n}\\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\\n\\t#ifdef USE_CLEARCOAT\\n\\t\\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\\n\\t#endif\\n\\t#ifdef USE_SHEEN\\n\\t\\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\\n\\t#endif\\n\\tvec3 singleScattering = vec3( 0.0 );\\n\\tvec3 multiScattering = vec3( 0.0 );\\n\\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\\n\\t#ifdef USE_IRIDESCENCE\\n\\t\\tcomputeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\\n\\t#else\\n\\t\\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\\n\\t#endif\\n\\tvec3 totalScattering = singleScattering + multiScattering;\\n\\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\\n\\treflectedLight.indirectSpecular += radiance * singleScattering;\\n\\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\\n\\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\\n}\\n#define RE_Direct\\t\\t\\t\\tRE_Direct_Physical\\n#define RE_Direct_RectArea\\t\\tRE_Direct_RectArea_Physical\\n#define RE_IndirectDiffuse\\t\\tRE_IndirectDiffuse_Physical\\n#define RE_IndirectSpecular\\t\\tRE_IndirectSpecular_Physical\\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\\n\\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\\n}\";\n\nvar lights_fragment_begin = \"\\nGeometricContext geometry;\\ngeometry.position = - vViewPosition;\\ngeometry.normal = normal;\\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\\n#ifdef USE_CLEARCOAT\\n\\tgeometry.clearcoatNormal = clearcoatNormal;\\n#endif\\n#ifdef USE_IRIDESCENCE\\n\\tfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\\n\\tif ( material.iridescenceThickness == 0.0 ) {\\n\\t\\tmaterial.iridescence = 0.0;\\n\\t} else {\\n\\t\\tmaterial.iridescence = saturate( material.iridescence );\\n\\t}\\n\\tif ( material.iridescence > 0.0 ) {\\n\\t\\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\\n\\t\\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\\n\\t}\\n#endif\\nIncidentLight directLight;\\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\\n\\tPointLight pointLight;\\n\\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\\n\\tPointLightShadow pointLightShadow;\\n\\t#endif\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\\n\\t\\tpointLight = pointLights[ i ];\\n\\t\\tgetPointLightInfo( pointLight, geometry, directLight );\\n\\t\\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\\n\\t\\tpointLightShadow = pointLightShadows[ i ];\\n\\t\\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\\n\\t\\t#endif\\n\\t\\tRE_Direct( directLight, geometry, material, reflectedLight );\\n\\t}\\n\\t#pragma unroll_loop_end\\n#endif\\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\\n\\tSpotLight spotLight;\\n\\tvec4 spotColor;\\n\\tvec3 spotLightCoord;\\n\\tbool inSpotLightMap;\\n\\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\\n\\tSpotLightShadow spotLightShadow;\\n\\t#endif\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\\n\\t\\tspotLight = spotLights[ i ];\\n\\t\\tgetSpotLightInfo( spotLight, geometry, directLight );\\n\\t\\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\\n\\t\\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\\n\\t\\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\\n\\t\\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\\n\\t\\t#else\\n\\t\\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\\n\\t\\t#endif\\n\\t\\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\\n\\t\\t\\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\\n\\t\\t\\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\\n\\t\\t\\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\\n\\t\\t\\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\\n\\t\\t#endif\\n\\t\\t#undef SPOT_LIGHT_MAP_INDEX\\n\\t\\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\\n\\t\\tspotLightShadow = spotLightShadows[ i ];\\n\\t\\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\\n\\t\\t#endif\\n\\t\\tRE_Direct( directLight, geometry, material, reflectedLight );\\n\\t}\\n\\t#pragma unroll_loop_end\\n#endif\\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\\n\\tDirectionalLight directionalLight;\\n\\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\\n\\tDirectionalLightShadow directionalLightShadow;\\n\\t#endif\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\\n\\t\\tdirectionalLight = directionalLights[ i ];\\n\\t\\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\\n\\t\\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\\n\\t\\tdirectionalLightShadow = directionalLightShadows[ i ];\\n\\t\\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\\n\\t\\t#endif\\n\\t\\tRE_Direct( directLight, geometry, material, reflectedLight );\\n\\t}\\n\\t#pragma unroll_loop_end\\n#endif\\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\\n\\tRectAreaLight rectAreaLight;\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\\n\\t\\trectAreaLight = rectAreaLights[ i ];\\n\\t\\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\\n\\t}\\n\\t#pragma unroll_loop_end\\n#endif\\n#if defined( RE_IndirectDiffuse )\\n\\tvec3 iblIrradiance = vec3( 0.0 );\\n\\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\\n\\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\\n\\t#if ( NUM_HEMI_LIGHTS > 0 )\\n\\t\\t#pragma unroll_loop_start\\n\\t\\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\\n\\t\\t\\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\\n\\t\\t}\\n\\t\\t#pragma unroll_loop_end\\n\\t#endif\\n#endif\\n#if defined( RE_IndirectSpecular )\\n\\tvec3 radiance = vec3( 0.0 );\\n\\tvec3 clearcoatRadiance = vec3( 0.0 );\\n#endif\";\n\nvar lights_fragment_maps = \"#if defined( RE_IndirectDiffuse )\\n\\t#ifdef USE_LIGHTMAP\\n\\t\\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\\n\\t\\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\\n\\t\\tirradiance += lightMapIrradiance;\\n\\t#endif\\n\\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\\n\\t\\tiblIrradiance += getIBLIrradiance( geometry.normal );\\n\\t#endif\\n#endif\\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\\n\\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\\n\\t#ifdef USE_CLEARCOAT\\n\\t\\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\\n\\t#endif\\n#endif\";\n\nvar lights_fragment_end = \"#if defined( RE_IndirectDiffuse )\\n\\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\\n#endif\\n#if defined( RE_IndirectSpecular )\\n\\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\\n#endif\";\n\nvar logdepthbuf_fragment = \"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\\n\\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\\n#endif\";\n\nvar logdepthbuf_pars_fragment = \"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\\n\\tuniform float logDepthBufFC;\\n\\tvarying float vFragDepth;\\n\\tvarying float vIsPerspective;\\n#endif\";\n\nvar logdepthbuf_pars_vertex = \"#ifdef USE_LOGDEPTHBUF\\n\\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\t\\tvarying float vFragDepth;\\n\\t\\tvarying float vIsPerspective;\\n\\t#else\\n\\t\\tuniform float logDepthBufFC;\\n\\t#endif\\n#endif\";\n\nvar logdepthbuf_vertex = \"#ifdef USE_LOGDEPTHBUF\\n\\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\t\\tvFragDepth = 1.0 + gl_Position.w;\\n\\t\\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\\n\\t#else\\n\\t\\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\\n\\t\\t\\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\\n\\t\\t\\tgl_Position.z *= gl_Position.w;\\n\\t\\t}\\n\\t#endif\\n#endif\";\n\nvar map_fragment = \"#ifdef USE_MAP\\n\\tvec4 sampledDiffuseColor = texture2D( map, vUv );\\n\\t#ifdef DECODE_VIDEO_TEXTURE\\n\\t\\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\\n\\t#endif\\n\\tdiffuseColor *= sampledDiffuseColor;\\n#endif\";\n\nvar map_pars_fragment = \"#ifdef USE_MAP\\n\\tuniform sampler2D map;\\n#endif\";\n\nvar map_particle_fragment = \"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\\n\\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\\n#endif\\n#ifdef USE_MAP\\n\\tdiffuseColor *= texture2D( map, uv );\\n#endif\\n#ifdef USE_ALPHAMAP\\n\\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\\n#endif\";\n\nvar map_particle_pars_fragment = \"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\\n\\tuniform mat3 uvTransform;\\n#endif\\n#ifdef USE_MAP\\n\\tuniform sampler2D map;\\n#endif\\n#ifdef USE_ALPHAMAP\\n\\tuniform sampler2D alphaMap;\\n#endif\";\n\nvar metalnessmap_fragment = \"float metalnessFactor = metalness;\\n#ifdef USE_METALNESSMAP\\n\\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\\n\\tmetalnessFactor *= texelMetalness.b;\\n#endif\";\n\nvar metalnessmap_pars_fragment = \"#ifdef USE_METALNESSMAP\\n\\tuniform sampler2D metalnessMap;\\n#endif\";\n\nvar morphcolor_vertex = \"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\\n\\tvColor *= morphTargetBaseInfluence;\\n\\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\\n\\t\\t#if defined( USE_COLOR_ALPHA )\\n\\t\\t\\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\\n\\t\\t#elif defined( USE_COLOR )\\n\\t\\t\\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\\n\\t\\t#endif\\n\\t}\\n#endif\";\n\nvar morphnormal_vertex = \"#ifdef USE_MORPHNORMALS\\n\\tobjectNormal *= morphTargetBaseInfluence;\\n\\t#ifdef MORPHTARGETS_TEXTURE\\n\\t\\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\\n\\t\\t\\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\\n\\t\\t}\\n\\t#else\\n\\t\\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\\n\\t\\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\\n\\t\\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\\n\\t\\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\\n\\t#endif\\n#endif\";\n\nvar morphtarget_pars_vertex = \"#ifdef USE_MORPHTARGETS\\n\\tuniform float morphTargetBaseInfluence;\\n\\t#ifdef MORPHTARGETS_TEXTURE\\n\\t\\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\\n\\t\\tuniform sampler2DArray morphTargetsTexture;\\n\\t\\tuniform ivec2 morphTargetsTextureSize;\\n\\t\\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\\n\\t\\t\\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\\n\\t\\t\\tint y = texelIndex / morphTargetsTextureSize.x;\\n\\t\\t\\tint x = texelIndex - y * morphTargetsTextureSize.x;\\n\\t\\t\\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\\n\\t\\t\\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\\n\\t\\t}\\n\\t#else\\n\\t\\t#ifndef USE_MORPHNORMALS\\n\\t\\t\\tuniform float morphTargetInfluences[ 8 ];\\n\\t\\t#else\\n\\t\\t\\tuniform float morphTargetInfluences[ 4 ];\\n\\t\\t#endif\\n\\t#endif\\n#endif\";\n\nvar morphtarget_vertex = \"#ifdef USE_MORPHTARGETS\\n\\ttransformed *= morphTargetBaseInfluence;\\n\\t#ifdef MORPHTARGETS_TEXTURE\\n\\t\\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\\n\\t\\t\\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\\n\\t\\t}\\n\\t#else\\n\\t\\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\\n\\t\\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\\n\\t\\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\\n\\t\\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\\n\\t\\t#ifndef USE_MORPHNORMALS\\n\\t\\t\\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\\n\\t\\t\\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\\n\\t\\t\\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\\n\\t\\t\\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\\n\\t\\t#endif\\n\\t#endif\\n#endif\";\n\nvar normal_fragment_begin = \"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\\n#ifdef FLAT_SHADED\\n\\tvec3 fdx = dFdx( vViewPosition );\\n\\tvec3 fdy = dFdy( vViewPosition );\\n\\tvec3 normal = normalize( cross( fdx, fdy ) );\\n#else\\n\\tvec3 normal = normalize( vNormal );\\n\\t#ifdef DOUBLE_SIDED\\n\\t\\tnormal = normal * faceDirection;\\n\\t#endif\\n\\t#ifdef USE_TANGENT\\n\\t\\tvec3 tangent = normalize( vTangent );\\n\\t\\tvec3 bitangent = normalize( vBitangent );\\n\\t\\t#ifdef DOUBLE_SIDED\\n\\t\\t\\ttangent = tangent * faceDirection;\\n\\t\\t\\tbitangent = bitangent * faceDirection;\\n\\t\\t#endif\\n\\t\\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\\n\\t\\t\\tmat3 vTBN = mat3( tangent, bitangent, normal );\\n\\t\\t#endif\\n\\t#endif\\n#endif\\nvec3 geometryNormal = normal;\";\n\nvar normal_fragment_maps = \"#ifdef OBJECTSPACE_NORMALMAP\\n\\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\\n\\t#ifdef FLIP_SIDED\\n\\t\\tnormal = - normal;\\n\\t#endif\\n\\t#ifdef DOUBLE_SIDED\\n\\t\\tnormal = normal * faceDirection;\\n\\t#endif\\n\\tnormal = normalize( normalMatrix * normal );\\n#elif defined( TANGENTSPACE_NORMALMAP )\\n\\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\\n\\tmapN.xy *= normalScale;\\n\\t#ifdef USE_TANGENT\\n\\t\\tnormal = normalize( vTBN * mapN );\\n\\t#else\\n\\t\\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\\n\\t#endif\\n#elif defined( USE_BUMPMAP )\\n\\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\\n#endif\";\n\nvar normal_pars_fragment = \"#ifndef FLAT_SHADED\\n\\tvarying vec3 vNormal;\\n\\t#ifdef USE_TANGENT\\n\\t\\tvarying vec3 vTangent;\\n\\t\\tvarying vec3 vBitangent;\\n\\t#endif\\n#endif\";\n\nvar normal_pars_vertex = \"#ifndef FLAT_SHADED\\n\\tvarying vec3 vNormal;\\n\\t#ifdef USE_TANGENT\\n\\t\\tvarying vec3 vTangent;\\n\\t\\tvarying vec3 vBitangent;\\n\\t#endif\\n#endif\";\n\nvar normal_vertex = \"#ifndef FLAT_SHADED\\n\\tvNormal = normalize( transformedNormal );\\n\\t#ifdef USE_TANGENT\\n\\t\\tvTangent = normalize( transformedTangent );\\n\\t\\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\\n\\t#endif\\n#endif\";\n\nvar normalmap_pars_fragment = \"#ifdef USE_NORMALMAP\\n\\tuniform sampler2D normalMap;\\n\\tuniform vec2 normalScale;\\n#endif\\n#ifdef OBJECTSPACE_NORMALMAP\\n\\tuniform mat3 normalMatrix;\\n#endif\\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\\n\\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\\n\\t\\tvec3 q0 = dFdx( eye_pos.xyz );\\n\\t\\tvec3 q1 = dFdy( eye_pos.xyz );\\n\\t\\tvec2 st0 = dFdx( vUv.st );\\n\\t\\tvec2 st1 = dFdy( vUv.st );\\n\\t\\tvec3 N = surf_norm;\\n\\t\\tvec3 q1perp = cross( q1, N );\\n\\t\\tvec3 q0perp = cross( N, q0 );\\n\\t\\tvec3 T = q1perp * st0.x + q0perp * st1.x;\\n\\t\\tvec3 B = q1perp * st0.y + q0perp * st1.y;\\n\\t\\tfloat det = max( dot( T, T ), dot( B, B ) );\\n\\t\\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\\n\\t\\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\\n\\t}\\n#endif\";\n\nvar clearcoat_normal_fragment_begin = \"#ifdef USE_CLEARCOAT\\n\\tvec3 clearcoatNormal = geometryNormal;\\n#endif\";\n\nvar clearcoat_normal_fragment_maps = \"#ifdef USE_CLEARCOAT_NORMALMAP\\n\\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\\n\\tclearcoatMapN.xy *= clearcoatNormalScale;\\n\\t#ifdef USE_TANGENT\\n\\t\\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\\n\\t#else\\n\\t\\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\\n\\t#endif\\n#endif\";\n\nvar clearcoat_pars_fragment = \"#ifdef USE_CLEARCOATMAP\\n\\tuniform sampler2D clearcoatMap;\\n#endif\\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\\n\\tuniform sampler2D clearcoatRoughnessMap;\\n#endif\\n#ifdef USE_CLEARCOAT_NORMALMAP\\n\\tuniform sampler2D clearcoatNormalMap;\\n\\tuniform vec2 clearcoatNormalScale;\\n#endif\";\n\nvar iridescence_pars_fragment = \"#ifdef USE_IRIDESCENCEMAP\\n\\tuniform sampler2D iridescenceMap;\\n#endif\\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\\n\\tuniform sampler2D iridescenceThicknessMap;\\n#endif\";\n\nvar output_fragment = \"#ifdef OPAQUE\\ndiffuseColor.a = 1.0;\\n#endif\\n#ifdef USE_TRANSMISSION\\ndiffuseColor.a *= material.transmissionAlpha + 0.1;\\n#endif\\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );\";\n\nvar packing = \"vec3 packNormalToRGB( const in vec3 normal ) {\\n\\treturn normalize( normal ) * 0.5 + 0.5;\\n}\\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\\n\\treturn 2.0 * rgb.xyz - 1.0;\\n}\\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\\nconst float ShiftRight8 = 1. / 256.;\\nvec4 packDepthToRGBA( const in float v ) {\\n\\tvec4 r = vec4( fract( v * PackFactors ), v );\\n\\tr.yzw -= r.xyz * ShiftRight8;\\treturn r * PackUpscale;\\n}\\nfloat unpackRGBAToDepth( const in vec4 v ) {\\n\\treturn dot( v, UnpackFactors );\\n}\\nvec2 packDepthToRG( in highp float v ) {\\n\\treturn packDepthToRGBA( v ).yx;\\n}\\nfloat unpackRGToDepth( const in highp vec2 v ) {\\n\\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\\n}\\nvec4 pack2HalfToRGBA( vec2 v ) {\\n\\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\\n\\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\\n}\\nvec2 unpackRGBATo2Half( vec4 v ) {\\n\\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\\n}\\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\\n\\treturn ( viewZ + near ) / ( near - far );\\n}\\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\\n\\treturn linearClipZ * ( near - far ) - near;\\n}\\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\\n\\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\\n}\\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\\n\\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\\n}\";\n\nvar premultiplied_alpha_fragment = \"#ifdef PREMULTIPLIED_ALPHA\\n\\tgl_FragColor.rgb *= gl_FragColor.a;\\n#endif\";\n\nvar project_vertex = \"vec4 mvPosition = vec4( transformed, 1.0 );\\n#ifdef USE_INSTANCING\\n\\tmvPosition = instanceMatrix * mvPosition;\\n#endif\\nmvPosition = modelViewMatrix * mvPosition;\\ngl_Position = projectionMatrix * mvPosition;\";\n\nvar dithering_fragment = \"#ifdef DITHERING\\n\\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\\n#endif\";\n\nvar dithering_pars_fragment = \"#ifdef DITHERING\\n\\tvec3 dithering( vec3 color ) {\\n\\t\\tfloat grid_position = rand( gl_FragCoord.xy );\\n\\t\\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\\n\\t\\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\\n\\t\\treturn color + dither_shift_RGB;\\n\\t}\\n#endif\";\n\nvar roughnessmap_fragment = \"float roughnessFactor = roughness;\\n#ifdef USE_ROUGHNESSMAP\\n\\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\\n\\troughnessFactor *= texelRoughness.g;\\n#endif\";\n\nvar roughnessmap_pars_fragment = \"#ifdef USE_ROUGHNESSMAP\\n\\tuniform sampler2D roughnessMap;\\n#endif\";\n\nvar shadowmap_pars_fragment = \"#if NUM_SPOT_LIGHT_COORDS > 0\\n  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\\n#endif\\n#if NUM_SPOT_LIGHT_MAPS > 0\\n  uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\\n#endif\\n#ifdef USE_SHADOWMAP\\n\\t#if NUM_DIR_LIGHT_SHADOWS > 0\\n\\t\\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\\n\\t\\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\\n\\t\\tstruct DirectionalLightShadow {\\n\\t\\t\\tfloat shadowBias;\\n\\t\\t\\tfloat shadowNormalBias;\\n\\t\\t\\tfloat shadowRadius;\\n\\t\\t\\tvec2 shadowMapSize;\\n\\t\\t};\\n\\t\\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\\n\\t#endif\\n\\t#if NUM_SPOT_LIGHT_SHADOWS > 0\\n\\t\\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\\n\\t\\tstruct SpotLightShadow {\\n\\t\\t\\tfloat shadowBias;\\n\\t\\t\\tfloat shadowNormalBias;\\n\\t\\t\\tfloat shadowRadius;\\n\\t\\t\\tvec2 shadowMapSize;\\n\\t\\t};\\n\\t\\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\\n\\t#endif\\n\\t#if NUM_POINT_LIGHT_SHADOWS > 0\\n\\t\\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\\n\\t\\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\\n\\t\\tstruct PointLightShadow {\\n\\t\\t\\tfloat shadowBias;\\n\\t\\t\\tfloat shadowNormalBias;\\n\\t\\t\\tfloat shadowRadius;\\n\\t\\t\\tvec2 shadowMapSize;\\n\\t\\t\\tfloat shadowCameraNear;\\n\\t\\t\\tfloat shadowCameraFar;\\n\\t\\t};\\n\\t\\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\\n\\t#endif\\n\\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\\n\\t\\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\\n\\t}\\n\\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\\n\\t\\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\\n\\t}\\n\\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\\n\\t\\tfloat occlusion = 1.0;\\n\\t\\tvec2 distribution = texture2DDistribution( shadow, uv );\\n\\t\\tfloat hard_shadow = step( compare , distribution.x );\\n\\t\\tif (hard_shadow != 1.0 ) {\\n\\t\\t\\tfloat distance = compare - distribution.x ;\\n\\t\\t\\tfloat variance = max( 0.00000, distribution.y * distribution.y );\\n\\t\\t\\tfloat softness_probability = variance / (variance + distance * distance );\\t\\t\\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\\t\\t\\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\\n\\t\\t}\\n\\t\\treturn occlusion;\\n\\t}\\n\\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\\n\\t\\tfloat shadow = 1.0;\\n\\t\\tshadowCoord.xyz /= shadowCoord.w;\\n\\t\\tshadowCoord.z += shadowBias;\\n\\t\\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\\n\\t\\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\\n\\t\\tif ( frustumTest ) {\\n\\t\\t#if defined( SHADOWMAP_TYPE_PCF )\\n\\t\\t\\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\\n\\t\\t\\tfloat dx0 = - texelSize.x * shadowRadius;\\n\\t\\t\\tfloat dy0 = - texelSize.y * shadowRadius;\\n\\t\\t\\tfloat dx1 = + texelSize.x * shadowRadius;\\n\\t\\t\\tfloat dy1 = + texelSize.y * shadowRadius;\\n\\t\\t\\tfloat dx2 = dx0 / 2.0;\\n\\t\\t\\tfloat dy2 = dy0 / 2.0;\\n\\t\\t\\tfloat dx3 = dx1 / 2.0;\\n\\t\\t\\tfloat dy3 = dy1 / 2.0;\\n\\t\\t\\tshadow = (\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\\n\\t\\t\\t) * ( 1.0 / 17.0 );\\n\\t\\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\\n\\t\\t\\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\\n\\t\\t\\tfloat dx = texelSize.x;\\n\\t\\t\\tfloat dy = texelSize.y;\\n\\t\\t\\tvec2 uv = shadowCoord.xy;\\n\\t\\t\\tvec2 f = fract( uv * shadowMapSize + 0.5 );\\n\\t\\t\\tuv -= f * texelSize;\\n\\t\\t\\tshadow = (\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\\n\\t\\t\\t\\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\\n\\t\\t\\t\\t\\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\\n\\t\\t\\t\\t\\t f.x ) +\\n\\t\\t\\t\\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\\n\\t\\t\\t\\t\\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\\n\\t\\t\\t\\t\\t f.x ) +\\n\\t\\t\\t\\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\\n\\t\\t\\t\\t\\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\\n\\t\\t\\t\\t\\t f.y ) +\\n\\t\\t\\t\\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\\n\\t\\t\\t\\t\\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\\n\\t\\t\\t\\t\\t f.y ) +\\n\\t\\t\\t\\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\\n\\t\\t\\t\\t\\t\\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\\n\\t\\t\\t\\t\\t\\t  f.x ),\\n\\t\\t\\t\\t\\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\\n\\t\\t\\t\\t\\t\\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\\n\\t\\t\\t\\t\\t\\t  f.x ),\\n\\t\\t\\t\\t\\t f.y )\\n\\t\\t\\t) * ( 1.0 / 9.0 );\\n\\t\\t#elif defined( SHADOWMAP_TYPE_VSM )\\n\\t\\t\\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\\n\\t\\t#else\\n\\t\\t\\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\\n\\t\\t#endif\\n\\t\\t}\\n\\t\\treturn shadow;\\n\\t}\\n\\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\\n\\t\\tvec3 absV = abs( v );\\n\\t\\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\\n\\t\\tabsV *= scaleToCube;\\n\\t\\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\\n\\t\\tvec2 planar = v.xy;\\n\\t\\tfloat almostATexel = 1.5 * texelSizeY;\\n\\t\\tfloat almostOne = 1.0 - almostATexel;\\n\\t\\tif ( absV.z >= almostOne ) {\\n\\t\\t\\tif ( v.z > 0.0 )\\n\\t\\t\\t\\tplanar.x = 4.0 - v.x;\\n\\t\\t} else if ( absV.x >= almostOne ) {\\n\\t\\t\\tfloat signX = sign( v.x );\\n\\t\\t\\tplanar.x = v.z * signX + 2.0 * signX;\\n\\t\\t} else if ( absV.y >= almostOne ) {\\n\\t\\t\\tfloat signY = sign( v.y );\\n\\t\\t\\tplanar.x = v.x + 2.0 * signY + 2.0;\\n\\t\\t\\tplanar.y = v.z * signY - 2.0;\\n\\t\\t}\\n\\t\\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\\n\\t}\\n\\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\\n\\t\\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\\n\\t\\tvec3 lightToPosition = shadowCoord.xyz;\\n\\t\\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\\t\\tdp += shadowBias;\\n\\t\\tvec3 bd3D = normalize( lightToPosition );\\n\\t\\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\\n\\t\\t\\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\\n\\t\\t\\treturn (\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\\n\\t\\t\\t) * ( 1.0 / 9.0 );\\n\\t\\t#else\\n\\t\\t\\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\\n\\t\\t#endif\\n\\t}\\n#endif\";\n\nvar shadowmap_pars_vertex = \"#if NUM_SPOT_LIGHT_COORDS > 0\\n  uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\\n  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\\n#endif\\n#ifdef USE_SHADOWMAP\\n\\t#if NUM_DIR_LIGHT_SHADOWS > 0\\n\\t\\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\\n\\t\\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\\n\\t\\tstruct DirectionalLightShadow {\\n\\t\\t\\tfloat shadowBias;\\n\\t\\t\\tfloat shadowNormalBias;\\n\\t\\t\\tfloat shadowRadius;\\n\\t\\t\\tvec2 shadowMapSize;\\n\\t\\t};\\n\\t\\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\\n\\t#endif\\n\\t#if NUM_SPOT_LIGHT_SHADOWS > 0\\n\\t\\tstruct SpotLightShadow {\\n\\t\\t\\tfloat shadowBias;\\n\\t\\t\\tfloat shadowNormalBias;\\n\\t\\t\\tfloat shadowRadius;\\n\\t\\t\\tvec2 shadowMapSize;\\n\\t\\t};\\n\\t\\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\\n\\t#endif\\n\\t#if NUM_POINT_LIGHT_SHADOWS > 0\\n\\t\\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\\n\\t\\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\\n\\t\\tstruct PointLightShadow {\\n\\t\\t\\tfloat shadowBias;\\n\\t\\t\\tfloat shadowNormalBias;\\n\\t\\t\\tfloat shadowRadius;\\n\\t\\t\\tvec2 shadowMapSize;\\n\\t\\t\\tfloat shadowCameraNear;\\n\\t\\t\\tfloat shadowCameraFar;\\n\\t\\t};\\n\\t\\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\\n\\t#endif\\n#endif\";\n\nvar shadowmap_vertex = \"#if defined( USE_SHADOWMAP ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\\n\\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_COORDS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\\n\\t\\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\\n\\t\\tvec4 shadowWorldPosition;\\n\\t#endif\\n\\t#if NUM_DIR_LIGHT_SHADOWS > 0\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\\n\\t\\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\\n\\t\\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\\n\\t}\\n\\t#pragma unroll_loop_end\\n\\t#endif\\n\\t#if NUM_SPOT_LIGHT_COORDS > 0\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\\n\\t\\tshadowWorldPosition = worldPosition;\\n\\t\\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\\n\\t\\t\\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\\n\\t\\t#endif\\n\\t\\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\\n\\t}\\n\\t#pragma unroll_loop_end\\n\\t#endif\\n\\t#if NUM_POINT_LIGHT_SHADOWS > 0\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\\n\\t\\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\\n\\t\\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\\n\\t}\\n\\t#pragma unroll_loop_end\\n\\t#endif\\n#endif\";\n\nvar shadowmask_pars_fragment = \"float getShadowMask() {\\n\\tfloat shadow = 1.0;\\n\\t#ifdef USE_SHADOWMAP\\n\\t#if NUM_DIR_LIGHT_SHADOWS > 0\\n\\tDirectionalLightShadow directionalLight;\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\\n\\t\\tdirectionalLight = directionalLightShadows[ i ];\\n\\t\\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\\n\\t}\\n\\t#pragma unroll_loop_end\\n\\t#endif\\n\\t#if NUM_SPOT_LIGHT_SHADOWS > 0\\n\\tSpotLightShadow spotLight;\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\\n\\t\\tspotLight = spotLightShadows[ i ];\\n\\t\\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\\n\\t}\\n\\t#pragma unroll_loop_end\\n\\t#endif\\n\\t#if NUM_POINT_LIGHT_SHADOWS > 0\\n\\tPointLightShadow pointLight;\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\\n\\t\\tpointLight = pointLightShadows[ i ];\\n\\t\\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\\n\\t}\\n\\t#pragma unroll_loop_end\\n\\t#endif\\n\\t#endif\\n\\treturn shadow;\\n}\";\n\nvar skinbase_vertex = \"#ifdef USE_SKINNING\\n\\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\\n\\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\\n\\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\\n\\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\\n#endif\";\n\nvar skinning_pars_vertex = \"#ifdef USE_SKINNING\\n\\tuniform mat4 bindMatrix;\\n\\tuniform mat4 bindMatrixInverse;\\n\\tuniform highp sampler2D boneTexture;\\n\\tuniform int boneTextureSize;\\n\\tmat4 getBoneMatrix( const in float i ) {\\n\\t\\tfloat j = i * 4.0;\\n\\t\\tfloat x = mod( j, float( boneTextureSize ) );\\n\\t\\tfloat y = floor( j / float( boneTextureSize ) );\\n\\t\\tfloat dx = 1.0 / float( boneTextureSize );\\n\\t\\tfloat dy = 1.0 / float( boneTextureSize );\\n\\t\\ty = dy * ( y + 0.5 );\\n\\t\\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\\n\\t\\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\\n\\t\\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\\n\\t\\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\\n\\t\\tmat4 bone = mat4( v1, v2, v3, v4 );\\n\\t\\treturn bone;\\n\\t}\\n#endif\";\n\nvar skinning_vertex = \"#ifdef USE_SKINNING\\n\\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\\n\\tvec4 skinned = vec4( 0.0 );\\n\\tskinned += boneMatX * skinVertex * skinWeight.x;\\n\\tskinned += boneMatY * skinVertex * skinWeight.y;\\n\\tskinned += boneMatZ * skinVertex * skinWeight.z;\\n\\tskinned += boneMatW * skinVertex * skinWeight.w;\\n\\ttransformed = ( bindMatrixInverse * skinned ).xyz;\\n#endif\";\n\nvar skinnormal_vertex = \"#ifdef USE_SKINNING\\n\\tmat4 skinMatrix = mat4( 0.0 );\\n\\tskinMatrix += skinWeight.x * boneMatX;\\n\\tskinMatrix += skinWeight.y * boneMatY;\\n\\tskinMatrix += skinWeight.z * boneMatZ;\\n\\tskinMatrix += skinWeight.w * boneMatW;\\n\\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\\n\\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\\n\\t#ifdef USE_TANGENT\\n\\t\\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\\n\\t#endif\\n#endif\";\n\nvar specularmap_fragment = \"float specularStrength;\\n#ifdef USE_SPECULARMAP\\n\\tvec4 texelSpecular = texture2D( specularMap, vUv );\\n\\tspecularStrength = texelSpecular.r;\\n#else\\n\\tspecularStrength = 1.0;\\n#endif\";\n\nvar specularmap_pars_fragment = \"#ifdef USE_SPECULARMAP\\n\\tuniform sampler2D specularMap;\\n#endif\";\n\nvar tonemapping_fragment = \"#if defined( TONE_MAPPING )\\n\\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\\n#endif\";\n\nvar tonemapping_pars_fragment = \"#ifndef saturate\\n#define saturate( a ) clamp( a, 0.0, 1.0 )\\n#endif\\nuniform float toneMappingExposure;\\nvec3 LinearToneMapping( vec3 color ) {\\n\\treturn toneMappingExposure * color;\\n}\\nvec3 ReinhardToneMapping( vec3 color ) {\\n\\tcolor *= toneMappingExposure;\\n\\treturn saturate( color / ( vec3( 1.0 ) + color ) );\\n}\\nvec3 OptimizedCineonToneMapping( vec3 color ) {\\n\\tcolor *= toneMappingExposure;\\n\\tcolor = max( vec3( 0.0 ), color - 0.004 );\\n\\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\\n}\\nvec3 RRTAndODTFit( vec3 v ) {\\n\\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\\n\\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\\n\\treturn a / b;\\n}\\nvec3 ACESFilmicToneMapping( vec3 color ) {\\n\\tconst mat3 ACESInputMat = mat3(\\n\\t\\tvec3( 0.59719, 0.07600, 0.02840 ),\\t\\tvec3( 0.35458, 0.90834, 0.13383 ),\\n\\t\\tvec3( 0.04823, 0.01566, 0.83777 )\\n\\t);\\n\\tconst mat3 ACESOutputMat = mat3(\\n\\t\\tvec3(  1.60475, -0.10208, -0.00327 ),\\t\\tvec3( -0.53108,  1.10813, -0.07276 ),\\n\\t\\tvec3( -0.07367, -0.00605,  1.07602 )\\n\\t);\\n\\tcolor *= toneMappingExposure / 0.6;\\n\\tcolor = ACESInputMat * color;\\n\\tcolor = RRTAndODTFit( color );\\n\\tcolor = ACESOutputMat * color;\\n\\treturn saturate( color );\\n}\\nvec3 CustomToneMapping( vec3 color ) { return color; }\";\n\nvar transmission_fragment = \"#ifdef USE_TRANSMISSION\\n\\tmaterial.transmission = transmission;\\n\\tmaterial.transmissionAlpha = 1.0;\\n\\tmaterial.thickness = thickness;\\n\\tmaterial.attenuationDistance = attenuationDistance;\\n\\tmaterial.attenuationColor = attenuationColor;\\n\\t#ifdef USE_TRANSMISSIONMAP\\n\\t\\tmaterial.transmission *= texture2D( transmissionMap, vUv ).r;\\n\\t#endif\\n\\t#ifdef USE_THICKNESSMAP\\n\\t\\tmaterial.thickness *= texture2D( thicknessMap, vUv ).g;\\n\\t#endif\\n\\tvec3 pos = vWorldPosition;\\n\\tvec3 v = normalize( cameraPosition - pos );\\n\\tvec3 n = inverseTransformDirection( normal, viewMatrix );\\n\\tvec4 transmission = getIBLVolumeRefraction(\\n\\t\\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\\n\\t\\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\\n\\t\\tmaterial.attenuationColor, material.attenuationDistance );\\n\\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );\\n\\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );\\n#endif\";\n\nvar transmission_pars_fragment = \"#ifdef USE_TRANSMISSION\\n\\tuniform float transmission;\\n\\tuniform float thickness;\\n\\tuniform float attenuationDistance;\\n\\tuniform vec3 attenuationColor;\\n\\t#ifdef USE_TRANSMISSIONMAP\\n\\t\\tuniform sampler2D transmissionMap;\\n\\t#endif\\n\\t#ifdef USE_THICKNESSMAP\\n\\t\\tuniform sampler2D thicknessMap;\\n\\t#endif\\n\\tuniform vec2 transmissionSamplerSize;\\n\\tuniform sampler2D transmissionSamplerMap;\\n\\tuniform mat4 modelMatrix;\\n\\tuniform mat4 projectionMatrix;\\n\\tvarying vec3 vWorldPosition;\\n\\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\\n\\t\\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\\n\\t\\tvec3 modelScale;\\n\\t\\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\\n\\t\\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\\n\\t\\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\\n\\t\\treturn normalize( refractionVector ) * thickness * modelScale;\\n\\t}\\n\\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\\n\\t\\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\\n\\t}\\n\\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\\n\\t\\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\\n\\t\\t#ifdef texture2DLodEXT\\n\\t\\t\\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\\n\\t\\t#else\\n\\t\\t\\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\\n\\t\\t#endif\\n\\t}\\n\\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\\n\\t\\tif ( isinf( attenuationDistance ) ) {\\n\\t\\t\\treturn radiance;\\n\\t\\t} else {\\n\\t\\t\\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\\n\\t\\t\\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\\t\\t\\treturn transmittance * radiance;\\n\\t\\t}\\n\\t}\\n\\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\\n\\t\\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\\n\\t\\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\\n\\t\\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\\n\\t\\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\\n\\t\\tvec3 refractedRayExit = position + transmissionRay;\\n\\t\\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\\n\\t\\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\\n\\t\\trefractionCoords += 1.0;\\n\\t\\trefractionCoords /= 2.0;\\n\\t\\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\\n\\t\\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\\n\\t\\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\\n\\t\\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\\n\\t}\\n#endif\";\n\nvar uv_pars_fragment = \"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\\n\\tvarying vec2 vUv;\\n#endif\";\n\nvar uv_pars_vertex = \"#ifdef USE_UV\\n\\t#ifdef UVS_VERTEX_ONLY\\n\\t\\tvec2 vUv;\\n\\t#else\\n\\t\\tvarying vec2 vUv;\\n\\t#endif\\n\\tuniform mat3 uvTransform;\\n#endif\";\n\nvar uv_vertex = \"#ifdef USE_UV\\n\\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\\n#endif\";\n\nvar uv2_pars_fragment = \"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\\n\\tvarying vec2 vUv2;\\n#endif\";\n\nvar uv2_pars_vertex = \"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\\n\\tattribute vec2 uv2;\\n\\tvarying vec2 vUv2;\\n\\tuniform mat3 uv2Transform;\\n#endif\";\n\nvar uv2_vertex = \"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\\n\\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\\n#endif\";\n\nvar worldpos_vertex = \"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\\n\\tvec4 worldPosition = vec4( transformed, 1.0 );\\n\\t#ifdef USE_INSTANCING\\n\\t\\tworldPosition = instanceMatrix * worldPosition;\\n\\t#endif\\n\\tworldPosition = modelMatrix * worldPosition;\\n#endif\";\n\nconst vertex$h = \"varying vec2 vUv;\\nuniform mat3 uvTransform;\\nvoid main() {\\n\\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\\n\\tgl_Position = vec4( position.xy, 1.0, 1.0 );\\n}\";\n\nconst fragment$h = \"uniform sampler2D t2D;\\nuniform float backgroundIntensity;\\nvarying vec2 vUv;\\nvoid main() {\\n\\tvec4 texColor = texture2D( t2D, vUv );\\n\\t#ifdef DECODE_VIDEO_TEXTURE\\n\\t\\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\\n\\t#endif\\n\\ttexColor.rgb *= backgroundIntensity;\\n\\tgl_FragColor = texColor;\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n}\";\n\nconst vertex$g = \"varying vec3 vWorldDirection;\\n#include <common>\\nvoid main() {\\n\\tvWorldDirection = transformDirection( position, modelMatrix );\\n\\t#include <begin_vertex>\\n\\t#include <project_vertex>\\n\\tgl_Position.z = gl_Position.w;\\n}\";\n\nconst fragment$g = \"#ifdef ENVMAP_TYPE_CUBE\\n\\tuniform samplerCube envMap;\\n#elif defined( ENVMAP_TYPE_CUBE_UV )\\n\\tuniform sampler2D envMap;\\n#endif\\nuniform float flipEnvMap;\\nuniform float backgroundBlurriness;\\nuniform float backgroundIntensity;\\nvarying vec3 vWorldDirection;\\n#include <cube_uv_reflection_fragment>\\nvoid main() {\\n\\t#ifdef ENVMAP_TYPE_CUBE\\n\\t\\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\\n\\t#elif defined( ENVMAP_TYPE_CUBE_UV )\\n\\t\\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\\n\\t#else\\n\\t\\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\\n\\t#endif\\n\\ttexColor.rgb *= backgroundIntensity;\\n\\tgl_FragColor = texColor;\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n}\";\n\nconst vertex$f = \"varying vec3 vWorldDirection;\\n#include <common>\\nvoid main() {\\n\\tvWorldDirection = transformDirection( position, modelMatrix );\\n\\t#include <begin_vertex>\\n\\t#include <project_vertex>\\n\\tgl_Position.z = gl_Position.w;\\n}\";\n\nconst fragment$f = \"uniform samplerCube tCube;\\nuniform float tFlip;\\nuniform float opacity;\\nvarying vec3 vWorldDirection;\\nvoid main() {\\n\\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\\n\\tgl_FragColor = texColor;\\n\\tgl_FragColor.a *= opacity;\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n}\";\n\nconst vertex$e = \"#include <common>\\n#include <uv_pars_vertex>\\n#include <displacementmap_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvarying vec2 vHighPrecisionZW;\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\t#include <skinbase_vertex>\\n\\t#ifdef USE_DISPLACEMENTMAP\\n\\t\\t#include <beginnormal_vertex>\\n\\t\\t#include <morphnormal_vertex>\\n\\t\\t#include <skinnormal_vertex>\\n\\t#endif\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <skinning_vertex>\\n\\t#include <displacementmap_vertex>\\n\\t#include <project_vertex>\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\tvHighPrecisionZW = gl_Position.zw;\\n}\";\n\nconst fragment$e = \"#if DEPTH_PACKING == 3200\\n\\tuniform float opacity;\\n#endif\\n#include <common>\\n#include <packing>\\n#include <uv_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <alphatest_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvarying vec2 vHighPrecisionZW;\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tvec4 diffuseColor = vec4( 1.0 );\\n\\t#if DEPTH_PACKING == 3200\\n\\t\\tdiffuseColor.a = opacity;\\n\\t#endif\\n\\t#include <map_fragment>\\n\\t#include <alphamap_fragment>\\n\\t#include <alphatest_fragment>\\n\\t#include <logdepthbuf_fragment>\\n\\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\\n\\t#if DEPTH_PACKING == 3200\\n\\t\\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\\n\\t#elif DEPTH_PACKING == 3201\\n\\t\\tgl_FragColor = packDepthToRGBA( fragCoordZ );\\n\\t#endif\\n}\";\n\nconst vertex$d = \"#define DISTANCE\\nvarying vec3 vWorldPosition;\\n#include <common>\\n#include <uv_pars_vertex>\\n#include <displacementmap_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\t#include <skinbase_vertex>\\n\\t#ifdef USE_DISPLACEMENTMAP\\n\\t\\t#include <beginnormal_vertex>\\n\\t\\t#include <morphnormal_vertex>\\n\\t\\t#include <skinnormal_vertex>\\n\\t#endif\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <skinning_vertex>\\n\\t#include <displacementmap_vertex>\\n\\t#include <project_vertex>\\n\\t#include <worldpos_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\tvWorldPosition = worldPosition.xyz;\\n}\";\n\nconst fragment$d = \"#define DISTANCE\\nuniform vec3 referencePosition;\\nuniform float nearDistance;\\nuniform float farDistance;\\nvarying vec3 vWorldPosition;\\n#include <common>\\n#include <packing>\\n#include <uv_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <alphatest_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main () {\\n\\t#include <clipping_planes_fragment>\\n\\tvec4 diffuseColor = vec4( 1.0 );\\n\\t#include <map_fragment>\\n\\t#include <alphamap_fragment>\\n\\t#include <alphatest_fragment>\\n\\tfloat dist = length( vWorldPosition - referencePosition );\\n\\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\\n\\tdist = saturate( dist );\\n\\tgl_FragColor = packDepthToRGBA( dist );\\n}\";\n\nconst vertex$c = \"varying vec3 vWorldDirection;\\n#include <common>\\nvoid main() {\\n\\tvWorldDirection = transformDirection( position, modelMatrix );\\n\\t#include <begin_vertex>\\n\\t#include <project_vertex>\\n}\";\n\nconst fragment$c = \"uniform sampler2D tEquirect;\\nvarying vec3 vWorldDirection;\\n#include <common>\\nvoid main() {\\n\\tvec3 direction = normalize( vWorldDirection );\\n\\tvec2 sampleUV = equirectUv( direction );\\n\\tgl_FragColor = texture2D( tEquirect, sampleUV );\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n}\";\n\nconst vertex$b = \"uniform float scale;\\nattribute float lineDistance;\\nvarying float vLineDistance;\\n#include <common>\\n#include <color_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\tvLineDistance = scale * lineDistance;\\n\\t#include <color_vertex>\\n\\t#include <morphcolor_vertex>\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <project_vertex>\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\t#include <fog_vertex>\\n}\";\n\nconst fragment$b = \"uniform vec3 diffuse;\\nuniform float opacity;\\nuniform float dashSize;\\nuniform float totalSize;\\nvarying float vLineDistance;\\n#include <common>\\n#include <color_pars_fragment>\\n#include <fog_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\\n\\t\\tdiscard;\\n\\t}\\n\\tvec3 outgoingLight = vec3( 0.0 );\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <color_fragment>\\n\\toutgoingLight = diffuseColor.rgb;\\n\\t#include <output_fragment>\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n\\t#include <premultiplied_alpha_fragment>\\n}\";\n\nconst vertex$a = \"#include <common>\\n#include <uv_pars_vertex>\\n#include <uv2_pars_vertex>\\n#include <envmap_pars_vertex>\\n#include <color_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\t#include <uv2_vertex>\\n\\t#include <color_vertex>\\n\\t#include <morphcolor_vertex>\\n\\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\\n\\t\\t#include <beginnormal_vertex>\\n\\t\\t#include <morphnormal_vertex>\\n\\t\\t#include <skinbase_vertex>\\n\\t\\t#include <skinnormal_vertex>\\n\\t\\t#include <defaultnormal_vertex>\\n\\t#endif\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <skinning_vertex>\\n\\t#include <project_vertex>\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\t#include <worldpos_vertex>\\n\\t#include <envmap_vertex>\\n\\t#include <fog_vertex>\\n}\";\n\nconst fragment$a = \"uniform vec3 diffuse;\\nuniform float opacity;\\n#ifndef FLAT_SHADED\\n\\tvarying vec3 vNormal;\\n#endif\\n#include <common>\\n#include <dithering_pars_fragment>\\n#include <color_pars_fragment>\\n#include <uv_pars_fragment>\\n#include <uv2_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <alphatest_pars_fragment>\\n#include <aomap_pars_fragment>\\n#include <lightmap_pars_fragment>\\n#include <envmap_common_pars_fragment>\\n#include <envmap_pars_fragment>\\n#include <fog_pars_fragment>\\n#include <specularmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <map_fragment>\\n\\t#include <color_fragment>\\n\\t#include <alphamap_fragment>\\n\\t#include <alphatest_fragment>\\n\\t#include <specularmap_fragment>\\n\\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\\n\\t#ifdef USE_LIGHTMAP\\n\\t\\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\\n\\t\\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\\n\\t#else\\n\\t\\treflectedLight.indirectDiffuse += vec3( 1.0 );\\n\\t#endif\\n\\t#include <aomap_fragment>\\n\\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\\n\\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\\n\\t#include <envmap_fragment>\\n\\t#include <output_fragment>\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n\\t#include <premultiplied_alpha_fragment>\\n\\t#include <dithering_fragment>\\n}\";\n\nconst vertex$9 = \"#define LAMBERT\\nvarying vec3 vViewPosition;\\n#include <common>\\n#include <uv_pars_vertex>\\n#include <uv2_pars_vertex>\\n#include <displacementmap_pars_vertex>\\n#include <envmap_pars_vertex>\\n#include <color_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <normal_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <shadowmap_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\t#include <uv2_vertex>\\n\\t#include <color_vertex>\\n\\t#include <morphcolor_vertex>\\n\\t#include <beginnormal_vertex>\\n\\t#include <morphnormal_vertex>\\n\\t#include <skinbase_vertex>\\n\\t#include <skinnormal_vertex>\\n\\t#include <defaultnormal_vertex>\\n\\t#include <normal_vertex>\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <skinning_vertex>\\n\\t#include <displacementmap_vertex>\\n\\t#include <project_vertex>\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\tvViewPosition = - mvPosition.xyz;\\n\\t#include <worldpos_vertex>\\n\\t#include <envmap_vertex>\\n\\t#include <shadowmap_vertex>\\n\\t#include <fog_vertex>\\n}\";\n\nconst fragment$9 = \"#define LAMBERT\\nuniform vec3 diffuse;\\nuniform vec3 emissive;\\nuniform float opacity;\\n#include <common>\\n#include <packing>\\n#include <dithering_pars_fragment>\\n#include <color_pars_fragment>\\n#include <uv_pars_fragment>\\n#include <uv2_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <alphatest_pars_fragment>\\n#include <aomap_pars_fragment>\\n#include <lightmap_pars_fragment>\\n#include <emissivemap_pars_fragment>\\n#include <envmap_common_pars_fragment>\\n#include <envmap_pars_fragment>\\n#include <fog_pars_fragment>\\n#include <bsdfs>\\n#include <lights_pars_begin>\\n#include <normal_pars_fragment>\\n#include <lights_lambert_pars_fragment>\\n#include <shadowmap_pars_fragment>\\n#include <bumpmap_pars_fragment>\\n#include <normalmap_pars_fragment>\\n#include <specularmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\\n\\tvec3 totalEmissiveRadiance = emissive;\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <map_fragment>\\n\\t#include <color_fragment>\\n\\t#include <alphamap_fragment>\\n\\t#include <alphatest_fragment>\\n\\t#include <specularmap_fragment>\\n\\t#include <normal_fragment_begin>\\n\\t#include <normal_fragment_maps>\\n\\t#include <emissivemap_fragment>\\n\\t#include <lights_lambert_fragment>\\n\\t#include <lights_fragment_begin>\\n\\t#include <lights_fragment_maps>\\n\\t#include <lights_fragment_end>\\n\\t#include <aomap_fragment>\\n\\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\\n\\t#include <envmap_fragment>\\n\\t#include <output_fragment>\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n\\t#include <premultiplied_alpha_fragment>\\n\\t#include <dithering_fragment>\\n}\";\n\nconst vertex$8 = \"#define MATCAP\\nvarying vec3 vViewPosition;\\n#include <common>\\n#include <uv_pars_vertex>\\n#include <color_pars_vertex>\\n#include <displacementmap_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <normal_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\t#include <color_vertex>\\n\\t#include <morphcolor_vertex>\\n\\t#include <beginnormal_vertex>\\n\\t#include <morphnormal_vertex>\\n\\t#include <skinbase_vertex>\\n\\t#include <skinnormal_vertex>\\n\\t#include <defaultnormal_vertex>\\n\\t#include <normal_vertex>\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <skinning_vertex>\\n\\t#include <displacementmap_vertex>\\n\\t#include <project_vertex>\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\t#include <fog_vertex>\\n\\tvViewPosition = - mvPosition.xyz;\\n}\";\n\nconst fragment$8 = \"#define MATCAP\\nuniform vec3 diffuse;\\nuniform float opacity;\\nuniform sampler2D matcap;\\nvarying vec3 vViewPosition;\\n#include <common>\\n#include <dithering_pars_fragment>\\n#include <color_pars_fragment>\\n#include <uv_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <alphatest_pars_fragment>\\n#include <fog_pars_fragment>\\n#include <normal_pars_fragment>\\n#include <bumpmap_pars_fragment>\\n#include <normalmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <map_fragment>\\n\\t#include <color_fragment>\\n\\t#include <alphamap_fragment>\\n\\t#include <alphatest_fragment>\\n\\t#include <normal_fragment_begin>\\n\\t#include <normal_fragment_maps>\\n\\tvec3 viewDir = normalize( vViewPosition );\\n\\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\\n\\tvec3 y = cross( viewDir, x );\\n\\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\\n\\t#ifdef USE_MATCAP\\n\\t\\tvec4 matcapColor = texture2D( matcap, uv );\\n\\t#else\\n\\t\\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\\n\\t#endif\\n\\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\\n\\t#include <output_fragment>\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n\\t#include <premultiplied_alpha_fragment>\\n\\t#include <dithering_fragment>\\n}\";\n\nconst vertex$7 = \"#define NORMAL\\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\\n\\tvarying vec3 vViewPosition;\\n#endif\\n#include <common>\\n#include <uv_pars_vertex>\\n#include <displacementmap_pars_vertex>\\n#include <normal_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\t#include <beginnormal_vertex>\\n\\t#include <morphnormal_vertex>\\n\\t#include <skinbase_vertex>\\n\\t#include <skinnormal_vertex>\\n\\t#include <defaultnormal_vertex>\\n\\t#include <normal_vertex>\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <skinning_vertex>\\n\\t#include <displacementmap_vertex>\\n\\t#include <project_vertex>\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\\n\\tvViewPosition = - mvPosition.xyz;\\n#endif\\n}\";\n\nconst fragment$7 = \"#define NORMAL\\nuniform float opacity;\\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\\n\\tvarying vec3 vViewPosition;\\n#endif\\n#include <packing>\\n#include <uv_pars_fragment>\\n#include <normal_pars_fragment>\\n#include <bumpmap_pars_fragment>\\n#include <normalmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <normal_fragment_begin>\\n\\t#include <normal_fragment_maps>\\n\\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\\n\\t#ifdef OPAQUE\\n\\t\\tgl_FragColor.a = 1.0;\\n\\t#endif\\n}\";\n\nconst vertex$6 = \"#define PHONG\\nvarying vec3 vViewPosition;\\n#include <common>\\n#include <uv_pars_vertex>\\n#include <uv2_pars_vertex>\\n#include <displacementmap_pars_vertex>\\n#include <envmap_pars_vertex>\\n#include <color_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <normal_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <shadowmap_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\t#include <uv2_vertex>\\n\\t#include <color_vertex>\\n\\t#include <morphcolor_vertex>\\n\\t#include <beginnormal_vertex>\\n\\t#include <morphnormal_vertex>\\n\\t#include <skinbase_vertex>\\n\\t#include <skinnormal_vertex>\\n\\t#include <defaultnormal_vertex>\\n\\t#include <normal_vertex>\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <skinning_vertex>\\n\\t#include <displacementmap_vertex>\\n\\t#include <project_vertex>\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\tvViewPosition = - mvPosition.xyz;\\n\\t#include <worldpos_vertex>\\n\\t#include <envmap_vertex>\\n\\t#include <shadowmap_vertex>\\n\\t#include <fog_vertex>\\n}\";\n\nconst fragment$6 = \"#define PHONG\\nuniform vec3 diffuse;\\nuniform vec3 emissive;\\nuniform vec3 specular;\\nuniform float shininess;\\nuniform float opacity;\\n#include <common>\\n#include <packing>\\n#include <dithering_pars_fragment>\\n#include <color_pars_fragment>\\n#include <uv_pars_fragment>\\n#include <uv2_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <alphatest_pars_fragment>\\n#include <aomap_pars_fragment>\\n#include <lightmap_pars_fragment>\\n#include <emissivemap_pars_fragment>\\n#include <envmap_common_pars_fragment>\\n#include <envmap_pars_fragment>\\n#include <fog_pars_fragment>\\n#include <bsdfs>\\n#include <lights_pars_begin>\\n#include <normal_pars_fragment>\\n#include <lights_phong_pars_fragment>\\n#include <shadowmap_pars_fragment>\\n#include <bumpmap_pars_fragment>\\n#include <normalmap_pars_fragment>\\n#include <specularmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\\n\\tvec3 totalEmissiveRadiance = emissive;\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <map_fragment>\\n\\t#include <color_fragment>\\n\\t#include <alphamap_fragment>\\n\\t#include <alphatest_fragment>\\n\\t#include <specularmap_fragment>\\n\\t#include <normal_fragment_begin>\\n\\t#include <normal_fragment_maps>\\n\\t#include <emissivemap_fragment>\\n\\t#include <lights_phong_fragment>\\n\\t#include <lights_fragment_begin>\\n\\t#include <lights_fragment_maps>\\n\\t#include <lights_fragment_end>\\n\\t#include <aomap_fragment>\\n\\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\\n\\t#include <envmap_fragment>\\n\\t#include <output_fragment>\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n\\t#include <premultiplied_alpha_fragment>\\n\\t#include <dithering_fragment>\\n}\";\n\nconst vertex$5 = \"#define STANDARD\\nvarying vec3 vViewPosition;\\n#ifdef USE_TRANSMISSION\\n\\tvarying vec3 vWorldPosition;\\n#endif\\n#include <common>\\n#include <uv_pars_vertex>\\n#include <uv2_pars_vertex>\\n#include <displacementmap_pars_vertex>\\n#include <color_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <normal_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <shadowmap_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\t#include <uv2_vertex>\\n\\t#include <color_vertex>\\n\\t#include <morphcolor_vertex>\\n\\t#include <beginnormal_vertex>\\n\\t#include <morphnormal_vertex>\\n\\t#include <skinbase_vertex>\\n\\t#include <skinnormal_vertex>\\n\\t#include <defaultnormal_vertex>\\n\\t#include <normal_vertex>\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <skinning_vertex>\\n\\t#include <displacementmap_vertex>\\n\\t#include <project_vertex>\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\tvViewPosition = - mvPosition.xyz;\\n\\t#include <worldpos_vertex>\\n\\t#include <shadowmap_vertex>\\n\\t#include <fog_vertex>\\n#ifdef USE_TRANSMISSION\\n\\tvWorldPosition = worldPosition.xyz;\\n#endif\\n}\";\n\nconst fragment$5 = \"#define STANDARD\\n#ifdef PHYSICAL\\n\\t#define IOR\\n\\t#define SPECULAR\\n#endif\\nuniform vec3 diffuse;\\nuniform vec3 emissive;\\nuniform float roughness;\\nuniform float metalness;\\nuniform float opacity;\\n#ifdef IOR\\n\\tuniform float ior;\\n#endif\\n#ifdef SPECULAR\\n\\tuniform float specularIntensity;\\n\\tuniform vec3 specularColor;\\n\\t#ifdef USE_SPECULARINTENSITYMAP\\n\\t\\tuniform sampler2D specularIntensityMap;\\n\\t#endif\\n\\t#ifdef USE_SPECULARCOLORMAP\\n\\t\\tuniform sampler2D specularColorMap;\\n\\t#endif\\n#endif\\n#ifdef USE_CLEARCOAT\\n\\tuniform float clearcoat;\\n\\tuniform float clearcoatRoughness;\\n#endif\\n#ifdef USE_IRIDESCENCE\\n\\tuniform float iridescence;\\n\\tuniform float iridescenceIOR;\\n\\tuniform float iridescenceThicknessMinimum;\\n\\tuniform float iridescenceThicknessMaximum;\\n#endif\\n#ifdef USE_SHEEN\\n\\tuniform vec3 sheenColor;\\n\\tuniform float sheenRoughness;\\n\\t#ifdef USE_SHEENCOLORMAP\\n\\t\\tuniform sampler2D sheenColorMap;\\n\\t#endif\\n\\t#ifdef USE_SHEENROUGHNESSMAP\\n\\t\\tuniform sampler2D sheenRoughnessMap;\\n\\t#endif\\n#endif\\nvarying vec3 vViewPosition;\\n#include <common>\\n#include <packing>\\n#include <dithering_pars_fragment>\\n#include <color_pars_fragment>\\n#include <uv_pars_fragment>\\n#include <uv2_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <alphatest_pars_fragment>\\n#include <aomap_pars_fragment>\\n#include <lightmap_pars_fragment>\\n#include <emissivemap_pars_fragment>\\n#include <bsdfs>\\n#include <iridescence_fragment>\\n#include <cube_uv_reflection_fragment>\\n#include <envmap_common_pars_fragment>\\n#include <envmap_physical_pars_fragment>\\n#include <fog_pars_fragment>\\n#include <lights_pars_begin>\\n#include <normal_pars_fragment>\\n#include <lights_physical_pars_fragment>\\n#include <transmission_pars_fragment>\\n#include <shadowmap_pars_fragment>\\n#include <bumpmap_pars_fragment>\\n#include <normalmap_pars_fragment>\\n#include <clearcoat_pars_fragment>\\n#include <iridescence_pars_fragment>\\n#include <roughnessmap_pars_fragment>\\n#include <metalnessmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\\n\\tvec3 totalEmissiveRadiance = emissive;\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <map_fragment>\\n\\t#include <color_fragment>\\n\\t#include <alphamap_fragment>\\n\\t#include <alphatest_fragment>\\n\\t#include <roughnessmap_fragment>\\n\\t#include <metalnessmap_fragment>\\n\\t#include <normal_fragment_begin>\\n\\t#include <normal_fragment_maps>\\n\\t#include <clearcoat_normal_fragment_begin>\\n\\t#include <clearcoat_normal_fragment_maps>\\n\\t#include <emissivemap_fragment>\\n\\t#include <lights_physical_fragment>\\n\\t#include <lights_fragment_begin>\\n\\t#include <lights_fragment_maps>\\n\\t#include <lights_fragment_end>\\n\\t#include <aomap_fragment>\\n\\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\\n\\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\\n\\t#include <transmission_fragment>\\n\\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\\n\\t#ifdef USE_SHEEN\\n\\t\\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\\n\\t\\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\\n\\t#endif\\n\\t#ifdef USE_CLEARCOAT\\n\\t\\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\\n\\t\\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\\n\\t\\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\\n\\t#endif\\n\\t#include <output_fragment>\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n\\t#include <premultiplied_alpha_fragment>\\n\\t#include <dithering_fragment>\\n}\";\n\nconst vertex$4 = \"#define TOON\\nvarying vec3 vViewPosition;\\n#include <common>\\n#include <uv_pars_vertex>\\n#include <uv2_pars_vertex>\\n#include <displacementmap_pars_vertex>\\n#include <color_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <normal_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <shadowmap_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\t#include <uv2_vertex>\\n\\t#include <color_vertex>\\n\\t#include <morphcolor_vertex>\\n\\t#include <beginnormal_vertex>\\n\\t#include <morphnormal_vertex>\\n\\t#include <skinbase_vertex>\\n\\t#include <skinnormal_vertex>\\n\\t#include <defaultnormal_vertex>\\n\\t#include <normal_vertex>\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <skinning_vertex>\\n\\t#include <displacementmap_vertex>\\n\\t#include <project_vertex>\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\tvViewPosition = - mvPosition.xyz;\\n\\t#include <worldpos_vertex>\\n\\t#include <shadowmap_vertex>\\n\\t#include <fog_vertex>\\n}\";\n\nconst fragment$4 = \"#define TOON\\nuniform vec3 diffuse;\\nuniform vec3 emissive;\\nuniform float opacity;\\n#include <common>\\n#include <packing>\\n#include <dithering_pars_fragment>\\n#include <color_pars_fragment>\\n#include <uv_pars_fragment>\\n#include <uv2_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <alphatest_pars_fragment>\\n#include <aomap_pars_fragment>\\n#include <lightmap_pars_fragment>\\n#include <emissivemap_pars_fragment>\\n#include <gradientmap_pars_fragment>\\n#include <fog_pars_fragment>\\n#include <bsdfs>\\n#include <lights_pars_begin>\\n#include <normal_pars_fragment>\\n#include <lights_toon_pars_fragment>\\n#include <shadowmap_pars_fragment>\\n#include <bumpmap_pars_fragment>\\n#include <normalmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\\n\\tvec3 totalEmissiveRadiance = emissive;\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <map_fragment>\\n\\t#include <color_fragment>\\n\\t#include <alphamap_fragment>\\n\\t#include <alphatest_fragment>\\n\\t#include <normal_fragment_begin>\\n\\t#include <normal_fragment_maps>\\n\\t#include <emissivemap_fragment>\\n\\t#include <lights_toon_fragment>\\n\\t#include <lights_fragment_begin>\\n\\t#include <lights_fragment_maps>\\n\\t#include <lights_fragment_end>\\n\\t#include <aomap_fragment>\\n\\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\\n\\t#include <output_fragment>\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n\\t#include <premultiplied_alpha_fragment>\\n\\t#include <dithering_fragment>\\n}\";\n\nconst vertex$3 = \"uniform float size;\\nuniform float scale;\\n#include <common>\\n#include <color_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <color_vertex>\\n\\t#include <morphcolor_vertex>\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <project_vertex>\\n\\tgl_PointSize = size;\\n\\t#ifdef USE_SIZEATTENUATION\\n\\t\\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\\n\\t\\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\\n\\t#endif\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\t#include <worldpos_vertex>\\n\\t#include <fog_vertex>\\n}\";\n\nconst fragment$3 = \"uniform vec3 diffuse;\\nuniform float opacity;\\n#include <common>\\n#include <color_pars_fragment>\\n#include <map_particle_pars_fragment>\\n#include <alphatest_pars_fragment>\\n#include <fog_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tvec3 outgoingLight = vec3( 0.0 );\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <map_particle_fragment>\\n\\t#include <color_fragment>\\n\\t#include <alphatest_fragment>\\n\\toutgoingLight = diffuseColor.rgb;\\n\\t#include <output_fragment>\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n\\t#include <premultiplied_alpha_fragment>\\n}\";\n\nconst vertex$2 = \"#include <common>\\n#include <fog_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <shadowmap_pars_vertex>\\nvoid main() {\\n\\t#include <beginnormal_vertex>\\n\\t#include <morphnormal_vertex>\\n\\t#include <skinbase_vertex>\\n\\t#include <skinnormal_vertex>\\n\\t#include <defaultnormal_vertex>\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <skinning_vertex>\\n\\t#include <project_vertex>\\n\\t#include <worldpos_vertex>\\n\\t#include <shadowmap_vertex>\\n\\t#include <fog_vertex>\\n}\";\n\nconst fragment$2 = \"uniform vec3 color;\\nuniform float opacity;\\n#include <common>\\n#include <packing>\\n#include <fog_pars_fragment>\\n#include <bsdfs>\\n#include <lights_pars_begin>\\n#include <shadowmap_pars_fragment>\\n#include <shadowmask_pars_fragment>\\nvoid main() {\\n\\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n}\";\n\nconst vertex$1 = \"uniform float rotation;\\nuniform vec2 center;\\n#include <common>\\n#include <uv_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\\n\\tvec2 scale;\\n\\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\\n\\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\\n\\t#ifndef USE_SIZEATTENUATION\\n\\t\\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\\n\\t\\tif ( isPerspective ) scale *= - mvPosition.z;\\n\\t#endif\\n\\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\\n\\tvec2 rotatedPosition;\\n\\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\\n\\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\\n\\tmvPosition.xy += rotatedPosition;\\n\\tgl_Position = projectionMatrix * mvPosition;\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\t#include <fog_vertex>\\n}\";\n\nconst fragment$1 = \"uniform vec3 diffuse;\\nuniform float opacity;\\n#include <common>\\n#include <uv_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <alphatest_pars_fragment>\\n#include <fog_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tvec3 outgoingLight = vec3( 0.0 );\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <map_fragment>\\n\\t#include <alphamap_fragment>\\n\\t#include <alphatest_fragment>\\n\\toutgoingLight = diffuseColor.rgb;\\n\\t#include <output_fragment>\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n}\";\n\nconst ShaderChunk = {\n\talphamap_fragment: alphamap_fragment,\n\talphamap_pars_fragment: alphamap_pars_fragment,\n\talphatest_fragment: alphatest_fragment,\n\talphatest_pars_fragment: alphatest_pars_fragment,\n\taomap_fragment: aomap_fragment,\n\taomap_pars_fragment: aomap_pars_fragment,\n\tbegin_vertex: begin_vertex,\n\tbeginnormal_vertex: beginnormal_vertex,\n\tbsdfs: bsdfs,\n\tiridescence_fragment: iridescence_fragment,\n\tbumpmap_pars_fragment: bumpmap_pars_fragment,\n\tclipping_planes_fragment: clipping_planes_fragment,\n\tclipping_planes_pars_fragment: clipping_planes_pars_fragment,\n\tclipping_planes_pars_vertex: clipping_planes_pars_vertex,\n\tclipping_planes_vertex: clipping_planes_vertex,\n\tcolor_fragment: color_fragment,\n\tcolor_pars_fragment: color_pars_fragment,\n\tcolor_pars_vertex: color_pars_vertex,\n\tcolor_vertex: color_vertex,\n\tcommon: common,\n\tcube_uv_reflection_fragment: cube_uv_reflection_fragment,\n\tdefaultnormal_vertex: defaultnormal_vertex,\n\tdisplacementmap_pars_vertex: displacementmap_pars_vertex,\n\tdisplacementmap_vertex: displacementmap_vertex,\n\temissivemap_fragment: emissivemap_fragment,\n\temissivemap_pars_fragment: emissivemap_pars_fragment,\n\tencodings_fragment: encodings_fragment,\n\tencodings_pars_fragment: encodings_pars_fragment,\n\tenvmap_fragment: envmap_fragment,\n\tenvmap_common_pars_fragment: envmap_common_pars_fragment,\n\tenvmap_pars_fragment: envmap_pars_fragment,\n\tenvmap_pars_vertex: envmap_pars_vertex,\n\tenvmap_physical_pars_fragment: envmap_physical_pars_fragment,\n\tenvmap_vertex: envmap_vertex,\n\tfog_vertex: fog_vertex,\n\tfog_pars_vertex: fog_pars_vertex,\n\tfog_fragment: fog_fragment,\n\tfog_pars_fragment: fog_pars_fragment,\n\tgradientmap_pars_fragment: gradientmap_pars_fragment,\n\tlightmap_fragment: lightmap_fragment,\n\tlightmap_pars_fragment: lightmap_pars_fragment,\n\tlights_lambert_fragment: lights_lambert_fragment,\n\tlights_lambert_pars_fragment: lights_lambert_pars_fragment,\n\tlights_pars_begin: lights_pars_begin,\n\tlights_toon_fragment: lights_toon_fragment,\n\tlights_toon_pars_fragment: lights_toon_pars_fragment,\n\tlights_phong_fragment: lights_phong_fragment,\n\tlights_phong_pars_fragment: lights_phong_pars_fragment,\n\tlights_physical_fragment: lights_physical_fragment,\n\tlights_physical_pars_fragment: lights_physical_pars_fragment,\n\tlights_fragment_begin: lights_fragment_begin,\n\tlights_fragment_maps: lights_fragment_maps,\n\tlights_fragment_end: lights_fragment_end,\n\tlogdepthbuf_fragment: logdepthbuf_fragment,\n\tlogdepthbuf_pars_fragment: logdepthbuf_pars_fragment,\n\tlogdepthbuf_pars_vertex: logdepthbuf_pars_vertex,\n\tlogdepthbuf_vertex: logdepthbuf_vertex,\n\tmap_fragment: map_fragment,\n\tmap_pars_fragment: map_pars_fragment,\n\tmap_particle_fragment: map_particle_fragment,\n\tmap_particle_pars_fragment: map_particle_pars_fragment,\n\tmetalnessmap_fragment: metalnessmap_fragment,\n\tmetalnessmap_pars_fragment: metalnessmap_pars_fragment,\n\tmorphcolor_vertex: morphcolor_vertex,\n\tmorphnormal_vertex: morphnormal_vertex,\n\tmorphtarget_pars_vertex: morphtarget_pars_vertex,\n\tmorphtarget_vertex: morphtarget_vertex,\n\tnormal_fragment_begin: normal_fragment_begin,\n\tnormal_fragment_maps: normal_fragment_maps,\n\tnormal_pars_fragment: normal_pars_fragment,\n\tnormal_pars_vertex: normal_pars_vertex,\n\tnormal_vertex: normal_vertex,\n\tnormalmap_pars_fragment: normalmap_pars_fragment,\n\tclearcoat_normal_fragment_begin: clearcoat_normal_fragment_begin,\n\tclearcoat_normal_fragment_maps: clearcoat_normal_fragment_maps,\n\tclearcoat_pars_fragment: clearcoat_pars_fragment,\n\tiridescence_pars_fragment: iridescence_pars_fragment,\n\toutput_fragment: output_fragment,\n\tpacking: packing,\n\tpremultiplied_alpha_fragment: premultiplied_alpha_fragment,\n\tproject_vertex: project_vertex,\n\tdithering_fragment: dithering_fragment,\n\tdithering_pars_fragment: dithering_pars_fragment,\n\troughnessmap_fragment: roughnessmap_fragment,\n\troughnessmap_pars_fragment: roughnessmap_pars_fragment,\n\tshadowmap_pars_fragment: shadowmap_pars_fragment,\n\tshadowmap_pars_vertex: shadowmap_pars_vertex,\n\tshadowmap_vertex: shadowmap_vertex,\n\tshadowmask_pars_fragment: shadowmask_pars_fragment,\n\tskinbase_vertex: skinbase_vertex,\n\tskinning_pars_vertex: skinning_pars_vertex,\n\tskinning_vertex: skinning_vertex,\n\tskinnormal_vertex: skinnormal_vertex,\n\tspecularmap_fragment: specularmap_fragment,\n\tspecularmap_pars_fragment: specularmap_pars_fragment,\n\ttonemapping_fragment: tonemapping_fragment,\n\ttonemapping_pars_fragment: tonemapping_pars_fragment,\n\ttransmission_fragment: transmission_fragment,\n\ttransmission_pars_fragment: transmission_pars_fragment,\n\tuv_pars_fragment: uv_pars_fragment,\n\tuv_pars_vertex: uv_pars_vertex,\n\tuv_vertex: uv_vertex,\n\tuv2_pars_fragment: uv2_pars_fragment,\n\tuv2_pars_vertex: uv2_pars_vertex,\n\tuv2_vertex: uv2_vertex,\n\tworldpos_vertex: worldpos_vertex,\n\n\tbackground_vert: vertex$h,\n\tbackground_frag: fragment$h,\n\tbackgroundCube_vert: vertex$g,\n\tbackgroundCube_frag: fragment$g,\n\tcube_vert: vertex$f,\n\tcube_frag: fragment$f,\n\tdepth_vert: vertex$e,\n\tdepth_frag: fragment$e,\n\tdistanceRGBA_vert: vertex$d,\n\tdistanceRGBA_frag: fragment$d,\n\tequirect_vert: vertex$c,\n\tequirect_frag: fragment$c,\n\tlinedashed_vert: vertex$b,\n\tlinedashed_frag: fragment$b,\n\tmeshbasic_vert: vertex$a,\n\tmeshbasic_frag: fragment$a,\n\tmeshlambert_vert: vertex$9,\n\tmeshlambert_frag: fragment$9,\n\tmeshmatcap_vert: vertex$8,\n\tmeshmatcap_frag: fragment$8,\n\tmeshnormal_vert: vertex$7,\n\tmeshnormal_frag: fragment$7,\n\tmeshphong_vert: vertex$6,\n\tmeshphong_frag: fragment$6,\n\tmeshphysical_vert: vertex$5,\n\tmeshphysical_frag: fragment$5,\n\tmeshtoon_vert: vertex$4,\n\tmeshtoon_frag: fragment$4,\n\tpoints_vert: vertex$3,\n\tpoints_frag: fragment$3,\n\tshadow_vert: vertex$2,\n\tshadow_frag: fragment$2,\n\tsprite_vert: vertex$1,\n\tsprite_frag: fragment$1\n};\n\n/**\n * Uniforms library for shared webgl shaders\n */\n\nconst UniformsLib = {\n\n\tcommon: {\n\n\t\tdiffuse: { value: /*@__PURE__*/ new Color( 0xffffff ) },\n\t\topacity: { value: 1.0 },\n\n\t\tmap: { value: null },\n\t\tuvTransform: { value: /*@__PURE__*/ new Matrix3() },\n\t\tuv2Transform: { value: /*@__PURE__*/ new Matrix3() },\n\n\t\talphaMap: { value: null },\n\t\talphaTest: { value: 0 }\n\n\t},\n\n\tspecularmap: {\n\n\t\tspecularMap: { value: null },\n\n\t},\n\n\tenvmap: {\n\n\t\tenvMap: { value: null },\n\t\tflipEnvMap: { value: - 1 },\n\t\treflectivity: { value: 1.0 }, // basic, lambert, phong\n\t\tior: { value: 1.5 }, // physical\n\t\trefractionRatio: { value: 0.98 }, // basic, lambert, phong\n\n\t},\n\n\taomap: {\n\n\t\taoMap: { value: null },\n\t\taoMapIntensity: { value: 1 }\n\n\t},\n\n\tlightmap: {\n\n\t\tlightMap: { value: null },\n\t\tlightMapIntensity: { value: 1 }\n\n\t},\n\n\temissivemap: {\n\n\t\temissiveMap: { value: null }\n\n\t},\n\n\tbumpmap: {\n\n\t\tbumpMap: { value: null },\n\t\tbumpScale: { value: 1 }\n\n\t},\n\n\tnormalmap: {\n\n\t\tnormalMap: { value: null },\n\t\tnormalScale: { value: /*@__PURE__*/ new Vector2( 1, 1 ) }\n\n\t},\n\n\tdisplacementmap: {\n\n\t\tdisplacementMap: { value: null },\n\t\tdisplacementScale: { value: 1 },\n\t\tdisplacementBias: { value: 0 }\n\n\t},\n\n\troughnessmap: {\n\n\t\troughnessMap: { value: null }\n\n\t},\n\n\tmetalnessmap: {\n\n\t\tmetalnessMap: { value: null }\n\n\t},\n\n\tgradientmap: {\n\n\t\tgradientMap: { value: null }\n\n\t},\n\n\tfog: {\n\n\t\tfogDensity: { value: 0.00025 },\n\t\tfogNear: { value: 1 },\n\t\tfogFar: { value: 2000 },\n\t\tfogColor: { value: /*@__PURE__*/ new Color( 0xffffff ) }\n\n\t},\n\n\tlights: {\n\n\t\tambientLightColor: { value: [] },\n\n\t\tlightProbe: { value: [] },\n\n\t\tdirectionalLights: { value: [], properties: {\n\t\t\tdirection: {},\n\t\t\tcolor: {}\n\t\t} },\n\n\t\tdirectionalLightShadows: { value: [], properties: {\n\t\t\tshadowBias: {},\n\t\t\tshadowNormalBias: {},\n\t\t\tshadowRadius: {},\n\t\t\tshadowMapSize: {}\n\t\t} },\n\n\t\tdirectionalShadowMap: { value: [] },\n\t\tdirectionalShadowMatrix: { value: [] },\n\n\t\tspotLights: { value: [], properties: {\n\t\t\tcolor: {},\n\t\t\tposition: {},\n\t\t\tdirection: {},\n\t\t\tdistance: {},\n\t\t\tconeCos: {},\n\t\t\tpenumbraCos: {},\n\t\t\tdecay: {}\n\t\t} },\n\n\t\tspotLightShadows: { value: [], properties: {\n\t\t\tshadowBias: {},\n\t\t\tshadowNormalBias: {},\n\t\t\tshadowRadius: {},\n\t\t\tshadowMapSize: {}\n\t\t} },\n\n\t\tspotLightMap: { value: [] },\n\t\tspotShadowMap: { value: [] },\n\t\tspotLightMatrix: { value: [] },\n\n\t\tpointLights: { value: [], properties: {\n\t\t\tcolor: {},\n\t\t\tposition: {},\n\t\t\tdecay: {},\n\t\t\tdistance: {}\n\t\t} },\n\n\t\tpointLightShadows: { value: [], properties: {\n\t\t\tshadowBias: {},\n\t\t\tshadowNormalBias: {},\n\t\t\tshadowRadius: {},\n\t\t\tshadowMapSize: {},\n\t\t\tshadowCameraNear: {},\n\t\t\tshadowCameraFar: {}\n\t\t} },\n\n\t\tpointShadowMap: { value: [] },\n\t\tpointShadowMatrix: { value: [] },\n\n\t\themisphereLights: { value: [], properties: {\n\t\t\tdirection: {},\n\t\t\tskyColor: {},\n\t\t\tgroundColor: {}\n\t\t} },\n\n\t\t// TODO (abelnation): RectAreaLight BRDF data needs to be moved from example to main src\n\t\trectAreaLights: { value: [], properties: {\n\t\t\tcolor: {},\n\t\t\tposition: {},\n\t\t\twidth: {},\n\t\t\theight: {}\n\t\t} },\n\n\t\tltc_1: { value: null },\n\t\tltc_2: { value: null }\n\n\t},\n\n\tpoints: {\n\n\t\tdiffuse: { value: /*@__PURE__*/ new Color( 0xffffff ) },\n\t\topacity: { value: 1.0 },\n\t\tsize: { value: 1.0 },\n\t\tscale: { value: 1.0 },\n\t\tmap: { value: null },\n\t\talphaMap: { value: null },\n\t\talphaTest: { value: 0 },\n\t\tuvTransform: { value: /*@__PURE__*/ new Matrix3() }\n\n\t},\n\n\tsprite: {\n\n\t\tdiffuse: { value: /*@__PURE__*/ new Color( 0xffffff ) },\n\t\topacity: { value: 1.0 },\n\t\tcenter: { value: /*@__PURE__*/ new Vector2( 0.5, 0.5 ) },\n\t\trotation: { value: 0.0 },\n\t\tmap: { value: null },\n\t\talphaMap: { value: null },\n\t\talphaTest: { value: 0 },\n\t\tuvTransform: { value: /*@__PURE__*/ new Matrix3() }\n\n\t}\n\n};\n\nconst ShaderLib = {\n\n\tbasic: {\n\n\t\tuniforms: /*@__PURE__*/ mergeUniforms( [\n\t\t\tUniformsLib.common,\n\t\t\tUniformsLib.specularmap,\n\t\t\tUniformsLib.envmap,\n\t\t\tUniformsLib.aomap,\n\t\t\tUniformsLib.lightmap,\n\t\t\tUniformsLib.fog\n\t\t] ),\n\n\t\tvertexShader: ShaderChunk.meshbasic_vert,\n\t\tfragmentShader: ShaderChunk.meshbasic_frag\n\n\t},\n\n\tlambert: {\n\n\t\tuniforms: /*@__PURE__*/ mergeUniforms( [\n\t\t\tUniformsLib.common,\n\t\t\tUniformsLib.specularmap,\n\t\t\tUniformsLib.envmap,\n\t\t\tUniformsLib.aomap,\n\t\t\tUniformsLib.lightmap,\n\t\t\tUniformsLib.emissivemap,\n\t\t\tUniformsLib.bumpmap,\n\t\t\tUniformsLib.normalmap,\n\t\t\tUniformsLib.displacementmap,\n\t\t\tUniformsLib.fog,\n\t\t\tUniformsLib.lights,\n\t\t\t{\n\t\t\t\temissive: { value: /*@__PURE__*/ new Color( 0x000000 ) }\n\t\t\t}\n\t\t] ),\n\n\t\tvertexShader: ShaderChunk.meshlambert_vert,\n\t\tfragmentShader: ShaderChunk.meshlambert_frag\n\n\t},\n\n\tphong: {\n\n\t\tuniforms: /*@__PURE__*/ mergeUniforms( [\n\t\t\tUniformsLib.common,\n\t\t\tUniformsLib.specularmap,\n\t\t\tUniformsLib.envmap,\n\t\t\tUniformsLib.aomap,\n\t\t\tUniformsLib.lightmap,\n\t\t\tUniformsLib.emissivemap,\n\t\t\tUniformsLib.bumpmap,\n\t\t\tUniformsLib.normalmap,\n\t\t\tUniformsLib.displacementmap,\n\t\t\tUniformsLib.fog,\n\t\t\tUniformsLib.lights,\n\t\t\t{\n\t\t\t\temissive: { value: /*@__PURE__*/ new Color( 0x000000 ) },\n\t\t\t\tspecular: { value: /*@__PURE__*/ new Color( 0x111111 ) },\n\t\t\t\tshininess: { value: 30 }\n\t\t\t}\n\t\t] ),\n\n\t\tvertexShader: ShaderChunk.meshphong_vert,\n\t\tfragmentShader: ShaderChunk.meshphong_frag\n\n\t},\n\n\tstandard: {\n\n\t\tuniforms: /*@__PURE__*/ mergeUniforms( [\n\t\t\tUniformsLib.common,\n\t\t\tUniformsLib.envmap,\n\t\t\tUniformsLib.aomap,\n\t\t\tUniformsLib.lightmap,\n\t\t\tUniformsLib.emissivemap,\n\t\t\tUniformsLib.bumpmap,\n\t\t\tUniformsLib.normalmap,\n\t\t\tUniformsLib.displacementmap,\n\t\t\tUniformsLib.roughnessmap,\n\t\t\tUniformsLib.metalnessmap,\n\t\t\tUniformsLib.fog,\n\t\t\tUniformsLib.lights,\n\t\t\t{\n\t\t\t\temissive: { value: /*@__PURE__*/ new Color( 0x000000 ) },\n\t\t\t\troughness: { value: 1.0 },\n\t\t\t\tmetalness: { value: 0.0 },\n\t\t\t\tenvMapIntensity: { value: 1 } // temporary\n\t\t\t}\n\t\t] ),\n\n\t\tvertexShader: ShaderChunk.meshphysical_vert,\n\t\tfragmentShader: ShaderChunk.meshphysical_frag\n\n\t},\n\n\ttoon: {\n\n\t\tuniforms: /*@__PURE__*/ mergeUniforms( [\n\t\t\tUniformsLib.common,\n\t\t\tUniformsLib.aomap,\n\t\t\tUniformsLib.lightmap,\n\t\t\tUniformsLib.emissivemap,\n\t\t\tUniformsLib.bumpmap,\n\t\t\tUniformsLib.normalmap,\n\t\t\tUniformsLib.displacementmap,\n\t\t\tUniformsLib.gradientmap,\n\t\t\tUniformsLib.fog,\n\t\t\tUniformsLib.lights,\n\t\t\t{\n\t\t\t\temissive: { value: /*@__PURE__*/ new Color( 0x000000 ) }\n\t\t\t}\n\t\t] ),\n\n\t\tvertexShader: ShaderChunk.meshtoon_vert,\n\t\tfragmentShader: ShaderChunk.meshtoon_frag\n\n\t},\n\n\tmatcap: {\n\n\t\tuniforms: /*@__PURE__*/ mergeUniforms( [\n\t\t\tUniformsLib.common,\n\t\t\tUniformsLib.bumpmap,\n\t\t\tUniformsLib.normalmap,\n\t\t\tUniformsLib.displacementmap,\n\t\t\tUniformsLib.fog,\n\t\t\t{\n\t\t\t\tmatcap: { value: null }\n\t\t\t}\n\t\t] ),\n\n\t\tvertexShader: ShaderChunk.meshmatcap_vert,\n\t\tfragmentShader: ShaderChunk.meshmatcap_frag\n\n\t},\n\n\tpoints: {\n\n\t\tuniforms: /*@__PURE__*/ mergeUniforms( [\n\t\t\tUniformsLib.points,\n\t\t\tUniformsLib.fog\n\t\t] ),\n\n\t\tvertexShader: ShaderChunk.points_vert,\n\t\tfragmentShader: ShaderChunk.points_frag\n\n\t},\n\n\tdashed: {\n\n\t\tuniforms: /*@__PURE__*/ mergeUniforms( [\n\t\t\tUniformsLib.common,\n\t\t\tUniformsLib.fog,\n\t\t\t{\n\t\t\t\tscale: { value: 1 },\n\t\t\t\tdashSize: { value: 1 },\n\t\t\t\ttotalSize: { value: 2 }\n\t\t\t}\n\t\t] ),\n\n\t\tvertexShader: ShaderChunk.linedashed_vert,\n\t\tfragmentShader: ShaderChunk.linedashed_frag\n\n\t},\n\n\tdepth: {\n\n\t\tuniforms: /*@__PURE__*/ mergeUniforms( [\n\t\t\tUniformsLib.common,\n\t\t\tUniformsLib.displacementmap\n\t\t] ),\n\n\t\tvertexShader: ShaderChunk.depth_vert,\n\t\tfragmentShader: ShaderChunk.depth_frag\n\n\t},\n\n\tnormal: {\n\n\t\tuniforms: /*@__PURE__*/ mergeUniforms( [\n\t\t\tUniformsLib.common,\n\t\t\tUniformsLib.bumpmap,\n\t\t\tUniformsLib.normalmap,\n\t\t\tUniformsLib.displacementmap,\n\t\t\t{\n\t\t\t\topacity: { value: 1.0 }\n\t\t\t}\n\t\t] ),\n\n\t\tvertexShader: ShaderChunk.meshnormal_vert,\n\t\tfragmentShader: ShaderChunk.meshnormal_frag\n\n\t},\n\n\tsprite: {\n\n\t\tuniforms: /*@__PURE__*/ mergeUniforms( [\n\t\t\tUniformsLib.sprite,\n\t\t\tUniformsLib.fog\n\t\t] ),\n\n\t\tvertexShader: ShaderChunk.sprite_vert,\n\t\tfragmentShader: ShaderChunk.sprite_frag\n\n\t},\n\n\tbackground: {\n\n\t\tuniforms: {\n\t\t\tuvTransform: { value: /*@__PURE__*/ new Matrix3() },\n\t\t\tt2D: { value: null },\n\t\t\tbackgroundIntensity: { value: 1 }\n\t\t},\n\n\t\tvertexShader: ShaderChunk.background_vert,\n\t\tfragmentShader: ShaderChunk.background_frag\n\n\t},\n\n\tbackgroundCube: {\n\n\t\tuniforms: {\n\t\t\tenvMap: { value: null },\n\t\t\tflipEnvMap: { value: - 1 },\n\t\t\tbackgroundBlurriness: { value: 0 },\n\t\t\tbackgroundIntensity: { value: 1 }\n\t\t},\n\n\t\tvertexShader: ShaderChunk.backgroundCube_vert,\n\t\tfragmentShader: ShaderChunk.backgroundCube_frag\n\n\t},\n\n\tcube: {\n\n\t\tuniforms: {\n\t\t\ttCube: { value: null },\n\t\t\ttFlip: { value: - 1 },\n\t\t\topacity: { value: 1.0 }\n\t\t},\n\n\t\tvertexShader: ShaderChunk.cube_vert,\n\t\tfragmentShader: ShaderChunk.cube_frag\n\n\t},\n\n\tequirect: {\n\n\t\tuniforms: {\n\t\t\ttEquirect: { value: null },\n\t\t},\n\n\t\tvertexShader: ShaderChunk.equirect_vert,\n\t\tfragmentShader: ShaderChunk.equirect_frag\n\n\t},\n\n\tdistanceRGBA: {\n\n\t\tuniforms: /*@__PURE__*/ mergeUniforms( [\n\t\t\tUniformsLib.common,\n\t\t\tUniformsLib.displacementmap,\n\t\t\t{\n\t\t\t\treferencePosition: { value: /*@__PURE__*/ new Vector3() },\n\t\t\t\tnearDistance: { value: 1 },\n\t\t\t\tfarDistance: { value: 1000 }\n\t\t\t}\n\t\t] ),\n\n\t\tvertexShader: ShaderChunk.distanceRGBA_vert,\n\t\tfragmentShader: ShaderChunk.distanceRGBA_frag\n\n\t},\n\n\tshadow: {\n\n\t\tuniforms: /*@__PURE__*/ mergeUniforms( [\n\t\t\tUniformsLib.lights,\n\t\t\tUniformsLib.fog,\n\t\t\t{\n\t\t\t\tcolor: { value: /*@__PURE__*/ new Color( 0x00000 ) },\n\t\t\t\topacity: { value: 1.0 }\n\t\t\t},\n\t\t] ),\n\n\t\tvertexShader: ShaderChunk.shadow_vert,\n\t\tfragmentShader: ShaderChunk.shadow_frag\n\n\t}\n\n};\n\nShaderLib.physical = {\n\n\tuniforms: /*@__PURE__*/ mergeUniforms( [\n\t\tShaderLib.standard.uniforms,\n\t\t{\n\t\t\tclearcoat: { value: 0 },\n\t\t\tclearcoatMap: { value: null },\n\t\t\tclearcoatRoughness: { value: 0 },\n\t\t\tclearcoatRoughnessMap: { value: null },\n\t\t\tclearcoatNormalScale: { value: /*@__PURE__*/ new Vector2( 1, 1 ) },\n\t\t\tclearcoatNormalMap: { value: null },\n\t\t\tiridescence: { value: 0 },\n\t\t\tiridescenceMap: { value: null },\n\t\t\tiridescenceIOR: { value: 1.3 },\n\t\t\tiridescenceThicknessMinimum: { value: 100 },\n\t\t\tiridescenceThicknessMaximum: { value: 400 },\n\t\t\tiridescenceThicknessMap: { value: null },\n\t\t\tsheen: { value: 0 },\n\t\t\tsheenColor: { value: /*@__PURE__*/ new Color( 0x000000 ) },\n\t\t\tsheenColorMap: { value: null },\n\t\t\tsheenRoughness: { value: 1 },\n\t\t\tsheenRoughnessMap: { value: null },\n\t\t\ttransmission: { value: 0 },\n\t\t\ttransmissionMap: { value: null },\n\t\t\ttransmissionSamplerSize: { value: /*@__PURE__*/ new Vector2() },\n\t\t\ttransmissionSamplerMap: { value: null },\n\t\t\tthickness: { value: 0 },\n\t\t\tthicknessMap: { value: null },\n\t\t\tattenuationDistance: { value: 0 },\n\t\t\tattenuationColor: { value: /*@__PURE__*/ new Color( 0x000000 ) },\n\t\t\tspecularIntensity: { value: 1 },\n\t\t\tspecularIntensityMap: { value: null },\n\t\t\tspecularColor: { value: /*@__PURE__*/ new Color( 1, 1, 1 ) },\n\t\t\tspecularColorMap: { value: null },\n\t\t}\n\t] ),\n\n\tvertexShader: ShaderChunk.meshphysical_vert,\n\tfragmentShader: ShaderChunk.meshphysical_frag\n\n};\n\nconst _rgb = { r: 0, b: 0, g: 0 };\n\nfunction WebGLBackground( renderer, cubemaps, cubeuvmaps, state, objects, alpha, premultipliedAlpha ) {\n\n\tconst clearColor = new Color( 0x000000 );\n\tlet clearAlpha = alpha === true ? 0 : 1;\n\n\tlet planeMesh;\n\tlet boxMesh;\n\n\tlet currentBackground = null;\n\tlet currentBackgroundVersion = 0;\n\tlet currentTonemapping = null;\n\n\tfunction render( renderList, scene ) {\n\n\t\tlet forceClear = false;\n\t\tlet background = scene.isScene === true ? scene.background : null;\n\n\t\tif ( background && background.isTexture ) {\n\n\t\t\tconst usePMREM = scene.backgroundBlurriness > 0; // use PMREM if the user wants to blur the background\n\t\t\tbackground = ( usePMREM ? cubeuvmaps : cubemaps ).get( background );\n\n\t\t}\n\n\t\t// Ignore background in AR\n\t\t// TODO: Reconsider this.\n\n\t\tconst xr = renderer.xr;\n\t\tconst session = xr.getSession && xr.getSession();\n\n\t\tif ( session && session.environmentBlendMode === 'additive' ) {\n\n\t\t\tbackground = null;\n\n\t\t}\n\n\t\tif ( background === null ) {\n\n\t\t\tsetClear( clearColor, clearAlpha );\n\n\t\t} else if ( background && background.isColor ) {\n\n\t\t\tsetClear( background, 1 );\n\t\t\tforceClear = true;\n\n\t\t}\n\n\t\tif ( renderer.autoClear || forceClear ) {\n\n\t\t\trenderer.clear( renderer.autoClearColor, renderer.autoClearDepth, renderer.autoClearStencil );\n\n\t\t}\n\n\t\tif ( background && ( background.isCubeTexture || background.mapping === CubeUVReflectionMapping ) ) {\n\n\t\t\tif ( boxMesh === undefined ) {\n\n\t\t\t\tboxMesh = new Mesh(\n\t\t\t\t\tnew BoxGeometry( 1, 1, 1 ),\n\t\t\t\t\tnew ShaderMaterial( {\n\t\t\t\t\t\tname: 'BackgroundCubeMaterial',\n\t\t\t\t\t\tuniforms: cloneUniforms( ShaderLib.backgroundCube.uniforms ),\n\t\t\t\t\t\tvertexShader: ShaderLib.backgroundCube.vertexShader,\n\t\t\t\t\t\tfragmentShader: ShaderLib.backgroundCube.fragmentShader,\n\t\t\t\t\t\tside: BackSide,\n\t\t\t\t\t\tdepthTest: false,\n\t\t\t\t\t\tdepthWrite: false,\n\t\t\t\t\t\tfog: false\n\t\t\t\t\t} )\n\t\t\t\t);\n\n\t\t\t\tboxMesh.geometry.deleteAttribute( 'normal' );\n\t\t\t\tboxMesh.geometry.deleteAttribute( 'uv' );\n\n\t\t\t\tboxMesh.onBeforeRender = function ( renderer, scene, camera ) {\n\n\t\t\t\t\tthis.matrixWorld.copyPosition( camera.matrixWorld );\n\n\t\t\t\t};\n\n\t\t\t\t// add \"envMap\" material property so the renderer can evaluate it like for built-in materials\n\t\t\t\tObject.defineProperty( boxMesh.material, 'envMap', {\n\n\t\t\t\t\tget: function () {\n\n\t\t\t\t\t\treturn this.uniforms.envMap.value;\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t\tobjects.update( boxMesh );\n\n\t\t\t}\n\n\t\t\tboxMesh.material.uniforms.envMap.value = background;\n\t\t\tboxMesh.material.uniforms.flipEnvMap.value = ( background.isCubeTexture && background.isRenderTargetTexture === false ) ? - 1 : 1;\n\t\t\tboxMesh.material.uniforms.backgroundBlurriness.value = scene.backgroundBlurriness;\n\t\t\tboxMesh.material.uniforms.backgroundIntensity.value = scene.backgroundIntensity;\n\t\t\tboxMesh.material.toneMapped = ( background.encoding === sRGBEncoding ) ? false : true;\n\n\t\t\tif ( currentBackground !== background ||\n\t\t\t\tcurrentBackgroundVersion !== background.version ||\n\t\t\t\tcurrentTonemapping !== renderer.toneMapping ) {\n\n\t\t\t\tboxMesh.material.needsUpdate = true;\n\n\t\t\t\tcurrentBackground = background;\n\t\t\t\tcurrentBackgroundVersion = background.version;\n\t\t\t\tcurrentTonemapping = renderer.toneMapping;\n\n\t\t\t}\n\n\t\t\tboxMesh.layers.enableAll();\n\n\t\t\t// push to the pre-sorted opaque render list\n\t\t\trenderList.unshift( boxMesh, boxMesh.geometry, boxMesh.material, 0, 0, null );\n\n\t\t} else if ( background && background.isTexture ) {\n\n\t\t\tif ( planeMesh === undefined ) {\n\n\t\t\t\tplaneMesh = new Mesh(\n\t\t\t\t\tnew PlaneGeometry( 2, 2 ),\n\t\t\t\t\tnew ShaderMaterial( {\n\t\t\t\t\t\tname: 'BackgroundMaterial',\n\t\t\t\t\t\tuniforms: cloneUniforms( ShaderLib.background.uniforms ),\n\t\t\t\t\t\tvertexShader: ShaderLib.background.vertexShader,\n\t\t\t\t\t\tfragmentShader: ShaderLib.background.fragmentShader,\n\t\t\t\t\t\tside: FrontSide,\n\t\t\t\t\t\tdepthTest: false,\n\t\t\t\t\t\tdepthWrite: false,\n\t\t\t\t\t\tfog: false\n\t\t\t\t\t} )\n\t\t\t\t);\n\n\t\t\t\tplaneMesh.geometry.deleteAttribute( 'normal' );\n\n\t\t\t\t// add \"map\" material property so the renderer can evaluate it like for built-in materials\n\t\t\t\tObject.defineProperty( planeMesh.material, 'map', {\n\n\t\t\t\t\tget: function () {\n\n\t\t\t\t\t\treturn this.uniforms.t2D.value;\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t\tobjects.update( planeMesh );\n\n\t\t\t}\n\n\t\t\tplaneMesh.material.uniforms.t2D.value = background;\n\t\t\tplaneMesh.material.uniforms.backgroundIntensity.value = scene.backgroundIntensity;\n\t\t\tplaneMesh.material.toneMapped = ( background.encoding === sRGBEncoding ) ? false : true;\n\n\t\t\tif ( background.matrixAutoUpdate === true ) {\n\n\t\t\t\tbackground.updateMatrix();\n\n\t\t\t}\n\n\t\t\tplaneMesh.material.uniforms.uvTransform.value.copy( background.matrix );\n\n\t\t\tif ( currentBackground !== background ||\n\t\t\t\tcurrentBackgroundVersion !== background.version ||\n\t\t\t\tcurrentTonemapping !== renderer.toneMapping ) {\n\n\t\t\t\tplaneMesh.material.needsUpdate = true;\n\n\t\t\t\tcurrentBackground = background;\n\t\t\t\tcurrentBackgroundVersion = background.version;\n\t\t\t\tcurrentTonemapping = renderer.toneMapping;\n\n\t\t\t}\n\n\t\t\tplaneMesh.layers.enableAll();\n\n\t\t\t// push to the pre-sorted opaque render list\n\t\t\trenderList.unshift( planeMesh, planeMesh.geometry, planeMesh.material, 0, 0, null );\n\n\t\t}\n\n\t}\n\n\tfunction setClear( color, alpha ) {\n\n\t\tcolor.getRGB( _rgb, getUnlitUniformColorSpace( renderer ) );\n\n\t\tstate.buffers.color.setClear( _rgb.r, _rgb.g, _rgb.b, alpha, premultipliedAlpha );\n\n\t}\n\n\treturn {\n\n\t\tgetClearColor: function () {\n\n\t\t\treturn clearColor;\n\n\t\t},\n\t\tsetClearColor: function ( color, alpha = 1 ) {\n\n\t\t\tclearColor.set( color );\n\t\t\tclearAlpha = alpha;\n\t\t\tsetClear( clearColor, clearAlpha );\n\n\t\t},\n\t\tgetClearAlpha: function () {\n\n\t\t\treturn clearAlpha;\n\n\t\t},\n\t\tsetClearAlpha: function ( alpha ) {\n\n\t\t\tclearAlpha = alpha;\n\t\t\tsetClear( clearColor, clearAlpha );\n\n\t\t},\n\t\trender: render\n\n\t};\n\n}\n\nfunction WebGLBindingStates( gl, extensions, attributes, capabilities ) {\n\n\tconst maxVertexAttributes = gl.getParameter( 34921 );\n\n\tconst extension = capabilities.isWebGL2 ? null : extensions.get( 'OES_vertex_array_object' );\n\tconst vaoAvailable = capabilities.isWebGL2 || extension !== null;\n\n\tconst bindingStates = {};\n\n\tconst defaultState = createBindingState( null );\n\tlet currentState = defaultState;\n\tlet forceUpdate = false;\n\n\tfunction setup( object, material, program, geometry, index ) {\n\n\t\tlet updateBuffers = false;\n\n\t\tif ( vaoAvailable ) {\n\n\t\t\tconst state = getBindingState( geometry, program, material );\n\n\t\t\tif ( currentState !== state ) {\n\n\t\t\t\tcurrentState = state;\n\t\t\t\tbindVertexArrayObject( currentState.object );\n\n\t\t\t}\n\n\t\t\tupdateBuffers = needsUpdate( object, geometry, program, index );\n\n\t\t\tif ( updateBuffers ) saveCache( object, geometry, program, index );\n\n\t\t} else {\n\n\t\t\tconst wireframe = ( material.wireframe === true );\n\n\t\t\tif ( currentState.geometry !== geometry.id ||\n\t\t\t\tcurrentState.program !== program.id ||\n\t\t\t\tcurrentState.wireframe !== wireframe ) {\n\n\t\t\t\tcurrentState.geometry = geometry.id;\n\t\t\t\tcurrentState.program = program.id;\n\t\t\t\tcurrentState.wireframe = wireframe;\n\n\t\t\t\tupdateBuffers = true;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( index !== null ) {\n\n\t\t\tattributes.update( index, 34963 );\n\n\t\t}\n\n\t\tif ( updateBuffers || forceUpdate ) {\n\n\t\t\tforceUpdate = false;\n\n\t\t\tsetupVertexAttributes( object, material, program, geometry );\n\n\t\t\tif ( index !== null ) {\n\n\t\t\t\tgl.bindBuffer( 34963, attributes.get( index ).buffer );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tfunction createVertexArrayObject() {\n\n\t\tif ( capabilities.isWebGL2 ) return gl.createVertexArray();\n\n\t\treturn extension.createVertexArrayOES();\n\n\t}\n\n\tfunction bindVertexArrayObject( vao ) {\n\n\t\tif ( capabilities.isWebGL2 ) return gl.bindVertexArray( vao );\n\n\t\treturn extension.bindVertexArrayOES( vao );\n\n\t}\n\n\tfunction deleteVertexArrayObject( vao ) {\n\n\t\tif ( capabilities.isWebGL2 ) return gl.deleteVertexArray( vao );\n\n\t\treturn extension.deleteVertexArrayOES( vao );\n\n\t}\n\n\tfunction getBindingState( geometry, program, material ) {\n\n\t\tconst wireframe = ( material.wireframe === true );\n\n\t\tlet programMap = bindingStates[ geometry.id ];\n\n\t\tif ( programMap === undefined ) {\n\n\t\t\tprogramMap = {};\n\t\t\tbindingStates[ geometry.id ] = programMap;\n\n\t\t}\n\n\t\tlet stateMap = programMap[ program.id ];\n\n\t\tif ( stateMap === undefined ) {\n\n\t\t\tstateMap = {};\n\t\t\tprogramMap[ program.id ] = stateMap;\n\n\t\t}\n\n\t\tlet state = stateMap[ wireframe ];\n\n\t\tif ( state === undefined ) {\n\n\t\t\tstate = createBindingState( createVertexArrayObject() );\n\t\t\tstateMap[ wireframe ] = state;\n\n\t\t}\n\n\t\treturn state;\n\n\t}\n\n\tfunction createBindingState( vao ) {\n\n\t\tconst newAttributes = [];\n\t\tconst enabledAttributes = [];\n\t\tconst attributeDivisors = [];\n\n\t\tfor ( let i = 0; i < maxVertexAttributes; i ++ ) {\n\n\t\t\tnewAttributes[ i ] = 0;\n\t\t\tenabledAttributes[ i ] = 0;\n\t\t\tattributeDivisors[ i ] = 0;\n\n\t\t}\n\n\t\treturn {\n\n\t\t\t// for backward compatibility on non-VAO support browser\n\t\t\tgeometry: null,\n\t\t\tprogram: null,\n\t\t\twireframe: false,\n\n\t\t\tnewAttributes: newAttributes,\n\t\t\tenabledAttributes: enabledAttributes,\n\t\t\tattributeDivisors: attributeDivisors,\n\t\t\tobject: vao,\n\t\t\tattributes: {},\n\t\t\tindex: null\n\n\t\t};\n\n\t}\n\n\tfunction needsUpdate( object, geometry, program, index ) {\n\n\t\tconst cachedAttributes = currentState.attributes;\n\t\tconst geometryAttributes = geometry.attributes;\n\n\t\tlet attributesNum = 0;\n\n\t\tconst programAttributes = program.getAttributes();\n\n\t\tfor ( const name in programAttributes ) {\n\n\t\t\tconst programAttribute = programAttributes[ name ];\n\n\t\t\tif ( programAttribute.location >= 0 ) {\n\n\t\t\t\tconst cachedAttribute = cachedAttributes[ name ];\n\t\t\t\tlet geometryAttribute = geometryAttributes[ name ];\n\n\t\t\t\tif ( geometryAttribute === undefined ) {\n\n\t\t\t\t\tif ( name === 'instanceMatrix' && object.instanceMatrix ) geometryAttribute = object.instanceMatrix;\n\t\t\t\t\tif ( name === 'instanceColor' && object.instanceColor ) geometryAttribute = object.instanceColor;\n\n\t\t\t\t}\n\n\t\t\t\tif ( cachedAttribute === undefined ) return true;\n\n\t\t\t\tif ( cachedAttribute.attribute !== geometryAttribute ) return true;\n\n\t\t\t\tif ( geometryAttribute && cachedAttribute.data !== geometryAttribute.data ) return true;\n\n\t\t\t\tattributesNum ++;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( currentState.attributesNum !== attributesNum ) return true;\n\n\t\tif ( currentState.index !== index ) return true;\n\n\t\treturn false;\n\n\t}\n\n\tfunction saveCache( object, geometry, program, index ) {\n\n\t\tconst cache = {};\n\t\tconst attributes = geometry.attributes;\n\t\tlet attributesNum = 0;\n\n\t\tconst programAttributes = program.getAttributes();\n\n\t\tfor ( const name in programAttributes ) {\n\n\t\t\tconst programAttribute = programAttributes[ name ];\n\n\t\t\tif ( programAttribute.location >= 0 ) {\n\n\t\t\t\tlet attribute = attributes[ name ];\n\n\t\t\t\tif ( attribute === undefined ) {\n\n\t\t\t\t\tif ( name === 'instanceMatrix' && object.instanceMatrix ) attribute = object.instanceMatrix;\n\t\t\t\t\tif ( name === 'instanceColor' && object.instanceColor ) attribute = object.instanceColor;\n\n\t\t\t\t}\n\n\t\t\t\tconst data = {};\n\t\t\t\tdata.attribute = attribute;\n\n\t\t\t\tif ( attribute && attribute.data ) {\n\n\t\t\t\t\tdata.data = attribute.data;\n\n\t\t\t\t}\n\n\t\t\t\tcache[ name ] = data;\n\n\t\t\t\tattributesNum ++;\n\n\t\t\t}\n\n\t\t}\n\n\t\tcurrentState.attributes = cache;\n\t\tcurrentState.attributesNum = attributesNum;\n\n\t\tcurrentState.index = index;\n\n\t}\n\n\tfunction initAttributes() {\n\n\t\tconst newAttributes = currentState.newAttributes;\n\n\t\tfor ( let i = 0, il = newAttributes.length; i < il; i ++ ) {\n\n\t\t\tnewAttributes[ i ] = 0;\n\n\t\t}\n\n\t}\n\n\tfunction enableAttribute( attribute ) {\n\n\t\tenableAttributeAndDivisor( attribute, 0 );\n\n\t}\n\n\tfunction enableAttributeAndDivisor( attribute, meshPerAttribute ) {\n\n\t\tconst newAttributes = currentState.newAttributes;\n\t\tconst enabledAttributes = currentState.enabledAttributes;\n\t\tconst attributeDivisors = currentState.attributeDivisors;\n\n\t\tnewAttributes[ attribute ] = 1;\n\n\t\tif ( enabledAttributes[ attribute ] === 0 ) {\n\n\t\t\tgl.enableVertexAttribArray( attribute );\n\t\t\tenabledAttributes[ attribute ] = 1;\n\n\t\t}\n\n\t\tif ( attributeDivisors[ attribute ] !== meshPerAttribute ) {\n\n\t\t\tconst extension = capabilities.isWebGL2 ? gl : extensions.get( 'ANGLE_instanced_arrays' );\n\n\t\t\textension[ capabilities.isWebGL2 ? 'vertexAttribDivisor' : 'vertexAttribDivisorANGLE' ]( attribute, meshPerAttribute );\n\t\t\tattributeDivisors[ attribute ] = meshPerAttribute;\n\n\t\t}\n\n\t}\n\n\tfunction disableUnusedAttributes() {\n\n\t\tconst newAttributes = currentState.newAttributes;\n\t\tconst enabledAttributes = currentState.enabledAttributes;\n\n\t\tfor ( let i = 0, il = enabledAttributes.length; i < il; i ++ ) {\n\n\t\t\tif ( enabledAttributes[ i ] !== newAttributes[ i ] ) {\n\n\t\t\t\tgl.disableVertexAttribArray( i );\n\t\t\t\tenabledAttributes[ i ] = 0;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tfunction vertexAttribPointer( index, size, type, normalized, stride, offset ) {\n\n\t\tif ( capabilities.isWebGL2 === true && ( type === 5124 || type === 5125 ) ) {\n\n\t\t\tgl.vertexAttribIPointer( index, size, type, stride, offset );\n\n\t\t} else {\n\n\t\t\tgl.vertexAttribPointer( index, size, type, normalized, stride, offset );\n\n\t\t}\n\n\t}\n\n\tfunction setupVertexAttributes( object, material, program, geometry ) {\n\n\t\tif ( capabilities.isWebGL2 === false && ( object.isInstancedMesh || geometry.isInstancedBufferGeometry ) ) {\n\n\t\t\tif ( extensions.get( 'ANGLE_instanced_arrays' ) === null ) return;\n\n\t\t}\n\n\t\tinitAttributes();\n\n\t\tconst geometryAttributes = geometry.attributes;\n\n\t\tconst programAttributes = program.getAttributes();\n\n\t\tconst materialDefaultAttributeValues = material.defaultAttributeValues;\n\n\t\tfor ( const name in programAttributes ) {\n\n\t\t\tconst programAttribute = programAttributes[ name ];\n\n\t\t\tif ( programAttribute.location >= 0 ) {\n\n\t\t\t\tlet geometryAttribute = geometryAttributes[ name ];\n\n\t\t\t\tif ( geometryAttribute === undefined ) {\n\n\t\t\t\t\tif ( name === 'instanceMatrix' && object.instanceMatrix ) geometryAttribute = object.instanceMatrix;\n\t\t\t\t\tif ( name === 'instanceColor' && object.instanceColor ) geometryAttribute = object.instanceColor;\n\n\t\t\t\t}\n\n\t\t\t\tif ( geometryAttribute !== undefined ) {\n\n\t\t\t\t\tconst normalized = geometryAttribute.normalized;\n\t\t\t\t\tconst size = geometryAttribute.itemSize;\n\n\t\t\t\t\tconst attribute = attributes.get( geometryAttribute );\n\n\t\t\t\t\t// TODO Attribute may not be available on context restore\n\n\t\t\t\t\tif ( attribute === undefined ) continue;\n\n\t\t\t\t\tconst buffer = attribute.buffer;\n\t\t\t\t\tconst type = attribute.type;\n\t\t\t\t\tconst bytesPerElement = attribute.bytesPerElement;\n\n\t\t\t\t\tif ( geometryAttribute.isInterleavedBufferAttribute ) {\n\n\t\t\t\t\t\tconst data = geometryAttribute.data;\n\t\t\t\t\t\tconst stride = data.stride;\n\t\t\t\t\t\tconst offset = geometryAttribute.offset;\n\n\t\t\t\t\t\tif ( data.isInstancedInterleavedBuffer ) {\n\n\t\t\t\t\t\t\tfor ( let i = 0; i < programAttribute.locationSize; i ++ ) {\n\n\t\t\t\t\t\t\t\tenableAttributeAndDivisor( programAttribute.location + i, data.meshPerAttribute );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif ( object.isInstancedMesh !== true && geometry._maxInstanceCount === undefined ) {\n\n\t\t\t\t\t\t\t\tgeometry._maxInstanceCount = data.meshPerAttribute * data.count;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tfor ( let i = 0; i < programAttribute.locationSize; i ++ ) {\n\n\t\t\t\t\t\t\t\tenableAttribute( programAttribute.location + i );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tgl.bindBuffer( 34962, buffer );\n\n\t\t\t\t\t\tfor ( let i = 0; i < programAttribute.locationSize; i ++ ) {\n\n\t\t\t\t\t\t\tvertexAttribPointer(\n\t\t\t\t\t\t\t\tprogramAttribute.location + i,\n\t\t\t\t\t\t\t\tsize / programAttribute.locationSize,\n\t\t\t\t\t\t\t\ttype,\n\t\t\t\t\t\t\t\tnormalized,\n\t\t\t\t\t\t\t\tstride * bytesPerElement,\n\t\t\t\t\t\t\t\t( offset + ( size / programAttribute.locationSize ) * i ) * bytesPerElement\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tif ( geometryAttribute.isInstancedBufferAttribute ) {\n\n\t\t\t\t\t\t\tfor ( let i = 0; i < programAttribute.locationSize; i ++ ) {\n\n\t\t\t\t\t\t\t\tenableAttributeAndDivisor( programAttribute.location + i, geometryAttribute.meshPerAttribute );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif ( object.isInstancedMesh !== true && geometry._maxInstanceCount === undefined ) {\n\n\t\t\t\t\t\t\t\tgeometry._maxInstanceCount = geometryAttribute.meshPerAttribute * geometryAttribute.count;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tfor ( let i = 0; i < programAttribute.locationSize; i ++ ) {\n\n\t\t\t\t\t\t\t\tenableAttribute( programAttribute.location + i );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tgl.bindBuffer( 34962, buffer );\n\n\t\t\t\t\t\tfor ( let i = 0; i < programAttribute.locationSize; i ++ ) {\n\n\t\t\t\t\t\t\tvertexAttribPointer(\n\t\t\t\t\t\t\t\tprogramAttribute.location + i,\n\t\t\t\t\t\t\t\tsize / programAttribute.locationSize,\n\t\t\t\t\t\t\t\ttype,\n\t\t\t\t\t\t\t\tnormalized,\n\t\t\t\t\t\t\t\tsize * bytesPerElement,\n\t\t\t\t\t\t\t\t( size / programAttribute.locationSize ) * i * bytesPerElement\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( materialDefaultAttributeValues !== undefined ) {\n\n\t\t\t\t\tconst value = materialDefaultAttributeValues[ name ];\n\n\t\t\t\t\tif ( value !== undefined ) {\n\n\t\t\t\t\t\tswitch ( value.length ) {\n\n\t\t\t\t\t\t\tcase 2:\n\t\t\t\t\t\t\t\tgl.vertexAttrib2fv( programAttribute.location, value );\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase 3:\n\t\t\t\t\t\t\t\tgl.vertexAttrib3fv( programAttribute.location, value );\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase 4:\n\t\t\t\t\t\t\t\tgl.vertexAttrib4fv( programAttribute.location, value );\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tgl.vertexAttrib1fv( programAttribute.location, value );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tdisableUnusedAttributes();\n\n\t}\n\n\tfunction dispose() {\n\n\t\treset();\n\n\t\tfor ( const geometryId in bindingStates ) {\n\n\t\t\tconst programMap = bindingStates[ geometryId ];\n\n\t\t\tfor ( const programId in programMap ) {\n\n\t\t\t\tconst stateMap = programMap[ programId ];\n\n\t\t\t\tfor ( const wireframe in stateMap ) {\n\n\t\t\t\t\tdeleteVertexArrayObject( stateMap[ wireframe ].object );\n\n\t\t\t\t\tdelete stateMap[ wireframe ];\n\n\t\t\t\t}\n\n\t\t\t\tdelete programMap[ programId ];\n\n\t\t\t}\n\n\t\t\tdelete bindingStates[ geometryId ];\n\n\t\t}\n\n\t}\n\n\tfunction releaseStatesOfGeometry( geometry ) {\n\n\t\tif ( bindingStates[ geometry.id ] === undefined ) return;\n\n\t\tconst programMap = bindingStates[ geometry.id ];\n\n\t\tfor ( const programId in programMap ) {\n\n\t\t\tconst stateMap = programMap[ programId ];\n\n\t\t\tfor ( const wireframe in stateMap ) {\n\n\t\t\t\tdeleteVertexArrayObject( stateMap[ wireframe ].object );\n\n\t\t\t\tdelete stateMap[ wireframe ];\n\n\t\t\t}\n\n\t\t\tdelete programMap[ programId ];\n\n\t\t}\n\n\t\tdelete bindingStates[ geometry.id ];\n\n\t}\n\n\tfunction releaseStatesOfProgram( program ) {\n\n\t\tfor ( const geometryId in bindingStates ) {\n\n\t\t\tconst programMap = bindingStates[ geometryId ];\n\n\t\t\tif ( programMap[ program.id ] === undefined ) continue;\n\n\t\t\tconst stateMap = programMap[ program.id ];\n\n\t\t\tfor ( const wireframe in stateMap ) {\n\n\t\t\t\tdeleteVertexArrayObject( stateMap[ wireframe ].object );\n\n\t\t\t\tdelete stateMap[ wireframe ];\n\n\t\t\t}\n\n\t\t\tdelete programMap[ program.id ];\n\n\t\t}\n\n\t}\n\n\tfunction reset() {\n\n\t\tresetDefaultState();\n\t\tforceUpdate = true;\n\n\t\tif ( currentState === defaultState ) return;\n\n\t\tcurrentState = defaultState;\n\t\tbindVertexArrayObject( currentState.object );\n\n\t}\n\n\t// for backward-compatibility\n\n\tfunction resetDefaultState() {\n\n\t\tdefaultState.geometry = null;\n\t\tdefaultState.program = null;\n\t\tdefaultState.wireframe = false;\n\n\t}\n\n\treturn {\n\n\t\tsetup: setup,\n\t\treset: reset,\n\t\tresetDefaultState: resetDefaultState,\n\t\tdispose: dispose,\n\t\treleaseStatesOfGeometry: releaseStatesOfGeometry,\n\t\treleaseStatesOfProgram: releaseStatesOfProgram,\n\n\t\tinitAttributes: initAttributes,\n\t\tenableAttribute: enableAttribute,\n\t\tdisableUnusedAttributes: disableUnusedAttributes\n\n\t};\n\n}\n\nfunction WebGLBufferRenderer( gl, extensions, info, capabilities ) {\n\n\tconst isWebGL2 = capabilities.isWebGL2;\n\n\tlet mode;\n\n\tfunction setMode( value ) {\n\n\t\tmode = value;\n\n\t}\n\n\tfunction render( start, count ) {\n\n\t\tgl.drawArrays( mode, start, count );\n\n\t\tinfo.update( count, mode, 1 );\n\n\t}\n\n\tfunction renderInstances( start, count, primcount ) {\n\n\t\tif ( primcount === 0 ) return;\n\n\t\tlet extension, methodName;\n\n\t\tif ( isWebGL2 ) {\n\n\t\t\textension = gl;\n\t\t\tmethodName = 'drawArraysInstanced';\n\n\t\t} else {\n\n\t\t\textension = extensions.get( 'ANGLE_instanced_arrays' );\n\t\t\tmethodName = 'drawArraysInstancedANGLE';\n\n\t\t\tif ( extension === null ) {\n\n\t\t\t\tconsole.error( 'THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.' );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t}\n\n\t\textension[ methodName ]( mode, start, count, primcount );\n\n\t\tinfo.update( count, mode, primcount );\n\n\t}\n\n\t//\n\n\tthis.setMode = setMode;\n\tthis.render = render;\n\tthis.renderInstances = renderInstances;\n\n}\n\nfunction WebGLCapabilities( gl, extensions, parameters ) {\n\n\tlet maxAnisotropy;\n\n\tfunction getMaxAnisotropy() {\n\n\t\tif ( maxAnisotropy !== undefined ) return maxAnisotropy;\n\n\t\tif ( extensions.has( 'EXT_texture_filter_anisotropic' ) === true ) {\n\n\t\t\tconst extension = extensions.get( 'EXT_texture_filter_anisotropic' );\n\n\t\t\tmaxAnisotropy = gl.getParameter( extension.MAX_TEXTURE_MAX_ANISOTROPY_EXT );\n\n\t\t} else {\n\n\t\t\tmaxAnisotropy = 0;\n\n\t\t}\n\n\t\treturn maxAnisotropy;\n\n\t}\n\n\tfunction getMaxPrecision( precision ) {\n\n\t\tif ( precision === 'highp' ) {\n\n\t\t\tif ( gl.getShaderPrecisionFormat( 35633, 36338 ).precision > 0 &&\n\t\t\t\tgl.getShaderPrecisionFormat( 35632, 36338 ).precision > 0 ) {\n\n\t\t\t\treturn 'highp';\n\n\t\t\t}\n\n\t\t\tprecision = 'mediump';\n\n\t\t}\n\n\t\tif ( precision === 'mediump' ) {\n\n\t\t\tif ( gl.getShaderPrecisionFormat( 35633, 36337 ).precision > 0 &&\n\t\t\t\tgl.getShaderPrecisionFormat( 35632, 36337 ).precision > 0 ) {\n\n\t\t\t\treturn 'mediump';\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn 'lowp';\n\n\t}\n\n\tconst isWebGL2 = ( typeof WebGL2RenderingContext !== 'undefined' && gl instanceof WebGL2RenderingContext ) ||\n\t\t( typeof WebGL2ComputeRenderingContext !== 'undefined' && gl instanceof WebGL2ComputeRenderingContext );\n\n\tlet precision = parameters.precision !== undefined ? parameters.precision : 'highp';\n\tconst maxPrecision = getMaxPrecision( precision );\n\n\tif ( maxPrecision !== precision ) {\n\n\t\tconsole.warn( 'THREE.WebGLRenderer:', precision, 'not supported, using', maxPrecision, 'instead.' );\n\t\tprecision = maxPrecision;\n\n\t}\n\n\tconst drawBuffers = isWebGL2 || extensions.has( 'WEBGL_draw_buffers' );\n\n\tconst logarithmicDepthBuffer = parameters.logarithmicDepthBuffer === true;\n\n\tconst maxTextures = gl.getParameter( 34930 );\n\tconst maxVertexTextures = gl.getParameter( 35660 );\n\tconst maxTextureSize = gl.getParameter( 3379 );\n\tconst maxCubemapSize = gl.getParameter( 34076 );\n\n\tconst maxAttributes = gl.getParameter( 34921 );\n\tconst maxVertexUniforms = gl.getParameter( 36347 );\n\tconst maxVaryings = gl.getParameter( 36348 );\n\tconst maxFragmentUniforms = gl.getParameter( 36349 );\n\n\tconst vertexTextures = maxVertexTextures > 0;\n\tconst floatFragmentTextures = isWebGL2 || extensions.has( 'OES_texture_float' );\n\tconst floatVertexTextures = vertexTextures && floatFragmentTextures;\n\n\tconst maxSamples = isWebGL2 ? gl.getParameter( 36183 ) : 0;\n\n\treturn {\n\n\t\tisWebGL2: isWebGL2,\n\n\t\tdrawBuffers: drawBuffers,\n\n\t\tgetMaxAnisotropy: getMaxAnisotropy,\n\t\tgetMaxPrecision: getMaxPrecision,\n\n\t\tprecision: precision,\n\t\tlogarithmicDepthBuffer: logarithmicDepthBuffer,\n\n\t\tmaxTextures: maxTextures,\n\t\tmaxVertexTextures: maxVertexTextures,\n\t\tmaxTextureSize: maxTextureSize,\n\t\tmaxCubemapSize: maxCubemapSize,\n\n\t\tmaxAttributes: maxAttributes,\n\t\tmaxVertexUniforms: maxVertexUniforms,\n\t\tmaxVaryings: maxVaryings,\n\t\tmaxFragmentUniforms: maxFragmentUniforms,\n\n\t\tvertexTextures: vertexTextures,\n\t\tfloatFragmentTextures: floatFragmentTextures,\n\t\tfloatVertexTextures: floatVertexTextures,\n\n\t\tmaxSamples: maxSamples\n\n\t};\n\n}\n\nfunction WebGLClipping( properties ) {\n\n\tconst scope = this;\n\n\tlet globalState = null,\n\t\tnumGlobalPlanes = 0,\n\t\tlocalClippingEnabled = false,\n\t\trenderingShadows = false;\n\n\tconst plane = new Plane(),\n\t\tviewNormalMatrix = new Matrix3(),\n\n\t\tuniform = { value: null, needsUpdate: false };\n\n\tthis.uniform = uniform;\n\tthis.numPlanes = 0;\n\tthis.numIntersection = 0;\n\n\tthis.init = function ( planes, enableLocalClipping, camera ) {\n\n\t\tconst enabled =\n\t\t\tplanes.length !== 0 ||\n\t\t\tenableLocalClipping ||\n\t\t\t// enable state of previous frame - the clipping code has to\n\t\t\t// run another frame in order to reset the state:\n\t\t\tnumGlobalPlanes !== 0 ||\n\t\t\tlocalClippingEnabled;\n\n\t\tlocalClippingEnabled = enableLocalClipping;\n\n\t\tglobalState = projectPlanes( planes, camera, 0 );\n\t\tnumGlobalPlanes = planes.length;\n\n\t\treturn enabled;\n\n\t};\n\n\tthis.beginShadows = function () {\n\n\t\trenderingShadows = true;\n\t\tprojectPlanes( null );\n\n\t};\n\n\tthis.endShadows = function () {\n\n\t\trenderingShadows = false;\n\t\tresetGlobalState();\n\n\t};\n\n\tthis.setState = function ( material, camera, useCache ) {\n\n\t\tconst planes = material.clippingPlanes,\n\t\t\tclipIntersection = material.clipIntersection,\n\t\t\tclipShadows = material.clipShadows;\n\n\t\tconst materialProperties = properties.get( material );\n\n\t\tif ( ! localClippingEnabled || planes === null || planes.length === 0 || renderingShadows && ! clipShadows ) {\n\n\t\t\t// there's no local clipping\n\n\t\t\tif ( renderingShadows ) {\n\n\t\t\t\t// there's no global clipping\n\n\t\t\t\tprojectPlanes( null );\n\n\t\t\t} else {\n\n\t\t\t\tresetGlobalState();\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconst nGlobal = renderingShadows ? 0 : numGlobalPlanes,\n\t\t\t\tlGlobal = nGlobal * 4;\n\n\t\t\tlet dstArray = materialProperties.clippingState || null;\n\n\t\t\tuniform.value = dstArray; // ensure unique state\n\n\t\t\tdstArray = projectPlanes( planes, camera, lGlobal, useCache );\n\n\t\t\tfor ( let i = 0; i !== lGlobal; ++ i ) {\n\n\t\t\t\tdstArray[ i ] = globalState[ i ];\n\n\t\t\t}\n\n\t\t\tmaterialProperties.clippingState = dstArray;\n\t\t\tthis.numIntersection = clipIntersection ? this.numPlanes : 0;\n\t\t\tthis.numPlanes += nGlobal;\n\n\t\t}\n\n\n\t};\n\n\tfunction resetGlobalState() {\n\n\t\tif ( uniform.value !== globalState ) {\n\n\t\t\tuniform.value = globalState;\n\t\t\tuniform.needsUpdate = numGlobalPlanes > 0;\n\n\t\t}\n\n\t\tscope.numPlanes = numGlobalPlanes;\n\t\tscope.numIntersection = 0;\n\n\t}\n\n\tfunction projectPlanes( planes, camera, dstOffset, skipTransform ) {\n\n\t\tconst nPlanes = planes !== null ? planes.length : 0;\n\t\tlet dstArray = null;\n\n\t\tif ( nPlanes !== 0 ) {\n\n\t\t\tdstArray = uniform.value;\n\n\t\t\tif ( skipTransform !== true || dstArray === null ) {\n\n\t\t\t\tconst flatSize = dstOffset + nPlanes * 4,\n\t\t\t\t\tviewMatrix = camera.matrixWorldInverse;\n\n\t\t\t\tviewNormalMatrix.getNormalMatrix( viewMatrix );\n\n\t\t\t\tif ( dstArray === null || dstArray.length < flatSize ) {\n\n\t\t\t\t\tdstArray = new Float32Array( flatSize );\n\n\t\t\t\t}\n\n\t\t\t\tfor ( let i = 0, i4 = dstOffset; i !== nPlanes; ++ i, i4 += 4 ) {\n\n\t\t\t\t\tplane.copy( planes[ i ] ).applyMatrix4( viewMatrix, viewNormalMatrix );\n\n\t\t\t\t\tplane.normal.toArray( dstArray, i4 );\n\t\t\t\t\tdstArray[ i4 + 3 ] = plane.constant;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tuniform.value = dstArray;\n\t\t\tuniform.needsUpdate = true;\n\n\t\t}\n\n\t\tscope.numPlanes = nPlanes;\n\t\tscope.numIntersection = 0;\n\n\t\treturn dstArray;\n\n\t}\n\n}\n\nfunction WebGLCubeMaps( renderer ) {\n\n\tlet cubemaps = new WeakMap();\n\n\tfunction mapTextureMapping( texture, mapping ) {\n\n\t\tif ( mapping === EquirectangularReflectionMapping ) {\n\n\t\t\ttexture.mapping = CubeReflectionMapping;\n\n\t\t} else if ( mapping === EquirectangularRefractionMapping ) {\n\n\t\t\ttexture.mapping = CubeRefractionMapping;\n\n\t\t}\n\n\t\treturn texture;\n\n\t}\n\n\tfunction get( texture ) {\n\n\t\tif ( texture && texture.isTexture && texture.isRenderTargetTexture === false ) {\n\n\t\t\tconst mapping = texture.mapping;\n\n\t\t\tif ( mapping === EquirectangularReflectionMapping || mapping === EquirectangularRefractionMapping ) {\n\n\t\t\t\tif ( cubemaps.has( texture ) ) {\n\n\t\t\t\t\tconst cubemap = cubemaps.get( texture ).texture;\n\t\t\t\t\treturn mapTextureMapping( cubemap, texture.mapping );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconst image = texture.image;\n\n\t\t\t\t\tif ( image && image.height > 0 ) {\n\n\t\t\t\t\t\tconst renderTarget = new WebGLCubeRenderTarget( image.height / 2 );\n\t\t\t\t\t\trenderTarget.fromEquirectangularTexture( renderer, texture );\n\t\t\t\t\t\tcubemaps.set( texture, renderTarget );\n\n\t\t\t\t\t\ttexture.addEventListener( 'dispose', onTextureDispose );\n\n\t\t\t\t\t\treturn mapTextureMapping( renderTarget.texture, texture.mapping );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// image not yet ready. try the conversion next frame\n\n\t\t\t\t\t\treturn null;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn texture;\n\n\t}\n\n\tfunction onTextureDispose( event ) {\n\n\t\tconst texture = event.target;\n\n\t\ttexture.removeEventListener( 'dispose', onTextureDispose );\n\n\t\tconst cubemap = cubemaps.get( texture );\n\n\t\tif ( cubemap !== undefined ) {\n\n\t\t\tcubemaps.delete( texture );\n\t\t\tcubemap.dispose();\n\n\t\t}\n\n\t}\n\n\tfunction dispose() {\n\n\t\tcubemaps = new WeakMap();\n\n\t}\n\n\treturn {\n\t\tget: get,\n\t\tdispose: dispose\n\t};\n\n}\n\nclass OrthographicCamera extends Camera {\n\n\tconstructor( left = - 1, right = 1, top = 1, bottom = - 1, near = 0.1, far = 2000 ) {\n\n\t\tsuper();\n\n\t\tthis.isOrthographicCamera = true;\n\n\t\tthis.type = 'OrthographicCamera';\n\n\t\tthis.zoom = 1;\n\t\tthis.view = null;\n\n\t\tthis.left = left;\n\t\tthis.right = right;\n\t\tthis.top = top;\n\t\tthis.bottom = bottom;\n\n\t\tthis.near = near;\n\t\tthis.far = far;\n\n\t\tthis.updateProjectionMatrix();\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.left = source.left;\n\t\tthis.right = source.right;\n\t\tthis.top = source.top;\n\t\tthis.bottom = source.bottom;\n\t\tthis.near = source.near;\n\t\tthis.far = source.far;\n\n\t\tthis.zoom = source.zoom;\n\t\tthis.view = source.view === null ? null : Object.assign( {}, source.view );\n\n\t\treturn this;\n\n\t}\n\n\tsetViewOffset( fullWidth, fullHeight, x, y, width, height ) {\n\n\t\tif ( this.view === null ) {\n\n\t\t\tthis.view = {\n\t\t\t\tenabled: true,\n\t\t\t\tfullWidth: 1,\n\t\t\t\tfullHeight: 1,\n\t\t\t\toffsetX: 0,\n\t\t\t\toffsetY: 0,\n\t\t\t\twidth: 1,\n\t\t\t\theight: 1\n\t\t\t};\n\n\t\t}\n\n\t\tthis.view.enabled = true;\n\t\tthis.view.fullWidth = fullWidth;\n\t\tthis.view.fullHeight = fullHeight;\n\t\tthis.view.offsetX = x;\n\t\tthis.view.offsetY = y;\n\t\tthis.view.width = width;\n\t\tthis.view.height = height;\n\n\t\tthis.updateProjectionMatrix();\n\n\t}\n\n\tclearViewOffset() {\n\n\t\tif ( this.view !== null ) {\n\n\t\t\tthis.view.enabled = false;\n\n\t\t}\n\n\t\tthis.updateProjectionMatrix();\n\n\t}\n\n\tupdateProjectionMatrix() {\n\n\t\tconst dx = ( this.right - this.left ) / ( 2 * this.zoom );\n\t\tconst dy = ( this.top - this.bottom ) / ( 2 * this.zoom );\n\t\tconst cx = ( this.right + this.left ) / 2;\n\t\tconst cy = ( this.top + this.bottom ) / 2;\n\n\t\tlet left = cx - dx;\n\t\tlet right = cx + dx;\n\t\tlet top = cy + dy;\n\t\tlet bottom = cy - dy;\n\n\t\tif ( this.view !== null && this.view.enabled ) {\n\n\t\t\tconst scaleW = ( this.right - this.left ) / this.view.fullWidth / this.zoom;\n\t\t\tconst scaleH = ( this.top - this.bottom ) / this.view.fullHeight / this.zoom;\n\n\t\t\tleft += scaleW * this.view.offsetX;\n\t\t\tright = left + scaleW * this.view.width;\n\t\t\ttop -= scaleH * this.view.offsetY;\n\t\t\tbottom = top - scaleH * this.view.height;\n\n\t\t}\n\n\t\tthis.projectionMatrix.makeOrthographic( left, right, top, bottom, this.near, this.far );\n\n\t\tthis.projectionMatrixInverse.copy( this.projectionMatrix ).invert();\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst data = super.toJSON( meta );\n\n\t\tdata.object.zoom = this.zoom;\n\t\tdata.object.left = this.left;\n\t\tdata.object.right = this.right;\n\t\tdata.object.top = this.top;\n\t\tdata.object.bottom = this.bottom;\n\t\tdata.object.near = this.near;\n\t\tdata.object.far = this.far;\n\n\t\tif ( this.view !== null ) data.object.view = Object.assign( {}, this.view );\n\n\t\treturn data;\n\n\t}\n\n}\n\nconst LOD_MIN = 4;\n\n// The standard deviations (radians) associated with the extra mips. These are\n// chosen to approximate a Trowbridge-Reitz distribution function times the\n// geometric shadowing function. These sigma values squared must match the\n// variance #defines in cube_uv_reflection_fragment.glsl.js.\nconst EXTRA_LOD_SIGMA = [ 0.125, 0.215, 0.35, 0.446, 0.526, 0.582 ];\n\n// The maximum length of the blur for loop. Smaller sigmas will use fewer\n// samples and exit early, but not recompile the shader.\nconst MAX_SAMPLES = 20;\n\nconst _flatCamera = /*@__PURE__*/ new OrthographicCamera();\nconst _clearColor = /*@__PURE__*/ new Color();\nlet _oldTarget = null;\n\n// Golden Ratio\nconst PHI = ( 1 + Math.sqrt( 5 ) ) / 2;\nconst INV_PHI = 1 / PHI;\n\n// Vertices of a dodecahedron (except the opposites, which represent the\n// same axis), used as axis directions evenly spread on a sphere.\nconst _axisDirections = [\n\t/*@__PURE__*/ new Vector3( 1, 1, 1 ),\n\t/*@__PURE__*/ new Vector3( - 1, 1, 1 ),\n\t/*@__PURE__*/ new Vector3( 1, 1, - 1 ),\n\t/*@__PURE__*/ new Vector3( - 1, 1, - 1 ),\n\t/*@__PURE__*/ new Vector3( 0, PHI, INV_PHI ),\n\t/*@__PURE__*/ new Vector3( 0, PHI, - INV_PHI ),\n\t/*@__PURE__*/ new Vector3( INV_PHI, 0, PHI ),\n\t/*@__PURE__*/ new Vector3( - INV_PHI, 0, PHI ),\n\t/*@__PURE__*/ new Vector3( PHI, INV_PHI, 0 ),\n\t/*@__PURE__*/ new Vector3( - PHI, INV_PHI, 0 ) ];\n\n/**\n * This class generates a Prefiltered, Mipmapped Radiance Environment Map\n * (PMREM) from a cubeMap environment texture. This allows different levels of\n * blur to be quickly accessed based on material roughness. It is packed into a\n * special CubeUV format that allows us to perform custom interpolation so that\n * we can support nonlinear formats such as RGBE. Unlike a traditional mipmap\n * chain, it only goes down to the LOD_MIN level (above), and then creates extra\n * even more filtered 'mips' at the same LOD_MIN resolution, associated with\n * higher roughness levels. In this way we maintain resolution to smoothly\n * interpolate diffuse lighting while limiting sampling computation.\n *\n * Paper: Fast, Accurate Image-Based Lighting\n * https://drive.google.com/file/d/15y8r_UpKlU9SvV4ILb0C3qCPecS8pvLz/view\n*/\n\nclass PMREMGenerator {\n\n\tconstructor( renderer ) {\n\n\t\tthis._renderer = renderer;\n\t\tthis._pingPongRenderTarget = null;\n\n\t\tthis._lodMax = 0;\n\t\tthis._cubeSize = 0;\n\t\tthis._lodPlanes = [];\n\t\tthis._sizeLods = [];\n\t\tthis._sigmas = [];\n\n\t\tthis._blurMaterial = null;\n\t\tthis._cubemapMaterial = null;\n\t\tthis._equirectMaterial = null;\n\n\t\tthis._compileMaterial( this._blurMaterial );\n\n\t}\n\n\t/**\n\t * Generates a PMREM from a supplied Scene, which can be faster than using an\n\t * image if networking bandwidth is low. Optional sigma specifies a blur radius\n\t * in radians to be applied to the scene before PMREM generation. Optional near\n\t * and far planes ensure the scene is rendered in its entirety (the cubeCamera\n\t * is placed at the origin).\n\t */\n\tfromScene( scene, sigma = 0, near = 0.1, far = 100 ) {\n\n\t\t_oldTarget = this._renderer.getRenderTarget();\n\n\t\tthis._setSize( 256 );\n\n\t\tconst cubeUVRenderTarget = this._allocateTargets();\n\t\tcubeUVRenderTarget.depthBuffer = true;\n\n\t\tthis._sceneToCubeUV( scene, near, far, cubeUVRenderTarget );\n\n\t\tif ( sigma > 0 ) {\n\n\t\t\tthis._blur( cubeUVRenderTarget, 0, 0, sigma );\n\n\t\t}\n\n\t\tthis._applyPMREM( cubeUVRenderTarget );\n\t\tthis._cleanup( cubeUVRenderTarget );\n\n\t\treturn cubeUVRenderTarget;\n\n\t}\n\n\t/**\n\t * Generates a PMREM from an equirectangular texture, which can be either LDR\n\t * or HDR. The ideal input image size is 1k (1024 x 512),\n\t * as this matches best with the 256 x 256 cubemap output.\n\t */\n\tfromEquirectangular( equirectangular, renderTarget = null ) {\n\n\t\treturn this._fromTexture( equirectangular, renderTarget );\n\n\t}\n\n\t/**\n\t * Generates a PMREM from an cubemap texture, which can be either LDR\n\t * or HDR. The ideal input cube size is 256 x 256,\n\t * as this matches best with the 256 x 256 cubemap output.\n\t */\n\tfromCubemap( cubemap, renderTarget = null ) {\n\n\t\treturn this._fromTexture( cubemap, renderTarget );\n\n\t}\n\n\t/**\n\t * Pre-compiles the cubemap shader. You can get faster start-up by invoking this method during\n\t * your texture's network fetch for increased concurrency.\n\t */\n\tcompileCubemapShader() {\n\n\t\tif ( this._cubemapMaterial === null ) {\n\n\t\t\tthis._cubemapMaterial = _getCubemapMaterial();\n\t\t\tthis._compileMaterial( this._cubemapMaterial );\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Pre-compiles the equirectangular shader. You can get faster start-up by invoking this method during\n\t * your texture's network fetch for increased concurrency.\n\t */\n\tcompileEquirectangularShader() {\n\n\t\tif ( this._equirectMaterial === null ) {\n\n\t\t\tthis._equirectMaterial = _getEquirectMaterial();\n\t\t\tthis._compileMaterial( this._equirectMaterial );\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Disposes of the PMREMGenerator's internal memory. Note that PMREMGenerator is a static class,\n\t * so you should not need more than one PMREMGenerator object. If you do, calling dispose() on\n\t * one of them will cause any others to also become unusable.\n\t */\n\tdispose() {\n\n\t\tthis._dispose();\n\n\t\tif ( this._cubemapMaterial !== null ) this._cubemapMaterial.dispose();\n\t\tif ( this._equirectMaterial !== null ) this._equirectMaterial.dispose();\n\n\t}\n\n\t// private interface\n\n\t_setSize( cubeSize ) {\n\n\t\tthis._lodMax = Math.floor( Math.log2( cubeSize ) );\n\t\tthis._cubeSize = Math.pow( 2, this._lodMax );\n\n\t}\n\n\t_dispose() {\n\n\t\tif ( this._blurMaterial !== null ) this._blurMaterial.dispose();\n\n\t\tif ( this._pingPongRenderTarget !== null ) this._pingPongRenderTarget.dispose();\n\n\t\tfor ( let i = 0; i < this._lodPlanes.length; i ++ ) {\n\n\t\t\tthis._lodPlanes[ i ].dispose();\n\n\t\t}\n\n\t}\n\n\t_cleanup( outputTarget ) {\n\n\t\tthis._renderer.setRenderTarget( _oldTarget );\n\t\toutputTarget.scissorTest = false;\n\t\t_setViewport( outputTarget, 0, 0, outputTarget.width, outputTarget.height );\n\n\t}\n\n\t_fromTexture( texture, renderTarget ) {\n\n\t\tif ( texture.mapping === CubeReflectionMapping || texture.mapping === CubeRefractionMapping ) {\n\n\t\t\tthis._setSize( texture.image.length === 0 ? 16 : ( texture.image[ 0 ].width || texture.image[ 0 ].image.width ) );\n\n\t\t} else { // Equirectangular\n\n\t\t\tthis._setSize( texture.image.width / 4 );\n\n\t\t}\n\n\t\t_oldTarget = this._renderer.getRenderTarget();\n\n\t\tconst cubeUVRenderTarget = renderTarget || this._allocateTargets();\n\t\tthis._textureToCubeUV( texture, cubeUVRenderTarget );\n\t\tthis._applyPMREM( cubeUVRenderTarget );\n\t\tthis._cleanup( cubeUVRenderTarget );\n\n\t\treturn cubeUVRenderTarget;\n\n\t}\n\n\t_allocateTargets() {\n\n\t\tconst width = 3 * Math.max( this._cubeSize, 16 * 7 );\n\t\tconst height = 4 * this._cubeSize;\n\n\t\tconst params = {\n\t\t\tmagFilter: LinearFilter,\n\t\t\tminFilter: LinearFilter,\n\t\t\tgenerateMipmaps: false,\n\t\t\ttype: HalfFloatType,\n\t\t\tformat: RGBAFormat,\n\t\t\tencoding: LinearEncoding,\n\t\t\tdepthBuffer: false\n\t\t};\n\n\t\tconst cubeUVRenderTarget = _createRenderTarget( width, height, params );\n\n\t\tif ( this._pingPongRenderTarget === null || this._pingPongRenderTarget.width !== width ) {\n\n\t\t\tif ( this._pingPongRenderTarget !== null ) {\n\n\t\t\t\tthis._dispose();\n\n\t\t\t}\n\n\t\t\tthis._pingPongRenderTarget = _createRenderTarget( width, height, params );\n\n\t\t\tconst { _lodMax } = this;\n\t\t\t( { sizeLods: this._sizeLods, lodPlanes: this._lodPlanes, sigmas: this._sigmas } = _createPlanes( _lodMax ) );\n\n\t\t\tthis._blurMaterial = _getBlurShader( _lodMax, width, height );\n\n\t\t}\n\n\t\treturn cubeUVRenderTarget;\n\n\t}\n\n\t_compileMaterial( material ) {\n\n\t\tconst tmpMesh = new Mesh( this._lodPlanes[ 0 ], material );\n\t\tthis._renderer.compile( tmpMesh, _flatCamera );\n\n\t}\n\n\t_sceneToCubeUV( scene, near, far, cubeUVRenderTarget ) {\n\n\t\tconst fov = 90;\n\t\tconst aspect = 1;\n\t\tconst cubeCamera = new PerspectiveCamera( fov, aspect, near, far );\n\t\tconst upSign = [ 1, - 1, 1, 1, 1, 1 ];\n\t\tconst forwardSign = [ 1, 1, 1, - 1, - 1, - 1 ];\n\t\tconst renderer = this._renderer;\n\n\t\tconst originalAutoClear = renderer.autoClear;\n\t\tconst toneMapping = renderer.toneMapping;\n\t\trenderer.getClearColor( _clearColor );\n\n\t\trenderer.toneMapping = NoToneMapping;\n\t\trenderer.autoClear = false;\n\n\t\tconst backgroundMaterial = new MeshBasicMaterial( {\n\t\t\tname: 'PMREM.Background',\n\t\t\tside: BackSide,\n\t\t\tdepthWrite: false,\n\t\t\tdepthTest: false,\n\t\t} );\n\n\t\tconst backgroundBox = new Mesh( new BoxGeometry(), backgroundMaterial );\n\n\t\tlet useSolidColor = false;\n\t\tconst background = scene.background;\n\n\t\tif ( background ) {\n\n\t\t\tif ( background.isColor ) {\n\n\t\t\t\tbackgroundMaterial.color.copy( background );\n\t\t\t\tscene.background = null;\n\t\t\t\tuseSolidColor = true;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tbackgroundMaterial.color.copy( _clearColor );\n\t\t\tuseSolidColor = true;\n\n\t\t}\n\n\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\tconst col = i % 3;\n\n\t\t\tif ( col === 0 ) {\n\n\t\t\t\tcubeCamera.up.set( 0, upSign[ i ], 0 );\n\t\t\t\tcubeCamera.lookAt( forwardSign[ i ], 0, 0 );\n\n\t\t\t} else if ( col === 1 ) {\n\n\t\t\t\tcubeCamera.up.set( 0, 0, upSign[ i ] );\n\t\t\t\tcubeCamera.lookAt( 0, forwardSign[ i ], 0 );\n\n\t\t\t} else {\n\n\t\t\t\tcubeCamera.up.set( 0, upSign[ i ], 0 );\n\t\t\t\tcubeCamera.lookAt( 0, 0, forwardSign[ i ] );\n\n\t\t\t}\n\n\t\t\tconst size = this._cubeSize;\n\n\t\t\t_setViewport( cubeUVRenderTarget, col * size, i > 2 ? size : 0, size, size );\n\n\t\t\trenderer.setRenderTarget( cubeUVRenderTarget );\n\n\t\t\tif ( useSolidColor ) {\n\n\t\t\t\trenderer.render( backgroundBox, cubeCamera );\n\n\t\t\t}\n\n\t\t\trenderer.render( scene, cubeCamera );\n\n\t\t}\n\n\t\tbackgroundBox.geometry.dispose();\n\t\tbackgroundBox.material.dispose();\n\n\t\trenderer.toneMapping = toneMapping;\n\t\trenderer.autoClear = originalAutoClear;\n\t\tscene.background = background;\n\n\t}\n\n\t_textureToCubeUV( texture, cubeUVRenderTarget ) {\n\n\t\tconst renderer = this._renderer;\n\n\t\tconst isCubeTexture = ( texture.mapping === CubeReflectionMapping || texture.mapping === CubeRefractionMapping );\n\n\t\tif ( isCubeTexture ) {\n\n\t\t\tif ( this._cubemapMaterial === null ) {\n\n\t\t\t\tthis._cubemapMaterial = _getCubemapMaterial();\n\n\t\t\t}\n\n\t\t\tthis._cubemapMaterial.uniforms.flipEnvMap.value = ( texture.isRenderTargetTexture === false ) ? - 1 : 1;\n\n\t\t} else {\n\n\t\t\tif ( this._equirectMaterial === null ) {\n\n\t\t\t\tthis._equirectMaterial = _getEquirectMaterial();\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst material = isCubeTexture ? this._cubemapMaterial : this._equirectMaterial;\n\t\tconst mesh = new Mesh( this._lodPlanes[ 0 ], material );\n\n\t\tconst uniforms = material.uniforms;\n\n\t\tuniforms[ 'envMap' ].value = texture;\n\n\t\tconst size = this._cubeSize;\n\n\t\t_setViewport( cubeUVRenderTarget, 0, 0, 3 * size, 2 * size );\n\n\t\trenderer.setRenderTarget( cubeUVRenderTarget );\n\t\trenderer.render( mesh, _flatCamera );\n\n\t}\n\n\t_applyPMREM( cubeUVRenderTarget ) {\n\n\t\tconst renderer = this._renderer;\n\t\tconst autoClear = renderer.autoClear;\n\t\trenderer.autoClear = false;\n\n\t\tfor ( let i = 1; i < this._lodPlanes.length; i ++ ) {\n\n\t\t\tconst sigma = Math.sqrt( this._sigmas[ i ] * this._sigmas[ i ] - this._sigmas[ i - 1 ] * this._sigmas[ i - 1 ] );\n\n\t\t\tconst poleAxis = _axisDirections[ ( i - 1 ) % _axisDirections.length ];\n\n\t\t\tthis._blur( cubeUVRenderTarget, i - 1, i, sigma, poleAxis );\n\n\t\t}\n\n\t\trenderer.autoClear = autoClear;\n\n\t}\n\n\t/**\n\t * This is a two-pass Gaussian blur for a cubemap. Normally this is done\n\t * vertically and horizontally, but this breaks down on a cube. Here we apply\n\t * the blur latitudinally (around the poles), and then longitudinally (towards\n\t * the poles) to approximate the orthogonally-separable blur. It is least\n\t * accurate at the poles, but still does a decent job.\n\t */\n\t_blur( cubeUVRenderTarget, lodIn, lodOut, sigma, poleAxis ) {\n\n\t\tconst pingPongRenderTarget = this._pingPongRenderTarget;\n\n\t\tthis._halfBlur(\n\t\t\tcubeUVRenderTarget,\n\t\t\tpingPongRenderTarget,\n\t\t\tlodIn,\n\t\t\tlodOut,\n\t\t\tsigma,\n\t\t\t'latitudinal',\n\t\t\tpoleAxis );\n\n\t\tthis._halfBlur(\n\t\t\tpingPongRenderTarget,\n\t\t\tcubeUVRenderTarget,\n\t\t\tlodOut,\n\t\t\tlodOut,\n\t\t\tsigma,\n\t\t\t'longitudinal',\n\t\t\tpoleAxis );\n\n\t}\n\n\t_halfBlur( targetIn, targetOut, lodIn, lodOut, sigmaRadians, direction, poleAxis ) {\n\n\t\tconst renderer = this._renderer;\n\t\tconst blurMaterial = this._blurMaterial;\n\n\t\tif ( direction !== 'latitudinal' && direction !== 'longitudinal' ) {\n\n\t\t\tconsole.error(\n\t\t\t\t'blur direction must be either latitudinal or longitudinal!' );\n\n\t\t}\n\n\t\t// Number of standard deviations at which to cut off the discrete approximation.\n\t\tconst STANDARD_DEVIATIONS = 3;\n\n\t\tconst blurMesh = new Mesh( this._lodPlanes[ lodOut ], blurMaterial );\n\t\tconst blurUniforms = blurMaterial.uniforms;\n\n\t\tconst pixels = this._sizeLods[ lodIn ] - 1;\n\t\tconst radiansPerPixel = isFinite( sigmaRadians ) ? Math.PI / ( 2 * pixels ) : 2 * Math.PI / ( 2 * MAX_SAMPLES - 1 );\n\t\tconst sigmaPixels = sigmaRadians / radiansPerPixel;\n\t\tconst samples = isFinite( sigmaRadians ) ? 1 + Math.floor( STANDARD_DEVIATIONS * sigmaPixels ) : MAX_SAMPLES;\n\n\t\tif ( samples > MAX_SAMPLES ) {\n\n\t\t\tconsole.warn( `sigmaRadians, ${\n\t\t\t\tsigmaRadians}, is too large and will clip, as it requested ${\n\t\t\t\tsamples} samples when the maximum is set to ${MAX_SAMPLES}` );\n\n\t\t}\n\n\t\tconst weights = [];\n\t\tlet sum = 0;\n\n\t\tfor ( let i = 0; i < MAX_SAMPLES; ++ i ) {\n\n\t\t\tconst x = i / sigmaPixels;\n\t\t\tconst weight = Math.exp( - x * x / 2 );\n\t\t\tweights.push( weight );\n\n\t\t\tif ( i === 0 ) {\n\n\t\t\t\tsum += weight;\n\n\t\t\t} else if ( i < samples ) {\n\n\t\t\t\tsum += 2 * weight;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfor ( let i = 0; i < weights.length; i ++ ) {\n\n\t\t\tweights[ i ] = weights[ i ] / sum;\n\n\t\t}\n\n\t\tblurUniforms[ 'envMap' ].value = targetIn.texture;\n\t\tblurUniforms[ 'samples' ].value = samples;\n\t\tblurUniforms[ 'weights' ].value = weights;\n\t\tblurUniforms[ 'latitudinal' ].value = direction === 'latitudinal';\n\n\t\tif ( poleAxis ) {\n\n\t\t\tblurUniforms[ 'poleAxis' ].value = poleAxis;\n\n\t\t}\n\n\t\tconst { _lodMax } = this;\n\t\tblurUniforms[ 'dTheta' ].value = radiansPerPixel;\n\t\tblurUniforms[ 'mipInt' ].value = _lodMax - lodIn;\n\n\t\tconst outputSize = this._sizeLods[ lodOut ];\n\t\tconst x = 3 * outputSize * ( lodOut > _lodMax - LOD_MIN ? lodOut - _lodMax + LOD_MIN : 0 );\n\t\tconst y = 4 * ( this._cubeSize - outputSize );\n\n\t\t_setViewport( targetOut, x, y, 3 * outputSize, 2 * outputSize );\n\t\trenderer.setRenderTarget( targetOut );\n\t\trenderer.render( blurMesh, _flatCamera );\n\n\t}\n\n}\n\n\n\nfunction _createPlanes( lodMax ) {\n\n\tconst lodPlanes = [];\n\tconst sizeLods = [];\n\tconst sigmas = [];\n\n\tlet lod = lodMax;\n\n\tconst totalLods = lodMax - LOD_MIN + 1 + EXTRA_LOD_SIGMA.length;\n\n\tfor ( let i = 0; i < totalLods; i ++ ) {\n\n\t\tconst sizeLod = Math.pow( 2, lod );\n\t\tsizeLods.push( sizeLod );\n\t\tlet sigma = 1.0 / sizeLod;\n\n\t\tif ( i > lodMax - LOD_MIN ) {\n\n\t\t\tsigma = EXTRA_LOD_SIGMA[ i - lodMax + LOD_MIN - 1 ];\n\n\t\t} else if ( i === 0 ) {\n\n\t\t\tsigma = 0;\n\n\t\t}\n\n\t\tsigmas.push( sigma );\n\n\t\tconst texelSize = 1.0 / ( sizeLod - 2 );\n\t\tconst min = - texelSize;\n\t\tconst max = 1 + texelSize;\n\t\tconst uv1 = [ min, min, max, min, max, max, min, min, max, max, min, max ];\n\n\t\tconst cubeFaces = 6;\n\t\tconst vertices = 6;\n\t\tconst positionSize = 3;\n\t\tconst uvSize = 2;\n\t\tconst faceIndexSize = 1;\n\n\t\tconst position = new Float32Array( positionSize * vertices * cubeFaces );\n\t\tconst uv = new Float32Array( uvSize * vertices * cubeFaces );\n\t\tconst faceIndex = new Float32Array( faceIndexSize * vertices * cubeFaces );\n\n\t\tfor ( let face = 0; face < cubeFaces; face ++ ) {\n\n\t\t\tconst x = ( face % 3 ) * 2 / 3 - 1;\n\t\t\tconst y = face > 2 ? 0 : - 1;\n\t\t\tconst coordinates = [\n\t\t\t\tx, y, 0,\n\t\t\t\tx + 2 / 3, y, 0,\n\t\t\t\tx + 2 / 3, y + 1, 0,\n\t\t\t\tx, y, 0,\n\t\t\t\tx + 2 / 3, y + 1, 0,\n\t\t\t\tx, y + 1, 0\n\t\t\t];\n\t\t\tposition.set( coordinates, positionSize * vertices * face );\n\t\t\tuv.set( uv1, uvSize * vertices * face );\n\t\t\tconst fill = [ face, face, face, face, face, face ];\n\t\t\tfaceIndex.set( fill, faceIndexSize * vertices * face );\n\n\t\t}\n\n\t\tconst planes = new BufferGeometry();\n\t\tplanes.setAttribute( 'position', new BufferAttribute( position, positionSize ) );\n\t\tplanes.setAttribute( 'uv', new BufferAttribute( uv, uvSize ) );\n\t\tplanes.setAttribute( 'faceIndex', new BufferAttribute( faceIndex, faceIndexSize ) );\n\t\tlodPlanes.push( planes );\n\n\t\tif ( lod > LOD_MIN ) {\n\n\t\t\tlod --;\n\n\t\t}\n\n\t}\n\n\treturn { lodPlanes, sizeLods, sigmas };\n\n}\n\nfunction _createRenderTarget( width, height, params ) {\n\n\tconst cubeUVRenderTarget = new WebGLRenderTarget( width, height, params );\n\tcubeUVRenderTarget.texture.mapping = CubeUVReflectionMapping;\n\tcubeUVRenderTarget.texture.name = 'PMREM.cubeUv';\n\tcubeUVRenderTarget.scissorTest = true;\n\treturn cubeUVRenderTarget;\n\n}\n\nfunction _setViewport( target, x, y, width, height ) {\n\n\ttarget.viewport.set( x, y, width, height );\n\ttarget.scissor.set( x, y, width, height );\n\n}\n\nfunction _getBlurShader( lodMax, width, height ) {\n\n\tconst weights = new Float32Array( MAX_SAMPLES );\n\tconst poleAxis = new Vector3( 0, 1, 0 );\n\tconst shaderMaterial = new ShaderMaterial( {\n\n\t\tname: 'SphericalGaussianBlur',\n\n\t\tdefines: {\n\t\t\t'n': MAX_SAMPLES,\n\t\t\t'CUBEUV_TEXEL_WIDTH': 1.0 / width,\n\t\t\t'CUBEUV_TEXEL_HEIGHT': 1.0 / height,\n\t\t\t'CUBEUV_MAX_MIP': `${lodMax}.0`,\n\t\t},\n\n\t\tuniforms: {\n\t\t\t'envMap': { value: null },\n\t\t\t'samples': { value: 1 },\n\t\t\t'weights': { value: weights },\n\t\t\t'latitudinal': { value: false },\n\t\t\t'dTheta': { value: 0 },\n\t\t\t'mipInt': { value: 0 },\n\t\t\t'poleAxis': { value: poleAxis }\n\t\t},\n\n\t\tvertexShader: _getCommonVertexShader(),\n\n\t\tfragmentShader: /* glsl */`\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t`,\n\n\t\tblending: NoBlending,\n\t\tdepthTest: false,\n\t\tdepthWrite: false\n\n\t} );\n\n\treturn shaderMaterial;\n\n}\n\nfunction _getEquirectMaterial() {\n\n\treturn new ShaderMaterial( {\n\n\t\tname: 'EquirectangularToCubeUV',\n\n\t\tuniforms: {\n\t\t\t'envMap': { value: null }\n\t\t},\n\n\t\tvertexShader: _getCommonVertexShader(),\n\n\t\tfragmentShader: /* glsl */`\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t`,\n\n\t\tblending: NoBlending,\n\t\tdepthTest: false,\n\t\tdepthWrite: false\n\n\t} );\n\n}\n\nfunction _getCubemapMaterial() {\n\n\treturn new ShaderMaterial( {\n\n\t\tname: 'CubemapToCubeUV',\n\n\t\tuniforms: {\n\t\t\t'envMap': { value: null },\n\t\t\t'flipEnvMap': { value: - 1 }\n\t\t},\n\n\t\tvertexShader: _getCommonVertexShader(),\n\n\t\tfragmentShader: /* glsl */`\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t`,\n\n\t\tblending: NoBlending,\n\t\tdepthTest: false,\n\t\tdepthWrite: false\n\n\t} );\n\n}\n\nfunction _getCommonVertexShader() {\n\n\treturn /* glsl */`\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t`;\n\n}\n\nfunction WebGLCubeUVMaps( renderer ) {\n\n\tlet cubeUVmaps = new WeakMap();\n\n\tlet pmremGenerator = null;\n\n\tfunction get( texture ) {\n\n\t\tif ( texture && texture.isTexture ) {\n\n\t\t\tconst mapping = texture.mapping;\n\n\t\t\tconst isEquirectMap = ( mapping === EquirectangularReflectionMapping || mapping === EquirectangularRefractionMapping );\n\t\t\tconst isCubeMap = ( mapping === CubeReflectionMapping || mapping === CubeRefractionMapping );\n\n\t\t\t// equirect/cube map to cubeUV conversion\n\n\t\t\tif ( isEquirectMap || isCubeMap ) {\n\n\t\t\t\tif ( texture.isRenderTargetTexture && texture.needsPMREMUpdate === true ) {\n\n\t\t\t\t\ttexture.needsPMREMUpdate = false;\n\n\t\t\t\t\tlet renderTarget = cubeUVmaps.get( texture );\n\n\t\t\t\t\tif ( pmremGenerator === null ) pmremGenerator = new PMREMGenerator( renderer );\n\n\t\t\t\t\trenderTarget = isEquirectMap ? pmremGenerator.fromEquirectangular( texture, renderTarget ) : pmremGenerator.fromCubemap( texture, renderTarget );\n\t\t\t\t\tcubeUVmaps.set( texture, renderTarget );\n\n\t\t\t\t\treturn renderTarget.texture;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( cubeUVmaps.has( texture ) ) {\n\n\t\t\t\t\t\treturn cubeUVmaps.get( texture ).texture;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tconst image = texture.image;\n\n\t\t\t\t\t\tif ( ( isEquirectMap && image && image.height > 0 ) || ( isCubeMap && image && isCubeTextureComplete( image ) ) ) {\n\n\t\t\t\t\t\t\tif ( pmremGenerator === null ) pmremGenerator = new PMREMGenerator( renderer );\n\n\t\t\t\t\t\t\tconst renderTarget = isEquirectMap ? pmremGenerator.fromEquirectangular( texture ) : pmremGenerator.fromCubemap( texture );\n\t\t\t\t\t\t\tcubeUVmaps.set( texture, renderTarget );\n\n\t\t\t\t\t\t\ttexture.addEventListener( 'dispose', onTextureDispose );\n\n\t\t\t\t\t\t\treturn renderTarget.texture;\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t// image not yet ready. try the conversion next frame\n\n\t\t\t\t\t\t\treturn null;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn texture;\n\n\t}\n\n\tfunction isCubeTextureComplete( image ) {\n\n\t\tlet count = 0;\n\t\tconst length = 6;\n\n\t\tfor ( let i = 0; i < length; i ++ ) {\n\n\t\t\tif ( image[ i ] !== undefined ) count ++;\n\n\t\t}\n\n\t\treturn count === length;\n\n\n\t}\n\n\tfunction onTextureDispose( event ) {\n\n\t\tconst texture = event.target;\n\n\t\ttexture.removeEventListener( 'dispose', onTextureDispose );\n\n\t\tconst cubemapUV = cubeUVmaps.get( texture );\n\n\t\tif ( cubemapUV !== undefined ) {\n\n\t\t\tcubeUVmaps.delete( texture );\n\t\t\tcubemapUV.dispose();\n\n\t\t}\n\n\t}\n\n\tfunction dispose() {\n\n\t\tcubeUVmaps = new WeakMap();\n\n\t\tif ( pmremGenerator !== null ) {\n\n\t\t\tpmremGenerator.dispose();\n\t\t\tpmremGenerator = null;\n\n\t\t}\n\n\t}\n\n\treturn {\n\t\tget: get,\n\t\tdispose: dispose\n\t};\n\n}\n\nfunction WebGLExtensions( gl ) {\n\n\tconst extensions = {};\n\n\tfunction getExtension( name ) {\n\n\t\tif ( extensions[ name ] !== undefined ) {\n\n\t\t\treturn extensions[ name ];\n\n\t\t}\n\n\t\tlet extension;\n\n\t\tswitch ( name ) {\n\n\t\t\tcase 'WEBGL_depth_texture':\n\t\t\t\textension = gl.getExtension( 'WEBGL_depth_texture' ) || gl.getExtension( 'MOZ_WEBGL_depth_texture' ) || gl.getExtension( 'WEBKIT_WEBGL_depth_texture' );\n\t\t\t\tbreak;\n\n\t\t\tcase 'EXT_texture_filter_anisotropic':\n\t\t\t\textension = gl.getExtension( 'EXT_texture_filter_anisotropic' ) || gl.getExtension( 'MOZ_EXT_texture_filter_anisotropic' ) || gl.getExtension( 'WEBKIT_EXT_texture_filter_anisotropic' );\n\t\t\t\tbreak;\n\n\t\t\tcase 'WEBGL_compressed_texture_s3tc':\n\t\t\t\textension = gl.getExtension( 'WEBGL_compressed_texture_s3tc' ) || gl.getExtension( 'MOZ_WEBGL_compressed_texture_s3tc' ) || gl.getExtension( 'WEBKIT_WEBGL_compressed_texture_s3tc' );\n\t\t\t\tbreak;\n\n\t\t\tcase 'WEBGL_compressed_texture_pvrtc':\n\t\t\t\textension = gl.getExtension( 'WEBGL_compressed_texture_pvrtc' ) || gl.getExtension( 'WEBKIT_WEBGL_compressed_texture_pvrtc' );\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\textension = gl.getExtension( name );\n\n\t\t}\n\n\t\textensions[ name ] = extension;\n\n\t\treturn extension;\n\n\t}\n\n\treturn {\n\n\t\thas: function ( name ) {\n\n\t\t\treturn getExtension( name ) !== null;\n\n\t\t},\n\n\t\tinit: function ( capabilities ) {\n\n\t\t\tif ( capabilities.isWebGL2 ) {\n\n\t\t\t\tgetExtension( 'EXT_color_buffer_float' );\n\n\t\t\t} else {\n\n\t\t\t\tgetExtension( 'WEBGL_depth_texture' );\n\t\t\t\tgetExtension( 'OES_texture_float' );\n\t\t\t\tgetExtension( 'OES_texture_half_float' );\n\t\t\t\tgetExtension( 'OES_texture_half_float_linear' );\n\t\t\t\tgetExtension( 'OES_standard_derivatives' );\n\t\t\t\tgetExtension( 'OES_element_index_uint' );\n\t\t\t\tgetExtension( 'OES_vertex_array_object' );\n\t\t\t\tgetExtension( 'ANGLE_instanced_arrays' );\n\n\t\t\t}\n\n\t\t\tgetExtension( 'OES_texture_float_linear' );\n\t\t\tgetExtension( 'EXT_color_buffer_half_float' );\n\t\t\tgetExtension( 'WEBGL_multisampled_render_to_texture' );\n\n\t\t},\n\n\t\tget: function ( name ) {\n\n\t\t\tconst extension = getExtension( name );\n\n\t\t\tif ( extension === null ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: ' + name + ' extension not supported.' );\n\n\t\t\t}\n\n\t\t\treturn extension;\n\n\t\t}\n\n\t};\n\n}\n\nfunction WebGLGeometries( gl, attributes, info, bindingStates ) {\n\n\tconst geometries = {};\n\tconst wireframeAttributes = new WeakMap();\n\n\tfunction onGeometryDispose( event ) {\n\n\t\tconst geometry = event.target;\n\n\t\tif ( geometry.index !== null ) {\n\n\t\t\tattributes.remove( geometry.index );\n\n\t\t}\n\n\t\tfor ( const name in geometry.attributes ) {\n\n\t\t\tattributes.remove( geometry.attributes[ name ] );\n\n\t\t}\n\n\t\tgeometry.removeEventListener( 'dispose', onGeometryDispose );\n\n\t\tdelete geometries[ geometry.id ];\n\n\t\tconst attribute = wireframeAttributes.get( geometry );\n\n\t\tif ( attribute ) {\n\n\t\t\tattributes.remove( attribute );\n\t\t\twireframeAttributes.delete( geometry );\n\n\t\t}\n\n\t\tbindingStates.releaseStatesOfGeometry( geometry );\n\n\t\tif ( geometry.isInstancedBufferGeometry === true ) {\n\n\t\t\tdelete geometry._maxInstanceCount;\n\n\t\t}\n\n\t\t//\n\n\t\tinfo.memory.geometries --;\n\n\t}\n\n\tfunction get( object, geometry ) {\n\n\t\tif ( geometries[ geometry.id ] === true ) return geometry;\n\n\t\tgeometry.addEventListener( 'dispose', onGeometryDispose );\n\n\t\tgeometries[ geometry.id ] = true;\n\n\t\tinfo.memory.geometries ++;\n\n\t\treturn geometry;\n\n\t}\n\n\tfunction update( geometry ) {\n\n\t\tconst geometryAttributes = geometry.attributes;\n\n\t\t// Updating index buffer in VAO now. See WebGLBindingStates.\n\n\t\tfor ( const name in geometryAttributes ) {\n\n\t\t\tattributes.update( geometryAttributes[ name ], 34962 );\n\n\t\t}\n\n\t\t// morph targets\n\n\t\tconst morphAttributes = geometry.morphAttributes;\n\n\t\tfor ( const name in morphAttributes ) {\n\n\t\t\tconst array = morphAttributes[ name ];\n\n\t\t\tfor ( let i = 0, l = array.length; i < l; i ++ ) {\n\n\t\t\t\tattributes.update( array[ i ], 34962 );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tfunction updateWireframeAttribute( geometry ) {\n\n\t\tconst indices = [];\n\n\t\tconst geometryIndex = geometry.index;\n\t\tconst geometryPosition = geometry.attributes.position;\n\t\tlet version = 0;\n\n\t\tif ( geometryIndex !== null ) {\n\n\t\t\tconst array = geometryIndex.array;\n\t\t\tversion = geometryIndex.version;\n\n\t\t\tfor ( let i = 0, l = array.length; i < l; i += 3 ) {\n\n\t\t\t\tconst a = array[ i + 0 ];\n\t\t\t\tconst b = array[ i + 1 ];\n\t\t\t\tconst c = array[ i + 2 ];\n\n\t\t\t\tindices.push( a, b, b, c, c, a );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconst array = geometryPosition.array;\n\t\t\tversion = geometryPosition.version;\n\n\t\t\tfor ( let i = 0, l = ( array.length / 3 ) - 1; i < l; i += 3 ) {\n\n\t\t\t\tconst a = i + 0;\n\t\t\t\tconst b = i + 1;\n\t\t\t\tconst c = i + 2;\n\n\t\t\t\tindices.push( a, b, b, c, c, a );\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst attribute = new ( arrayNeedsUint32( indices ) ? Uint32BufferAttribute : Uint16BufferAttribute )( indices, 1 );\n\t\tattribute.version = version;\n\n\t\t// Updating index buffer in VAO now. See WebGLBindingStates\n\n\t\t//\n\n\t\tconst previousAttribute = wireframeAttributes.get( geometry );\n\n\t\tif ( previousAttribute ) attributes.remove( previousAttribute );\n\n\t\t//\n\n\t\twireframeAttributes.set( geometry, attribute );\n\n\t}\n\n\tfunction getWireframeAttribute( geometry ) {\n\n\t\tconst currentAttribute = wireframeAttributes.get( geometry );\n\n\t\tif ( currentAttribute ) {\n\n\t\t\tconst geometryIndex = geometry.index;\n\n\t\t\tif ( geometryIndex !== null ) {\n\n\t\t\t\t// if the attribute is obsolete, create a new one\n\n\t\t\t\tif ( currentAttribute.version < geometryIndex.version ) {\n\n\t\t\t\t\tupdateWireframeAttribute( geometry );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tupdateWireframeAttribute( geometry );\n\n\t\t}\n\n\t\treturn wireframeAttributes.get( geometry );\n\n\t}\n\n\treturn {\n\n\t\tget: get,\n\t\tupdate: update,\n\n\t\tgetWireframeAttribute: getWireframeAttribute\n\n\t};\n\n}\n\nfunction WebGLIndexedBufferRenderer( gl, extensions, info, capabilities ) {\n\n\tconst isWebGL2 = capabilities.isWebGL2;\n\n\tlet mode;\n\n\tfunction setMode( value ) {\n\n\t\tmode = value;\n\n\t}\n\n\tlet type, bytesPerElement;\n\n\tfunction setIndex( value ) {\n\n\t\ttype = value.type;\n\t\tbytesPerElement = value.bytesPerElement;\n\n\t}\n\n\tfunction render( start, count ) {\n\n\t\tgl.drawElements( mode, count, type, start * bytesPerElement );\n\n\t\tinfo.update( count, mode, 1 );\n\n\t}\n\n\tfunction renderInstances( start, count, primcount ) {\n\n\t\tif ( primcount === 0 ) return;\n\n\t\tlet extension, methodName;\n\n\t\tif ( isWebGL2 ) {\n\n\t\t\textension = gl;\n\t\t\tmethodName = 'drawElementsInstanced';\n\n\t\t} else {\n\n\t\t\textension = extensions.get( 'ANGLE_instanced_arrays' );\n\t\t\tmethodName = 'drawElementsInstancedANGLE';\n\n\t\t\tif ( extension === null ) {\n\n\t\t\t\tconsole.error( 'THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.' );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t}\n\n\t\textension[ methodName ]( mode, count, type, start * bytesPerElement, primcount );\n\n\t\tinfo.update( count, mode, primcount );\n\n\t}\n\n\t//\n\n\tthis.setMode = setMode;\n\tthis.setIndex = setIndex;\n\tthis.render = render;\n\tthis.renderInstances = renderInstances;\n\n}\n\nfunction WebGLInfo( gl ) {\n\n\tconst memory = {\n\t\tgeometries: 0,\n\t\ttextures: 0\n\t};\n\n\tconst render = {\n\t\tframe: 0,\n\t\tcalls: 0,\n\t\ttriangles: 0,\n\t\tpoints: 0,\n\t\tlines: 0\n\t};\n\n\tfunction update( count, mode, instanceCount ) {\n\n\t\trender.calls ++;\n\n\t\tswitch ( mode ) {\n\n\t\t\tcase 4:\n\t\t\t\trender.triangles += instanceCount * ( count / 3 );\n\t\t\t\tbreak;\n\n\t\t\tcase 1:\n\t\t\t\trender.lines += instanceCount * ( count / 2 );\n\t\t\t\tbreak;\n\n\t\t\tcase 3:\n\t\t\t\trender.lines += instanceCount * ( count - 1 );\n\t\t\t\tbreak;\n\n\t\t\tcase 2:\n\t\t\t\trender.lines += instanceCount * count;\n\t\t\t\tbreak;\n\n\t\t\tcase 0:\n\t\t\t\trender.points += instanceCount * count;\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tconsole.error( 'THREE.WebGLInfo: Unknown draw mode:', mode );\n\t\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\tfunction reset() {\n\n\t\trender.frame ++;\n\t\trender.calls = 0;\n\t\trender.triangles = 0;\n\t\trender.points = 0;\n\t\trender.lines = 0;\n\n\t}\n\n\treturn {\n\t\tmemory: memory,\n\t\trender: render,\n\t\tprograms: null,\n\t\tautoReset: true,\n\t\treset: reset,\n\t\tupdate: update\n\t};\n\n}\n\nfunction numericalSort( a, b ) {\n\n\treturn a[ 0 ] - b[ 0 ];\n\n}\n\nfunction absNumericalSort( a, b ) {\n\n\treturn Math.abs( b[ 1 ] ) - Math.abs( a[ 1 ] );\n\n}\n\nfunction WebGLMorphtargets( gl, capabilities, textures ) {\n\n\tconst influencesList = {};\n\tconst morphInfluences = new Float32Array( 8 );\n\tconst morphTextures = new WeakMap();\n\tconst morph = new Vector4();\n\n\tconst workInfluences = [];\n\n\tfor ( let i = 0; i < 8; i ++ ) {\n\n\t\tworkInfluences[ i ] = [ i, 0 ];\n\n\t}\n\n\tfunction update( object, geometry, material, program ) {\n\n\t\tconst objectInfluences = object.morphTargetInfluences;\n\n\t\tif ( capabilities.isWebGL2 === true ) {\n\n\t\t\t// instead of using attributes, the WebGL 2 code path encodes morph targets\n\t\t\t// into an array of data textures. Each layer represents a single morph target.\n\n\t\t\tconst morphAttribute = geometry.morphAttributes.position || geometry.morphAttributes.normal || geometry.morphAttributes.color;\n\t\t\tconst morphTargetsCount = ( morphAttribute !== undefined ) ? morphAttribute.length : 0;\n\n\t\t\tlet entry = morphTextures.get( geometry );\n\n\t\t\tif ( entry === undefined || entry.count !== morphTargetsCount ) {\n\n\t\t\t\tif ( entry !== undefined ) entry.texture.dispose();\n\n\t\t\t\tconst hasMorphPosition = geometry.morphAttributes.position !== undefined;\n\t\t\t\tconst hasMorphNormals = geometry.morphAttributes.normal !== undefined;\n\t\t\t\tconst hasMorphColors = geometry.morphAttributes.color !== undefined;\n\n\t\t\t\tconst morphTargets = geometry.morphAttributes.position || [];\n\t\t\t\tconst morphNormals = geometry.morphAttributes.normal || [];\n\t\t\t\tconst morphColors = geometry.morphAttributes.color || [];\n\n\t\t\t\tlet vertexDataCount = 0;\n\n\t\t\t\tif ( hasMorphPosition === true ) vertexDataCount = 1;\n\t\t\t\tif ( hasMorphNormals === true ) vertexDataCount = 2;\n\t\t\t\tif ( hasMorphColors === true ) vertexDataCount = 3;\n\n\t\t\t\tlet width = geometry.attributes.position.count * vertexDataCount;\n\t\t\t\tlet height = 1;\n\n\t\t\t\tif ( width > capabilities.maxTextureSize ) {\n\n\t\t\t\t\theight = Math.ceil( width / capabilities.maxTextureSize );\n\t\t\t\t\twidth = capabilities.maxTextureSize;\n\n\t\t\t\t}\n\n\t\t\t\tconst buffer = new Float32Array( width * height * 4 * morphTargetsCount );\n\n\t\t\t\tconst texture = new DataArrayTexture( buffer, width, height, morphTargetsCount );\n\t\t\t\ttexture.type = FloatType;\n\t\t\t\ttexture.needsUpdate = true;\n\n\t\t\t\t// fill buffer\n\n\t\t\t\tconst vertexDataStride = vertexDataCount * 4;\n\n\t\t\t\tfor ( let i = 0; i < morphTargetsCount; i ++ ) {\n\n\t\t\t\t\tconst morphTarget = morphTargets[ i ];\n\t\t\t\t\tconst morphNormal = morphNormals[ i ];\n\t\t\t\t\tconst morphColor = morphColors[ i ];\n\n\t\t\t\t\tconst offset = width * height * 4 * i;\n\n\t\t\t\t\tfor ( let j = 0; j < morphTarget.count; j ++ ) {\n\n\t\t\t\t\t\tconst stride = j * vertexDataStride;\n\n\t\t\t\t\t\tif ( hasMorphPosition === true ) {\n\n\t\t\t\t\t\t\tmorph.fromBufferAttribute( morphTarget, j );\n\n\t\t\t\t\t\t\tbuffer[ offset + stride + 0 ] = morph.x;\n\t\t\t\t\t\t\tbuffer[ offset + stride + 1 ] = morph.y;\n\t\t\t\t\t\t\tbuffer[ offset + stride + 2 ] = morph.z;\n\t\t\t\t\t\t\tbuffer[ offset + stride + 3 ] = 0;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( hasMorphNormals === true ) {\n\n\t\t\t\t\t\t\tmorph.fromBufferAttribute( morphNormal, j );\n\n\t\t\t\t\t\t\tbuffer[ offset + stride + 4 ] = morph.x;\n\t\t\t\t\t\t\tbuffer[ offset + stride + 5 ] = morph.y;\n\t\t\t\t\t\t\tbuffer[ offset + stride + 6 ] = morph.z;\n\t\t\t\t\t\t\tbuffer[ offset + stride + 7 ] = 0;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( hasMorphColors === true ) {\n\n\t\t\t\t\t\t\tmorph.fromBufferAttribute( morphColor, j );\n\n\t\t\t\t\t\t\tbuffer[ offset + stride + 8 ] = morph.x;\n\t\t\t\t\t\t\tbuffer[ offset + stride + 9 ] = morph.y;\n\t\t\t\t\t\t\tbuffer[ offset + stride + 10 ] = morph.z;\n\t\t\t\t\t\t\tbuffer[ offset + stride + 11 ] = ( morphColor.itemSize === 4 ) ? morph.w : 1;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tentry = {\n\t\t\t\t\tcount: morphTargetsCount,\n\t\t\t\t\ttexture: texture,\n\t\t\t\t\tsize: new Vector2( width, height )\n\t\t\t\t};\n\n\t\t\t\tmorphTextures.set( geometry, entry );\n\n\t\t\t\tfunction disposeTexture() {\n\n\t\t\t\t\ttexture.dispose();\n\n\t\t\t\t\tmorphTextures.delete( geometry );\n\n\t\t\t\t\tgeometry.removeEventListener( 'dispose', disposeTexture );\n\n\t\t\t\t}\n\n\t\t\t\tgeometry.addEventListener( 'dispose', disposeTexture );\n\n\t\t\t}\n\n\t\t\t//\n\n\t\t\tlet morphInfluencesSum = 0;\n\n\t\t\tfor ( let i = 0; i < objectInfluences.length; i ++ ) {\n\n\t\t\t\tmorphInfluencesSum += objectInfluences[ i ];\n\n\t\t\t}\n\n\t\t\tconst morphBaseInfluence = geometry.morphTargetsRelative ? 1 : 1 - morphInfluencesSum;\n\n\t\t\tprogram.getUniforms().setValue( gl, 'morphTargetBaseInfluence', morphBaseInfluence );\n\t\t\tprogram.getUniforms().setValue( gl, 'morphTargetInfluences', objectInfluences );\n\n\t\t\tprogram.getUniforms().setValue( gl, 'morphTargetsTexture', entry.texture, textures );\n\t\t\tprogram.getUniforms().setValue( gl, 'morphTargetsTextureSize', entry.size );\n\n\n\t\t} else {\n\n\t\t\t// When object doesn't have morph target influences defined, we treat it as a 0-length array\n\t\t\t// This is important to make sure we set up morphTargetBaseInfluence / morphTargetInfluences\n\n\t\t\tconst length = objectInfluences === undefined ? 0 : objectInfluences.length;\n\n\t\t\tlet influences = influencesList[ geometry.id ];\n\n\t\t\tif ( influences === undefined || influences.length !== length ) {\n\n\t\t\t\t// initialise list\n\n\t\t\t\tinfluences = [];\n\n\t\t\t\tfor ( let i = 0; i < length; i ++ ) {\n\n\t\t\t\t\tinfluences[ i ] = [ i, 0 ];\n\n\t\t\t\t}\n\n\t\t\t\tinfluencesList[ geometry.id ] = influences;\n\n\t\t\t}\n\n\t\t\t// Collect influences\n\n\t\t\tfor ( let i = 0; i < length; i ++ ) {\n\n\t\t\t\tconst influence = influences[ i ];\n\n\t\t\t\tinfluence[ 0 ] = i;\n\t\t\t\tinfluence[ 1 ] = objectInfluences[ i ];\n\n\t\t\t}\n\n\t\t\tinfluences.sort( absNumericalSort );\n\n\t\t\tfor ( let i = 0; i < 8; i ++ ) {\n\n\t\t\t\tif ( i < length && influences[ i ][ 1 ] ) {\n\n\t\t\t\t\tworkInfluences[ i ][ 0 ] = influences[ i ][ 0 ];\n\t\t\t\t\tworkInfluences[ i ][ 1 ] = influences[ i ][ 1 ];\n\n\t\t\t\t} else {\n\n\t\t\t\t\tworkInfluences[ i ][ 0 ] = Number.MAX_SAFE_INTEGER;\n\t\t\t\t\tworkInfluences[ i ][ 1 ] = 0;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tworkInfluences.sort( numericalSort );\n\n\t\t\tconst morphTargets = geometry.morphAttributes.position;\n\t\t\tconst morphNormals = geometry.morphAttributes.normal;\n\n\t\t\tlet morphInfluencesSum = 0;\n\n\t\t\tfor ( let i = 0; i < 8; i ++ ) {\n\n\t\t\t\tconst influence = workInfluences[ i ];\n\t\t\t\tconst index = influence[ 0 ];\n\t\t\t\tconst value = influence[ 1 ];\n\n\t\t\t\tif ( index !== Number.MAX_SAFE_INTEGER && value ) {\n\n\t\t\t\t\tif ( morphTargets && geometry.getAttribute( 'morphTarget' + i ) !== morphTargets[ index ] ) {\n\n\t\t\t\t\t\tgeometry.setAttribute( 'morphTarget' + i, morphTargets[ index ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( morphNormals && geometry.getAttribute( 'morphNormal' + i ) !== morphNormals[ index ] ) {\n\n\t\t\t\t\t\tgeometry.setAttribute( 'morphNormal' + i, morphNormals[ index ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tmorphInfluences[ i ] = value;\n\t\t\t\t\tmorphInfluencesSum += value;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( morphTargets && geometry.hasAttribute( 'morphTarget' + i ) === true ) {\n\n\t\t\t\t\t\tgeometry.deleteAttribute( 'morphTarget' + i );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( morphNormals && geometry.hasAttribute( 'morphNormal' + i ) === true ) {\n\n\t\t\t\t\t\tgeometry.deleteAttribute( 'morphNormal' + i );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tmorphInfluences[ i ] = 0;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// GLSL shader uses formula baseinfluence * base + sum(target * influence)\n\t\t\t// This allows us to switch between absolute morphs and relative morphs without changing shader code\n\t\t\t// When baseinfluence = 1 - sum(influence), the above is equivalent to sum((target - base) * influence)\n\t\t\tconst morphBaseInfluence = geometry.morphTargetsRelative ? 1 : 1 - morphInfluencesSum;\n\n\t\t\tprogram.getUniforms().setValue( gl, 'morphTargetBaseInfluence', morphBaseInfluence );\n\t\t\tprogram.getUniforms().setValue( gl, 'morphTargetInfluences', morphInfluences );\n\n\t\t}\n\n\t}\n\n\treturn {\n\n\t\tupdate: update\n\n\t};\n\n}\n\nfunction WebGLObjects( gl, geometries, attributes, info ) {\n\n\tlet updateMap = new WeakMap();\n\n\tfunction update( object ) {\n\n\t\tconst frame = info.render.frame;\n\n\t\tconst geometry = object.geometry;\n\t\tconst buffergeometry = geometries.get( object, geometry );\n\n\t\t// Update once per frame\n\n\t\tif ( updateMap.get( buffergeometry ) !== frame ) {\n\n\t\t\tgeometries.update( buffergeometry );\n\n\t\t\tupdateMap.set( buffergeometry, frame );\n\n\t\t}\n\n\t\tif ( object.isInstancedMesh ) {\n\n\t\t\tif ( object.hasEventListener( 'dispose', onInstancedMeshDispose ) === false ) {\n\n\t\t\t\tobject.addEventListener( 'dispose', onInstancedMeshDispose );\n\n\t\t\t}\n\n\t\t\tattributes.update( object.instanceMatrix, 34962 );\n\n\t\t\tif ( object.instanceColor !== null ) {\n\n\t\t\t\tattributes.update( object.instanceColor, 34962 );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn buffergeometry;\n\n\t}\n\n\tfunction dispose() {\n\n\t\tupdateMap = new WeakMap();\n\n\t}\n\n\tfunction onInstancedMeshDispose( event ) {\n\n\t\tconst instancedMesh = event.target;\n\n\t\tinstancedMesh.removeEventListener( 'dispose', onInstancedMeshDispose );\n\n\t\tattributes.remove( instancedMesh.instanceMatrix );\n\n\t\tif ( instancedMesh.instanceColor !== null ) attributes.remove( instancedMesh.instanceColor );\n\n\t}\n\n\treturn {\n\n\t\tupdate: update,\n\t\tdispose: dispose\n\n\t};\n\n}\n\n/**\n * Uniforms of a program.\n * Those form a tree structure with a special top-level container for the root,\n * which you get by calling 'new WebGLUniforms( gl, program )'.\n *\n *\n * Properties of inner nodes including the top-level container:\n *\n * .seq - array of nested uniforms\n * .map - nested uniforms by name\n *\n *\n * Methods of all nodes except the top-level container:\n *\n * .setValue( gl, value, [textures] )\n *\n * \t\tuploads a uniform value(s)\n *  \tthe 'textures' parameter is needed for sampler uniforms\n *\n *\n * Static methods of the top-level container (textures factorizations):\n *\n * .upload( gl, seq, values, textures )\n *\n * \t\tsets uniforms in 'seq' to 'values[id].value'\n *\n * .seqWithValue( seq, values ) : filteredSeq\n *\n * \t\tfilters 'seq' entries with corresponding entry in values\n *\n *\n * Methods of the top-level container (textures factorizations):\n *\n * .setValue( gl, name, value, textures )\n *\n * \t\tsets uniform with  name 'name' to 'value'\n *\n * .setOptional( gl, obj, prop )\n *\n * \t\tlike .set for an optional property of the object\n *\n */\n\nconst emptyTexture = /*@__PURE__*/ new Texture();\nconst emptyArrayTexture = /*@__PURE__*/ new DataArrayTexture();\nconst empty3dTexture = /*@__PURE__*/ new Data3DTexture();\nconst emptyCubeTexture = /*@__PURE__*/ new CubeTexture();\n\n// --- Utilities ---\n\n// Array Caches (provide typed arrays for temporary by size)\n\nconst arrayCacheF32 = [];\nconst arrayCacheI32 = [];\n\n// Float32Array caches used for uploading Matrix uniforms\n\nconst mat4array = new Float32Array( 16 );\nconst mat3array = new Float32Array( 9 );\nconst mat2array = new Float32Array( 4 );\n\n// Flattening for arrays of vectors and matrices\n\nfunction flatten( array, nBlocks, blockSize ) {\n\n\tconst firstElem = array[ 0 ];\n\n\tif ( firstElem <= 0 || firstElem > 0 ) return array;\n\t// unoptimized: ! isNaN( firstElem )\n\t// see http://jacksondunstan.com/articles/983\n\n\tconst n = nBlocks * blockSize;\n\tlet r = arrayCacheF32[ n ];\n\n\tif ( r === undefined ) {\n\n\t\tr = new Float32Array( n );\n\t\tarrayCacheF32[ n ] = r;\n\n\t}\n\n\tif ( nBlocks !== 0 ) {\n\n\t\tfirstElem.toArray( r, 0 );\n\n\t\tfor ( let i = 1, offset = 0; i !== nBlocks; ++ i ) {\n\n\t\t\toffset += blockSize;\n\t\t\tarray[ i ].toArray( r, offset );\n\n\t\t}\n\n\t}\n\n\treturn r;\n\n}\n\nfunction arraysEqual( a, b ) {\n\n\tif ( a.length !== b.length ) return false;\n\n\tfor ( let i = 0, l = a.length; i < l; i ++ ) {\n\n\t\tif ( a[ i ] !== b[ i ] ) return false;\n\n\t}\n\n\treturn true;\n\n}\n\nfunction copyArray( a, b ) {\n\n\tfor ( let i = 0, l = b.length; i < l; i ++ ) {\n\n\t\ta[ i ] = b[ i ];\n\n\t}\n\n}\n\n// Texture unit allocation\n\nfunction allocTexUnits( textures, n ) {\n\n\tlet r = arrayCacheI32[ n ];\n\n\tif ( r === undefined ) {\n\n\t\tr = new Int32Array( n );\n\t\tarrayCacheI32[ n ] = r;\n\n\t}\n\n\tfor ( let i = 0; i !== n; ++ i ) {\n\n\t\tr[ i ] = textures.allocateTextureUnit();\n\n\t}\n\n\treturn r;\n\n}\n\n// --- Setters ---\n\n// Note: Defining these methods externally, because they come in a bunch\n// and this way their names minify.\n\n// Single scalar\n\nfunction setValueV1f( gl, v ) {\n\n\tconst cache = this.cache;\n\n\tif ( cache[ 0 ] === v ) return;\n\n\tgl.uniform1f( this.addr, v );\n\n\tcache[ 0 ] = v;\n\n}\n\n// Single float vector (from flat array or THREE.VectorN)\n\nfunction setValueV2f( gl, v ) {\n\n\tconst cache = this.cache;\n\n\tif ( v.x !== undefined ) {\n\n\t\tif ( cache[ 0 ] !== v.x || cache[ 1 ] !== v.y ) {\n\n\t\t\tgl.uniform2f( this.addr, v.x, v.y );\n\n\t\t\tcache[ 0 ] = v.x;\n\t\t\tcache[ 1 ] = v.y;\n\n\t\t}\n\n\t} else {\n\n\t\tif ( arraysEqual( cache, v ) ) return;\n\n\t\tgl.uniform2fv( this.addr, v );\n\n\t\tcopyArray( cache, v );\n\n\t}\n\n}\n\nfunction setValueV3f( gl, v ) {\n\n\tconst cache = this.cache;\n\n\tif ( v.x !== undefined ) {\n\n\t\tif ( cache[ 0 ] !== v.x || cache[ 1 ] !== v.y || cache[ 2 ] !== v.z ) {\n\n\t\t\tgl.uniform3f( this.addr, v.x, v.y, v.z );\n\n\t\t\tcache[ 0 ] = v.x;\n\t\t\tcache[ 1 ] = v.y;\n\t\t\tcache[ 2 ] = v.z;\n\n\t\t}\n\n\t} else if ( v.r !== undefined ) {\n\n\t\tif ( cache[ 0 ] !== v.r || cache[ 1 ] !== v.g || cache[ 2 ] !== v.b ) {\n\n\t\t\tgl.uniform3f( this.addr, v.r, v.g, v.b );\n\n\t\t\tcache[ 0 ] = v.r;\n\t\t\tcache[ 1 ] = v.g;\n\t\t\tcache[ 2 ] = v.b;\n\n\t\t}\n\n\t} else {\n\n\t\tif ( arraysEqual( cache, v ) ) return;\n\n\t\tgl.uniform3fv( this.addr, v );\n\n\t\tcopyArray( cache, v );\n\n\t}\n\n}\n\nfunction setValueV4f( gl, v ) {\n\n\tconst cache = this.cache;\n\n\tif ( v.x !== undefined ) {\n\n\t\tif ( cache[ 0 ] !== v.x || cache[ 1 ] !== v.y || cache[ 2 ] !== v.z || cache[ 3 ] !== v.w ) {\n\n\t\t\tgl.uniform4f( this.addr, v.x, v.y, v.z, v.w );\n\n\t\t\tcache[ 0 ] = v.x;\n\t\t\tcache[ 1 ] = v.y;\n\t\t\tcache[ 2 ] = v.z;\n\t\t\tcache[ 3 ] = v.w;\n\n\t\t}\n\n\t} else {\n\n\t\tif ( arraysEqual( cache, v ) ) return;\n\n\t\tgl.uniform4fv( this.addr, v );\n\n\t\tcopyArray( cache, v );\n\n\t}\n\n}\n\n// Single matrix (from flat array or THREE.MatrixN)\n\nfunction setValueM2( gl, v ) {\n\n\tconst cache = this.cache;\n\tconst elements = v.elements;\n\n\tif ( elements === undefined ) {\n\n\t\tif ( arraysEqual( cache, v ) ) return;\n\n\t\tgl.uniformMatrix2fv( this.addr, false, v );\n\n\t\tcopyArray( cache, v );\n\n\t} else {\n\n\t\tif ( arraysEqual( cache, elements ) ) return;\n\n\t\tmat2array.set( elements );\n\n\t\tgl.uniformMatrix2fv( this.addr, false, mat2array );\n\n\t\tcopyArray( cache, elements );\n\n\t}\n\n}\n\nfunction setValueM3( gl, v ) {\n\n\tconst cache = this.cache;\n\tconst elements = v.elements;\n\n\tif ( elements === undefined ) {\n\n\t\tif ( arraysEqual( cache, v ) ) return;\n\n\t\tgl.uniformMatrix3fv( this.addr, false, v );\n\n\t\tcopyArray( cache, v );\n\n\t} else {\n\n\t\tif ( arraysEqual( cache, elements ) ) return;\n\n\t\tmat3array.set( elements );\n\n\t\tgl.uniformMatrix3fv( this.addr, false, mat3array );\n\n\t\tcopyArray( cache, elements );\n\n\t}\n\n}\n\nfunction setValueM4( gl, v ) {\n\n\tconst cache = this.cache;\n\tconst elements = v.elements;\n\n\tif ( elements === undefined ) {\n\n\t\tif ( arraysEqual( cache, v ) ) return;\n\n\t\tgl.uniformMatrix4fv( this.addr, false, v );\n\n\t\tcopyArray( cache, v );\n\n\t} else {\n\n\t\tif ( arraysEqual( cache, elements ) ) return;\n\n\t\tmat4array.set( elements );\n\n\t\tgl.uniformMatrix4fv( this.addr, false, mat4array );\n\n\t\tcopyArray( cache, elements );\n\n\t}\n\n}\n\n// Single integer / boolean\n\nfunction setValueV1i( gl, v ) {\n\n\tconst cache = this.cache;\n\n\tif ( cache[ 0 ] === v ) return;\n\n\tgl.uniform1i( this.addr, v );\n\n\tcache[ 0 ] = v;\n\n}\n\n// Single integer / boolean vector (from flat array or THREE.VectorN)\n\nfunction setValueV2i( gl, v ) {\n\n\tconst cache = this.cache;\n\n\tif ( v.x !== undefined ) {\n\n\t\tif ( cache[ 0 ] !== v.x || cache[ 1 ] !== v.y ) {\n\n\t\t\tgl.uniform2i( this.addr, v.x, v.y );\n\n\t\t\tcache[ 0 ] = v.x;\n\t\t\tcache[ 1 ] = v.y;\n\n\t\t}\n\n\t} else {\n\n\t\tif ( arraysEqual( cache, v ) ) return;\n\n\t\tgl.uniform2iv( this.addr, v );\n\n\t\tcopyArray( cache, v );\n\n\t}\n\n}\n\nfunction setValueV3i( gl, v ) {\n\n\tconst cache = this.cache;\n\n\tif ( v.x !== undefined ) {\n\n\t\tif ( cache[ 0 ] !== v.x || cache[ 1 ] !== v.y || cache[ 2 ] !== v.z ) {\n\n\t\t\tgl.uniform3i( this.addr, v.x, v.y, v.z );\n\n\t\t\tcache[ 0 ] = v.x;\n\t\t\tcache[ 1 ] = v.y;\n\t\t\tcache[ 2 ] = v.z;\n\n\t\t}\n\n\t} else {\n\n\t\tif ( arraysEqual( cache, v ) ) return;\n\n\t\tgl.uniform3iv( this.addr, v );\n\n\t\tcopyArray( cache, v );\n\n\t}\n\n}\n\nfunction setValueV4i( gl, v ) {\n\n\tconst cache = this.cache;\n\n\tif ( v.x !== undefined ) {\n\n\t\tif ( cache[ 0 ] !== v.x || cache[ 1 ] !== v.y || cache[ 2 ] !== v.z || cache[ 3 ] !== v.w ) {\n\n\t\t\tgl.uniform4i( this.addr, v.x, v.y, v.z, v.w );\n\n\t\t\tcache[ 0 ] = v.x;\n\t\t\tcache[ 1 ] = v.y;\n\t\t\tcache[ 2 ] = v.z;\n\t\t\tcache[ 3 ] = v.w;\n\n\t\t}\n\n\t} else {\n\n\t\tif ( arraysEqual( cache, v ) ) return;\n\n\t\tgl.uniform4iv( this.addr, v );\n\n\t\tcopyArray( cache, v );\n\n\t}\n\n}\n\n// Single unsigned integer\n\nfunction setValueV1ui( gl, v ) {\n\n\tconst cache = this.cache;\n\n\tif ( cache[ 0 ] === v ) return;\n\n\tgl.uniform1ui( this.addr, v );\n\n\tcache[ 0 ] = v;\n\n}\n\n// Single unsigned integer vector (from flat array or THREE.VectorN)\n\nfunction setValueV2ui( gl, v ) {\n\n\tconst cache = this.cache;\n\n\tif ( v.x !== undefined ) {\n\n\t\tif ( cache[ 0 ] !== v.x || cache[ 1 ] !== v.y ) {\n\n\t\t\tgl.uniform2ui( this.addr, v.x, v.y );\n\n\t\t\tcache[ 0 ] = v.x;\n\t\t\tcache[ 1 ] = v.y;\n\n\t\t}\n\n\t} else {\n\n\t\tif ( arraysEqual( cache, v ) ) return;\n\n\t\tgl.uniform2uiv( this.addr, v );\n\n\t\tcopyArray( cache, v );\n\n\t}\n\n}\n\nfunction setValueV3ui( gl, v ) {\n\n\tconst cache = this.cache;\n\n\tif ( v.x !== undefined ) {\n\n\t\tif ( cache[ 0 ] !== v.x || cache[ 1 ] !== v.y || cache[ 2 ] !== v.z ) {\n\n\t\t\tgl.uniform3ui( this.addr, v.x, v.y, v.z );\n\n\t\t\tcache[ 0 ] = v.x;\n\t\t\tcache[ 1 ] = v.y;\n\t\t\tcache[ 2 ] = v.z;\n\n\t\t}\n\n\t} else {\n\n\t\tif ( arraysEqual( cache, v ) ) return;\n\n\t\tgl.uniform3uiv( this.addr, v );\n\n\t\tcopyArray( cache, v );\n\n\t}\n\n}\n\nfunction setValueV4ui( gl, v ) {\n\n\tconst cache = this.cache;\n\n\tif ( v.x !== undefined ) {\n\n\t\tif ( cache[ 0 ] !== v.x || cache[ 1 ] !== v.y || cache[ 2 ] !== v.z || cache[ 3 ] !== v.w ) {\n\n\t\t\tgl.uniform4ui( this.addr, v.x, v.y, v.z, v.w );\n\n\t\t\tcache[ 0 ] = v.x;\n\t\t\tcache[ 1 ] = v.y;\n\t\t\tcache[ 2 ] = v.z;\n\t\t\tcache[ 3 ] = v.w;\n\n\t\t}\n\n\t} else {\n\n\t\tif ( arraysEqual( cache, v ) ) return;\n\n\t\tgl.uniform4uiv( this.addr, v );\n\n\t\tcopyArray( cache, v );\n\n\t}\n\n}\n\n\n// Single texture (2D / Cube)\n\nfunction setValueT1( gl, v, textures ) {\n\n\tconst cache = this.cache;\n\tconst unit = textures.allocateTextureUnit();\n\n\tif ( cache[ 0 ] !== unit ) {\n\n\t\tgl.uniform1i( this.addr, unit );\n\t\tcache[ 0 ] = unit;\n\n\t}\n\n\ttextures.setTexture2D( v || emptyTexture, unit );\n\n}\n\nfunction setValueT3D1( gl, v, textures ) {\n\n\tconst cache = this.cache;\n\tconst unit = textures.allocateTextureUnit();\n\n\tif ( cache[ 0 ] !== unit ) {\n\n\t\tgl.uniform1i( this.addr, unit );\n\t\tcache[ 0 ] = unit;\n\n\t}\n\n\ttextures.setTexture3D( v || empty3dTexture, unit );\n\n}\n\nfunction setValueT6( gl, v, textures ) {\n\n\tconst cache = this.cache;\n\tconst unit = textures.allocateTextureUnit();\n\n\tif ( cache[ 0 ] !== unit ) {\n\n\t\tgl.uniform1i( this.addr, unit );\n\t\tcache[ 0 ] = unit;\n\n\t}\n\n\ttextures.setTextureCube( v || emptyCubeTexture, unit );\n\n}\n\nfunction setValueT2DArray1( gl, v, textures ) {\n\n\tconst cache = this.cache;\n\tconst unit = textures.allocateTextureUnit();\n\n\tif ( cache[ 0 ] !== unit ) {\n\n\t\tgl.uniform1i( this.addr, unit );\n\t\tcache[ 0 ] = unit;\n\n\t}\n\n\ttextures.setTexture2DArray( v || emptyArrayTexture, unit );\n\n}\n\n// Helper to pick the right setter for the singular case\n\nfunction getSingularSetter( type ) {\n\n\tswitch ( type ) {\n\n\t\tcase 0x1406: return setValueV1f; // FLOAT\n\t\tcase 0x8b50: return setValueV2f; // _VEC2\n\t\tcase 0x8b51: return setValueV3f; // _VEC3\n\t\tcase 0x8b52: return setValueV4f; // _VEC4\n\n\t\tcase 0x8b5a: return setValueM2; // _MAT2\n\t\tcase 0x8b5b: return setValueM3; // _MAT3\n\t\tcase 0x8b5c: return setValueM4; // _MAT4\n\n\t\tcase 0x1404: case 0x8b56: return setValueV1i; // INT, BOOL\n\t\tcase 0x8b53: case 0x8b57: return setValueV2i; // _VEC2\n\t\tcase 0x8b54: case 0x8b58: return setValueV3i; // _VEC3\n\t\tcase 0x8b55: case 0x8b59: return setValueV4i; // _VEC4\n\n\t\tcase 0x1405: return setValueV1ui; // UINT\n\t\tcase 0x8dc6: return setValueV2ui; // _VEC2\n\t\tcase 0x8dc7: return setValueV3ui; // _VEC3\n\t\tcase 0x8dc8: return setValueV4ui; // _VEC4\n\n\t\tcase 0x8b5e: // SAMPLER_2D\n\t\tcase 0x8d66: // SAMPLER_EXTERNAL_OES\n\t\tcase 0x8dca: // INT_SAMPLER_2D\n\t\tcase 0x8dd2: // UNSIGNED_INT_SAMPLER_2D\n\t\tcase 0x8b62: // SAMPLER_2D_SHADOW\n\t\t\treturn setValueT1;\n\n\t\tcase 0x8b5f: // SAMPLER_3D\n\t\tcase 0x8dcb: // INT_SAMPLER_3D\n\t\tcase 0x8dd3: // UNSIGNED_INT_SAMPLER_3D\n\t\t\treturn setValueT3D1;\n\n\t\tcase 0x8b60: // SAMPLER_CUBE\n\t\tcase 0x8dcc: // INT_SAMPLER_CUBE\n\t\tcase 0x8dd4: // UNSIGNED_INT_SAMPLER_CUBE\n\t\tcase 0x8dc5: // SAMPLER_CUBE_SHADOW\n\t\t\treturn setValueT6;\n\n\t\tcase 0x8dc1: // SAMPLER_2D_ARRAY\n\t\tcase 0x8dcf: // INT_SAMPLER_2D_ARRAY\n\t\tcase 0x8dd7: // UNSIGNED_INT_SAMPLER_2D_ARRAY\n\t\tcase 0x8dc4: // SAMPLER_2D_ARRAY_SHADOW\n\t\t\treturn setValueT2DArray1;\n\n\t}\n\n}\n\n\n// Array of scalars\n\nfunction setValueV1fArray( gl, v ) {\n\n\tgl.uniform1fv( this.addr, v );\n\n}\n\n// Array of vectors (from flat array or array of THREE.VectorN)\n\nfunction setValueV2fArray( gl, v ) {\n\n\tconst data = flatten( v, this.size, 2 );\n\n\tgl.uniform2fv( this.addr, data );\n\n}\n\nfunction setValueV3fArray( gl, v ) {\n\n\tconst data = flatten( v, this.size, 3 );\n\n\tgl.uniform3fv( this.addr, data );\n\n}\n\nfunction setValueV4fArray( gl, v ) {\n\n\tconst data = flatten( v, this.size, 4 );\n\n\tgl.uniform4fv( this.addr, data );\n\n}\n\n// Array of matrices (from flat array or array of THREE.MatrixN)\n\nfunction setValueM2Array( gl, v ) {\n\n\tconst data = flatten( v, this.size, 4 );\n\n\tgl.uniformMatrix2fv( this.addr, false, data );\n\n}\n\nfunction setValueM3Array( gl, v ) {\n\n\tconst data = flatten( v, this.size, 9 );\n\n\tgl.uniformMatrix3fv( this.addr, false, data );\n\n}\n\nfunction setValueM4Array( gl, v ) {\n\n\tconst data = flatten( v, this.size, 16 );\n\n\tgl.uniformMatrix4fv( this.addr, false, data );\n\n}\n\n// Array of integer / boolean\n\nfunction setValueV1iArray( gl, v ) {\n\n\tgl.uniform1iv( this.addr, v );\n\n}\n\n// Array of integer / boolean vectors (from flat array)\n\nfunction setValueV2iArray( gl, v ) {\n\n\tgl.uniform2iv( this.addr, v );\n\n}\n\nfunction setValueV3iArray( gl, v ) {\n\n\tgl.uniform3iv( this.addr, v );\n\n}\n\nfunction setValueV4iArray( gl, v ) {\n\n\tgl.uniform4iv( this.addr, v );\n\n}\n\n// Array of unsigned integer\n\nfunction setValueV1uiArray( gl, v ) {\n\n\tgl.uniform1uiv( this.addr, v );\n\n}\n\n// Array of unsigned integer vectors (from flat array)\n\nfunction setValueV2uiArray( gl, v ) {\n\n\tgl.uniform2uiv( this.addr, v );\n\n}\n\nfunction setValueV3uiArray( gl, v ) {\n\n\tgl.uniform3uiv( this.addr, v );\n\n}\n\nfunction setValueV4uiArray( gl, v ) {\n\n\tgl.uniform4uiv( this.addr, v );\n\n}\n\n\n// Array of textures (2D / 3D / Cube / 2DArray)\n\nfunction setValueT1Array( gl, v, textures ) {\n\n\tconst cache = this.cache;\n\n\tconst n = v.length;\n\n\tconst units = allocTexUnits( textures, n );\n\n\tif ( ! arraysEqual( cache, units ) ) {\n\n\t\tgl.uniform1iv( this.addr, units );\n\n\t\tcopyArray( cache, units );\n\n\t}\n\n\tfor ( let i = 0; i !== n; ++ i ) {\n\n\t\ttextures.setTexture2D( v[ i ] || emptyTexture, units[ i ] );\n\n\t}\n\n}\n\nfunction setValueT3DArray( gl, v, textures ) {\n\n\tconst cache = this.cache;\n\n\tconst n = v.length;\n\n\tconst units = allocTexUnits( textures, n );\n\n\tif ( ! arraysEqual( cache, units ) ) {\n\n\t\tgl.uniform1iv( this.addr, units );\n\n\t\tcopyArray( cache, units );\n\n\t}\n\n\tfor ( let i = 0; i !== n; ++ i ) {\n\n\t\ttextures.setTexture3D( v[ i ] || empty3dTexture, units[ i ] );\n\n\t}\n\n}\n\nfunction setValueT6Array( gl, v, textures ) {\n\n\tconst cache = this.cache;\n\n\tconst n = v.length;\n\n\tconst units = allocTexUnits( textures, n );\n\n\tif ( ! arraysEqual( cache, units ) ) {\n\n\t\tgl.uniform1iv( this.addr, units );\n\n\t\tcopyArray( cache, units );\n\n\t}\n\n\tfor ( let i = 0; i !== n; ++ i ) {\n\n\t\ttextures.setTextureCube( v[ i ] || emptyCubeTexture, units[ i ] );\n\n\t}\n\n}\n\nfunction setValueT2DArrayArray( gl, v, textures ) {\n\n\tconst cache = this.cache;\n\n\tconst n = v.length;\n\n\tconst units = allocTexUnits( textures, n );\n\n\tif ( ! arraysEqual( cache, units ) ) {\n\n\t\tgl.uniform1iv( this.addr, units );\n\n\t\tcopyArray( cache, units );\n\n\t}\n\n\tfor ( let i = 0; i !== n; ++ i ) {\n\n\t\ttextures.setTexture2DArray( v[ i ] || emptyArrayTexture, units[ i ] );\n\n\t}\n\n}\n\n\n// Helper to pick the right setter for a pure (bottom-level) array\n\nfunction getPureArraySetter( type ) {\n\n\tswitch ( type ) {\n\n\t\tcase 0x1406: return setValueV1fArray; // FLOAT\n\t\tcase 0x8b50: return setValueV2fArray; // _VEC2\n\t\tcase 0x8b51: return setValueV3fArray; // _VEC3\n\t\tcase 0x8b52: return setValueV4fArray; // _VEC4\n\n\t\tcase 0x8b5a: return setValueM2Array; // _MAT2\n\t\tcase 0x8b5b: return setValueM3Array; // _MAT3\n\t\tcase 0x8b5c: return setValueM4Array; // _MAT4\n\n\t\tcase 0x1404: case 0x8b56: return setValueV1iArray; // INT, BOOL\n\t\tcase 0x8b53: case 0x8b57: return setValueV2iArray; // _VEC2\n\t\tcase 0x8b54: case 0x8b58: return setValueV3iArray; // _VEC3\n\t\tcase 0x8b55: case 0x8b59: return setValueV4iArray; // _VEC4\n\n\t\tcase 0x1405: return setValueV1uiArray; // UINT\n\t\tcase 0x8dc6: return setValueV2uiArray; // _VEC2\n\t\tcase 0x8dc7: return setValueV3uiArray; // _VEC3\n\t\tcase 0x8dc8: return setValueV4uiArray; // _VEC4\n\n\t\tcase 0x8b5e: // SAMPLER_2D\n\t\tcase 0x8d66: // SAMPLER_EXTERNAL_OES\n\t\tcase 0x8dca: // INT_SAMPLER_2D\n\t\tcase 0x8dd2: // UNSIGNED_INT_SAMPLER_2D\n\t\tcase 0x8b62: // SAMPLER_2D_SHADOW\n\t\t\treturn setValueT1Array;\n\n\t\tcase 0x8b5f: // SAMPLER_3D\n\t\tcase 0x8dcb: // INT_SAMPLER_3D\n\t\tcase 0x8dd3: // UNSIGNED_INT_SAMPLER_3D\n\t\t\treturn setValueT3DArray;\n\n\t\tcase 0x8b60: // SAMPLER_CUBE\n\t\tcase 0x8dcc: // INT_SAMPLER_CUBE\n\t\tcase 0x8dd4: // UNSIGNED_INT_SAMPLER_CUBE\n\t\tcase 0x8dc5: // SAMPLER_CUBE_SHADOW\n\t\t\treturn setValueT6Array;\n\n\t\tcase 0x8dc1: // SAMPLER_2D_ARRAY\n\t\tcase 0x8dcf: // INT_SAMPLER_2D_ARRAY\n\t\tcase 0x8dd7: // UNSIGNED_INT_SAMPLER_2D_ARRAY\n\t\tcase 0x8dc4: // SAMPLER_2D_ARRAY_SHADOW\n\t\t\treturn setValueT2DArrayArray;\n\n\t}\n\n}\n\n// --- Uniform Classes ---\n\nclass SingleUniform {\n\n\tconstructor( id, activeInfo, addr ) {\n\n\t\tthis.id = id;\n\t\tthis.addr = addr;\n\t\tthis.cache = [];\n\t\tthis.setValue = getSingularSetter( activeInfo.type );\n\n\t\t// this.path = activeInfo.name; // DEBUG\n\n\t}\n\n}\n\nclass PureArrayUniform {\n\n\tconstructor( id, activeInfo, addr ) {\n\n\t\tthis.id = id;\n\t\tthis.addr = addr;\n\t\tthis.cache = [];\n\t\tthis.size = activeInfo.size;\n\t\tthis.setValue = getPureArraySetter( activeInfo.type );\n\n\t\t// this.path = activeInfo.name; // DEBUG\n\n\t}\n\n}\n\nclass StructuredUniform {\n\n\tconstructor( id ) {\n\n\t\tthis.id = id;\n\n\t\tthis.seq = [];\n\t\tthis.map = {};\n\n\t}\n\n\tsetValue( gl, value, textures ) {\n\n\t\tconst seq = this.seq;\n\n\t\tfor ( let i = 0, n = seq.length; i !== n; ++ i ) {\n\n\t\t\tconst u = seq[ i ];\n\t\t\tu.setValue( gl, value[ u.id ], textures );\n\n\t\t}\n\n\t}\n\n}\n\n// --- Top-level ---\n\n// Parser - builds up the property tree from the path strings\n\nconst RePathPart = /(\\w+)(\\])?(\\[|\\.)?/g;\n\n// extracts\n// \t- the identifier (member name or array index)\n//  - followed by an optional right bracket (found when array index)\n//  - followed by an optional left bracket or dot (type of subscript)\n//\n// Note: These portions can be read in a non-overlapping fashion and\n// allow straightforward parsing of the hierarchy that WebGL encodes\n// in the uniform names.\n\nfunction addUniform( container, uniformObject ) {\n\n\tcontainer.seq.push( uniformObject );\n\tcontainer.map[ uniformObject.id ] = uniformObject;\n\n}\n\nfunction parseUniform( activeInfo, addr, container ) {\n\n\tconst path = activeInfo.name,\n\t\tpathLength = path.length;\n\n\t// reset RegExp object, because of the early exit of a previous run\n\tRePathPart.lastIndex = 0;\n\n\twhile ( true ) {\n\n\t\tconst match = RePathPart.exec( path ),\n\t\t\tmatchEnd = RePathPart.lastIndex;\n\n\t\tlet id = match[ 1 ];\n\t\tconst idIsIndex = match[ 2 ] === ']',\n\t\t\tsubscript = match[ 3 ];\n\n\t\tif ( idIsIndex ) id = id | 0; // convert to integer\n\n\t\tif ( subscript === undefined || subscript === '[' && matchEnd + 2 === pathLength ) {\n\n\t\t\t// bare name or \"pure\" bottom-level array \"[0]\" suffix\n\n\t\t\taddUniform( container, subscript === undefined ?\n\t\t\t\tnew SingleUniform( id, activeInfo, addr ) :\n\t\t\t\tnew PureArrayUniform( id, activeInfo, addr ) );\n\n\t\t\tbreak;\n\n\t\t} else {\n\n\t\t\t// step into inner node / create it in case it doesn't exist\n\n\t\t\tconst map = container.map;\n\t\t\tlet next = map[ id ];\n\n\t\t\tif ( next === undefined ) {\n\n\t\t\t\tnext = new StructuredUniform( id );\n\t\t\t\taddUniform( container, next );\n\n\t\t\t}\n\n\t\t\tcontainer = next;\n\n\t\t}\n\n\t}\n\n}\n\n// Root Container\n\nclass WebGLUniforms {\n\n\tconstructor( gl, program ) {\n\n\t\tthis.seq = [];\n\t\tthis.map = {};\n\n\t\tconst n = gl.getProgramParameter( program, 35718 );\n\n\t\tfor ( let i = 0; i < n; ++ i ) {\n\n\t\t\tconst info = gl.getActiveUniform( program, i ),\n\t\t\t\taddr = gl.getUniformLocation( program, info.name );\n\n\t\t\tparseUniform( info, addr, this );\n\n\t\t}\n\n\t}\n\n\tsetValue( gl, name, value, textures ) {\n\n\t\tconst u = this.map[ name ];\n\n\t\tif ( u !== undefined ) u.setValue( gl, value, textures );\n\n\t}\n\n\tsetOptional( gl, object, name ) {\n\n\t\tconst v = object[ name ];\n\n\t\tif ( v !== undefined ) this.setValue( gl, name, v );\n\n\t}\n\n\tstatic upload( gl, seq, values, textures ) {\n\n\t\tfor ( let i = 0, n = seq.length; i !== n; ++ i ) {\n\n\t\t\tconst u = seq[ i ],\n\t\t\t\tv = values[ u.id ];\n\n\t\t\tif ( v.needsUpdate !== false ) {\n\n\t\t\t\t// note: always updating when .needsUpdate is undefined\n\t\t\t\tu.setValue( gl, v.value, textures );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tstatic seqWithValue( seq, values ) {\n\n\t\tconst r = [];\n\n\t\tfor ( let i = 0, n = seq.length; i !== n; ++ i ) {\n\n\t\t\tconst u = seq[ i ];\n\t\t\tif ( u.id in values ) r.push( u );\n\n\t\t}\n\n\t\treturn r;\n\n\t}\n\n}\n\nfunction WebGLShader( gl, type, string ) {\n\n\tconst shader = gl.createShader( type );\n\n\tgl.shaderSource( shader, string );\n\tgl.compileShader( shader );\n\n\treturn shader;\n\n}\n\nlet programIdCount = 0;\n\nfunction handleSource( string, errorLine ) {\n\n\tconst lines = string.split( '\\n' );\n\tconst lines2 = [];\n\n\tconst from = Math.max( errorLine - 6, 0 );\n\tconst to = Math.min( errorLine + 6, lines.length );\n\n\tfor ( let i = from; i < to; i ++ ) {\n\n\t\tconst line = i + 1;\n\t\tlines2.push( `${line === errorLine ? '>' : ' '} ${line}: ${lines[ i ]}` );\n\n\t}\n\n\treturn lines2.join( '\\n' );\n\n}\n\nfunction getEncodingComponents( encoding ) {\n\n\tswitch ( encoding ) {\n\n\t\tcase LinearEncoding:\n\t\t\treturn [ 'Linear', '( value )' ];\n\t\tcase sRGBEncoding:\n\t\t\treturn [ 'sRGB', '( value )' ];\n\t\tdefault:\n\t\t\tconsole.warn( 'THREE.WebGLProgram: Unsupported encoding:', encoding );\n\t\t\treturn [ 'Linear', '( value )' ];\n\n\t}\n\n}\n\nfunction getShaderErrors( gl, shader, type ) {\n\n\tconst status = gl.getShaderParameter( shader, 35713 );\n\tconst errors = gl.getShaderInfoLog( shader ).trim();\n\n\tif ( status && errors === '' ) return '';\n\n\tconst errorMatches = /ERROR: 0:(\\d+)/.exec( errors );\n\tif ( errorMatches ) {\n\n\t\t// --enable-privileged-webgl-extension\n\t\t// console.log( '**' + type + '**', gl.getExtension( 'WEBGL_debug_shaders' ).getTranslatedShaderSource( shader ) );\n\n\t\tconst errorLine = parseInt( errorMatches[ 1 ] );\n\t\treturn type.toUpperCase() + '\\n\\n' + errors + '\\n\\n' + handleSource( gl.getShaderSource( shader ), errorLine );\n\n\t} else {\n\n\t\treturn errors;\n\n\t}\n\n}\n\nfunction getTexelEncodingFunction( functionName, encoding ) {\n\n\tconst components = getEncodingComponents( encoding );\n\treturn 'vec4 ' + functionName + '( vec4 value ) { return LinearTo' + components[ 0 ] + components[ 1 ] + '; }';\n\n}\n\nfunction getToneMappingFunction( functionName, toneMapping ) {\n\n\tlet toneMappingName;\n\n\tswitch ( toneMapping ) {\n\n\t\tcase LinearToneMapping:\n\t\t\ttoneMappingName = 'Linear';\n\t\t\tbreak;\n\n\t\tcase ReinhardToneMapping:\n\t\t\ttoneMappingName = 'Reinhard';\n\t\t\tbreak;\n\n\t\tcase CineonToneMapping:\n\t\t\ttoneMappingName = 'OptimizedCineon';\n\t\t\tbreak;\n\n\t\tcase ACESFilmicToneMapping:\n\t\t\ttoneMappingName = 'ACESFilmic';\n\t\t\tbreak;\n\n\t\tcase CustomToneMapping:\n\t\t\ttoneMappingName = 'Custom';\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tconsole.warn( 'THREE.WebGLProgram: Unsupported toneMapping:', toneMapping );\n\t\t\ttoneMappingName = 'Linear';\n\n\t}\n\n\treturn 'vec3 ' + functionName + '( vec3 color ) { return ' + toneMappingName + 'ToneMapping( color ); }';\n\n}\n\nfunction generateExtensions( parameters ) {\n\n\tconst chunks = [\n\t\t( parameters.extensionDerivatives || !! parameters.envMapCubeUVHeight || parameters.bumpMap || parameters.tangentSpaceNormalMap || parameters.clearcoatNormalMap || parameters.flatShading || parameters.shaderID === 'physical' ) ? '#extension GL_OES_standard_derivatives : enable' : '',\n\t\t( parameters.extensionFragDepth || parameters.logarithmicDepthBuffer ) && parameters.rendererExtensionFragDepth ? '#extension GL_EXT_frag_depth : enable' : '',\n\t\t( parameters.extensionDrawBuffers && parameters.rendererExtensionDrawBuffers ) ? '#extension GL_EXT_draw_buffers : require' : '',\n\t\t( parameters.extensionShaderTextureLOD || parameters.envMap || parameters.transmission ) && parameters.rendererExtensionShaderTextureLod ? '#extension GL_EXT_shader_texture_lod : enable' : ''\n\t];\n\n\treturn chunks.filter( filterEmptyLine ).join( '\\n' );\n\n}\n\nfunction generateDefines( defines ) {\n\n\tconst chunks = [];\n\n\tfor ( const name in defines ) {\n\n\t\tconst value = defines[ name ];\n\n\t\tif ( value === false ) continue;\n\n\t\tchunks.push( '#define ' + name + ' ' + value );\n\n\t}\n\n\treturn chunks.join( '\\n' );\n\n}\n\nfunction fetchAttributeLocations( gl, program ) {\n\n\tconst attributes = {};\n\n\tconst n = gl.getProgramParameter( program, 35721 );\n\n\tfor ( let i = 0; i < n; i ++ ) {\n\n\t\tconst info = gl.getActiveAttrib( program, i );\n\t\tconst name = info.name;\n\n\t\tlet locationSize = 1;\n\t\tif ( info.type === 35674 ) locationSize = 2;\n\t\tif ( info.type === 35675 ) locationSize = 3;\n\t\tif ( info.type === 35676 ) locationSize = 4;\n\n\t\t// console.log( 'THREE.WebGLProgram: ACTIVE VERTEX ATTRIBUTE:', name, i );\n\n\t\tattributes[ name ] = {\n\t\t\ttype: info.type,\n\t\t\tlocation: gl.getAttribLocation( program, name ),\n\t\t\tlocationSize: locationSize\n\t\t};\n\n\t}\n\n\treturn attributes;\n\n}\n\nfunction filterEmptyLine( string ) {\n\n\treturn string !== '';\n\n}\n\nfunction replaceLightNums( string, parameters ) {\n\n\tconst numSpotLightCoords = parameters.numSpotLightShadows + parameters.numSpotLightMaps - parameters.numSpotLightShadowsWithMaps;\n\n\treturn string\n\t\t.replace( /NUM_DIR_LIGHTS/g, parameters.numDirLights )\n\t\t.replace( /NUM_SPOT_LIGHTS/g, parameters.numSpotLights )\n\t\t.replace( /NUM_SPOT_LIGHT_MAPS/g, parameters.numSpotLightMaps )\n\t\t.replace( /NUM_SPOT_LIGHT_COORDS/g, numSpotLightCoords )\n\t\t.replace( /NUM_RECT_AREA_LIGHTS/g, parameters.numRectAreaLights )\n\t\t.replace( /NUM_POINT_LIGHTS/g, parameters.numPointLights )\n\t\t.replace( /NUM_HEMI_LIGHTS/g, parameters.numHemiLights )\n\t\t.replace( /NUM_DIR_LIGHT_SHADOWS/g, parameters.numDirLightShadows )\n\t\t.replace( /NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g, parameters.numSpotLightShadowsWithMaps )\n\t\t.replace( /NUM_SPOT_LIGHT_SHADOWS/g, parameters.numSpotLightShadows )\n\t\t.replace( /NUM_POINT_LIGHT_SHADOWS/g, parameters.numPointLightShadows );\n\n}\n\nfunction replaceClippingPlaneNums( string, parameters ) {\n\n\treturn string\n\t\t.replace( /NUM_CLIPPING_PLANES/g, parameters.numClippingPlanes )\n\t\t.replace( /UNION_CLIPPING_PLANES/g, ( parameters.numClippingPlanes - parameters.numClipIntersection ) );\n\n}\n\n// Resolve Includes\n\nconst includePattern = /^[ \\t]*#include +<([\\w\\d./]+)>/gm;\n\nfunction resolveIncludes( string ) {\n\n\treturn string.replace( includePattern, includeReplacer );\n\n}\n\nfunction includeReplacer( match, include ) {\n\n\tconst string = ShaderChunk[ include ];\n\n\tif ( string === undefined ) {\n\n\t\tthrow new Error( 'Can not resolve #include <' + include + '>' );\n\n\t}\n\n\treturn resolveIncludes( string );\n\n}\n\n// Unroll Loops\n\nconst unrollLoopPattern = /#pragma unroll_loop_start\\s+for\\s*\\(\\s*int\\s+i\\s*=\\s*(\\d+)\\s*;\\s*i\\s*<\\s*(\\d+)\\s*;\\s*i\\s*\\+\\+\\s*\\)\\s*{([\\s\\S]+?)}\\s+#pragma unroll_loop_end/g;\n\nfunction unrollLoops( string ) {\n\n\treturn string.replace( unrollLoopPattern, loopReplacer );\n\n}\n\nfunction loopReplacer( match, start, end, snippet ) {\n\n\tlet string = '';\n\n\tfor ( let i = parseInt( start ); i < parseInt( end ); i ++ ) {\n\n\t\tstring += snippet\n\t\t\t.replace( /\\[\\s*i\\s*\\]/g, '[ ' + i + ' ]' )\n\t\t\t.replace( /UNROLLED_LOOP_INDEX/g, i );\n\n\t}\n\n\treturn string;\n\n}\n\n//\n\nfunction generatePrecision( parameters ) {\n\n\tlet precisionstring = 'precision ' + parameters.precision + ' float;\\nprecision ' + parameters.precision + ' int;';\n\n\tif ( parameters.precision === 'highp' ) {\n\n\t\tprecisionstring += '\\n#define HIGH_PRECISION';\n\n\t} else if ( parameters.precision === 'mediump' ) {\n\n\t\tprecisionstring += '\\n#define MEDIUM_PRECISION';\n\n\t} else if ( parameters.precision === 'lowp' ) {\n\n\t\tprecisionstring += '\\n#define LOW_PRECISION';\n\n\t}\n\n\treturn precisionstring;\n\n}\n\nfunction generateShadowMapTypeDefine( parameters ) {\n\n\tlet shadowMapTypeDefine = 'SHADOWMAP_TYPE_BASIC';\n\n\tif ( parameters.shadowMapType === PCFShadowMap ) {\n\n\t\tshadowMapTypeDefine = 'SHADOWMAP_TYPE_PCF';\n\n\t} else if ( parameters.shadowMapType === PCFSoftShadowMap ) {\n\n\t\tshadowMapTypeDefine = 'SHADOWMAP_TYPE_PCF_SOFT';\n\n\t} else if ( parameters.shadowMapType === VSMShadowMap ) {\n\n\t\tshadowMapTypeDefine = 'SHADOWMAP_TYPE_VSM';\n\n\t}\n\n\treturn shadowMapTypeDefine;\n\n}\n\nfunction generateEnvMapTypeDefine( parameters ) {\n\n\tlet envMapTypeDefine = 'ENVMAP_TYPE_CUBE';\n\n\tif ( parameters.envMap ) {\n\n\t\tswitch ( parameters.envMapMode ) {\n\n\t\t\tcase CubeReflectionMapping:\n\t\t\tcase CubeRefractionMapping:\n\t\t\t\tenvMapTypeDefine = 'ENVMAP_TYPE_CUBE';\n\t\t\t\tbreak;\n\n\t\t\tcase CubeUVReflectionMapping:\n\t\t\t\tenvMapTypeDefine = 'ENVMAP_TYPE_CUBE_UV';\n\t\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\treturn envMapTypeDefine;\n\n}\n\nfunction generateEnvMapModeDefine( parameters ) {\n\n\tlet envMapModeDefine = 'ENVMAP_MODE_REFLECTION';\n\n\tif ( parameters.envMap ) {\n\n\t\tswitch ( parameters.envMapMode ) {\n\n\t\t\tcase CubeRefractionMapping:\n\n\t\t\t\tenvMapModeDefine = 'ENVMAP_MODE_REFRACTION';\n\t\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\treturn envMapModeDefine;\n\n}\n\nfunction generateEnvMapBlendingDefine( parameters ) {\n\n\tlet envMapBlendingDefine = 'ENVMAP_BLENDING_NONE';\n\n\tif ( parameters.envMap ) {\n\n\t\tswitch ( parameters.combine ) {\n\n\t\t\tcase MultiplyOperation:\n\t\t\t\tenvMapBlendingDefine = 'ENVMAP_BLENDING_MULTIPLY';\n\t\t\t\tbreak;\n\n\t\t\tcase MixOperation:\n\t\t\t\tenvMapBlendingDefine = 'ENVMAP_BLENDING_MIX';\n\t\t\t\tbreak;\n\n\t\t\tcase AddOperation:\n\t\t\t\tenvMapBlendingDefine = 'ENVMAP_BLENDING_ADD';\n\t\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\treturn envMapBlendingDefine;\n\n}\n\nfunction generateCubeUVSize( parameters ) {\n\n\tconst imageHeight = parameters.envMapCubeUVHeight;\n\n\tif ( imageHeight === null ) return null;\n\n\tconst maxMip = Math.log2( imageHeight ) - 2;\n\n\tconst texelHeight = 1.0 / imageHeight;\n\n\tconst texelWidth = 1.0 / ( 3 * Math.max( Math.pow( 2, maxMip ), 7 * 16 ) );\n\n\treturn { texelWidth, texelHeight, maxMip };\n\n}\n\nfunction WebGLProgram( renderer, cacheKey, parameters, bindingStates ) {\n\n\t// TODO Send this event to Three.js DevTools\n\t// console.log( 'WebGLProgram', cacheKey );\n\n\tconst gl = renderer.getContext();\n\n\tconst defines = parameters.defines;\n\n\tlet vertexShader = parameters.vertexShader;\n\tlet fragmentShader = parameters.fragmentShader;\n\n\tconst shadowMapTypeDefine = generateShadowMapTypeDefine( parameters );\n\tconst envMapTypeDefine = generateEnvMapTypeDefine( parameters );\n\tconst envMapModeDefine = generateEnvMapModeDefine( parameters );\n\tconst envMapBlendingDefine = generateEnvMapBlendingDefine( parameters );\n\tconst envMapCubeUVSize = generateCubeUVSize( parameters );\n\n\tconst customExtensions = parameters.isWebGL2 ? '' : generateExtensions( parameters );\n\n\tconst customDefines = generateDefines( defines );\n\n\tconst program = gl.createProgram();\n\n\tlet prefixVertex, prefixFragment;\n\tlet versionString = parameters.glslVersion ? '#version ' + parameters.glslVersion + '\\n' : '';\n\n\tif ( parameters.isRawShaderMaterial ) {\n\n\t\tprefixVertex = [\n\n\t\t\tcustomDefines\n\n\t\t].filter( filterEmptyLine ).join( '\\n' );\n\n\t\tif ( prefixVertex.length > 0 ) {\n\n\t\t\tprefixVertex += '\\n';\n\n\t\t}\n\n\t\tprefixFragment = [\n\n\t\t\tcustomExtensions,\n\t\t\tcustomDefines\n\n\t\t].filter( filterEmptyLine ).join( '\\n' );\n\n\t\tif ( prefixFragment.length > 0 ) {\n\n\t\t\tprefixFragment += '\\n';\n\n\t\t}\n\n\t} else {\n\n\t\tprefixVertex = [\n\n\t\t\tgeneratePrecision( parameters ),\n\n\t\t\t'#define SHADER_NAME ' + parameters.shaderName,\n\n\t\t\tcustomDefines,\n\n\t\t\tparameters.instancing ? '#define USE_INSTANCING' : '',\n\t\t\tparameters.instancingColor ? '#define USE_INSTANCING_COLOR' : '',\n\n\t\t\tparameters.supportsVertexTextures ? '#define VERTEX_TEXTURES' : '',\n\n\t\t\t( parameters.useFog && parameters.fog ) ? '#define USE_FOG' : '',\n\t\t\t( parameters.useFog && parameters.fogExp2 ) ? '#define FOG_EXP2' : '',\n\n\t\t\tparameters.map ? '#define USE_MAP' : '',\n\t\t\tparameters.envMap ? '#define USE_ENVMAP' : '',\n\t\t\tparameters.envMap ? '#define ' + envMapModeDefine : '',\n\t\t\tparameters.lightMap ? '#define USE_LIGHTMAP' : '',\n\t\t\tparameters.aoMap ? '#define USE_AOMAP' : '',\n\t\t\tparameters.emissiveMap ? '#define USE_EMISSIVEMAP' : '',\n\t\t\tparameters.bumpMap ? '#define USE_BUMPMAP' : '',\n\t\t\tparameters.normalMap ? '#define USE_NORMALMAP' : '',\n\t\t\t( parameters.normalMap && parameters.objectSpaceNormalMap ) ? '#define OBJECTSPACE_NORMALMAP' : '',\n\t\t\t( parameters.normalMap && parameters.tangentSpaceNormalMap ) ? '#define TANGENTSPACE_NORMALMAP' : '',\n\n\t\t\tparameters.clearcoatMap ? '#define USE_CLEARCOATMAP' : '',\n\t\t\tparameters.clearcoatRoughnessMap ? '#define USE_CLEARCOAT_ROUGHNESSMAP' : '',\n\t\t\tparameters.clearcoatNormalMap ? '#define USE_CLEARCOAT_NORMALMAP' : '',\n\n\t\t\tparameters.iridescenceMap ? '#define USE_IRIDESCENCEMAP' : '',\n\t\t\tparameters.iridescenceThicknessMap ? '#define USE_IRIDESCENCE_THICKNESSMAP' : '',\n\n\t\t\tparameters.displacementMap && parameters.supportsVertexTextures ? '#define USE_DISPLACEMENTMAP' : '',\n\n\t\t\tparameters.specularMap ? '#define USE_SPECULARMAP' : '',\n\t\t\tparameters.specularIntensityMap ? '#define USE_SPECULARINTENSITYMAP' : '',\n\t\t\tparameters.specularColorMap ? '#define USE_SPECULARCOLORMAP' : '',\n\n\t\t\tparameters.roughnessMap ? '#define USE_ROUGHNESSMAP' : '',\n\t\t\tparameters.metalnessMap ? '#define USE_METALNESSMAP' : '',\n\t\t\tparameters.alphaMap ? '#define USE_ALPHAMAP' : '',\n\n\t\t\tparameters.transmission ? '#define USE_TRANSMISSION' : '',\n\t\t\tparameters.transmissionMap ? '#define USE_TRANSMISSIONMAP' : '',\n\t\t\tparameters.thicknessMap ? '#define USE_THICKNESSMAP' : '',\n\n\t\t\tparameters.sheenColorMap ? '#define USE_SHEENCOLORMAP' : '',\n\t\t\tparameters.sheenRoughnessMap ? '#define USE_SHEENROUGHNESSMAP' : '',\n\n\t\t\tparameters.vertexTangents ? '#define USE_TANGENT' : '',\n\t\t\tparameters.vertexColors ? '#define USE_COLOR' : '',\n\t\t\tparameters.vertexAlphas ? '#define USE_COLOR_ALPHA' : '',\n\t\t\tparameters.vertexUvs ? '#define USE_UV' : '',\n\t\t\tparameters.uvsVertexOnly ? '#define UVS_VERTEX_ONLY' : '',\n\n\t\t\tparameters.flatShading ? '#define FLAT_SHADED' : '',\n\n\t\t\tparameters.skinning ? '#define USE_SKINNING' : '',\n\n\t\t\tparameters.morphTargets ? '#define USE_MORPHTARGETS' : '',\n\t\t\tparameters.morphNormals && parameters.flatShading === false ? '#define USE_MORPHNORMALS' : '',\n\t\t\t( parameters.morphColors && parameters.isWebGL2 ) ? '#define USE_MORPHCOLORS' : '',\n\t\t\t( parameters.morphTargetsCount > 0 && parameters.isWebGL2 ) ? '#define MORPHTARGETS_TEXTURE' : '',\n\t\t\t( parameters.morphTargetsCount > 0 && parameters.isWebGL2 ) ? '#define MORPHTARGETS_TEXTURE_STRIDE ' + parameters.morphTextureStride : '',\n\t\t\t( parameters.morphTargetsCount > 0 && parameters.isWebGL2 ) ? '#define MORPHTARGETS_COUNT ' + parameters.morphTargetsCount : '',\n\t\t\tparameters.doubleSided ? '#define DOUBLE_SIDED' : '',\n\t\t\tparameters.flipSided ? '#define FLIP_SIDED' : '',\n\n\t\t\tparameters.shadowMapEnabled ? '#define USE_SHADOWMAP' : '',\n\t\t\tparameters.shadowMapEnabled ? '#define ' + shadowMapTypeDefine : '',\n\n\t\t\tparameters.sizeAttenuation ? '#define USE_SIZEATTENUATION' : '',\n\n\t\t\tparameters.logarithmicDepthBuffer ? '#define USE_LOGDEPTHBUF' : '',\n\t\t\t( parameters.logarithmicDepthBuffer && parameters.rendererExtensionFragDepth ) ? '#define USE_LOGDEPTHBUF_EXT' : '',\n\n\t\t\t'uniform mat4 modelMatrix;',\n\t\t\t'uniform mat4 modelViewMatrix;',\n\t\t\t'uniform mat4 projectionMatrix;',\n\t\t\t'uniform mat4 viewMatrix;',\n\t\t\t'uniform mat3 normalMatrix;',\n\t\t\t'uniform vec3 cameraPosition;',\n\t\t\t'uniform bool isOrthographic;',\n\n\t\t\t'#ifdef USE_INSTANCING',\n\n\t\t\t'\tattribute mat4 instanceMatrix;',\n\n\t\t\t'#endif',\n\n\t\t\t'#ifdef USE_INSTANCING_COLOR',\n\n\t\t\t'\tattribute vec3 instanceColor;',\n\n\t\t\t'#endif',\n\n\t\t\t'attribute vec3 position;',\n\t\t\t'attribute vec3 normal;',\n\t\t\t'attribute vec2 uv;',\n\n\t\t\t'#ifdef USE_TANGENT',\n\n\t\t\t'\tattribute vec4 tangent;',\n\n\t\t\t'#endif',\n\n\t\t\t'#if defined( USE_COLOR_ALPHA )',\n\n\t\t\t'\tattribute vec4 color;',\n\n\t\t\t'#elif defined( USE_COLOR )',\n\n\t\t\t'\tattribute vec3 color;',\n\n\t\t\t'#endif',\n\n\t\t\t'#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )',\n\n\t\t\t'\tattribute vec3 morphTarget0;',\n\t\t\t'\tattribute vec3 morphTarget1;',\n\t\t\t'\tattribute vec3 morphTarget2;',\n\t\t\t'\tattribute vec3 morphTarget3;',\n\n\t\t\t'\t#ifdef USE_MORPHNORMALS',\n\n\t\t\t'\t\tattribute vec3 morphNormal0;',\n\t\t\t'\t\tattribute vec3 morphNormal1;',\n\t\t\t'\t\tattribute vec3 morphNormal2;',\n\t\t\t'\t\tattribute vec3 morphNormal3;',\n\n\t\t\t'\t#else',\n\n\t\t\t'\t\tattribute vec3 morphTarget4;',\n\t\t\t'\t\tattribute vec3 morphTarget5;',\n\t\t\t'\t\tattribute vec3 morphTarget6;',\n\t\t\t'\t\tattribute vec3 morphTarget7;',\n\n\t\t\t'\t#endif',\n\n\t\t\t'#endif',\n\n\t\t\t'#ifdef USE_SKINNING',\n\n\t\t\t'\tattribute vec4 skinIndex;',\n\t\t\t'\tattribute vec4 skinWeight;',\n\n\t\t\t'#endif',\n\n\t\t\t'\\n'\n\n\t\t].filter( filterEmptyLine ).join( '\\n' );\n\n\t\tprefixFragment = [\n\n\t\t\tcustomExtensions,\n\n\t\t\tgeneratePrecision( parameters ),\n\n\t\t\t'#define SHADER_NAME ' + parameters.shaderName,\n\n\t\t\tcustomDefines,\n\n\t\t\t( parameters.useFog && parameters.fog ) ? '#define USE_FOG' : '',\n\t\t\t( parameters.useFog && parameters.fogExp2 ) ? '#define FOG_EXP2' : '',\n\n\t\t\tparameters.map ? '#define USE_MAP' : '',\n\t\t\tparameters.matcap ? '#define USE_MATCAP' : '',\n\t\t\tparameters.envMap ? '#define USE_ENVMAP' : '',\n\t\t\tparameters.envMap ? '#define ' + envMapTypeDefine : '',\n\t\t\tparameters.envMap ? '#define ' + envMapModeDefine : '',\n\t\t\tparameters.envMap ? '#define ' + envMapBlendingDefine : '',\n\t\t\tenvMapCubeUVSize ? '#define CUBEUV_TEXEL_WIDTH ' + envMapCubeUVSize.texelWidth : '',\n\t\t\tenvMapCubeUVSize ? '#define CUBEUV_TEXEL_HEIGHT ' + envMapCubeUVSize.texelHeight : '',\n\t\t\tenvMapCubeUVSize ? '#define CUBEUV_MAX_MIP ' + envMapCubeUVSize.maxMip + '.0' : '',\n\t\t\tparameters.lightMap ? '#define USE_LIGHTMAP' : '',\n\t\t\tparameters.aoMap ? '#define USE_AOMAP' : '',\n\t\t\tparameters.emissiveMap ? '#define USE_EMISSIVEMAP' : '',\n\t\t\tparameters.bumpMap ? '#define USE_BUMPMAP' : '',\n\t\t\tparameters.normalMap ? '#define USE_NORMALMAP' : '',\n\t\t\t( parameters.normalMap && parameters.objectSpaceNormalMap ) ? '#define OBJECTSPACE_NORMALMAP' : '',\n\t\t\t( parameters.normalMap && parameters.tangentSpaceNormalMap ) ? '#define TANGENTSPACE_NORMALMAP' : '',\n\n\t\t\tparameters.clearcoat ? '#define USE_CLEARCOAT' : '',\n\t\t\tparameters.clearcoatMap ? '#define USE_CLEARCOATMAP' : '',\n\t\t\tparameters.clearcoatRoughnessMap ? '#define USE_CLEARCOAT_ROUGHNESSMAP' : '',\n\t\t\tparameters.clearcoatNormalMap ? '#define USE_CLEARCOAT_NORMALMAP' : '',\n\n\t\t\tparameters.iridescence ? '#define USE_IRIDESCENCE' : '',\n\t\t\tparameters.iridescenceMap ? '#define USE_IRIDESCENCEMAP' : '',\n\t\t\tparameters.iridescenceThicknessMap ? '#define USE_IRIDESCENCE_THICKNESSMAP' : '',\n\n\t\t\tparameters.specularMap ? '#define USE_SPECULARMAP' : '',\n\t\t\tparameters.specularIntensityMap ? '#define USE_SPECULARINTENSITYMAP' : '',\n\t\t\tparameters.specularColorMap ? '#define USE_SPECULARCOLORMAP' : '',\n\t\t\tparameters.roughnessMap ? '#define USE_ROUGHNESSMAP' : '',\n\t\t\tparameters.metalnessMap ? '#define USE_METALNESSMAP' : '',\n\n\t\t\tparameters.alphaMap ? '#define USE_ALPHAMAP' : '',\n\t\t\tparameters.alphaTest ? '#define USE_ALPHATEST' : '',\n\n\t\t\tparameters.sheen ? '#define USE_SHEEN' : '',\n\t\t\tparameters.sheenColorMap ? '#define USE_SHEENCOLORMAP' : '',\n\t\t\tparameters.sheenRoughnessMap ? '#define USE_SHEENROUGHNESSMAP' : '',\n\n\t\t\tparameters.transmission ? '#define USE_TRANSMISSION' : '',\n\t\t\tparameters.transmissionMap ? '#define USE_TRANSMISSIONMAP' : '',\n\t\t\tparameters.thicknessMap ? '#define USE_THICKNESSMAP' : '',\n\n\t\t\tparameters.decodeVideoTexture ? '#define DECODE_VIDEO_TEXTURE' : '',\n\n\t\t\tparameters.vertexTangents ? '#define USE_TANGENT' : '',\n\t\t\tparameters.vertexColors || parameters.instancingColor ? '#define USE_COLOR' : '',\n\t\t\tparameters.vertexAlphas ? '#define USE_COLOR_ALPHA' : '',\n\t\t\tparameters.vertexUvs ? '#define USE_UV' : '',\n\t\t\tparameters.uvsVertexOnly ? '#define UVS_VERTEX_ONLY' : '',\n\n\t\t\tparameters.gradientMap ? '#define USE_GRADIENTMAP' : '',\n\n\t\t\tparameters.flatShading ? '#define FLAT_SHADED' : '',\n\n\t\t\tparameters.doubleSided ? '#define DOUBLE_SIDED' : '',\n\t\t\tparameters.flipSided ? '#define FLIP_SIDED' : '',\n\n\t\t\tparameters.shadowMapEnabled ? '#define USE_SHADOWMAP' : '',\n\t\t\tparameters.shadowMapEnabled ? '#define ' + shadowMapTypeDefine : '',\n\n\t\t\tparameters.premultipliedAlpha ? '#define PREMULTIPLIED_ALPHA' : '',\n\n\t\t\tparameters.physicallyCorrectLights ? '#define PHYSICALLY_CORRECT_LIGHTS' : '',\n\n\t\t\tparameters.logarithmicDepthBuffer ? '#define USE_LOGDEPTHBUF' : '',\n\t\t\t( parameters.logarithmicDepthBuffer && parameters.rendererExtensionFragDepth ) ? '#define USE_LOGDEPTHBUF_EXT' : '',\n\n\t\t\t'uniform mat4 viewMatrix;',\n\t\t\t'uniform vec3 cameraPosition;',\n\t\t\t'uniform bool isOrthographic;',\n\n\t\t\t( parameters.toneMapping !== NoToneMapping ) ? '#define TONE_MAPPING' : '',\n\t\t\t( parameters.toneMapping !== NoToneMapping ) ? ShaderChunk[ 'tonemapping_pars_fragment' ] : '', // this code is required here because it is used by the toneMapping() function defined below\n\t\t\t( parameters.toneMapping !== NoToneMapping ) ? getToneMappingFunction( 'toneMapping', parameters.toneMapping ) : '',\n\n\t\t\tparameters.dithering ? '#define DITHERING' : '',\n\t\t\tparameters.opaque ? '#define OPAQUE' : '',\n\n\t\t\tShaderChunk[ 'encodings_pars_fragment' ], // this code is required here because it is used by the various encoding/decoding function defined below\n\t\t\tgetTexelEncodingFunction( 'linearToOutputTexel', parameters.outputEncoding ),\n\n\t\t\tparameters.useDepthPacking ? '#define DEPTH_PACKING ' + parameters.depthPacking : '',\n\n\t\t\t'\\n'\n\n\t\t].filter( filterEmptyLine ).join( '\\n' );\n\n\t}\n\n\tvertexShader = resolveIncludes( vertexShader );\n\tvertexShader = replaceLightNums( vertexShader, parameters );\n\tvertexShader = replaceClippingPlaneNums( vertexShader, parameters );\n\n\tfragmentShader = resolveIncludes( fragmentShader );\n\tfragmentShader = replaceLightNums( fragmentShader, parameters );\n\tfragmentShader = replaceClippingPlaneNums( fragmentShader, parameters );\n\n\tvertexShader = unrollLoops( vertexShader );\n\tfragmentShader = unrollLoops( fragmentShader );\n\n\tif ( parameters.isWebGL2 && parameters.isRawShaderMaterial !== true ) {\n\n\t\t// GLSL 3.0 conversion for built-in materials and ShaderMaterial\n\n\t\tversionString = '#version 300 es\\n';\n\n\t\tprefixVertex = [\n\t\t\t'precision mediump sampler2DArray;',\n\t\t\t'#define attribute in',\n\t\t\t'#define varying out',\n\t\t\t'#define texture2D texture'\n\t\t].join( '\\n' ) + '\\n' + prefixVertex;\n\n\t\tprefixFragment = [\n\t\t\t'#define varying in',\n\t\t\t( parameters.glslVersion === GLSL3 ) ? '' : 'layout(location = 0) out highp vec4 pc_fragColor;',\n\t\t\t( parameters.glslVersion === GLSL3 ) ? '' : '#define gl_FragColor pc_fragColor',\n\t\t\t'#define gl_FragDepthEXT gl_FragDepth',\n\t\t\t'#define texture2D texture',\n\t\t\t'#define textureCube texture',\n\t\t\t'#define texture2DProj textureProj',\n\t\t\t'#define texture2DLodEXT textureLod',\n\t\t\t'#define texture2DProjLodEXT textureProjLod',\n\t\t\t'#define textureCubeLodEXT textureLod',\n\t\t\t'#define texture2DGradEXT textureGrad',\n\t\t\t'#define texture2DProjGradEXT textureProjGrad',\n\t\t\t'#define textureCubeGradEXT textureGrad'\n\t\t].join( '\\n' ) + '\\n' + prefixFragment;\n\n\t}\n\n\tconst vertexGlsl = versionString + prefixVertex + vertexShader;\n\tconst fragmentGlsl = versionString + prefixFragment + fragmentShader;\n\n\t// console.log( '*VERTEX*', vertexGlsl );\n\t// console.log( '*FRAGMENT*', fragmentGlsl );\n\n\tconst glVertexShader = WebGLShader( gl, 35633, vertexGlsl );\n\tconst glFragmentShader = WebGLShader( gl, 35632, fragmentGlsl );\n\n\tgl.attachShader( program, glVertexShader );\n\tgl.attachShader( program, glFragmentShader );\n\n\t// Force a particular attribute to index 0.\n\n\tif ( parameters.index0AttributeName !== undefined ) {\n\n\t\tgl.bindAttribLocation( program, 0, parameters.index0AttributeName );\n\n\t} else if ( parameters.morphTargets === true ) {\n\n\t\t// programs with morphTargets displace position out of attribute 0\n\t\tgl.bindAttribLocation( program, 0, 'position' );\n\n\t}\n\n\tgl.linkProgram( program );\n\n\t// check for link errors\n\tif ( renderer.debug.checkShaderErrors ) {\n\n\t\tconst programLog = gl.getProgramInfoLog( program ).trim();\n\t\tconst vertexLog = gl.getShaderInfoLog( glVertexShader ).trim();\n\t\tconst fragmentLog = gl.getShaderInfoLog( glFragmentShader ).trim();\n\n\t\tlet runnable = true;\n\t\tlet haveDiagnostics = true;\n\n\t\tif ( gl.getProgramParameter( program, 35714 ) === false ) {\n\n\t\t\trunnable = false;\n\n\t\t\tconst vertexErrors = getShaderErrors( gl, glVertexShader, 'vertex' );\n\t\t\tconst fragmentErrors = getShaderErrors( gl, glFragmentShader, 'fragment' );\n\n\t\t\tconsole.error(\n\t\t\t\t'THREE.WebGLProgram: Shader Error ' + gl.getError() + ' - ' +\n\t\t\t\t'VALIDATE_STATUS ' + gl.getProgramParameter( program, 35715 ) + '\\n\\n' +\n\t\t\t\t'Program Info Log: ' + programLog + '\\n' +\n\t\t\t\tvertexErrors + '\\n' +\n\t\t\t\tfragmentErrors\n\t\t\t);\n\n\t\t} else if ( programLog !== '' ) {\n\n\t\t\tconsole.warn( 'THREE.WebGLProgram: Program Info Log:', programLog );\n\n\t\t} else if ( vertexLog === '' || fragmentLog === '' ) {\n\n\t\t\thaveDiagnostics = false;\n\n\t\t}\n\n\t\tif ( haveDiagnostics ) {\n\n\t\t\tthis.diagnostics = {\n\n\t\t\t\trunnable: runnable,\n\n\t\t\t\tprogramLog: programLog,\n\n\t\t\t\tvertexShader: {\n\n\t\t\t\t\tlog: vertexLog,\n\t\t\t\t\tprefix: prefixVertex\n\n\t\t\t\t},\n\n\t\t\t\tfragmentShader: {\n\n\t\t\t\t\tlog: fragmentLog,\n\t\t\t\t\tprefix: prefixFragment\n\n\t\t\t\t}\n\n\t\t\t};\n\n\t\t}\n\n\t}\n\n\t// Clean up\n\n\t// Crashes in iOS9 and iOS10. #18402\n\t// gl.detachShader( program, glVertexShader );\n\t// gl.detachShader( program, glFragmentShader );\n\n\tgl.deleteShader( glVertexShader );\n\tgl.deleteShader( glFragmentShader );\n\n\t// set up caching for uniform locations\n\n\tlet cachedUniforms;\n\n\tthis.getUniforms = function () {\n\n\t\tif ( cachedUniforms === undefined ) {\n\n\t\t\tcachedUniforms = new WebGLUniforms( gl, program );\n\n\t\t}\n\n\t\treturn cachedUniforms;\n\n\t};\n\n\t// set up caching for attribute locations\n\n\tlet cachedAttributes;\n\n\tthis.getAttributes = function () {\n\n\t\tif ( cachedAttributes === undefined ) {\n\n\t\t\tcachedAttributes = fetchAttributeLocations( gl, program );\n\n\t\t}\n\n\t\treturn cachedAttributes;\n\n\t};\n\n\t// free resource\n\n\tthis.destroy = function () {\n\n\t\tbindingStates.releaseStatesOfProgram( this );\n\n\t\tgl.deleteProgram( program );\n\t\tthis.program = undefined;\n\n\t};\n\n\t//\n\n\tthis.name = parameters.shaderName;\n\tthis.id = programIdCount ++;\n\tthis.cacheKey = cacheKey;\n\tthis.usedTimes = 1;\n\tthis.program = program;\n\tthis.vertexShader = glVertexShader;\n\tthis.fragmentShader = glFragmentShader;\n\n\treturn this;\n\n}\n\nlet _id = 0;\n\nclass WebGLShaderCache {\n\n\tconstructor() {\n\n\t\tthis.shaderCache = new Map();\n\t\tthis.materialCache = new Map();\n\n\t}\n\n\tupdate( material ) {\n\n\t\tconst vertexShader = material.vertexShader;\n\t\tconst fragmentShader = material.fragmentShader;\n\n\t\tconst vertexShaderStage = this._getShaderStage( vertexShader );\n\t\tconst fragmentShaderStage = this._getShaderStage( fragmentShader );\n\n\t\tconst materialShaders = this._getShaderCacheForMaterial( material );\n\n\t\tif ( materialShaders.has( vertexShaderStage ) === false ) {\n\n\t\t\tmaterialShaders.add( vertexShaderStage );\n\t\t\tvertexShaderStage.usedTimes ++;\n\n\t\t}\n\n\t\tif ( materialShaders.has( fragmentShaderStage ) === false ) {\n\n\t\t\tmaterialShaders.add( fragmentShaderStage );\n\t\t\tfragmentShaderStage.usedTimes ++;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tremove( material ) {\n\n\t\tconst materialShaders = this.materialCache.get( material );\n\n\t\tfor ( const shaderStage of materialShaders ) {\n\n\t\t\tshaderStage.usedTimes --;\n\n\t\t\tif ( shaderStage.usedTimes === 0 ) this.shaderCache.delete( shaderStage.code );\n\n\t\t}\n\n\t\tthis.materialCache.delete( material );\n\n\t\treturn this;\n\n\t}\n\n\tgetVertexShaderID( material ) {\n\n\t\treturn this._getShaderStage( material.vertexShader ).id;\n\n\t}\n\n\tgetFragmentShaderID( material ) {\n\n\t\treturn this._getShaderStage( material.fragmentShader ).id;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.shaderCache.clear();\n\t\tthis.materialCache.clear();\n\n\t}\n\n\t_getShaderCacheForMaterial( material ) {\n\n\t\tconst cache = this.materialCache;\n\t\tlet set = cache.get( material );\n\n\t\tif ( set === undefined ) {\n\n\t\t\tset = new Set();\n\t\t\tcache.set( material, set );\n\n\t\t}\n\n\t\treturn set;\n\n\t}\n\n\t_getShaderStage( code ) {\n\n\t\tconst cache = this.shaderCache;\n\t\tlet stage = cache.get( code );\n\n\t\tif ( stage === undefined ) {\n\n\t\t\tstage = new WebGLShaderStage( code );\n\t\t\tcache.set( code, stage );\n\n\t\t}\n\n\t\treturn stage;\n\n\t}\n\n}\n\nclass WebGLShaderStage {\n\n\tconstructor( code ) {\n\n\t\tthis.id = _id ++;\n\n\t\tthis.code = code;\n\t\tthis.usedTimes = 0;\n\n\t}\n\n}\n\nfunction WebGLPrograms( renderer, cubemaps, cubeuvmaps, extensions, capabilities, bindingStates, clipping ) {\n\n\tconst _programLayers = new Layers();\n\tconst _customShaders = new WebGLShaderCache();\n\tconst programs = [];\n\n\tconst isWebGL2 = capabilities.isWebGL2;\n\tconst logarithmicDepthBuffer = capabilities.logarithmicDepthBuffer;\n\tconst vertexTextures = capabilities.vertexTextures;\n\tlet precision = capabilities.precision;\n\n\tconst shaderIDs = {\n\t\tMeshDepthMaterial: 'depth',\n\t\tMeshDistanceMaterial: 'distanceRGBA',\n\t\tMeshNormalMaterial: 'normal',\n\t\tMeshBasicMaterial: 'basic',\n\t\tMeshLambertMaterial: 'lambert',\n\t\tMeshPhongMaterial: 'phong',\n\t\tMeshToonMaterial: 'toon',\n\t\tMeshStandardMaterial: 'physical',\n\t\tMeshPhysicalMaterial: 'physical',\n\t\tMeshMatcapMaterial: 'matcap',\n\t\tLineBasicMaterial: 'basic',\n\t\tLineDashedMaterial: 'dashed',\n\t\tPointsMaterial: 'points',\n\t\tShadowMaterial: 'shadow',\n\t\tSpriteMaterial: 'sprite'\n\t};\n\n\tfunction getParameters( material, lights, shadows, scene, object ) {\n\n\t\tconst fog = scene.fog;\n\t\tconst geometry = object.geometry;\n\t\tconst environment = material.isMeshStandardMaterial ? scene.environment : null;\n\n\t\tconst envMap = ( material.isMeshStandardMaterial ? cubeuvmaps : cubemaps ).get( material.envMap || environment );\n\t\tconst envMapCubeUVHeight = ( !! envMap ) && ( envMap.mapping === CubeUVReflectionMapping ) ? envMap.image.height : null;\n\n\t\tconst shaderID = shaderIDs[ material.type ];\n\n\t\t// heuristics to create shader parameters according to lights in the scene\n\t\t// (not to blow over maxLights budget)\n\n\t\tif ( material.precision !== null ) {\n\n\t\t\tprecision = capabilities.getMaxPrecision( material.precision );\n\n\t\t\tif ( precision !== material.precision ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLProgram.getParameters:', material.precision, 'not supported, using', precision, 'instead.' );\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tconst morphAttribute = geometry.morphAttributes.position || geometry.morphAttributes.normal || geometry.morphAttributes.color;\n\t\tconst morphTargetsCount = ( morphAttribute !== undefined ) ? morphAttribute.length : 0;\n\n\t\tlet morphTextureStride = 0;\n\n\t\tif ( geometry.morphAttributes.position !== undefined ) morphTextureStride = 1;\n\t\tif ( geometry.morphAttributes.normal !== undefined ) morphTextureStride = 2;\n\t\tif ( geometry.morphAttributes.color !== undefined ) morphTextureStride = 3;\n\n\t\t//\n\n\t\tlet vertexShader, fragmentShader;\n\t\tlet customVertexShaderID, customFragmentShaderID;\n\n\t\tif ( shaderID ) {\n\n\t\t\tconst shader = ShaderLib[ shaderID ];\n\n\t\t\tvertexShader = shader.vertexShader;\n\t\t\tfragmentShader = shader.fragmentShader;\n\n\t\t} else {\n\n\t\t\tvertexShader = material.vertexShader;\n\t\t\tfragmentShader = material.fragmentShader;\n\n\t\t\t_customShaders.update( material );\n\n\t\t\tcustomVertexShaderID = _customShaders.getVertexShaderID( material );\n\t\t\tcustomFragmentShaderID = _customShaders.getFragmentShaderID( material );\n\n\t\t}\n\n\t\tconst currentRenderTarget = renderer.getRenderTarget();\n\n\t\tconst useAlphaTest = material.alphaTest > 0;\n\t\tconst useClearcoat = material.clearcoat > 0;\n\t\tconst useIridescence = material.iridescence > 0;\n\n\t\tconst parameters = {\n\n\t\t\tisWebGL2: isWebGL2,\n\n\t\t\tshaderID: shaderID,\n\t\t\tshaderName: material.type,\n\n\t\t\tvertexShader: vertexShader,\n\t\t\tfragmentShader: fragmentShader,\n\t\t\tdefines: material.defines,\n\n\t\t\tcustomVertexShaderID: customVertexShaderID,\n\t\t\tcustomFragmentShaderID: customFragmentShaderID,\n\n\t\t\tisRawShaderMaterial: material.isRawShaderMaterial === true,\n\t\t\tglslVersion: material.glslVersion,\n\n\t\t\tprecision: precision,\n\n\t\t\tinstancing: object.isInstancedMesh === true,\n\t\t\tinstancingColor: object.isInstancedMesh === true && object.instanceColor !== null,\n\n\t\t\tsupportsVertexTextures: vertexTextures,\n\t\t\toutputEncoding: ( currentRenderTarget === null ) ? renderer.outputEncoding : ( currentRenderTarget.isXRRenderTarget === true ? currentRenderTarget.texture.encoding : LinearEncoding ),\n\t\t\tmap: !! material.map,\n\t\t\tmatcap: !! material.matcap,\n\t\t\tenvMap: !! envMap,\n\t\t\tenvMapMode: envMap && envMap.mapping,\n\t\t\tenvMapCubeUVHeight: envMapCubeUVHeight,\n\t\t\tlightMap: !! material.lightMap,\n\t\t\taoMap: !! material.aoMap,\n\t\t\temissiveMap: !! material.emissiveMap,\n\t\t\tbumpMap: !! material.bumpMap,\n\t\t\tnormalMap: !! material.normalMap,\n\t\t\tobjectSpaceNormalMap: material.normalMapType === ObjectSpaceNormalMap,\n\t\t\ttangentSpaceNormalMap: material.normalMapType === TangentSpaceNormalMap,\n\n\t\t\tdecodeVideoTexture: !! material.map && ( material.map.isVideoTexture === true ) && ( material.map.encoding === sRGBEncoding ),\n\n\t\t\tclearcoat: useClearcoat,\n\t\t\tclearcoatMap: useClearcoat && !! material.clearcoatMap,\n\t\t\tclearcoatRoughnessMap: useClearcoat && !! material.clearcoatRoughnessMap,\n\t\t\tclearcoatNormalMap: useClearcoat && !! material.clearcoatNormalMap,\n\n\t\t\tiridescence: useIridescence,\n\t\t\tiridescenceMap: useIridescence && !! material.iridescenceMap,\n\t\t\tiridescenceThicknessMap: useIridescence && !! material.iridescenceThicknessMap,\n\n\t\t\tdisplacementMap: !! material.displacementMap,\n\t\t\troughnessMap: !! material.roughnessMap,\n\t\t\tmetalnessMap: !! material.metalnessMap,\n\t\t\tspecularMap: !! material.specularMap,\n\t\t\tspecularIntensityMap: !! material.specularIntensityMap,\n\t\t\tspecularColorMap: !! material.specularColorMap,\n\n\t\t\topaque: material.transparent === false && material.blending === NormalBlending,\n\n\t\t\talphaMap: !! material.alphaMap,\n\t\t\talphaTest: useAlphaTest,\n\n\t\t\tgradientMap: !! material.gradientMap,\n\n\t\t\tsheen: material.sheen > 0,\n\t\t\tsheenColorMap: !! material.sheenColorMap,\n\t\t\tsheenRoughnessMap: !! material.sheenRoughnessMap,\n\n\t\t\ttransmission: material.transmission > 0,\n\t\t\ttransmissionMap: !! material.transmissionMap,\n\t\t\tthicknessMap: !! material.thicknessMap,\n\n\t\t\tcombine: material.combine,\n\n\t\t\tvertexTangents: ( !! material.normalMap && !! geometry.attributes.tangent ),\n\t\t\tvertexColors: material.vertexColors,\n\t\t\tvertexAlphas: material.vertexColors === true && !! geometry.attributes.color && geometry.attributes.color.itemSize === 4,\n\t\t\tvertexUvs: !! material.map || !! material.bumpMap || !! material.normalMap || !! material.specularMap || !! material.alphaMap || !! material.emissiveMap || !! material.roughnessMap || !! material.metalnessMap || !! material.clearcoatMap || !! material.clearcoatRoughnessMap || !! material.clearcoatNormalMap || !! material.iridescenceMap || !! material.iridescenceThicknessMap || !! material.displacementMap || !! material.transmissionMap || !! material.thicknessMap || !! material.specularIntensityMap || !! material.specularColorMap || !! material.sheenColorMap || !! material.sheenRoughnessMap,\n\t\t\tuvsVertexOnly: ! ( !! material.map || !! material.bumpMap || !! material.normalMap || !! material.specularMap || !! material.alphaMap || !! material.emissiveMap || !! material.roughnessMap || !! material.metalnessMap || !! material.clearcoatNormalMap || !! material.iridescenceMap || !! material.iridescenceThicknessMap || material.transmission > 0 || !! material.transmissionMap || !! material.thicknessMap || !! material.specularIntensityMap || !! material.specularColorMap || material.sheen > 0 || !! material.sheenColorMap || !! material.sheenRoughnessMap ) && !! material.displacementMap,\n\n\t\t\tfog: !! fog,\n\t\t\tuseFog: material.fog === true,\n\t\t\tfogExp2: ( fog && fog.isFogExp2 ),\n\n\t\t\tflatShading: !! material.flatShading,\n\n\t\t\tsizeAttenuation: material.sizeAttenuation,\n\t\t\tlogarithmicDepthBuffer: logarithmicDepthBuffer,\n\n\t\t\tskinning: object.isSkinnedMesh === true,\n\n\t\t\tmorphTargets: geometry.morphAttributes.position !== undefined,\n\t\t\tmorphNormals: geometry.morphAttributes.normal !== undefined,\n\t\t\tmorphColors: geometry.morphAttributes.color !== undefined,\n\t\t\tmorphTargetsCount: morphTargetsCount,\n\t\t\tmorphTextureStride: morphTextureStride,\n\n\t\t\tnumDirLights: lights.directional.length,\n\t\t\tnumPointLights: lights.point.length,\n\t\t\tnumSpotLights: lights.spot.length,\n\t\t\tnumSpotLightMaps: lights.spotLightMap.length,\n\t\t\tnumRectAreaLights: lights.rectArea.length,\n\t\t\tnumHemiLights: lights.hemi.length,\n\n\t\t\tnumDirLightShadows: lights.directionalShadowMap.length,\n\t\t\tnumPointLightShadows: lights.pointShadowMap.length,\n\t\t\tnumSpotLightShadows: lights.spotShadowMap.length,\n\t\t\tnumSpotLightShadowsWithMaps: lights.numSpotLightShadowsWithMaps,\n\n\t\t\tnumClippingPlanes: clipping.numPlanes,\n\t\t\tnumClipIntersection: clipping.numIntersection,\n\n\t\t\tdithering: material.dithering,\n\n\t\t\tshadowMapEnabled: renderer.shadowMap.enabled && shadows.length > 0,\n\t\t\tshadowMapType: renderer.shadowMap.type,\n\n\t\t\ttoneMapping: material.toneMapped ? renderer.toneMapping : NoToneMapping,\n\t\t\tphysicallyCorrectLights: renderer.physicallyCorrectLights,\n\n\t\t\tpremultipliedAlpha: material.premultipliedAlpha,\n\n\t\t\tdoubleSided: material.side === DoubleSide,\n\t\t\tflipSided: material.side === BackSide,\n\n\t\t\tuseDepthPacking: !! material.depthPacking,\n\t\t\tdepthPacking: material.depthPacking || 0,\n\n\t\t\tindex0AttributeName: material.index0AttributeName,\n\n\t\t\textensionDerivatives: material.extensions && material.extensions.derivatives,\n\t\t\textensionFragDepth: material.extensions && material.extensions.fragDepth,\n\t\t\textensionDrawBuffers: material.extensions && material.extensions.drawBuffers,\n\t\t\textensionShaderTextureLOD: material.extensions && material.extensions.shaderTextureLOD,\n\n\t\t\trendererExtensionFragDepth: isWebGL2 || extensions.has( 'EXT_frag_depth' ),\n\t\t\trendererExtensionDrawBuffers: isWebGL2 || extensions.has( 'WEBGL_draw_buffers' ),\n\t\t\trendererExtensionShaderTextureLod: isWebGL2 || extensions.has( 'EXT_shader_texture_lod' ),\n\n\t\t\tcustomProgramCacheKey: material.customProgramCacheKey()\n\n\t\t};\n\n\t\treturn parameters;\n\n\t}\n\n\tfunction getProgramCacheKey( parameters ) {\n\n\t\tconst array = [];\n\n\t\tif ( parameters.shaderID ) {\n\n\t\t\tarray.push( parameters.shaderID );\n\n\t\t} else {\n\n\t\t\tarray.push( parameters.customVertexShaderID );\n\t\t\tarray.push( parameters.customFragmentShaderID );\n\n\t\t}\n\n\t\tif ( parameters.defines !== undefined ) {\n\n\t\t\tfor ( const name in parameters.defines ) {\n\n\t\t\t\tarray.push( name );\n\t\t\t\tarray.push( parameters.defines[ name ] );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( parameters.isRawShaderMaterial === false ) {\n\n\t\t\tgetProgramCacheKeyParameters( array, parameters );\n\t\t\tgetProgramCacheKeyBooleans( array, parameters );\n\t\t\tarray.push( renderer.outputEncoding );\n\n\t\t}\n\n\t\tarray.push( parameters.customProgramCacheKey );\n\n\t\treturn array.join();\n\n\t}\n\n\tfunction getProgramCacheKeyParameters( array, parameters ) {\n\n\t\tarray.push( parameters.precision );\n\t\tarray.push( parameters.outputEncoding );\n\t\tarray.push( parameters.envMapMode );\n\t\tarray.push( parameters.envMapCubeUVHeight );\n\t\tarray.push( parameters.combine );\n\t\tarray.push( parameters.vertexUvs );\n\t\tarray.push( parameters.fogExp2 );\n\t\tarray.push( parameters.sizeAttenuation );\n\t\tarray.push( parameters.morphTargetsCount );\n\t\tarray.push( parameters.morphAttributeCount );\n\t\tarray.push( parameters.numDirLights );\n\t\tarray.push( parameters.numPointLights );\n\t\tarray.push( parameters.numSpotLights );\n\t\tarray.push( parameters.numSpotLightMaps );\n\t\tarray.push( parameters.numHemiLights );\n\t\tarray.push( parameters.numRectAreaLights );\n\t\tarray.push( parameters.numDirLightShadows );\n\t\tarray.push( parameters.numPointLightShadows );\n\t\tarray.push( parameters.numSpotLightShadows );\n\t\tarray.push( parameters.numSpotLightShadowsWithMaps );\n\t\tarray.push( parameters.shadowMapType );\n\t\tarray.push( parameters.toneMapping );\n\t\tarray.push( parameters.numClippingPlanes );\n\t\tarray.push( parameters.numClipIntersection );\n\t\tarray.push( parameters.depthPacking );\n\n\t}\n\n\tfunction getProgramCacheKeyBooleans( array, parameters ) {\n\n\t\t_programLayers.disableAll();\n\n\t\tif ( parameters.isWebGL2 )\n\t\t\t_programLayers.enable( 0 );\n\t\tif ( parameters.supportsVertexTextures )\n\t\t\t_programLayers.enable( 1 );\n\t\tif ( parameters.instancing )\n\t\t\t_programLayers.enable( 2 );\n\t\tif ( parameters.instancingColor )\n\t\t\t_programLayers.enable( 3 );\n\t\tif ( parameters.map )\n\t\t\t_programLayers.enable( 4 );\n\t\tif ( parameters.matcap )\n\t\t\t_programLayers.enable( 5 );\n\t\tif ( parameters.envMap )\n\t\t\t_programLayers.enable( 6 );\n\t\tif ( parameters.lightMap )\n\t\t\t_programLayers.enable( 7 );\n\t\tif ( parameters.aoMap )\n\t\t\t_programLayers.enable( 8 );\n\t\tif ( parameters.emissiveMap )\n\t\t\t_programLayers.enable( 9 );\n\t\tif ( parameters.bumpMap )\n\t\t\t_programLayers.enable( 10 );\n\t\tif ( parameters.normalMap )\n\t\t\t_programLayers.enable( 11 );\n\t\tif ( parameters.objectSpaceNormalMap )\n\t\t\t_programLayers.enable( 12 );\n\t\tif ( parameters.tangentSpaceNormalMap )\n\t\t\t_programLayers.enable( 13 );\n\t\tif ( parameters.clearcoat )\n\t\t\t_programLayers.enable( 14 );\n\t\tif ( parameters.clearcoatMap )\n\t\t\t_programLayers.enable( 15 );\n\t\tif ( parameters.clearcoatRoughnessMap )\n\t\t\t_programLayers.enable( 16 );\n\t\tif ( parameters.clearcoatNormalMap )\n\t\t\t_programLayers.enable( 17 );\n\t\tif ( parameters.iridescence )\n\t\t\t_programLayers.enable( 18 );\n\t\tif ( parameters.iridescenceMap )\n\t\t\t_programLayers.enable( 19 );\n\t\tif ( parameters.iridescenceThicknessMap )\n\t\t\t_programLayers.enable( 20 );\n\t\tif ( parameters.displacementMap )\n\t\t\t_programLayers.enable( 21 );\n\t\tif ( parameters.specularMap )\n\t\t\t_programLayers.enable( 22 );\n\t\tif ( parameters.roughnessMap )\n\t\t\t_programLayers.enable( 23 );\n\t\tif ( parameters.metalnessMap )\n\t\t\t_programLayers.enable( 24 );\n\t\tif ( parameters.gradientMap )\n\t\t\t_programLayers.enable( 25 );\n\t\tif ( parameters.alphaMap )\n\t\t\t_programLayers.enable( 26 );\n\t\tif ( parameters.alphaTest )\n\t\t\t_programLayers.enable( 27 );\n\t\tif ( parameters.vertexColors )\n\t\t\t_programLayers.enable( 28 );\n\t\tif ( parameters.vertexAlphas )\n\t\t\t_programLayers.enable( 29 );\n\t\tif ( parameters.vertexUvs )\n\t\t\t_programLayers.enable( 30 );\n\t\tif ( parameters.vertexTangents )\n\t\t\t_programLayers.enable( 31 );\n\t\tif ( parameters.uvsVertexOnly )\n\t\t\t_programLayers.enable( 32 );\n\n\t\tarray.push( _programLayers.mask );\n\t\t_programLayers.disableAll();\n\n\t\tif ( parameters.fog )\n\t\t\t_programLayers.enable( 0 );\n\t\tif ( parameters.useFog )\n\t\t\t_programLayers.enable( 1 );\n\t\tif ( parameters.flatShading )\n\t\t\t_programLayers.enable( 2 );\n\t\tif ( parameters.logarithmicDepthBuffer )\n\t\t\t_programLayers.enable( 3 );\n\t\tif ( parameters.skinning )\n\t\t\t_programLayers.enable( 4 );\n\t\tif ( parameters.morphTargets )\n\t\t\t_programLayers.enable( 5 );\n\t\tif ( parameters.morphNormals )\n\t\t\t_programLayers.enable( 6 );\n\t\tif ( parameters.morphColors )\n\t\t\t_programLayers.enable( 7 );\n\t\tif ( parameters.premultipliedAlpha )\n\t\t\t_programLayers.enable( 8 );\n\t\tif ( parameters.shadowMapEnabled )\n\t\t\t_programLayers.enable( 9 );\n\t\tif ( parameters.physicallyCorrectLights )\n\t\t\t_programLayers.enable( 10 );\n\t\tif ( parameters.doubleSided )\n\t\t\t_programLayers.enable( 11 );\n\t\tif ( parameters.flipSided )\n\t\t\t_programLayers.enable( 12 );\n\t\tif ( parameters.useDepthPacking )\n\t\t\t_programLayers.enable( 13 );\n\t\tif ( parameters.dithering )\n\t\t\t_programLayers.enable( 14 );\n\t\tif ( parameters.specularIntensityMap )\n\t\t\t_programLayers.enable( 15 );\n\t\tif ( parameters.specularColorMap )\n\t\t\t_programLayers.enable( 16 );\n\t\tif ( parameters.transmission )\n\t\t\t_programLayers.enable( 17 );\n\t\tif ( parameters.transmissionMap )\n\t\t\t_programLayers.enable( 18 );\n\t\tif ( parameters.thicknessMap )\n\t\t\t_programLayers.enable( 19 );\n\t\tif ( parameters.sheen )\n\t\t\t_programLayers.enable( 20 );\n\t\tif ( parameters.sheenColorMap )\n\t\t\t_programLayers.enable( 21 );\n\t\tif ( parameters.sheenRoughnessMap )\n\t\t\t_programLayers.enable( 22 );\n\t\tif ( parameters.decodeVideoTexture )\n\t\t\t_programLayers.enable( 23 );\n\t\tif ( parameters.opaque )\n\t\t\t_programLayers.enable( 24 );\n\n\t\tarray.push( _programLayers.mask );\n\n\t}\n\n\tfunction getUniforms( material ) {\n\n\t\tconst shaderID = shaderIDs[ material.type ];\n\t\tlet uniforms;\n\n\t\tif ( shaderID ) {\n\n\t\t\tconst shader = ShaderLib[ shaderID ];\n\t\t\tuniforms = UniformsUtils.clone( shader.uniforms );\n\n\t\t} else {\n\n\t\t\tuniforms = material.uniforms;\n\n\t\t}\n\n\t\treturn uniforms;\n\n\t}\n\n\tfunction acquireProgram( parameters, cacheKey ) {\n\n\t\tlet program;\n\n\t\t// Check if code has been already compiled\n\t\tfor ( let p = 0, pl = programs.length; p < pl; p ++ ) {\n\n\t\t\tconst preexistingProgram = programs[ p ];\n\n\t\t\tif ( preexistingProgram.cacheKey === cacheKey ) {\n\n\t\t\t\tprogram = preexistingProgram;\n\t\t\t\t++ program.usedTimes;\n\n\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( program === undefined ) {\n\n\t\t\tprogram = new WebGLProgram( renderer, cacheKey, parameters, bindingStates );\n\t\t\tprograms.push( program );\n\n\t\t}\n\n\t\treturn program;\n\n\t}\n\n\tfunction releaseProgram( program ) {\n\n\t\tif ( -- program.usedTimes === 0 ) {\n\n\t\t\t// Remove from unordered set\n\t\t\tconst i = programs.indexOf( program );\n\t\t\tprograms[ i ] = programs[ programs.length - 1 ];\n\t\t\tprograms.pop();\n\n\t\t\t// Free WebGL resources\n\t\t\tprogram.destroy();\n\n\t\t}\n\n\t}\n\n\tfunction releaseShaderCache( material ) {\n\n\t\t_customShaders.remove( material );\n\n\t}\n\n\tfunction dispose() {\n\n\t\t_customShaders.dispose();\n\n\t}\n\n\treturn {\n\t\tgetParameters: getParameters,\n\t\tgetProgramCacheKey: getProgramCacheKey,\n\t\tgetUniforms: getUniforms,\n\t\tacquireProgram: acquireProgram,\n\t\treleaseProgram: releaseProgram,\n\t\treleaseShaderCache: releaseShaderCache,\n\t\t// Exposed for resource monitoring & error feedback via renderer.info:\n\t\tprograms: programs,\n\t\tdispose: dispose\n\t};\n\n}\n\nfunction WebGLProperties() {\n\n\tlet properties = new WeakMap();\n\n\tfunction get( object ) {\n\n\t\tlet map = properties.get( object );\n\n\t\tif ( map === undefined ) {\n\n\t\t\tmap = {};\n\t\t\tproperties.set( object, map );\n\n\t\t}\n\n\t\treturn map;\n\n\t}\n\n\tfunction remove( object ) {\n\n\t\tproperties.delete( object );\n\n\t}\n\n\tfunction update( object, key, value ) {\n\n\t\tproperties.get( object )[ key ] = value;\n\n\t}\n\n\tfunction dispose() {\n\n\t\tproperties = new WeakMap();\n\n\t}\n\n\treturn {\n\t\tget: get,\n\t\tremove: remove,\n\t\tupdate: update,\n\t\tdispose: dispose\n\t};\n\n}\n\nfunction painterSortStable( a, b ) {\n\n\tif ( a.groupOrder !== b.groupOrder ) {\n\n\t\treturn a.groupOrder - b.groupOrder;\n\n\t} else if ( a.renderOrder !== b.renderOrder ) {\n\n\t\treturn a.renderOrder - b.renderOrder;\n\n\t} else if ( a.material.id !== b.material.id ) {\n\n\t\treturn a.material.id - b.material.id;\n\n\t} else if ( a.z !== b.z ) {\n\n\t\treturn a.z - b.z;\n\n\t} else {\n\n\t\treturn a.id - b.id;\n\n\t}\n\n}\n\nfunction reversePainterSortStable( a, b ) {\n\n\tif ( a.groupOrder !== b.groupOrder ) {\n\n\t\treturn a.groupOrder - b.groupOrder;\n\n\t} else if ( a.renderOrder !== b.renderOrder ) {\n\n\t\treturn a.renderOrder - b.renderOrder;\n\n\t} else if ( a.z !== b.z ) {\n\n\t\treturn b.z - a.z;\n\n\t} else {\n\n\t\treturn a.id - b.id;\n\n\t}\n\n}\n\n\nfunction WebGLRenderList() {\n\n\tconst renderItems = [];\n\tlet renderItemsIndex = 0;\n\n\tconst opaque = [];\n\tconst transmissive = [];\n\tconst transparent = [];\n\n\tfunction init() {\n\n\t\trenderItemsIndex = 0;\n\n\t\topaque.length = 0;\n\t\ttransmissive.length = 0;\n\t\ttransparent.length = 0;\n\n\t}\n\n\tfunction getNextRenderItem( object, geometry, material, groupOrder, z, group ) {\n\n\t\tlet renderItem = renderItems[ renderItemsIndex ];\n\n\t\tif ( renderItem === undefined ) {\n\n\t\t\trenderItem = {\n\t\t\t\tid: object.id,\n\t\t\t\tobject: object,\n\t\t\t\tgeometry: geometry,\n\t\t\t\tmaterial: material,\n\t\t\t\tgroupOrder: groupOrder,\n\t\t\t\trenderOrder: object.renderOrder,\n\t\t\t\tz: z,\n\t\t\t\tgroup: group\n\t\t\t};\n\n\t\t\trenderItems[ renderItemsIndex ] = renderItem;\n\n\t\t} else {\n\n\t\t\trenderItem.id = object.id;\n\t\t\trenderItem.object = object;\n\t\t\trenderItem.geometry = geometry;\n\t\t\trenderItem.material = material;\n\t\t\trenderItem.groupOrder = groupOrder;\n\t\t\trenderItem.renderOrder = object.renderOrder;\n\t\t\trenderItem.z = z;\n\t\t\trenderItem.group = group;\n\n\t\t}\n\n\t\trenderItemsIndex ++;\n\n\t\treturn renderItem;\n\n\t}\n\n\tfunction push( object, geometry, material, groupOrder, z, group ) {\n\n\t\tconst renderItem = getNextRenderItem( object, geometry, material, groupOrder, z, group );\n\n\t\tif ( material.transmission > 0.0 ) {\n\n\t\t\ttransmissive.push( renderItem );\n\n\t\t} else if ( material.transparent === true ) {\n\n\t\t\ttransparent.push( renderItem );\n\n\t\t} else {\n\n\t\t\topaque.push( renderItem );\n\n\t\t}\n\n\t}\n\n\tfunction unshift( object, geometry, material, groupOrder, z, group ) {\n\n\t\tconst renderItem = getNextRenderItem( object, geometry, material, groupOrder, z, group );\n\n\t\tif ( material.transmission > 0.0 ) {\n\n\t\t\ttransmissive.unshift( renderItem );\n\n\t\t} else if ( material.transparent === true ) {\n\n\t\t\ttransparent.unshift( renderItem );\n\n\t\t} else {\n\n\t\t\topaque.unshift( renderItem );\n\n\t\t}\n\n\t}\n\n\tfunction sort( customOpaqueSort, customTransparentSort ) {\n\n\t\tif ( opaque.length > 1 ) opaque.sort( customOpaqueSort || painterSortStable );\n\t\tif ( transmissive.length > 1 ) transmissive.sort( customTransparentSort || reversePainterSortStable );\n\t\tif ( transparent.length > 1 ) transparent.sort( customTransparentSort || reversePainterSortStable );\n\n\t}\n\n\tfunction finish() {\n\n\t\t// Clear references from inactive renderItems in the list\n\n\t\tfor ( let i = renderItemsIndex, il = renderItems.length; i < il; i ++ ) {\n\n\t\t\tconst renderItem = renderItems[ i ];\n\n\t\t\tif ( renderItem.id === null ) break;\n\n\t\t\trenderItem.id = null;\n\t\t\trenderItem.object = null;\n\t\t\trenderItem.geometry = null;\n\t\t\trenderItem.material = null;\n\t\t\trenderItem.group = null;\n\n\t\t}\n\n\t}\n\n\treturn {\n\n\t\topaque: opaque,\n\t\ttransmissive: transmissive,\n\t\ttransparent: transparent,\n\n\t\tinit: init,\n\t\tpush: push,\n\t\tunshift: unshift,\n\t\tfinish: finish,\n\n\t\tsort: sort\n\t};\n\n}\n\nfunction WebGLRenderLists() {\n\n\tlet lists = new WeakMap();\n\n\tfunction get( scene, renderCallDepth ) {\n\n\t\tconst listArray = lists.get( scene );\n\t\tlet list;\n\n\t\tif ( listArray === undefined ) {\n\n\t\t\tlist = new WebGLRenderList();\n\t\t\tlists.set( scene, [ list ] );\n\n\t\t} else {\n\n\t\t\tif ( renderCallDepth >= listArray.length ) {\n\n\t\t\t\tlist = new WebGLRenderList();\n\t\t\t\tlistArray.push( list );\n\n\t\t\t} else {\n\n\t\t\t\tlist = listArray[ renderCallDepth ];\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn list;\n\n\t}\n\n\tfunction dispose() {\n\n\t\tlists = new WeakMap();\n\n\t}\n\n\treturn {\n\t\tget: get,\n\t\tdispose: dispose\n\t};\n\n}\n\nfunction UniformsCache() {\n\n\tconst lights = {};\n\n\treturn {\n\n\t\tget: function ( light ) {\n\n\t\t\tif ( lights[ light.id ] !== undefined ) {\n\n\t\t\t\treturn lights[ light.id ];\n\n\t\t\t}\n\n\t\t\tlet uniforms;\n\n\t\t\tswitch ( light.type ) {\n\n\t\t\t\tcase 'DirectionalLight':\n\t\t\t\t\tuniforms = {\n\t\t\t\t\t\tdirection: new Vector3(),\n\t\t\t\t\t\tcolor: new Color()\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'SpotLight':\n\t\t\t\t\tuniforms = {\n\t\t\t\t\t\tposition: new Vector3(),\n\t\t\t\t\t\tdirection: new Vector3(),\n\t\t\t\t\t\tcolor: new Color(),\n\t\t\t\t\t\tdistance: 0,\n\t\t\t\t\t\tconeCos: 0,\n\t\t\t\t\t\tpenumbraCos: 0,\n\t\t\t\t\t\tdecay: 0\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'PointLight':\n\t\t\t\t\tuniforms = {\n\t\t\t\t\t\tposition: new Vector3(),\n\t\t\t\t\t\tcolor: new Color(),\n\t\t\t\t\t\tdistance: 0,\n\t\t\t\t\t\tdecay: 0\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'HemisphereLight':\n\t\t\t\t\tuniforms = {\n\t\t\t\t\t\tdirection: new Vector3(),\n\t\t\t\t\t\tskyColor: new Color(),\n\t\t\t\t\t\tgroundColor: new Color()\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'RectAreaLight':\n\t\t\t\t\tuniforms = {\n\t\t\t\t\t\tcolor: new Color(),\n\t\t\t\t\t\tposition: new Vector3(),\n\t\t\t\t\t\thalfWidth: new Vector3(),\n\t\t\t\t\t\thalfHeight: new Vector3()\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tlights[ light.id ] = uniforms;\n\n\t\t\treturn uniforms;\n\n\t\t}\n\n\t};\n\n}\n\nfunction ShadowUniformsCache() {\n\n\tconst lights = {};\n\n\treturn {\n\n\t\tget: function ( light ) {\n\n\t\t\tif ( lights[ light.id ] !== undefined ) {\n\n\t\t\t\treturn lights[ light.id ];\n\n\t\t\t}\n\n\t\t\tlet uniforms;\n\n\t\t\tswitch ( light.type ) {\n\n\t\t\t\tcase 'DirectionalLight':\n\t\t\t\t\tuniforms = {\n\t\t\t\t\t\tshadowBias: 0,\n\t\t\t\t\t\tshadowNormalBias: 0,\n\t\t\t\t\t\tshadowRadius: 1,\n\t\t\t\t\t\tshadowMapSize: new Vector2()\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'SpotLight':\n\t\t\t\t\tuniforms = {\n\t\t\t\t\t\tshadowBias: 0,\n\t\t\t\t\t\tshadowNormalBias: 0,\n\t\t\t\t\t\tshadowRadius: 1,\n\t\t\t\t\t\tshadowMapSize: new Vector2()\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'PointLight':\n\t\t\t\t\tuniforms = {\n\t\t\t\t\t\tshadowBias: 0,\n\t\t\t\t\t\tshadowNormalBias: 0,\n\t\t\t\t\t\tshadowRadius: 1,\n\t\t\t\t\t\tshadowMapSize: new Vector2(),\n\t\t\t\t\t\tshadowCameraNear: 1,\n\t\t\t\t\t\tshadowCameraFar: 1000\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\n\t\t\t\t// TODO (abelnation): set RectAreaLight shadow uniforms\n\n\t\t\t}\n\n\t\t\tlights[ light.id ] = uniforms;\n\n\t\t\treturn uniforms;\n\n\t\t}\n\n\t};\n\n}\n\n\n\nlet nextVersion = 0;\n\nfunction shadowCastingAndTexturingLightsFirst( lightA, lightB ) {\n\n\treturn ( lightB.castShadow ? 2 : 0 ) - ( lightA.castShadow ? 2 : 0 ) + ( lightB.map ? 1 : 0 ) - ( lightA.map ? 1 : 0 );\n\n}\n\nfunction WebGLLights( extensions, capabilities ) {\n\n\tconst cache = new UniformsCache();\n\n\tconst shadowCache = ShadowUniformsCache();\n\n\tconst state = {\n\n\t\tversion: 0,\n\n\t\thash: {\n\t\t\tdirectionalLength: - 1,\n\t\t\tpointLength: - 1,\n\t\t\tspotLength: - 1,\n\t\t\trectAreaLength: - 1,\n\t\t\themiLength: - 1,\n\n\t\t\tnumDirectionalShadows: - 1,\n\t\t\tnumPointShadows: - 1,\n\t\t\tnumSpotShadows: - 1,\n\t\t\tnumSpotMaps: - 1\n\t\t},\n\n\t\tambient: [ 0, 0, 0 ],\n\t\tprobe: [],\n\t\tdirectional: [],\n\t\tdirectionalShadow: [],\n\t\tdirectionalShadowMap: [],\n\t\tdirectionalShadowMatrix: [],\n\t\tspot: [],\n\t\tspotLightMap: [],\n\t\tspotShadow: [],\n\t\tspotShadowMap: [],\n\t\tspotLightMatrix: [],\n\t\trectArea: [],\n\t\trectAreaLTC1: null,\n\t\trectAreaLTC2: null,\n\t\tpoint: [],\n\t\tpointShadow: [],\n\t\tpointShadowMap: [],\n\t\tpointShadowMatrix: [],\n\t\themi: [],\n\t\tnumSpotLightShadowsWithMaps: 0\n\n\t};\n\n\tfor ( let i = 0; i < 9; i ++ ) state.probe.push( new Vector3() );\n\n\tconst vector3 = new Vector3();\n\tconst matrix4 = new Matrix4();\n\tconst matrix42 = new Matrix4();\n\n\tfunction setup( lights, physicallyCorrectLights ) {\n\n\t\tlet r = 0, g = 0, b = 0;\n\n\t\tfor ( let i = 0; i < 9; i ++ ) state.probe[ i ].set( 0, 0, 0 );\n\n\t\tlet directionalLength = 0;\n\t\tlet pointLength = 0;\n\t\tlet spotLength = 0;\n\t\tlet rectAreaLength = 0;\n\t\tlet hemiLength = 0;\n\n\t\tlet numDirectionalShadows = 0;\n\t\tlet numPointShadows = 0;\n\t\tlet numSpotShadows = 0;\n\t\tlet numSpotMaps = 0;\n\t\tlet numSpotShadowsWithMaps = 0;\n\n\t\t// ordering : [shadow casting + map texturing, map texturing, shadow casting, none ]\n\t\tlights.sort( shadowCastingAndTexturingLightsFirst );\n\n\t\t// artist-friendly light intensity scaling factor\n\t\tconst scaleFactor = ( physicallyCorrectLights !== true ) ? Math.PI : 1;\n\n\t\tfor ( let i = 0, l = lights.length; i < l; i ++ ) {\n\n\t\t\tconst light = lights[ i ];\n\n\t\t\tconst color = light.color;\n\t\t\tconst intensity = light.intensity;\n\t\t\tconst distance = light.distance;\n\n\t\t\tconst shadowMap = ( light.shadow && light.shadow.map ) ? light.shadow.map.texture : null;\n\n\t\t\tif ( light.isAmbientLight ) {\n\n\t\t\t\tr += color.r * intensity * scaleFactor;\n\t\t\t\tg += color.g * intensity * scaleFactor;\n\t\t\t\tb += color.b * intensity * scaleFactor;\n\n\t\t\t} else if ( light.isLightProbe ) {\n\n\t\t\t\tfor ( let j = 0; j < 9; j ++ ) {\n\n\t\t\t\t\tstate.probe[ j ].addScaledVector( light.sh.coefficients[ j ], intensity );\n\n\t\t\t\t}\n\n\t\t\t} else if ( light.isDirectionalLight ) {\n\n\t\t\t\tconst uniforms = cache.get( light );\n\n\t\t\t\tuniforms.color.copy( light.color ).multiplyScalar( light.intensity * scaleFactor );\n\n\t\t\t\tif ( light.castShadow ) {\n\n\t\t\t\t\tconst shadow = light.shadow;\n\n\t\t\t\t\tconst shadowUniforms = shadowCache.get( light );\n\n\t\t\t\t\tshadowUniforms.shadowBias = shadow.bias;\n\t\t\t\t\tshadowUniforms.shadowNormalBias = shadow.normalBias;\n\t\t\t\t\tshadowUniforms.shadowRadius = shadow.radius;\n\t\t\t\t\tshadowUniforms.shadowMapSize = shadow.mapSize;\n\n\t\t\t\t\tstate.directionalShadow[ directionalLength ] = shadowUniforms;\n\t\t\t\t\tstate.directionalShadowMap[ directionalLength ] = shadowMap;\n\t\t\t\t\tstate.directionalShadowMatrix[ directionalLength ] = light.shadow.matrix;\n\n\t\t\t\t\tnumDirectionalShadows ++;\n\n\t\t\t\t}\n\n\t\t\t\tstate.directional[ directionalLength ] = uniforms;\n\n\t\t\t\tdirectionalLength ++;\n\n\t\t\t} else if ( light.isSpotLight ) {\n\n\t\t\t\tconst uniforms = cache.get( light );\n\n\t\t\t\tuniforms.position.setFromMatrixPosition( light.matrixWorld );\n\n\t\t\t\tuniforms.color.copy( color ).multiplyScalar( intensity * scaleFactor );\n\t\t\t\tuniforms.distance = distance;\n\n\t\t\t\tuniforms.coneCos = Math.cos( light.angle );\n\t\t\t\tuniforms.penumbraCos = Math.cos( light.angle * ( 1 - light.penumbra ) );\n\t\t\t\tuniforms.decay = light.decay;\n\n\t\t\t\tstate.spot[ spotLength ] = uniforms;\n\n\t\t\t\tconst shadow = light.shadow;\n\n\t\t\t\tif ( light.map ) {\n\n\t\t\t\t\tstate.spotLightMap[ numSpotMaps ] = light.map;\n\t\t\t\t\tnumSpotMaps ++;\n\n\t\t\t\t\t// make sure the lightMatrix is up to date\n\t\t\t\t\t// TODO : do it if required only\n\t\t\t\t\tshadow.updateMatrices( light );\n\n\t\t\t\t\tif ( light.castShadow ) numSpotShadowsWithMaps ++;\n\n\t\t\t\t}\n\n\t\t\t\tstate.spotLightMatrix[ spotLength ] = shadow.matrix;\n\n\t\t\t\tif ( light.castShadow ) {\n\n\t\t\t\t\tconst shadowUniforms = shadowCache.get( light );\n\n\t\t\t\t\tshadowUniforms.shadowBias = shadow.bias;\n\t\t\t\t\tshadowUniforms.shadowNormalBias = shadow.normalBias;\n\t\t\t\t\tshadowUniforms.shadowRadius = shadow.radius;\n\t\t\t\t\tshadowUniforms.shadowMapSize = shadow.mapSize;\n\n\t\t\t\t\tstate.spotShadow[ spotLength ] = shadowUniforms;\n\t\t\t\t\tstate.spotShadowMap[ spotLength ] = shadowMap;\n\n\t\t\t\t\tnumSpotShadows ++;\n\n\t\t\t\t}\n\n\t\t\t\tspotLength ++;\n\n\t\t\t} else if ( light.isRectAreaLight ) {\n\n\t\t\t\tconst uniforms = cache.get( light );\n\n\t\t\t\tuniforms.color.copy( color ).multiplyScalar( intensity );\n\n\t\t\t\tuniforms.halfWidth.set( light.width * 0.5, 0.0, 0.0 );\n\t\t\t\tuniforms.halfHeight.set( 0.0, light.height * 0.5, 0.0 );\n\n\t\t\t\tstate.rectArea[ rectAreaLength ] = uniforms;\n\n\t\t\t\trectAreaLength ++;\n\n\t\t\t} else if ( light.isPointLight ) {\n\n\t\t\t\tconst uniforms = cache.get( light );\n\n\t\t\t\tuniforms.color.copy( light.color ).multiplyScalar( light.intensity * scaleFactor );\n\t\t\t\tuniforms.distance = light.distance;\n\t\t\t\tuniforms.decay = light.decay;\n\n\t\t\t\tif ( light.castShadow ) {\n\n\t\t\t\t\tconst shadow = light.shadow;\n\n\t\t\t\t\tconst shadowUniforms = shadowCache.get( light );\n\n\t\t\t\t\tshadowUniforms.shadowBias = shadow.bias;\n\t\t\t\t\tshadowUniforms.shadowNormalBias = shadow.normalBias;\n\t\t\t\t\tshadowUniforms.shadowRadius = shadow.radius;\n\t\t\t\t\tshadowUniforms.shadowMapSize = shadow.mapSize;\n\t\t\t\t\tshadowUniforms.shadowCameraNear = shadow.camera.near;\n\t\t\t\t\tshadowUniforms.shadowCameraFar = shadow.camera.far;\n\n\t\t\t\t\tstate.pointShadow[ pointLength ] = shadowUniforms;\n\t\t\t\t\tstate.pointShadowMap[ pointLength ] = shadowMap;\n\t\t\t\t\tstate.pointShadowMatrix[ pointLength ] = light.shadow.matrix;\n\n\t\t\t\t\tnumPointShadows ++;\n\n\t\t\t\t}\n\n\t\t\t\tstate.point[ pointLength ] = uniforms;\n\n\t\t\t\tpointLength ++;\n\n\t\t\t} else if ( light.isHemisphereLight ) {\n\n\t\t\t\tconst uniforms = cache.get( light );\n\n\t\t\t\tuniforms.skyColor.copy( light.color ).multiplyScalar( intensity * scaleFactor );\n\t\t\t\tuniforms.groundColor.copy( light.groundColor ).multiplyScalar( intensity * scaleFactor );\n\n\t\t\t\tstate.hemi[ hemiLength ] = uniforms;\n\n\t\t\t\themiLength ++;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( rectAreaLength > 0 ) {\n\n\t\t\tif ( capabilities.isWebGL2 ) {\n\n\t\t\t\t// WebGL 2\n\n\t\t\t\tstate.rectAreaLTC1 = UniformsLib.LTC_FLOAT_1;\n\t\t\t\tstate.rectAreaLTC2 = UniformsLib.LTC_FLOAT_2;\n\n\t\t\t} else {\n\n\t\t\t\t// WebGL 1\n\n\t\t\t\tif ( extensions.has( 'OES_texture_float_linear' ) === true ) {\n\n\t\t\t\t\tstate.rectAreaLTC1 = UniformsLib.LTC_FLOAT_1;\n\t\t\t\t\tstate.rectAreaLTC2 = UniformsLib.LTC_FLOAT_2;\n\n\t\t\t\t} else if ( extensions.has( 'OES_texture_half_float_linear' ) === true ) {\n\n\t\t\t\t\tstate.rectAreaLTC1 = UniformsLib.LTC_HALF_1;\n\t\t\t\t\tstate.rectAreaLTC2 = UniformsLib.LTC_HALF_2;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( 'THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.' );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tstate.ambient[ 0 ] = r;\n\t\tstate.ambient[ 1 ] = g;\n\t\tstate.ambient[ 2 ] = b;\n\n\t\tconst hash = state.hash;\n\n\t\tif ( hash.directionalLength !== directionalLength ||\n\t\t\thash.pointLength !== pointLength ||\n\t\t\thash.spotLength !== spotLength ||\n\t\t\thash.rectAreaLength !== rectAreaLength ||\n\t\t\thash.hemiLength !== hemiLength ||\n\t\t\thash.numDirectionalShadows !== numDirectionalShadows ||\n\t\t\thash.numPointShadows !== numPointShadows ||\n\t\t\thash.numSpotShadows !== numSpotShadows ||\n\t\t\thash.numSpotMaps !== numSpotMaps ) {\n\n\t\t\tstate.directional.length = directionalLength;\n\t\t\tstate.spot.length = spotLength;\n\t\t\tstate.rectArea.length = rectAreaLength;\n\t\t\tstate.point.length = pointLength;\n\t\t\tstate.hemi.length = hemiLength;\n\n\t\t\tstate.directionalShadow.length = numDirectionalShadows;\n\t\t\tstate.directionalShadowMap.length = numDirectionalShadows;\n\t\t\tstate.pointShadow.length = numPointShadows;\n\t\t\tstate.pointShadowMap.length = numPointShadows;\n\t\t\tstate.spotShadow.length = numSpotShadows;\n\t\t\tstate.spotShadowMap.length = numSpotShadows;\n\t\t\tstate.directionalShadowMatrix.length = numDirectionalShadows;\n\t\t\tstate.pointShadowMatrix.length = numPointShadows;\n\t\t\tstate.spotLightMatrix.length = numSpotShadows + numSpotMaps - numSpotShadowsWithMaps;\n\t\t\tstate.spotLightMap.length = numSpotMaps;\n\t\t\tstate.numSpotLightShadowsWithMaps = numSpotShadowsWithMaps;\n\n\t\t\thash.directionalLength = directionalLength;\n\t\t\thash.pointLength = pointLength;\n\t\t\thash.spotLength = spotLength;\n\t\t\thash.rectAreaLength = rectAreaLength;\n\t\t\thash.hemiLength = hemiLength;\n\n\t\t\thash.numDirectionalShadows = numDirectionalShadows;\n\t\t\thash.numPointShadows = numPointShadows;\n\t\t\thash.numSpotShadows = numSpotShadows;\n\t\t\thash.numSpotMaps = numSpotMaps;\n\n\t\t\tstate.version = nextVersion ++;\n\n\t\t}\n\n\t}\n\n\tfunction setupView( lights, camera ) {\n\n\t\tlet directionalLength = 0;\n\t\tlet pointLength = 0;\n\t\tlet spotLength = 0;\n\t\tlet rectAreaLength = 0;\n\t\tlet hemiLength = 0;\n\n\t\tconst viewMatrix = camera.matrixWorldInverse;\n\n\t\tfor ( let i = 0, l = lights.length; i < l; i ++ ) {\n\n\t\t\tconst light = lights[ i ];\n\n\t\t\tif ( light.isDirectionalLight ) {\n\n\t\t\t\tconst uniforms = state.directional[ directionalLength ];\n\n\t\t\t\tuniforms.direction.setFromMatrixPosition( light.matrixWorld );\n\t\t\t\tvector3.setFromMatrixPosition( light.target.matrixWorld );\n\t\t\t\tuniforms.direction.sub( vector3 );\n\t\t\t\tuniforms.direction.transformDirection( viewMatrix );\n\n\t\t\t\tdirectionalLength ++;\n\n\t\t\t} else if ( light.isSpotLight ) {\n\n\t\t\t\tconst uniforms = state.spot[ spotLength ];\n\n\t\t\t\tuniforms.position.setFromMatrixPosition( light.matrixWorld );\n\t\t\t\tuniforms.position.applyMatrix4( viewMatrix );\n\n\t\t\t\tuniforms.direction.setFromMatrixPosition( light.matrixWorld );\n\t\t\t\tvector3.setFromMatrixPosition( light.target.matrixWorld );\n\t\t\t\tuniforms.direction.sub( vector3 );\n\t\t\t\tuniforms.direction.transformDirection( viewMatrix );\n\n\t\t\t\tspotLength ++;\n\n\t\t\t} else if ( light.isRectAreaLight ) {\n\n\t\t\t\tconst uniforms = state.rectArea[ rectAreaLength ];\n\n\t\t\t\tuniforms.position.setFromMatrixPosition( light.matrixWorld );\n\t\t\t\tuniforms.position.applyMatrix4( viewMatrix );\n\n\t\t\t\t// extract local rotation of light to derive width/height half vectors\n\t\t\t\tmatrix42.identity();\n\t\t\t\tmatrix4.copy( light.matrixWorld );\n\t\t\t\tmatrix4.premultiply( viewMatrix );\n\t\t\t\tmatrix42.extractRotation( matrix4 );\n\n\t\t\t\tuniforms.halfWidth.set( light.width * 0.5, 0.0, 0.0 );\n\t\t\t\tuniforms.halfHeight.set( 0.0, light.height * 0.5, 0.0 );\n\n\t\t\t\tuniforms.halfWidth.applyMatrix4( matrix42 );\n\t\t\t\tuniforms.halfHeight.applyMatrix4( matrix42 );\n\n\t\t\t\trectAreaLength ++;\n\n\t\t\t} else if ( light.isPointLight ) {\n\n\t\t\t\tconst uniforms = state.point[ pointLength ];\n\n\t\t\t\tuniforms.position.setFromMatrixPosition( light.matrixWorld );\n\t\t\t\tuniforms.position.applyMatrix4( viewMatrix );\n\n\t\t\t\tpointLength ++;\n\n\t\t\t} else if ( light.isHemisphereLight ) {\n\n\t\t\t\tconst uniforms = state.hemi[ hemiLength ];\n\n\t\t\t\tuniforms.direction.setFromMatrixPosition( light.matrixWorld );\n\t\t\t\tuniforms.direction.transformDirection( viewMatrix );\n\n\t\t\t\themiLength ++;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\treturn {\n\t\tsetup: setup,\n\t\tsetupView: setupView,\n\t\tstate: state\n\t};\n\n}\n\nfunction WebGLRenderState( extensions, capabilities ) {\n\n\tconst lights = new WebGLLights( extensions, capabilities );\n\n\tconst lightsArray = [];\n\tconst shadowsArray = [];\n\n\tfunction init() {\n\n\t\tlightsArray.length = 0;\n\t\tshadowsArray.length = 0;\n\n\t}\n\n\tfunction pushLight( light ) {\n\n\t\tlightsArray.push( light );\n\n\t}\n\n\tfunction pushShadow( shadowLight ) {\n\n\t\tshadowsArray.push( shadowLight );\n\n\t}\n\n\tfunction setupLights( physicallyCorrectLights ) {\n\n\t\tlights.setup( lightsArray, physicallyCorrectLights );\n\n\t}\n\n\tfunction setupLightsView( camera ) {\n\n\t\tlights.setupView( lightsArray, camera );\n\n\t}\n\n\tconst state = {\n\t\tlightsArray: lightsArray,\n\t\tshadowsArray: shadowsArray,\n\n\t\tlights: lights\n\t};\n\n\treturn {\n\t\tinit: init,\n\t\tstate: state,\n\t\tsetupLights: setupLights,\n\t\tsetupLightsView: setupLightsView,\n\n\t\tpushLight: pushLight,\n\t\tpushShadow: pushShadow\n\t};\n\n}\n\nfunction WebGLRenderStates( extensions, capabilities ) {\n\n\tlet renderStates = new WeakMap();\n\n\tfunction get( scene, renderCallDepth = 0 ) {\n\n\t\tconst renderStateArray = renderStates.get( scene );\n\t\tlet renderState;\n\n\t\tif ( renderStateArray === undefined ) {\n\n\t\t\trenderState = new WebGLRenderState( extensions, capabilities );\n\t\t\trenderStates.set( scene, [ renderState ] );\n\n\t\t} else {\n\n\t\t\tif ( renderCallDepth >= renderStateArray.length ) {\n\n\t\t\t\trenderState = new WebGLRenderState( extensions, capabilities );\n\t\t\t\trenderStateArray.push( renderState );\n\n\t\t\t} else {\n\n\t\t\t\trenderState = renderStateArray[ renderCallDepth ];\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn renderState;\n\n\t}\n\n\tfunction dispose() {\n\n\t\trenderStates = new WeakMap();\n\n\t}\n\n\treturn {\n\t\tget: get,\n\t\tdispose: dispose\n\t};\n\n}\n\nclass MeshDepthMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshDepthMaterial = true;\n\n\t\tthis.type = 'MeshDepthMaterial';\n\n\t\tthis.depthPacking = BasicDepthPacking;\n\n\t\tthis.map = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.displacementMap = null;\n\t\tthis.displacementScale = 1;\n\t\tthis.displacementBias = 0;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.depthPacking = source.depthPacking;\n\n\t\tthis.map = source.map;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.displacementMap = source.displacementMap;\n\t\tthis.displacementScale = source.displacementScale;\n\t\tthis.displacementBias = source.displacementBias;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass MeshDistanceMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshDistanceMaterial = true;\n\n\t\tthis.type = 'MeshDistanceMaterial';\n\n\t\tthis.referencePosition = new Vector3();\n\t\tthis.nearDistance = 1;\n\t\tthis.farDistance = 1000;\n\n\t\tthis.map = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.displacementMap = null;\n\t\tthis.displacementScale = 1;\n\t\tthis.displacementBias = 0;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.referencePosition.copy( source.referencePosition );\n\t\tthis.nearDistance = source.nearDistance;\n\t\tthis.farDistance = source.farDistance;\n\n\t\tthis.map = source.map;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.displacementMap = source.displacementMap;\n\t\tthis.displacementScale = source.displacementScale;\n\t\tthis.displacementBias = source.displacementBias;\n\n\t\treturn this;\n\n\t}\n\n}\n\nconst vertex = \"void main() {\\n\\tgl_Position = vec4( position, 1.0 );\\n}\";\n\nconst fragment = \"uniform sampler2D shadow_pass;\\nuniform vec2 resolution;\\nuniform float radius;\\n#include <packing>\\nvoid main() {\\n\\tconst float samples = float( VSM_SAMPLES );\\n\\tfloat mean = 0.0;\\n\\tfloat squared_mean = 0.0;\\n\\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\\n\\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\\n\\tfor ( float i = 0.0; i < samples; i ++ ) {\\n\\t\\tfloat uvOffset = uvStart + i * uvStride;\\n\\t\\t#ifdef HORIZONTAL_PASS\\n\\t\\t\\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\\n\\t\\t\\tmean += distribution.x;\\n\\t\\t\\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\\n\\t\\t#else\\n\\t\\t\\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\\n\\t\\t\\tmean += depth;\\n\\t\\t\\tsquared_mean += depth * depth;\\n\\t\\t#endif\\n\\t}\\n\\tmean = mean / samples;\\n\\tsquared_mean = squared_mean / samples;\\n\\tfloat std_dev = sqrt( squared_mean - mean * mean );\\n\\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\\n}\";\n\nfunction WebGLShadowMap( _renderer, _objects, _capabilities ) {\n\n\tlet _frustum = new Frustum();\n\n\tconst _shadowMapSize = new Vector2(),\n\t\t_viewportSize = new Vector2(),\n\n\t\t_viewport = new Vector4(),\n\n\t\t_depthMaterial = new MeshDepthMaterial( { depthPacking: RGBADepthPacking } ),\n\t\t_distanceMaterial = new MeshDistanceMaterial(),\n\n\t\t_materialCache = {},\n\n\t\t_maxTextureSize = _capabilities.maxTextureSize;\n\n\tconst shadowSide = { 0: BackSide, 1: FrontSide, 2: DoubleSide };\n\n\tconst shadowMaterialVertical = new ShaderMaterial( {\n\t\tdefines: {\n\t\t\tVSM_SAMPLES: 8\n\t\t},\n\t\tuniforms: {\n\t\t\tshadow_pass: { value: null },\n\t\t\tresolution: { value: new Vector2() },\n\t\t\tradius: { value: 4.0 }\n\t\t},\n\n\t\tvertexShader: vertex,\n\t\tfragmentShader: fragment\n\n\t} );\n\n\tconst shadowMaterialHorizontal = shadowMaterialVertical.clone();\n\tshadowMaterialHorizontal.defines.HORIZONTAL_PASS = 1;\n\n\tconst fullScreenTri = new BufferGeometry();\n\tfullScreenTri.setAttribute(\n\t\t'position',\n\t\tnew BufferAttribute(\n\t\t\tnew Float32Array( [ - 1, - 1, 0.5, 3, - 1, 0.5, - 1, 3, 0.5 ] ),\n\t\t\t3\n\t\t)\n\t);\n\n\tconst fullScreenMesh = new Mesh( fullScreenTri, shadowMaterialVertical );\n\n\tconst scope = this;\n\n\tthis.enabled = false;\n\n\tthis.autoUpdate = true;\n\tthis.needsUpdate = false;\n\n\tthis.type = PCFShadowMap;\n\n\tthis.render = function ( lights, scene, camera ) {\n\n\t\tif ( scope.enabled === false ) return;\n\t\tif ( scope.autoUpdate === false && scope.needsUpdate === false ) return;\n\n\t\tif ( lights.length === 0 ) return;\n\n\t\tconst currentRenderTarget = _renderer.getRenderTarget();\n\t\tconst activeCubeFace = _renderer.getActiveCubeFace();\n\t\tconst activeMipmapLevel = _renderer.getActiveMipmapLevel();\n\n\t\tconst _state = _renderer.state;\n\n\t\t// Set GL state for depth map.\n\t\t_state.setBlending( NoBlending );\n\t\t_state.buffers.color.setClear( 1, 1, 1, 1 );\n\t\t_state.buffers.depth.setTest( true );\n\t\t_state.setScissorTest( false );\n\n\t\t// render depth map\n\n\t\tfor ( let i = 0, il = lights.length; i < il; i ++ ) {\n\n\t\t\tconst light = lights[ i ];\n\t\t\tconst shadow = light.shadow;\n\n\t\t\tif ( shadow === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLShadowMap:', light, 'has no shadow.' );\n\t\t\t\tcontinue;\n\n\t\t\t}\n\n\t\t\tif ( shadow.autoUpdate === false && shadow.needsUpdate === false ) continue;\n\n\t\t\t_shadowMapSize.copy( shadow.mapSize );\n\n\t\t\tconst shadowFrameExtents = shadow.getFrameExtents();\n\n\t\t\t_shadowMapSize.multiply( shadowFrameExtents );\n\n\t\t\t_viewportSize.copy( shadow.mapSize );\n\n\t\t\tif ( _shadowMapSize.x > _maxTextureSize || _shadowMapSize.y > _maxTextureSize ) {\n\n\t\t\t\tif ( _shadowMapSize.x > _maxTextureSize ) {\n\n\t\t\t\t\t_viewportSize.x = Math.floor( _maxTextureSize / shadowFrameExtents.x );\n\t\t\t\t\t_shadowMapSize.x = _viewportSize.x * shadowFrameExtents.x;\n\t\t\t\t\tshadow.mapSize.x = _viewportSize.x;\n\n\t\t\t\t}\n\n\t\t\t\tif ( _shadowMapSize.y > _maxTextureSize ) {\n\n\t\t\t\t\t_viewportSize.y = Math.floor( _maxTextureSize / shadowFrameExtents.y );\n\t\t\t\t\t_shadowMapSize.y = _viewportSize.y * shadowFrameExtents.y;\n\t\t\t\t\tshadow.mapSize.y = _viewportSize.y;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( shadow.map === null ) {\n\n\t\t\t\tconst pars = ( this.type !== VSMShadowMap ) ? { minFilter: NearestFilter, magFilter: NearestFilter } : {};\n\n\t\t\t\tshadow.map = new WebGLRenderTarget( _shadowMapSize.x, _shadowMapSize.y, pars );\n\t\t\t\tshadow.map.texture.name = light.name + '.shadowMap';\n\n\t\t\t\tshadow.camera.updateProjectionMatrix();\n\n\t\t\t}\n\n\t\t\t_renderer.setRenderTarget( shadow.map );\n\t\t\t_renderer.clear();\n\n\t\t\tconst viewportCount = shadow.getViewportCount();\n\n\t\t\tfor ( let vp = 0; vp < viewportCount; vp ++ ) {\n\n\t\t\t\tconst viewport = shadow.getViewport( vp );\n\n\t\t\t\t_viewport.set(\n\t\t\t\t\t_viewportSize.x * viewport.x,\n\t\t\t\t\t_viewportSize.y * viewport.y,\n\t\t\t\t\t_viewportSize.x * viewport.z,\n\t\t\t\t\t_viewportSize.y * viewport.w\n\t\t\t\t);\n\n\t\t\t\t_state.viewport( _viewport );\n\n\t\t\t\tshadow.updateMatrices( light, vp );\n\n\t\t\t\t_frustum = shadow.getFrustum();\n\n\t\t\t\trenderObject( scene, camera, shadow.camera, light, this.type );\n\n\t\t\t}\n\n\t\t\t// do blur pass for VSM\n\n\t\t\tif ( shadow.isPointLightShadow !== true && this.type === VSMShadowMap ) {\n\n\t\t\t\tVSMPass( shadow, camera );\n\n\t\t\t}\n\n\t\t\tshadow.needsUpdate = false;\n\n\t\t}\n\n\t\tscope.needsUpdate = false;\n\n\t\t_renderer.setRenderTarget( currentRenderTarget, activeCubeFace, activeMipmapLevel );\n\n\t};\n\n\tfunction VSMPass( shadow, camera ) {\n\n\t\tconst geometry = _objects.update( fullScreenMesh );\n\n\t\tif ( shadowMaterialVertical.defines.VSM_SAMPLES !== shadow.blurSamples ) {\n\n\t\t\tshadowMaterialVertical.defines.VSM_SAMPLES = shadow.blurSamples;\n\t\t\tshadowMaterialHorizontal.defines.VSM_SAMPLES = shadow.blurSamples;\n\n\t\t\tshadowMaterialVertical.needsUpdate = true;\n\t\t\tshadowMaterialHorizontal.needsUpdate = true;\n\n\t\t}\n\n\t\tif ( shadow.mapPass === null ) {\n\n\t\t\tshadow.mapPass = new WebGLRenderTarget( _shadowMapSize.x, _shadowMapSize.y );\n\n\t\t}\n\n\t\t// vertical pass\n\n\t\tshadowMaterialVertical.uniforms.shadow_pass.value = shadow.map.texture;\n\t\tshadowMaterialVertical.uniforms.resolution.value = shadow.mapSize;\n\t\tshadowMaterialVertical.uniforms.radius.value = shadow.radius;\n\t\t_renderer.setRenderTarget( shadow.mapPass );\n\t\t_renderer.clear();\n\t\t_renderer.renderBufferDirect( camera, null, geometry, shadowMaterialVertical, fullScreenMesh, null );\n\n\t\t// horizontal pass\n\n\t\tshadowMaterialHorizontal.uniforms.shadow_pass.value = shadow.mapPass.texture;\n\t\tshadowMaterialHorizontal.uniforms.resolution.value = shadow.mapSize;\n\t\tshadowMaterialHorizontal.uniforms.radius.value = shadow.radius;\n\t\t_renderer.setRenderTarget( shadow.map );\n\t\t_renderer.clear();\n\t\t_renderer.renderBufferDirect( camera, null, geometry, shadowMaterialHorizontal, fullScreenMesh, null );\n\n\t}\n\n\tfunction getDepthMaterial( object, material, light, shadowCameraNear, shadowCameraFar, type ) {\n\n\t\tlet result = null;\n\n\t\tconst customMaterial = ( light.isPointLight === true ) ? object.customDistanceMaterial : object.customDepthMaterial;\n\n\t\tif ( customMaterial !== undefined ) {\n\n\t\t\tresult = customMaterial;\n\n\t\t} else {\n\n\t\t\tresult = ( light.isPointLight === true ) ? _distanceMaterial : _depthMaterial;\n\n\t\t\tif ( ( _renderer.localClippingEnabled && material.clipShadows === true && Array.isArray( material.clippingPlanes ) && material.clippingPlanes.length !== 0 ) ||\n\t\t\t\t( material.displacementMap && material.displacementScale !== 0 ) ||\n\t\t\t\t( material.alphaMap && material.alphaTest > 0 ) ||\n\t\t\t\t( material.map && material.alphaTest > 0 ) ) {\n\n\t\t\t\t// in this case we need a unique material instance reflecting the\n\t\t\t\t// appropriate state\n\n\t\t\t\tconst keyA = result.uuid, keyB = material.uuid;\n\n\t\t\t\tlet materialsForVariant = _materialCache[ keyA ];\n\n\t\t\t\tif ( materialsForVariant === undefined ) {\n\n\t\t\t\t\tmaterialsForVariant = {};\n\t\t\t\t\t_materialCache[ keyA ] = materialsForVariant;\n\n\t\t\t\t}\n\n\t\t\t\tlet cachedMaterial = materialsForVariant[ keyB ];\n\n\t\t\t\tif ( cachedMaterial === undefined ) {\n\n\t\t\t\t\tcachedMaterial = result.clone();\n\t\t\t\t\tmaterialsForVariant[ keyB ] = cachedMaterial;\n\n\t\t\t\t}\n\n\t\t\t\tresult = cachedMaterial;\n\n\t\t\t}\n\n\t\t}\n\n\t\tresult.visible = material.visible;\n\t\tresult.wireframe = material.wireframe;\n\n\t\tif ( type === VSMShadowMap ) {\n\n\t\t\tresult.side = ( material.shadowSide !== null ) ? material.shadowSide : material.side;\n\n\t\t} else {\n\n\t\t\tresult.side = ( material.shadowSide !== null ) ? material.shadowSide : shadowSide[ material.side ];\n\n\t\t}\n\n\t\tresult.alphaMap = material.alphaMap;\n\t\tresult.alphaTest = material.alphaTest;\n\t\tresult.map = material.map;\n\n\t\tresult.clipShadows = material.clipShadows;\n\t\tresult.clippingPlanes = material.clippingPlanes;\n\t\tresult.clipIntersection = material.clipIntersection;\n\n\t\tresult.displacementMap = material.displacementMap;\n\t\tresult.displacementScale = material.displacementScale;\n\t\tresult.displacementBias = material.displacementBias;\n\n\t\tresult.wireframeLinewidth = material.wireframeLinewidth;\n\t\tresult.linewidth = material.linewidth;\n\n\t\tif ( light.isPointLight === true && result.isMeshDistanceMaterial === true ) {\n\n\t\t\tresult.referencePosition.setFromMatrixPosition( light.matrixWorld );\n\t\t\tresult.nearDistance = shadowCameraNear;\n\t\t\tresult.farDistance = shadowCameraFar;\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n\tfunction renderObject( object, camera, shadowCamera, light, type ) {\n\n\t\tif ( object.visible === false ) return;\n\n\t\tconst visible = object.layers.test( camera.layers );\n\n\t\tif ( visible && ( object.isMesh || object.isLine || object.isPoints ) ) {\n\n\t\t\tif ( ( object.castShadow || ( object.receiveShadow && type === VSMShadowMap ) ) && ( ! object.frustumCulled || _frustum.intersectsObject( object ) ) ) {\n\n\t\t\t\tobject.modelViewMatrix.multiplyMatrices( shadowCamera.matrixWorldInverse, object.matrixWorld );\n\n\t\t\t\tconst geometry = _objects.update( object );\n\t\t\t\tconst material = object.material;\n\n\t\t\t\tif ( Array.isArray( material ) ) {\n\n\t\t\t\t\tconst groups = geometry.groups;\n\n\t\t\t\t\tfor ( let k = 0, kl = groups.length; k < kl; k ++ ) {\n\n\t\t\t\t\t\tconst group = groups[ k ];\n\t\t\t\t\t\tconst groupMaterial = material[ group.materialIndex ];\n\n\t\t\t\t\t\tif ( groupMaterial && groupMaterial.visible ) {\n\n\t\t\t\t\t\t\tconst depthMaterial = getDepthMaterial( object, groupMaterial, light, shadowCamera.near, shadowCamera.far, type );\n\n\t\t\t\t\t\t\t_renderer.renderBufferDirect( shadowCamera, null, geometry, depthMaterial, object, group );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( material.visible ) {\n\n\t\t\t\t\tconst depthMaterial = getDepthMaterial( object, material, light, shadowCamera.near, shadowCamera.far, type );\n\n\t\t\t\t\t_renderer.renderBufferDirect( shadowCamera, null, geometry, depthMaterial, object, null );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst children = object.children;\n\n\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\trenderObject( children[ i ], camera, shadowCamera, light, type );\n\n\t\t}\n\n\t}\n\n}\n\nfunction WebGLState( gl, extensions, capabilities ) {\n\n\tconst isWebGL2 = capabilities.isWebGL2;\n\n\tfunction ColorBuffer() {\n\n\t\tlet locked = false;\n\n\t\tconst color = new Vector4();\n\t\tlet currentColorMask = null;\n\t\tconst currentColorClear = new Vector4( 0, 0, 0, 0 );\n\n\t\treturn {\n\n\t\t\tsetMask: function ( colorMask ) {\n\n\t\t\t\tif ( currentColorMask !== colorMask && ! locked ) {\n\n\t\t\t\t\tgl.colorMask( colorMask, colorMask, colorMask, colorMask );\n\t\t\t\t\tcurrentColorMask = colorMask;\n\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\tsetLocked: function ( lock ) {\n\n\t\t\t\tlocked = lock;\n\n\t\t\t},\n\n\t\t\tsetClear: function ( r, g, b, a, premultipliedAlpha ) {\n\n\t\t\t\tif ( premultipliedAlpha === true ) {\n\n\t\t\t\t\tr *= a; g *= a; b *= a;\n\n\t\t\t\t}\n\n\t\t\t\tcolor.set( r, g, b, a );\n\n\t\t\t\tif ( currentColorClear.equals( color ) === false ) {\n\n\t\t\t\t\tgl.clearColor( r, g, b, a );\n\t\t\t\t\tcurrentColorClear.copy( color );\n\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\treset: function () {\n\n\t\t\t\tlocked = false;\n\n\t\t\t\tcurrentColorMask = null;\n\t\t\t\tcurrentColorClear.set( - 1, 0, 0, 0 ); // set to invalid state\n\n\t\t\t}\n\n\t\t};\n\n\t}\n\n\tfunction DepthBuffer() {\n\n\t\tlet locked = false;\n\n\t\tlet currentDepthMask = null;\n\t\tlet currentDepthFunc = null;\n\t\tlet currentDepthClear = null;\n\n\t\treturn {\n\n\t\t\tsetTest: function ( depthTest ) {\n\n\t\t\t\tif ( depthTest ) {\n\n\t\t\t\t\tenable( 2929 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tdisable( 2929 );\n\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\tsetMask: function ( depthMask ) {\n\n\t\t\t\tif ( currentDepthMask !== depthMask && ! locked ) {\n\n\t\t\t\t\tgl.depthMask( depthMask );\n\t\t\t\t\tcurrentDepthMask = depthMask;\n\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\tsetFunc: function ( depthFunc ) {\n\n\t\t\t\tif ( currentDepthFunc !== depthFunc ) {\n\n\t\t\t\t\tswitch ( depthFunc ) {\n\n\t\t\t\t\t\tcase NeverDepth:\n\n\t\t\t\t\t\t\tgl.depthFunc( 512 );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase AlwaysDepth:\n\n\t\t\t\t\t\t\tgl.depthFunc( 519 );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase LessDepth:\n\n\t\t\t\t\t\t\tgl.depthFunc( 513 );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase LessEqualDepth:\n\n\t\t\t\t\t\t\tgl.depthFunc( 515 );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase EqualDepth:\n\n\t\t\t\t\t\t\tgl.depthFunc( 514 );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase GreaterEqualDepth:\n\n\t\t\t\t\t\t\tgl.depthFunc( 518 );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase GreaterDepth:\n\n\t\t\t\t\t\t\tgl.depthFunc( 516 );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase NotEqualDepth:\n\n\t\t\t\t\t\t\tgl.depthFunc( 517 );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tdefault:\n\n\t\t\t\t\t\t\tgl.depthFunc( 515 );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tcurrentDepthFunc = depthFunc;\n\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\tsetLocked: function ( lock ) {\n\n\t\t\t\tlocked = lock;\n\n\t\t\t},\n\n\t\t\tsetClear: function ( depth ) {\n\n\t\t\t\tif ( currentDepthClear !== depth ) {\n\n\t\t\t\t\tgl.clearDepth( depth );\n\t\t\t\t\tcurrentDepthClear = depth;\n\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\treset: function () {\n\n\t\t\t\tlocked = false;\n\n\t\t\t\tcurrentDepthMask = null;\n\t\t\t\tcurrentDepthFunc = null;\n\t\t\t\tcurrentDepthClear = null;\n\n\t\t\t}\n\n\t\t};\n\n\t}\n\n\tfunction StencilBuffer() {\n\n\t\tlet locked = false;\n\n\t\tlet currentStencilMask = null;\n\t\tlet currentStencilFunc = null;\n\t\tlet currentStencilRef = null;\n\t\tlet currentStencilFuncMask = null;\n\t\tlet currentStencilFail = null;\n\t\tlet currentStencilZFail = null;\n\t\tlet currentStencilZPass = null;\n\t\tlet currentStencilClear = null;\n\n\t\treturn {\n\n\t\t\tsetTest: function ( stencilTest ) {\n\n\t\t\t\tif ( ! locked ) {\n\n\t\t\t\t\tif ( stencilTest ) {\n\n\t\t\t\t\t\tenable( 2960 );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tdisable( 2960 );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\tsetMask: function ( stencilMask ) {\n\n\t\t\t\tif ( currentStencilMask !== stencilMask && ! locked ) {\n\n\t\t\t\t\tgl.stencilMask( stencilMask );\n\t\t\t\t\tcurrentStencilMask = stencilMask;\n\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\tsetFunc: function ( stencilFunc, stencilRef, stencilMask ) {\n\n\t\t\t\tif ( currentStencilFunc !== stencilFunc ||\n\t\t\t\t     currentStencilRef !== stencilRef ||\n\t\t\t\t     currentStencilFuncMask !== stencilMask ) {\n\n\t\t\t\t\tgl.stencilFunc( stencilFunc, stencilRef, stencilMask );\n\n\t\t\t\t\tcurrentStencilFunc = stencilFunc;\n\t\t\t\t\tcurrentStencilRef = stencilRef;\n\t\t\t\t\tcurrentStencilFuncMask = stencilMask;\n\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\tsetOp: function ( stencilFail, stencilZFail, stencilZPass ) {\n\n\t\t\t\tif ( currentStencilFail !== stencilFail ||\n\t\t\t\t     currentStencilZFail !== stencilZFail ||\n\t\t\t\t     currentStencilZPass !== stencilZPass ) {\n\n\t\t\t\t\tgl.stencilOp( stencilFail, stencilZFail, stencilZPass );\n\n\t\t\t\t\tcurrentStencilFail = stencilFail;\n\t\t\t\t\tcurrentStencilZFail = stencilZFail;\n\t\t\t\t\tcurrentStencilZPass = stencilZPass;\n\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\tsetLocked: function ( lock ) {\n\n\t\t\t\tlocked = lock;\n\n\t\t\t},\n\n\t\t\tsetClear: function ( stencil ) {\n\n\t\t\t\tif ( currentStencilClear !== stencil ) {\n\n\t\t\t\t\tgl.clearStencil( stencil );\n\t\t\t\t\tcurrentStencilClear = stencil;\n\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\treset: function () {\n\n\t\t\t\tlocked = false;\n\n\t\t\t\tcurrentStencilMask = null;\n\t\t\t\tcurrentStencilFunc = null;\n\t\t\t\tcurrentStencilRef = null;\n\t\t\t\tcurrentStencilFuncMask = null;\n\t\t\t\tcurrentStencilFail = null;\n\t\t\t\tcurrentStencilZFail = null;\n\t\t\t\tcurrentStencilZPass = null;\n\t\t\t\tcurrentStencilClear = null;\n\n\t\t\t}\n\n\t\t};\n\n\t}\n\n\t//\n\n\tconst colorBuffer = new ColorBuffer();\n\tconst depthBuffer = new DepthBuffer();\n\tconst stencilBuffer = new StencilBuffer();\n\n\tconst uboBindings = new WeakMap();\n\tconst uboProgramMap = new WeakMap();\n\n\tlet enabledCapabilities = {};\n\n\tlet currentBoundFramebuffers = {};\n\tlet currentDrawbuffers = new WeakMap();\n\tlet defaultDrawbuffers = [];\n\n\tlet currentProgram = null;\n\n\tlet currentBlendingEnabled = false;\n\tlet currentBlending = null;\n\tlet currentBlendEquation = null;\n\tlet currentBlendSrc = null;\n\tlet currentBlendDst = null;\n\tlet currentBlendEquationAlpha = null;\n\tlet currentBlendSrcAlpha = null;\n\tlet currentBlendDstAlpha = null;\n\tlet currentPremultipledAlpha = false;\n\n\tlet currentFlipSided = null;\n\tlet currentCullFace = null;\n\n\tlet currentLineWidth = null;\n\n\tlet currentPolygonOffsetFactor = null;\n\tlet currentPolygonOffsetUnits = null;\n\n\tconst maxTextures = gl.getParameter( 35661 );\n\n\tlet lineWidthAvailable = false;\n\tlet version = 0;\n\tconst glVersion = gl.getParameter( 7938 );\n\n\tif ( glVersion.indexOf( 'WebGL' ) !== - 1 ) {\n\n\t\tversion = parseFloat( /^WebGL (\\d)/.exec( glVersion )[ 1 ] );\n\t\tlineWidthAvailable = ( version >= 1.0 );\n\n\t} else if ( glVersion.indexOf( 'OpenGL ES' ) !== - 1 ) {\n\n\t\tversion = parseFloat( /^OpenGL ES (\\d)/.exec( glVersion )[ 1 ] );\n\t\tlineWidthAvailable = ( version >= 2.0 );\n\n\t}\n\n\tlet currentTextureSlot = null;\n\tlet currentBoundTextures = {};\n\n\tconst scissorParam = gl.getParameter( 3088 );\n\tconst viewportParam = gl.getParameter( 2978 );\n\n\tconst currentScissor = new Vector4().fromArray( scissorParam );\n\tconst currentViewport = new Vector4().fromArray( viewportParam );\n\n\tfunction createTexture( type, target, count ) {\n\n\t\tconst data = new Uint8Array( 4 ); // 4 is required to match default unpack alignment of 4.\n\t\tconst texture = gl.createTexture();\n\n\t\tgl.bindTexture( type, texture );\n\t\tgl.texParameteri( type, 10241, 9728 );\n\t\tgl.texParameteri( type, 10240, 9728 );\n\n\t\tfor ( let i = 0; i < count; i ++ ) {\n\n\t\t\tgl.texImage2D( target + i, 0, 6408, 1, 1, 0, 6408, 5121, data );\n\n\t\t}\n\n\t\treturn texture;\n\n\t}\n\n\tconst emptyTextures = {};\n\temptyTextures[ 3553 ] = createTexture( 3553, 3553, 1 );\n\temptyTextures[ 34067 ] = createTexture( 34067, 34069, 6 );\n\n\t// init\n\n\tcolorBuffer.setClear( 0, 0, 0, 1 );\n\tdepthBuffer.setClear( 1 );\n\tstencilBuffer.setClear( 0 );\n\n\tenable( 2929 );\n\tdepthBuffer.setFunc( LessEqualDepth );\n\n\tsetFlipSided( false );\n\tsetCullFace( CullFaceBack );\n\tenable( 2884 );\n\n\tsetBlending( NoBlending );\n\n\t//\n\n\tfunction enable( id ) {\n\n\t\tif ( enabledCapabilities[ id ] !== true ) {\n\n\t\t\tgl.enable( id );\n\t\t\tenabledCapabilities[ id ] = true;\n\n\t\t}\n\n\t}\n\n\tfunction disable( id ) {\n\n\t\tif ( enabledCapabilities[ id ] !== false ) {\n\n\t\t\tgl.disable( id );\n\t\t\tenabledCapabilities[ id ] = false;\n\n\t\t}\n\n\t}\n\n\tfunction bindFramebuffer( target, framebuffer ) {\n\n\t\tif ( currentBoundFramebuffers[ target ] !== framebuffer ) {\n\n\t\t\tgl.bindFramebuffer( target, framebuffer );\n\n\t\t\tcurrentBoundFramebuffers[ target ] = framebuffer;\n\n\t\t\tif ( isWebGL2 ) {\n\n\t\t\t\t// 36009 is equivalent to 36160\n\n\t\t\t\tif ( target === 36009 ) {\n\n\t\t\t\t\tcurrentBoundFramebuffers[ 36160 ] = framebuffer;\n\n\t\t\t\t}\n\n\t\t\t\tif ( target === 36160 ) {\n\n\t\t\t\t\tcurrentBoundFramebuffers[ 36009 ] = framebuffer;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\treturn false;\n\n\t}\n\n\tfunction drawBuffers( renderTarget, framebuffer ) {\n\n\t\tlet drawBuffers = defaultDrawbuffers;\n\n\t\tlet needsUpdate = false;\n\n\t\tif ( renderTarget ) {\n\n\t\t\tdrawBuffers = currentDrawbuffers.get( framebuffer );\n\n\t\t\tif ( drawBuffers === undefined ) {\n\n\t\t\t\tdrawBuffers = [];\n\t\t\t\tcurrentDrawbuffers.set( framebuffer, drawBuffers );\n\n\t\t\t}\n\n\t\t\tif ( renderTarget.isWebGLMultipleRenderTargets ) {\n\n\t\t\t\tconst textures = renderTarget.texture;\n\n\t\t\t\tif ( drawBuffers.length !== textures.length || drawBuffers[ 0 ] !== 36064 ) {\n\n\t\t\t\t\tfor ( let i = 0, il = textures.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tdrawBuffers[ i ] = 36064 + i;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tdrawBuffers.length = textures.length;\n\n\t\t\t\t\tneedsUpdate = true;\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tif ( drawBuffers[ 0 ] !== 36064 ) {\n\n\t\t\t\t\tdrawBuffers[ 0 ] = 36064;\n\n\t\t\t\t\tneedsUpdate = true;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tif ( drawBuffers[ 0 ] !== 1029 ) {\n\n\t\t\t\tdrawBuffers[ 0 ] = 1029;\n\n\t\t\t\tneedsUpdate = true;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( needsUpdate ) {\n\n\t\t\tif ( capabilities.isWebGL2 ) {\n\n\t\t\t\tgl.drawBuffers( drawBuffers );\n\n\t\t\t} else {\n\n\t\t\t\textensions.get( 'WEBGL_draw_buffers' ).drawBuffersWEBGL( drawBuffers );\n\n\t\t\t}\n\n\t\t}\n\n\n\t}\n\n\tfunction useProgram( program ) {\n\n\t\tif ( currentProgram !== program ) {\n\n\t\t\tgl.useProgram( program );\n\n\t\t\tcurrentProgram = program;\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\treturn false;\n\n\t}\n\n\tconst equationToGL = {\n\t\t[ AddEquation ]: 32774,\n\t\t[ SubtractEquation ]: 32778,\n\t\t[ ReverseSubtractEquation ]: 32779\n\t};\n\n\tif ( isWebGL2 ) {\n\n\t\tequationToGL[ MinEquation ] = 32775;\n\t\tequationToGL[ MaxEquation ] = 32776;\n\n\t} else {\n\n\t\tconst extension = extensions.get( 'EXT_blend_minmax' );\n\n\t\tif ( extension !== null ) {\n\n\t\t\tequationToGL[ MinEquation ] = extension.MIN_EXT;\n\t\t\tequationToGL[ MaxEquation ] = extension.MAX_EXT;\n\n\t\t}\n\n\t}\n\n\tconst factorToGL = {\n\t\t[ ZeroFactor ]: 0,\n\t\t[ OneFactor ]: 1,\n\t\t[ SrcColorFactor ]: 768,\n\t\t[ SrcAlphaFactor ]: 770,\n\t\t[ SrcAlphaSaturateFactor ]: 776,\n\t\t[ DstColorFactor ]: 774,\n\t\t[ DstAlphaFactor ]: 772,\n\t\t[ OneMinusSrcColorFactor ]: 769,\n\t\t[ OneMinusSrcAlphaFactor ]: 771,\n\t\t[ OneMinusDstColorFactor ]: 775,\n\t\t[ OneMinusDstAlphaFactor ]: 773\n\t};\n\n\tfunction setBlending( blending, blendEquation, blendSrc, blendDst, blendEquationAlpha, blendSrcAlpha, blendDstAlpha, premultipliedAlpha ) {\n\n\t\tif ( blending === NoBlending ) {\n\n\t\t\tif ( currentBlendingEnabled === true ) {\n\n\t\t\t\tdisable( 3042 );\n\t\t\t\tcurrentBlendingEnabled = false;\n\n\t\t\t}\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( currentBlendingEnabled === false ) {\n\n\t\t\tenable( 3042 );\n\t\t\tcurrentBlendingEnabled = true;\n\n\t\t}\n\n\t\tif ( blending !== CustomBlending ) {\n\n\t\t\tif ( blending !== currentBlending || premultipliedAlpha !== currentPremultipledAlpha ) {\n\n\t\t\t\tif ( currentBlendEquation !== AddEquation || currentBlendEquationAlpha !== AddEquation ) {\n\n\t\t\t\t\tgl.blendEquation( 32774 );\n\n\t\t\t\t\tcurrentBlendEquation = AddEquation;\n\t\t\t\t\tcurrentBlendEquationAlpha = AddEquation;\n\n\t\t\t\t}\n\n\t\t\t\tif ( premultipliedAlpha ) {\n\n\t\t\t\t\tswitch ( blending ) {\n\n\t\t\t\t\t\tcase NormalBlending:\n\t\t\t\t\t\t\tgl.blendFuncSeparate( 1, 771, 1, 771 );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase AdditiveBlending:\n\t\t\t\t\t\t\tgl.blendFunc( 1, 1 );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase SubtractiveBlending:\n\t\t\t\t\t\t\tgl.blendFuncSeparate( 0, 769, 0, 1 );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase MultiplyBlending:\n\t\t\t\t\t\t\tgl.blendFuncSeparate( 0, 768, 0, 770 );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tconsole.error( 'THREE.WebGLState: Invalid blending: ', blending );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tswitch ( blending ) {\n\n\t\t\t\t\t\tcase NormalBlending:\n\t\t\t\t\t\t\tgl.blendFuncSeparate( 770, 771, 1, 771 );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase AdditiveBlending:\n\t\t\t\t\t\t\tgl.blendFunc( 770, 1 );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase SubtractiveBlending:\n\t\t\t\t\t\t\tgl.blendFuncSeparate( 0, 769, 0, 1 );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase MultiplyBlending:\n\t\t\t\t\t\t\tgl.blendFunc( 0, 768 );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tconsole.error( 'THREE.WebGLState: Invalid blending: ', blending );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tcurrentBlendSrc = null;\n\t\t\t\tcurrentBlendDst = null;\n\t\t\t\tcurrentBlendSrcAlpha = null;\n\t\t\t\tcurrentBlendDstAlpha = null;\n\n\t\t\t\tcurrentBlending = blending;\n\t\t\t\tcurrentPremultipledAlpha = premultipliedAlpha;\n\n\t\t\t}\n\n\t\t\treturn;\n\n\t\t}\n\n\t\t// custom blending\n\n\t\tblendEquationAlpha = blendEquationAlpha || blendEquation;\n\t\tblendSrcAlpha = blendSrcAlpha || blendSrc;\n\t\tblendDstAlpha = blendDstAlpha || blendDst;\n\n\t\tif ( blendEquation !== currentBlendEquation || blendEquationAlpha !== currentBlendEquationAlpha ) {\n\n\t\t\tgl.blendEquationSeparate( equationToGL[ blendEquation ], equationToGL[ blendEquationAlpha ] );\n\n\t\t\tcurrentBlendEquation = blendEquation;\n\t\t\tcurrentBlendEquationAlpha = blendEquationAlpha;\n\n\t\t}\n\n\t\tif ( blendSrc !== currentBlendSrc || blendDst !== currentBlendDst || blendSrcAlpha !== currentBlendSrcAlpha || blendDstAlpha !== currentBlendDstAlpha ) {\n\n\t\t\tgl.blendFuncSeparate( factorToGL[ blendSrc ], factorToGL[ blendDst ], factorToGL[ blendSrcAlpha ], factorToGL[ blendDstAlpha ] );\n\n\t\t\tcurrentBlendSrc = blendSrc;\n\t\t\tcurrentBlendDst = blendDst;\n\t\t\tcurrentBlendSrcAlpha = blendSrcAlpha;\n\t\t\tcurrentBlendDstAlpha = blendDstAlpha;\n\n\t\t}\n\n\t\tcurrentBlending = blending;\n\t\tcurrentPremultipledAlpha = false;\n\n\t}\n\n\tfunction setMaterial( material, frontFaceCW ) {\n\n\t\tmaterial.side === DoubleSide\n\t\t\t? disable( 2884 )\n\t\t\t: enable( 2884 );\n\n\t\tlet flipSided = ( material.side === BackSide );\n\t\tif ( frontFaceCW ) flipSided = ! flipSided;\n\n\t\tsetFlipSided( flipSided );\n\n\t\t( material.blending === NormalBlending && material.transparent === false )\n\t\t\t? setBlending( NoBlending )\n\t\t\t: setBlending( material.blending, material.blendEquation, material.blendSrc, material.blendDst, material.blendEquationAlpha, material.blendSrcAlpha, material.blendDstAlpha, material.premultipliedAlpha );\n\n\t\tdepthBuffer.setFunc( material.depthFunc );\n\t\tdepthBuffer.setTest( material.depthTest );\n\t\tdepthBuffer.setMask( material.depthWrite );\n\t\tcolorBuffer.setMask( material.colorWrite );\n\n\t\tconst stencilWrite = material.stencilWrite;\n\t\tstencilBuffer.setTest( stencilWrite );\n\t\tif ( stencilWrite ) {\n\n\t\t\tstencilBuffer.setMask( material.stencilWriteMask );\n\t\t\tstencilBuffer.setFunc( material.stencilFunc, material.stencilRef, material.stencilFuncMask );\n\t\t\tstencilBuffer.setOp( material.stencilFail, material.stencilZFail, material.stencilZPass );\n\n\t\t}\n\n\t\tsetPolygonOffset( material.polygonOffset, material.polygonOffsetFactor, material.polygonOffsetUnits );\n\n\t\tmaterial.alphaToCoverage === true\n\t\t\t? enable( 32926 )\n\t\t\t: disable( 32926 );\n\n\t}\n\n\t//\n\n\tfunction setFlipSided( flipSided ) {\n\n\t\tif ( currentFlipSided !== flipSided ) {\n\n\t\t\tif ( flipSided ) {\n\n\t\t\t\tgl.frontFace( 2304 );\n\n\t\t\t} else {\n\n\t\t\t\tgl.frontFace( 2305 );\n\n\t\t\t}\n\n\t\t\tcurrentFlipSided = flipSided;\n\n\t\t}\n\n\t}\n\n\tfunction setCullFace( cullFace ) {\n\n\t\tif ( cullFace !== CullFaceNone ) {\n\n\t\t\tenable( 2884 );\n\n\t\t\tif ( cullFace !== currentCullFace ) {\n\n\t\t\t\tif ( cullFace === CullFaceBack ) {\n\n\t\t\t\t\tgl.cullFace( 1029 );\n\n\t\t\t\t} else if ( cullFace === CullFaceFront ) {\n\n\t\t\t\t\tgl.cullFace( 1028 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tgl.cullFace( 1032 );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tdisable( 2884 );\n\n\t\t}\n\n\t\tcurrentCullFace = cullFace;\n\n\t}\n\n\tfunction setLineWidth( width ) {\n\n\t\tif ( width !== currentLineWidth ) {\n\n\t\t\tif ( lineWidthAvailable ) gl.lineWidth( width );\n\n\t\t\tcurrentLineWidth = width;\n\n\t\t}\n\n\t}\n\n\tfunction setPolygonOffset( polygonOffset, factor, units ) {\n\n\t\tif ( polygonOffset ) {\n\n\t\t\tenable( 32823 );\n\n\t\t\tif ( currentPolygonOffsetFactor !== factor || currentPolygonOffsetUnits !== units ) {\n\n\t\t\t\tgl.polygonOffset( factor, units );\n\n\t\t\t\tcurrentPolygonOffsetFactor = factor;\n\t\t\t\tcurrentPolygonOffsetUnits = units;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tdisable( 32823 );\n\n\t\t}\n\n\t}\n\n\tfunction setScissorTest( scissorTest ) {\n\n\t\tif ( scissorTest ) {\n\n\t\t\tenable( 3089 );\n\n\t\t} else {\n\n\t\t\tdisable( 3089 );\n\n\t\t}\n\n\t}\n\n\t// texture\n\n\tfunction activeTexture( webglSlot ) {\n\n\t\tif ( webglSlot === undefined ) webglSlot = 33984 + maxTextures - 1;\n\n\t\tif ( currentTextureSlot !== webglSlot ) {\n\n\t\t\tgl.activeTexture( webglSlot );\n\t\t\tcurrentTextureSlot = webglSlot;\n\n\t\t}\n\n\t}\n\n\tfunction bindTexture( webglType, webglTexture, webglSlot ) {\n\n\t\tif ( webglSlot === undefined ) {\n\n\t\t\tif ( currentTextureSlot === null ) {\n\n\t\t\t\twebglSlot = 33984 + maxTextures - 1;\n\n\t\t\t} else {\n\n\t\t\t\twebglSlot = currentTextureSlot;\n\n\t\t\t}\n\n\t\t}\n\n\t\tlet boundTexture = currentBoundTextures[ webglSlot ];\n\n\t\tif ( boundTexture === undefined ) {\n\n\t\t\tboundTexture = { type: undefined, texture: undefined };\n\t\t\tcurrentBoundTextures[ webglSlot ] = boundTexture;\n\n\t\t}\n\n\t\tif ( boundTexture.type !== webglType || boundTexture.texture !== webglTexture ) {\n\n\t\t\tif ( currentTextureSlot !== webglSlot ) {\n\n\t\t\t\tgl.activeTexture( webglSlot );\n\t\t\t\tcurrentTextureSlot = webglSlot;\n\n\t\t\t}\n\n\t\t\tgl.bindTexture( webglType, webglTexture || emptyTextures[ webglType ] );\n\n\t\t\tboundTexture.type = webglType;\n\t\t\tboundTexture.texture = webglTexture;\n\n\t\t}\n\n\t}\n\n\tfunction unbindTexture() {\n\n\t\tconst boundTexture = currentBoundTextures[ currentTextureSlot ];\n\n\t\tif ( boundTexture !== undefined && boundTexture.type !== undefined ) {\n\n\t\t\tgl.bindTexture( boundTexture.type, null );\n\n\t\t\tboundTexture.type = undefined;\n\t\t\tboundTexture.texture = undefined;\n\n\t\t}\n\n\t}\n\n\tfunction compressedTexImage2D() {\n\n\t\ttry {\n\n\t\t\tgl.compressedTexImage2D.apply( gl, arguments );\n\n\t\t} catch ( error ) {\n\n\t\t\tconsole.error( 'THREE.WebGLState:', error );\n\n\t\t}\n\n\t}\n\n\tfunction compressedTexImage3D() {\n\n\t\ttry {\n\n\t\t\tgl.compressedTexImage3D.apply( gl, arguments );\n\n\t\t} catch ( error ) {\n\n\t\t\tconsole.error( 'THREE.WebGLState:', error );\n\n\t\t}\n\n\t}\n\n\tfunction texSubImage2D() {\n\n\t\ttry {\n\n\t\t\tgl.texSubImage2D.apply( gl, arguments );\n\n\t\t} catch ( error ) {\n\n\t\t\tconsole.error( 'THREE.WebGLState:', error );\n\n\t\t}\n\n\t}\n\n\tfunction texSubImage3D() {\n\n\t\ttry {\n\n\t\t\tgl.texSubImage3D.apply( gl, arguments );\n\n\t\t} catch ( error ) {\n\n\t\t\tconsole.error( 'THREE.WebGLState:', error );\n\n\t\t}\n\n\t}\n\n\tfunction compressedTexSubImage2D() {\n\n\t\ttry {\n\n\t\t\tgl.compressedTexSubImage2D.apply( gl, arguments );\n\n\t\t} catch ( error ) {\n\n\t\t\tconsole.error( 'THREE.WebGLState:', error );\n\n\t\t}\n\n\t}\n\n\tfunction compressedTexSubImage3D() {\n\n\t\ttry {\n\n\t\t\tgl.compressedTexSubImage3D.apply( gl, arguments );\n\n\t\t} catch ( error ) {\n\n\t\t\tconsole.error( 'THREE.WebGLState:', error );\n\n\t\t}\n\n\t}\n\n\tfunction texStorage2D() {\n\n\t\ttry {\n\n\t\t\tgl.texStorage2D.apply( gl, arguments );\n\n\t\t} catch ( error ) {\n\n\t\t\tconsole.error( 'THREE.WebGLState:', error );\n\n\t\t}\n\n\t}\n\n\tfunction texStorage3D() {\n\n\t\ttry {\n\n\t\t\tgl.texStorage3D.apply( gl, arguments );\n\n\t\t} catch ( error ) {\n\n\t\t\tconsole.error( 'THREE.WebGLState:', error );\n\n\t\t}\n\n\t}\n\n\tfunction texImage2D() {\n\n\t\ttry {\n\n\t\t\tgl.texImage2D.apply( gl, arguments );\n\n\t\t} catch ( error ) {\n\n\t\t\tconsole.error( 'THREE.WebGLState:', error );\n\n\t\t}\n\n\t}\n\n\tfunction texImage3D() {\n\n\t\ttry {\n\n\t\t\tgl.texImage3D.apply( gl, arguments );\n\n\t\t} catch ( error ) {\n\n\t\t\tconsole.error( 'THREE.WebGLState:', error );\n\n\t\t}\n\n\t}\n\n\t//\n\n\tfunction scissor( scissor ) {\n\n\t\tif ( currentScissor.equals( scissor ) === false ) {\n\n\t\t\tgl.scissor( scissor.x, scissor.y, scissor.z, scissor.w );\n\t\t\tcurrentScissor.copy( scissor );\n\n\t\t}\n\n\t}\n\n\tfunction viewport( viewport ) {\n\n\t\tif ( currentViewport.equals( viewport ) === false ) {\n\n\t\t\tgl.viewport( viewport.x, viewport.y, viewport.z, viewport.w );\n\t\t\tcurrentViewport.copy( viewport );\n\n\t\t}\n\n\t}\n\n\tfunction updateUBOMapping( uniformsGroup, program ) {\n\n\t\tlet mapping = uboProgramMap.get( program );\n\n\t\tif ( mapping === undefined ) {\n\n\t\t\tmapping = new WeakMap();\n\n\t\t\tuboProgramMap.set( program, mapping );\n\n\t\t}\n\n\t\tlet blockIndex = mapping.get( uniformsGroup );\n\n\t\tif ( blockIndex === undefined ) {\n\n\t\t\tblockIndex = gl.getUniformBlockIndex( program, uniformsGroup.name );\n\n\t\t\tmapping.set( uniformsGroup, blockIndex );\n\n\t\t}\n\n\t}\n\n\tfunction uniformBlockBinding( uniformsGroup, program ) {\n\n\t\tconst mapping = uboProgramMap.get( program );\n\t\tconst blockIndex = mapping.get( uniformsGroup );\n\n\t\tif ( uboBindings.get( program ) !== blockIndex ) {\n\n\t\t\t// bind shader specific block index to global block point\n\t\t\tgl.uniformBlockBinding( program, blockIndex, uniformsGroup.__bindingPointIndex );\n\n\t\t\tuboBindings.set( program, blockIndex );\n\n\t\t}\n\n\t}\n\n\t//\n\n\tfunction reset() {\n\n\t\t// reset state\n\n\t\tgl.disable( 3042 );\n\t\tgl.disable( 2884 );\n\t\tgl.disable( 2929 );\n\t\tgl.disable( 32823 );\n\t\tgl.disable( 3089 );\n\t\tgl.disable( 2960 );\n\t\tgl.disable( 32926 );\n\n\t\tgl.blendEquation( 32774 );\n\t\tgl.blendFunc( 1, 0 );\n\t\tgl.blendFuncSeparate( 1, 0, 1, 0 );\n\n\t\tgl.colorMask( true, true, true, true );\n\t\tgl.clearColor( 0, 0, 0, 0 );\n\n\t\tgl.depthMask( true );\n\t\tgl.depthFunc( 513 );\n\t\tgl.clearDepth( 1 );\n\n\t\tgl.stencilMask( 0xffffffff );\n\t\tgl.stencilFunc( 519, 0, 0xffffffff );\n\t\tgl.stencilOp( 7680, 7680, 7680 );\n\t\tgl.clearStencil( 0 );\n\n\t\tgl.cullFace( 1029 );\n\t\tgl.frontFace( 2305 );\n\n\t\tgl.polygonOffset( 0, 0 );\n\n\t\tgl.activeTexture( 33984 );\n\n\t\tgl.bindFramebuffer( 36160, null );\n\n\t\tif ( isWebGL2 === true ) {\n\n\t\t\tgl.bindFramebuffer( 36009, null );\n\t\t\tgl.bindFramebuffer( 36008, null );\n\n\t\t}\n\n\t\tgl.useProgram( null );\n\n\t\tgl.lineWidth( 1 );\n\n\t\tgl.scissor( 0, 0, gl.canvas.width, gl.canvas.height );\n\t\tgl.viewport( 0, 0, gl.canvas.width, gl.canvas.height );\n\n\t\t// reset internals\n\n\t\tenabledCapabilities = {};\n\n\t\tcurrentTextureSlot = null;\n\t\tcurrentBoundTextures = {};\n\n\t\tcurrentBoundFramebuffers = {};\n\t\tcurrentDrawbuffers = new WeakMap();\n\t\tdefaultDrawbuffers = [];\n\n\t\tcurrentProgram = null;\n\n\t\tcurrentBlendingEnabled = false;\n\t\tcurrentBlending = null;\n\t\tcurrentBlendEquation = null;\n\t\tcurrentBlendSrc = null;\n\t\tcurrentBlendDst = null;\n\t\tcurrentBlendEquationAlpha = null;\n\t\tcurrentBlendSrcAlpha = null;\n\t\tcurrentBlendDstAlpha = null;\n\t\tcurrentPremultipledAlpha = false;\n\n\t\tcurrentFlipSided = null;\n\t\tcurrentCullFace = null;\n\n\t\tcurrentLineWidth = null;\n\n\t\tcurrentPolygonOffsetFactor = null;\n\t\tcurrentPolygonOffsetUnits = null;\n\n\t\tcurrentScissor.set( 0, 0, gl.canvas.width, gl.canvas.height );\n\t\tcurrentViewport.set( 0, 0, gl.canvas.width, gl.canvas.height );\n\n\t\tcolorBuffer.reset();\n\t\tdepthBuffer.reset();\n\t\tstencilBuffer.reset();\n\n\t}\n\n\treturn {\n\n\t\tbuffers: {\n\t\t\tcolor: colorBuffer,\n\t\t\tdepth: depthBuffer,\n\t\t\tstencil: stencilBuffer\n\t\t},\n\n\t\tenable: enable,\n\t\tdisable: disable,\n\n\t\tbindFramebuffer: bindFramebuffer,\n\t\tdrawBuffers: drawBuffers,\n\n\t\tuseProgram: useProgram,\n\n\t\tsetBlending: setBlending,\n\t\tsetMaterial: setMaterial,\n\n\t\tsetFlipSided: setFlipSided,\n\t\tsetCullFace: setCullFace,\n\n\t\tsetLineWidth: setLineWidth,\n\t\tsetPolygonOffset: setPolygonOffset,\n\n\t\tsetScissorTest: setScissorTest,\n\n\t\tactiveTexture: activeTexture,\n\t\tbindTexture: bindTexture,\n\t\tunbindTexture: unbindTexture,\n\t\tcompressedTexImage2D: compressedTexImage2D,\n\t\tcompressedTexImage3D: compressedTexImage3D,\n\t\ttexImage2D: texImage2D,\n\t\ttexImage3D: texImage3D,\n\n\t\tupdateUBOMapping: updateUBOMapping,\n\t\tuniformBlockBinding: uniformBlockBinding,\n\n\t\ttexStorage2D: texStorage2D,\n\t\ttexStorage3D: texStorage3D,\n\t\ttexSubImage2D: texSubImage2D,\n\t\ttexSubImage3D: texSubImage3D,\n\t\tcompressedTexSubImage2D: compressedTexSubImage2D,\n\t\tcompressedTexSubImage3D: compressedTexSubImage3D,\n\n\t\tscissor: scissor,\n\t\tviewport: viewport,\n\n\t\treset: reset\n\n\t};\n\n}\n\nfunction WebGLTextures( _gl, extensions, state, properties, capabilities, utils, info ) {\n\n\tconst isWebGL2 = capabilities.isWebGL2;\n\tconst maxTextures = capabilities.maxTextures;\n\tconst maxCubemapSize = capabilities.maxCubemapSize;\n\tconst maxTextureSize = capabilities.maxTextureSize;\n\tconst maxSamples = capabilities.maxSamples;\n\tconst multisampledRTTExt = extensions.has( 'WEBGL_multisampled_render_to_texture' ) ? extensions.get( 'WEBGL_multisampled_render_to_texture' ) : null;\n\tconst supportsInvalidateFramebuffer = typeof navigator === 'undefined' ? false : /OculusBrowser/g.test( navigator.userAgent );\n\n\tconst _videoTextures = new WeakMap();\n\tlet _canvas;\n\n\tconst _sources = new WeakMap(); // maps WebglTexture objects to instances of Source\n\n\t// cordova iOS (as of 5.0) still uses UIWebView, which provides OffscreenCanvas,\n\t// also OffscreenCanvas.getContext(\"webgl\"), but not OffscreenCanvas.getContext(\"2d\")!\n\t// Some implementations may only implement OffscreenCanvas partially (e.g. lacking 2d).\n\n\tlet useOffscreenCanvas = false;\n\n\ttry {\n\n\t\tuseOffscreenCanvas = typeof OffscreenCanvas !== 'undefined'\n\t\t\t// eslint-disable-next-line compat/compat\n\t\t\t&& ( new OffscreenCanvas( 1, 1 ).getContext( '2d' ) ) !== null;\n\n\t} catch ( err ) {\n\n\t\t// Ignore any errors\n\n\t}\n\n\tfunction createCanvas( width, height ) {\n\n\t\t// Use OffscreenCanvas when available. Specially needed in web workers\n\n\t\treturn useOffscreenCanvas ?\n\t\t\t// eslint-disable-next-line compat/compat\n\t\t\tnew OffscreenCanvas( width, height ) : createElementNS( 'canvas' );\n\n\t}\n\n\tfunction resizeImage( image, needsPowerOfTwo, needsNewCanvas, maxSize ) {\n\n\t\tlet scale = 1;\n\n\t\t// handle case if texture exceeds max size\n\n\t\tif ( image.width > maxSize || image.height > maxSize ) {\n\n\t\t\tscale = maxSize / Math.max( image.width, image.height );\n\n\t\t}\n\n\t\t// only perform resize if necessary\n\n\t\tif ( scale < 1 || needsPowerOfTwo === true ) {\n\n\t\t\t// only perform resize for certain image types\n\n\t\t\tif ( ( typeof HTMLImageElement !== 'undefined' && image instanceof HTMLImageElement ) ||\n\t\t\t\t( typeof HTMLCanvasElement !== 'undefined' && image instanceof HTMLCanvasElement ) ||\n\t\t\t\t( typeof ImageBitmap !== 'undefined' && image instanceof ImageBitmap ) ) {\n\n\t\t\t\tconst floor = needsPowerOfTwo ? floorPowerOfTwo : Math.floor;\n\n\t\t\t\tconst width = floor( scale * image.width );\n\t\t\t\tconst height = floor( scale * image.height );\n\n\t\t\t\tif ( _canvas === undefined ) _canvas = createCanvas( width, height );\n\n\t\t\t\t// cube textures can't reuse the same canvas\n\n\t\t\t\tconst canvas = needsNewCanvas ? createCanvas( width, height ) : _canvas;\n\n\t\t\t\tcanvas.width = width;\n\t\t\t\tcanvas.height = height;\n\n\t\t\t\tconst context = canvas.getContext( '2d' );\n\t\t\t\tcontext.drawImage( image, 0, 0, width, height );\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Texture has been resized from (' + image.width + 'x' + image.height + ') to (' + width + 'x' + height + ').' );\n\n\t\t\t\treturn canvas;\n\n\t\t\t} else {\n\n\t\t\t\tif ( 'data' in image ) {\n\n\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Image in DataTexture is too big (' + image.width + 'x' + image.height + ').' );\n\n\t\t\t\t}\n\n\t\t\t\treturn image;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn image;\n\n\t}\n\n\tfunction isPowerOfTwo$1( image ) {\n\n\t\treturn isPowerOfTwo( image.width ) && isPowerOfTwo( image.height );\n\n\t}\n\n\tfunction textureNeedsPowerOfTwo( texture ) {\n\n\t\tif ( isWebGL2 ) return false;\n\n\t\treturn ( texture.wrapS !== ClampToEdgeWrapping || texture.wrapT !== ClampToEdgeWrapping ) ||\n\t\t\t( texture.minFilter !== NearestFilter && texture.minFilter !== LinearFilter );\n\n\t}\n\n\tfunction textureNeedsGenerateMipmaps( texture, supportsMips ) {\n\n\t\treturn texture.generateMipmaps && supportsMips &&\n\t\t\ttexture.minFilter !== NearestFilter && texture.minFilter !== LinearFilter;\n\n\t}\n\n\tfunction generateMipmap( target ) {\n\n\t\t_gl.generateMipmap( target );\n\n\t}\n\n\tfunction getInternalFormat( internalFormatName, glFormat, glType, encoding, forceLinearEncoding = false ) {\n\n\t\tif ( isWebGL2 === false ) return glFormat;\n\n\t\tif ( internalFormatName !== null ) {\n\n\t\t\tif ( _gl[ internalFormatName ] !== undefined ) return _gl[ internalFormatName ];\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format \\'' + internalFormatName + '\\'' );\n\n\t\t}\n\n\t\tlet internalFormat = glFormat;\n\n\t\tif ( glFormat === 6403 ) {\n\n\t\t\tif ( glType === 5126 ) internalFormat = 33326;\n\t\t\tif ( glType === 5131 ) internalFormat = 33325;\n\t\t\tif ( glType === 5121 ) internalFormat = 33321;\n\n\t\t}\n\n\t\tif ( glFormat === 33319 ) {\n\n\t\t\tif ( glType === 5126 ) internalFormat = 33328;\n\t\t\tif ( glType === 5131 ) internalFormat = 33327;\n\t\t\tif ( glType === 5121 ) internalFormat = 33323;\n\n\t\t}\n\n\t\tif ( glFormat === 6408 ) {\n\n\t\t\tif ( glType === 5126 ) internalFormat = 34836;\n\t\t\tif ( glType === 5131 ) internalFormat = 34842;\n\t\t\tif ( glType === 5121 ) internalFormat = ( encoding === sRGBEncoding && forceLinearEncoding === false ) ? 35907 : 32856;\n\t\t\tif ( glType === 32819 ) internalFormat = 32854;\n\t\t\tif ( glType === 32820 ) internalFormat = 32855;\n\n\t\t}\n\n\t\tif ( internalFormat === 33325 || internalFormat === 33326 ||\n\t\t\tinternalFormat === 33327 || internalFormat === 33328 ||\n\t\t\tinternalFormat === 34842 || internalFormat === 34836 ) {\n\n\t\t\textensions.get( 'EXT_color_buffer_float' );\n\n\t\t}\n\n\t\treturn internalFormat;\n\n\t}\n\n\tfunction getMipLevels( texture, image, supportsMips ) {\n\n\t\tif ( textureNeedsGenerateMipmaps( texture, supportsMips ) === true || ( texture.isFramebufferTexture && texture.minFilter !== NearestFilter && texture.minFilter !== LinearFilter ) ) {\n\n\t\t\treturn Math.log2( Math.max( image.width, image.height ) ) + 1;\n\n\t\t} else if ( texture.mipmaps !== undefined && texture.mipmaps.length > 0 ) {\n\n\t\t\t// user-defined mipmaps\n\n\t\t\treturn texture.mipmaps.length;\n\n\t\t} else if ( texture.isCompressedTexture && Array.isArray( texture.image ) ) {\n\n\t\t\treturn image.mipmaps.length;\n\n\t\t} else {\n\n\t\t\t// texture without mipmaps (only base level)\n\n\t\t\treturn 1;\n\n\t\t}\n\n\t}\n\n\t// Fallback filters for non-power-of-2 textures\n\n\tfunction filterFallback( f ) {\n\n\t\tif ( f === NearestFilter || f === NearestMipmapNearestFilter || f === NearestMipmapLinearFilter ) {\n\n\t\t\treturn 9728;\n\n\t\t}\n\n\t\treturn 9729;\n\n\t}\n\n\t//\n\n\tfunction onTextureDispose( event ) {\n\n\t\tconst texture = event.target;\n\n\t\ttexture.removeEventListener( 'dispose', onTextureDispose );\n\n\t\tdeallocateTexture( texture );\n\n\t\tif ( texture.isVideoTexture ) {\n\n\t\t\t_videoTextures.delete( texture );\n\n\t\t}\n\n\t}\n\n\tfunction onRenderTargetDispose( event ) {\n\n\t\tconst renderTarget = event.target;\n\n\t\trenderTarget.removeEventListener( 'dispose', onRenderTargetDispose );\n\n\t\tdeallocateRenderTarget( renderTarget );\n\n\t}\n\n\t//\n\n\tfunction deallocateTexture( texture ) {\n\n\t\tconst textureProperties = properties.get( texture );\n\n\t\tif ( textureProperties.__webglInit === undefined ) return;\n\n\t\t// check if it's necessary to remove the WebGLTexture object\n\n\t\tconst source = texture.source;\n\t\tconst webglTextures = _sources.get( source );\n\n\t\tif ( webglTextures ) {\n\n\t\t\tconst webglTexture = webglTextures[ textureProperties.__cacheKey ];\n\t\t\twebglTexture.usedTimes --;\n\n\t\t\t// the WebGLTexture object is not used anymore, remove it\n\n\t\t\tif ( webglTexture.usedTimes === 0 ) {\n\n\t\t\t\tdeleteTexture( texture );\n\n\t\t\t}\n\n\t\t\t// remove the weak map entry if no WebGLTexture uses the source anymore\n\n\t\t\tif ( Object.keys( webglTextures ).length === 0 ) {\n\n\t\t\t\t_sources.delete( source );\n\n\t\t\t}\n\n\t\t}\n\n\t\tproperties.remove( texture );\n\n\t}\n\n\tfunction deleteTexture( texture ) {\n\n\t\tconst textureProperties = properties.get( texture );\n\t\t_gl.deleteTexture( textureProperties.__webglTexture );\n\n\t\tconst source = texture.source;\n\t\tconst webglTextures = _sources.get( source );\n\t\tdelete webglTextures[ textureProperties.__cacheKey ];\n\n\t\tinfo.memory.textures --;\n\n\t}\n\n\tfunction deallocateRenderTarget( renderTarget ) {\n\n\t\tconst texture = renderTarget.texture;\n\n\t\tconst renderTargetProperties = properties.get( renderTarget );\n\t\tconst textureProperties = properties.get( texture );\n\n\t\tif ( textureProperties.__webglTexture !== undefined ) {\n\n\t\t\t_gl.deleteTexture( textureProperties.__webglTexture );\n\n\t\t\tinfo.memory.textures --;\n\n\t\t}\n\n\t\tif ( renderTarget.depthTexture ) {\n\n\t\t\trenderTarget.depthTexture.dispose();\n\n\t\t}\n\n\t\tif ( renderTarget.isWebGLCubeRenderTarget ) {\n\n\t\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\t\t_gl.deleteFramebuffer( renderTargetProperties.__webglFramebuffer[ i ] );\n\t\t\t\tif ( renderTargetProperties.__webglDepthbuffer ) _gl.deleteRenderbuffer( renderTargetProperties.__webglDepthbuffer[ i ] );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\t_gl.deleteFramebuffer( renderTargetProperties.__webglFramebuffer );\n\t\t\tif ( renderTargetProperties.__webglDepthbuffer ) _gl.deleteRenderbuffer( renderTargetProperties.__webglDepthbuffer );\n\t\t\tif ( renderTargetProperties.__webglMultisampledFramebuffer ) _gl.deleteFramebuffer( renderTargetProperties.__webglMultisampledFramebuffer );\n\n\t\t\tif ( renderTargetProperties.__webglColorRenderbuffer ) {\n\n\t\t\t\tfor ( let i = 0; i < renderTargetProperties.__webglColorRenderbuffer.length; i ++ ) {\n\n\t\t\t\t\tif ( renderTargetProperties.__webglColorRenderbuffer[ i ] ) _gl.deleteRenderbuffer( renderTargetProperties.__webglColorRenderbuffer[ i ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( renderTargetProperties.__webglDepthRenderbuffer ) _gl.deleteRenderbuffer( renderTargetProperties.__webglDepthRenderbuffer );\n\n\t\t}\n\n\t\tif ( renderTarget.isWebGLMultipleRenderTargets ) {\n\n\t\t\tfor ( let i = 0, il = texture.length; i < il; i ++ ) {\n\n\t\t\t\tconst attachmentProperties = properties.get( texture[ i ] );\n\n\t\t\t\tif ( attachmentProperties.__webglTexture ) {\n\n\t\t\t\t\t_gl.deleteTexture( attachmentProperties.__webglTexture );\n\n\t\t\t\t\tinfo.memory.textures --;\n\n\t\t\t\t}\n\n\t\t\t\tproperties.remove( texture[ i ] );\n\n\t\t\t}\n\n\t\t}\n\n\t\tproperties.remove( texture );\n\t\tproperties.remove( renderTarget );\n\n\t}\n\n\t//\n\n\tlet textureUnits = 0;\n\n\tfunction resetTextureUnits() {\n\n\t\ttextureUnits = 0;\n\n\t}\n\n\tfunction allocateTextureUnit() {\n\n\t\tconst textureUnit = textureUnits;\n\n\t\tif ( textureUnit >= maxTextures ) {\n\n\t\t\tconsole.warn( 'THREE.WebGLTextures: Trying to use ' + textureUnit + ' texture units while this GPU supports only ' + maxTextures );\n\n\t\t}\n\n\t\ttextureUnits += 1;\n\n\t\treturn textureUnit;\n\n\t}\n\n\tfunction getTextureCacheKey( texture ) {\n\n\t\tconst array = [];\n\n\t\tarray.push( texture.wrapS );\n\t\tarray.push( texture.wrapT );\n\t\tarray.push( texture.wrapR || 0 );\n\t\tarray.push( texture.magFilter );\n\t\tarray.push( texture.minFilter );\n\t\tarray.push( texture.anisotropy );\n\t\tarray.push( texture.internalFormat );\n\t\tarray.push( texture.format );\n\t\tarray.push( texture.type );\n\t\tarray.push( texture.generateMipmaps );\n\t\tarray.push( texture.premultiplyAlpha );\n\t\tarray.push( texture.flipY );\n\t\tarray.push( texture.unpackAlignment );\n\t\tarray.push( texture.encoding );\n\n\t\treturn array.join();\n\n\t}\n\n\t//\n\n\tfunction setTexture2D( texture, slot ) {\n\n\t\tconst textureProperties = properties.get( texture );\n\n\t\tif ( texture.isVideoTexture ) updateVideoTexture( texture );\n\n\t\tif ( texture.isRenderTargetTexture === false && texture.version > 0 && textureProperties.__version !== texture.version ) {\n\n\t\t\tconst image = texture.image;\n\n\t\t\tif ( image === null ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Texture marked for update but no image data found.' );\n\n\t\t\t} else if ( image.complete === false ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Texture marked for update but image is incomplete' );\n\n\t\t\t} else {\n\n\t\t\t\tuploadTexture( textureProperties, texture, slot );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t}\n\n\t\tstate.bindTexture( 3553, textureProperties.__webglTexture, 33984 + slot );\n\n\t}\n\n\tfunction setTexture2DArray( texture, slot ) {\n\n\t\tconst textureProperties = properties.get( texture );\n\n\t\tif ( texture.version > 0 && textureProperties.__version !== texture.version ) {\n\n\t\t\tuploadTexture( textureProperties, texture, slot );\n\t\t\treturn;\n\n\t\t}\n\n\t\tstate.bindTexture( 35866, textureProperties.__webglTexture, 33984 + slot );\n\n\t}\n\n\tfunction setTexture3D( texture, slot ) {\n\n\t\tconst textureProperties = properties.get( texture );\n\n\t\tif ( texture.version > 0 && textureProperties.__version !== texture.version ) {\n\n\t\t\tuploadTexture( textureProperties, texture, slot );\n\t\t\treturn;\n\n\t\t}\n\n\t\tstate.bindTexture( 32879, textureProperties.__webglTexture, 33984 + slot );\n\n\t}\n\n\tfunction setTextureCube( texture, slot ) {\n\n\t\tconst textureProperties = properties.get( texture );\n\n\t\tif ( texture.version > 0 && textureProperties.__version !== texture.version ) {\n\n\t\t\tuploadCubeTexture( textureProperties, texture, slot );\n\t\t\treturn;\n\n\t\t}\n\n\t\tstate.bindTexture( 34067, textureProperties.__webglTexture, 33984 + slot );\n\n\t}\n\n\tconst wrappingToGL = {\n\t\t[ RepeatWrapping ]: 10497,\n\t\t[ ClampToEdgeWrapping ]: 33071,\n\t\t[ MirroredRepeatWrapping ]: 33648\n\t};\n\n\tconst filterToGL = {\n\t\t[ NearestFilter ]: 9728,\n\t\t[ NearestMipmapNearestFilter ]: 9984,\n\t\t[ NearestMipmapLinearFilter ]: 9986,\n\n\t\t[ LinearFilter ]: 9729,\n\t\t[ LinearMipmapNearestFilter ]: 9985,\n\t\t[ LinearMipmapLinearFilter ]: 9987\n\t};\n\n\tfunction setTextureParameters( textureType, texture, supportsMips ) {\n\n\t\tif ( supportsMips ) {\n\n\t\t\t_gl.texParameteri( textureType, 10242, wrappingToGL[ texture.wrapS ] );\n\t\t\t_gl.texParameteri( textureType, 10243, wrappingToGL[ texture.wrapT ] );\n\n\t\t\tif ( textureType === 32879 || textureType === 35866 ) {\n\n\t\t\t\t_gl.texParameteri( textureType, 32882, wrappingToGL[ texture.wrapR ] );\n\n\t\t\t}\n\n\t\t\t_gl.texParameteri( textureType, 10240, filterToGL[ texture.magFilter ] );\n\t\t\t_gl.texParameteri( textureType, 10241, filterToGL[ texture.minFilter ] );\n\n\t\t} else {\n\n\t\t\t_gl.texParameteri( textureType, 10242, 33071 );\n\t\t\t_gl.texParameteri( textureType, 10243, 33071 );\n\n\t\t\tif ( textureType === 32879 || textureType === 35866 ) {\n\n\t\t\t\t_gl.texParameteri( textureType, 32882, 33071 );\n\n\t\t\t}\n\n\t\t\tif ( texture.wrapS !== ClampToEdgeWrapping || texture.wrapT !== ClampToEdgeWrapping ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.' );\n\n\t\t\t}\n\n\t\t\t_gl.texParameteri( textureType, 10240, filterFallback( texture.magFilter ) );\n\t\t\t_gl.texParameteri( textureType, 10241, filterFallback( texture.minFilter ) );\n\n\t\t\tif ( texture.minFilter !== NearestFilter && texture.minFilter !== LinearFilter ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.' );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( extensions.has( 'EXT_texture_filter_anisotropic' ) === true ) {\n\n\t\t\tconst extension = extensions.get( 'EXT_texture_filter_anisotropic' );\n\n\t\t\tif ( texture.magFilter === NearestFilter ) return;\n\t\t\tif ( texture.minFilter !== NearestMipmapLinearFilter && texture.minFilter !== LinearMipmapLinearFilter ) return;\n\t\t\tif ( texture.type === FloatType && extensions.has( 'OES_texture_float_linear' ) === false ) return; // verify extension for WebGL 1 and WebGL 2\n\t\t\tif ( isWebGL2 === false && ( texture.type === HalfFloatType && extensions.has( 'OES_texture_half_float_linear' ) === false ) ) return; // verify extension for WebGL 1 only\n\n\t\t\tif ( texture.anisotropy > 1 || properties.get( texture ).__currentAnisotropy ) {\n\n\t\t\t\t_gl.texParameterf( textureType, extension.TEXTURE_MAX_ANISOTROPY_EXT, Math.min( texture.anisotropy, capabilities.getMaxAnisotropy() ) );\n\t\t\t\tproperties.get( texture ).__currentAnisotropy = texture.anisotropy;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tfunction initTexture( textureProperties, texture ) {\n\n\t\tlet forceUpload = false;\n\n\t\tif ( textureProperties.__webglInit === undefined ) {\n\n\t\t\ttextureProperties.__webglInit = true;\n\n\t\t\ttexture.addEventListener( 'dispose', onTextureDispose );\n\n\t\t}\n\n\t\t// create Source <-> WebGLTextures mapping if necessary\n\n\t\tconst source = texture.source;\n\t\tlet webglTextures = _sources.get( source );\n\n\t\tif ( webglTextures === undefined ) {\n\n\t\t\twebglTextures = {};\n\t\t\t_sources.set( source, webglTextures );\n\n\t\t}\n\n\t\t// check if there is already a WebGLTexture object for the given texture parameters\n\n\t\tconst textureCacheKey = getTextureCacheKey( texture );\n\n\t\tif ( textureCacheKey !== textureProperties.__cacheKey ) {\n\n\t\t\t// if not, create a new instance of WebGLTexture\n\n\t\t\tif ( webglTextures[ textureCacheKey ] === undefined ) {\n\n\t\t\t\t// create new entry\n\n\t\t\t\twebglTextures[ textureCacheKey ] = {\n\t\t\t\t\ttexture: _gl.createTexture(),\n\t\t\t\t\tusedTimes: 0\n\t\t\t\t};\n\n\t\t\t\tinfo.memory.textures ++;\n\n\t\t\t\t// when a new instance of WebGLTexture was created, a texture upload is required\n\t\t\t\t// even if the image contents are identical\n\n\t\t\t\tforceUpload = true;\n\n\t\t\t}\n\n\t\t\twebglTextures[ textureCacheKey ].usedTimes ++;\n\n\t\t\t// every time the texture cache key changes, it's necessary to check if an instance of\n\t\t\t// WebGLTexture can be deleted in order to avoid a memory leak.\n\n\t\t\tconst webglTexture = webglTextures[ textureProperties.__cacheKey ];\n\n\t\t\tif ( webglTexture !== undefined ) {\n\n\t\t\t\twebglTextures[ textureProperties.__cacheKey ].usedTimes --;\n\n\t\t\t\tif ( webglTexture.usedTimes === 0 ) {\n\n\t\t\t\t\tdeleteTexture( texture );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// store references to cache key and WebGLTexture object\n\n\t\t\ttextureProperties.__cacheKey = textureCacheKey;\n\t\t\ttextureProperties.__webglTexture = webglTextures[ textureCacheKey ].texture;\n\n\t\t}\n\n\t\treturn forceUpload;\n\n\t}\n\n\tfunction uploadTexture( textureProperties, texture, slot ) {\n\n\t\tlet textureType = 3553;\n\n\t\tif ( texture.isDataArrayTexture || texture.isCompressedArrayTexture ) textureType = 35866;\n\t\tif ( texture.isData3DTexture ) textureType = 32879;\n\n\t\tconst forceUpload = initTexture( textureProperties, texture );\n\t\tconst source = texture.source;\n\n\t\tstate.bindTexture( textureType, textureProperties.__webglTexture, 33984 + slot );\n\n\t\tconst sourceProperties = properties.get( source );\n\n\t\tif ( source.version !== sourceProperties.__version || forceUpload === true ) {\n\n\t\t\tstate.activeTexture( 33984 + slot );\n\n\t\t\t_gl.pixelStorei( 37440, texture.flipY );\n\t\t\t_gl.pixelStorei( 37441, texture.premultiplyAlpha );\n\t\t\t_gl.pixelStorei( 3317, texture.unpackAlignment );\n\t\t\t_gl.pixelStorei( 37443, 0 );\n\n\t\t\tconst needsPowerOfTwo = textureNeedsPowerOfTwo( texture ) && isPowerOfTwo$1( texture.image ) === false;\n\t\t\tlet image = resizeImage( texture.image, needsPowerOfTwo, false, maxTextureSize );\n\t\t\timage = verifyColorSpace( texture, image );\n\n\t\t\tconst supportsMips = isPowerOfTwo$1( image ) || isWebGL2,\n\t\t\t\tglFormat = utils.convert( texture.format, texture.encoding );\n\n\t\t\tlet glType = utils.convert( texture.type ),\n\t\t\t\tglInternalFormat = getInternalFormat( texture.internalFormat, glFormat, glType, texture.encoding, texture.isVideoTexture );\n\n\t\t\tsetTextureParameters( textureType, texture, supportsMips );\n\n\t\t\tlet mipmap;\n\t\t\tconst mipmaps = texture.mipmaps;\n\n\t\t\tconst useTexStorage = ( isWebGL2 && texture.isVideoTexture !== true );\n\t\t\tconst allocateMemory = ( sourceProperties.__version === undefined ) || ( forceUpload === true );\n\t\t\tconst levels = getMipLevels( texture, image, supportsMips );\n\n\t\t\tif ( texture.isDepthTexture ) {\n\n\t\t\t\t// populate depth texture with dummy data\n\n\t\t\t\tglInternalFormat = 6402;\n\n\t\t\t\tif ( isWebGL2 ) {\n\n\t\t\t\t\tif ( texture.type === FloatType ) {\n\n\t\t\t\t\t\tglInternalFormat = 36012;\n\n\t\t\t\t\t} else if ( texture.type === UnsignedIntType ) {\n\n\t\t\t\t\t\tglInternalFormat = 33190;\n\n\t\t\t\t\t} else if ( texture.type === UnsignedInt248Type ) {\n\n\t\t\t\t\t\tglInternalFormat = 35056;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tglInternalFormat = 33189; // WebGL2 requires sized internalformat for glTexImage2D\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( texture.type === FloatType ) {\n\n\t\t\t\t\t\tconsole.error( 'WebGLRenderer: Floating point depth texture requires WebGL2.' );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t// validation checks for WebGL 1\n\n\t\t\t\tif ( texture.format === DepthFormat && glInternalFormat === 6402 ) {\n\n\t\t\t\t\t// The error INVALID_OPERATION is generated by texImage2D if format and internalformat are\n\t\t\t\t\t// DEPTH_COMPONENT and type is not UNSIGNED_SHORT or UNSIGNED_INT\n\t\t\t\t\t// (https://www.khronos.org/registry/webgl/extensions/WEBGL_depth_texture/)\n\t\t\t\t\tif ( texture.type !== UnsignedShortType && texture.type !== UnsignedIntType ) {\n\n\t\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture.' );\n\n\t\t\t\t\t\ttexture.type = UnsignedIntType;\n\t\t\t\t\t\tglType = utils.convert( texture.type );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( texture.format === DepthStencilFormat && glInternalFormat === 6402 ) {\n\n\t\t\t\t\t// Depth stencil textures need the DEPTH_STENCIL internal format\n\t\t\t\t\t// (https://www.khronos.org/registry/webgl/extensions/WEBGL_depth_texture/)\n\t\t\t\t\tglInternalFormat = 34041;\n\n\t\t\t\t\t// The error INVALID_OPERATION is generated by texImage2D if format and internalformat are\n\t\t\t\t\t// DEPTH_STENCIL and type is not UNSIGNED_INT_24_8_WEBGL.\n\t\t\t\t\t// (https://www.khronos.org/registry/webgl/extensions/WEBGL_depth_texture/)\n\t\t\t\t\tif ( texture.type !== UnsignedInt248Type ) {\n\n\t\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture.' );\n\n\t\t\t\t\t\ttexture.type = UnsignedInt248Type;\n\t\t\t\t\t\tglType = utils.convert( texture.type );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t//\n\n\t\t\t\tif ( allocateMemory ) {\n\n\t\t\t\t\tif ( useTexStorage ) {\n\n\t\t\t\t\t\tstate.texStorage2D( 3553, 1, glInternalFormat, image.width, image.height );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tstate.texImage2D( 3553, 0, glInternalFormat, image.width, image.height, 0, glFormat, glType, null );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else if ( texture.isDataTexture ) {\n\n\t\t\t\t// use manually created mipmaps if available\n\t\t\t\t// if there are no manual mipmaps\n\t\t\t\t// set 0 level mipmap and then use GL to generate other mipmap levels\n\n\t\t\t\tif ( mipmaps.length > 0 && supportsMips ) {\n\n\t\t\t\t\tif ( useTexStorage && allocateMemory ) {\n\n\t\t\t\t\t\tstate.texStorage2D( 3553, levels, glInternalFormat, mipmaps[ 0 ].width, mipmaps[ 0 ].height );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfor ( let i = 0, il = mipmaps.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tmipmap = mipmaps[ i ];\n\n\t\t\t\t\t\tif ( useTexStorage ) {\n\n\t\t\t\t\t\t\tstate.texSubImage2D( 3553, i, 0, 0, mipmap.width, mipmap.height, glFormat, glType, mipmap.data );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tstate.texImage2D( 3553, i, glInternalFormat, mipmap.width, mipmap.height, 0, glFormat, glType, mipmap.data );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\ttexture.generateMipmaps = false;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( useTexStorage ) {\n\n\t\t\t\t\t\tif ( allocateMemory ) {\n\n\t\t\t\t\t\t\tstate.texStorage2D( 3553, levels, glInternalFormat, image.width, image.height );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tstate.texSubImage2D( 3553, 0, 0, 0, image.width, image.height, glFormat, glType, image.data );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tstate.texImage2D( 3553, 0, glInternalFormat, image.width, image.height, 0, glFormat, glType, image.data );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else if ( texture.isCompressedTexture ) {\n\n\t\t\t\tif ( texture.isCompressedArrayTexture ) {\n\n\t\t\t\t\tif ( useTexStorage && allocateMemory ) {\n\n\t\t\t\t\t\tstate.texStorage3D( 35866, levels, glInternalFormat, mipmaps[ 0 ].width, mipmaps[ 0 ].height, image.depth );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfor ( let i = 0, il = mipmaps.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tmipmap = mipmaps[ i ];\n\n\t\t\t\t\t\tif ( texture.format !== RGBAFormat ) {\n\n\t\t\t\t\t\t\tif ( glFormat !== null ) {\n\n\t\t\t\t\t\t\t\tif ( useTexStorage ) {\n\n\t\t\t\t\t\t\t\t\tstate.compressedTexSubImage3D( 35866, i, 0, 0, 0, mipmap.width, mipmap.height, image.depth, glFormat, mipmap.data, 0, 0 );\n\n\t\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\t\tstate.compressedTexImage3D( 35866, i, glInternalFormat, mipmap.width, mipmap.height, image.depth, 0, mipmap.data, 0, 0 );\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()' );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tif ( useTexStorage ) {\n\n\t\t\t\t\t\t\t\tstate.texSubImage3D( 35866, i, 0, 0, 0, mipmap.width, mipmap.height, image.depth, glFormat, glType, mipmap.data );\n\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\tstate.texImage3D( 35866, i, glInternalFormat, mipmap.width, mipmap.height, image.depth, 0, glFormat, glType, mipmap.data );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( useTexStorage && allocateMemory ) {\n\n\t\t\t\t\t\tstate.texStorage2D( 3553, levels, glInternalFormat, mipmaps[ 0 ].width, mipmaps[ 0 ].height );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfor ( let i = 0, il = mipmaps.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tmipmap = mipmaps[ i ];\n\n\t\t\t\t\t\tif ( texture.format !== RGBAFormat ) {\n\n\t\t\t\t\t\t\tif ( glFormat !== null ) {\n\n\t\t\t\t\t\t\t\tif ( useTexStorage ) {\n\n\t\t\t\t\t\t\t\t\tstate.compressedTexSubImage2D( 3553, i, 0, 0, mipmap.width, mipmap.height, glFormat, mipmap.data );\n\n\t\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\t\tstate.compressedTexImage2D( 3553, i, glInternalFormat, mipmap.width, mipmap.height, 0, mipmap.data );\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()' );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tif ( useTexStorage ) {\n\n\t\t\t\t\t\t\t\tstate.texSubImage2D( 3553, i, 0, 0, mipmap.width, mipmap.height, glFormat, glType, mipmap.data );\n\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\tstate.texImage2D( 3553, i, glInternalFormat, mipmap.width, mipmap.height, 0, glFormat, glType, mipmap.data );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else if ( texture.isDataArrayTexture ) {\n\n\t\t\t\tif ( useTexStorage ) {\n\n\t\t\t\t\tif ( allocateMemory ) {\n\n\t\t\t\t\t\tstate.texStorage3D( 35866, levels, glInternalFormat, image.width, image.height, image.depth );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tstate.texSubImage3D( 35866, 0, 0, 0, 0, image.width, image.height, image.depth, glFormat, glType, image.data );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tstate.texImage3D( 35866, 0, glInternalFormat, image.width, image.height, image.depth, 0, glFormat, glType, image.data );\n\n\t\t\t\t}\n\n\t\t\t} else if ( texture.isData3DTexture ) {\n\n\t\t\t\tif ( useTexStorage ) {\n\n\t\t\t\t\tif ( allocateMemory ) {\n\n\t\t\t\t\t\tstate.texStorage3D( 32879, levels, glInternalFormat, image.width, image.height, image.depth );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tstate.texSubImage3D( 32879, 0, 0, 0, 0, image.width, image.height, image.depth, glFormat, glType, image.data );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tstate.texImage3D( 32879, 0, glInternalFormat, image.width, image.height, image.depth, 0, glFormat, glType, image.data );\n\n\t\t\t\t}\n\n\t\t\t} else if ( texture.isFramebufferTexture ) {\n\n\t\t\t\tif ( allocateMemory ) {\n\n\t\t\t\t\tif ( useTexStorage ) {\n\n\t\t\t\t\t\tstate.texStorage2D( 3553, levels, glInternalFormat, image.width, image.height );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tlet width = image.width, height = image.height;\n\n\t\t\t\t\t\tfor ( let i = 0; i < levels; i ++ ) {\n\n\t\t\t\t\t\t\tstate.texImage2D( 3553, i, glInternalFormat, width, height, 0, glFormat, glType, null );\n\n\t\t\t\t\t\t\twidth >>= 1;\n\t\t\t\t\t\t\theight >>= 1;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t// regular Texture (image, video, canvas)\n\n\t\t\t\t// use manually created mipmaps if available\n\t\t\t\t// if there are no manual mipmaps\n\t\t\t\t// set 0 level mipmap and then use GL to generate other mipmap levels\n\n\t\t\t\tif ( mipmaps.length > 0 && supportsMips ) {\n\n\t\t\t\t\tif ( useTexStorage && allocateMemory ) {\n\n\t\t\t\t\t\tstate.texStorage2D( 3553, levels, glInternalFormat, mipmaps[ 0 ].width, mipmaps[ 0 ].height );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfor ( let i = 0, il = mipmaps.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tmipmap = mipmaps[ i ];\n\n\t\t\t\t\t\tif ( useTexStorage ) {\n\n\t\t\t\t\t\t\tstate.texSubImage2D( 3553, i, 0, 0, glFormat, glType, mipmap );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tstate.texImage2D( 3553, i, glInternalFormat, glFormat, glType, mipmap );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\ttexture.generateMipmaps = false;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( useTexStorage ) {\n\n\t\t\t\t\t\tif ( allocateMemory ) {\n\n\t\t\t\t\t\t\tstate.texStorage2D( 3553, levels, glInternalFormat, image.width, image.height );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tstate.texSubImage2D( 3553, 0, 0, 0, glFormat, glType, image );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tstate.texImage2D( 3553, 0, glInternalFormat, glFormat, glType, image );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( textureNeedsGenerateMipmaps( texture, supportsMips ) ) {\n\n\t\t\t\tgenerateMipmap( textureType );\n\n\t\t\t}\n\n\t\t\tsourceProperties.__version = source.version;\n\n\t\t\tif ( texture.onUpdate ) texture.onUpdate( texture );\n\n\t\t}\n\n\t\ttextureProperties.__version = texture.version;\n\n\t}\n\n\tfunction uploadCubeTexture( textureProperties, texture, slot ) {\n\n\t\tif ( texture.image.length !== 6 ) return;\n\n\t\tconst forceUpload = initTexture( textureProperties, texture );\n\t\tconst source = texture.source;\n\n\t\tstate.bindTexture( 34067, textureProperties.__webglTexture, 33984 + slot );\n\n\t\tconst sourceProperties = properties.get( source );\n\n\t\tif ( source.version !== sourceProperties.__version || forceUpload === true ) {\n\n\t\t\tstate.activeTexture( 33984 + slot );\n\n\t\t\t_gl.pixelStorei( 37440, texture.flipY );\n\t\t\t_gl.pixelStorei( 37441, texture.premultiplyAlpha );\n\t\t\t_gl.pixelStorei( 3317, texture.unpackAlignment );\n\t\t\t_gl.pixelStorei( 37443, 0 );\n\n\t\t\tconst isCompressed = ( texture.isCompressedTexture || texture.image[ 0 ].isCompressedTexture );\n\t\t\tconst isDataTexture = ( texture.image[ 0 ] && texture.image[ 0 ].isDataTexture );\n\n\t\t\tconst cubeImage = [];\n\n\t\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\t\tif ( ! isCompressed && ! isDataTexture ) {\n\n\t\t\t\t\tcubeImage[ i ] = resizeImage( texture.image[ i ], false, true, maxCubemapSize );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tcubeImage[ i ] = isDataTexture ? texture.image[ i ].image : texture.image[ i ];\n\n\t\t\t\t}\n\n\t\t\t\tcubeImage[ i ] = verifyColorSpace( texture, cubeImage[ i ] );\n\n\t\t\t}\n\n\t\t\tconst image = cubeImage[ 0 ],\n\t\t\t\tsupportsMips = isPowerOfTwo$1( image ) || isWebGL2,\n\t\t\t\tglFormat = utils.convert( texture.format, texture.encoding ),\n\t\t\t\tglType = utils.convert( texture.type ),\n\t\t\t\tglInternalFormat = getInternalFormat( texture.internalFormat, glFormat, glType, texture.encoding );\n\n\t\t\tconst useTexStorage = ( isWebGL2 && texture.isVideoTexture !== true );\n\t\t\tconst allocateMemory = ( sourceProperties.__version === undefined ) || ( forceUpload === true );\n\t\t\tlet levels = getMipLevels( texture, image, supportsMips );\n\n\t\t\tsetTextureParameters( 34067, texture, supportsMips );\n\n\t\t\tlet mipmaps;\n\n\t\t\tif ( isCompressed ) {\n\n\t\t\t\tif ( useTexStorage && allocateMemory ) {\n\n\t\t\t\t\tstate.texStorage2D( 34067, levels, glInternalFormat, image.width, image.height );\n\n\t\t\t\t}\n\n\t\t\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\t\t\tmipmaps = cubeImage[ i ].mipmaps;\n\n\t\t\t\t\tfor ( let j = 0; j < mipmaps.length; j ++ ) {\n\n\t\t\t\t\t\tconst mipmap = mipmaps[ j ];\n\n\t\t\t\t\t\tif ( texture.format !== RGBAFormat ) {\n\n\t\t\t\t\t\t\tif ( glFormat !== null ) {\n\n\t\t\t\t\t\t\t\tif ( useTexStorage ) {\n\n\t\t\t\t\t\t\t\t\tstate.compressedTexSubImage2D( 34069 + i, j, 0, 0, mipmap.width, mipmap.height, glFormat, mipmap.data );\n\n\t\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\t\tstate.compressedTexImage2D( 34069 + i, j, glInternalFormat, mipmap.width, mipmap.height, 0, mipmap.data );\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()' );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tif ( useTexStorage ) {\n\n\t\t\t\t\t\t\t\tstate.texSubImage2D( 34069 + i, j, 0, 0, mipmap.width, mipmap.height, glFormat, glType, mipmap.data );\n\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\tstate.texImage2D( 34069 + i, j, glInternalFormat, mipmap.width, mipmap.height, 0, glFormat, glType, mipmap.data );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tmipmaps = texture.mipmaps;\n\n\t\t\t\tif ( useTexStorage && allocateMemory ) {\n\n\t\t\t\t\t// TODO: Uniformly handle mipmap definitions\n\t\t\t\t\t// Normal textures and compressed cube textures define base level + mips with their mipmap array\n\t\t\t\t\t// Uncompressed cube textures use their mipmap array only for mips (no base level)\n\n\t\t\t\t\tif ( mipmaps.length > 0 ) levels ++;\n\n\t\t\t\t\tstate.texStorage2D( 34067, levels, glInternalFormat, cubeImage[ 0 ].width, cubeImage[ 0 ].height );\n\n\t\t\t\t}\n\n\t\t\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\t\t\tif ( isDataTexture ) {\n\n\t\t\t\t\t\tif ( useTexStorage ) {\n\n\t\t\t\t\t\t\tstate.texSubImage2D( 34069 + i, 0, 0, 0, cubeImage[ i ].width, cubeImage[ i ].height, glFormat, glType, cubeImage[ i ].data );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tstate.texImage2D( 34069 + i, 0, glInternalFormat, cubeImage[ i ].width, cubeImage[ i ].height, 0, glFormat, glType, cubeImage[ i ].data );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tfor ( let j = 0; j < mipmaps.length; j ++ ) {\n\n\t\t\t\t\t\t\tconst mipmap = mipmaps[ j ];\n\t\t\t\t\t\t\tconst mipmapImage = mipmap.image[ i ].image;\n\n\t\t\t\t\t\t\tif ( useTexStorage ) {\n\n\t\t\t\t\t\t\t\tstate.texSubImage2D( 34069 + i, j + 1, 0, 0, mipmapImage.width, mipmapImage.height, glFormat, glType, mipmapImage.data );\n\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\tstate.texImage2D( 34069 + i, j + 1, glInternalFormat, mipmapImage.width, mipmapImage.height, 0, glFormat, glType, mipmapImage.data );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tif ( useTexStorage ) {\n\n\t\t\t\t\t\t\tstate.texSubImage2D( 34069 + i, 0, 0, 0, glFormat, glType, cubeImage[ i ] );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tstate.texImage2D( 34069 + i, 0, glInternalFormat, glFormat, glType, cubeImage[ i ] );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tfor ( let j = 0; j < mipmaps.length; j ++ ) {\n\n\t\t\t\t\t\t\tconst mipmap = mipmaps[ j ];\n\n\t\t\t\t\t\t\tif ( useTexStorage ) {\n\n\t\t\t\t\t\t\t\tstate.texSubImage2D( 34069 + i, j + 1, 0, 0, glFormat, glType, mipmap.image[ i ] );\n\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\tstate.texImage2D( 34069 + i, j + 1, glInternalFormat, glFormat, glType, mipmap.image[ i ] );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( textureNeedsGenerateMipmaps( texture, supportsMips ) ) {\n\n\t\t\t\t// We assume images for cube map have the same size.\n\t\t\t\tgenerateMipmap( 34067 );\n\n\t\t\t}\n\n\t\t\tsourceProperties.__version = source.version;\n\n\t\t\tif ( texture.onUpdate ) texture.onUpdate( texture );\n\n\t\t}\n\n\t\ttextureProperties.__version = texture.version;\n\n\t}\n\n\t// Render targets\n\n\t// Setup storage for target texture and bind it to correct framebuffer\n\tfunction setupFrameBufferTexture( framebuffer, renderTarget, texture, attachment, textureTarget ) {\n\n\t\tconst glFormat = utils.convert( texture.format, texture.encoding );\n\t\tconst glType = utils.convert( texture.type );\n\t\tconst glInternalFormat = getInternalFormat( texture.internalFormat, glFormat, glType, texture.encoding );\n\t\tconst renderTargetProperties = properties.get( renderTarget );\n\n\t\tif ( ! renderTargetProperties.__hasExternalTextures ) {\n\n\t\t\tif ( textureTarget === 32879 || textureTarget === 35866 ) {\n\n\t\t\t\tstate.texImage3D( textureTarget, 0, glInternalFormat, renderTarget.width, renderTarget.height, renderTarget.depth, 0, glFormat, glType, null );\n\n\t\t\t} else {\n\n\t\t\t\tstate.texImage2D( textureTarget, 0, glInternalFormat, renderTarget.width, renderTarget.height, 0, glFormat, glType, null );\n\n\t\t\t}\n\n\t\t}\n\n\t\tstate.bindFramebuffer( 36160, framebuffer );\n\n\t\tif ( useMultisampledRTT( renderTarget ) ) {\n\n\t\t\tmultisampledRTTExt.framebufferTexture2DMultisampleEXT( 36160, attachment, textureTarget, properties.get( texture ).__webglTexture, 0, getRenderTargetSamples( renderTarget ) );\n\n\t\t} else if ( textureTarget === 3553 || ( textureTarget >= 34069 && textureTarget <= 34074 ) ) { // see #24753\n\n\t\t\t_gl.framebufferTexture2D( 36160, attachment, textureTarget, properties.get( texture ).__webglTexture, 0 );\n\n\t\t}\n\n\t\tstate.bindFramebuffer( 36160, null );\n\n\t}\n\n\n\t// Setup storage for internal depth/stencil buffers and bind to correct framebuffer\n\tfunction setupRenderBufferStorage( renderbuffer, renderTarget, isMultisample ) {\n\n\t\t_gl.bindRenderbuffer( 36161, renderbuffer );\n\n\t\tif ( renderTarget.depthBuffer && ! renderTarget.stencilBuffer ) {\n\n\t\t\tlet glInternalFormat = 33189;\n\n\t\t\tif ( isMultisample || useMultisampledRTT( renderTarget ) ) {\n\n\t\t\t\tconst depthTexture = renderTarget.depthTexture;\n\n\t\t\t\tif ( depthTexture && depthTexture.isDepthTexture ) {\n\n\t\t\t\t\tif ( depthTexture.type === FloatType ) {\n\n\t\t\t\t\t\tglInternalFormat = 36012;\n\n\t\t\t\t\t} else if ( depthTexture.type === UnsignedIntType ) {\n\n\t\t\t\t\t\tglInternalFormat = 33190;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tconst samples = getRenderTargetSamples( renderTarget );\n\n\t\t\t\tif ( useMultisampledRTT( renderTarget ) ) {\n\n\t\t\t\t\tmultisampledRTTExt.renderbufferStorageMultisampleEXT( 36161, samples, glInternalFormat, renderTarget.width, renderTarget.height );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t_gl.renderbufferStorageMultisample( 36161, samples, glInternalFormat, renderTarget.width, renderTarget.height );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t_gl.renderbufferStorage( 36161, glInternalFormat, renderTarget.width, renderTarget.height );\n\n\t\t\t}\n\n\t\t\t_gl.framebufferRenderbuffer( 36160, 36096, 36161, renderbuffer );\n\n\t\t} else if ( renderTarget.depthBuffer && renderTarget.stencilBuffer ) {\n\n\t\t\tconst samples = getRenderTargetSamples( renderTarget );\n\n\t\t\tif ( isMultisample && useMultisampledRTT( renderTarget ) === false ) {\n\n\t\t\t\t_gl.renderbufferStorageMultisample( 36161, samples, 35056, renderTarget.width, renderTarget.height );\n\n\t\t\t} else if ( useMultisampledRTT( renderTarget ) ) {\n\n\t\t\t\tmultisampledRTTExt.renderbufferStorageMultisampleEXT( 36161, samples, 35056, renderTarget.width, renderTarget.height );\n\n\t\t\t} else {\n\n\t\t\t\t_gl.renderbufferStorage( 36161, 34041, renderTarget.width, renderTarget.height );\n\n\t\t\t}\n\n\n\t\t\t_gl.framebufferRenderbuffer( 36160, 33306, 36161, renderbuffer );\n\n\t\t} else {\n\n\t\t\tconst textures = renderTarget.isWebGLMultipleRenderTargets === true ? renderTarget.texture : [ renderTarget.texture ];\n\n\t\t\tfor ( let i = 0; i < textures.length; i ++ ) {\n\n\t\t\t\tconst texture = textures[ i ];\n\n\t\t\t\tconst glFormat = utils.convert( texture.format, texture.encoding );\n\t\t\t\tconst glType = utils.convert( texture.type );\n\t\t\t\tconst glInternalFormat = getInternalFormat( texture.internalFormat, glFormat, glType, texture.encoding );\n\t\t\t\tconst samples = getRenderTargetSamples( renderTarget );\n\n\t\t\t\tif ( isMultisample && useMultisampledRTT( renderTarget ) === false ) {\n\n\t\t\t\t\t_gl.renderbufferStorageMultisample( 36161, samples, glInternalFormat, renderTarget.width, renderTarget.height );\n\n\t\t\t\t} else if ( useMultisampledRTT( renderTarget ) ) {\n\n\t\t\t\t\tmultisampledRTTExt.renderbufferStorageMultisampleEXT( 36161, samples, glInternalFormat, renderTarget.width, renderTarget.height );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t_gl.renderbufferStorage( 36161, glInternalFormat, renderTarget.width, renderTarget.height );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\t_gl.bindRenderbuffer( 36161, null );\n\n\t}\n\n\t// Setup resources for a Depth Texture for a FBO (needs an extension)\n\tfunction setupDepthTexture( framebuffer, renderTarget ) {\n\n\t\tconst isCube = ( renderTarget && renderTarget.isWebGLCubeRenderTarget );\n\t\tif ( isCube ) throw new Error( 'Depth Texture with cube render targets is not supported' );\n\n\t\tstate.bindFramebuffer( 36160, framebuffer );\n\n\t\tif ( ! ( renderTarget.depthTexture && renderTarget.depthTexture.isDepthTexture ) ) {\n\n\t\t\tthrow new Error( 'renderTarget.depthTexture must be an instance of THREE.DepthTexture' );\n\n\t\t}\n\n\t\t// upload an empty depth texture with framebuffer size\n\t\tif ( ! properties.get( renderTarget.depthTexture ).__webglTexture ||\n\t\t\t\trenderTarget.depthTexture.image.width !== renderTarget.width ||\n\t\t\t\trenderTarget.depthTexture.image.height !== renderTarget.height ) {\n\n\t\t\trenderTarget.depthTexture.image.width = renderTarget.width;\n\t\t\trenderTarget.depthTexture.image.height = renderTarget.height;\n\t\t\trenderTarget.depthTexture.needsUpdate = true;\n\n\t\t}\n\n\t\tsetTexture2D( renderTarget.depthTexture, 0 );\n\n\t\tconst webglDepthTexture = properties.get( renderTarget.depthTexture ).__webglTexture;\n\t\tconst samples = getRenderTargetSamples( renderTarget );\n\n\t\tif ( renderTarget.depthTexture.format === DepthFormat ) {\n\n\t\t\tif ( useMultisampledRTT( renderTarget ) ) {\n\n\t\t\t\tmultisampledRTTExt.framebufferTexture2DMultisampleEXT( 36160, 36096, 3553, webglDepthTexture, 0, samples );\n\n\t\t\t} else {\n\n\t\t\t\t_gl.framebufferTexture2D( 36160, 36096, 3553, webglDepthTexture, 0 );\n\n\t\t\t}\n\n\t\t} else if ( renderTarget.depthTexture.format === DepthStencilFormat ) {\n\n\t\t\tif ( useMultisampledRTT( renderTarget ) ) {\n\n\t\t\t\tmultisampledRTTExt.framebufferTexture2DMultisampleEXT( 36160, 33306, 3553, webglDepthTexture, 0, samples );\n\n\t\t\t} else {\n\n\t\t\t\t_gl.framebufferTexture2D( 36160, 33306, 3553, webglDepthTexture, 0 );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tthrow new Error( 'Unknown depthTexture format' );\n\n\t\t}\n\n\t}\n\n\t// Setup GL resources for a non-texture depth buffer\n\tfunction setupDepthRenderbuffer( renderTarget ) {\n\n\t\tconst renderTargetProperties = properties.get( renderTarget );\n\t\tconst isCube = ( renderTarget.isWebGLCubeRenderTarget === true );\n\n\t\tif ( renderTarget.depthTexture && ! renderTargetProperties.__autoAllocateDepthBuffer ) {\n\n\t\t\tif ( isCube ) throw new Error( 'target.depthTexture not supported in Cube render targets' );\n\n\t\t\tsetupDepthTexture( renderTargetProperties.__webglFramebuffer, renderTarget );\n\n\t\t} else {\n\n\t\t\tif ( isCube ) {\n\n\t\t\t\trenderTargetProperties.__webglDepthbuffer = [];\n\n\t\t\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\t\t\tstate.bindFramebuffer( 36160, renderTargetProperties.__webglFramebuffer[ i ] );\n\t\t\t\t\trenderTargetProperties.__webglDepthbuffer[ i ] = _gl.createRenderbuffer();\n\t\t\t\t\tsetupRenderBufferStorage( renderTargetProperties.__webglDepthbuffer[ i ], renderTarget, false );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tstate.bindFramebuffer( 36160, renderTargetProperties.__webglFramebuffer );\n\t\t\t\trenderTargetProperties.__webglDepthbuffer = _gl.createRenderbuffer();\n\t\t\t\tsetupRenderBufferStorage( renderTargetProperties.__webglDepthbuffer, renderTarget, false );\n\n\t\t\t}\n\n\t\t}\n\n\t\tstate.bindFramebuffer( 36160, null );\n\n\t}\n\n\t// rebind framebuffer with external textures\n\tfunction rebindTextures( renderTarget, colorTexture, depthTexture ) {\n\n\t\tconst renderTargetProperties = properties.get( renderTarget );\n\n\t\tif ( colorTexture !== undefined ) {\n\n\t\t\tsetupFrameBufferTexture( renderTargetProperties.__webglFramebuffer, renderTarget, renderTarget.texture, 36064, 3553 );\n\n\t\t}\n\n\t\tif ( depthTexture !== undefined ) {\n\n\t\t\tsetupDepthRenderbuffer( renderTarget );\n\n\t\t}\n\n\t}\n\n\t// Set up GL resources for the render target\n\tfunction setupRenderTarget( renderTarget ) {\n\n\t\tconst texture = renderTarget.texture;\n\n\t\tconst renderTargetProperties = properties.get( renderTarget );\n\t\tconst textureProperties = properties.get( texture );\n\n\t\trenderTarget.addEventListener( 'dispose', onRenderTargetDispose );\n\n\t\tif ( renderTarget.isWebGLMultipleRenderTargets !== true ) {\n\n\t\t\tif ( textureProperties.__webglTexture === undefined ) {\n\n\t\t\t\ttextureProperties.__webglTexture = _gl.createTexture();\n\n\t\t\t}\n\n\t\t\ttextureProperties.__version = texture.version;\n\t\t\tinfo.memory.textures ++;\n\n\t\t}\n\n\t\tconst isCube = ( renderTarget.isWebGLCubeRenderTarget === true );\n\t\tconst isMultipleRenderTargets = ( renderTarget.isWebGLMultipleRenderTargets === true );\n\t\tconst supportsMips = isPowerOfTwo$1( renderTarget ) || isWebGL2;\n\n\t\t// Setup framebuffer\n\n\t\tif ( isCube ) {\n\n\t\t\trenderTargetProperties.__webglFramebuffer = [];\n\n\t\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\t\trenderTargetProperties.__webglFramebuffer[ i ] = _gl.createFramebuffer();\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\trenderTargetProperties.__webglFramebuffer = _gl.createFramebuffer();\n\n\t\t\tif ( isMultipleRenderTargets ) {\n\n\t\t\t\tif ( capabilities.drawBuffers ) {\n\n\t\t\t\t\tconst textures = renderTarget.texture;\n\n\t\t\t\t\tfor ( let i = 0, il = textures.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tconst attachmentProperties = properties.get( textures[ i ] );\n\n\t\t\t\t\t\tif ( attachmentProperties.__webglTexture === undefined ) {\n\n\t\t\t\t\t\t\tattachmentProperties.__webglTexture = _gl.createTexture();\n\n\t\t\t\t\t\t\tinfo.memory.textures ++;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.' );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( ( isWebGL2 && renderTarget.samples > 0 ) && useMultisampledRTT( renderTarget ) === false ) {\n\n\t\t\t\tconst textures = isMultipleRenderTargets ? texture : [ texture ];\n\n\t\t\t\trenderTargetProperties.__webglMultisampledFramebuffer = _gl.createFramebuffer();\n\t\t\t\trenderTargetProperties.__webglColorRenderbuffer = [];\n\n\t\t\t\tstate.bindFramebuffer( 36160, renderTargetProperties.__webglMultisampledFramebuffer );\n\n\t\t\t\tfor ( let i = 0; i < textures.length; i ++ ) {\n\n\t\t\t\t\tconst texture = textures[ i ];\n\t\t\t\t\trenderTargetProperties.__webglColorRenderbuffer[ i ] = _gl.createRenderbuffer();\n\n\t\t\t\t\t_gl.bindRenderbuffer( 36161, renderTargetProperties.__webglColorRenderbuffer[ i ] );\n\n\t\t\t\t\tconst glFormat = utils.convert( texture.format, texture.encoding );\n\t\t\t\t\tconst glType = utils.convert( texture.type );\n\t\t\t\t\tconst glInternalFormat = getInternalFormat( texture.internalFormat, glFormat, glType, texture.encoding, renderTarget.isXRRenderTarget === true );\n\t\t\t\t\tconst samples = getRenderTargetSamples( renderTarget );\n\t\t\t\t\t_gl.renderbufferStorageMultisample( 36161, samples, glInternalFormat, renderTarget.width, renderTarget.height );\n\n\t\t\t\t\t_gl.framebufferRenderbuffer( 36160, 36064 + i, 36161, renderTargetProperties.__webglColorRenderbuffer[ i ] );\n\n\t\t\t\t}\n\n\t\t\t\t_gl.bindRenderbuffer( 36161, null );\n\n\t\t\t\tif ( renderTarget.depthBuffer ) {\n\n\t\t\t\t\trenderTargetProperties.__webglDepthRenderbuffer = _gl.createRenderbuffer();\n\t\t\t\t\tsetupRenderBufferStorage( renderTargetProperties.__webglDepthRenderbuffer, renderTarget, true );\n\n\t\t\t\t}\n\n\t\t\t\tstate.bindFramebuffer( 36160, null );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Setup color buffer\n\n\t\tif ( isCube ) {\n\n\t\t\tstate.bindTexture( 34067, textureProperties.__webglTexture );\n\t\t\tsetTextureParameters( 34067, texture, supportsMips );\n\n\t\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\t\tsetupFrameBufferTexture( renderTargetProperties.__webglFramebuffer[ i ], renderTarget, texture, 36064, 34069 + i );\n\n\t\t\t}\n\n\t\t\tif ( textureNeedsGenerateMipmaps( texture, supportsMips ) ) {\n\n\t\t\t\tgenerateMipmap( 34067 );\n\n\t\t\t}\n\n\t\t\tstate.unbindTexture();\n\n\t\t} else if ( isMultipleRenderTargets ) {\n\n\t\t\tconst textures = renderTarget.texture;\n\n\t\t\tfor ( let i = 0, il = textures.length; i < il; i ++ ) {\n\n\t\t\t\tconst attachment = textures[ i ];\n\t\t\t\tconst attachmentProperties = properties.get( attachment );\n\n\t\t\t\tstate.bindTexture( 3553, attachmentProperties.__webglTexture );\n\t\t\t\tsetTextureParameters( 3553, attachment, supportsMips );\n\t\t\t\tsetupFrameBufferTexture( renderTargetProperties.__webglFramebuffer, renderTarget, attachment, 36064 + i, 3553 );\n\n\t\t\t\tif ( textureNeedsGenerateMipmaps( attachment, supportsMips ) ) {\n\n\t\t\t\t\tgenerateMipmap( 3553 );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tstate.unbindTexture();\n\n\t\t} else {\n\n\t\t\tlet glTextureType = 3553;\n\n\t\t\tif ( renderTarget.isWebGL3DRenderTarget || renderTarget.isWebGLArrayRenderTarget ) {\n\n\t\t\t\tif ( isWebGL2 ) {\n\n\t\t\t\t\tglTextureType = renderTarget.isWebGL3DRenderTarget ? 32879 : 35866;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( 'THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.' );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tstate.bindTexture( glTextureType, textureProperties.__webglTexture );\n\t\t\tsetTextureParameters( glTextureType, texture, supportsMips );\n\t\t\tsetupFrameBufferTexture( renderTargetProperties.__webglFramebuffer, renderTarget, texture, 36064, glTextureType );\n\n\t\t\tif ( textureNeedsGenerateMipmaps( texture, supportsMips ) ) {\n\n\t\t\t\tgenerateMipmap( glTextureType );\n\n\t\t\t}\n\n\t\t\tstate.unbindTexture();\n\n\t\t}\n\n\t\t// Setup depth and stencil buffers\n\n\t\tif ( renderTarget.depthBuffer ) {\n\n\t\t\tsetupDepthRenderbuffer( renderTarget );\n\n\t\t}\n\n\t}\n\n\tfunction updateRenderTargetMipmap( renderTarget ) {\n\n\t\tconst supportsMips = isPowerOfTwo$1( renderTarget ) || isWebGL2;\n\n\t\tconst textures = renderTarget.isWebGLMultipleRenderTargets === true ? renderTarget.texture : [ renderTarget.texture ];\n\n\t\tfor ( let i = 0, il = textures.length; i < il; i ++ ) {\n\n\t\t\tconst texture = textures[ i ];\n\n\t\t\tif ( textureNeedsGenerateMipmaps( texture, supportsMips ) ) {\n\n\t\t\t\tconst target = renderTarget.isWebGLCubeRenderTarget ? 34067 : 3553;\n\t\t\t\tconst webglTexture = properties.get( texture ).__webglTexture;\n\n\t\t\t\tstate.bindTexture( target, webglTexture );\n\t\t\t\tgenerateMipmap( target );\n\t\t\t\tstate.unbindTexture();\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tfunction updateMultisampleRenderTarget( renderTarget ) {\n\n\t\tif ( ( isWebGL2 && renderTarget.samples > 0 ) && useMultisampledRTT( renderTarget ) === false ) {\n\n\t\t\tconst textures = renderTarget.isWebGLMultipleRenderTargets ? renderTarget.texture : [ renderTarget.texture ];\n\t\t\tconst width = renderTarget.width;\n\t\t\tconst height = renderTarget.height;\n\t\t\tlet mask = 16384;\n\t\t\tconst invalidationArray = [];\n\t\t\tconst depthStyle = renderTarget.stencilBuffer ? 33306 : 36096;\n\t\t\tconst renderTargetProperties = properties.get( renderTarget );\n\t\t\tconst isMultipleRenderTargets = ( renderTarget.isWebGLMultipleRenderTargets === true );\n\n\t\t\t// If MRT we need to remove FBO attachments\n\t\t\tif ( isMultipleRenderTargets ) {\n\n\t\t\t\tfor ( let i = 0; i < textures.length; i ++ ) {\n\n\t\t\t\t\tstate.bindFramebuffer( 36160, renderTargetProperties.__webglMultisampledFramebuffer );\n\t\t\t\t\t_gl.framebufferRenderbuffer( 36160, 36064 + i, 36161, null );\n\n\t\t\t\t\tstate.bindFramebuffer( 36160, renderTargetProperties.__webglFramebuffer );\n\t\t\t\t\t_gl.framebufferTexture2D( 36009, 36064 + i, 3553, null, 0 );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tstate.bindFramebuffer( 36008, renderTargetProperties.__webglMultisampledFramebuffer );\n\t\t\tstate.bindFramebuffer( 36009, renderTargetProperties.__webglFramebuffer );\n\n\t\t\tfor ( let i = 0; i < textures.length; i ++ ) {\n\n\t\t\t\tinvalidationArray.push( 36064 + i );\n\n\t\t\t\tif ( renderTarget.depthBuffer ) {\n\n\t\t\t\t\tinvalidationArray.push( depthStyle );\n\n\t\t\t\t}\n\n\t\t\t\tconst ignoreDepthValues = ( renderTargetProperties.__ignoreDepthValues !== undefined ) ? renderTargetProperties.__ignoreDepthValues : false;\n\n\t\t\t\tif ( ignoreDepthValues === false ) {\n\n\t\t\t\t\tif ( renderTarget.depthBuffer ) mask |= 256;\n\t\t\t\t\tif ( renderTarget.stencilBuffer ) mask |= 1024;\n\n\t\t\t\t}\n\n\t\t\t\tif ( isMultipleRenderTargets ) {\n\n\t\t\t\t\t_gl.framebufferRenderbuffer( 36008, 36064, 36161, renderTargetProperties.__webglColorRenderbuffer[ i ] );\n\n\t\t\t\t}\n\n\t\t\t\tif ( ignoreDepthValues === true ) {\n\n\t\t\t\t\t_gl.invalidateFramebuffer( 36008, [ depthStyle ] );\n\t\t\t\t\t_gl.invalidateFramebuffer( 36009, [ depthStyle ] );\n\n\t\t\t\t}\n\n\t\t\t\tif ( isMultipleRenderTargets ) {\n\n\t\t\t\t\tconst webglTexture = properties.get( textures[ i ] ).__webglTexture;\n\t\t\t\t\t_gl.framebufferTexture2D( 36009, 36064, 3553, webglTexture, 0 );\n\n\t\t\t\t}\n\n\t\t\t\t_gl.blitFramebuffer( 0, 0, width, height, 0, 0, width, height, mask, 9728 );\n\n\t\t\t\tif ( supportsInvalidateFramebuffer ) {\n\n\t\t\t\t\t_gl.invalidateFramebuffer( 36008, invalidationArray );\n\n\t\t\t\t}\n\n\n\t\t\t}\n\n\t\t\tstate.bindFramebuffer( 36008, null );\n\t\t\tstate.bindFramebuffer( 36009, null );\n\n\t\t\t// If MRT since pre-blit we removed the FBO we need to reconstruct the attachments\n\t\t\tif ( isMultipleRenderTargets ) {\n\n\t\t\t\tfor ( let i = 0; i < textures.length; i ++ ) {\n\n\t\t\t\t\tstate.bindFramebuffer( 36160, renderTargetProperties.__webglMultisampledFramebuffer );\n\t\t\t\t\t_gl.framebufferRenderbuffer( 36160, 36064 + i, 36161, renderTargetProperties.__webglColorRenderbuffer[ i ] );\n\n\t\t\t\t\tconst webglTexture = properties.get( textures[ i ] ).__webglTexture;\n\n\t\t\t\t\tstate.bindFramebuffer( 36160, renderTargetProperties.__webglFramebuffer );\n\t\t\t\t\t_gl.framebufferTexture2D( 36009, 36064 + i, 3553, webglTexture, 0 );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tstate.bindFramebuffer( 36009, renderTargetProperties.__webglMultisampledFramebuffer );\n\n\t\t}\n\n\t}\n\n\tfunction getRenderTargetSamples( renderTarget ) {\n\n\t\treturn Math.min( maxSamples, renderTarget.samples );\n\n\t}\n\n\tfunction useMultisampledRTT( renderTarget ) {\n\n\t\tconst renderTargetProperties = properties.get( renderTarget );\n\n\t\treturn isWebGL2 && renderTarget.samples > 0 && extensions.has( 'WEBGL_multisampled_render_to_texture' ) === true && renderTargetProperties.__useRenderToTexture !== false;\n\n\t}\n\n\tfunction updateVideoTexture( texture ) {\n\n\t\tconst frame = info.render.frame;\n\n\t\t// Check the last frame we updated the VideoTexture\n\n\t\tif ( _videoTextures.get( texture ) !== frame ) {\n\n\t\t\t_videoTextures.set( texture, frame );\n\t\t\ttexture.update();\n\n\t\t}\n\n\t}\n\n\tfunction verifyColorSpace( texture, image ) {\n\n\t\tconst encoding = texture.encoding;\n\t\tconst format = texture.format;\n\t\tconst type = texture.type;\n\n\t\tif ( texture.isCompressedTexture === true || texture.isVideoTexture === true || texture.format === _SRGBAFormat ) return image;\n\n\t\tif ( encoding !== LinearEncoding ) {\n\n\t\t\t// sRGB\n\n\t\t\tif ( encoding === sRGBEncoding ) {\n\n\t\t\t\tif ( isWebGL2 === false ) {\n\n\t\t\t\t\t// in WebGL 1, try to use EXT_sRGB extension and unsized formats\n\n\t\t\t\t\tif ( extensions.has( 'EXT_sRGB' ) === true && format === RGBAFormat ) {\n\n\t\t\t\t\t\ttexture.format = _SRGBAFormat;\n\n\t\t\t\t\t\t// it's not possible to generate mips in WebGL 1 with this extension\n\n\t\t\t\t\t\ttexture.minFilter = LinearFilter;\n\t\t\t\t\t\ttexture.generateMipmaps = false;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// slow fallback (CPU decode)\n\n\t\t\t\t\t\timage = ImageUtils.sRGBToLinear( image );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// in WebGL 2 uncompressed textures can only be sRGB encoded if they have the RGBA8 format\n\n\t\t\t\t\tif ( format !== RGBAFormat || type !== UnsignedByteType ) {\n\n\t\t\t\t\t\tconsole.warn( 'THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType.' );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tconsole.error( 'THREE.WebGLTextures: Unsupported texture encoding:', encoding );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn image;\n\n\t}\n\n\t//\n\n\tthis.allocateTextureUnit = allocateTextureUnit;\n\tthis.resetTextureUnits = resetTextureUnits;\n\n\tthis.setTexture2D = setTexture2D;\n\tthis.setTexture2DArray = setTexture2DArray;\n\tthis.setTexture3D = setTexture3D;\n\tthis.setTextureCube = setTextureCube;\n\tthis.rebindTextures = rebindTextures;\n\tthis.setupRenderTarget = setupRenderTarget;\n\tthis.updateRenderTargetMipmap = updateRenderTargetMipmap;\n\tthis.updateMultisampleRenderTarget = updateMultisampleRenderTarget;\n\tthis.setupDepthRenderbuffer = setupDepthRenderbuffer;\n\tthis.setupFrameBufferTexture = setupFrameBufferTexture;\n\tthis.useMultisampledRTT = useMultisampledRTT;\n\n}\n\nfunction WebGLUtils( gl, extensions, capabilities ) {\n\n\tconst isWebGL2 = capabilities.isWebGL2;\n\n\tfunction convert( p, encoding = null ) {\n\n\t\tlet extension;\n\n\t\tif ( p === UnsignedByteType ) return 5121;\n\t\tif ( p === UnsignedShort4444Type ) return 32819;\n\t\tif ( p === UnsignedShort5551Type ) return 32820;\n\n\t\tif ( p === ByteType ) return 5120;\n\t\tif ( p === ShortType ) return 5122;\n\t\tif ( p === UnsignedShortType ) return 5123;\n\t\tif ( p === IntType ) return 5124;\n\t\tif ( p === UnsignedIntType ) return 5125;\n\t\tif ( p === FloatType ) return 5126;\n\n\t\tif ( p === HalfFloatType ) {\n\n\t\t\tif ( isWebGL2 ) return 5131;\n\n\t\t\textension = extensions.get( 'OES_texture_half_float' );\n\n\t\t\tif ( extension !== null ) {\n\n\t\t\t\treturn extension.HALF_FLOAT_OES;\n\n\t\t\t} else {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( p === AlphaFormat ) return 6406;\n\t\tif ( p === RGBAFormat ) return 6408;\n\t\tif ( p === LuminanceFormat ) return 6409;\n\t\tif ( p === LuminanceAlphaFormat ) return 6410;\n\t\tif ( p === DepthFormat ) return 6402;\n\t\tif ( p === DepthStencilFormat ) return 34041;\n\n\t\t// @deprecated since r137\n\n\t\tif ( p === RGBFormat ) {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228' );\n\t\t\treturn 6408;\n\n\t\t}\n\n\t\t// WebGL 1 sRGB fallback\n\n\t\tif ( p === _SRGBAFormat ) {\n\n\t\t\textension = extensions.get( 'EXT_sRGB' );\n\n\t\t\tif ( extension !== null ) {\n\n\t\t\t\treturn extension.SRGB_ALPHA_EXT;\n\n\t\t\t} else {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// WebGL2 formats.\n\n\t\tif ( p === RedFormat ) return 6403;\n\t\tif ( p === RedIntegerFormat ) return 36244;\n\t\tif ( p === RGFormat ) return 33319;\n\t\tif ( p === RGIntegerFormat ) return 33320;\n\t\tif ( p === RGBAIntegerFormat ) return 36249;\n\n\t\t// S3TC\n\n\t\tif ( p === RGB_S3TC_DXT1_Format || p === RGBA_S3TC_DXT1_Format || p === RGBA_S3TC_DXT3_Format || p === RGBA_S3TC_DXT5_Format ) {\n\n\t\t\tif ( encoding === sRGBEncoding ) {\n\n\t\t\t\textension = extensions.get( 'WEBGL_compressed_texture_s3tc_srgb' );\n\n\t\t\t\tif ( extension !== null ) {\n\n\t\t\t\t\tif ( p === RGB_S3TC_DXT1_Format ) return extension.COMPRESSED_SRGB_S3TC_DXT1_EXT;\n\t\t\t\t\tif ( p === RGBA_S3TC_DXT1_Format ) return extension.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;\n\t\t\t\t\tif ( p === RGBA_S3TC_DXT3_Format ) return extension.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;\n\t\t\t\t\tif ( p === RGBA_S3TC_DXT5_Format ) return extension.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT;\n\n\t\t\t\t} else {\n\n\t\t\t\t\treturn null;\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\textension = extensions.get( 'WEBGL_compressed_texture_s3tc' );\n\n\t\t\t\tif ( extension !== null ) {\n\n\t\t\t\t\tif ( p === RGB_S3TC_DXT1_Format ) return extension.COMPRESSED_RGB_S3TC_DXT1_EXT;\n\t\t\t\t\tif ( p === RGBA_S3TC_DXT1_Format ) return extension.COMPRESSED_RGBA_S3TC_DXT1_EXT;\n\t\t\t\t\tif ( p === RGBA_S3TC_DXT3_Format ) return extension.COMPRESSED_RGBA_S3TC_DXT3_EXT;\n\t\t\t\t\tif ( p === RGBA_S3TC_DXT5_Format ) return extension.COMPRESSED_RGBA_S3TC_DXT5_EXT;\n\n\t\t\t\t} else {\n\n\t\t\t\t\treturn null;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\t// PVRTC\n\n\t\tif ( p === RGB_PVRTC_4BPPV1_Format || p === RGB_PVRTC_2BPPV1_Format || p === RGBA_PVRTC_4BPPV1_Format || p === RGBA_PVRTC_2BPPV1_Format ) {\n\n\t\t\textension = extensions.get( 'WEBGL_compressed_texture_pvrtc' );\n\n\t\t\tif ( extension !== null ) {\n\n\t\t\t\tif ( p === RGB_PVRTC_4BPPV1_Format ) return extension.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;\n\t\t\t\tif ( p === RGB_PVRTC_2BPPV1_Format ) return extension.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;\n\t\t\t\tif ( p === RGBA_PVRTC_4BPPV1_Format ) return extension.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;\n\t\t\t\tif ( p === RGBA_PVRTC_2BPPV1_Format ) return extension.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG;\n\n\t\t\t} else {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// ETC1\n\n\t\tif ( p === RGB_ETC1_Format ) {\n\n\t\t\textension = extensions.get( 'WEBGL_compressed_texture_etc1' );\n\n\t\t\tif ( extension !== null ) {\n\n\t\t\t\treturn extension.COMPRESSED_RGB_ETC1_WEBGL;\n\n\t\t\t} else {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// ETC2\n\n\t\tif ( p === RGB_ETC2_Format || p === RGBA_ETC2_EAC_Format ) {\n\n\t\t\textension = extensions.get( 'WEBGL_compressed_texture_etc' );\n\n\t\t\tif ( extension !== null ) {\n\n\t\t\t\tif ( p === RGB_ETC2_Format ) return ( encoding === sRGBEncoding ) ? extension.COMPRESSED_SRGB8_ETC2 : extension.COMPRESSED_RGB8_ETC2;\n\t\t\t\tif ( p === RGBA_ETC2_EAC_Format ) return ( encoding === sRGBEncoding ) ? extension.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC : extension.COMPRESSED_RGBA8_ETC2_EAC;\n\n\t\t\t} else {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// ASTC\n\n\t\tif ( p === RGBA_ASTC_4x4_Format || p === RGBA_ASTC_5x4_Format || p === RGBA_ASTC_5x5_Format ||\n\t\t\tp === RGBA_ASTC_6x5_Format || p === RGBA_ASTC_6x6_Format || p === RGBA_ASTC_8x5_Format ||\n\t\t\tp === RGBA_ASTC_8x6_Format || p === RGBA_ASTC_8x8_Format || p === RGBA_ASTC_10x5_Format ||\n\t\t\tp === RGBA_ASTC_10x6_Format || p === RGBA_ASTC_10x8_Format || p === RGBA_ASTC_10x10_Format ||\n\t\t\tp === RGBA_ASTC_12x10_Format || p === RGBA_ASTC_12x12_Format ) {\n\n\t\t\textension = extensions.get( 'WEBGL_compressed_texture_astc' );\n\n\t\t\tif ( extension !== null ) {\n\n\t\t\t\tif ( p === RGBA_ASTC_4x4_Format ) return ( encoding === sRGBEncoding ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR : extension.COMPRESSED_RGBA_ASTC_4x4_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_5x4_Format ) return ( encoding === sRGBEncoding ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR : extension.COMPRESSED_RGBA_ASTC_5x4_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_5x5_Format ) return ( encoding === sRGBEncoding ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR : extension.COMPRESSED_RGBA_ASTC_5x5_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_6x5_Format ) return ( encoding === sRGBEncoding ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR : extension.COMPRESSED_RGBA_ASTC_6x5_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_6x6_Format ) return ( encoding === sRGBEncoding ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR : extension.COMPRESSED_RGBA_ASTC_6x6_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_8x5_Format ) return ( encoding === sRGBEncoding ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR : extension.COMPRESSED_RGBA_ASTC_8x5_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_8x6_Format ) return ( encoding === sRGBEncoding ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR : extension.COMPRESSED_RGBA_ASTC_8x6_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_8x8_Format ) return ( encoding === sRGBEncoding ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR : extension.COMPRESSED_RGBA_ASTC_8x8_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_10x5_Format ) return ( encoding === sRGBEncoding ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR : extension.COMPRESSED_RGBA_ASTC_10x5_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_10x6_Format ) return ( encoding === sRGBEncoding ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR : extension.COMPRESSED_RGBA_ASTC_10x6_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_10x8_Format ) return ( encoding === sRGBEncoding ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR : extension.COMPRESSED_RGBA_ASTC_10x8_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_10x10_Format ) return ( encoding === sRGBEncoding ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR : extension.COMPRESSED_RGBA_ASTC_10x10_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_12x10_Format ) return ( encoding === sRGBEncoding ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR : extension.COMPRESSED_RGBA_ASTC_12x10_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_12x12_Format ) return ( encoding === sRGBEncoding ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR : extension.COMPRESSED_RGBA_ASTC_12x12_KHR;\n\n\t\t\t} else {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// BPTC\n\n\t\tif ( p === RGBA_BPTC_Format ) {\n\n\t\t\textension = extensions.get( 'EXT_texture_compression_bptc' );\n\n\t\t\tif ( extension !== null ) {\n\n\t\t\t\tif ( p === RGBA_BPTC_Format ) return ( encoding === sRGBEncoding ) ? extension.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT : extension.COMPRESSED_RGBA_BPTC_UNORM_EXT;\n\n\t\t\t} else {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tif ( p === UnsignedInt248Type ) {\n\n\t\t\tif ( isWebGL2 ) return 34042;\n\n\t\t\textension = extensions.get( 'WEBGL_depth_texture' );\n\n\t\t\tif ( extension !== null ) {\n\n\t\t\t\treturn extension.UNSIGNED_INT_24_8_WEBGL;\n\n\t\t\t} else {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// if \"p\" can't be resolved, assume the user defines a WebGL constant as a string (fallback/workaround for packed RGB formats)\n\n\t\treturn ( gl[ p ] !== undefined ) ? gl[ p ] : null;\n\n\t}\n\n\treturn { convert: convert };\n\n}\n\nclass ArrayCamera extends PerspectiveCamera {\n\n\tconstructor( array = [] ) {\n\n\t\tsuper();\n\n\t\tthis.isArrayCamera = true;\n\n\t\tthis.cameras = array;\n\n\t}\n\n}\n\nclass Group extends Object3D {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.isGroup = true;\n\n\t\tthis.type = 'Group';\n\n\t}\n\n}\n\nconst _moveEvent = { type: 'move' };\n\nclass WebXRController {\n\n\tconstructor() {\n\n\t\tthis._targetRay = null;\n\t\tthis._grip = null;\n\t\tthis._hand = null;\n\n\t}\n\n\tgetHandSpace() {\n\n\t\tif ( this._hand === null ) {\n\n\t\t\tthis._hand = new Group();\n\t\t\tthis._hand.matrixAutoUpdate = false;\n\t\t\tthis._hand.visible = false;\n\n\t\t\tthis._hand.joints = {};\n\t\t\tthis._hand.inputState = { pinching: false };\n\n\t\t}\n\n\t\treturn this._hand;\n\n\t}\n\n\tgetTargetRaySpace() {\n\n\t\tif ( this._targetRay === null ) {\n\n\t\t\tthis._targetRay = new Group();\n\t\t\tthis._targetRay.matrixAutoUpdate = false;\n\t\t\tthis._targetRay.visible = false;\n\t\t\tthis._targetRay.hasLinearVelocity = false;\n\t\t\tthis._targetRay.linearVelocity = new Vector3();\n\t\t\tthis._targetRay.hasAngularVelocity = false;\n\t\t\tthis._targetRay.angularVelocity = new Vector3();\n\n\t\t}\n\n\t\treturn this._targetRay;\n\n\t}\n\n\tgetGripSpace() {\n\n\t\tif ( this._grip === null ) {\n\n\t\t\tthis._grip = new Group();\n\t\t\tthis._grip.matrixAutoUpdate = false;\n\t\t\tthis._grip.visible = false;\n\t\t\tthis._grip.hasLinearVelocity = false;\n\t\t\tthis._grip.linearVelocity = new Vector3();\n\t\t\tthis._grip.hasAngularVelocity = false;\n\t\t\tthis._grip.angularVelocity = new Vector3();\n\n\t\t}\n\n\t\treturn this._grip;\n\n\t}\n\n\tdispatchEvent( event ) {\n\n\t\tif ( this._targetRay !== null ) {\n\n\t\t\tthis._targetRay.dispatchEvent( event );\n\n\t\t}\n\n\t\tif ( this._grip !== null ) {\n\n\t\t\tthis._grip.dispatchEvent( event );\n\n\t\t}\n\n\t\tif ( this._hand !== null ) {\n\n\t\t\tthis._hand.dispatchEvent( event );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tconnect( inputSource ) {\n\n\t\tif ( inputSource && inputSource.hand ) {\n\n\t\t\tconst hand = this._hand;\n\n\t\t\tif ( hand ) {\n\n\t\t\t\tfor ( const inputjoint of inputSource.hand.values() ) {\n\n\t\t\t\t\t// Initialize hand with joints when connected\n\t\t\t\t\tthis._getHandJoint( hand, inputjoint );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.dispatchEvent( { type: 'connected', data: inputSource } );\n\n\t\treturn this;\n\n\t}\n\n\tdisconnect( inputSource ) {\n\n\t\tthis.dispatchEvent( { type: 'disconnected', data: inputSource } );\n\n\t\tif ( this._targetRay !== null ) {\n\n\t\t\tthis._targetRay.visible = false;\n\n\t\t}\n\n\t\tif ( this._grip !== null ) {\n\n\t\t\tthis._grip.visible = false;\n\n\t\t}\n\n\t\tif ( this._hand !== null ) {\n\n\t\t\tthis._hand.visible = false;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tupdate( inputSource, frame, referenceSpace ) {\n\n\t\tlet inputPose = null;\n\t\tlet gripPose = null;\n\t\tlet handPose = null;\n\n\t\tconst targetRay = this._targetRay;\n\t\tconst grip = this._grip;\n\t\tconst hand = this._hand;\n\n\t\tif ( inputSource && frame.session.visibilityState !== 'visible-blurred' ) {\n\n\t\t\tif ( hand && inputSource.hand ) {\n\n\t\t\t\thandPose = true;\n\n\t\t\t\tfor ( const inputjoint of inputSource.hand.values() ) {\n\n\t\t\t\t\t// Update the joints groups with the XRJoint poses\n\t\t\t\t\tconst jointPose = frame.getJointPose( inputjoint, referenceSpace );\n\n\t\t\t\t\t// The transform of this joint will be updated with the joint pose on each frame\n\t\t\t\t\tconst joint = this._getHandJoint( hand, inputjoint );\n\n\t\t\t\t\tif ( jointPose !== null ) {\n\n\t\t\t\t\t\tjoint.matrix.fromArray( jointPose.transform.matrix );\n\t\t\t\t\t\tjoint.matrix.decompose( joint.position, joint.rotation, joint.scale );\n\t\t\t\t\t\tjoint.jointRadius = jointPose.radius;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tjoint.visible = jointPose !== null;\n\n\t\t\t\t}\n\n\t\t\t\t// Custom events\n\n\t\t\t\t// Check pinchz\n\t\t\t\tconst indexTip = hand.joints[ 'index-finger-tip' ];\n\t\t\t\tconst thumbTip = hand.joints[ 'thumb-tip' ];\n\t\t\t\tconst distance = indexTip.position.distanceTo( thumbTip.position );\n\n\t\t\t\tconst distanceToPinch = 0.02;\n\t\t\t\tconst threshold = 0.005;\n\n\t\t\t\tif ( hand.inputState.pinching && distance > distanceToPinch + threshold ) {\n\n\t\t\t\t\thand.inputState.pinching = false;\n\t\t\t\t\tthis.dispatchEvent( {\n\t\t\t\t\t\ttype: 'pinchend',\n\t\t\t\t\t\thandedness: inputSource.handedness,\n\t\t\t\t\t\ttarget: this\n\t\t\t\t\t} );\n\n\t\t\t\t} else if ( ! hand.inputState.pinching && distance <= distanceToPinch - threshold ) {\n\n\t\t\t\t\thand.inputState.pinching = true;\n\t\t\t\t\tthis.dispatchEvent( {\n\t\t\t\t\t\ttype: 'pinchstart',\n\t\t\t\t\t\thandedness: inputSource.handedness,\n\t\t\t\t\t\ttarget: this\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tif ( grip !== null && inputSource.gripSpace ) {\n\n\t\t\t\t\tgripPose = frame.getPose( inputSource.gripSpace, referenceSpace );\n\n\t\t\t\t\tif ( gripPose !== null ) {\n\n\t\t\t\t\t\tgrip.matrix.fromArray( gripPose.transform.matrix );\n\t\t\t\t\t\tgrip.matrix.decompose( grip.position, grip.rotation, grip.scale );\n\n\t\t\t\t\t\tif ( gripPose.linearVelocity ) {\n\n\t\t\t\t\t\t\tgrip.hasLinearVelocity = true;\n\t\t\t\t\t\t\tgrip.linearVelocity.copy( gripPose.linearVelocity );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tgrip.hasLinearVelocity = false;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( gripPose.angularVelocity ) {\n\n\t\t\t\t\t\t\tgrip.hasAngularVelocity = true;\n\t\t\t\t\t\t\tgrip.angularVelocity.copy( gripPose.angularVelocity );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tgrip.hasAngularVelocity = false;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( targetRay !== null ) {\n\n\t\t\t\tinputPose = frame.getPose( inputSource.targetRaySpace, referenceSpace );\n\n\t\t\t\t// Some runtimes (namely Vive Cosmos with Vive OpenXR Runtime) have only grip space and ray space is equal to it\n\t\t\t\tif ( inputPose === null && gripPose !== null ) {\n\n\t\t\t\t\tinputPose = gripPose;\n\n\t\t\t\t}\n\n\t\t\t\tif ( inputPose !== null ) {\n\n\t\t\t\t\ttargetRay.matrix.fromArray( inputPose.transform.matrix );\n\t\t\t\t\ttargetRay.matrix.decompose( targetRay.position, targetRay.rotation, targetRay.scale );\n\n\t\t\t\t\tif ( inputPose.linearVelocity ) {\n\n\t\t\t\t\t\ttargetRay.hasLinearVelocity = true;\n\t\t\t\t\t\ttargetRay.linearVelocity.copy( inputPose.linearVelocity );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\ttargetRay.hasLinearVelocity = false;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( inputPose.angularVelocity ) {\n\n\t\t\t\t\t\ttargetRay.hasAngularVelocity = true;\n\t\t\t\t\t\ttargetRay.angularVelocity.copy( inputPose.angularVelocity );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\ttargetRay.hasAngularVelocity = false;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.dispatchEvent( _moveEvent );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\n\t\t}\n\n\t\tif ( targetRay !== null ) {\n\n\t\t\ttargetRay.visible = ( inputPose !== null );\n\n\t\t}\n\n\t\tif ( grip !== null ) {\n\n\t\t\tgrip.visible = ( gripPose !== null );\n\n\t\t}\n\n\t\tif ( hand !== null ) {\n\n\t\t\thand.visible = ( handPose !== null );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t// private method\n\n\t_getHandJoint( hand, inputjoint ) {\n\n\t\tif ( hand.joints[ inputjoint.jointName ] === undefined ) {\n\n\t\t\tconst joint = new Group();\n\t\t\tjoint.matrixAutoUpdate = false;\n\t\t\tjoint.visible = false;\n\t\t\thand.joints[ inputjoint.jointName ] = joint;\n\n\t\t\thand.add( joint );\n\n\t\t}\n\n\t\treturn hand.joints[ inputjoint.jointName ];\n\n\t}\n\n}\n\nclass DepthTexture extends Texture {\n\n\tconstructor( width, height, type, mapping, wrapS, wrapT, magFilter, minFilter, anisotropy, format ) {\n\n\t\tformat = format !== undefined ? format : DepthFormat;\n\n\t\tif ( format !== DepthFormat && format !== DepthStencilFormat ) {\n\n\t\t\tthrow new Error( 'DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat' );\n\n\t\t}\n\n\t\tif ( type === undefined && format === DepthFormat ) type = UnsignedIntType;\n\t\tif ( type === undefined && format === DepthStencilFormat ) type = UnsignedInt248Type;\n\n\t\tsuper( null, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy );\n\n\t\tthis.isDepthTexture = true;\n\n\t\tthis.image = { width: width, height: height };\n\n\t\tthis.magFilter = magFilter !== undefined ? magFilter : NearestFilter;\n\t\tthis.minFilter = minFilter !== undefined ? minFilter : NearestFilter;\n\n\t\tthis.flipY = false;\n\t\tthis.generateMipmaps = false;\n\n\t}\n\n\n}\n\nclass WebXRManager extends EventDispatcher {\n\n\tconstructor( renderer, gl ) {\n\n\t\tsuper();\n\n\t\tconst scope = this;\n\n\t\tlet session = null;\n\t\tlet framebufferScaleFactor = 1.0;\n\n\t\tlet referenceSpace = null;\n\t\tlet referenceSpaceType = 'local-floor';\n\t\tlet customReferenceSpace = null;\n\n\t\tlet pose = null;\n\t\tlet glBinding = null;\n\t\tlet glProjLayer = null;\n\t\tlet glBaseLayer = null;\n\t\tlet xrFrame = null;\n\t\tconst attributes = gl.getContextAttributes();\n\t\tlet initialRenderTarget = null;\n\t\tlet newRenderTarget = null;\n\n\t\tconst controllers = [];\n\t\tconst controllerInputSources = [];\n\n\t\tconst planes = new Set();\n\t\tconst planesLastChangedTimes = new Map();\n\n\t\t//\n\n\t\tconst cameraL = new PerspectiveCamera();\n\t\tcameraL.layers.enable( 1 );\n\t\tcameraL.viewport = new Vector4();\n\n\t\tconst cameraR = new PerspectiveCamera();\n\t\tcameraR.layers.enable( 2 );\n\t\tcameraR.viewport = new Vector4();\n\n\t\tconst cameras = [ cameraL, cameraR ];\n\n\t\tconst cameraVR = new ArrayCamera();\n\t\tcameraVR.layers.enable( 1 );\n\t\tcameraVR.layers.enable( 2 );\n\n\t\tlet _currentDepthNear = null;\n\t\tlet _currentDepthFar = null;\n\n\t\t//\n\n\t\tthis.cameraAutoUpdate = true;\n\t\tthis.enabled = false;\n\n\t\tthis.isPresenting = false;\n\n\t\tthis.getController = function ( index ) {\n\n\t\t\tlet controller = controllers[ index ];\n\n\t\t\tif ( controller === undefined ) {\n\n\t\t\t\tcontroller = new WebXRController();\n\t\t\t\tcontrollers[ index ] = controller;\n\n\t\t\t}\n\n\t\t\treturn controller.getTargetRaySpace();\n\n\t\t};\n\n\t\tthis.getControllerGrip = function ( index ) {\n\n\t\t\tlet controller = controllers[ index ];\n\n\t\t\tif ( controller === undefined ) {\n\n\t\t\t\tcontroller = new WebXRController();\n\t\t\t\tcontrollers[ index ] = controller;\n\n\t\t\t}\n\n\t\t\treturn controller.getGripSpace();\n\n\t\t};\n\n\t\tthis.getHand = function ( index ) {\n\n\t\t\tlet controller = controllers[ index ];\n\n\t\t\tif ( controller === undefined ) {\n\n\t\t\t\tcontroller = new WebXRController();\n\t\t\t\tcontrollers[ index ] = controller;\n\n\t\t\t}\n\n\t\t\treturn controller.getHandSpace();\n\n\t\t};\n\n\t\t//\n\n\t\tfunction onSessionEvent( event ) {\n\n\t\t\tconst controllerIndex = controllerInputSources.indexOf( event.inputSource );\n\n\t\t\tif ( controllerIndex === - 1 ) {\n\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tconst controller = controllers[ controllerIndex ];\n\n\t\t\tif ( controller !== undefined ) {\n\n\t\t\t\tcontroller.dispatchEvent( { type: event.type, data: event.inputSource } );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onSessionEnd() {\n\n\t\t\tsession.removeEventListener( 'select', onSessionEvent );\n\t\t\tsession.removeEventListener( 'selectstart', onSessionEvent );\n\t\t\tsession.removeEventListener( 'selectend', onSessionEvent );\n\t\t\tsession.removeEventListener( 'squeeze', onSessionEvent );\n\t\t\tsession.removeEventListener( 'squeezestart', onSessionEvent );\n\t\t\tsession.removeEventListener( 'squeezeend', onSessionEvent );\n\t\t\tsession.removeEventListener( 'end', onSessionEnd );\n\t\t\tsession.removeEventListener( 'inputsourceschange', onInputSourcesChange );\n\n\t\t\tfor ( let i = 0; i < controllers.length; i ++ ) {\n\n\t\t\t\tconst inputSource = controllerInputSources[ i ];\n\n\t\t\t\tif ( inputSource === null ) continue;\n\n\t\t\t\tcontrollerInputSources[ i ] = null;\n\n\t\t\t\tcontrollers[ i ].disconnect( inputSource );\n\n\t\t\t}\n\n\t\t\t_currentDepthNear = null;\n\t\t\t_currentDepthFar = null;\n\n\t\t\t// restore framebuffer/rendering state\n\n\t\t\trenderer.setRenderTarget( initialRenderTarget );\n\n\t\t\tglBaseLayer = null;\n\t\t\tglProjLayer = null;\n\t\t\tglBinding = null;\n\t\t\tsession = null;\n\t\t\tnewRenderTarget = null;\n\n\t\t\t//\n\n\t\t\tanimation.stop();\n\n\t\t\tscope.isPresenting = false;\n\n\t\t\tscope.dispatchEvent( { type: 'sessionend' } );\n\n\t\t}\n\n\t\tthis.setFramebufferScaleFactor = function ( value ) {\n\n\t\t\tframebufferScaleFactor = value;\n\n\t\t\tif ( scope.isPresenting === true ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebXRManager: Cannot change framebuffer scale while presenting.' );\n\n\t\t\t}\n\n\t\t};\n\n\t\tthis.setReferenceSpaceType = function ( value ) {\n\n\t\t\treferenceSpaceType = value;\n\n\t\t\tif ( scope.isPresenting === true ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebXRManager: Cannot change reference space type while presenting.' );\n\n\t\t\t}\n\n\t\t};\n\n\t\tthis.getReferenceSpace = function () {\n\n\t\t\treturn customReferenceSpace || referenceSpace;\n\n\t\t};\n\n\t\tthis.setReferenceSpace = function ( space ) {\n\n\t\t\tcustomReferenceSpace = space;\n\n\t\t};\n\n\t\tthis.getBaseLayer = function () {\n\n\t\t\treturn glProjLayer !== null ? glProjLayer : glBaseLayer;\n\n\t\t};\n\n\t\tthis.getBinding = function () {\n\n\t\t\treturn glBinding;\n\n\t\t};\n\n\t\tthis.getFrame = function () {\n\n\t\t\treturn xrFrame;\n\n\t\t};\n\n\t\tthis.getSession = function () {\n\n\t\t\treturn session;\n\n\t\t};\n\n\t\tthis.setSession = async function ( value ) {\n\n\t\t\tsession = value;\n\n\t\t\tif ( session !== null ) {\n\n\t\t\t\tinitialRenderTarget = renderer.getRenderTarget();\n\n\t\t\t\tsession.addEventListener( 'select', onSessionEvent );\n\t\t\t\tsession.addEventListener( 'selectstart', onSessionEvent );\n\t\t\t\tsession.addEventListener( 'selectend', onSessionEvent );\n\t\t\t\tsession.addEventListener( 'squeeze', onSessionEvent );\n\t\t\t\tsession.addEventListener( 'squeezestart', onSessionEvent );\n\t\t\t\tsession.addEventListener( 'squeezeend', onSessionEvent );\n\t\t\t\tsession.addEventListener( 'end', onSessionEnd );\n\t\t\t\tsession.addEventListener( 'inputsourceschange', onInputSourcesChange );\n\n\t\t\t\tif ( attributes.xrCompatible !== true ) {\n\n\t\t\t\t\tawait gl.makeXRCompatible();\n\n\t\t\t\t}\n\n\t\t\t\tif ( ( session.renderState.layers === undefined ) || ( renderer.capabilities.isWebGL2 === false ) ) {\n\n\t\t\t\t\tconst layerInit = {\n\t\t\t\t\t\tantialias: ( session.renderState.layers === undefined ) ? attributes.antialias : true,\n\t\t\t\t\t\talpha: attributes.alpha,\n\t\t\t\t\t\tdepth: attributes.depth,\n\t\t\t\t\t\tstencil: attributes.stencil,\n\t\t\t\t\t\tframebufferScaleFactor: framebufferScaleFactor\n\t\t\t\t\t};\n\n\t\t\t\t\tglBaseLayer = new XRWebGLLayer( session, gl, layerInit );\n\n\t\t\t\t\tsession.updateRenderState( { baseLayer: glBaseLayer } );\n\n\t\t\t\t\tnewRenderTarget = new WebGLRenderTarget(\n\t\t\t\t\t\tglBaseLayer.framebufferWidth,\n\t\t\t\t\t\tglBaseLayer.framebufferHeight,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tformat: RGBAFormat,\n\t\t\t\t\t\t\ttype: UnsignedByteType,\n\t\t\t\t\t\t\tencoding: renderer.outputEncoding,\n\t\t\t\t\t\t\tstencilBuffer: attributes.stencil\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t} else {\n\n\t\t\t\t\tlet depthFormat = null;\n\t\t\t\t\tlet depthType = null;\n\t\t\t\t\tlet glDepthFormat = null;\n\n\t\t\t\t\tif ( attributes.depth ) {\n\n\t\t\t\t\t\tglDepthFormat = attributes.stencil ? 35056 : 33190;\n\t\t\t\t\t\tdepthFormat = attributes.stencil ? DepthStencilFormat : DepthFormat;\n\t\t\t\t\t\tdepthType = attributes.stencil ? UnsignedInt248Type : UnsignedIntType;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tconst projectionlayerInit = {\n\t\t\t\t\t\tcolorFormat: 32856,\n\t\t\t\t\t\tdepthFormat: glDepthFormat,\n\t\t\t\t\t\tscaleFactor: framebufferScaleFactor\n\t\t\t\t\t};\n\n\t\t\t\t\tglBinding = new XRWebGLBinding( session, gl );\n\n\t\t\t\t\tglProjLayer = glBinding.createProjectionLayer( projectionlayerInit );\n\n\t\t\t\t\tsession.updateRenderState( { layers: [ glProjLayer ] } );\n\n\t\t\t\t\tnewRenderTarget = new WebGLRenderTarget(\n\t\t\t\t\t\tglProjLayer.textureWidth,\n\t\t\t\t\t\tglProjLayer.textureHeight,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tformat: RGBAFormat,\n\t\t\t\t\t\t\ttype: UnsignedByteType,\n\t\t\t\t\t\t\tdepthTexture: new DepthTexture( glProjLayer.textureWidth, glProjLayer.textureHeight, depthType, undefined, undefined, undefined, undefined, undefined, undefined, depthFormat ),\n\t\t\t\t\t\t\tstencilBuffer: attributes.stencil,\n\t\t\t\t\t\t\tencoding: renderer.outputEncoding,\n\t\t\t\t\t\t\tsamples: attributes.antialias ? 4 : 0\n\t\t\t\t\t\t} );\n\n\t\t\t\t\tconst renderTargetProperties = renderer.properties.get( newRenderTarget );\n\t\t\t\t\trenderTargetProperties.__ignoreDepthValues = glProjLayer.ignoreDepthValues;\n\n\t\t\t\t}\n\n\t\t\t\tnewRenderTarget.isXRRenderTarget = true; // TODO Remove this when possible, see #23278\n\n\t\t\t\t// Set foveation to maximum.\n\t\t\t\tthis.setFoveation( 1.0 );\n\n\t\t\t\tcustomReferenceSpace = null;\n\t\t\t\treferenceSpace = await session.requestReferenceSpace( referenceSpaceType );\n\n\t\t\t\tanimation.setContext( session );\n\t\t\t\tanimation.start();\n\n\t\t\t\tscope.isPresenting = true;\n\n\t\t\t\tscope.dispatchEvent( { type: 'sessionstart' } );\n\n\t\t\t}\n\n\t\t};\n\n\t\tfunction onInputSourcesChange( event ) {\n\n\t\t\t// Notify disconnected\n\n\t\t\tfor ( let i = 0; i < event.removed.length; i ++ ) {\n\n\t\t\t\tconst inputSource = event.removed[ i ];\n\t\t\t\tconst index = controllerInputSources.indexOf( inputSource );\n\n\t\t\t\tif ( index >= 0 ) {\n\n\t\t\t\t\tcontrollerInputSources[ index ] = null;\n\t\t\t\t\tcontrollers[ index ].disconnect( inputSource );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// Notify connected\n\n\t\t\tfor ( let i = 0; i < event.added.length; i ++ ) {\n\n\t\t\t\tconst inputSource = event.added[ i ];\n\n\t\t\t\tlet controllerIndex = controllerInputSources.indexOf( inputSource );\n\n\t\t\t\tif ( controllerIndex === - 1 ) {\n\n\t\t\t\t\t// Assign input source a controller that currently has no input source\n\n\t\t\t\t\tfor ( let i = 0; i < controllers.length; i ++ ) {\n\n\t\t\t\t\t\tif ( i >= controllerInputSources.length ) {\n\n\t\t\t\t\t\t\tcontrollerInputSources.push( inputSource );\n\t\t\t\t\t\t\tcontrollerIndex = i;\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t} else if ( controllerInputSources[ i ] === null ) {\n\n\t\t\t\t\t\t\tcontrollerInputSources[ i ] = inputSource;\n\t\t\t\t\t\t\tcontrollerIndex = i;\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// If all controllers do currently receive input we ignore new ones\n\n\t\t\t\t\tif ( controllerIndex === - 1 ) break;\n\n\t\t\t\t}\n\n\t\t\t\tconst controller = controllers[ controllerIndex ];\n\n\t\t\t\tif ( controller ) {\n\n\t\t\t\t\tcontroller.connect( inputSource );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tconst cameraLPos = new Vector3();\n\t\tconst cameraRPos = new Vector3();\n\n\t\t/**\n\t\t * Assumes 2 cameras that are parallel and share an X-axis, and that\n\t\t * the cameras' projection and world matrices have already been set.\n\t\t * And that near and far planes are identical for both cameras.\n\t\t * Visualization of this technique: https://computergraphics.stackexchange.com/a/4765\n\t\t */\n\t\tfunction setProjectionFromUnion( camera, cameraL, cameraR ) {\n\n\t\t\tcameraLPos.setFromMatrixPosition( cameraL.matrixWorld );\n\t\t\tcameraRPos.setFromMatrixPosition( cameraR.matrixWorld );\n\n\t\t\tconst ipd = cameraLPos.distanceTo( cameraRPos );\n\n\t\t\tconst projL = cameraL.projectionMatrix.elements;\n\t\t\tconst projR = cameraR.projectionMatrix.elements;\n\n\t\t\t// VR systems will have identical far and near planes, and\n\t\t\t// most likely identical top and bottom frustum extents.\n\t\t\t// Use the left camera for these values.\n\t\t\tconst near = projL[ 14 ] / ( projL[ 10 ] - 1 );\n\t\t\tconst far = projL[ 14 ] / ( projL[ 10 ] + 1 );\n\t\t\tconst topFov = ( projL[ 9 ] + 1 ) / projL[ 5 ];\n\t\t\tconst bottomFov = ( projL[ 9 ] - 1 ) / projL[ 5 ];\n\n\t\t\tconst leftFov = ( projL[ 8 ] - 1 ) / projL[ 0 ];\n\t\t\tconst rightFov = ( projR[ 8 ] + 1 ) / projR[ 0 ];\n\t\t\tconst left = near * leftFov;\n\t\t\tconst right = near * rightFov;\n\n\t\t\t// Calculate the new camera's position offset from the\n\t\t\t// left camera. xOffset should be roughly half `ipd`.\n\t\t\tconst zOffset = ipd / ( - leftFov + rightFov );\n\t\t\tconst xOffset = zOffset * - leftFov;\n\n\t\t\t// TODO: Better way to apply this offset?\n\t\t\tcameraL.matrixWorld.decompose( camera.position, camera.quaternion, camera.scale );\n\t\t\tcamera.translateX( xOffset );\n\t\t\tcamera.translateZ( zOffset );\n\t\t\tcamera.matrixWorld.compose( camera.position, camera.quaternion, camera.scale );\n\t\t\tcamera.matrixWorldInverse.copy( camera.matrixWorld ).invert();\n\n\t\t\t// Find the union of the frustum values of the cameras and scale\n\t\t\t// the values so that the near plane's position does not change in world space,\n\t\t\t// although must now be relative to the new union camera.\n\t\t\tconst near2 = near + zOffset;\n\t\t\tconst far2 = far + zOffset;\n\t\t\tconst left2 = left - xOffset;\n\t\t\tconst right2 = right + ( ipd - xOffset );\n\t\t\tconst top2 = topFov * far / far2 * near2;\n\t\t\tconst bottom2 = bottomFov * far / far2 * near2;\n\n\t\t\tcamera.projectionMatrix.makePerspective( left2, right2, top2, bottom2, near2, far2 );\n\n\t\t}\n\n\t\tfunction updateCamera( camera, parent ) {\n\n\t\t\tif ( parent === null ) {\n\n\t\t\t\tcamera.matrixWorld.copy( camera.matrix );\n\n\t\t\t} else {\n\n\t\t\t\tcamera.matrixWorld.multiplyMatrices( parent.matrixWorld, camera.matrix );\n\n\t\t\t}\n\n\t\t\tcamera.matrixWorldInverse.copy( camera.matrixWorld ).invert();\n\n\t\t}\n\n\t\tthis.updateCamera = function ( camera ) {\n\n\t\t\tif ( session === null ) return;\n\n\t\t\tcameraVR.near = cameraR.near = cameraL.near = camera.near;\n\t\t\tcameraVR.far = cameraR.far = cameraL.far = camera.far;\n\n\t\t\tif ( _currentDepthNear !== cameraVR.near || _currentDepthFar !== cameraVR.far ) {\n\n\t\t\t\t// Note that the new renderState won't apply until the next frame. See #18320\n\n\t\t\t\tsession.updateRenderState( {\n\t\t\t\t\tdepthNear: cameraVR.near,\n\t\t\t\t\tdepthFar: cameraVR.far\n\t\t\t\t} );\n\n\t\t\t\t_currentDepthNear = cameraVR.near;\n\t\t\t\t_currentDepthFar = cameraVR.far;\n\n\t\t\t}\n\n\t\t\tconst parent = camera.parent;\n\t\t\tconst cameras = cameraVR.cameras;\n\n\t\t\tupdateCamera( cameraVR, parent );\n\n\t\t\tfor ( let i = 0; i < cameras.length; i ++ ) {\n\n\t\t\t\tupdateCamera( cameras[ i ], parent );\n\n\t\t\t}\n\n\t\t\tcameraVR.matrixWorld.decompose( cameraVR.position, cameraVR.quaternion, cameraVR.scale );\n\n\t\t\t// update user camera and its children\n\n\t\t\tcamera.matrix.copy( cameraVR.matrix );\n\t\t\tcamera.matrix.decompose( camera.position, camera.quaternion, camera.scale );\n\n\t\t\tconst children = camera.children;\n\n\t\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\t\tchildren[ i ].updateMatrixWorld( true );\n\n\t\t\t}\n\n\t\t\t// update projection matrix for proper view frustum culling\n\n\t\t\tif ( cameras.length === 2 ) {\n\n\t\t\t\tsetProjectionFromUnion( cameraVR, cameraL, cameraR );\n\n\t\t\t} else {\n\n\t\t\t\t// assume single camera setup (AR)\n\n\t\t\t\tcameraVR.projectionMatrix.copy( cameraL.projectionMatrix );\n\n\t\t\t}\n\n\t\t};\n\n\t\tthis.getCamera = function () {\n\n\t\t\treturn cameraVR;\n\n\t\t};\n\n\t\tthis.getFoveation = function () {\n\n\t\t\tif ( glProjLayer !== null ) {\n\n\t\t\t\treturn glProjLayer.fixedFoveation;\n\n\t\t\t}\n\n\t\t\tif ( glBaseLayer !== null ) {\n\n\t\t\t\treturn glBaseLayer.fixedFoveation;\n\n\t\t\t}\n\n\t\t\treturn undefined;\n\n\t\t};\n\n\t\tthis.setFoveation = function ( foveation ) {\n\n\t\t\t// 0 = no foveation = full resolution\n\t\t\t// 1 = maximum foveation = the edges render at lower resolution\n\n\t\t\tif ( glProjLayer !== null ) {\n\n\t\t\t\tglProjLayer.fixedFoveation = foveation;\n\n\t\t\t}\n\n\t\t\tif ( glBaseLayer !== null && glBaseLayer.fixedFoveation !== undefined ) {\n\n\t\t\t\tglBaseLayer.fixedFoveation = foveation;\n\n\t\t\t}\n\n\t\t};\n\n\t\tthis.getPlanes = function () {\n\n\t\t\treturn planes;\n\n\t\t};\n\n\t\t// Animation Loop\n\n\t\tlet onAnimationFrameCallback = null;\n\n\t\tfunction onAnimationFrame( time, frame ) {\n\n\t\t\tpose = frame.getViewerPose( customReferenceSpace || referenceSpace );\n\t\t\txrFrame = frame;\n\n\t\t\tif ( pose !== null ) {\n\n\t\t\t\tconst views = pose.views;\n\n\t\t\t\tif ( glBaseLayer !== null ) {\n\n\t\t\t\t\trenderer.setRenderTargetFramebuffer( newRenderTarget, glBaseLayer.framebuffer );\n\t\t\t\t\trenderer.setRenderTarget( newRenderTarget );\n\n\t\t\t\t}\n\n\t\t\t\tlet cameraVRNeedsUpdate = false;\n\n\t\t\t\t// check if it's necessary to rebuild cameraVR's camera list\n\n\t\t\t\tif ( views.length !== cameraVR.cameras.length ) {\n\n\t\t\t\t\tcameraVR.cameras.length = 0;\n\t\t\t\t\tcameraVRNeedsUpdate = true;\n\n\t\t\t\t}\n\n\t\t\t\tfor ( let i = 0; i < views.length; i ++ ) {\n\n\t\t\t\t\tconst view = views[ i ];\n\n\t\t\t\t\tlet viewport = null;\n\n\t\t\t\t\tif ( glBaseLayer !== null ) {\n\n\t\t\t\t\t\tviewport = glBaseLayer.getViewport( view );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tconst glSubImage = glBinding.getViewSubImage( glProjLayer, view );\n\t\t\t\t\t\tviewport = glSubImage.viewport;\n\n\t\t\t\t\t\t// For side-by-side projection, we only produce a single texture for both eyes.\n\t\t\t\t\t\tif ( i === 0 ) {\n\n\t\t\t\t\t\t\trenderer.setRenderTargetTextures(\n\t\t\t\t\t\t\t\tnewRenderTarget,\n\t\t\t\t\t\t\t\tglSubImage.colorTexture,\n\t\t\t\t\t\t\t\tglProjLayer.ignoreDepthValues ? undefined : glSubImage.depthStencilTexture );\n\n\t\t\t\t\t\t\trenderer.setRenderTarget( newRenderTarget );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tlet camera = cameras[ i ];\n\n\t\t\t\t\tif ( camera === undefined ) {\n\n\t\t\t\t\t\tcamera = new PerspectiveCamera();\n\t\t\t\t\t\tcamera.layers.enable( i );\n\t\t\t\t\t\tcamera.viewport = new Vector4();\n\t\t\t\t\t\tcameras[ i ] = camera;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tcamera.matrix.fromArray( view.transform.matrix );\n\t\t\t\t\tcamera.projectionMatrix.fromArray( view.projectionMatrix );\n\t\t\t\t\tcamera.viewport.set( viewport.x, viewport.y, viewport.width, viewport.height );\n\n\t\t\t\t\tif ( i === 0 ) {\n\n\t\t\t\t\t\tcameraVR.matrix.copy( camera.matrix );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( cameraVRNeedsUpdate === true ) {\n\n\t\t\t\t\t\tcameraVR.cameras.push( camera );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t//\n\n\t\t\tfor ( let i = 0; i < controllers.length; i ++ ) {\n\n\t\t\t\tconst inputSource = controllerInputSources[ i ];\n\t\t\t\tconst controller = controllers[ i ];\n\n\t\t\t\tif ( inputSource !== null && controller !== undefined ) {\n\n\t\t\t\t\tcontroller.update( inputSource, frame, customReferenceSpace || referenceSpace );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( onAnimationFrameCallback ) onAnimationFrameCallback( time, frame );\n\n\t\t\tif ( frame.detectedPlanes ) {\n\n\t\t\t\tscope.dispatchEvent( { type: 'planesdetected', data: frame.detectedPlanes } );\n\n\t\t\t\tlet planesToRemove = null;\n\n\t\t\t\tfor ( const plane of planes ) {\n\n\t\t\t\t\tif ( ! frame.detectedPlanes.has( plane ) ) {\n\n\t\t\t\t\t\tif ( planesToRemove === null ) {\n\n\t\t\t\t\t\t\tplanesToRemove = [];\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tplanesToRemove.push( plane );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( planesToRemove !== null ) {\n\n\t\t\t\t\tfor ( const plane of planesToRemove ) {\n\n\t\t\t\t\t\tplanes.delete( plane );\n\t\t\t\t\t\tplanesLastChangedTimes.delete( plane );\n\t\t\t\t\t\tscope.dispatchEvent( { type: 'planeremoved', data: plane } );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tfor ( const plane of frame.detectedPlanes ) {\n\n\t\t\t\t\tif ( ! planes.has( plane ) ) {\n\n\t\t\t\t\t\tplanes.add( plane );\n\t\t\t\t\t\tplanesLastChangedTimes.set( plane, frame.lastChangedTime );\n\t\t\t\t\t\tscope.dispatchEvent( { type: 'planeadded', data: plane } );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tconst lastKnownTime = planesLastChangedTimes.get( plane );\n\n\t\t\t\t\t\tif ( plane.lastChangedTime > lastKnownTime ) {\n\n\t\t\t\t\t\t\tplanesLastChangedTimes.set( plane, plane.lastChangedTime );\n\t\t\t\t\t\t\tscope.dispatchEvent( { type: 'planechanged', data: plane } );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\txrFrame = null;\n\n\t\t}\n\n\t\tconst animation = new WebGLAnimation();\n\n\t\tanimation.setAnimationLoop( onAnimationFrame );\n\n\t\tthis.setAnimationLoop = function ( callback ) {\n\n\t\t\tonAnimationFrameCallback = callback;\n\n\t\t};\n\n\t\tthis.dispose = function () {};\n\n\t}\n\n}\n\nfunction WebGLMaterials( renderer, properties ) {\n\n\tfunction refreshFogUniforms( uniforms, fog ) {\n\n\t\tfog.color.getRGB( uniforms.fogColor.value, getUnlitUniformColorSpace( renderer ) );\n\n\t\tif ( fog.isFog ) {\n\n\t\t\tuniforms.fogNear.value = fog.near;\n\t\t\tuniforms.fogFar.value = fog.far;\n\n\t\t} else if ( fog.isFogExp2 ) {\n\n\t\t\tuniforms.fogDensity.value = fog.density;\n\n\t\t}\n\n\t}\n\n\tfunction refreshMaterialUniforms( uniforms, material, pixelRatio, height, transmissionRenderTarget ) {\n\n\t\tif ( material.isMeshBasicMaterial ) {\n\n\t\t\trefreshUniformsCommon( uniforms, material );\n\n\t\t} else if ( material.isMeshLambertMaterial ) {\n\n\t\t\trefreshUniformsCommon( uniforms, material );\n\n\t\t} else if ( material.isMeshToonMaterial ) {\n\n\t\t\trefreshUniformsCommon( uniforms, material );\n\t\t\trefreshUniformsToon( uniforms, material );\n\n\t\t} else if ( material.isMeshPhongMaterial ) {\n\n\t\t\trefreshUniformsCommon( uniforms, material );\n\t\t\trefreshUniformsPhong( uniforms, material );\n\n\t\t} else if ( material.isMeshStandardMaterial ) {\n\n\t\t\trefreshUniformsCommon( uniforms, material );\n\t\t\trefreshUniformsStandard( uniforms, material );\n\n\t\t\tif ( material.isMeshPhysicalMaterial ) {\n\n\t\t\t\trefreshUniformsPhysical( uniforms, material, transmissionRenderTarget );\n\n\t\t\t}\n\n\t\t} else if ( material.isMeshMatcapMaterial ) {\n\n\t\t\trefreshUniformsCommon( uniforms, material );\n\t\t\trefreshUniformsMatcap( uniforms, material );\n\n\t\t} else if ( material.isMeshDepthMaterial ) {\n\n\t\t\trefreshUniformsCommon( uniforms, material );\n\n\t\t} else if ( material.isMeshDistanceMaterial ) {\n\n\t\t\trefreshUniformsCommon( uniforms, material );\n\t\t\trefreshUniformsDistance( uniforms, material );\n\n\t\t} else if ( material.isMeshNormalMaterial ) {\n\n\t\t\trefreshUniformsCommon( uniforms, material );\n\n\t\t} else if ( material.isLineBasicMaterial ) {\n\n\t\t\trefreshUniformsLine( uniforms, material );\n\n\t\t\tif ( material.isLineDashedMaterial ) {\n\n\t\t\t\trefreshUniformsDash( uniforms, material );\n\n\t\t\t}\n\n\t\t} else if ( material.isPointsMaterial ) {\n\n\t\t\trefreshUniformsPoints( uniforms, material, pixelRatio, height );\n\n\t\t} else if ( material.isSpriteMaterial ) {\n\n\t\t\trefreshUniformsSprites( uniforms, material );\n\n\t\t} else if ( material.isShadowMaterial ) {\n\n\t\t\tuniforms.color.value.copy( material.color );\n\t\t\tuniforms.opacity.value = material.opacity;\n\n\t\t} else if ( material.isShaderMaterial ) {\n\n\t\t\tmaterial.uniformsNeedUpdate = false; // #15581\n\n\t\t}\n\n\t}\n\n\tfunction refreshUniformsCommon( uniforms, material ) {\n\n\t\tuniforms.opacity.value = material.opacity;\n\n\t\tif ( material.color ) {\n\n\t\t\tuniforms.diffuse.value.copy( material.color );\n\n\t\t}\n\n\t\tif ( material.emissive ) {\n\n\t\t\tuniforms.emissive.value.copy( material.emissive ).multiplyScalar( material.emissiveIntensity );\n\n\t\t}\n\n\t\tif ( material.map ) {\n\n\t\t\tuniforms.map.value = material.map;\n\n\t\t}\n\n\t\tif ( material.alphaMap ) {\n\n\t\t\tuniforms.alphaMap.value = material.alphaMap;\n\n\t\t}\n\n\t\tif ( material.bumpMap ) {\n\n\t\t\tuniforms.bumpMap.value = material.bumpMap;\n\t\t\tuniforms.bumpScale.value = material.bumpScale;\n\t\t\tif ( material.side === BackSide ) uniforms.bumpScale.value *= - 1;\n\n\t\t}\n\n\t\tif ( material.displacementMap ) {\n\n\t\t\tuniforms.displacementMap.value = material.displacementMap;\n\t\t\tuniforms.displacementScale.value = material.displacementScale;\n\t\t\tuniforms.displacementBias.value = material.displacementBias;\n\n\t\t}\n\n\t\tif ( material.emissiveMap ) {\n\n\t\t\tuniforms.emissiveMap.value = material.emissiveMap;\n\n\t\t}\n\n\t\tif ( material.normalMap ) {\n\n\t\t\tuniforms.normalMap.value = material.normalMap;\n\t\t\tuniforms.normalScale.value.copy( material.normalScale );\n\t\t\tif ( material.side === BackSide ) uniforms.normalScale.value.negate();\n\n\t\t}\n\n\t\tif ( material.specularMap ) {\n\n\t\t\tuniforms.specularMap.value = material.specularMap;\n\n\t\t}\n\n\t\tif ( material.alphaTest > 0 ) {\n\n\t\t\tuniforms.alphaTest.value = material.alphaTest;\n\n\t\t}\n\n\t\tconst envMap = properties.get( material ).envMap;\n\n\t\tif ( envMap ) {\n\n\t\t\tuniforms.envMap.value = envMap;\n\n\t\t\tuniforms.flipEnvMap.value = ( envMap.isCubeTexture && envMap.isRenderTargetTexture === false ) ? - 1 : 1;\n\n\t\t\tuniforms.reflectivity.value = material.reflectivity;\n\t\t\tuniforms.ior.value = material.ior;\n\t\t\tuniforms.refractionRatio.value = material.refractionRatio;\n\n\t\t}\n\n\t\tif ( material.lightMap ) {\n\n\t\t\tuniforms.lightMap.value = material.lightMap;\n\n\t\t\t// artist-friendly light intensity scaling factor\n\t\t\tconst scaleFactor = ( renderer.physicallyCorrectLights !== true ) ? Math.PI : 1;\n\n\t\t\tuniforms.lightMapIntensity.value = material.lightMapIntensity * scaleFactor;\n\n\t\t}\n\n\t\tif ( material.aoMap ) {\n\n\t\t\tuniforms.aoMap.value = material.aoMap;\n\t\t\tuniforms.aoMapIntensity.value = material.aoMapIntensity;\n\n\t\t}\n\n\t\t// uv repeat and offset setting priorities\n\t\t// 1. color map\n\t\t// 2. specular map\n\t\t// 3. displacementMap map\n\t\t// 4. normal map\n\t\t// 5. bump map\n\t\t// 6. roughnessMap map\n\t\t// 7. metalnessMap map\n\t\t// 8. alphaMap map\n\t\t// 9. emissiveMap map\n\t\t// 10. clearcoat map\n\t\t// 11. clearcoat normal map\n\t\t// 12. clearcoat roughnessMap map\n\t\t// 13. iridescence map\n\t\t// 14. iridescence thickness map\n\t\t// 15. specular intensity map\n\t\t// 16. specular tint map\n\t\t// 17. transmission map\n\t\t// 18. thickness map\n\n\t\tlet uvScaleMap;\n\n\t\tif ( material.map ) {\n\n\t\t\tuvScaleMap = material.map;\n\n\t\t} else if ( material.specularMap ) {\n\n\t\t\tuvScaleMap = material.specularMap;\n\n\t\t} else if ( material.displacementMap ) {\n\n\t\t\tuvScaleMap = material.displacementMap;\n\n\t\t} else if ( material.normalMap ) {\n\n\t\t\tuvScaleMap = material.normalMap;\n\n\t\t} else if ( material.bumpMap ) {\n\n\t\t\tuvScaleMap = material.bumpMap;\n\n\t\t} else if ( material.roughnessMap ) {\n\n\t\t\tuvScaleMap = material.roughnessMap;\n\n\t\t} else if ( material.metalnessMap ) {\n\n\t\t\tuvScaleMap = material.metalnessMap;\n\n\t\t} else if ( material.alphaMap ) {\n\n\t\t\tuvScaleMap = material.alphaMap;\n\n\t\t} else if ( material.emissiveMap ) {\n\n\t\t\tuvScaleMap = material.emissiveMap;\n\n\t\t} else if ( material.clearcoatMap ) {\n\n\t\t\tuvScaleMap = material.clearcoatMap;\n\n\t\t} else if ( material.clearcoatNormalMap ) {\n\n\t\t\tuvScaleMap = material.clearcoatNormalMap;\n\n\t\t} else if ( material.clearcoatRoughnessMap ) {\n\n\t\t\tuvScaleMap = material.clearcoatRoughnessMap;\n\n\t\t} else if ( material.iridescenceMap ) {\n\n\t\t\tuvScaleMap = material.iridescenceMap;\n\n\t\t} else if ( material.iridescenceThicknessMap ) {\n\n\t\t\tuvScaleMap = material.iridescenceThicknessMap;\n\n\t\t} else if ( material.specularIntensityMap ) {\n\n\t\t\tuvScaleMap = material.specularIntensityMap;\n\n\t\t} else if ( material.specularColorMap ) {\n\n\t\t\tuvScaleMap = material.specularColorMap;\n\n\t\t} else if ( material.transmissionMap ) {\n\n\t\t\tuvScaleMap = material.transmissionMap;\n\n\t\t} else if ( material.thicknessMap ) {\n\n\t\t\tuvScaleMap = material.thicknessMap;\n\n\t\t} else if ( material.sheenColorMap ) {\n\n\t\t\tuvScaleMap = material.sheenColorMap;\n\n\t\t} else if ( material.sheenRoughnessMap ) {\n\n\t\t\tuvScaleMap = material.sheenRoughnessMap;\n\n\t\t}\n\n\t\tif ( uvScaleMap !== undefined ) {\n\n\t\t\t// backwards compatibility\n\t\t\tif ( uvScaleMap.isWebGLRenderTarget ) {\n\n\t\t\t\tuvScaleMap = uvScaleMap.texture;\n\n\t\t\t}\n\n\t\t\tif ( uvScaleMap.matrixAutoUpdate === true ) {\n\n\t\t\t\tuvScaleMap.updateMatrix();\n\n\t\t\t}\n\n\t\t\tuniforms.uvTransform.value.copy( uvScaleMap.matrix );\n\n\t\t}\n\n\t\t// uv repeat and offset setting priorities for uv2\n\t\t// 1. ao map\n\t\t// 2. light map\n\n\t\tlet uv2ScaleMap;\n\n\t\tif ( material.aoMap ) {\n\n\t\t\tuv2ScaleMap = material.aoMap;\n\n\t\t} else if ( material.lightMap ) {\n\n\t\t\tuv2ScaleMap = material.lightMap;\n\n\t\t}\n\n\t\tif ( uv2ScaleMap !== undefined ) {\n\n\t\t\t// backwards compatibility\n\t\t\tif ( uv2ScaleMap.isWebGLRenderTarget ) {\n\n\t\t\t\tuv2ScaleMap = uv2ScaleMap.texture;\n\n\t\t\t}\n\n\t\t\tif ( uv2ScaleMap.matrixAutoUpdate === true ) {\n\n\t\t\t\tuv2ScaleMap.updateMatrix();\n\n\t\t\t}\n\n\t\t\tuniforms.uv2Transform.value.copy( uv2ScaleMap.matrix );\n\n\t\t}\n\n\t}\n\n\tfunction refreshUniformsLine( uniforms, material ) {\n\n\t\tuniforms.diffuse.value.copy( material.color );\n\t\tuniforms.opacity.value = material.opacity;\n\n\t}\n\n\tfunction refreshUniformsDash( uniforms, material ) {\n\n\t\tuniforms.dashSize.value = material.dashSize;\n\t\tuniforms.totalSize.value = material.dashSize + material.gapSize;\n\t\tuniforms.scale.value = material.scale;\n\n\t}\n\n\tfunction refreshUniformsPoints( uniforms, material, pixelRatio, height ) {\n\n\t\tuniforms.diffuse.value.copy( material.color );\n\t\tuniforms.opacity.value = material.opacity;\n\t\tuniforms.size.value = material.size * pixelRatio;\n\t\tuniforms.scale.value = height * 0.5;\n\n\t\tif ( material.map ) {\n\n\t\t\tuniforms.map.value = material.map;\n\n\t\t}\n\n\t\tif ( material.alphaMap ) {\n\n\t\t\tuniforms.alphaMap.value = material.alphaMap;\n\n\t\t}\n\n\t\tif ( material.alphaTest > 0 ) {\n\n\t\t\tuniforms.alphaTest.value = material.alphaTest;\n\n\t\t}\n\n\t\t// uv repeat and offset setting priorities\n\t\t// 1. color map\n\t\t// 2. alpha map\n\n\t\tlet uvScaleMap;\n\n\t\tif ( material.map ) {\n\n\t\t\tuvScaleMap = material.map;\n\n\t\t} else if ( material.alphaMap ) {\n\n\t\t\tuvScaleMap = material.alphaMap;\n\n\t\t}\n\n\t\tif ( uvScaleMap !== undefined ) {\n\n\t\t\tif ( uvScaleMap.matrixAutoUpdate === true ) {\n\n\t\t\t\tuvScaleMap.updateMatrix();\n\n\t\t\t}\n\n\t\t\tuniforms.uvTransform.value.copy( uvScaleMap.matrix );\n\n\t\t}\n\n\t}\n\n\tfunction refreshUniformsSprites( uniforms, material ) {\n\n\t\tuniforms.diffuse.value.copy( material.color );\n\t\tuniforms.opacity.value = material.opacity;\n\t\tuniforms.rotation.value = material.rotation;\n\n\t\tif ( material.map ) {\n\n\t\t\tuniforms.map.value = material.map;\n\n\t\t}\n\n\t\tif ( material.alphaMap ) {\n\n\t\t\tuniforms.alphaMap.value = material.alphaMap;\n\n\t\t}\n\n\t\tif ( material.alphaTest > 0 ) {\n\n\t\t\tuniforms.alphaTest.value = material.alphaTest;\n\n\t\t}\n\n\t\t// uv repeat and offset setting priorities\n\t\t// 1. color map\n\t\t// 2. alpha map\n\n\t\tlet uvScaleMap;\n\n\t\tif ( material.map ) {\n\n\t\t\tuvScaleMap = material.map;\n\n\t\t} else if ( material.alphaMap ) {\n\n\t\t\tuvScaleMap = material.alphaMap;\n\n\t\t}\n\n\t\tif ( uvScaleMap !== undefined ) {\n\n\t\t\tif ( uvScaleMap.matrixAutoUpdate === true ) {\n\n\t\t\t\tuvScaleMap.updateMatrix();\n\n\t\t\t}\n\n\t\t\tuniforms.uvTransform.value.copy( uvScaleMap.matrix );\n\n\t\t}\n\n\t}\n\n\tfunction refreshUniformsPhong( uniforms, material ) {\n\n\t\tuniforms.specular.value.copy( material.specular );\n\t\tuniforms.shininess.value = Math.max( material.shininess, 1e-4 ); // to prevent pow( 0.0, 0.0 )\n\n\t}\n\n\tfunction refreshUniformsToon( uniforms, material ) {\n\n\t\tif ( material.gradientMap ) {\n\n\t\t\tuniforms.gradientMap.value = material.gradientMap;\n\n\t\t}\n\n\t}\n\n\tfunction refreshUniformsStandard( uniforms, material ) {\n\n\t\tuniforms.roughness.value = material.roughness;\n\t\tuniforms.metalness.value = material.metalness;\n\n\t\tif ( material.roughnessMap ) {\n\n\t\t\tuniforms.roughnessMap.value = material.roughnessMap;\n\n\t\t}\n\n\t\tif ( material.metalnessMap ) {\n\n\t\t\tuniforms.metalnessMap.value = material.metalnessMap;\n\n\t\t}\n\n\t\tconst envMap = properties.get( material ).envMap;\n\n\t\tif ( envMap ) {\n\n\t\t\t//uniforms.envMap.value = material.envMap; // part of uniforms common\n\t\t\tuniforms.envMapIntensity.value = material.envMapIntensity;\n\n\t\t}\n\n\t}\n\n\tfunction refreshUniformsPhysical( uniforms, material, transmissionRenderTarget ) {\n\n\t\tuniforms.ior.value = material.ior; // also part of uniforms common\n\n\t\tif ( material.sheen > 0 ) {\n\n\t\t\tuniforms.sheenColor.value.copy( material.sheenColor ).multiplyScalar( material.sheen );\n\n\t\t\tuniforms.sheenRoughness.value = material.sheenRoughness;\n\n\t\t\tif ( material.sheenColorMap ) {\n\n\t\t\t\tuniforms.sheenColorMap.value = material.sheenColorMap;\n\n\t\t\t}\n\n\t\t\tif ( material.sheenRoughnessMap ) {\n\n\t\t\t\tuniforms.sheenRoughnessMap.value = material.sheenRoughnessMap;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( material.clearcoat > 0 ) {\n\n\t\t\tuniforms.clearcoat.value = material.clearcoat;\n\t\t\tuniforms.clearcoatRoughness.value = material.clearcoatRoughness;\n\n\t\t\tif ( material.clearcoatMap ) {\n\n\t\t\t\tuniforms.clearcoatMap.value = material.clearcoatMap;\n\n\t\t\t}\n\n\t\t\tif ( material.clearcoatRoughnessMap ) {\n\n\t\t\t\tuniforms.clearcoatRoughnessMap.value = material.clearcoatRoughnessMap;\n\n\t\t\t}\n\n\t\t\tif ( material.clearcoatNormalMap ) {\n\n\t\t\t\tuniforms.clearcoatNormalScale.value.copy( material.clearcoatNormalScale );\n\t\t\t\tuniforms.clearcoatNormalMap.value = material.clearcoatNormalMap;\n\n\t\t\t\tif ( material.side === BackSide ) {\n\n\t\t\t\t\tuniforms.clearcoatNormalScale.value.negate();\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( material.iridescence > 0 ) {\n\n\t\t\tuniforms.iridescence.value = material.iridescence;\n\t\t\tuniforms.iridescenceIOR.value = material.iridescenceIOR;\n\t\t\tuniforms.iridescenceThicknessMinimum.value = material.iridescenceThicknessRange[ 0 ];\n\t\t\tuniforms.iridescenceThicknessMaximum.value = material.iridescenceThicknessRange[ 1 ];\n\n\t\t\tif ( material.iridescenceMap ) {\n\n\t\t\t\tuniforms.iridescenceMap.value = material.iridescenceMap;\n\n\t\t\t}\n\n\t\t\tif ( material.iridescenceThicknessMap ) {\n\n\t\t\t\tuniforms.iridescenceThicknessMap.value = material.iridescenceThicknessMap;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( material.transmission > 0 ) {\n\n\t\t\tuniforms.transmission.value = material.transmission;\n\t\t\tuniforms.transmissionSamplerMap.value = transmissionRenderTarget.texture;\n\t\t\tuniforms.transmissionSamplerSize.value.set( transmissionRenderTarget.width, transmissionRenderTarget.height );\n\n\t\t\tif ( material.transmissionMap ) {\n\n\t\t\t\tuniforms.transmissionMap.value = material.transmissionMap;\n\n\t\t\t}\n\n\t\t\tuniforms.thickness.value = material.thickness;\n\n\t\t\tif ( material.thicknessMap ) {\n\n\t\t\t\tuniforms.thicknessMap.value = material.thicknessMap;\n\n\t\t\t}\n\n\t\t\tuniforms.attenuationDistance.value = material.attenuationDistance;\n\t\t\tuniforms.attenuationColor.value.copy( material.attenuationColor );\n\n\t\t}\n\n\t\tuniforms.specularIntensity.value = material.specularIntensity;\n\t\tuniforms.specularColor.value.copy( material.specularColor );\n\n\t\tif ( material.specularIntensityMap ) {\n\n\t\t\tuniforms.specularIntensityMap.value = material.specularIntensityMap;\n\n\t\t}\n\n\t\tif ( material.specularColorMap ) {\n\n\t\t\tuniforms.specularColorMap.value = material.specularColorMap;\n\n\t\t}\n\n\t}\n\n\tfunction refreshUniformsMatcap( uniforms, material ) {\n\n\t\tif ( material.matcap ) {\n\n\t\t\tuniforms.matcap.value = material.matcap;\n\n\t\t}\n\n\t}\n\n\tfunction refreshUniformsDistance( uniforms, material ) {\n\n\t\tuniforms.referencePosition.value.copy( material.referencePosition );\n\t\tuniforms.nearDistance.value = material.nearDistance;\n\t\tuniforms.farDistance.value = material.farDistance;\n\n\t}\n\n\treturn {\n\t\trefreshFogUniforms: refreshFogUniforms,\n\t\trefreshMaterialUniforms: refreshMaterialUniforms\n\t};\n\n}\n\nfunction WebGLUniformsGroups( gl, info, capabilities, state ) {\n\n\tlet buffers = {};\n\tlet updateList = {};\n\tlet allocatedBindingPoints = [];\n\n\tconst maxBindingPoints = ( capabilities.isWebGL2 ) ? gl.getParameter( 35375 ) : 0; // binding points are global whereas block indices are per shader program\n\n\tfunction bind( uniformsGroup, program ) {\n\n\t\tconst webglProgram = program.program;\n\t\tstate.uniformBlockBinding( uniformsGroup, webglProgram );\n\n\t}\n\n\tfunction update( uniformsGroup, program ) {\n\n\t\tlet buffer = buffers[ uniformsGroup.id ];\n\n\t\tif ( buffer === undefined ) {\n\n\t\t\tprepareUniformsGroup( uniformsGroup );\n\n\t\t\tbuffer = createBuffer( uniformsGroup );\n\t\t\tbuffers[ uniformsGroup.id ] = buffer;\n\n\t\t\tuniformsGroup.addEventListener( 'dispose', onUniformsGroupsDispose );\n\n\t\t}\n\n\t\t// ensure to update the binding points/block indices mapping for this program\n\n\t\tconst webglProgram = program.program;\n\t\tstate.updateUBOMapping( uniformsGroup, webglProgram );\n\n\t\t// update UBO once per frame\n\n\t\tconst frame = info.render.frame;\n\n\t\tif ( updateList[ uniformsGroup.id ] !== frame ) {\n\n\t\t\tupdateBufferData( uniformsGroup );\n\n\t\t\tupdateList[ uniformsGroup.id ] = frame;\n\n\t\t}\n\n\t}\n\n\tfunction createBuffer( uniformsGroup ) {\n\n\t\t// the setup of an UBO is independent of a particular shader program but global\n\n\t\tconst bindingPointIndex = allocateBindingPointIndex();\n\t\tuniformsGroup.__bindingPointIndex = bindingPointIndex;\n\n\t\tconst buffer = gl.createBuffer();\n\t\tconst size = uniformsGroup.__size;\n\t\tconst usage = uniformsGroup.usage;\n\n\t\tgl.bindBuffer( 35345, buffer );\n\t\tgl.bufferData( 35345, size, usage );\n\t\tgl.bindBuffer( 35345, null );\n\t\tgl.bindBufferBase( 35345, bindingPointIndex, buffer );\n\n\t\treturn buffer;\n\n\t}\n\n\tfunction allocateBindingPointIndex() {\n\n\t\tfor ( let i = 0; i < maxBindingPoints; i ++ ) {\n\n\t\t\tif ( allocatedBindingPoints.indexOf( i ) === - 1 ) {\n\n\t\t\t\tallocatedBindingPoints.push( i );\n\t\t\t\treturn i;\n\n\t\t\t}\n\n\t\t}\n\n\t\tconsole.error( 'THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached.' );\n\n\t\treturn 0;\n\n\t}\n\n\tfunction updateBufferData( uniformsGroup ) {\n\n\t\tconst buffer = buffers[ uniformsGroup.id ];\n\t\tconst uniforms = uniformsGroup.uniforms;\n\t\tconst cache = uniformsGroup.__cache;\n\n\t\tgl.bindBuffer( 35345, buffer );\n\n\t\tfor ( let i = 0, il = uniforms.length; i < il; i ++ ) {\n\n\t\t\tconst uniform = uniforms[ i ];\n\n\t\t\t// partly update the buffer if necessary\n\n\t\t\tif ( hasUniformChanged( uniform, i, cache ) === true ) {\n\n\t\t\t\tconst offset = uniform.__offset;\n\n\t\t\t\tconst values = Array.isArray( uniform.value ) ? uniform.value : [ uniform.value ];\n\n\t\t\t\tlet arrayOffset = 0;\n\n\t\t\t\tfor ( let i = 0; i < values.length; i ++ ) {\n\n\t\t\t\t\tconst value = values[ i ];\n\n\t\t\t\t\tconst info = getUniformSize( value );\n\n\t\t\t\t\tif ( typeof value === 'number' ) {\n\n\t\t\t\t\t\tuniform.__data[ 0 ] = value;\n\t\t\t\t\t\tgl.bufferSubData( 35345, offset + arrayOffset, uniform.__data );\n\n\t\t\t\t\t} else if ( value.isMatrix3 ) {\n\n\t\t\t\t\t\t// manually converting 3x3 to 3x4\n\n\t\t\t\t\t\tuniform.__data[ 0 ] = value.elements[ 0 ];\n\t\t\t\t\t\tuniform.__data[ 1 ] = value.elements[ 1 ];\n\t\t\t\t\t\tuniform.__data[ 2 ] = value.elements[ 2 ];\n\t\t\t\t\t\tuniform.__data[ 3 ] = value.elements[ 0 ];\n\t\t\t\t\t\tuniform.__data[ 4 ] = value.elements[ 3 ];\n\t\t\t\t\t\tuniform.__data[ 5 ] = value.elements[ 4 ];\n\t\t\t\t\t\tuniform.__data[ 6 ] = value.elements[ 5 ];\n\t\t\t\t\t\tuniform.__data[ 7 ] = value.elements[ 0 ];\n\t\t\t\t\t\tuniform.__data[ 8 ] = value.elements[ 6 ];\n\t\t\t\t\t\tuniform.__data[ 9 ] = value.elements[ 7 ];\n\t\t\t\t\t\tuniform.__data[ 10 ] = value.elements[ 8 ];\n\t\t\t\t\t\tuniform.__data[ 11 ] = value.elements[ 0 ];\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tvalue.toArray( uniform.__data, arrayOffset );\n\n\t\t\t\t\t\tarrayOffset += info.storage / Float32Array.BYTES_PER_ELEMENT;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tgl.bufferSubData( 35345, offset, uniform.__data );\n\n\t\t\t}\n\n\t\t}\n\n\t\tgl.bindBuffer( 35345, null );\n\n\t}\n\n\tfunction hasUniformChanged( uniform, index, cache ) {\n\n\t\tconst value = uniform.value;\n\n\t\tif ( cache[ index ] === undefined ) {\n\n\t\t\t// cache entry does not exist so far\n\n\t\t\tif ( typeof value === 'number' ) {\n\n\t\t\t\tcache[ index ] = value;\n\n\t\t\t} else {\n\n\t\t\t\tconst values = Array.isArray( value ) ? value : [ value ];\n\n\t\t\t\tconst tempValues = [];\n\n\t\t\t\tfor ( let i = 0; i < values.length; i ++ ) {\n\n\t\t\t\t\ttempValues.push( values[ i ].clone() );\n\n\t\t\t\t}\n\n\t\t\t\tcache[ index ] = tempValues;\n\n\t\t\t}\n\n\t\t\treturn true;\n\n\t\t} else {\n\n\t\t\t// compare current value with cached entry\n\n\t\t\tif ( typeof value === 'number' ) {\n\n\t\t\t\tif ( cache[ index ] !== value ) {\n\n\t\t\t\t\tcache[ index ] = value;\n\t\t\t\t\treturn true;\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tconst cachedObjects = Array.isArray( cache[ index ] ) ? cache[ index ] : [ cache[ index ] ];\n\t\t\t\tconst values = Array.isArray( value ) ? value : [ value ];\n\n\t\t\t\tfor ( let i = 0; i < cachedObjects.length; i ++ ) {\n\n\t\t\t\t\tconst cachedObject = cachedObjects[ i ];\n\n\t\t\t\t\tif ( cachedObject.equals( values[ i ] ) === false ) {\n\n\t\t\t\t\t\tcachedObject.copy( values[ i ] );\n\t\t\t\t\t\treturn true;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn false;\n\n\t}\n\n\tfunction prepareUniformsGroup( uniformsGroup ) {\n\n\t\t// determine total buffer size according to the STD140 layout\n\t\t// Hint: STD140 is the only supported layout in WebGL 2\n\n\t\tconst uniforms = uniformsGroup.uniforms;\n\n\t\tlet offset = 0; // global buffer offset in bytes\n\t\tconst chunkSize = 16; // size of a chunk in bytes\n\t\tlet chunkOffset = 0; // offset within a single chunk in bytes\n\n\t\tfor ( let i = 0, l = uniforms.length; i < l; i ++ ) {\n\n\t\t\tconst uniform = uniforms[ i ];\n\n\t\t\tconst infos = {\n\t\t\t\tboundary: 0, // bytes\n\t\t\t\tstorage: 0 // bytes\n\t\t\t};\n\n\t\t\tconst values = Array.isArray( uniform.value ) ? uniform.value : [ uniform.value ];\n\n\t\t\tfor ( let j = 0, jl = values.length; j < jl; j ++ ) {\n\n\t\t\t\tconst value = values[ j ];\n\n\t\t\t\tconst info = getUniformSize( value );\n\n\t\t\t\tinfos.boundary += info.boundary;\n\t\t\t\tinfos.storage += info.storage;\n\n\t\t\t}\n\n\t\t\t// the following two properties will be used for partial buffer updates\n\n\t\t\tuniform.__data = new Float32Array( infos.storage / Float32Array.BYTES_PER_ELEMENT );\n\t\t\tuniform.__offset = offset;\n\n\t\t\t//\n\n\t\t\tif ( i > 0 ) {\n\n\t\t\t\tchunkOffset = offset % chunkSize;\n\n\t\t\t\tconst remainingSizeInChunk = chunkSize - chunkOffset;\n\n\t\t\t\t// check for chunk overflow\n\n\t\t\t\tif ( chunkOffset !== 0 && ( remainingSizeInChunk - infos.boundary ) < 0 ) {\n\n\t\t\t\t\t// add padding and adjust offset\n\n\t\t\t\t\toffset += ( chunkSize - chunkOffset );\n\t\t\t\t\tuniform.__offset = offset;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\toffset += infos.storage;\n\n\t\t}\n\n\t\t// ensure correct final padding\n\n\t\tchunkOffset = offset % chunkSize;\n\n\t\tif ( chunkOffset > 0 ) offset += ( chunkSize - chunkOffset );\n\n\t\t//\n\n\t\tuniformsGroup.__size = offset;\n\t\tuniformsGroup.__cache = {};\n\n\t\treturn this;\n\n\t}\n\n\tfunction getUniformSize( value ) {\n\n\t\tconst info = {\n\t\t\tboundary: 0, // bytes\n\t\t\tstorage: 0 // bytes\n\t\t};\n\n\t\t// determine sizes according to STD140\n\n\t\tif ( typeof value === 'number' ) {\n\n\t\t\t// float/int\n\n\t\t\tinfo.boundary = 4;\n\t\t\tinfo.storage = 4;\n\n\t\t} else if ( value.isVector2 ) {\n\n\t\t\t// vec2\n\n\t\t\tinfo.boundary = 8;\n\t\t\tinfo.storage = 8;\n\n\t\t} else if ( value.isVector3 || value.isColor ) {\n\n\t\t\t// vec3\n\n\t\t\tinfo.boundary = 16;\n\t\t\tinfo.storage = 12; // evil: vec3 must start on a 16-byte boundary but it only consumes 12 bytes\n\n\t\t} else if ( value.isVector4 ) {\n\n\t\t\t// vec4\n\n\t\t\tinfo.boundary = 16;\n\t\t\tinfo.storage = 16;\n\n\t\t} else if ( value.isMatrix3 ) {\n\n\t\t\t// mat3 (in STD140 a 3x3 matrix is represented as 3x4)\n\n\t\t\tinfo.boundary = 48;\n\t\t\tinfo.storage = 48;\n\n\t\t} else if ( value.isMatrix4 ) {\n\n\t\t\t// mat4\n\n\t\t\tinfo.boundary = 64;\n\t\t\tinfo.storage = 64;\n\n\t\t} else if ( value.isTexture ) {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group.' );\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: Unsupported uniform value type.', value );\n\n\t\t}\n\n\t\treturn info;\n\n\t}\n\n\tfunction onUniformsGroupsDispose( event ) {\n\n\t\tconst uniformsGroup = event.target;\n\n\t\tuniformsGroup.removeEventListener( 'dispose', onUniformsGroupsDispose );\n\n\t\tconst index = allocatedBindingPoints.indexOf( uniformsGroup.__bindingPointIndex );\n\t\tallocatedBindingPoints.splice( index, 1 );\n\n\t\tgl.deleteBuffer( buffers[ uniformsGroup.id ] );\n\n\t\tdelete buffers[ uniformsGroup.id ];\n\t\tdelete updateList[ uniformsGroup.id ];\n\n\t}\n\n\tfunction dispose() {\n\n\t\tfor ( const id in buffers ) {\n\n\t\t\tgl.deleteBuffer( buffers[ id ] );\n\n\t\t}\n\n\t\tallocatedBindingPoints = [];\n\t\tbuffers = {};\n\t\tupdateList = {};\n\n\t}\n\n\treturn {\n\n\t\tbind: bind,\n\t\tupdate: update,\n\n\t\tdispose: dispose\n\n\t};\n\n}\n\nfunction createCanvasElement() {\n\n\tconst canvas = createElementNS( 'canvas' );\n\tcanvas.style.display = 'block';\n\treturn canvas;\n\n}\n\nfunction WebGLRenderer( parameters = {} ) {\n\n\tthis.isWebGLRenderer = true;\n\n\tconst _canvas = parameters.canvas !== undefined ? parameters.canvas : createCanvasElement(),\n\t\t_context = parameters.context !== undefined ? parameters.context : null,\n\n\t\t_depth = parameters.depth !== undefined ? parameters.depth : true,\n\t\t_stencil = parameters.stencil !== undefined ? parameters.stencil : true,\n\t\t_antialias = parameters.antialias !== undefined ? parameters.antialias : false,\n\t\t_premultipliedAlpha = parameters.premultipliedAlpha !== undefined ? parameters.premultipliedAlpha : true,\n\t\t_preserveDrawingBuffer = parameters.preserveDrawingBuffer !== undefined ? parameters.preserveDrawingBuffer : false,\n\t\t_powerPreference = parameters.powerPreference !== undefined ? parameters.powerPreference : 'default',\n\t\t_failIfMajorPerformanceCaveat = parameters.failIfMajorPerformanceCaveat !== undefined ? parameters.failIfMajorPerformanceCaveat : false;\n\n\tlet _alpha;\n\n\tif ( _context !== null ) {\n\n\t\t_alpha = _context.getContextAttributes().alpha;\n\n\t} else {\n\n\t\t_alpha = parameters.alpha !== undefined ? parameters.alpha : false;\n\n\t}\n\n\tlet currentRenderList = null;\n\tlet currentRenderState = null;\n\n\t// render() can be called from within a callback triggered by another render.\n\t// We track this so that the nested render call gets its list and state isolated from the parent render call.\n\n\tconst renderListStack = [];\n\tconst renderStateStack = [];\n\n\t// public properties\n\n\tthis.domElement = _canvas;\n\n\t// Debug configuration container\n\tthis.debug = {\n\n\t\t/**\n\t\t * Enables error checking and reporting when shader programs are being compiled\n\t\t * @type {boolean}\n\t\t */\n\t\tcheckShaderErrors: true\n\t};\n\n\t// clearing\n\n\tthis.autoClear = true;\n\tthis.autoClearColor = true;\n\tthis.autoClearDepth = true;\n\tthis.autoClearStencil = true;\n\n\t// scene graph\n\n\tthis.sortObjects = true;\n\n\t// user-defined clipping\n\n\tthis.clippingPlanes = [];\n\tthis.localClippingEnabled = false;\n\n\t// physically based shading\n\n\tthis.outputEncoding = LinearEncoding;\n\n\t// physical lights\n\n\tthis.physicallyCorrectLights = false;\n\n\t// tone mapping\n\n\tthis.toneMapping = NoToneMapping;\n\tthis.toneMappingExposure = 1.0;\n\n\t// internal properties\n\n\tconst _this = this;\n\n\tlet _isContextLost = false;\n\n\t// internal state cache\n\n\tlet _currentActiveCubeFace = 0;\n\tlet _currentActiveMipmapLevel = 0;\n\tlet _currentRenderTarget = null;\n\tlet _currentMaterialId = - 1;\n\n\tlet _currentCamera = null;\n\n\tconst _currentViewport = new Vector4();\n\tconst _currentScissor = new Vector4();\n\tlet _currentScissorTest = null;\n\n\t//\n\n\tlet _width = _canvas.width;\n\tlet _height = _canvas.height;\n\n\tlet _pixelRatio = 1;\n\tlet _opaqueSort = null;\n\tlet _transparentSort = null;\n\n\tconst _viewport = new Vector4( 0, 0, _width, _height );\n\tconst _scissor = new Vector4( 0, 0, _width, _height );\n\tlet _scissorTest = false;\n\n\t// frustum\n\n\tconst _frustum = new Frustum();\n\n\t// clipping\n\n\tlet _clippingEnabled = false;\n\tlet _localClippingEnabled = false;\n\n\t// transmission\n\n\tlet _transmissionRenderTarget = null;\n\n\t// camera matrices cache\n\n\tconst _projScreenMatrix = new Matrix4();\n\n\tconst _vector2 = new Vector2();\n\tconst _vector3 = new Vector3();\n\n\tconst _emptyScene = { background: null, fog: null, environment: null, overrideMaterial: null, isScene: true };\n\n\tfunction getTargetPixelRatio() {\n\n\t\treturn _currentRenderTarget === null ? _pixelRatio : 1;\n\n\t}\n\n\t// initialize\n\n\tlet _gl = _context;\n\n\tfunction getContext( contextNames, contextAttributes ) {\n\n\t\tfor ( let i = 0; i < contextNames.length; i ++ ) {\n\n\t\t\tconst contextName = contextNames[ i ];\n\t\t\tconst context = _canvas.getContext( contextName, contextAttributes );\n\t\t\tif ( context !== null ) return context;\n\n\t\t}\n\n\t\treturn null;\n\n\t}\n\n\ttry {\n\n\t\tconst contextAttributes = {\n\t\t\talpha: true,\n\t\t\tdepth: _depth,\n\t\t\tstencil: _stencil,\n\t\t\tantialias: _antialias,\n\t\t\tpremultipliedAlpha: _premultipliedAlpha,\n\t\t\tpreserveDrawingBuffer: _preserveDrawingBuffer,\n\t\t\tpowerPreference: _powerPreference,\n\t\t\tfailIfMajorPerformanceCaveat: _failIfMajorPerformanceCaveat\n\t\t};\n\n\t\t// OffscreenCanvas does not have setAttribute, see #22811\n\t\tif ( 'setAttribute' in _canvas ) _canvas.setAttribute( 'data-engine', `three.js r${REVISION}` );\n\n\t\t// event listeners must be registered before WebGL context is created, see #12753\n\t\t_canvas.addEventListener( 'webglcontextlost', onContextLost, false );\n\t\t_canvas.addEventListener( 'webglcontextrestored', onContextRestore, false );\n\t\t_canvas.addEventListener( 'webglcontextcreationerror', onContextCreationError, false );\n\n\t\tif ( _gl === null ) {\n\n\t\t\tconst contextNames = [ 'webgl2', 'webgl', 'experimental-webgl' ];\n\n\t\t\tif ( _this.isWebGL1Renderer === true ) {\n\n\t\t\t\tcontextNames.shift();\n\n\t\t\t}\n\n\t\t\t_gl = getContext( contextNames, contextAttributes );\n\n\t\t\tif ( _gl === null ) {\n\n\t\t\t\tif ( getContext( contextNames ) ) {\n\n\t\t\t\t\tthrow new Error( 'Error creating WebGL context with your selected attributes.' );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthrow new Error( 'Error creating WebGL context.' );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Some experimental-webgl implementations do not have getShaderPrecisionFormat\n\n\t\tif ( _gl.getShaderPrecisionFormat === undefined ) {\n\n\t\t\t_gl.getShaderPrecisionFormat = function () {\n\n\t\t\t\treturn { 'rangeMin': 1, 'rangeMax': 1, 'precision': 1 };\n\n\t\t\t};\n\n\t\t}\n\n\t} catch ( error ) {\n\n\t\tconsole.error( 'THREE.WebGLRenderer: ' + error.message );\n\t\tthrow error;\n\n\t}\n\n\tlet extensions, capabilities, state, info;\n\tlet properties, textures, cubemaps, cubeuvmaps, attributes, geometries, objects;\n\tlet programCache, materials, renderLists, renderStates, clipping, shadowMap;\n\n\tlet background, morphtargets, bufferRenderer, indexedBufferRenderer;\n\n\tlet utils, bindingStates, uniformsGroups;\n\n\tfunction initGLContext() {\n\n\t\textensions = new WebGLExtensions( _gl );\n\n\t\tcapabilities = new WebGLCapabilities( _gl, extensions, parameters );\n\n\t\textensions.init( capabilities );\n\n\t\tutils = new WebGLUtils( _gl, extensions, capabilities );\n\n\t\tstate = new WebGLState( _gl, extensions, capabilities );\n\n\t\tinfo = new WebGLInfo();\n\t\tproperties = new WebGLProperties();\n\t\ttextures = new WebGLTextures( _gl, extensions, state, properties, capabilities, utils, info );\n\t\tcubemaps = new WebGLCubeMaps( _this );\n\t\tcubeuvmaps = new WebGLCubeUVMaps( _this );\n\t\tattributes = new WebGLAttributes( _gl, capabilities );\n\t\tbindingStates = new WebGLBindingStates( _gl, extensions, attributes, capabilities );\n\t\tgeometries = new WebGLGeometries( _gl, attributes, info, bindingStates );\n\t\tobjects = new WebGLObjects( _gl, geometries, attributes, info );\n\t\tmorphtargets = new WebGLMorphtargets( _gl, capabilities, textures );\n\t\tclipping = new WebGLClipping( properties );\n\t\tprogramCache = new WebGLPrograms( _this, cubemaps, cubeuvmaps, extensions, capabilities, bindingStates, clipping );\n\t\tmaterials = new WebGLMaterials( _this, properties );\n\t\trenderLists = new WebGLRenderLists();\n\t\trenderStates = new WebGLRenderStates( extensions, capabilities );\n\t\tbackground = new WebGLBackground( _this, cubemaps, cubeuvmaps, state, objects, _alpha, _premultipliedAlpha );\n\t\tshadowMap = new WebGLShadowMap( _this, objects, capabilities );\n\t\tuniformsGroups = new WebGLUniformsGroups( _gl, info, capabilities, state );\n\n\t\tbufferRenderer = new WebGLBufferRenderer( _gl, extensions, info, capabilities );\n\t\tindexedBufferRenderer = new WebGLIndexedBufferRenderer( _gl, extensions, info, capabilities );\n\n\t\tinfo.programs = programCache.programs;\n\n\t\t_this.capabilities = capabilities;\n\t\t_this.extensions = extensions;\n\t\t_this.properties = properties;\n\t\t_this.renderLists = renderLists;\n\t\t_this.shadowMap = shadowMap;\n\t\t_this.state = state;\n\t\t_this.info = info;\n\n\t}\n\n\tinitGLContext();\n\n\t// xr\n\n\tconst xr = new WebXRManager( _this, _gl );\n\n\tthis.xr = xr;\n\n\t// API\n\n\tthis.getContext = function () {\n\n\t\treturn _gl;\n\n\t};\n\n\tthis.getContextAttributes = function () {\n\n\t\treturn _gl.getContextAttributes();\n\n\t};\n\n\tthis.forceContextLoss = function () {\n\n\t\tconst extension = extensions.get( 'WEBGL_lose_context' );\n\t\tif ( extension ) extension.loseContext();\n\n\t};\n\n\tthis.forceContextRestore = function () {\n\n\t\tconst extension = extensions.get( 'WEBGL_lose_context' );\n\t\tif ( extension ) extension.restoreContext();\n\n\t};\n\n\tthis.getPixelRatio = function () {\n\n\t\treturn _pixelRatio;\n\n\t};\n\n\tthis.setPixelRatio = function ( value ) {\n\n\t\tif ( value === undefined ) return;\n\n\t\t_pixelRatio = value;\n\n\t\tthis.setSize( _width, _height, false );\n\n\t};\n\n\tthis.getSize = function ( target ) {\n\n\t\treturn target.set( _width, _height );\n\n\t};\n\n\tthis.setSize = function ( width, height, updateStyle ) {\n\n\t\tif ( xr.isPresenting ) {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: Can\\'t change size while VR device is presenting.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\t_width = width;\n\t\t_height = height;\n\n\t\t_canvas.width = Math.floor( width * _pixelRatio );\n\t\t_canvas.height = Math.floor( height * _pixelRatio );\n\n\t\tif ( updateStyle !== false ) {\n\n\t\t\t_canvas.style.width = width + 'px';\n\t\t\t_canvas.style.height = height + 'px';\n\n\t\t}\n\n\t\tthis.setViewport( 0, 0, width, height );\n\n\t};\n\n\tthis.getDrawingBufferSize = function ( target ) {\n\n\t\treturn target.set( _width * _pixelRatio, _height * _pixelRatio ).floor();\n\n\t};\n\n\tthis.setDrawingBufferSize = function ( width, height, pixelRatio ) {\n\n\t\t_width = width;\n\t\t_height = height;\n\n\t\t_pixelRatio = pixelRatio;\n\n\t\t_canvas.width = Math.floor( width * pixelRatio );\n\t\t_canvas.height = Math.floor( height * pixelRatio );\n\n\t\tthis.setViewport( 0, 0, width, height );\n\n\t};\n\n\tthis.getCurrentViewport = function ( target ) {\n\n\t\treturn target.copy( _currentViewport );\n\n\t};\n\n\tthis.getViewport = function ( target ) {\n\n\t\treturn target.copy( _viewport );\n\n\t};\n\n\tthis.setViewport = function ( x, y, width, height ) {\n\n\t\tif ( x.isVector4 ) {\n\n\t\t\t_viewport.set( x.x, x.y, x.z, x.w );\n\n\t\t} else {\n\n\t\t\t_viewport.set( x, y, width, height );\n\n\t\t}\n\n\t\tstate.viewport( _currentViewport.copy( _viewport ).multiplyScalar( _pixelRatio ).floor() );\n\n\t};\n\n\tthis.getScissor = function ( target ) {\n\n\t\treturn target.copy( _scissor );\n\n\t};\n\n\tthis.setScissor = function ( x, y, width, height ) {\n\n\t\tif ( x.isVector4 ) {\n\n\t\t\t_scissor.set( x.x, x.y, x.z, x.w );\n\n\t\t} else {\n\n\t\t\t_scissor.set( x, y, width, height );\n\n\t\t}\n\n\t\tstate.scissor( _currentScissor.copy( _scissor ).multiplyScalar( _pixelRatio ).floor() );\n\n\t};\n\n\tthis.getScissorTest = function () {\n\n\t\treturn _scissorTest;\n\n\t};\n\n\tthis.setScissorTest = function ( boolean ) {\n\n\t\tstate.setScissorTest( _scissorTest = boolean );\n\n\t};\n\n\tthis.setOpaqueSort = function ( method ) {\n\n\t\t_opaqueSort = method;\n\n\t};\n\n\tthis.setTransparentSort = function ( method ) {\n\n\t\t_transparentSort = method;\n\n\t};\n\n\t// Clearing\n\n\tthis.getClearColor = function ( target ) {\n\n\t\treturn target.copy( background.getClearColor() );\n\n\t};\n\n\tthis.setClearColor = function () {\n\n\t\tbackground.setClearColor.apply( background, arguments );\n\n\t};\n\n\tthis.getClearAlpha = function () {\n\n\t\treturn background.getClearAlpha();\n\n\t};\n\n\tthis.setClearAlpha = function () {\n\n\t\tbackground.setClearAlpha.apply( background, arguments );\n\n\t};\n\n\tthis.clear = function ( color = true, depth = true, stencil = true ) {\n\n\t\tlet bits = 0;\n\n\t\tif ( color ) bits |= 16384;\n\t\tif ( depth ) bits |= 256;\n\t\tif ( stencil ) bits |= 1024;\n\n\t\t_gl.clear( bits );\n\n\t};\n\n\tthis.clearColor = function () {\n\n\t\tthis.clear( true, false, false );\n\n\t};\n\n\tthis.clearDepth = function () {\n\n\t\tthis.clear( false, true, false );\n\n\t};\n\n\tthis.clearStencil = function () {\n\n\t\tthis.clear( false, false, true );\n\n\t};\n\n\t//\n\n\tthis.dispose = function () {\n\n\t\t_canvas.removeEventListener( 'webglcontextlost', onContextLost, false );\n\t\t_canvas.removeEventListener( 'webglcontextrestored', onContextRestore, false );\n\t\t_canvas.removeEventListener( 'webglcontextcreationerror', onContextCreationError, false );\n\n\t\trenderLists.dispose();\n\t\trenderStates.dispose();\n\t\tproperties.dispose();\n\t\tcubemaps.dispose();\n\t\tcubeuvmaps.dispose();\n\t\tobjects.dispose();\n\t\tbindingStates.dispose();\n\t\tuniformsGroups.dispose();\n\t\tprogramCache.dispose();\n\n\t\txr.dispose();\n\n\t\txr.removeEventListener( 'sessionstart', onXRSessionStart );\n\t\txr.removeEventListener( 'sessionend', onXRSessionEnd );\n\n\t\tif ( _transmissionRenderTarget ) {\n\n\t\t\t_transmissionRenderTarget.dispose();\n\t\t\t_transmissionRenderTarget = null;\n\n\t\t}\n\n\t\tanimation.stop();\n\n\t};\n\n\t// Events\n\n\tfunction onContextLost( event ) {\n\n\t\tevent.preventDefault();\n\n\t\tconsole.log( 'THREE.WebGLRenderer: Context Lost.' );\n\n\t\t_isContextLost = true;\n\n\t}\n\n\tfunction onContextRestore( /* event */ ) {\n\n\t\tconsole.log( 'THREE.WebGLRenderer: Context Restored.' );\n\n\t\t_isContextLost = false;\n\n\t\tconst infoAutoReset = info.autoReset;\n\t\tconst shadowMapEnabled = shadowMap.enabled;\n\t\tconst shadowMapAutoUpdate = shadowMap.autoUpdate;\n\t\tconst shadowMapNeedsUpdate = shadowMap.needsUpdate;\n\t\tconst shadowMapType = shadowMap.type;\n\n\t\tinitGLContext();\n\n\t\tinfo.autoReset = infoAutoReset;\n\t\tshadowMap.enabled = shadowMapEnabled;\n\t\tshadowMap.autoUpdate = shadowMapAutoUpdate;\n\t\tshadowMap.needsUpdate = shadowMapNeedsUpdate;\n\t\tshadowMap.type = shadowMapType;\n\n\t}\n\n\tfunction onContextCreationError( event ) {\n\n\t\tconsole.error( 'THREE.WebGLRenderer: A WebGL context could not be created. Reason: ', event.statusMessage );\n\n\t}\n\n\tfunction onMaterialDispose( event ) {\n\n\t\tconst material = event.target;\n\n\t\tmaterial.removeEventListener( 'dispose', onMaterialDispose );\n\n\t\tdeallocateMaterial( material );\n\n\t}\n\n\t// Buffer deallocation\n\n\tfunction deallocateMaterial( material ) {\n\n\t\treleaseMaterialProgramReferences( material );\n\n\t\tproperties.remove( material );\n\n\t}\n\n\n\tfunction releaseMaterialProgramReferences( material ) {\n\n\t\tconst programs = properties.get( material ).programs;\n\n\t\tif ( programs !== undefined ) {\n\n\t\t\tprograms.forEach( function ( program ) {\n\n\t\t\t\tprogramCache.releaseProgram( program );\n\n\t\t\t} );\n\n\t\t\tif ( material.isShaderMaterial ) {\n\n\t\t\t\tprogramCache.releaseShaderCache( material );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t// Buffer rendering\n\n\tthis.renderBufferDirect = function ( camera, scene, geometry, material, object, group ) {\n\n\t\tif ( scene === null ) scene = _emptyScene; // renderBufferDirect second parameter used to be fog (could be null)\n\n\t\tconst frontFaceCW = ( object.isMesh && object.matrixWorld.determinant() < 0 );\n\n\t\tconst program = setProgram( camera, scene, geometry, material, object );\n\n\t\tstate.setMaterial( material, frontFaceCW );\n\n\t\t//\n\n\t\tlet index = geometry.index;\n\t\tlet rangeFactor = 1;\n\n\t\tif ( material.wireframe === true ) {\n\n\t\t\tindex = geometries.getWireframeAttribute( geometry );\n\t\t\trangeFactor = 2;\n\n\t\t}\n\n\t\t//\n\n\t\tconst drawRange = geometry.drawRange;\n\t\tconst position = geometry.attributes.position;\n\n\t\tlet drawStart = drawRange.start * rangeFactor;\n\t\tlet drawEnd = ( drawRange.start + drawRange.count ) * rangeFactor;\n\n\t\tif ( group !== null ) {\n\n\t\t\tdrawStart = Math.max( drawStart, group.start * rangeFactor );\n\t\t\tdrawEnd = Math.min( drawEnd, ( group.start + group.count ) * rangeFactor );\n\n\t\t}\n\n\t\tif ( index !== null ) {\n\n\t\t\tdrawStart = Math.max( drawStart, 0 );\n\t\t\tdrawEnd = Math.min( drawEnd, index.count );\n\n\t\t} else if ( position !== undefined && position !== null ) {\n\n\t\t\tdrawStart = Math.max( drawStart, 0 );\n\t\t\tdrawEnd = Math.min( drawEnd, position.count );\n\n\t\t}\n\n\t\tconst drawCount = drawEnd - drawStart;\n\n\t\tif ( drawCount < 0 || drawCount === Infinity ) return;\n\n\t\t//\n\n\t\tbindingStates.setup( object, material, program, geometry, index );\n\n\t\tlet attribute;\n\t\tlet renderer = bufferRenderer;\n\n\t\tif ( index !== null ) {\n\n\t\t\tattribute = attributes.get( index );\n\n\t\t\trenderer = indexedBufferRenderer;\n\t\t\trenderer.setIndex( attribute );\n\n\t\t}\n\n\t\t//\n\n\t\tif ( object.isMesh ) {\n\n\t\t\tif ( material.wireframe === true ) {\n\n\t\t\t\tstate.setLineWidth( material.wireframeLinewidth * getTargetPixelRatio() );\n\t\t\t\trenderer.setMode( 1 );\n\n\t\t\t} else {\n\n\t\t\t\trenderer.setMode( 4 );\n\n\t\t\t}\n\n\t\t} else if ( object.isLine ) {\n\n\t\t\tlet lineWidth = material.linewidth;\n\n\t\t\tif ( lineWidth === undefined ) lineWidth = 1; // Not using Line*Material\n\n\t\t\tstate.setLineWidth( lineWidth * getTargetPixelRatio() );\n\n\t\t\tif ( object.isLineSegments ) {\n\n\t\t\t\trenderer.setMode( 1 );\n\n\t\t\t} else if ( object.isLineLoop ) {\n\n\t\t\t\trenderer.setMode( 2 );\n\n\t\t\t} else {\n\n\t\t\t\trenderer.setMode( 3 );\n\n\t\t\t}\n\n\t\t} else if ( object.isPoints ) {\n\n\t\t\trenderer.setMode( 0 );\n\n\t\t} else if ( object.isSprite ) {\n\n\t\t\trenderer.setMode( 4 );\n\n\t\t}\n\n\t\tif ( object.isInstancedMesh ) {\n\n\t\t\trenderer.renderInstances( drawStart, drawCount, object.count );\n\n\t\t} else if ( geometry.isInstancedBufferGeometry ) {\n\n\t\t\tconst maxInstanceCount = geometry._maxInstanceCount !== undefined ? geometry._maxInstanceCount : Infinity;\n\t\t\tconst instanceCount = Math.min( geometry.instanceCount, maxInstanceCount );\n\n\t\t\trenderer.renderInstances( drawStart, drawCount, instanceCount );\n\n\t\t} else {\n\n\t\t\trenderer.render( drawStart, drawCount );\n\n\t\t}\n\n\t};\n\n\t// Compile\n\n\tthis.compile = function ( scene, camera ) {\n\n\t\tfunction prepare( material, scene, object ) {\n\n\t\t\tif ( material.transparent === true && material.side === TwoPassDoubleSide ) {\n\n\t\t\t\tmaterial.side = BackSide;\n\t\t\t\tmaterial.needsUpdate = true;\n\t\t\t\tgetProgram( material, scene, object );\n\n\t\t\t\tmaterial.side = FrontSide;\n\t\t\t\tmaterial.needsUpdate = true;\n\t\t\t\tgetProgram( material, scene, object );\n\n\t\t\t\tmaterial.side = TwoPassDoubleSide;\n\n\t\t\t} else {\n\n\t\t\t\tgetProgram( material, scene, object );\n\n\t\t\t}\n\n\t\t}\n\n\t\tcurrentRenderState = renderStates.get( scene );\n\t\tcurrentRenderState.init();\n\n\t\trenderStateStack.push( currentRenderState );\n\n\t\tscene.traverseVisible( function ( object ) {\n\n\t\t\tif ( object.isLight && object.layers.test( camera.layers ) ) {\n\n\t\t\t\tcurrentRenderState.pushLight( object );\n\n\t\t\t\tif ( object.castShadow ) {\n\n\t\t\t\t\tcurrentRenderState.pushShadow( object );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} );\n\n\t\tcurrentRenderState.setupLights( _this.physicallyCorrectLights );\n\n\t\tscene.traverse( function ( object ) {\n\n\t\t\tconst material = object.material;\n\n\t\t\tif ( material ) {\n\n\t\t\t\tif ( Array.isArray( material ) ) {\n\n\t\t\t\t\tfor ( let i = 0; i < material.length; i ++ ) {\n\n\t\t\t\t\t\tconst material2 = material[ i ];\n\n\t\t\t\t\t\tprepare( material2, scene, object );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tprepare( material, scene, object );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} );\n\n\t\trenderStateStack.pop();\n\t\tcurrentRenderState = null;\n\n\t};\n\n\t// Animation Loop\n\n\tlet onAnimationFrameCallback = null;\n\n\tfunction onAnimationFrame( time ) {\n\n\t\tif ( onAnimationFrameCallback ) onAnimationFrameCallback( time );\n\n\t}\n\n\tfunction onXRSessionStart() {\n\n\t\tanimation.stop();\n\n\t}\n\n\tfunction onXRSessionEnd() {\n\n\t\tanimation.start();\n\n\t}\n\n\tconst animation = new WebGLAnimation();\n\tanimation.setAnimationLoop( onAnimationFrame );\n\n\tif ( typeof self !== 'undefined' ) animation.setContext( self );\n\n\tthis.setAnimationLoop = function ( callback ) {\n\n\t\tonAnimationFrameCallback = callback;\n\t\txr.setAnimationLoop( callback );\n\n\t\t( callback === null ) ? animation.stop() : animation.start();\n\n\t};\n\n\txr.addEventListener( 'sessionstart', onXRSessionStart );\n\txr.addEventListener( 'sessionend', onXRSessionEnd );\n\n\t// Rendering\n\n\tthis.render = function ( scene, camera ) {\n\n\t\tif ( camera !== undefined && camera.isCamera !== true ) {\n\n\t\t\tconsole.error( 'THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( _isContextLost === true ) return;\n\n\t\t// update scene graph\n\n\t\tif ( scene.matrixWorldAutoUpdate === true ) scene.updateMatrixWorld();\n\n\t\t// update camera matrices and frustum\n\n\t\tif ( camera.parent === null && camera.matrixWorldAutoUpdate === true ) camera.updateMatrixWorld();\n\n\t\tif ( xr.enabled === true && xr.isPresenting === true ) {\n\n\t\t\tif ( xr.cameraAutoUpdate === true ) xr.updateCamera( camera );\n\n\t\t\tcamera = xr.getCamera(); // use XR camera for rendering\n\n\t\t}\n\n\t\t//\n\t\tif ( scene.isScene === true ) scene.onBeforeRender( _this, scene, camera, _currentRenderTarget );\n\n\t\tcurrentRenderState = renderStates.get( scene, renderStateStack.length );\n\t\tcurrentRenderState.init();\n\n\t\trenderStateStack.push( currentRenderState );\n\n\t\t_projScreenMatrix.multiplyMatrices( camera.projectionMatrix, camera.matrixWorldInverse );\n\t\t_frustum.setFromProjectionMatrix( _projScreenMatrix );\n\n\t\t_localClippingEnabled = this.localClippingEnabled;\n\t\t_clippingEnabled = clipping.init( this.clippingPlanes, _localClippingEnabled, camera );\n\n\t\tcurrentRenderList = renderLists.get( scene, renderListStack.length );\n\t\tcurrentRenderList.init();\n\n\t\trenderListStack.push( currentRenderList );\n\n\t\tprojectObject( scene, camera, 0, _this.sortObjects );\n\n\t\tcurrentRenderList.finish();\n\n\t\tif ( _this.sortObjects === true ) {\n\n\t\t\tcurrentRenderList.sort( _opaqueSort, _transparentSort );\n\n\t\t}\n\n\t\t//\n\n\t\tif ( _clippingEnabled === true ) clipping.beginShadows();\n\n\t\tconst shadowsArray = currentRenderState.state.shadowsArray;\n\n\t\tshadowMap.render( shadowsArray, scene, camera );\n\n\t\tif ( _clippingEnabled === true ) clipping.endShadows();\n\n\t\t//\n\n\t\tif ( this.info.autoReset === true ) this.info.reset();\n\n\t\t//\n\n\t\tbackground.render( currentRenderList, scene );\n\n\t\t// render scene\n\n\t\tcurrentRenderState.setupLights( _this.physicallyCorrectLights );\n\n\t\tif ( camera.isArrayCamera ) {\n\n\t\t\tconst cameras = camera.cameras;\n\n\t\t\tfor ( let i = 0, l = cameras.length; i < l; i ++ ) {\n\n\t\t\t\tconst camera2 = cameras[ i ];\n\n\t\t\t\trenderScene( currentRenderList, scene, camera2, camera2.viewport );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\trenderScene( currentRenderList, scene, camera );\n\n\t\t}\n\n\t\t//\n\n\t\tif ( _currentRenderTarget !== null ) {\n\n\t\t\t// resolve multisample renderbuffers to a single-sample texture if necessary\n\n\t\t\ttextures.updateMultisampleRenderTarget( _currentRenderTarget );\n\n\t\t\t// Generate mipmap if we're using any kind of mipmap filtering\n\n\t\t\ttextures.updateRenderTargetMipmap( _currentRenderTarget );\n\n\t\t}\n\n\t\t//\n\n\t\tif ( scene.isScene === true ) scene.onAfterRender( _this, scene, camera );\n\n\t\t// _gl.finish();\n\n\t\tbindingStates.resetDefaultState();\n\t\t_currentMaterialId = - 1;\n\t\t_currentCamera = null;\n\n\t\trenderStateStack.pop();\n\n\t\tif ( renderStateStack.length > 0 ) {\n\n\t\t\tcurrentRenderState = renderStateStack[ renderStateStack.length - 1 ];\n\n\t\t} else {\n\n\t\t\tcurrentRenderState = null;\n\n\t\t}\n\n\t\trenderListStack.pop();\n\n\t\tif ( renderListStack.length > 0 ) {\n\n\t\t\tcurrentRenderList = renderListStack[ renderListStack.length - 1 ];\n\n\t\t} else {\n\n\t\t\tcurrentRenderList = null;\n\n\t\t}\n\n\t};\n\n\tfunction projectObject( object, camera, groupOrder, sortObjects ) {\n\n\t\tif ( object.visible === false ) return;\n\n\t\tconst visible = object.layers.test( camera.layers );\n\n\t\tif ( visible ) {\n\n\t\t\tif ( object.isGroup ) {\n\n\t\t\t\tgroupOrder = object.renderOrder;\n\n\t\t\t} else if ( object.isLOD ) {\n\n\t\t\t\tif ( object.autoUpdate === true ) object.update( camera );\n\n\t\t\t} else if ( object.isLight ) {\n\n\t\t\t\tcurrentRenderState.pushLight( object );\n\n\t\t\t\tif ( object.castShadow ) {\n\n\t\t\t\t\tcurrentRenderState.pushShadow( object );\n\n\t\t\t\t}\n\n\t\t\t} else if ( object.isSprite ) {\n\n\t\t\t\tif ( ! object.frustumCulled || _frustum.intersectsSprite( object ) ) {\n\n\t\t\t\t\tif ( sortObjects ) {\n\n\t\t\t\t\t\t_vector3.setFromMatrixPosition( object.matrixWorld )\n\t\t\t\t\t\t\t.applyMatrix4( _projScreenMatrix );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tconst geometry = objects.update( object );\n\t\t\t\t\tconst material = object.material;\n\n\t\t\t\t\tif ( material.visible ) {\n\n\t\t\t\t\t\tcurrentRenderList.push( object, geometry, material, groupOrder, _vector3.z, null );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else if ( object.isMesh || object.isLine || object.isPoints ) {\n\n\t\t\t\tif ( object.isSkinnedMesh ) {\n\n\t\t\t\t\t// update skeleton only once in a frame\n\n\t\t\t\t\tif ( object.skeleton.frame !== info.render.frame ) {\n\n\t\t\t\t\t\tobject.skeleton.update();\n\t\t\t\t\t\tobject.skeleton.frame = info.render.frame;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( ! object.frustumCulled || _frustum.intersectsObject( object ) ) {\n\n\t\t\t\t\tif ( sortObjects ) {\n\n\t\t\t\t\t\t_vector3.setFromMatrixPosition( object.matrixWorld )\n\t\t\t\t\t\t\t.applyMatrix4( _projScreenMatrix );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tconst geometry = objects.update( object );\n\t\t\t\t\tconst material = object.material;\n\n\t\t\t\t\tif ( Array.isArray( material ) ) {\n\n\t\t\t\t\t\tconst groups = geometry.groups;\n\n\t\t\t\t\t\tfor ( let i = 0, l = groups.length; i < l; i ++ ) {\n\n\t\t\t\t\t\t\tconst group = groups[ i ];\n\t\t\t\t\t\t\tconst groupMaterial = material[ group.materialIndex ];\n\n\t\t\t\t\t\t\tif ( groupMaterial && groupMaterial.visible ) {\n\n\t\t\t\t\t\t\t\tcurrentRenderList.push( object, geometry, groupMaterial, groupOrder, _vector3.z, group );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else if ( material.visible ) {\n\n\t\t\t\t\t\tcurrentRenderList.push( object, geometry, material, groupOrder, _vector3.z, null );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst children = object.children;\n\n\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\tprojectObject( children[ i ], camera, groupOrder, sortObjects );\n\n\t\t}\n\n\t}\n\n\tfunction renderScene( currentRenderList, scene, camera, viewport ) {\n\n\t\tconst opaqueObjects = currentRenderList.opaque;\n\t\tconst transmissiveObjects = currentRenderList.transmissive;\n\t\tconst transparentObjects = currentRenderList.transparent;\n\n\t\tcurrentRenderState.setupLightsView( camera );\n\n\t\tif ( transmissiveObjects.length > 0 ) renderTransmissionPass( opaqueObjects, scene, camera );\n\n\t\tif ( viewport ) state.viewport( _currentViewport.copy( viewport ) );\n\n\t\tif ( opaqueObjects.length > 0 ) renderObjects( opaqueObjects, scene, camera );\n\t\tif ( transmissiveObjects.length > 0 ) renderObjects( transmissiveObjects, scene, camera );\n\t\tif ( transparentObjects.length > 0 ) renderObjects( transparentObjects, scene, camera );\n\n\t\t// Ensure depth buffer writing is enabled so it can be cleared on next render\n\n\t\tstate.buffers.depth.setTest( true );\n\t\tstate.buffers.depth.setMask( true );\n\t\tstate.buffers.color.setMask( true );\n\n\t\tstate.setPolygonOffset( false );\n\n\t}\n\n\tfunction renderTransmissionPass( opaqueObjects, scene, camera ) {\n\n\t\tconst isWebGL2 = capabilities.isWebGL2;\n\n\t\tif ( _transmissionRenderTarget === null ) {\n\n\t\t\t_transmissionRenderTarget = new WebGLRenderTarget( 1, 1, {\n\t\t\t\tgenerateMipmaps: true,\n\t\t\t\ttype: extensions.has( 'EXT_color_buffer_half_float' ) ? HalfFloatType : UnsignedByteType,\n\t\t\t\tminFilter: LinearMipmapLinearFilter,\n\t\t\t\tsamples: ( isWebGL2 && _antialias === true ) ? 4 : 0\n\t\t\t} );\n\n\t\t}\n\n\t\t_this.getDrawingBufferSize( _vector2 );\n\n\t\tif ( isWebGL2 ) {\n\n\t\t\t_transmissionRenderTarget.setSize( _vector2.x, _vector2.y );\n\n\t\t} else {\n\n\t\t\t_transmissionRenderTarget.setSize( floorPowerOfTwo( _vector2.x ), floorPowerOfTwo( _vector2.y ) );\n\n\t\t}\n\n\t\t//\n\n\t\tconst currentRenderTarget = _this.getRenderTarget();\n\t\t_this.setRenderTarget( _transmissionRenderTarget );\n\t\t_this.clear();\n\n\t\t// Turn off the features which can affect the frag color for opaque objects pass.\n\t\t// Otherwise they are applied twice in opaque objects pass and transmission objects pass.\n\t\tconst currentToneMapping = _this.toneMapping;\n\t\t_this.toneMapping = NoToneMapping;\n\n\t\trenderObjects( opaqueObjects, scene, camera );\n\n\t\t_this.toneMapping = currentToneMapping;\n\n\t\ttextures.updateMultisampleRenderTarget( _transmissionRenderTarget );\n\t\ttextures.updateRenderTargetMipmap( _transmissionRenderTarget );\n\n\t\t_this.setRenderTarget( currentRenderTarget );\n\n\t}\n\n\tfunction renderObjects( renderList, scene, camera ) {\n\n\t\tconst overrideMaterial = scene.isScene === true ? scene.overrideMaterial : null;\n\n\t\tfor ( let i = 0, l = renderList.length; i < l; i ++ ) {\n\n\t\t\tconst renderItem = renderList[ i ];\n\n\t\t\tconst object = renderItem.object;\n\t\t\tconst geometry = renderItem.geometry;\n\t\t\tconst material = overrideMaterial === null ? renderItem.material : overrideMaterial;\n\t\t\tconst group = renderItem.group;\n\n\t\t\tif ( object.layers.test( camera.layers ) ) {\n\n\t\t\t\trenderObject( object, scene, camera, geometry, material, group );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tfunction renderObject( object, scene, camera, geometry, material, group ) {\n\n\t\tobject.onBeforeRender( _this, scene, camera, geometry, material, group );\n\n\t\tobject.modelViewMatrix.multiplyMatrices( camera.matrixWorldInverse, object.matrixWorld );\n\t\tobject.normalMatrix.getNormalMatrix( object.modelViewMatrix );\n\n\t\tmaterial.onBeforeRender( _this, scene, camera, geometry, object, group );\n\n\t\tif ( material.transparent === true && material.side === TwoPassDoubleSide ) {\n\n\t\t\tmaterial.side = BackSide;\n\t\t\tmaterial.needsUpdate = true;\n\t\t\t_this.renderBufferDirect( camera, scene, geometry, material, object, group );\n\n\t\t\tmaterial.side = FrontSide;\n\t\t\tmaterial.needsUpdate = true;\n\t\t\t_this.renderBufferDirect( camera, scene, geometry, material, object, group );\n\n\t\t\tmaterial.side = TwoPassDoubleSide;\n\n\t\t} else {\n\n\t\t\t_this.renderBufferDirect( camera, scene, geometry, material, object, group );\n\n\t\t}\n\n\t\tobject.onAfterRender( _this, scene, camera, geometry, material, group );\n\n\t}\n\n\tfunction getProgram( material, scene, object ) {\n\n\t\tif ( scene.isScene !== true ) scene = _emptyScene; // scene could be a Mesh, Line, Points, ...\n\n\t\tconst materialProperties = properties.get( material );\n\n\t\tconst lights = currentRenderState.state.lights;\n\t\tconst shadowsArray = currentRenderState.state.shadowsArray;\n\n\t\tconst lightsStateVersion = lights.state.version;\n\n\t\tconst parameters = programCache.getParameters( material, lights.state, shadowsArray, scene, object );\n\t\tconst programCacheKey = programCache.getProgramCacheKey( parameters );\n\n\t\tlet programs = materialProperties.programs;\n\n\t\t// always update environment and fog - changing these trigger an getProgram call, but it's possible that the program doesn't change\n\n\t\tmaterialProperties.environment = material.isMeshStandardMaterial ? scene.environment : null;\n\t\tmaterialProperties.fog = scene.fog;\n\t\tmaterialProperties.envMap = ( material.isMeshStandardMaterial ? cubeuvmaps : cubemaps ).get( material.envMap || materialProperties.environment );\n\n\t\tif ( programs === undefined ) {\n\n\t\t\t// new material\n\n\t\t\tmaterial.addEventListener( 'dispose', onMaterialDispose );\n\n\t\t\tprograms = new Map();\n\t\t\tmaterialProperties.programs = programs;\n\n\t\t}\n\n\t\tlet program = programs.get( programCacheKey );\n\n\t\tif ( program !== undefined ) {\n\n\t\t\t// early out if program and light state is identical\n\n\t\t\tif ( materialProperties.currentProgram === program && materialProperties.lightsStateVersion === lightsStateVersion ) {\n\n\t\t\t\tupdateCommonMaterialProperties( material, parameters );\n\n\t\t\t\treturn program;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tparameters.uniforms = programCache.getUniforms( material );\n\n\t\t\tmaterial.onBuild( object, parameters, _this );\n\n\t\t\tmaterial.onBeforeCompile( parameters, _this );\n\n\t\t\tprogram = programCache.acquireProgram( parameters, programCacheKey );\n\t\t\tprograms.set( programCacheKey, program );\n\n\t\t\tmaterialProperties.uniforms = parameters.uniforms;\n\n\t\t}\n\n\t\tconst uniforms = materialProperties.uniforms;\n\n\t\tif ( ( ! material.isShaderMaterial && ! material.isRawShaderMaterial ) || material.clipping === true ) {\n\n\t\t\tuniforms.clippingPlanes = clipping.uniform;\n\n\t\t}\n\n\t\tupdateCommonMaterialProperties( material, parameters );\n\n\t\t// store the light setup it was created for\n\n\t\tmaterialProperties.needsLights = materialNeedsLights( material );\n\t\tmaterialProperties.lightsStateVersion = lightsStateVersion;\n\n\t\tif ( materialProperties.needsLights ) {\n\n\t\t\t// wire up the material to this renderer's lighting state\n\n\t\t\tuniforms.ambientLightColor.value = lights.state.ambient;\n\t\t\tuniforms.lightProbe.value = lights.state.probe;\n\t\t\tuniforms.directionalLights.value = lights.state.directional;\n\t\t\tuniforms.directionalLightShadows.value = lights.state.directionalShadow;\n\t\t\tuniforms.spotLights.value = lights.state.spot;\n\t\t\tuniforms.spotLightShadows.value = lights.state.spotShadow;\n\t\t\tuniforms.rectAreaLights.value = lights.state.rectArea;\n\t\t\tuniforms.ltc_1.value = lights.state.rectAreaLTC1;\n\t\t\tuniforms.ltc_2.value = lights.state.rectAreaLTC2;\n\t\t\tuniforms.pointLights.value = lights.state.point;\n\t\t\tuniforms.pointLightShadows.value = lights.state.pointShadow;\n\t\t\tuniforms.hemisphereLights.value = lights.state.hemi;\n\n\t\t\tuniforms.directionalShadowMap.value = lights.state.directionalShadowMap;\n\t\t\tuniforms.directionalShadowMatrix.value = lights.state.directionalShadowMatrix;\n\t\t\tuniforms.spotShadowMap.value = lights.state.spotShadowMap;\n\t\t\tuniforms.spotLightMatrix.value = lights.state.spotLightMatrix;\n\t\t\tuniforms.spotLightMap.value = lights.state.spotLightMap;\n\t\t\tuniforms.pointShadowMap.value = lights.state.pointShadowMap;\n\t\t\tuniforms.pointShadowMatrix.value = lights.state.pointShadowMatrix;\n\t\t\t// TODO (abelnation): add area lights shadow info to uniforms\n\n\t\t}\n\n\t\tconst progUniforms = program.getUniforms();\n\t\tconst uniformsList = WebGLUniforms.seqWithValue( progUniforms.seq, uniforms );\n\n\t\tmaterialProperties.currentProgram = program;\n\t\tmaterialProperties.uniformsList = uniformsList;\n\n\t\treturn program;\n\n\t}\n\n\tfunction updateCommonMaterialProperties( material, parameters ) {\n\n\t\tconst materialProperties = properties.get( material );\n\n\t\tmaterialProperties.outputEncoding = parameters.outputEncoding;\n\t\tmaterialProperties.instancing = parameters.instancing;\n\t\tmaterialProperties.skinning = parameters.skinning;\n\t\tmaterialProperties.morphTargets = parameters.morphTargets;\n\t\tmaterialProperties.morphNormals = parameters.morphNormals;\n\t\tmaterialProperties.morphColors = parameters.morphColors;\n\t\tmaterialProperties.morphTargetsCount = parameters.morphTargetsCount;\n\t\tmaterialProperties.numClippingPlanes = parameters.numClippingPlanes;\n\t\tmaterialProperties.numIntersection = parameters.numClipIntersection;\n\t\tmaterialProperties.vertexAlphas = parameters.vertexAlphas;\n\t\tmaterialProperties.vertexTangents = parameters.vertexTangents;\n\t\tmaterialProperties.toneMapping = parameters.toneMapping;\n\n\t}\n\n\tfunction setProgram( camera, scene, geometry, material, object ) {\n\n\t\tif ( scene.isScene !== true ) scene = _emptyScene; // scene could be a Mesh, Line, Points, ...\n\n\t\ttextures.resetTextureUnits();\n\n\t\tconst fog = scene.fog;\n\t\tconst environment = material.isMeshStandardMaterial ? scene.environment : null;\n\t\tconst encoding = ( _currentRenderTarget === null ) ? _this.outputEncoding : ( _currentRenderTarget.isXRRenderTarget === true ? _currentRenderTarget.texture.encoding : LinearEncoding );\n\t\tconst envMap = ( material.isMeshStandardMaterial ? cubeuvmaps : cubemaps ).get( material.envMap || environment );\n\t\tconst vertexAlphas = material.vertexColors === true && !! geometry.attributes.color && geometry.attributes.color.itemSize === 4;\n\t\tconst vertexTangents = !! material.normalMap && !! geometry.attributes.tangent;\n\t\tconst morphTargets = !! geometry.morphAttributes.position;\n\t\tconst morphNormals = !! geometry.morphAttributes.normal;\n\t\tconst morphColors = !! geometry.morphAttributes.color;\n\t\tconst toneMapping = material.toneMapped ? _this.toneMapping : NoToneMapping;\n\n\t\tconst morphAttribute = geometry.morphAttributes.position || geometry.morphAttributes.normal || geometry.morphAttributes.color;\n\t\tconst morphTargetsCount = ( morphAttribute !== undefined ) ? morphAttribute.length : 0;\n\n\t\tconst materialProperties = properties.get( material );\n\t\tconst lights = currentRenderState.state.lights;\n\n\t\tif ( _clippingEnabled === true ) {\n\n\t\t\tif ( _localClippingEnabled === true || camera !== _currentCamera ) {\n\n\t\t\t\tconst useCache =\n\t\t\t\t\tcamera === _currentCamera &&\n\t\t\t\t\tmaterial.id === _currentMaterialId;\n\n\t\t\t\t// we might want to call this function with some ClippingGroup\n\t\t\t\t// object instead of the material, once it becomes feasible\n\t\t\t\t// (#8465, #8379)\n\t\t\t\tclipping.setState( material, camera, useCache );\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tlet needsProgramChange = false;\n\n\t\tif ( material.version === materialProperties.__version ) {\n\n\t\t\tif ( materialProperties.needsLights && ( materialProperties.lightsStateVersion !== lights.state.version ) ) {\n\n\t\t\t\tneedsProgramChange = true;\n\n\t\t\t} else if ( materialProperties.outputEncoding !== encoding ) {\n\n\t\t\t\tneedsProgramChange = true;\n\n\t\t\t} else if ( object.isInstancedMesh && materialProperties.instancing === false ) {\n\n\t\t\t\tneedsProgramChange = true;\n\n\t\t\t} else if ( ! object.isInstancedMesh && materialProperties.instancing === true ) {\n\n\t\t\t\tneedsProgramChange = true;\n\n\t\t\t} else if ( object.isSkinnedMesh && materialProperties.skinning === false ) {\n\n\t\t\t\tneedsProgramChange = true;\n\n\t\t\t} else if ( ! object.isSkinnedMesh && materialProperties.skinning === true ) {\n\n\t\t\t\tneedsProgramChange = true;\n\n\t\t\t} else if ( materialProperties.envMap !== envMap ) {\n\n\t\t\t\tneedsProgramChange = true;\n\n\t\t\t} else if ( material.fog === true && materialProperties.fog !== fog ) {\n\n\t\t\t\tneedsProgramChange = true;\n\n\t\t\t} else if ( materialProperties.numClippingPlanes !== undefined &&\n\t\t\t\t( materialProperties.numClippingPlanes !== clipping.numPlanes ||\n\t\t\t\tmaterialProperties.numIntersection !== clipping.numIntersection ) ) {\n\n\t\t\t\tneedsProgramChange = true;\n\n\t\t\t} else if ( materialProperties.vertexAlphas !== vertexAlphas ) {\n\n\t\t\t\tneedsProgramChange = true;\n\n\t\t\t} else if ( materialProperties.vertexTangents !== vertexTangents ) {\n\n\t\t\t\tneedsProgramChange = true;\n\n\t\t\t} else if ( materialProperties.morphTargets !== morphTargets ) {\n\n\t\t\t\tneedsProgramChange = true;\n\n\t\t\t} else if ( materialProperties.morphNormals !== morphNormals ) {\n\n\t\t\t\tneedsProgramChange = true;\n\n\t\t\t} else if ( materialProperties.morphColors !== morphColors ) {\n\n\t\t\t\tneedsProgramChange = true;\n\n\t\t\t} else if ( materialProperties.toneMapping !== toneMapping ) {\n\n\t\t\t\tneedsProgramChange = true;\n\n\t\t\t} else if ( capabilities.isWebGL2 === true && materialProperties.morphTargetsCount !== morphTargetsCount ) {\n\n\t\t\t\tneedsProgramChange = true;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tneedsProgramChange = true;\n\t\t\tmaterialProperties.__version = material.version;\n\n\t\t}\n\n\t\t//\n\n\t\tlet program = materialProperties.currentProgram;\n\n\t\tif ( needsProgramChange === true ) {\n\n\t\t\tprogram = getProgram( material, scene, object );\n\n\t\t}\n\n\t\tlet refreshProgram = false;\n\t\tlet refreshMaterial = false;\n\t\tlet refreshLights = false;\n\n\t\tconst p_uniforms = program.getUniforms(),\n\t\t\tm_uniforms = materialProperties.uniforms;\n\n\t\tif ( state.useProgram( program.program ) ) {\n\n\t\t\trefreshProgram = true;\n\t\t\trefreshMaterial = true;\n\t\t\trefreshLights = true;\n\n\t\t}\n\n\t\tif ( material.id !== _currentMaterialId ) {\n\n\t\t\t_currentMaterialId = material.id;\n\n\t\t\trefreshMaterial = true;\n\n\t\t}\n\n\t\tif ( refreshProgram || _currentCamera !== camera ) {\n\n\t\t\tp_uniforms.setValue( _gl, 'projectionMatrix', camera.projectionMatrix );\n\n\t\t\tif ( capabilities.logarithmicDepthBuffer ) {\n\n\t\t\t\tp_uniforms.setValue( _gl, 'logDepthBufFC',\n\t\t\t\t\t2.0 / ( Math.log( camera.far + 1.0 ) / Math.LN2 ) );\n\n\t\t\t}\n\n\t\t\tif ( _currentCamera !== camera ) {\n\n\t\t\t\t_currentCamera = camera;\n\n\t\t\t\t// lighting uniforms depend on the camera so enforce an update\n\t\t\t\t// now, in case this material supports lights - or later, when\n\t\t\t\t// the next material that does gets activated:\n\n\t\t\t\trefreshMaterial = true;\t\t// set to true on material change\n\t\t\t\trefreshLights = true;\t\t// remains set until update done\n\n\t\t\t}\n\n\t\t\t// load material specific uniforms\n\t\t\t// (shader material also gets them for the sake of genericity)\n\n\t\t\tif ( material.isShaderMaterial ||\n\t\t\t\tmaterial.isMeshPhongMaterial ||\n\t\t\t\tmaterial.isMeshToonMaterial ||\n\t\t\t\tmaterial.isMeshStandardMaterial ||\n\t\t\t\tmaterial.envMap ) {\n\n\t\t\t\tconst uCamPos = p_uniforms.map.cameraPosition;\n\n\t\t\t\tif ( uCamPos !== undefined ) {\n\n\t\t\t\t\tuCamPos.setValue( _gl,\n\t\t\t\t\t\t_vector3.setFromMatrixPosition( camera.matrixWorld ) );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( material.isMeshPhongMaterial ||\n\t\t\t\tmaterial.isMeshToonMaterial ||\n\t\t\t\tmaterial.isMeshLambertMaterial ||\n\t\t\t\tmaterial.isMeshBasicMaterial ||\n\t\t\t\tmaterial.isMeshStandardMaterial ||\n\t\t\t\tmaterial.isShaderMaterial ) {\n\n\t\t\t\tp_uniforms.setValue( _gl, 'isOrthographic', camera.isOrthographicCamera === true );\n\n\t\t\t}\n\n\t\t\tif ( material.isMeshPhongMaterial ||\n\t\t\t\tmaterial.isMeshToonMaterial ||\n\t\t\t\tmaterial.isMeshLambertMaterial ||\n\t\t\t\tmaterial.isMeshBasicMaterial ||\n\t\t\t\tmaterial.isMeshStandardMaterial ||\n\t\t\t\tmaterial.isShaderMaterial ||\n\t\t\t\tmaterial.isShadowMaterial ||\n\t\t\t\tobject.isSkinnedMesh ) {\n\n\t\t\t\tp_uniforms.setValue( _gl, 'viewMatrix', camera.matrixWorldInverse );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// skinning and morph target uniforms must be set even if material didn't change\n\t\t// auto-setting of texture unit for bone and morph texture must go before other textures\n\t\t// otherwise textures used for skinning and morphing can take over texture units reserved for other material textures\n\n\t\tif ( object.isSkinnedMesh ) {\n\n\t\t\tp_uniforms.setOptional( _gl, object, 'bindMatrix' );\n\t\t\tp_uniforms.setOptional( _gl, object, 'bindMatrixInverse' );\n\n\t\t\tconst skeleton = object.skeleton;\n\n\t\t\tif ( skeleton ) {\n\n\t\t\t\tif ( capabilities.floatVertexTextures ) {\n\n\t\t\t\t\tif ( skeleton.boneTexture === null ) skeleton.computeBoneTexture();\n\n\t\t\t\t\tp_uniforms.setValue( _gl, 'boneTexture', skeleton.boneTexture, textures );\n\t\t\t\t\tp_uniforms.setValue( _gl, 'boneTextureSize', skeleton.boneTextureSize );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required.' );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst morphAttributes = geometry.morphAttributes;\n\n\t\tif ( morphAttributes.position !== undefined || morphAttributes.normal !== undefined || ( morphAttributes.color !== undefined && capabilities.isWebGL2 === true ) ) {\n\n\t\t\tmorphtargets.update( object, geometry, material, program );\n\n\t\t}\n\n\t\tif ( refreshMaterial || materialProperties.receiveShadow !== object.receiveShadow ) {\n\n\t\t\tmaterialProperties.receiveShadow = object.receiveShadow;\n\t\t\tp_uniforms.setValue( _gl, 'receiveShadow', object.receiveShadow );\n\n\t\t}\n\n\t\t// https://github.com/mrdoob/three.js/pull/24467#issuecomment-1209031512\n\n\t\tif ( material.isMeshGouraudMaterial && material.envMap !== null ) {\n\n\t\t\tm_uniforms.envMap.value = envMap;\n\n\t\t\tm_uniforms.flipEnvMap.value = ( envMap.isCubeTexture && envMap.isRenderTargetTexture === false ) ? - 1 : 1;\n\n\t\t}\n\n\t\tif ( refreshMaterial ) {\n\n\t\t\tp_uniforms.setValue( _gl, 'toneMappingExposure', _this.toneMappingExposure );\n\n\t\t\tif ( materialProperties.needsLights ) {\n\n\t\t\t\t// the current material requires lighting info\n\n\t\t\t\t// note: all lighting uniforms are always set correctly\n\t\t\t\t// they simply reference the renderer's state for their\n\t\t\t\t// values\n\t\t\t\t//\n\t\t\t\t// use the current material's .needsUpdate flags to set\n\t\t\t\t// the GL state when required\n\n\t\t\t\tmarkUniformsLightsNeedsUpdate( m_uniforms, refreshLights );\n\n\t\t\t}\n\n\t\t\t// refresh uniforms common to several materials\n\n\t\t\tif ( fog && material.fog === true ) {\n\n\t\t\t\tmaterials.refreshFogUniforms( m_uniforms, fog );\n\n\t\t\t}\n\n\t\t\tmaterials.refreshMaterialUniforms( m_uniforms, material, _pixelRatio, _height, _transmissionRenderTarget );\n\n\t\t\tWebGLUniforms.upload( _gl, materialProperties.uniformsList, m_uniforms, textures );\n\n\t\t}\n\n\t\tif ( material.isShaderMaterial && material.uniformsNeedUpdate === true ) {\n\n\t\t\tWebGLUniforms.upload( _gl, materialProperties.uniformsList, m_uniforms, textures );\n\t\t\tmaterial.uniformsNeedUpdate = false;\n\n\t\t}\n\n\t\tif ( material.isSpriteMaterial ) {\n\n\t\t\tp_uniforms.setValue( _gl, 'center', object.center );\n\n\t\t}\n\n\t\t// common matrices\n\n\t\tp_uniforms.setValue( _gl, 'modelViewMatrix', object.modelViewMatrix );\n\t\tp_uniforms.setValue( _gl, 'normalMatrix', object.normalMatrix );\n\t\tp_uniforms.setValue( _gl, 'modelMatrix', object.matrixWorld );\n\n\t\t// UBOs\n\n\t\tif ( material.isShaderMaterial || material.isRawShaderMaterial ) {\n\n\t\t\tconst groups = material.uniformsGroups;\n\n\t\t\tfor ( let i = 0, l = groups.length; i < l; i ++ ) {\n\n\t\t\t\tif ( capabilities.isWebGL2 ) {\n\n\t\t\t\t\tconst group = groups[ i ];\n\n\t\t\t\t\tuniformsGroups.update( group, program );\n\t\t\t\t\tuniformsGroups.bind( group, program );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.' );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn program;\n\n\t}\n\n\t// If uniforms are marked as clean, they don't need to be loaded to the GPU.\n\n\tfunction markUniformsLightsNeedsUpdate( uniforms, value ) {\n\n\t\tuniforms.ambientLightColor.needsUpdate = value;\n\t\tuniforms.lightProbe.needsUpdate = value;\n\n\t\tuniforms.directionalLights.needsUpdate = value;\n\t\tuniforms.directionalLightShadows.needsUpdate = value;\n\t\tuniforms.pointLights.needsUpdate = value;\n\t\tuniforms.pointLightShadows.needsUpdate = value;\n\t\tuniforms.spotLights.needsUpdate = value;\n\t\tuniforms.spotLightShadows.needsUpdate = value;\n\t\tuniforms.rectAreaLights.needsUpdate = value;\n\t\tuniforms.hemisphereLights.needsUpdate = value;\n\n\t}\n\n\tfunction materialNeedsLights( material ) {\n\n\t\treturn material.isMeshLambertMaterial || material.isMeshToonMaterial || material.isMeshPhongMaterial ||\n\t\t\tmaterial.isMeshStandardMaterial || material.isShadowMaterial ||\n\t\t\t( material.isShaderMaterial && material.lights === true );\n\n\t}\n\n\tthis.getActiveCubeFace = function () {\n\n\t\treturn _currentActiveCubeFace;\n\n\t};\n\n\tthis.getActiveMipmapLevel = function () {\n\n\t\treturn _currentActiveMipmapLevel;\n\n\t};\n\n\tthis.getRenderTarget = function () {\n\n\t\treturn _currentRenderTarget;\n\n\t};\n\n\tthis.setRenderTargetTextures = function ( renderTarget, colorTexture, depthTexture ) {\n\n\t\tproperties.get( renderTarget.texture ).__webglTexture = colorTexture;\n\t\tproperties.get( renderTarget.depthTexture ).__webglTexture = depthTexture;\n\n\t\tconst renderTargetProperties = properties.get( renderTarget );\n\t\trenderTargetProperties.__hasExternalTextures = true;\n\n\t\tif ( renderTargetProperties.__hasExternalTextures ) {\n\n\t\t\trenderTargetProperties.__autoAllocateDepthBuffer = depthTexture === undefined;\n\n\t\t\tif ( ! renderTargetProperties.__autoAllocateDepthBuffer ) {\n\n\t\t\t\t// The multisample_render_to_texture extension doesn't work properly if there\n\t\t\t\t// are midframe flushes and an external depth buffer. Disable use of the extension.\n\t\t\t\tif ( extensions.has( 'WEBGL_multisampled_render_to_texture' ) === true ) {\n\n\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided' );\n\t\t\t\t\trenderTargetProperties.__useRenderToTexture = false;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t};\n\n\tthis.setRenderTargetFramebuffer = function ( renderTarget, defaultFramebuffer ) {\n\n\t\tconst renderTargetProperties = properties.get( renderTarget );\n\t\trenderTargetProperties.__webglFramebuffer = defaultFramebuffer;\n\t\trenderTargetProperties.__useDefaultFramebuffer = defaultFramebuffer === undefined;\n\n\t};\n\n\tthis.setRenderTarget = function ( renderTarget, activeCubeFace = 0, activeMipmapLevel = 0 ) {\n\n\t\t_currentRenderTarget = renderTarget;\n\t\t_currentActiveCubeFace = activeCubeFace;\n\t\t_currentActiveMipmapLevel = activeMipmapLevel;\n\n\t\tlet useDefaultFramebuffer = true;\n\t\tlet framebuffer = null;\n\t\tlet isCube = false;\n\t\tlet isRenderTarget3D = false;\n\n\t\tif ( renderTarget ) {\n\n\t\t\tconst renderTargetProperties = properties.get( renderTarget );\n\n\t\t\tif ( renderTargetProperties.__useDefaultFramebuffer !== undefined ) {\n\n\t\t\t\t// We need to make sure to rebind the framebuffer.\n\t\t\t\tstate.bindFramebuffer( 36160, null );\n\t\t\t\tuseDefaultFramebuffer = false;\n\n\t\t\t} else if ( renderTargetProperties.__webglFramebuffer === undefined ) {\n\n\t\t\t\ttextures.setupRenderTarget( renderTarget );\n\n\t\t\t} else if ( renderTargetProperties.__hasExternalTextures ) {\n\n\t\t\t\t// Color and depth texture must be rebound in order for the swapchain to update.\n\t\t\t\ttextures.rebindTextures( renderTarget, properties.get( renderTarget.texture ).__webglTexture, properties.get( renderTarget.depthTexture ).__webglTexture );\n\n\t\t\t}\n\n\t\t\tconst texture = renderTarget.texture;\n\n\t\t\tif ( texture.isData3DTexture || texture.isDataArrayTexture || texture.isCompressedArrayTexture ) {\n\n\t\t\t\tisRenderTarget3D = true;\n\n\t\t\t}\n\n\t\t\tconst __webglFramebuffer = properties.get( renderTarget ).__webglFramebuffer;\n\n\t\t\tif ( renderTarget.isWebGLCubeRenderTarget ) {\n\n\t\t\t\tframebuffer = __webglFramebuffer[ activeCubeFace ];\n\t\t\t\tisCube = true;\n\n\t\t\t} else if ( ( capabilities.isWebGL2 && renderTarget.samples > 0 ) && textures.useMultisampledRTT( renderTarget ) === false ) {\n\n\t\t\t\tframebuffer = properties.get( renderTarget ).__webglMultisampledFramebuffer;\n\n\t\t\t} else {\n\n\t\t\t\tframebuffer = __webglFramebuffer;\n\n\t\t\t}\n\n\t\t\t_currentViewport.copy( renderTarget.viewport );\n\t\t\t_currentScissor.copy( renderTarget.scissor );\n\t\t\t_currentScissorTest = renderTarget.scissorTest;\n\n\t\t} else {\n\n\t\t\t_currentViewport.copy( _viewport ).multiplyScalar( _pixelRatio ).floor();\n\t\t\t_currentScissor.copy( _scissor ).multiplyScalar( _pixelRatio ).floor();\n\t\t\t_currentScissorTest = _scissorTest;\n\n\t\t}\n\n\t\tconst framebufferBound = state.bindFramebuffer( 36160, framebuffer );\n\n\t\tif ( framebufferBound && capabilities.drawBuffers && useDefaultFramebuffer ) {\n\n\t\t\tstate.drawBuffers( renderTarget, framebuffer );\n\n\t\t}\n\n\t\tstate.viewport( _currentViewport );\n\t\tstate.scissor( _currentScissor );\n\t\tstate.setScissorTest( _currentScissorTest );\n\n\t\tif ( isCube ) {\n\n\t\t\tconst textureProperties = properties.get( renderTarget.texture );\n\t\t\t_gl.framebufferTexture2D( 36160, 36064, 34069 + activeCubeFace, textureProperties.__webglTexture, activeMipmapLevel );\n\n\t\t} else if ( isRenderTarget3D ) {\n\n\t\t\tconst textureProperties = properties.get( renderTarget.texture );\n\t\t\tconst layer = activeCubeFace || 0;\n\t\t\t_gl.framebufferTextureLayer( 36160, 36064, textureProperties.__webglTexture, activeMipmapLevel || 0, layer );\n\n\t\t}\n\n\t\t_currentMaterialId = - 1; // reset current material to ensure correct uniform bindings\n\n\t};\n\n\tthis.readRenderTargetPixels = function ( renderTarget, x, y, width, height, buffer, activeCubeFaceIndex ) {\n\n\t\tif ( ! ( renderTarget && renderTarget.isWebGLRenderTarget ) ) {\n\n\t\t\tconsole.error( 'THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tlet framebuffer = properties.get( renderTarget ).__webglFramebuffer;\n\n\t\tif ( renderTarget.isWebGLCubeRenderTarget && activeCubeFaceIndex !== undefined ) {\n\n\t\t\tframebuffer = framebuffer[ activeCubeFaceIndex ];\n\n\t\t}\n\n\t\tif ( framebuffer ) {\n\n\t\t\tstate.bindFramebuffer( 36160, framebuffer );\n\n\t\t\ttry {\n\n\t\t\t\tconst texture = renderTarget.texture;\n\t\t\t\tconst textureFormat = texture.format;\n\t\t\t\tconst textureType = texture.type;\n\n\t\t\t\tif ( textureFormat !== RGBAFormat && utils.convert( textureFormat ) !== _gl.getParameter( 35739 ) ) {\n\n\t\t\t\t\tconsole.error( 'THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.' );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\tconst halfFloatSupportedByExt = ( textureType === HalfFloatType ) && ( extensions.has( 'EXT_color_buffer_half_float' ) || ( capabilities.isWebGL2 && extensions.has( 'EXT_color_buffer_float' ) ) );\n\n\t\t\t\tif ( textureType !== UnsignedByteType && utils.convert( textureType ) !== _gl.getParameter( 35738 ) && // Edge and Chrome Mac < 52 (#9513)\n\t\t\t\t\t! ( textureType === FloatType && ( capabilities.isWebGL2 || extensions.has( 'OES_texture_float' ) || extensions.has( 'WEBGL_color_buffer_float' ) ) ) && // Chrome Mac >= 52 and Firefox\n\t\t\t\t\t! halfFloatSupportedByExt ) {\n\n\t\t\t\t\tconsole.error( 'THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.' );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\t// the following if statement ensures valid read requests (no out-of-bounds pixels, see #8604)\n\n\t\t\t\tif ( ( x >= 0 && x <= ( renderTarget.width - width ) ) && ( y >= 0 && y <= ( renderTarget.height - height ) ) ) {\n\n\t\t\t\t\t_gl.readPixels( x, y, width, height, utils.convert( textureFormat ), utils.convert( textureType ), buffer );\n\n\t\t\t\t}\n\n\t\t\t} finally {\n\n\t\t\t\t// restore framebuffer of current render target if necessary\n\n\t\t\t\tconst framebuffer = ( _currentRenderTarget !== null ) ? properties.get( _currentRenderTarget ).__webglFramebuffer : null;\n\t\t\t\tstate.bindFramebuffer( 36160, framebuffer );\n\n\t\t\t}\n\n\t\t}\n\n\t};\n\n\tthis.copyFramebufferToTexture = function ( position, texture, level = 0 ) {\n\n\t\tconst levelScale = Math.pow( 2, - level );\n\t\tconst width = Math.floor( texture.image.width * levelScale );\n\t\tconst height = Math.floor( texture.image.height * levelScale );\n\n\t\ttextures.setTexture2D( texture, 0 );\n\n\t\t_gl.copyTexSubImage2D( 3553, level, 0, 0, position.x, position.y, width, height );\n\n\t\tstate.unbindTexture();\n\n\t};\n\n\tthis.copyTextureToTexture = function ( position, srcTexture, dstTexture, level = 0 ) {\n\n\t\tconst width = srcTexture.image.width;\n\t\tconst height = srcTexture.image.height;\n\t\tconst glFormat = utils.convert( dstTexture.format );\n\t\tconst glType = utils.convert( dstTexture.type );\n\n\t\ttextures.setTexture2D( dstTexture, 0 );\n\n\t\t// As another texture upload may have changed pixelStorei\n\t\t// parameters, make sure they are correct for the dstTexture\n\t\t_gl.pixelStorei( 37440, dstTexture.flipY );\n\t\t_gl.pixelStorei( 37441, dstTexture.premultiplyAlpha );\n\t\t_gl.pixelStorei( 3317, dstTexture.unpackAlignment );\n\n\t\tif ( srcTexture.isDataTexture ) {\n\n\t\t\t_gl.texSubImage2D( 3553, level, position.x, position.y, width, height, glFormat, glType, srcTexture.image.data );\n\n\t\t} else {\n\n\t\t\tif ( srcTexture.isCompressedTexture ) {\n\n\t\t\t\t_gl.compressedTexSubImage2D( 3553, level, position.x, position.y, srcTexture.mipmaps[ 0 ].width, srcTexture.mipmaps[ 0 ].height, glFormat, srcTexture.mipmaps[ 0 ].data );\n\n\t\t\t} else {\n\n\t\t\t\t_gl.texSubImage2D( 3553, level, position.x, position.y, glFormat, glType, srcTexture.image );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Generate mipmaps only when copying level 0\n\t\tif ( level === 0 && dstTexture.generateMipmaps ) _gl.generateMipmap( 3553 );\n\n\t\tstate.unbindTexture();\n\n\t};\n\n\tthis.copyTextureToTexture3D = function ( sourceBox, position, srcTexture, dstTexture, level = 0 ) {\n\n\t\tif ( _this.isWebGL1Renderer ) {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tconst width = sourceBox.max.x - sourceBox.min.x + 1;\n\t\tconst height = sourceBox.max.y - sourceBox.min.y + 1;\n\t\tconst depth = sourceBox.max.z - sourceBox.min.z + 1;\n\t\tconst glFormat = utils.convert( dstTexture.format );\n\t\tconst glType = utils.convert( dstTexture.type );\n\t\tlet glTarget;\n\n\t\tif ( dstTexture.isData3DTexture ) {\n\n\t\t\ttextures.setTexture3D( dstTexture, 0 );\n\t\t\tglTarget = 32879;\n\n\t\t} else if ( dstTexture.isDataArrayTexture ) {\n\n\t\t\ttextures.setTexture2DArray( dstTexture, 0 );\n\t\t\tglTarget = 35866;\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\t_gl.pixelStorei( 37440, dstTexture.flipY );\n\t\t_gl.pixelStorei( 37441, dstTexture.premultiplyAlpha );\n\t\t_gl.pixelStorei( 3317, dstTexture.unpackAlignment );\n\n\t\tconst unpackRowLen = _gl.getParameter( 3314 );\n\t\tconst unpackImageHeight = _gl.getParameter( 32878 );\n\t\tconst unpackSkipPixels = _gl.getParameter( 3316 );\n\t\tconst unpackSkipRows = _gl.getParameter( 3315 );\n\t\tconst unpackSkipImages = _gl.getParameter( 32877 );\n\n\t\tconst image = srcTexture.isCompressedTexture ? srcTexture.mipmaps[ 0 ] : srcTexture.image;\n\n\t\t_gl.pixelStorei( 3314, image.width );\n\t\t_gl.pixelStorei( 32878, image.height );\n\t\t_gl.pixelStorei( 3316, sourceBox.min.x );\n\t\t_gl.pixelStorei( 3315, sourceBox.min.y );\n\t\t_gl.pixelStorei( 32877, sourceBox.min.z );\n\n\t\tif ( srcTexture.isDataTexture || srcTexture.isData3DTexture ) {\n\n\t\t\t_gl.texSubImage3D( glTarget, level, position.x, position.y, position.z, width, height, depth, glFormat, glType, image.data );\n\n\t\t} else {\n\n\t\t\tif ( srcTexture.isCompressedArrayTexture ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture.' );\n\t\t\t\t_gl.compressedTexSubImage3D( glTarget, level, position.x, position.y, position.z, width, height, depth, glFormat, image.data );\n\n\t\t\t} else {\n\n\t\t\t\t_gl.texSubImage3D( glTarget, level, position.x, position.y, position.z, width, height, depth, glFormat, glType, image );\n\n\t\t\t}\n\n\t\t}\n\n\t\t_gl.pixelStorei( 3314, unpackRowLen );\n\t\t_gl.pixelStorei( 32878, unpackImageHeight );\n\t\t_gl.pixelStorei( 3316, unpackSkipPixels );\n\t\t_gl.pixelStorei( 3315, unpackSkipRows );\n\t\t_gl.pixelStorei( 32877, unpackSkipImages );\n\n\t\t// Generate mipmaps only when copying level 0\n\t\tif ( level === 0 && dstTexture.generateMipmaps ) _gl.generateMipmap( glTarget );\n\n\t\tstate.unbindTexture();\n\n\t};\n\n\tthis.initTexture = function ( texture ) {\n\n\t\tif ( texture.isCubeTexture ) {\n\n\t\t\ttextures.setTextureCube( texture, 0 );\n\n\t\t} else if ( texture.isData3DTexture ) {\n\n\t\t\ttextures.setTexture3D( texture, 0 );\n\n\t\t} else if ( texture.isDataArrayTexture || texture.isCompressedArrayTexture ) {\n\n\t\t\ttextures.setTexture2DArray( texture, 0 );\n\n\t\t} else {\n\n\t\t\ttextures.setTexture2D( texture, 0 );\n\n\t\t}\n\n\t\tstate.unbindTexture();\n\n\t};\n\n\tthis.resetState = function () {\n\n\t\t_currentActiveCubeFace = 0;\n\t\t_currentActiveMipmapLevel = 0;\n\t\t_currentRenderTarget = null;\n\n\t\tstate.reset();\n\t\tbindingStates.reset();\n\n\t};\n\n\tif ( typeof __THREE_DEVTOOLS__ !== 'undefined' ) {\n\n\t\t__THREE_DEVTOOLS__.dispatchEvent( new CustomEvent( 'observe', { detail: this } ) );\n\n\t}\n\n}\n\nclass WebGL1Renderer extends WebGLRenderer {}\n\nWebGL1Renderer.prototype.isWebGL1Renderer = true;\n\nclass FogExp2 {\n\n\tconstructor( color, density = 0.00025 ) {\n\n\t\tthis.isFogExp2 = true;\n\n\t\tthis.name = '';\n\n\t\tthis.color = new Color( color );\n\t\tthis.density = density;\n\n\t}\n\n\tclone() {\n\n\t\treturn new FogExp2( this.color, this.density );\n\n\t}\n\n\ttoJSON( /* meta */ ) {\n\n\t\treturn {\n\t\t\ttype: 'FogExp2',\n\t\t\tcolor: this.color.getHex(),\n\t\t\tdensity: this.density\n\t\t};\n\n\t}\n\n}\n\nclass Fog {\n\n\tconstructor( color, near = 1, far = 1000 ) {\n\n\t\tthis.isFog = true;\n\n\t\tthis.name = '';\n\n\t\tthis.color = new Color( color );\n\n\t\tthis.near = near;\n\t\tthis.far = far;\n\n\t}\n\n\tclone() {\n\n\t\treturn new Fog( this.color, this.near, this.far );\n\n\t}\n\n\ttoJSON( /* meta */ ) {\n\n\t\treturn {\n\t\t\ttype: 'Fog',\n\t\t\tcolor: this.color.getHex(),\n\t\t\tnear: this.near,\n\t\t\tfar: this.far\n\t\t};\n\n\t}\n\n}\n\nclass Scene extends Object3D {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.isScene = true;\n\n\t\tthis.type = 'Scene';\n\n\t\tthis.background = null;\n\t\tthis.environment = null;\n\t\tthis.fog = null;\n\n\t\tthis.backgroundBlurriness = 0;\n\t\tthis.backgroundIntensity = 1;\n\n\t\tthis.overrideMaterial = null;\n\n\t\tif ( typeof __THREE_DEVTOOLS__ !== 'undefined' ) {\n\n\t\t\t__THREE_DEVTOOLS__.dispatchEvent( new CustomEvent( 'observe', { detail: this } ) );\n\n\t\t}\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tif ( source.background !== null ) this.background = source.background.clone();\n\t\tif ( source.environment !== null ) this.environment = source.environment.clone();\n\t\tif ( source.fog !== null ) this.fog = source.fog.clone();\n\n\t\tthis.backgroundBlurriness = source.backgroundBlurriness;\n\t\tthis.backgroundIntensity = source.backgroundIntensity;\n\n\t\tif ( source.overrideMaterial !== null ) this.overrideMaterial = source.overrideMaterial.clone();\n\n\t\tthis.matrixAutoUpdate = source.matrixAutoUpdate;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst data = super.toJSON( meta );\n\n\t\tif ( this.fog !== null ) data.object.fog = this.fog.toJSON();\n\t\tif ( this.backgroundBlurriness > 0 ) data.backgroundBlurriness = this.backgroundBlurriness;\n\t\tif ( this.backgroundIntensity !== 1 ) data.backgroundIntensity = this.backgroundIntensity;\n\n\t\treturn data;\n\n\t}\n\n\t// @deprecated\n\n\tget autoUpdate() {\n\n\t\tconsole.warn( 'THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144.' );\n\t\treturn this.matrixWorldAutoUpdate;\n\n\t}\n\n\tset autoUpdate( value ) {\n\n\t\tconsole.warn( 'THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144.' );\n\t\tthis.matrixWorldAutoUpdate = value;\n\n\t}\n\n}\n\nclass InterleavedBuffer {\n\n\tconstructor( array, stride ) {\n\n\t\tthis.isInterleavedBuffer = true;\n\n\t\tthis.array = array;\n\t\tthis.stride = stride;\n\t\tthis.count = array !== undefined ? array.length / stride : 0;\n\n\t\tthis.usage = StaticDrawUsage;\n\t\tthis.updateRange = { offset: 0, count: - 1 };\n\n\t\tthis.version = 0;\n\n\t\tthis.uuid = generateUUID();\n\n\t}\n\n\tonUploadCallback() {}\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) this.version ++;\n\n\t}\n\n\tsetUsage( value ) {\n\n\t\tthis.usage = value;\n\n\t\treturn this;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.array = new source.array.constructor( source.array );\n\t\tthis.count = source.count;\n\t\tthis.stride = source.stride;\n\t\tthis.usage = source.usage;\n\n\t\treturn this;\n\n\t}\n\n\tcopyAt( index1, attribute, index2 ) {\n\n\t\tindex1 *= this.stride;\n\t\tindex2 *= attribute.stride;\n\n\t\tfor ( let i = 0, l = this.stride; i < l; i ++ ) {\n\n\t\t\tthis.array[ index1 + i ] = attribute.array[ index2 + i ];\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tset( value, offset = 0 ) {\n\n\t\tthis.array.set( value, offset );\n\n\t\treturn this;\n\n\t}\n\n\tclone( data ) {\n\n\t\tif ( data.arrayBuffers === undefined ) {\n\n\t\t\tdata.arrayBuffers = {};\n\n\t\t}\n\n\t\tif ( this.array.buffer._uuid === undefined ) {\n\n\t\t\tthis.array.buffer._uuid = generateUUID();\n\n\t\t}\n\n\t\tif ( data.arrayBuffers[ this.array.buffer._uuid ] === undefined ) {\n\n\t\t\tdata.arrayBuffers[ this.array.buffer._uuid ] = this.array.slice( 0 ).buffer;\n\n\t\t}\n\n\t\tconst array = new this.array.constructor( data.arrayBuffers[ this.array.buffer._uuid ] );\n\n\t\tconst ib = new this.constructor( array, this.stride );\n\t\tib.setUsage( this.usage );\n\n\t\treturn ib;\n\n\t}\n\n\tonUpload( callback ) {\n\n\t\tthis.onUploadCallback = callback;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON( data ) {\n\n\t\tif ( data.arrayBuffers === undefined ) {\n\n\t\t\tdata.arrayBuffers = {};\n\n\t\t}\n\n\t\t// generate UUID for array buffer if necessary\n\n\t\tif ( this.array.buffer._uuid === undefined ) {\n\n\t\t\tthis.array.buffer._uuid = generateUUID();\n\n\t\t}\n\n\t\tif ( data.arrayBuffers[ this.array.buffer._uuid ] === undefined ) {\n\n\t\t\tdata.arrayBuffers[ this.array.buffer._uuid ] = Array.from( new Uint32Array( this.array.buffer ) );\n\n\t\t}\n\n\t\t//\n\n\t\treturn {\n\t\t\tuuid: this.uuid,\n\t\t\tbuffer: this.array.buffer._uuid,\n\t\t\ttype: this.array.constructor.name,\n\t\t\tstride: this.stride\n\t\t};\n\n\t}\n\n}\n\nconst _vector$6 = /*@__PURE__*/ new Vector3();\n\nclass InterleavedBufferAttribute {\n\n\tconstructor( interleavedBuffer, itemSize, offset, normalized = false ) {\n\n\t\tthis.isInterleavedBufferAttribute = true;\n\n\t\tthis.name = '';\n\n\t\tthis.data = interleavedBuffer;\n\t\tthis.itemSize = itemSize;\n\t\tthis.offset = offset;\n\n\t\tthis.normalized = normalized;\n\n\t}\n\n\tget count() {\n\n\t\treturn this.data.count;\n\n\t}\n\n\tget array() {\n\n\t\treturn this.data.array;\n\n\t}\n\n\tset needsUpdate( value ) {\n\n\t\tthis.data.needsUpdate = value;\n\n\t}\n\n\tapplyMatrix4( m ) {\n\n\t\tfor ( let i = 0, l = this.data.count; i < l; i ++ ) {\n\n\t\t\t_vector$6.fromBufferAttribute( this, i );\n\n\t\t\t_vector$6.applyMatrix4( m );\n\n\t\t\tthis.setXYZ( i, _vector$6.x, _vector$6.y, _vector$6.z );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tapplyNormalMatrix( m ) {\n\n\t\tfor ( let i = 0, l = this.count; i < l; i ++ ) {\n\n\t\t\t_vector$6.fromBufferAttribute( this, i );\n\n\t\t\t_vector$6.applyNormalMatrix( m );\n\n\t\t\tthis.setXYZ( i, _vector$6.x, _vector$6.y, _vector$6.z );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\ttransformDirection( m ) {\n\n\t\tfor ( let i = 0, l = this.count; i < l; i ++ ) {\n\n\t\t\t_vector$6.fromBufferAttribute( this, i );\n\n\t\t\t_vector$6.transformDirection( m );\n\n\t\t\tthis.setXYZ( i, _vector$6.x, _vector$6.y, _vector$6.z );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetX( index, x ) {\n\n\t\tif ( this.normalized ) x = normalize( x, this.array );\n\n\t\tthis.data.array[ index * this.data.stride + this.offset ] = x;\n\n\t\treturn this;\n\n\t}\n\n\tsetY( index, y ) {\n\n\t\tif ( this.normalized ) y = normalize( y, this.array );\n\n\t\tthis.data.array[ index * this.data.stride + this.offset + 1 ] = y;\n\n\t\treturn this;\n\n\t}\n\n\tsetZ( index, z ) {\n\n\t\tif ( this.normalized ) z = normalize( z, this.array );\n\n\t\tthis.data.array[ index * this.data.stride + this.offset + 2 ] = z;\n\n\t\treturn this;\n\n\t}\n\n\tsetW( index, w ) {\n\n\t\tif ( this.normalized ) w = normalize( w, this.array );\n\n\t\tthis.data.array[ index * this.data.stride + this.offset + 3 ] = w;\n\n\t\treturn this;\n\n\t}\n\n\tgetX( index ) {\n\n\t\tlet x = this.data.array[ index * this.data.stride + this.offset ];\n\n\t\tif ( this.normalized ) x = denormalize( x, this.array );\n\n\t\treturn x;\n\n\t}\n\n\tgetY( index ) {\n\n\t\tlet y = this.data.array[ index * this.data.stride + this.offset + 1 ];\n\n\t\tif ( this.normalized ) y = denormalize( y, this.array );\n\n\t\treturn y;\n\n\t}\n\n\tgetZ( index ) {\n\n\t\tlet z = this.data.array[ index * this.data.stride + this.offset + 2 ];\n\n\t\tif ( this.normalized ) z = denormalize( z, this.array );\n\n\t\treturn z;\n\n\t}\n\n\tgetW( index ) {\n\n\t\tlet w = this.data.array[ index * this.data.stride + this.offset + 3 ];\n\n\t\tif ( this.normalized ) w = denormalize( w, this.array );\n\n\t\treturn w;\n\n\t}\n\n\tsetXY( index, x, y ) {\n\n\t\tindex = index * this.data.stride + this.offset;\n\n\t\tif ( this.normalized ) {\n\n\t\t\tx = normalize( x, this.array );\n\t\t\ty = normalize( y, this.array );\n\n\t\t}\n\n\t\tthis.data.array[ index + 0 ] = x;\n\t\tthis.data.array[ index + 1 ] = y;\n\n\t\treturn this;\n\n\t}\n\n\tsetXYZ( index, x, y, z ) {\n\n\t\tindex = index * this.data.stride + this.offset;\n\n\t\tif ( this.normalized ) {\n\n\t\t\tx = normalize( x, this.array );\n\t\t\ty = normalize( y, this.array );\n\t\t\tz = normalize( z, this.array );\n\n\t\t}\n\n\t\tthis.data.array[ index + 0 ] = x;\n\t\tthis.data.array[ index + 1 ] = y;\n\t\tthis.data.array[ index + 2 ] = z;\n\n\t\treturn this;\n\n\t}\n\n\tsetXYZW( index, x, y, z, w ) {\n\n\t\tindex = index * this.data.stride + this.offset;\n\n\t\tif ( this.normalized ) {\n\n\t\t\tx = normalize( x, this.array );\n\t\t\ty = normalize( y, this.array );\n\t\t\tz = normalize( z, this.array );\n\t\t\tw = normalize( w, this.array );\n\n\t\t}\n\n\t\tthis.data.array[ index + 0 ] = x;\n\t\tthis.data.array[ index + 1 ] = y;\n\t\tthis.data.array[ index + 2 ] = z;\n\t\tthis.data.array[ index + 3 ] = w;\n\n\t\treturn this;\n\n\t}\n\n\tclone( data ) {\n\n\t\tif ( data === undefined ) {\n\n\t\t\tconsole.log( 'THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.' );\n\n\t\t\tconst array = [];\n\n\t\t\tfor ( let i = 0; i < this.count; i ++ ) {\n\n\t\t\t\tconst index = i * this.data.stride + this.offset;\n\n\t\t\t\tfor ( let j = 0; j < this.itemSize; j ++ ) {\n\n\t\t\t\t\tarray.push( this.data.array[ index + j ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn new BufferAttribute( new this.array.constructor( array ), this.itemSize, this.normalized );\n\n\t\t} else {\n\n\t\t\tif ( data.interleavedBuffers === undefined ) {\n\n\t\t\t\tdata.interleavedBuffers = {};\n\n\t\t\t}\n\n\t\t\tif ( data.interleavedBuffers[ this.data.uuid ] === undefined ) {\n\n\t\t\t\tdata.interleavedBuffers[ this.data.uuid ] = this.data.clone( data );\n\n\t\t\t}\n\n\t\t\treturn new InterleavedBufferAttribute( data.interleavedBuffers[ this.data.uuid ], this.itemSize, this.offset, this.normalized );\n\n\t\t}\n\n\t}\n\n\ttoJSON( data ) {\n\n\t\tif ( data === undefined ) {\n\n\t\t\tconsole.log( 'THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.' );\n\n\t\t\tconst array = [];\n\n\t\t\tfor ( let i = 0; i < this.count; i ++ ) {\n\n\t\t\t\tconst index = i * this.data.stride + this.offset;\n\n\t\t\t\tfor ( let j = 0; j < this.itemSize; j ++ ) {\n\n\t\t\t\t\tarray.push( this.data.array[ index + j ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// de-interleave data and save it as an ordinary buffer attribute for now\n\n\t\t\treturn {\n\t\t\t\titemSize: this.itemSize,\n\t\t\t\ttype: this.array.constructor.name,\n\t\t\t\tarray: array,\n\t\t\t\tnormalized: this.normalized\n\t\t\t};\n\n\t\t} else {\n\n\t\t\t// save as true interleaved attribute\n\n\t\t\tif ( data.interleavedBuffers === undefined ) {\n\n\t\t\t\tdata.interleavedBuffers = {};\n\n\t\t\t}\n\n\t\t\tif ( data.interleavedBuffers[ this.data.uuid ] === undefined ) {\n\n\t\t\t\tdata.interleavedBuffers[ this.data.uuid ] = this.data.toJSON( data );\n\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tisInterleavedBufferAttribute: true,\n\t\t\t\titemSize: this.itemSize,\n\t\t\t\tdata: this.data.uuid,\n\t\t\t\toffset: this.offset,\n\t\t\t\tnormalized: this.normalized\n\t\t\t};\n\n\t\t}\n\n\t}\n\n}\n\nclass SpriteMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isSpriteMaterial = true;\n\n\t\tthis.type = 'SpriteMaterial';\n\n\t\tthis.color = new Color( 0xffffff );\n\n\t\tthis.map = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.rotation = 0;\n\n\t\tthis.sizeAttenuation = true;\n\n\t\tthis.transparent = true;\n\n\t\tthis.fog = true;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\n\t\tthis.map = source.map;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.rotation = source.rotation;\n\n\t\tthis.sizeAttenuation = source.sizeAttenuation;\n\n\t\tthis.fog = source.fog;\n\n\t\treturn this;\n\n\t}\n\n}\n\nlet _geometry;\n\nconst _intersectPoint = /*@__PURE__*/ new Vector3();\nconst _worldScale = /*@__PURE__*/ new Vector3();\nconst _mvPosition = /*@__PURE__*/ new Vector3();\n\nconst _alignedPosition = /*@__PURE__*/ new Vector2();\nconst _rotatedPosition = /*@__PURE__*/ new Vector2();\nconst _viewWorldMatrix = /*@__PURE__*/ new Matrix4();\n\nconst _vA = /*@__PURE__*/ new Vector3();\nconst _vB = /*@__PURE__*/ new Vector3();\nconst _vC = /*@__PURE__*/ new Vector3();\n\nconst _uvA = /*@__PURE__*/ new Vector2();\nconst _uvB = /*@__PURE__*/ new Vector2();\nconst _uvC = /*@__PURE__*/ new Vector2();\n\nclass Sprite extends Object3D {\n\n\tconstructor( material ) {\n\n\t\tsuper();\n\n\t\tthis.isSprite = true;\n\n\t\tthis.type = 'Sprite';\n\n\t\tif ( _geometry === undefined ) {\n\n\t\t\t_geometry = new BufferGeometry();\n\n\t\t\tconst float32Array = new Float32Array( [\n\t\t\t\t- 0.5, - 0.5, 0, 0, 0,\n\t\t\t\t0.5, - 0.5, 0, 1, 0,\n\t\t\t\t0.5, 0.5, 0, 1, 1,\n\t\t\t\t- 0.5, 0.5, 0, 0, 1\n\t\t\t] );\n\n\t\t\tconst interleavedBuffer = new InterleavedBuffer( float32Array, 5 );\n\n\t\t\t_geometry.setIndex( [ 0, 1, 2,\t0, 2, 3 ] );\n\t\t\t_geometry.setAttribute( 'position', new InterleavedBufferAttribute( interleavedBuffer, 3, 0, false ) );\n\t\t\t_geometry.setAttribute( 'uv', new InterleavedBufferAttribute( interleavedBuffer, 2, 3, false ) );\n\n\t\t}\n\n\t\tthis.geometry = _geometry;\n\t\tthis.material = ( material !== undefined ) ? material : new SpriteMaterial();\n\n\t\tthis.center = new Vector2( 0.5, 0.5 );\n\n\t}\n\n\traycast( raycaster, intersects ) {\n\n\t\tif ( raycaster.camera === null ) {\n\n\t\t\tconsole.error( 'THREE.Sprite: \"Raycaster.camera\" needs to be set in order to raycast against sprites.' );\n\n\t\t}\n\n\t\t_worldScale.setFromMatrixScale( this.matrixWorld );\n\n\t\t_viewWorldMatrix.copy( raycaster.camera.matrixWorld );\n\t\tthis.modelViewMatrix.multiplyMatrices( raycaster.camera.matrixWorldInverse, this.matrixWorld );\n\n\t\t_mvPosition.setFromMatrixPosition( this.modelViewMatrix );\n\n\t\tif ( raycaster.camera.isPerspectiveCamera && this.material.sizeAttenuation === false ) {\n\n\t\t\t_worldScale.multiplyScalar( - _mvPosition.z );\n\n\t\t}\n\n\t\tconst rotation = this.material.rotation;\n\t\tlet sin, cos;\n\n\t\tif ( rotation !== 0 ) {\n\n\t\t\tcos = Math.cos( rotation );\n\t\t\tsin = Math.sin( rotation );\n\n\t\t}\n\n\t\tconst center = this.center;\n\n\t\ttransformVertex( _vA.set( - 0.5, - 0.5, 0 ), _mvPosition, center, _worldScale, sin, cos );\n\t\ttransformVertex( _vB.set( 0.5, - 0.5, 0 ), _mvPosition, center, _worldScale, sin, cos );\n\t\ttransformVertex( _vC.set( 0.5, 0.5, 0 ), _mvPosition, center, _worldScale, sin, cos );\n\n\t\t_uvA.set( 0, 0 );\n\t\t_uvB.set( 1, 0 );\n\t\t_uvC.set( 1, 1 );\n\n\t\t// check first triangle\n\t\tlet intersect = raycaster.ray.intersectTriangle( _vA, _vB, _vC, false, _intersectPoint );\n\n\t\tif ( intersect === null ) {\n\n\t\t\t// check second triangle\n\t\t\ttransformVertex( _vB.set( - 0.5, 0.5, 0 ), _mvPosition, center, _worldScale, sin, cos );\n\t\t\t_uvB.set( 0, 1 );\n\n\t\t\tintersect = raycaster.ray.intersectTriangle( _vA, _vC, _vB, false, _intersectPoint );\n\t\t\tif ( intersect === null ) {\n\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst distance = raycaster.ray.origin.distanceTo( _intersectPoint );\n\n\t\tif ( distance < raycaster.near || distance > raycaster.far ) return;\n\n\t\tintersects.push( {\n\n\t\t\tdistance: distance,\n\t\t\tpoint: _intersectPoint.clone(),\n\t\t\tuv: Triangle.getUV( _intersectPoint, _vA, _vB, _vC, _uvA, _uvB, _uvC, new Vector2() ),\n\t\t\tface: null,\n\t\t\tobject: this\n\n\t\t} );\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tif ( source.center !== undefined ) this.center.copy( source.center );\n\n\t\tthis.material = source.material;\n\n\t\treturn this;\n\n\t}\n\n}\n\nfunction transformVertex( vertexPosition, mvPosition, center, scale, sin, cos ) {\n\n\t// compute position in camera space\n\t_alignedPosition.subVectors( vertexPosition, center ).addScalar( 0.5 ).multiply( scale );\n\n\t// to check if rotation is not zero\n\tif ( sin !== undefined ) {\n\n\t\t_rotatedPosition.x = ( cos * _alignedPosition.x ) - ( sin * _alignedPosition.y );\n\t\t_rotatedPosition.y = ( sin * _alignedPosition.x ) + ( cos * _alignedPosition.y );\n\n\t} else {\n\n\t\t_rotatedPosition.copy( _alignedPosition );\n\n\t}\n\n\n\tvertexPosition.copy( mvPosition );\n\tvertexPosition.x += _rotatedPosition.x;\n\tvertexPosition.y += _rotatedPosition.y;\n\n\t// transform to world space\n\tvertexPosition.applyMatrix4( _viewWorldMatrix );\n\n}\n\nconst _v1$2 = /*@__PURE__*/ new Vector3();\nconst _v2$1 = /*@__PURE__*/ new Vector3();\n\nclass LOD extends Object3D {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis._currentLevel = 0;\n\n\t\tthis.type = 'LOD';\n\n\t\tObject.defineProperties( this, {\n\t\t\tlevels: {\n\t\t\t\tenumerable: true,\n\t\t\t\tvalue: []\n\t\t\t},\n\t\t\tisLOD: {\n\t\t\t\tvalue: true,\n\t\t\t}\n\t\t} );\n\n\t\tthis.autoUpdate = true;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source, false );\n\n\t\tconst levels = source.levels;\n\n\t\tfor ( let i = 0, l = levels.length; i < l; i ++ ) {\n\n\t\t\tconst level = levels[ i ];\n\n\t\t\tthis.addLevel( level.object.clone(), level.distance, level.hysteresis );\n\n\t\t}\n\n\t\tthis.autoUpdate = source.autoUpdate;\n\n\t\treturn this;\n\n\t}\n\n\taddLevel( object, distance = 0, hysteresis = 0 ) {\n\n\t\tdistance = Math.abs( distance );\n\n\t\tconst levels = this.levels;\n\n\t\tlet l;\n\n\t\tfor ( l = 0; l < levels.length; l ++ ) {\n\n\t\t\tif ( distance < levels[ l ].distance ) {\n\n\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\tlevels.splice( l, 0, { distance: distance, hysteresis: hysteresis, object: object } );\n\n\t\tthis.add( object );\n\n\t\treturn this;\n\n\t}\n\n\tgetCurrentLevel() {\n\n\t\treturn this._currentLevel;\n\n\t}\n\n\n\n\tgetObjectForDistance( distance ) {\n\n\t\tconst levels = this.levels;\n\n\t\tif ( levels.length > 0 ) {\n\n\t\t\tlet i, l;\n\n\t\t\tfor ( i = 1, l = levels.length; i < l; i ++ ) {\n\n\t\t\t\tlet levelDistance = levels[ i ].distance;\n\n\t\t\t\tif ( levels[ i ].object.visible ) {\n\n\t\t\t\t\tlevelDistance -= levelDistance * levels[ i ].hysteresis;\n\n\t\t\t\t}\n\n\t\t\t\tif ( distance < levelDistance ) {\n\n\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn levels[ i - 1 ].object;\n\n\t\t}\n\n\t\treturn null;\n\n\t}\n\n\traycast( raycaster, intersects ) {\n\n\t\tconst levels = this.levels;\n\n\t\tif ( levels.length > 0 ) {\n\n\t\t\t_v1$2.setFromMatrixPosition( this.matrixWorld );\n\n\t\t\tconst distance = raycaster.ray.origin.distanceTo( _v1$2 );\n\n\t\t\tthis.getObjectForDistance( distance ).raycast( raycaster, intersects );\n\n\t\t}\n\n\t}\n\n\tupdate( camera ) {\n\n\t\tconst levels = this.levels;\n\n\t\tif ( levels.length > 1 ) {\n\n\t\t\t_v1$2.setFromMatrixPosition( camera.matrixWorld );\n\t\t\t_v2$1.setFromMatrixPosition( this.matrixWorld );\n\n\t\t\tconst distance = _v1$2.distanceTo( _v2$1 ) / camera.zoom;\n\n\t\t\tlevels[ 0 ].object.visible = true;\n\n\t\t\tlet i, l;\n\n\t\t\tfor ( i = 1, l = levels.length; i < l; i ++ ) {\n\n\t\t\t\tlet levelDistance = levels[ i ].distance;\n\n\t\t\t\tif ( levels[ i ].object.visible ) {\n\n\t\t\t\t\tlevelDistance -= levelDistance * levels[ i ].hysteresis;\n\n\t\t\t\t}\n\n\t\t\t\tif ( distance >= levelDistance ) {\n\n\t\t\t\t\tlevels[ i - 1 ].object.visible = false;\n\t\t\t\t\tlevels[ i ].object.visible = true;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis._currentLevel = i - 1;\n\n\t\t\tfor ( ; i < l; i ++ ) {\n\n\t\t\t\tlevels[ i ].object.visible = false;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst data = super.toJSON( meta );\n\n\t\tif ( this.autoUpdate === false ) data.object.autoUpdate = false;\n\n\t\tdata.object.levels = [];\n\n\t\tconst levels = this.levels;\n\n\t\tfor ( let i = 0, l = levels.length; i < l; i ++ ) {\n\n\t\t\tconst level = levels[ i ];\n\n\t\t\tdata.object.levels.push( {\n\t\t\t\tobject: level.object.uuid,\n\t\t\t\tdistance: level.distance,\n\t\t\t\thysteresis: level.hysteresis\n\t\t\t} );\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n}\n\nconst _basePosition = /*@__PURE__*/ new Vector3();\n\nconst _skinIndex = /*@__PURE__*/ new Vector4();\nconst _skinWeight = /*@__PURE__*/ new Vector4();\n\nconst _vector$5 = /*@__PURE__*/ new Vector3();\nconst _matrix = /*@__PURE__*/ new Matrix4();\n\nclass SkinnedMesh extends Mesh {\n\n\tconstructor( geometry, material ) {\n\n\t\tsuper( geometry, material );\n\n\t\tthis.isSkinnedMesh = true;\n\n\t\tthis.type = 'SkinnedMesh';\n\n\t\tthis.bindMode = 'attached';\n\t\tthis.bindMatrix = new Matrix4();\n\t\tthis.bindMatrixInverse = new Matrix4();\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.bindMode = source.bindMode;\n\t\tthis.bindMatrix.copy( source.bindMatrix );\n\t\tthis.bindMatrixInverse.copy( source.bindMatrixInverse );\n\n\t\tthis.skeleton = source.skeleton;\n\n\t\treturn this;\n\n\t}\n\n\tbind( skeleton, bindMatrix ) {\n\n\t\tthis.skeleton = skeleton;\n\n\t\tif ( bindMatrix === undefined ) {\n\n\t\t\tthis.updateMatrixWorld( true );\n\n\t\t\tthis.skeleton.calculateInverses();\n\n\t\t\tbindMatrix = this.matrixWorld;\n\n\t\t}\n\n\t\tthis.bindMatrix.copy( bindMatrix );\n\t\tthis.bindMatrixInverse.copy( bindMatrix ).invert();\n\n\t}\n\n\tpose() {\n\n\t\tthis.skeleton.pose();\n\n\t}\n\n\tnormalizeSkinWeights() {\n\n\t\tconst vector = new Vector4();\n\n\t\tconst skinWeight = this.geometry.attributes.skinWeight;\n\n\t\tfor ( let i = 0, l = skinWeight.count; i < l; i ++ ) {\n\n\t\t\tvector.fromBufferAttribute( skinWeight, i );\n\n\t\t\tconst scale = 1.0 / vector.manhattanLength();\n\n\t\t\tif ( scale !== Infinity ) {\n\n\t\t\t\tvector.multiplyScalar( scale );\n\n\t\t\t} else {\n\n\t\t\t\tvector.set( 1, 0, 0, 0 ); // do something reasonable\n\n\t\t\t}\n\n\t\t\tskinWeight.setXYZW( i, vector.x, vector.y, vector.z, vector.w );\n\n\t\t}\n\n\t}\n\n\tupdateMatrixWorld( force ) {\n\n\t\tsuper.updateMatrixWorld( force );\n\n\t\tif ( this.bindMode === 'attached' ) {\n\n\t\t\tthis.bindMatrixInverse.copy( this.matrixWorld ).invert();\n\n\t\t} else if ( this.bindMode === 'detached' ) {\n\n\t\t\tthis.bindMatrixInverse.copy( this.bindMatrix ).invert();\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.SkinnedMesh: Unrecognized bindMode: ' + this.bindMode );\n\n\t\t}\n\n\t}\n\n\tboneTransform( index, target ) {\n\n\t\tconst skeleton = this.skeleton;\n\t\tconst geometry = this.geometry;\n\n\t\t_skinIndex.fromBufferAttribute( geometry.attributes.skinIndex, index );\n\t\t_skinWeight.fromBufferAttribute( geometry.attributes.skinWeight, index );\n\n\t\t_basePosition.copy( target ).applyMatrix4( this.bindMatrix );\n\n\t\ttarget.set( 0, 0, 0 );\n\n\t\tfor ( let i = 0; i < 4; i ++ ) {\n\n\t\t\tconst weight = _skinWeight.getComponent( i );\n\n\t\t\tif ( weight !== 0 ) {\n\n\t\t\t\tconst boneIndex = _skinIndex.getComponent( i );\n\n\t\t\t\t_matrix.multiplyMatrices( skeleton.bones[ boneIndex ].matrixWorld, skeleton.boneInverses[ boneIndex ] );\n\n\t\t\t\ttarget.addScaledVector( _vector$5.copy( _basePosition ).applyMatrix4( _matrix ), weight );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn target.applyMatrix4( this.bindMatrixInverse );\n\n\t}\n\n}\n\nclass Bone extends Object3D {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.isBone = true;\n\n\t\tthis.type = 'Bone';\n\n\t}\n\n}\n\nclass DataTexture extends Texture {\n\n\tconstructor( data = null, width = 1, height = 1, format, type, mapping, wrapS, wrapT, magFilter = NearestFilter, minFilter = NearestFilter, anisotropy, encoding ) {\n\n\t\tsuper( null, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy, encoding );\n\n\t\tthis.isDataTexture = true;\n\n\t\tthis.image = { data: data, width: width, height: height };\n\n\t\tthis.generateMipmaps = false;\n\t\tthis.flipY = false;\n\t\tthis.unpackAlignment = 1;\n\n\t}\n\n}\n\nconst _offsetMatrix = /*@__PURE__*/ new Matrix4();\nconst _identityMatrix = /*@__PURE__*/ new Matrix4();\n\nclass Skeleton {\n\n\tconstructor( bones = [], boneInverses = [] ) {\n\n\t\tthis.uuid = generateUUID();\n\n\t\tthis.bones = bones.slice( 0 );\n\t\tthis.boneInverses = boneInverses;\n\t\tthis.boneMatrices = null;\n\n\t\tthis.boneTexture = null;\n\t\tthis.boneTextureSize = 0;\n\n\t\tthis.frame = - 1;\n\n\t\tthis.init();\n\n\t}\n\n\tinit() {\n\n\t\tconst bones = this.bones;\n\t\tconst boneInverses = this.boneInverses;\n\n\t\tthis.boneMatrices = new Float32Array( bones.length * 16 );\n\n\t\t// calculate inverse bone matrices if necessary\n\n\t\tif ( boneInverses.length === 0 ) {\n\n\t\t\tthis.calculateInverses();\n\n\t\t} else {\n\n\t\t\t// handle special case\n\n\t\t\tif ( bones.length !== boneInverses.length ) {\n\n\t\t\t\tconsole.warn( 'THREE.Skeleton: Number of inverse bone matrices does not match amount of bones.' );\n\n\t\t\t\tthis.boneInverses = [];\n\n\t\t\t\tfor ( let i = 0, il = this.bones.length; i < il; i ++ ) {\n\n\t\t\t\t\tthis.boneInverses.push( new Matrix4() );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tcalculateInverses() {\n\n\t\tthis.boneInverses.length = 0;\n\n\t\tfor ( let i = 0, il = this.bones.length; i < il; i ++ ) {\n\n\t\t\tconst inverse = new Matrix4();\n\n\t\t\tif ( this.bones[ i ] ) {\n\n\t\t\t\tinverse.copy( this.bones[ i ].matrixWorld ).invert();\n\n\t\t\t}\n\n\t\t\tthis.boneInverses.push( inverse );\n\n\t\t}\n\n\t}\n\n\tpose() {\n\n\t\t// recover the bind-time world matrices\n\n\t\tfor ( let i = 0, il = this.bones.length; i < il; i ++ ) {\n\n\t\t\tconst bone = this.bones[ i ];\n\n\t\t\tif ( bone ) {\n\n\t\t\t\tbone.matrixWorld.copy( this.boneInverses[ i ] ).invert();\n\n\t\t\t}\n\n\t\t}\n\n\t\t// compute the local matrices, positions, rotations and scales\n\n\t\tfor ( let i = 0, il = this.bones.length; i < il; i ++ ) {\n\n\t\t\tconst bone = this.bones[ i ];\n\n\t\t\tif ( bone ) {\n\n\t\t\t\tif ( bone.parent && bone.parent.isBone ) {\n\n\t\t\t\t\tbone.matrix.copy( bone.parent.matrixWorld ).invert();\n\t\t\t\t\tbone.matrix.multiply( bone.matrixWorld );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tbone.matrix.copy( bone.matrixWorld );\n\n\t\t\t\t}\n\n\t\t\t\tbone.matrix.decompose( bone.position, bone.quaternion, bone.scale );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tupdate() {\n\n\t\tconst bones = this.bones;\n\t\tconst boneInverses = this.boneInverses;\n\t\tconst boneMatrices = this.boneMatrices;\n\t\tconst boneTexture = this.boneTexture;\n\n\t\t// flatten bone matrices to array\n\n\t\tfor ( let i = 0, il = bones.length; i < il; i ++ ) {\n\n\t\t\t// compute the offset between the current and the original transform\n\n\t\t\tconst matrix = bones[ i ] ? bones[ i ].matrixWorld : _identityMatrix;\n\n\t\t\t_offsetMatrix.multiplyMatrices( matrix, boneInverses[ i ] );\n\t\t\t_offsetMatrix.toArray( boneMatrices, i * 16 );\n\n\t\t}\n\n\t\tif ( boneTexture !== null ) {\n\n\t\t\tboneTexture.needsUpdate = true;\n\n\t\t}\n\n\t}\n\n\tclone() {\n\n\t\treturn new Skeleton( this.bones, this.boneInverses );\n\n\t}\n\n\tcomputeBoneTexture() {\n\n\t\t// layout (1 matrix = 4 pixels)\n\t\t//      RGBA RGBA RGBA RGBA (=> column1, column2, column3, column4)\n\t\t//  with  8x8  pixel texture max   16 bones * 4 pixels =  (8 * 8)\n\t\t//       16x16 pixel texture max   64 bones * 4 pixels = (16 * 16)\n\t\t//       32x32 pixel texture max  256 bones * 4 pixels = (32 * 32)\n\t\t//       64x64 pixel texture max 1024 bones * 4 pixels = (64 * 64)\n\n\t\tlet size = Math.sqrt( this.bones.length * 4 ); // 4 pixels needed for 1 matrix\n\t\tsize = ceilPowerOfTwo( size );\n\t\tsize = Math.max( size, 4 );\n\n\t\tconst boneMatrices = new Float32Array( size * size * 4 ); // 4 floats per RGBA pixel\n\t\tboneMatrices.set( this.boneMatrices ); // copy current values\n\n\t\tconst boneTexture = new DataTexture( boneMatrices, size, size, RGBAFormat, FloatType );\n\t\tboneTexture.needsUpdate = true;\n\n\t\tthis.boneMatrices = boneMatrices;\n\t\tthis.boneTexture = boneTexture;\n\t\tthis.boneTextureSize = size;\n\n\t\treturn this;\n\n\t}\n\n\tgetBoneByName( name ) {\n\n\t\tfor ( let i = 0, il = this.bones.length; i < il; i ++ ) {\n\n\t\t\tconst bone = this.bones[ i ];\n\n\t\t\tif ( bone.name === name ) {\n\n\t\t\t\treturn bone;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn undefined;\n\n\t}\n\n\tdispose( ) {\n\n\t\tif ( this.boneTexture !== null ) {\n\n\t\t\tthis.boneTexture.dispose();\n\n\t\t\tthis.boneTexture = null;\n\n\t\t}\n\n\t}\n\n\tfromJSON( json, bones ) {\n\n\t\tthis.uuid = json.uuid;\n\n\t\tfor ( let i = 0, l = json.bones.length; i < l; i ++ ) {\n\n\t\t\tconst uuid = json.bones[ i ];\n\t\t\tlet bone = bones[ uuid ];\n\n\t\t\tif ( bone === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.Skeleton: No bone found with UUID:', uuid );\n\t\t\t\tbone = new Bone();\n\n\t\t\t}\n\n\t\t\tthis.bones.push( bone );\n\t\t\tthis.boneInverses.push( new Matrix4().fromArray( json.boneInverses[ i ] ) );\n\n\t\t}\n\n\t\tthis.init();\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = {\n\t\t\tmetadata: {\n\t\t\t\tversion: 4.5,\n\t\t\t\ttype: 'Skeleton',\n\t\t\t\tgenerator: 'Skeleton.toJSON'\n\t\t\t},\n\t\t\tbones: [],\n\t\t\tboneInverses: []\n\t\t};\n\n\t\tdata.uuid = this.uuid;\n\n\t\tconst bones = this.bones;\n\t\tconst boneInverses = this.boneInverses;\n\n\t\tfor ( let i = 0, l = bones.length; i < l; i ++ ) {\n\n\t\t\tconst bone = bones[ i ];\n\t\t\tdata.bones.push( bone.uuid );\n\n\t\t\tconst boneInverse = boneInverses[ i ];\n\t\t\tdata.boneInverses.push( boneInverse.toArray() );\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n}\n\nclass InstancedBufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized, meshPerAttribute = 1 ) {\n\n\t\tsuper( array, itemSize, normalized );\n\n\t\tthis.isInstancedBufferAttribute = true;\n\n\t\tthis.meshPerAttribute = meshPerAttribute;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.meshPerAttribute = source.meshPerAttribute;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.meshPerAttribute = this.meshPerAttribute;\n\n\t\tdata.isInstancedBufferAttribute = true;\n\n\t\treturn data;\n\n\t}\n\n}\n\nconst _instanceLocalMatrix = /*@__PURE__*/ new Matrix4();\nconst _instanceWorldMatrix = /*@__PURE__*/ new Matrix4();\n\nconst _instanceIntersects = [];\n\nconst _identity = /*@__PURE__*/ new Matrix4();\nconst _mesh = /*@__PURE__*/ new Mesh();\n\nclass InstancedMesh extends Mesh {\n\n\tconstructor( geometry, material, count ) {\n\n\t\tsuper( geometry, material );\n\n\t\tthis.isInstancedMesh = true;\n\n\t\tthis.instanceMatrix = new InstancedBufferAttribute( new Float32Array( count * 16 ), 16 );\n\t\tthis.instanceColor = null;\n\n\t\tthis.count = count;\n\n\t\tthis.frustumCulled = false;\n\n\t\tfor ( let i = 0; i < count; i ++ ) {\n\n\t\t\tthis.setMatrixAt( i, _identity );\n\n\t\t}\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.instanceMatrix.copy( source.instanceMatrix );\n\n\t\tif ( source.instanceColor !== null ) this.instanceColor = source.instanceColor.clone();\n\n\t\tthis.count = source.count;\n\n\t\treturn this;\n\n\t}\n\n\tgetColorAt( index, color ) {\n\n\t\tcolor.fromArray( this.instanceColor.array, index * 3 );\n\n\t}\n\n\tgetMatrixAt( index, matrix ) {\n\n\t\tmatrix.fromArray( this.instanceMatrix.array, index * 16 );\n\n\t}\n\n\traycast( raycaster, intersects ) {\n\n\t\tconst matrixWorld = this.matrixWorld;\n\t\tconst raycastTimes = this.count;\n\n\t\t_mesh.geometry = this.geometry;\n\t\t_mesh.material = this.material;\n\n\t\tif ( _mesh.material === undefined ) return;\n\n\t\tfor ( let instanceId = 0; instanceId < raycastTimes; instanceId ++ ) {\n\n\t\t\t// calculate the world matrix for each instance\n\n\t\t\tthis.getMatrixAt( instanceId, _instanceLocalMatrix );\n\n\t\t\t_instanceWorldMatrix.multiplyMatrices( matrixWorld, _instanceLocalMatrix );\n\n\t\t\t// the mesh represents this single instance\n\n\t\t\t_mesh.matrixWorld = _instanceWorldMatrix;\n\n\t\t\t_mesh.raycast( raycaster, _instanceIntersects );\n\n\t\t\t// process the result of raycast\n\n\t\t\tfor ( let i = 0, l = _instanceIntersects.length; i < l; i ++ ) {\n\n\t\t\t\tconst intersect = _instanceIntersects[ i ];\n\t\t\t\tintersect.instanceId = instanceId;\n\t\t\t\tintersect.object = this;\n\t\t\t\tintersects.push( intersect );\n\n\t\t\t}\n\n\t\t\t_instanceIntersects.length = 0;\n\n\t\t}\n\n\t}\n\n\tsetColorAt( index, color ) {\n\n\t\tif ( this.instanceColor === null ) {\n\n\t\t\tthis.instanceColor = new InstancedBufferAttribute( new Float32Array( this.instanceMatrix.count * 3 ), 3 );\n\n\t\t}\n\n\t\tcolor.toArray( this.instanceColor.array, index * 3 );\n\n\t}\n\n\tsetMatrixAt( index, matrix ) {\n\n\t\tmatrix.toArray( this.instanceMatrix.array, index * 16 );\n\n\t}\n\n\tupdateMorphTargets() {\n\n\t}\n\n\tdispose() {\n\n\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t}\n\n}\n\nclass LineBasicMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isLineBasicMaterial = true;\n\n\t\tthis.type = 'LineBasicMaterial';\n\n\t\tthis.color = new Color( 0xffffff );\n\n\t\tthis.linewidth = 1;\n\t\tthis.linecap = 'round';\n\t\tthis.linejoin = 'round';\n\n\t\tthis.fog = true;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\n\t\tthis.linewidth = source.linewidth;\n\t\tthis.linecap = source.linecap;\n\t\tthis.linejoin = source.linejoin;\n\n\t\tthis.fog = source.fog;\n\n\t\treturn this;\n\n\t}\n\n}\n\nconst _start$1 = /*@__PURE__*/ new Vector3();\nconst _end$1 = /*@__PURE__*/ new Vector3();\nconst _inverseMatrix$1 = /*@__PURE__*/ new Matrix4();\nconst _ray$1 = /*@__PURE__*/ new Ray();\nconst _sphere$1 = /*@__PURE__*/ new Sphere();\n\nclass Line extends Object3D {\n\n\tconstructor( geometry = new BufferGeometry(), material = new LineBasicMaterial() ) {\n\n\t\tsuper();\n\n\t\tthis.isLine = true;\n\n\t\tthis.type = 'Line';\n\n\t\tthis.geometry = geometry;\n\t\tthis.material = material;\n\n\t\tthis.updateMorphTargets();\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.material = source.material;\n\t\tthis.geometry = source.geometry;\n\n\t\treturn this;\n\n\t}\n\n\tcomputeLineDistances() {\n\n\t\tconst geometry = this.geometry;\n\n\t\t// we assume non-indexed geometry\n\n\t\tif ( geometry.index === null ) {\n\n\t\t\tconst positionAttribute = geometry.attributes.position;\n\t\t\tconst lineDistances = [ 0 ];\n\n\t\t\tfor ( let i = 1, l = positionAttribute.count; i < l; i ++ ) {\n\n\t\t\t\t_start$1.fromBufferAttribute( positionAttribute, i - 1 );\n\t\t\t\t_end$1.fromBufferAttribute( positionAttribute, i );\n\n\t\t\t\tlineDistances[ i ] = lineDistances[ i - 1 ];\n\t\t\t\tlineDistances[ i ] += _start$1.distanceTo( _end$1 );\n\n\t\t\t}\n\n\t\t\tgeometry.setAttribute( 'lineDistance', new Float32BufferAttribute( lineDistances, 1 ) );\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.' );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\traycast( raycaster, intersects ) {\n\n\t\tconst geometry = this.geometry;\n\t\tconst matrixWorld = this.matrixWorld;\n\t\tconst threshold = raycaster.params.Line.threshold;\n\t\tconst drawRange = geometry.drawRange;\n\n\t\t// Checking boundingSphere distance to ray\n\n\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\n\n\t\t_sphere$1.copy( geometry.boundingSphere );\n\t\t_sphere$1.applyMatrix4( matrixWorld );\n\t\t_sphere$1.radius += threshold;\n\n\t\tif ( raycaster.ray.intersectsSphere( _sphere$1 ) === false ) return;\n\n\t\t//\n\n\t\t_inverseMatrix$1.copy( matrixWorld ).invert();\n\t\t_ray$1.copy( raycaster.ray ).applyMatrix4( _inverseMatrix$1 );\n\n\t\tconst localThreshold = threshold / ( ( this.scale.x + this.scale.y + this.scale.z ) / 3 );\n\t\tconst localThresholdSq = localThreshold * localThreshold;\n\n\t\tconst vStart = new Vector3();\n\t\tconst vEnd = new Vector3();\n\t\tconst interSegment = new Vector3();\n\t\tconst interRay = new Vector3();\n\t\tconst step = this.isLineSegments ? 2 : 1;\n\n\t\tconst index = geometry.index;\n\t\tconst attributes = geometry.attributes;\n\t\tconst positionAttribute = attributes.position;\n\n\t\tif ( index !== null ) {\n\n\t\t\tconst start = Math.max( 0, drawRange.start );\n\t\t\tconst end = Math.min( index.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\tfor ( let i = start, l = end - 1; i < l; i += step ) {\n\n\t\t\t\tconst a = index.getX( i );\n\t\t\t\tconst b = index.getX( i + 1 );\n\n\t\t\t\tvStart.fromBufferAttribute( positionAttribute, a );\n\t\t\t\tvEnd.fromBufferAttribute( positionAttribute, b );\n\n\t\t\t\tconst distSq = _ray$1.distanceSqToSegment( vStart, vEnd, interRay, interSegment );\n\n\t\t\t\tif ( distSq > localThresholdSq ) continue;\n\n\t\t\t\tinterRay.applyMatrix4( this.matrixWorld ); //Move back to world space for distance calculation\n\n\t\t\t\tconst distance = raycaster.ray.origin.distanceTo( interRay );\n\n\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) continue;\n\n\t\t\t\tintersects.push( {\n\n\t\t\t\t\tdistance: distance,\n\t\t\t\t\t// What do we want? intersection point on the ray or on the segment??\n\t\t\t\t\t// point: raycaster.ray.at( distance ),\n\t\t\t\t\tpoint: interSegment.clone().applyMatrix4( this.matrixWorld ),\n\t\t\t\t\tindex: i,\n\t\t\t\t\tface: null,\n\t\t\t\t\tfaceIndex: null,\n\t\t\t\t\tobject: this\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconst start = Math.max( 0, drawRange.start );\n\t\t\tconst end = Math.min( positionAttribute.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\tfor ( let i = start, l = end - 1; i < l; i += step ) {\n\n\t\t\t\tvStart.fromBufferAttribute( positionAttribute, i );\n\t\t\t\tvEnd.fromBufferAttribute( positionAttribute, i + 1 );\n\n\t\t\t\tconst distSq = _ray$1.distanceSqToSegment( vStart, vEnd, interRay, interSegment );\n\n\t\t\t\tif ( distSq > localThresholdSq ) continue;\n\n\t\t\t\tinterRay.applyMatrix4( this.matrixWorld ); //Move back to world space for distance calculation\n\n\t\t\t\tconst distance = raycaster.ray.origin.distanceTo( interRay );\n\n\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) continue;\n\n\t\t\t\tintersects.push( {\n\n\t\t\t\t\tdistance: distance,\n\t\t\t\t\t// What do we want? intersection point on the ray or on the segment??\n\t\t\t\t\t// point: raycaster.ray.at( distance ),\n\t\t\t\t\tpoint: interSegment.clone().applyMatrix4( this.matrixWorld ),\n\t\t\t\t\tindex: i,\n\t\t\t\t\tface: null,\n\t\t\t\t\tfaceIndex: null,\n\t\t\t\t\tobject: this\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tupdateMorphTargets() {\n\n\t\tconst geometry = this.geometry;\n\n\t\tconst morphAttributes = geometry.morphAttributes;\n\t\tconst keys = Object.keys( morphAttributes );\n\n\t\tif ( keys.length > 0 ) {\n\n\t\t\tconst morphAttribute = morphAttributes[ keys[ 0 ] ];\n\n\t\t\tif ( morphAttribute !== undefined ) {\n\n\t\t\t\tthis.morphTargetInfluences = [];\n\t\t\t\tthis.morphTargetDictionary = {};\n\n\t\t\t\tfor ( let m = 0, ml = morphAttribute.length; m < ml; m ++ ) {\n\n\t\t\t\t\tconst name = morphAttribute[ m ].name || String( m );\n\n\t\t\t\t\tthis.morphTargetInfluences.push( 0 );\n\t\t\t\t\tthis.morphTargetDictionary[ name ] = m;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}\n\nconst _start = /*@__PURE__*/ new Vector3();\nconst _end = /*@__PURE__*/ new Vector3();\n\nclass LineSegments extends Line {\n\n\tconstructor( geometry, material ) {\n\n\t\tsuper( geometry, material );\n\n\t\tthis.isLineSegments = true;\n\n\t\tthis.type = 'LineSegments';\n\n\t}\n\n\tcomputeLineDistances() {\n\n\t\tconst geometry = this.geometry;\n\n\t\t// we assume non-indexed geometry\n\n\t\tif ( geometry.index === null ) {\n\n\t\t\tconst positionAttribute = geometry.attributes.position;\n\t\t\tconst lineDistances = [];\n\n\t\t\tfor ( let i = 0, l = positionAttribute.count; i < l; i += 2 ) {\n\n\t\t\t\t_start.fromBufferAttribute( positionAttribute, i );\n\t\t\t\t_end.fromBufferAttribute( positionAttribute, i + 1 );\n\n\t\t\t\tlineDistances[ i ] = ( i === 0 ) ? 0 : lineDistances[ i - 1 ];\n\t\t\t\tlineDistances[ i + 1 ] = lineDistances[ i ] + _start.distanceTo( _end );\n\n\t\t\t}\n\n\t\t\tgeometry.setAttribute( 'lineDistance', new Float32BufferAttribute( lineDistances, 1 ) );\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.' );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass LineLoop extends Line {\n\n\tconstructor( geometry, material ) {\n\n\t\tsuper( geometry, material );\n\n\t\tthis.isLineLoop = true;\n\n\t\tthis.type = 'LineLoop';\n\n\t}\n\n}\n\nclass PointsMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isPointsMaterial = true;\n\n\t\tthis.type = 'PointsMaterial';\n\n\t\tthis.color = new Color( 0xffffff );\n\n\t\tthis.map = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.size = 1;\n\t\tthis.sizeAttenuation = true;\n\n\t\tthis.fog = true;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\n\t\tthis.map = source.map;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.size = source.size;\n\t\tthis.sizeAttenuation = source.sizeAttenuation;\n\n\t\tthis.fog = source.fog;\n\n\t\treturn this;\n\n\t}\n\n}\n\nconst _inverseMatrix = /*@__PURE__*/ new Matrix4();\nconst _ray = /*@__PURE__*/ new Ray();\nconst _sphere = /*@__PURE__*/ new Sphere();\nconst _position$2 = /*@__PURE__*/ new Vector3();\n\nclass Points extends Object3D {\n\n\tconstructor( geometry = new BufferGeometry(), material = new PointsMaterial() ) {\n\n\t\tsuper();\n\n\t\tthis.isPoints = true;\n\n\t\tthis.type = 'Points';\n\n\t\tthis.geometry = geometry;\n\t\tthis.material = material;\n\n\t\tthis.updateMorphTargets();\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.material = source.material;\n\t\tthis.geometry = source.geometry;\n\n\t\treturn this;\n\n\t}\n\n\traycast( raycaster, intersects ) {\n\n\t\tconst geometry = this.geometry;\n\t\tconst matrixWorld = this.matrixWorld;\n\t\tconst threshold = raycaster.params.Points.threshold;\n\t\tconst drawRange = geometry.drawRange;\n\n\t\t// Checking boundingSphere distance to ray\n\n\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\n\n\t\t_sphere.copy( geometry.boundingSphere );\n\t\t_sphere.applyMatrix4( matrixWorld );\n\t\t_sphere.radius += threshold;\n\n\t\tif ( raycaster.ray.intersectsSphere( _sphere ) === false ) return;\n\n\t\t//\n\n\t\t_inverseMatrix.copy( matrixWorld ).invert();\n\t\t_ray.copy( raycaster.ray ).applyMatrix4( _inverseMatrix );\n\n\t\tconst localThreshold = threshold / ( ( this.scale.x + this.scale.y + this.scale.z ) / 3 );\n\t\tconst localThresholdSq = localThreshold * localThreshold;\n\n\t\tconst index = geometry.index;\n\t\tconst attributes = geometry.attributes;\n\t\tconst positionAttribute = attributes.position;\n\n\t\tif ( index !== null ) {\n\n\t\t\tconst start = Math.max( 0, drawRange.start );\n\t\t\tconst end = Math.min( index.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\tfor ( let i = start, il = end; i < il; i ++ ) {\n\n\t\t\t\tconst a = index.getX( i );\n\n\t\t\t\t_position$2.fromBufferAttribute( positionAttribute, a );\n\n\t\t\t\ttestPoint( _position$2, a, localThresholdSq, matrixWorld, raycaster, intersects, this );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconst start = Math.max( 0, drawRange.start );\n\t\t\tconst end = Math.min( positionAttribute.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\tfor ( let i = start, l = end; i < l; i ++ ) {\n\n\t\t\t\t_position$2.fromBufferAttribute( positionAttribute, i );\n\n\t\t\t\ttestPoint( _position$2, i, localThresholdSq, matrixWorld, raycaster, intersects, this );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tupdateMorphTargets() {\n\n\t\tconst geometry = this.geometry;\n\n\t\tconst morphAttributes = geometry.morphAttributes;\n\t\tconst keys = Object.keys( morphAttributes );\n\n\t\tif ( keys.length > 0 ) {\n\n\t\t\tconst morphAttribute = morphAttributes[ keys[ 0 ] ];\n\n\t\t\tif ( morphAttribute !== undefined ) {\n\n\t\t\t\tthis.morphTargetInfluences = [];\n\t\t\t\tthis.morphTargetDictionary = {};\n\n\t\t\t\tfor ( let m = 0, ml = morphAttribute.length; m < ml; m ++ ) {\n\n\t\t\t\t\tconst name = morphAttribute[ m ].name || String( m );\n\n\t\t\t\t\tthis.morphTargetInfluences.push( 0 );\n\t\t\t\t\tthis.morphTargetDictionary[ name ] = m;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}\n\nfunction testPoint( point, index, localThresholdSq, matrixWorld, raycaster, intersects, object ) {\n\n\tconst rayPointDistanceSq = _ray.distanceSqToPoint( point );\n\n\tif ( rayPointDistanceSq < localThresholdSq ) {\n\n\t\tconst intersectPoint = new Vector3();\n\n\t\t_ray.closestPointToPoint( point, intersectPoint );\n\t\tintersectPoint.applyMatrix4( matrixWorld );\n\n\t\tconst distance = raycaster.ray.origin.distanceTo( intersectPoint );\n\n\t\tif ( distance < raycaster.near || distance > raycaster.far ) return;\n\n\t\tintersects.push( {\n\n\t\t\tdistance: distance,\n\t\t\tdistanceToRay: Math.sqrt( rayPointDistanceSq ),\n\t\t\tpoint: intersectPoint,\n\t\t\tindex: index,\n\t\t\tface: null,\n\t\t\tobject: object\n\n\t\t} );\n\n\t}\n\n}\n\nclass VideoTexture extends Texture {\n\n\tconstructor( video, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy ) {\n\n\t\tsuper( video, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy );\n\n\t\tthis.isVideoTexture = true;\n\n\t\tthis.minFilter = minFilter !== undefined ? minFilter : LinearFilter;\n\t\tthis.magFilter = magFilter !== undefined ? magFilter : LinearFilter;\n\n\t\tthis.generateMipmaps = false;\n\n\t\tconst scope = this;\n\n\t\tfunction updateVideo() {\n\n\t\t\tscope.needsUpdate = true;\n\t\t\tvideo.requestVideoFrameCallback( updateVideo );\n\n\t\t}\n\n\t\tif ( 'requestVideoFrameCallback' in video ) {\n\n\t\t\tvideo.requestVideoFrameCallback( updateVideo );\n\n\t\t}\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this.image ).copy( this );\n\n\t}\n\n\tupdate() {\n\n\t\tconst video = this.image;\n\t\tconst hasVideoFrameCallback = 'requestVideoFrameCallback' in video;\n\n\t\tif ( hasVideoFrameCallback === false && video.readyState >= video.HAVE_CURRENT_DATA ) {\n\n\t\t\tthis.needsUpdate = true;\n\n\t\t}\n\n\t}\n\n}\n\nclass FramebufferTexture extends Texture {\n\n\tconstructor( width, height, format ) {\n\n\t\tsuper( { width, height } );\n\n\t\tthis.isFramebufferTexture = true;\n\n\t\tthis.format = format;\n\n\t\tthis.magFilter = NearestFilter;\n\t\tthis.minFilter = NearestFilter;\n\n\t\tthis.generateMipmaps = false;\n\n\t\tthis.needsUpdate = true;\n\n\t}\n\n}\n\nclass CompressedTexture extends Texture {\n\n\tconstructor( mipmaps, width, height, format, type, mapping, wrapS, wrapT, magFilter, minFilter, anisotropy, encoding ) {\n\n\t\tsuper( null, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy, encoding );\n\n\t\tthis.isCompressedTexture = true;\n\n\t\tthis.image = { width: width, height: height };\n\t\tthis.mipmaps = mipmaps;\n\n\t\t// no flipping for cube textures\n\t\t// (also flipping doesn't work for compressed textures )\n\n\t\tthis.flipY = false;\n\n\t\t// can't generate mipmaps for compressed textures\n\t\t// mips must be embedded in DDS files\n\n\t\tthis.generateMipmaps = false;\n\n\t}\n\n}\n\nclass CompressedArrayTexture extends CompressedTexture {\n\n\tconstructor( mipmaps, width, height, depth, format, type ) {\n\n\t\tsuper( mipmaps, width, height, format, type );\n\n\t\tthis.isCompressedArrayTexture = true;\n\t\tthis.image.depth = depth;\n\t\tthis.wrapR = ClampToEdgeWrapping;\n\n\t}\n\n}\n\nclass CanvasTexture extends Texture {\n\n\tconstructor( canvas, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy ) {\n\n\t\tsuper( canvas, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy );\n\n\t\tthis.isCanvasTexture = true;\n\n\t\tthis.needsUpdate = true;\n\n\t}\n\n}\n\n/**\n * Extensible curve object.\n *\n * Some common of curve methods:\n * .getPoint( t, optionalTarget ), .getTangent( t, optionalTarget )\n * .getPointAt( u, optionalTarget ), .getTangentAt( u, optionalTarget )\n * .getPoints(), .getSpacedPoints()\n * .getLength()\n * .updateArcLengths()\n *\n * This following curves inherit from THREE.Curve:\n *\n * -- 2D curves --\n * THREE.ArcCurve\n * THREE.CubicBezierCurve\n * THREE.EllipseCurve\n * THREE.LineCurve\n * THREE.QuadraticBezierCurve\n * THREE.SplineCurve\n *\n * -- 3D curves --\n * THREE.CatmullRomCurve3\n * THREE.CubicBezierCurve3\n * THREE.LineCurve3\n * THREE.QuadraticBezierCurve3\n *\n * A series of curves can be represented as a THREE.CurvePath.\n *\n **/\n\nclass Curve {\n\n\tconstructor() {\n\n\t\tthis.type = 'Curve';\n\n\t\tthis.arcLengthDivisions = 200;\n\n\t}\n\n\t// Virtual base class method to overwrite and implement in subclasses\n\t//\t- t [0 .. 1]\n\n\tgetPoint( /* t, optionalTarget */ ) {\n\n\t\tconsole.warn( 'THREE.Curve: .getPoint() not implemented.' );\n\t\treturn null;\n\n\t}\n\n\t// Get point at relative position in curve according to arc length\n\t// - u [0 .. 1]\n\n\tgetPointAt( u, optionalTarget ) {\n\n\t\tconst t = this.getUtoTmapping( u );\n\t\treturn this.getPoint( t, optionalTarget );\n\n\t}\n\n\t// Get sequence of points using getPoint( t )\n\n\tgetPoints( divisions = 5 ) {\n\n\t\tconst points = [];\n\n\t\tfor ( let d = 0; d <= divisions; d ++ ) {\n\n\t\t\tpoints.push( this.getPoint( d / divisions ) );\n\n\t\t}\n\n\t\treturn points;\n\n\t}\n\n\t// Get sequence of points using getPointAt( u )\n\n\tgetSpacedPoints( divisions = 5 ) {\n\n\t\tconst points = [];\n\n\t\tfor ( let d = 0; d <= divisions; d ++ ) {\n\n\t\t\tpoints.push( this.getPointAt( d / divisions ) );\n\n\t\t}\n\n\t\treturn points;\n\n\t}\n\n\t// Get total curve arc length\n\n\tgetLength() {\n\n\t\tconst lengths = this.getLengths();\n\t\treturn lengths[ lengths.length - 1 ];\n\n\t}\n\n\t// Get list of cumulative segment lengths\n\n\tgetLengths( divisions = this.arcLengthDivisions ) {\n\n\t\tif ( this.cacheArcLengths &&\n\t\t\t( this.cacheArcLengths.length === divisions + 1 ) &&\n\t\t\t! this.needsUpdate ) {\n\n\t\t\treturn this.cacheArcLengths;\n\n\t\t}\n\n\t\tthis.needsUpdate = false;\n\n\t\tconst cache = [];\n\t\tlet current, last = this.getPoint( 0 );\n\t\tlet sum = 0;\n\n\t\tcache.push( 0 );\n\n\t\tfor ( let p = 1; p <= divisions; p ++ ) {\n\n\t\t\tcurrent = this.getPoint( p / divisions );\n\t\t\tsum += current.distanceTo( last );\n\t\t\tcache.push( sum );\n\t\t\tlast = current;\n\n\t\t}\n\n\t\tthis.cacheArcLengths = cache;\n\n\t\treturn cache; // { sums: cache, sum: sum }; Sum is in the last element.\n\n\t}\n\n\tupdateArcLengths() {\n\n\t\tthis.needsUpdate = true;\n\t\tthis.getLengths();\n\n\t}\n\n\t// Given u ( 0 .. 1 ), get a t to find p. This gives you points which are equidistant\n\n\tgetUtoTmapping( u, distance ) {\n\n\t\tconst arcLengths = this.getLengths();\n\n\t\tlet i = 0;\n\t\tconst il = arcLengths.length;\n\n\t\tlet targetArcLength; // The targeted u distance value to get\n\n\t\tif ( distance ) {\n\n\t\t\ttargetArcLength = distance;\n\n\t\t} else {\n\n\t\t\ttargetArcLength = u * arcLengths[ il - 1 ];\n\n\t\t}\n\n\t\t// binary search for the index with largest value smaller than target u distance\n\n\t\tlet low = 0, high = il - 1, comparison;\n\n\t\twhile ( low <= high ) {\n\n\t\t\ti = Math.floor( low + ( high - low ) / 2 ); // less likely to overflow, though probably not issue here, JS doesn't really have integers, all numbers are floats\n\n\t\t\tcomparison = arcLengths[ i ] - targetArcLength;\n\n\t\t\tif ( comparison < 0 ) {\n\n\t\t\t\tlow = i + 1;\n\n\t\t\t} else if ( comparison > 0 ) {\n\n\t\t\t\thigh = i - 1;\n\n\t\t\t} else {\n\n\t\t\t\thigh = i;\n\t\t\t\tbreak;\n\n\t\t\t\t// DONE\n\n\t\t\t}\n\n\t\t}\n\n\t\ti = high;\n\n\t\tif ( arcLengths[ i ] === targetArcLength ) {\n\n\t\t\treturn i / ( il - 1 );\n\n\t\t}\n\n\t\t// we could get finer grain at lengths, or use simple interpolation between two points\n\n\t\tconst lengthBefore = arcLengths[ i ];\n\t\tconst lengthAfter = arcLengths[ i + 1 ];\n\n\t\tconst segmentLength = lengthAfter - lengthBefore;\n\n\t\t// determine where we are between the 'before' and 'after' points\n\n\t\tconst segmentFraction = ( targetArcLength - lengthBefore ) / segmentLength;\n\n\t\t// add that fractional amount to t\n\n\t\tconst t = ( i + segmentFraction ) / ( il - 1 );\n\n\t\treturn t;\n\n\t}\n\n\t// Returns a unit vector tangent at t\n\t// In case any sub curve does not implement its tangent derivation,\n\t// 2 points a small delta apart will be used to find its gradient\n\t// which seems to give a reasonable approximation\n\n\tgetTangent( t, optionalTarget ) {\n\n\t\tconst delta = 0.0001;\n\t\tlet t1 = t - delta;\n\t\tlet t2 = t + delta;\n\n\t\t// Capping in case of danger\n\n\t\tif ( t1 < 0 ) t1 = 0;\n\t\tif ( t2 > 1 ) t2 = 1;\n\n\t\tconst pt1 = this.getPoint( t1 );\n\t\tconst pt2 = this.getPoint( t2 );\n\n\t\tconst tangent = optionalTarget || ( ( pt1.isVector2 ) ? new Vector2() : new Vector3() );\n\n\t\ttangent.copy( pt2 ).sub( pt1 ).normalize();\n\n\t\treturn tangent;\n\n\t}\n\n\tgetTangentAt( u, optionalTarget ) {\n\n\t\tconst t = this.getUtoTmapping( u );\n\t\treturn this.getTangent( t, optionalTarget );\n\n\t}\n\n\tcomputeFrenetFrames( segments, closed ) {\n\n\t\t// see http://www.cs.indiana.edu/pub/techreports/TR425.pdf\n\n\t\tconst normal = new Vector3();\n\n\t\tconst tangents = [];\n\t\tconst normals = [];\n\t\tconst binormals = [];\n\n\t\tconst vec = new Vector3();\n\t\tconst mat = new Matrix4();\n\n\t\t// compute the tangent vectors for each segment on the curve\n\n\t\tfor ( let i = 0; i <= segments; i ++ ) {\n\n\t\t\tconst u = i / segments;\n\n\t\t\ttangents[ i ] = this.getTangentAt( u, new Vector3() );\n\n\t\t}\n\n\t\t// select an initial normal vector perpendicular to the first tangent vector,\n\t\t// and in the direction of the minimum tangent xyz component\n\n\t\tnormals[ 0 ] = new Vector3();\n\t\tbinormals[ 0 ] = new Vector3();\n\t\tlet min = Number.MAX_VALUE;\n\t\tconst tx = Math.abs( tangents[ 0 ].x );\n\t\tconst ty = Math.abs( tangents[ 0 ].y );\n\t\tconst tz = Math.abs( tangents[ 0 ].z );\n\n\t\tif ( tx <= min ) {\n\n\t\t\tmin = tx;\n\t\t\tnormal.set( 1, 0, 0 );\n\n\t\t}\n\n\t\tif ( ty <= min ) {\n\n\t\t\tmin = ty;\n\t\t\tnormal.set( 0, 1, 0 );\n\n\t\t}\n\n\t\tif ( tz <= min ) {\n\n\t\t\tnormal.set( 0, 0, 1 );\n\n\t\t}\n\n\t\tvec.crossVectors( tangents[ 0 ], normal ).normalize();\n\n\t\tnormals[ 0 ].crossVectors( tangents[ 0 ], vec );\n\t\tbinormals[ 0 ].crossVectors( tangents[ 0 ], normals[ 0 ] );\n\n\n\t\t// compute the slowly-varying normal and binormal vectors for each segment on the curve\n\n\t\tfor ( let i = 1; i <= segments; i ++ ) {\n\n\t\t\tnormals[ i ] = normals[ i - 1 ].clone();\n\n\t\t\tbinormals[ i ] = binormals[ i - 1 ].clone();\n\n\t\t\tvec.crossVectors( tangents[ i - 1 ], tangents[ i ] );\n\n\t\t\tif ( vec.length() > Number.EPSILON ) {\n\n\t\t\t\tvec.normalize();\n\n\t\t\t\tconst theta = Math.acos( clamp( tangents[ i - 1 ].dot( tangents[ i ] ), - 1, 1 ) ); // clamp for floating pt errors\n\n\t\t\t\tnormals[ i ].applyMatrix4( mat.makeRotationAxis( vec, theta ) );\n\n\t\t\t}\n\n\t\t\tbinormals[ i ].crossVectors( tangents[ i ], normals[ i ] );\n\n\t\t}\n\n\t\t// if the curve is closed, postprocess the vectors so the first and last normal vectors are the same\n\n\t\tif ( closed === true ) {\n\n\t\t\tlet theta = Math.acos( clamp( normals[ 0 ].dot( normals[ segments ] ), - 1, 1 ) );\n\t\t\ttheta /= segments;\n\n\t\t\tif ( tangents[ 0 ].dot( vec.crossVectors( normals[ 0 ], normals[ segments ] ) ) > 0 ) {\n\n\t\t\t\ttheta = - theta;\n\n\t\t\t}\n\n\t\t\tfor ( let i = 1; i <= segments; i ++ ) {\n\n\t\t\t\t// twist a little...\n\t\t\t\tnormals[ i ].applyMatrix4( mat.makeRotationAxis( tangents[ i ], theta * i ) );\n\t\t\t\tbinormals[ i ].crossVectors( tangents[ i ], normals[ i ] );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn {\n\t\t\ttangents: tangents,\n\t\t\tnormals: normals,\n\t\t\tbinormals: binormals\n\t\t};\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.arcLengthDivisions = source.arcLengthDivisions;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = {\n\t\t\tmetadata: {\n\t\t\t\tversion: 4.5,\n\t\t\t\ttype: 'Curve',\n\t\t\t\tgenerator: 'Curve.toJSON'\n\t\t\t}\n\t\t};\n\n\t\tdata.arcLengthDivisions = this.arcLengthDivisions;\n\t\tdata.type = this.type;\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tthis.arcLengthDivisions = json.arcLengthDivisions;\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass EllipseCurve extends Curve {\n\n\tconstructor( aX = 0, aY = 0, xRadius = 1, yRadius = 1, aStartAngle = 0, aEndAngle = Math.PI * 2, aClockwise = false, aRotation = 0 ) {\n\n\t\tsuper();\n\n\t\tthis.isEllipseCurve = true;\n\n\t\tthis.type = 'EllipseCurve';\n\n\t\tthis.aX = aX;\n\t\tthis.aY = aY;\n\n\t\tthis.xRadius = xRadius;\n\t\tthis.yRadius = yRadius;\n\n\t\tthis.aStartAngle = aStartAngle;\n\t\tthis.aEndAngle = aEndAngle;\n\n\t\tthis.aClockwise = aClockwise;\n\n\t\tthis.aRotation = aRotation;\n\n\t}\n\n\tgetPoint( t, optionalTarget ) {\n\n\t\tconst point = optionalTarget || new Vector2();\n\n\t\tconst twoPi = Math.PI * 2;\n\t\tlet deltaAngle = this.aEndAngle - this.aStartAngle;\n\t\tconst samePoints = Math.abs( deltaAngle ) < Number.EPSILON;\n\n\t\t// ensures that deltaAngle is 0 .. 2 PI\n\t\twhile ( deltaAngle < 0 ) deltaAngle += twoPi;\n\t\twhile ( deltaAngle > twoPi ) deltaAngle -= twoPi;\n\n\t\tif ( deltaAngle < Number.EPSILON ) {\n\n\t\t\tif ( samePoints ) {\n\n\t\t\t\tdeltaAngle = 0;\n\n\t\t\t} else {\n\n\t\t\t\tdeltaAngle = twoPi;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( this.aClockwise === true && ! samePoints ) {\n\n\t\t\tif ( deltaAngle === twoPi ) {\n\n\t\t\t\tdeltaAngle = - twoPi;\n\n\t\t\t} else {\n\n\t\t\t\tdeltaAngle = deltaAngle - twoPi;\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst angle = this.aStartAngle + t * deltaAngle;\n\t\tlet x = this.aX + this.xRadius * Math.cos( angle );\n\t\tlet y = this.aY + this.yRadius * Math.sin( angle );\n\n\t\tif ( this.aRotation !== 0 ) {\n\n\t\t\tconst cos = Math.cos( this.aRotation );\n\t\t\tconst sin = Math.sin( this.aRotation );\n\n\t\t\tconst tx = x - this.aX;\n\t\t\tconst ty = y - this.aY;\n\n\t\t\t// Rotate the point about the center of the ellipse.\n\t\t\tx = tx * cos - ty * sin + this.aX;\n\t\t\ty = tx * sin + ty * cos + this.aY;\n\n\t\t}\n\n\t\treturn point.set( x, y );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.aX = source.aX;\n\t\tthis.aY = source.aY;\n\n\t\tthis.xRadius = source.xRadius;\n\t\tthis.yRadius = source.yRadius;\n\n\t\tthis.aStartAngle = source.aStartAngle;\n\t\tthis.aEndAngle = source.aEndAngle;\n\n\t\tthis.aClockwise = source.aClockwise;\n\n\t\tthis.aRotation = source.aRotation;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.aX = this.aX;\n\t\tdata.aY = this.aY;\n\n\t\tdata.xRadius = this.xRadius;\n\t\tdata.yRadius = this.yRadius;\n\n\t\tdata.aStartAngle = this.aStartAngle;\n\t\tdata.aEndAngle = this.aEndAngle;\n\n\t\tdata.aClockwise = this.aClockwise;\n\n\t\tdata.aRotation = this.aRotation;\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.aX = json.aX;\n\t\tthis.aY = json.aY;\n\n\t\tthis.xRadius = json.xRadius;\n\t\tthis.yRadius = json.yRadius;\n\n\t\tthis.aStartAngle = json.aStartAngle;\n\t\tthis.aEndAngle = json.aEndAngle;\n\n\t\tthis.aClockwise = json.aClockwise;\n\n\t\tthis.aRotation = json.aRotation;\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass ArcCurve extends EllipseCurve {\n\n\tconstructor( aX, aY, aRadius, aStartAngle, aEndAngle, aClockwise ) {\n\n\t\tsuper( aX, aY, aRadius, aRadius, aStartAngle, aEndAngle, aClockwise );\n\n\t\tthis.isArcCurve = true;\n\n\t\tthis.type = 'ArcCurve';\n\n\t}\n\n}\n\n/**\n * Centripetal CatmullRom Curve - which is useful for avoiding\n * cusps and self-intersections in non-uniform catmull rom curves.\n * http://www.cemyuksel.com/research/catmullrom_param/catmullrom.pdf\n *\n * curve.type accepts centripetal(default), chordal and catmullrom\n * curve.tension is used for catmullrom which defaults to 0.5\n */\n\n\n/*\nBased on an optimized c++ solution in\n - http://stackoverflow.com/questions/9489736/catmull-rom-curve-with-no-cusps-and-no-self-intersections/\n - http://ideone.com/NoEbVM\n\nThis CubicPoly class could be used for reusing some variables and calculations,\nbut for three.js curve use, it could be possible inlined and flatten into a single function call\nwhich can be placed in CurveUtils.\n*/\n\nfunction CubicPoly() {\n\n\tlet c0 = 0, c1 = 0, c2 = 0, c3 = 0;\n\n\t/*\n\t * Compute coefficients for a cubic polynomial\n\t *   p(s) = c0 + c1*s + c2*s^2 + c3*s^3\n\t * such that\n\t *   p(0) = x0, p(1) = x1\n\t *  and\n\t *   p'(0) = t0, p'(1) = t1.\n\t */\n\tfunction init( x0, x1, t0, t1 ) {\n\n\t\tc0 = x0;\n\t\tc1 = t0;\n\t\tc2 = - 3 * x0 + 3 * x1 - 2 * t0 - t1;\n\t\tc3 = 2 * x0 - 2 * x1 + t0 + t1;\n\n\t}\n\n\treturn {\n\n\t\tinitCatmullRom: function ( x0, x1, x2, x3, tension ) {\n\n\t\t\tinit( x1, x2, tension * ( x2 - x0 ), tension * ( x3 - x1 ) );\n\n\t\t},\n\n\t\tinitNonuniformCatmullRom: function ( x0, x1, x2, x3, dt0, dt1, dt2 ) {\n\n\t\t\t// compute tangents when parameterized in [t1,t2]\n\t\t\tlet t1 = ( x1 - x0 ) / dt0 - ( x2 - x0 ) / ( dt0 + dt1 ) + ( x2 - x1 ) / dt1;\n\t\t\tlet t2 = ( x2 - x1 ) / dt1 - ( x3 - x1 ) / ( dt1 + dt2 ) + ( x3 - x2 ) / dt2;\n\n\t\t\t// rescale tangents for parametrization in [0,1]\n\t\t\tt1 *= dt1;\n\t\t\tt2 *= dt1;\n\n\t\t\tinit( x1, x2, t1, t2 );\n\n\t\t},\n\n\t\tcalc: function ( t ) {\n\n\t\t\tconst t2 = t * t;\n\t\t\tconst t3 = t2 * t;\n\t\t\treturn c0 + c1 * t + c2 * t2 + c3 * t3;\n\n\t\t}\n\n\t};\n\n}\n\n//\n\nconst tmp = /*@__PURE__*/ new Vector3();\nconst px = /*@__PURE__*/ new CubicPoly();\nconst py = /*@__PURE__*/ new CubicPoly();\nconst pz = /*@__PURE__*/ new CubicPoly();\n\nclass CatmullRomCurve3 extends Curve {\n\n\tconstructor( points = [], closed = false, curveType = 'centripetal', tension = 0.5 ) {\n\n\t\tsuper();\n\n\t\tthis.isCatmullRomCurve3 = true;\n\n\t\tthis.type = 'CatmullRomCurve3';\n\n\t\tthis.points = points;\n\t\tthis.closed = closed;\n\t\tthis.curveType = curveType;\n\t\tthis.tension = tension;\n\n\t}\n\n\tgetPoint( t, optionalTarget = new Vector3() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tconst points = this.points;\n\t\tconst l = points.length;\n\n\t\tconst p = ( l - ( this.closed ? 0 : 1 ) ) * t;\n\t\tlet intPoint = Math.floor( p );\n\t\tlet weight = p - intPoint;\n\n\t\tif ( this.closed ) {\n\n\t\t\tintPoint += intPoint > 0 ? 0 : ( Math.floor( Math.abs( intPoint ) / l ) + 1 ) * l;\n\n\t\t} else if ( weight === 0 && intPoint === l - 1 ) {\n\n\t\t\tintPoint = l - 2;\n\t\t\tweight = 1;\n\n\t\t}\n\n\t\tlet p0, p3; // 4 points (p1 & p2 defined below)\n\n\t\tif ( this.closed || intPoint > 0 ) {\n\n\t\t\tp0 = points[ ( intPoint - 1 ) % l ];\n\n\t\t} else {\n\n\t\t\t// extrapolate first point\n\t\t\ttmp.subVectors( points[ 0 ], points[ 1 ] ).add( points[ 0 ] );\n\t\t\tp0 = tmp;\n\n\t\t}\n\n\t\tconst p1 = points[ intPoint % l ];\n\t\tconst p2 = points[ ( intPoint + 1 ) % l ];\n\n\t\tif ( this.closed || intPoint + 2 < l ) {\n\n\t\t\tp3 = points[ ( intPoint + 2 ) % l ];\n\n\t\t} else {\n\n\t\t\t// extrapolate last point\n\t\t\ttmp.subVectors( points[ l - 1 ], points[ l - 2 ] ).add( points[ l - 1 ] );\n\t\t\tp3 = tmp;\n\n\t\t}\n\n\t\tif ( this.curveType === 'centripetal' || this.curveType === 'chordal' ) {\n\n\t\t\t// init Centripetal / Chordal Catmull-Rom\n\t\t\tconst pow = this.curveType === 'chordal' ? 0.5 : 0.25;\n\t\t\tlet dt0 = Math.pow( p0.distanceToSquared( p1 ), pow );\n\t\t\tlet dt1 = Math.pow( p1.distanceToSquared( p2 ), pow );\n\t\t\tlet dt2 = Math.pow( p2.distanceToSquared( p3 ), pow );\n\n\t\t\t// safety check for repeated points\n\t\t\tif ( dt1 < 1e-4 ) dt1 = 1.0;\n\t\t\tif ( dt0 < 1e-4 ) dt0 = dt1;\n\t\t\tif ( dt2 < 1e-4 ) dt2 = dt1;\n\n\t\t\tpx.initNonuniformCatmullRom( p0.x, p1.x, p2.x, p3.x, dt0, dt1, dt2 );\n\t\t\tpy.initNonuniformCatmullRom( p0.y, p1.y, p2.y, p3.y, dt0, dt1, dt2 );\n\t\t\tpz.initNonuniformCatmullRom( p0.z, p1.z, p2.z, p3.z, dt0, dt1, dt2 );\n\n\t\t} else if ( this.curveType === 'catmullrom' ) {\n\n\t\t\tpx.initCatmullRom( p0.x, p1.x, p2.x, p3.x, this.tension );\n\t\t\tpy.initCatmullRom( p0.y, p1.y, p2.y, p3.y, this.tension );\n\t\t\tpz.initCatmullRom( p0.z, p1.z, p2.z, p3.z, this.tension );\n\n\t\t}\n\n\t\tpoint.set(\n\t\t\tpx.calc( weight ),\n\t\t\tpy.calc( weight ),\n\t\t\tpz.calc( weight )\n\t\t);\n\n\t\treturn point;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.points = [];\n\n\t\tfor ( let i = 0, l = source.points.length; i < l; i ++ ) {\n\n\t\t\tconst point = source.points[ i ];\n\n\t\t\tthis.points.push( point.clone() );\n\n\t\t}\n\n\t\tthis.closed = source.closed;\n\t\tthis.curveType = source.curveType;\n\t\tthis.tension = source.tension;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.points = [];\n\n\t\tfor ( let i = 0, l = this.points.length; i < l; i ++ ) {\n\n\t\t\tconst point = this.points[ i ];\n\t\t\tdata.points.push( point.toArray() );\n\n\t\t}\n\n\t\tdata.closed = this.closed;\n\t\tdata.curveType = this.curveType;\n\t\tdata.tension = this.tension;\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.points = [];\n\n\t\tfor ( let i = 0, l = json.points.length; i < l; i ++ ) {\n\n\t\t\tconst point = json.points[ i ];\n\t\t\tthis.points.push( new Vector3().fromArray( point ) );\n\n\t\t}\n\n\t\tthis.closed = json.closed;\n\t\tthis.curveType = json.curveType;\n\t\tthis.tension = json.tension;\n\n\t\treturn this;\n\n\t}\n\n}\n\n/**\n * Bezier Curves formulas obtained from\n * https://en.wikipedia.org/wiki/B%C3%A9zier_curve\n */\n\nfunction CatmullRom( t, p0, p1, p2, p3 ) {\n\n\tconst v0 = ( p2 - p0 ) * 0.5;\n\tconst v1 = ( p3 - p1 ) * 0.5;\n\tconst t2 = t * t;\n\tconst t3 = t * t2;\n\treturn ( 2 * p1 - 2 * p2 + v0 + v1 ) * t3 + ( - 3 * p1 + 3 * p2 - 2 * v0 - v1 ) * t2 + v0 * t + p1;\n\n}\n\n//\n\nfunction QuadraticBezierP0( t, p ) {\n\n\tconst k = 1 - t;\n\treturn k * k * p;\n\n}\n\nfunction QuadraticBezierP1( t, p ) {\n\n\treturn 2 * ( 1 - t ) * t * p;\n\n}\n\nfunction QuadraticBezierP2( t, p ) {\n\n\treturn t * t * p;\n\n}\n\nfunction QuadraticBezier( t, p0, p1, p2 ) {\n\n\treturn QuadraticBezierP0( t, p0 ) + QuadraticBezierP1( t, p1 ) +\n\t\tQuadraticBezierP2( t, p2 );\n\n}\n\n//\n\nfunction CubicBezierP0( t, p ) {\n\n\tconst k = 1 - t;\n\treturn k * k * k * p;\n\n}\n\nfunction CubicBezierP1( t, p ) {\n\n\tconst k = 1 - t;\n\treturn 3 * k * k * t * p;\n\n}\n\nfunction CubicBezierP2( t, p ) {\n\n\treturn 3 * ( 1 - t ) * t * t * p;\n\n}\n\nfunction CubicBezierP3( t, p ) {\n\n\treturn t * t * t * p;\n\n}\n\nfunction CubicBezier( t, p0, p1, p2, p3 ) {\n\n\treturn CubicBezierP0( t, p0 ) + CubicBezierP1( t, p1 ) + CubicBezierP2( t, p2 ) +\n\t\tCubicBezierP3( t, p3 );\n\n}\n\nclass CubicBezierCurve extends Curve {\n\n\tconstructor( v0 = new Vector2(), v1 = new Vector2(), v2 = new Vector2(), v3 = new Vector2() ) {\n\n\t\tsuper();\n\n\t\tthis.isCubicBezierCurve = true;\n\n\t\tthis.type = 'CubicBezierCurve';\n\n\t\tthis.v0 = v0;\n\t\tthis.v1 = v1;\n\t\tthis.v2 = v2;\n\t\tthis.v3 = v3;\n\n\t}\n\n\tgetPoint( t, optionalTarget = new Vector2() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tconst v0 = this.v0, v1 = this.v1, v2 = this.v2, v3 = this.v3;\n\n\t\tpoint.set(\n\t\t\tCubicBezier( t, v0.x, v1.x, v2.x, v3.x ),\n\t\t\tCubicBezier( t, v0.y, v1.y, v2.y, v3.y )\n\t\t);\n\n\t\treturn point;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.v0.copy( source.v0 );\n\t\tthis.v1.copy( source.v1 );\n\t\tthis.v2.copy( source.v2 );\n\t\tthis.v3.copy( source.v3 );\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.v0 = this.v0.toArray();\n\t\tdata.v1 = this.v1.toArray();\n\t\tdata.v2 = this.v2.toArray();\n\t\tdata.v3 = this.v3.toArray();\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.v0.fromArray( json.v0 );\n\t\tthis.v1.fromArray( json.v1 );\n\t\tthis.v2.fromArray( json.v2 );\n\t\tthis.v3.fromArray( json.v3 );\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass CubicBezierCurve3 extends Curve {\n\n\tconstructor( v0 = new Vector3(), v1 = new Vector3(), v2 = new Vector3(), v3 = new Vector3() ) {\n\n\t\tsuper();\n\n\t\tthis.isCubicBezierCurve3 = true;\n\n\t\tthis.type = 'CubicBezierCurve3';\n\n\t\tthis.v0 = v0;\n\t\tthis.v1 = v1;\n\t\tthis.v2 = v2;\n\t\tthis.v3 = v3;\n\n\t}\n\n\tgetPoint( t, optionalTarget = new Vector3() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tconst v0 = this.v0, v1 = this.v1, v2 = this.v2, v3 = this.v3;\n\n\t\tpoint.set(\n\t\t\tCubicBezier( t, v0.x, v1.x, v2.x, v3.x ),\n\t\t\tCubicBezier( t, v0.y, v1.y, v2.y, v3.y ),\n\t\t\tCubicBezier( t, v0.z, v1.z, v2.z, v3.z )\n\t\t);\n\n\t\treturn point;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.v0.copy( source.v0 );\n\t\tthis.v1.copy( source.v1 );\n\t\tthis.v2.copy( source.v2 );\n\t\tthis.v3.copy( source.v3 );\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.v0 = this.v0.toArray();\n\t\tdata.v1 = this.v1.toArray();\n\t\tdata.v2 = this.v2.toArray();\n\t\tdata.v3 = this.v3.toArray();\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.v0.fromArray( json.v0 );\n\t\tthis.v1.fromArray( json.v1 );\n\t\tthis.v2.fromArray( json.v2 );\n\t\tthis.v3.fromArray( json.v3 );\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass LineCurve extends Curve {\n\n\tconstructor( v1 = new Vector2(), v2 = new Vector2() ) {\n\n\t\tsuper();\n\n\t\tthis.isLineCurve = true;\n\n\t\tthis.type = 'LineCurve';\n\n\t\tthis.v1 = v1;\n\t\tthis.v2 = v2;\n\n\t}\n\n\tgetPoint( t, optionalTarget = new Vector2() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tif ( t === 1 ) {\n\n\t\t\tpoint.copy( this.v2 );\n\n\t\t} else {\n\n\t\t\tpoint.copy( this.v2 ).sub( this.v1 );\n\t\t\tpoint.multiplyScalar( t ).add( this.v1 );\n\n\t\t}\n\n\t\treturn point;\n\n\t}\n\n\t// Line curve is linear, so we can overwrite default getPointAt\n\tgetPointAt( u, optionalTarget ) {\n\n\t\treturn this.getPoint( u, optionalTarget );\n\n\t}\n\n\tgetTangent( t, optionalTarget ) {\n\n\t\tconst tangent = optionalTarget || new Vector2();\n\n\t\ttangent.copy( this.v2 ).sub( this.v1 ).normalize();\n\n\t\treturn tangent;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.v1.copy( source.v1 );\n\t\tthis.v2.copy( source.v2 );\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.v1 = this.v1.toArray();\n\t\tdata.v2 = this.v2.toArray();\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.v1.fromArray( json.v1 );\n\t\tthis.v2.fromArray( json.v2 );\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass LineCurve3 extends Curve {\n\n\tconstructor( v1 = new Vector3(), v2 = new Vector3() ) {\n\n\t\tsuper();\n\n\t\tthis.isLineCurve3 = true;\n\n\t\tthis.type = 'LineCurve3';\n\n\t\tthis.v1 = v1;\n\t\tthis.v2 = v2;\n\n\t}\n\tgetPoint( t, optionalTarget = new Vector3() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tif ( t === 1 ) {\n\n\t\t\tpoint.copy( this.v2 );\n\n\t\t} else {\n\n\t\t\tpoint.copy( this.v2 ).sub( this.v1 );\n\t\t\tpoint.multiplyScalar( t ).add( this.v1 );\n\n\t\t}\n\n\t\treturn point;\n\n\t}\n\t// Line curve is linear, so we can overwrite default getPointAt\n\tgetPointAt( u, optionalTarget ) {\n\n\t\treturn this.getPoint( u, optionalTarget );\n\n\t}\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.v1.copy( source.v1 );\n\t\tthis.v2.copy( source.v2 );\n\n\t\treturn this;\n\n\t}\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.v1 = this.v1.toArray();\n\t\tdata.v2 = this.v2.toArray();\n\n\t\treturn data;\n\n\t}\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.v1.fromArray( json.v1 );\n\t\tthis.v2.fromArray( json.v2 );\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass QuadraticBezierCurve extends Curve {\n\n\tconstructor( v0 = new Vector2(), v1 = new Vector2(), v2 = new Vector2() ) {\n\n\t\tsuper();\n\n\t\tthis.isQuadraticBezierCurve = true;\n\n\t\tthis.type = 'QuadraticBezierCurve';\n\n\t\tthis.v0 = v0;\n\t\tthis.v1 = v1;\n\t\tthis.v2 = v2;\n\n\t}\n\n\tgetPoint( t, optionalTarget = new Vector2() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tconst v0 = this.v0, v1 = this.v1, v2 = this.v2;\n\n\t\tpoint.set(\n\t\t\tQuadraticBezier( t, v0.x, v1.x, v2.x ),\n\t\t\tQuadraticBezier( t, v0.y, v1.y, v2.y )\n\t\t);\n\n\t\treturn point;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.v0.copy( source.v0 );\n\t\tthis.v1.copy( source.v1 );\n\t\tthis.v2.copy( source.v2 );\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.v0 = this.v0.toArray();\n\t\tdata.v1 = this.v1.toArray();\n\t\tdata.v2 = this.v2.toArray();\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.v0.fromArray( json.v0 );\n\t\tthis.v1.fromArray( json.v1 );\n\t\tthis.v2.fromArray( json.v2 );\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass QuadraticBezierCurve3 extends Curve {\n\n\tconstructor( v0 = new Vector3(), v1 = new Vector3(), v2 = new Vector3() ) {\n\n\t\tsuper();\n\n\t\tthis.isQuadraticBezierCurve3 = true;\n\n\t\tthis.type = 'QuadraticBezierCurve3';\n\n\t\tthis.v0 = v0;\n\t\tthis.v1 = v1;\n\t\tthis.v2 = v2;\n\n\t}\n\n\tgetPoint( t, optionalTarget = new Vector3() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tconst v0 = this.v0, v1 = this.v1, v2 = this.v2;\n\n\t\tpoint.set(\n\t\t\tQuadraticBezier( t, v0.x, v1.x, v2.x ),\n\t\t\tQuadraticBezier( t, v0.y, v1.y, v2.y ),\n\t\t\tQuadraticBezier( t, v0.z, v1.z, v2.z )\n\t\t);\n\n\t\treturn point;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.v0.copy( source.v0 );\n\t\tthis.v1.copy( source.v1 );\n\t\tthis.v2.copy( source.v2 );\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.v0 = this.v0.toArray();\n\t\tdata.v1 = this.v1.toArray();\n\t\tdata.v2 = this.v2.toArray();\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.v0.fromArray( json.v0 );\n\t\tthis.v1.fromArray( json.v1 );\n\t\tthis.v2.fromArray( json.v2 );\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass SplineCurve extends Curve {\n\n\tconstructor( points = [] ) {\n\n\t\tsuper();\n\n\t\tthis.isSplineCurve = true;\n\n\t\tthis.type = 'SplineCurve';\n\n\t\tthis.points = points;\n\n\t}\n\n\tgetPoint( t, optionalTarget = new Vector2() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tconst points = this.points;\n\t\tconst p = ( points.length - 1 ) * t;\n\n\t\tconst intPoint = Math.floor( p );\n\t\tconst weight = p - intPoint;\n\n\t\tconst p0 = points[ intPoint === 0 ? intPoint : intPoint - 1 ];\n\t\tconst p1 = points[ intPoint ];\n\t\tconst p2 = points[ intPoint > points.length - 2 ? points.length - 1 : intPoint + 1 ];\n\t\tconst p3 = points[ intPoint > points.length - 3 ? points.length - 1 : intPoint + 2 ];\n\n\t\tpoint.set(\n\t\t\tCatmullRom( weight, p0.x, p1.x, p2.x, p3.x ),\n\t\t\tCatmullRom( weight, p0.y, p1.y, p2.y, p3.y )\n\t\t);\n\n\t\treturn point;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.points = [];\n\n\t\tfor ( let i = 0, l = source.points.length; i < l; i ++ ) {\n\n\t\t\tconst point = source.points[ i ];\n\n\t\t\tthis.points.push( point.clone() );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.points = [];\n\n\t\tfor ( let i = 0, l = this.points.length; i < l; i ++ ) {\n\n\t\t\tconst point = this.points[ i ];\n\t\t\tdata.points.push( point.toArray() );\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.points = [];\n\n\t\tfor ( let i = 0, l = json.points.length; i < l; i ++ ) {\n\n\t\t\tconst point = json.points[ i ];\n\t\t\tthis.points.push( new Vector2().fromArray( point ) );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n}\n\nvar Curves = /*#__PURE__*/Object.freeze({\n\t__proto__: null,\n\tArcCurve: ArcCurve,\n\tCatmullRomCurve3: CatmullRomCurve3,\n\tCubicBezierCurve: CubicBezierCurve,\n\tCubicBezierCurve3: CubicBezierCurve3,\n\tEllipseCurve: EllipseCurve,\n\tLineCurve: LineCurve,\n\tLineCurve3: LineCurve3,\n\tQuadraticBezierCurve: QuadraticBezierCurve,\n\tQuadraticBezierCurve3: QuadraticBezierCurve3,\n\tSplineCurve: SplineCurve\n});\n\n/**************************************************************\n *\tCurved Path - a curve path is simply a array of connected\n *  curves, but retains the api of a curve\n **************************************************************/\n\nclass CurvePath extends Curve {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.type = 'CurvePath';\n\n\t\tthis.curves = [];\n\t\tthis.autoClose = false; // Automatically closes the path\n\n\t}\n\n\tadd( curve ) {\n\n\t\tthis.curves.push( curve );\n\n\t}\n\n\tclosePath() {\n\n\t\t// Add a line curve if start and end of lines are not connected\n\t\tconst startPoint = this.curves[ 0 ].getPoint( 0 );\n\t\tconst endPoint = this.curves[ this.curves.length - 1 ].getPoint( 1 );\n\n\t\tif ( ! startPoint.equals( endPoint ) ) {\n\n\t\t\tthis.curves.push( new LineCurve( endPoint, startPoint ) );\n\n\t\t}\n\n\t}\n\n\t// To get accurate point with reference to\n\t// entire path distance at time t,\n\t// following has to be done:\n\n\t// 1. Length of each sub path have to be known\n\t// 2. Locate and identify type of curve\n\t// 3. Get t for the curve\n\t// 4. Return curve.getPointAt(t')\n\n\tgetPoint( t, optionalTarget ) {\n\n\t\tconst d = t * this.getLength();\n\t\tconst curveLengths = this.getCurveLengths();\n\t\tlet i = 0;\n\n\t\t// To think about boundaries points.\n\n\t\twhile ( i < curveLengths.length ) {\n\n\t\t\tif ( curveLengths[ i ] >= d ) {\n\n\t\t\t\tconst diff = curveLengths[ i ] - d;\n\t\t\t\tconst curve = this.curves[ i ];\n\n\t\t\t\tconst segmentLength = curve.getLength();\n\t\t\t\tconst u = segmentLength === 0 ? 0 : 1 - diff / segmentLength;\n\n\t\t\t\treturn curve.getPointAt( u, optionalTarget );\n\n\t\t\t}\n\n\t\t\ti ++;\n\n\t\t}\n\n\t\treturn null;\n\n\t\t// loop where sum != 0, sum > d , sum+1 <d\n\n\t}\n\n\t// We cannot use the default THREE.Curve getPoint() with getLength() because in\n\t// THREE.Curve, getLength() depends on getPoint() but in THREE.CurvePath\n\t// getPoint() depends on getLength\n\n\tgetLength() {\n\n\t\tconst lens = this.getCurveLengths();\n\t\treturn lens[ lens.length - 1 ];\n\n\t}\n\n\t// cacheLengths must be recalculated.\n\tupdateArcLengths() {\n\n\t\tthis.needsUpdate = true;\n\t\tthis.cacheLengths = null;\n\t\tthis.getCurveLengths();\n\n\t}\n\n\t// Compute lengths and cache them\n\t// We cannot overwrite getLengths() because UtoT mapping uses it.\n\n\tgetCurveLengths() {\n\n\t\t// We use cache values if curves and cache array are same length\n\n\t\tif ( this.cacheLengths && this.cacheLengths.length === this.curves.length ) {\n\n\t\t\treturn this.cacheLengths;\n\n\t\t}\n\n\t\t// Get length of sub-curve\n\t\t// Push sums into cached array\n\n\t\tconst lengths = [];\n\t\tlet sums = 0;\n\n\t\tfor ( let i = 0, l = this.curves.length; i < l; i ++ ) {\n\n\t\t\tsums += this.curves[ i ].getLength();\n\t\t\tlengths.push( sums );\n\n\t\t}\n\n\t\tthis.cacheLengths = lengths;\n\n\t\treturn lengths;\n\n\t}\n\n\tgetSpacedPoints( divisions = 40 ) {\n\n\t\tconst points = [];\n\n\t\tfor ( let i = 0; i <= divisions; i ++ ) {\n\n\t\t\tpoints.push( this.getPoint( i / divisions ) );\n\n\t\t}\n\n\t\tif ( this.autoClose ) {\n\n\t\t\tpoints.push( points[ 0 ] );\n\n\t\t}\n\n\t\treturn points;\n\n\t}\n\n\tgetPoints( divisions = 12 ) {\n\n\t\tconst points = [];\n\t\tlet last;\n\n\t\tfor ( let i = 0, curves = this.curves; i < curves.length; i ++ ) {\n\n\t\t\tconst curve = curves[ i ];\n\t\t\tconst resolution = curve.isEllipseCurve ? divisions * 2\n\t\t\t\t: ( curve.isLineCurve || curve.isLineCurve3 ) ? 1\n\t\t\t\t\t: curve.isSplineCurve ? divisions * curve.points.length\n\t\t\t\t\t\t: divisions;\n\n\t\t\tconst pts = curve.getPoints( resolution );\n\n\t\t\tfor ( let j = 0; j < pts.length; j ++ ) {\n\n\t\t\t\tconst point = pts[ j ];\n\n\t\t\t\tif ( last && last.equals( point ) ) continue; // ensures no consecutive points are duplicates\n\n\t\t\t\tpoints.push( point );\n\t\t\t\tlast = point;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( this.autoClose && points.length > 1 && ! points[ points.length - 1 ].equals( points[ 0 ] ) ) {\n\n\t\t\tpoints.push( points[ 0 ] );\n\n\t\t}\n\n\t\treturn points;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.curves = [];\n\n\t\tfor ( let i = 0, l = source.curves.length; i < l; i ++ ) {\n\n\t\t\tconst curve = source.curves[ i ];\n\n\t\t\tthis.curves.push( curve.clone() );\n\n\t\t}\n\n\t\tthis.autoClose = source.autoClose;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.autoClose = this.autoClose;\n\t\tdata.curves = [];\n\n\t\tfor ( let i = 0, l = this.curves.length; i < l; i ++ ) {\n\n\t\t\tconst curve = this.curves[ i ];\n\t\t\tdata.curves.push( curve.toJSON() );\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.autoClose = json.autoClose;\n\t\tthis.curves = [];\n\n\t\tfor ( let i = 0, l = json.curves.length; i < l; i ++ ) {\n\n\t\t\tconst curve = json.curves[ i ];\n\t\t\tthis.curves.push( new Curves[ curve.type ]().fromJSON( curve ) );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass Path extends CurvePath {\n\n\tconstructor( points ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'Path';\n\n\t\tthis.currentPoint = new Vector2();\n\n\t\tif ( points ) {\n\n\t\t\tthis.setFromPoints( points );\n\n\t\t}\n\n\t}\n\n\tsetFromPoints( points ) {\n\n\t\tthis.moveTo( points[ 0 ].x, points[ 0 ].y );\n\n\t\tfor ( let i = 1, l = points.length; i < l; i ++ ) {\n\n\t\t\tthis.lineTo( points[ i ].x, points[ i ].y );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tmoveTo( x, y ) {\n\n\t\tthis.currentPoint.set( x, y ); // TODO consider referencing vectors instead of copying?\n\n\t\treturn this;\n\n\t}\n\n\tlineTo( x, y ) {\n\n\t\tconst curve = new LineCurve( this.currentPoint.clone(), new Vector2( x, y ) );\n\t\tthis.curves.push( curve );\n\n\t\tthis.currentPoint.set( x, y );\n\n\t\treturn this;\n\n\t}\n\n\tquadraticCurveTo( aCPx, aCPy, aX, aY ) {\n\n\t\tconst curve = new QuadraticBezierCurve(\n\t\t\tthis.currentPoint.clone(),\n\t\t\tnew Vector2( aCPx, aCPy ),\n\t\t\tnew Vector2( aX, aY )\n\t\t);\n\n\t\tthis.curves.push( curve );\n\n\t\tthis.currentPoint.set( aX, aY );\n\n\t\treturn this;\n\n\t}\n\n\tbezierCurveTo( aCP1x, aCP1y, aCP2x, aCP2y, aX, aY ) {\n\n\t\tconst curve = new CubicBezierCurve(\n\t\t\tthis.currentPoint.clone(),\n\t\t\tnew Vector2( aCP1x, aCP1y ),\n\t\t\tnew Vector2( aCP2x, aCP2y ),\n\t\t\tnew Vector2( aX, aY )\n\t\t);\n\n\t\tthis.curves.push( curve );\n\n\t\tthis.currentPoint.set( aX, aY );\n\n\t\treturn this;\n\n\t}\n\n\tsplineThru( pts /*Array of Vector*/ ) {\n\n\t\tconst npts = [ this.currentPoint.clone() ].concat( pts );\n\n\t\tconst curve = new SplineCurve( npts );\n\t\tthis.curves.push( curve );\n\n\t\tthis.currentPoint.copy( pts[ pts.length - 1 ] );\n\n\t\treturn this;\n\n\t}\n\n\tarc( aX, aY, aRadius, aStartAngle, aEndAngle, aClockwise ) {\n\n\t\tconst x0 = this.currentPoint.x;\n\t\tconst y0 = this.currentPoint.y;\n\n\t\tthis.absarc( aX + x0, aY + y0, aRadius,\n\t\t\taStartAngle, aEndAngle, aClockwise );\n\n\t\treturn this;\n\n\t}\n\n\tabsarc( aX, aY, aRadius, aStartAngle, aEndAngle, aClockwise ) {\n\n\t\tthis.absellipse( aX, aY, aRadius, aRadius, aStartAngle, aEndAngle, aClockwise );\n\n\t\treturn this;\n\n\t}\n\n\tellipse( aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation ) {\n\n\t\tconst x0 = this.currentPoint.x;\n\t\tconst y0 = this.currentPoint.y;\n\n\t\tthis.absellipse( aX + x0, aY + y0, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation );\n\n\t\treturn this;\n\n\t}\n\n\tabsellipse( aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation ) {\n\n\t\tconst curve = new EllipseCurve( aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation );\n\n\t\tif ( this.curves.length > 0 ) {\n\n\t\t\t// if a previous curve is present, attempt to join\n\t\t\tconst firstPoint = curve.getPoint( 0 );\n\n\t\t\tif ( ! firstPoint.equals( this.currentPoint ) ) {\n\n\t\t\t\tthis.lineTo( firstPoint.x, firstPoint.y );\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.curves.push( curve );\n\n\t\tconst lastPoint = curve.getPoint( 1 );\n\t\tthis.currentPoint.copy( lastPoint );\n\n\t\treturn this;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.currentPoint.copy( source.currentPoint );\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.currentPoint = this.currentPoint.toArray();\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.currentPoint.fromArray( json.currentPoint );\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass LatheGeometry extends BufferGeometry {\n\n\tconstructor( points = [ new Vector2( 0, - 0.5 ), new Vector2( 0.5, 0 ), new Vector2( 0, 0.5 ) ], segments = 12, phiStart = 0, phiLength = Math.PI * 2 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'LatheGeometry';\n\n\t\tthis.parameters = {\n\t\t\tpoints: points,\n\t\t\tsegments: segments,\n\t\t\tphiStart: phiStart,\n\t\t\tphiLength: phiLength\n\t\t};\n\n\t\tsegments = Math.floor( segments );\n\n\t\t// clamp phiLength so it's in range of [ 0, 2PI ]\n\n\t\tphiLength = clamp( phiLength, 0, Math.PI * 2 );\n\n\t\t// buffers\n\n\t\tconst indices = [];\n\t\tconst vertices = [];\n\t\tconst uvs = [];\n\t\tconst initNormals = [];\n\t\tconst normals = [];\n\n\t\t// helper variables\n\n\t\tconst inverseSegments = 1.0 / segments;\n\t\tconst vertex = new Vector3();\n\t\tconst uv = new Vector2();\n\t\tconst normal = new Vector3();\n\t\tconst curNormal = new Vector3();\n\t\tconst prevNormal = new Vector3();\n\t\tlet dx = 0;\n\t\tlet dy = 0;\n\n\t\t// pre-compute normals for initial \"meridian\"\n\n\t\tfor ( let j = 0; j <= ( points.length - 1 ); j ++ ) {\n\n\t\t\tswitch ( j ) {\n\n\t\t\t\tcase 0:\t\t\t\t// special handling for 1st vertex on path\n\n\t\t\t\t\tdx = points[ j + 1 ].x - points[ j ].x;\n\t\t\t\t\tdy = points[ j + 1 ].y - points[ j ].y;\n\n\t\t\t\t\tnormal.x = dy * 1.0;\n\t\t\t\t\tnormal.y = - dx;\n\t\t\t\t\tnormal.z = dy * 0.0;\n\n\t\t\t\t\tprevNormal.copy( normal );\n\n\t\t\t\t\tnormal.normalize();\n\n\t\t\t\t\tinitNormals.push( normal.x, normal.y, normal.z );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase ( points.length - 1 ):\t// special handling for last Vertex on path\n\n\t\t\t\t\tinitNormals.push( prevNormal.x, prevNormal.y, prevNormal.z );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\t\t\t// default handling for all vertices in between\n\n\t\t\t\t\tdx = points[ j + 1 ].x - points[ j ].x;\n\t\t\t\t\tdy = points[ j + 1 ].y - points[ j ].y;\n\n\t\t\t\t\tnormal.x = dy * 1.0;\n\t\t\t\t\tnormal.y = - dx;\n\t\t\t\t\tnormal.z = dy * 0.0;\n\n\t\t\t\t\tcurNormal.copy( normal );\n\n\t\t\t\t\tnormal.x += prevNormal.x;\n\t\t\t\t\tnormal.y += prevNormal.y;\n\t\t\t\t\tnormal.z += prevNormal.z;\n\n\t\t\t\t\tnormal.normalize();\n\n\t\t\t\t\tinitNormals.push( normal.x, normal.y, normal.z );\n\n\t\t\t\t\tprevNormal.copy( curNormal );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// generate vertices, uvs and normals\n\n\t\tfor ( let i = 0; i <= segments; i ++ ) {\n\n\t\t\tconst phi = phiStart + i * inverseSegments * phiLength;\n\n\t\t\tconst sin = Math.sin( phi );\n\t\t\tconst cos = Math.cos( phi );\n\n\t\t\tfor ( let j = 0; j <= ( points.length - 1 ); j ++ ) {\n\n\t\t\t\t// vertex\n\n\t\t\t\tvertex.x = points[ j ].x * sin;\n\t\t\t\tvertex.y = points[ j ].y;\n\t\t\t\tvertex.z = points[ j ].x * cos;\n\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\n\n\t\t\t\t// uv\n\n\t\t\t\tuv.x = i / segments;\n\t\t\t\tuv.y = j / ( points.length - 1 );\n\n\t\t\t\tuvs.push( uv.x, uv.y );\n\n\t\t\t\t// normal\n\n\t\t\t\tconst x = initNormals[ 3 * j + 0 ] * sin;\n\t\t\t\tconst y = initNormals[ 3 * j + 1 ];\n\t\t\t\tconst z = initNormals[ 3 * j + 0 ] * cos;\n\n\t\t\t\tnormals.push( x, y, z );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// indices\n\n\t\tfor ( let i = 0; i < segments; i ++ ) {\n\n\t\t\tfor ( let j = 0; j < ( points.length - 1 ); j ++ ) {\n\n\t\t\t\tconst base = j + i * points.length;\n\n\t\t\t\tconst a = base;\n\t\t\t\tconst b = base + points.length;\n\t\t\t\tconst c = base + points.length + 1;\n\t\t\t\tconst d = base + 1;\n\n\t\t\t\t// faces\n\n\t\t\t\tindices.push( a, b, d );\n\t\t\t\tindices.push( c, d, b );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// build geometry\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new LatheGeometry( data.points, data.segments, data.phiStart, data.phiLength );\n\n\t}\n\n}\n\nclass CapsuleGeometry extends LatheGeometry {\n\n\tconstructor( radius = 1, length = 1, capSegments = 4, radialSegments = 8 ) {\n\n\t\tconst path = new Path();\n\t\tpath.absarc( 0, - length / 2, radius, Math.PI * 1.5, 0 );\n\t\tpath.absarc( 0, length / 2, radius, 0, Math.PI * 0.5 );\n\n\t\tsuper( path.getPoints( capSegments ), radialSegments );\n\n\t\tthis.type = 'CapsuleGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\theight: length,\n\t\t\tcapSegments: capSegments,\n\t\t\tradialSegments: radialSegments,\n\t\t};\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new CapsuleGeometry( data.radius, data.length, data.capSegments, data.radialSegments );\n\n\t}\n\n}\n\nclass CircleGeometry extends BufferGeometry {\n\n\tconstructor( radius = 1, segments = 32, thetaStart = 0, thetaLength = Math.PI * 2 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'CircleGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\tsegments: segments,\n\t\t\tthetaStart: thetaStart,\n\t\t\tthetaLength: thetaLength\n\t\t};\n\n\t\tsegments = Math.max( 3, segments );\n\n\t\t// buffers\n\n\t\tconst indices = [];\n\t\tconst vertices = [];\n\t\tconst normals = [];\n\t\tconst uvs = [];\n\n\t\t// helper variables\n\n\t\tconst vertex = new Vector3();\n\t\tconst uv = new Vector2();\n\n\t\t// center point\n\n\t\tvertices.push( 0, 0, 0 );\n\t\tnormals.push( 0, 0, 1 );\n\t\tuvs.push( 0.5, 0.5 );\n\n\t\tfor ( let s = 0, i = 3; s <= segments; s ++, i += 3 ) {\n\n\t\t\tconst segment = thetaStart + s / segments * thetaLength;\n\n\t\t\t// vertex\n\n\t\t\tvertex.x = radius * Math.cos( segment );\n\t\t\tvertex.y = radius * Math.sin( segment );\n\n\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\n\n\t\t\t// normal\n\n\t\t\tnormals.push( 0, 0, 1 );\n\n\t\t\t// uvs\n\n\t\t\tuv.x = ( vertices[ i ] / radius + 1 ) / 2;\n\t\t\tuv.y = ( vertices[ i + 1 ] / radius + 1 ) / 2;\n\n\t\t\tuvs.push( uv.x, uv.y );\n\n\t\t}\n\n\t\t// indices\n\n\t\tfor ( let i = 1; i <= segments; i ++ ) {\n\n\t\t\tindices.push( i, i + 1, 0 );\n\n\t\t}\n\n\t\t// build geometry\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new CircleGeometry( data.radius, data.segments, data.thetaStart, data.thetaLength );\n\n\t}\n\n}\n\nclass CylinderGeometry extends BufferGeometry {\n\n\tconstructor( radiusTop = 1, radiusBottom = 1, height = 1, radialSegments = 32, heightSegments = 1, openEnded = false, thetaStart = 0, thetaLength = Math.PI * 2 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'CylinderGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradiusTop: radiusTop,\n\t\t\tradiusBottom: radiusBottom,\n\t\t\theight: height,\n\t\t\tradialSegments: radialSegments,\n\t\t\theightSegments: heightSegments,\n\t\t\topenEnded: openEnded,\n\t\t\tthetaStart: thetaStart,\n\t\t\tthetaLength: thetaLength\n\t\t};\n\n\t\tconst scope = this;\n\n\t\tradialSegments = Math.floor( radialSegments );\n\t\theightSegments = Math.floor( heightSegments );\n\n\t\t// buffers\n\n\t\tconst indices = [];\n\t\tconst vertices = [];\n\t\tconst normals = [];\n\t\tconst uvs = [];\n\n\t\t// helper variables\n\n\t\tlet index = 0;\n\t\tconst indexArray = [];\n\t\tconst halfHeight = height / 2;\n\t\tlet groupStart = 0;\n\n\t\t// generate geometry\n\n\t\tgenerateTorso();\n\n\t\tif ( openEnded === false ) {\n\n\t\t\tif ( radiusTop > 0 ) generateCap( true );\n\t\t\tif ( radiusBottom > 0 ) generateCap( false );\n\n\t\t}\n\n\t\t// build geometry\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\t\tfunction generateTorso() {\n\n\t\t\tconst normal = new Vector3();\n\t\t\tconst vertex = new Vector3();\n\n\t\t\tlet groupCount = 0;\n\n\t\t\t// this will be used to calculate the normal\n\t\t\tconst slope = ( radiusBottom - radiusTop ) / height;\n\n\t\t\t// generate vertices, normals and uvs\n\n\t\t\tfor ( let y = 0; y <= heightSegments; y ++ ) {\n\n\t\t\t\tconst indexRow = [];\n\n\t\t\t\tconst v = y / heightSegments;\n\n\t\t\t\t// calculate the radius of the current row\n\n\t\t\t\tconst radius = v * ( radiusBottom - radiusTop ) + radiusTop;\n\n\t\t\t\tfor ( let x = 0; x <= radialSegments; x ++ ) {\n\n\t\t\t\t\tconst u = x / radialSegments;\n\n\t\t\t\t\tconst theta = u * thetaLength + thetaStart;\n\n\t\t\t\t\tconst sinTheta = Math.sin( theta );\n\t\t\t\t\tconst cosTheta = Math.cos( theta );\n\n\t\t\t\t\t// vertex\n\n\t\t\t\t\tvertex.x = radius * sinTheta;\n\t\t\t\t\tvertex.y = - v * height + halfHeight;\n\t\t\t\t\tvertex.z = radius * cosTheta;\n\t\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\n\n\t\t\t\t\t// normal\n\n\t\t\t\t\tnormal.set( sinTheta, slope, cosTheta ).normalize();\n\t\t\t\t\tnormals.push( normal.x, normal.y, normal.z );\n\n\t\t\t\t\t// uv\n\n\t\t\t\t\tuvs.push( u, 1 - v );\n\n\t\t\t\t\t// save index of vertex in respective row\n\n\t\t\t\t\tindexRow.push( index ++ );\n\n\t\t\t\t}\n\n\t\t\t\t// now save vertices of the row in our index array\n\n\t\t\t\tindexArray.push( indexRow );\n\n\t\t\t}\n\n\t\t\t// generate indices\n\n\t\t\tfor ( let x = 0; x < radialSegments; x ++ ) {\n\n\t\t\t\tfor ( let y = 0; y < heightSegments; y ++ ) {\n\n\t\t\t\t\t// we use the index array to access the correct indices\n\n\t\t\t\t\tconst a = indexArray[ y ][ x ];\n\t\t\t\t\tconst b = indexArray[ y + 1 ][ x ];\n\t\t\t\t\tconst c = indexArray[ y + 1 ][ x + 1 ];\n\t\t\t\t\tconst d = indexArray[ y ][ x + 1 ];\n\n\t\t\t\t\t// faces\n\n\t\t\t\t\tindices.push( a, b, d );\n\t\t\t\t\tindices.push( b, c, d );\n\n\t\t\t\t\t// update group counter\n\n\t\t\t\t\tgroupCount += 6;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// add a group to the geometry. this will ensure multi material support\n\n\t\t\tscope.addGroup( groupStart, groupCount, 0 );\n\n\t\t\t// calculate new start value for groups\n\n\t\t\tgroupStart += groupCount;\n\n\t\t}\n\n\t\tfunction generateCap( top ) {\n\n\t\t\t// save the index of the first center vertex\n\t\t\tconst centerIndexStart = index;\n\n\t\t\tconst uv = new Vector2();\n\t\t\tconst vertex = new Vector3();\n\n\t\t\tlet groupCount = 0;\n\n\t\t\tconst radius = ( top === true ) ? radiusTop : radiusBottom;\n\t\t\tconst sign = ( top === true ) ? 1 : - 1;\n\n\t\t\t// first we generate the center vertex data of the cap.\n\t\t\t// because the geometry needs one set of uvs per face,\n\t\t\t// we must generate a center vertex per face/segment\n\n\t\t\tfor ( let x = 1; x <= radialSegments; x ++ ) {\n\n\t\t\t\t// vertex\n\n\t\t\t\tvertices.push( 0, halfHeight * sign, 0 );\n\n\t\t\t\t// normal\n\n\t\t\t\tnormals.push( 0, sign, 0 );\n\n\t\t\t\t// uv\n\n\t\t\t\tuvs.push( 0.5, 0.5 );\n\n\t\t\t\t// increase index\n\n\t\t\t\tindex ++;\n\n\t\t\t}\n\n\t\t\t// save the index of the last center vertex\n\t\t\tconst centerIndexEnd = index;\n\n\t\t\t// now we generate the surrounding vertices, normals and uvs\n\n\t\t\tfor ( let x = 0; x <= radialSegments; x ++ ) {\n\n\t\t\t\tconst u = x / radialSegments;\n\t\t\t\tconst theta = u * thetaLength + thetaStart;\n\n\t\t\t\tconst cosTheta = Math.cos( theta );\n\t\t\t\tconst sinTheta = Math.sin( theta );\n\n\t\t\t\t// vertex\n\n\t\t\t\tvertex.x = radius * sinTheta;\n\t\t\t\tvertex.y = halfHeight * sign;\n\t\t\t\tvertex.z = radius * cosTheta;\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\n\n\t\t\t\t// normal\n\n\t\t\t\tnormals.push( 0, sign, 0 );\n\n\t\t\t\t// uv\n\n\t\t\t\tuv.x = ( cosTheta * 0.5 ) + 0.5;\n\t\t\t\tuv.y = ( sinTheta * 0.5 * sign ) + 0.5;\n\t\t\t\tuvs.push( uv.x, uv.y );\n\n\t\t\t\t// increase index\n\n\t\t\t\tindex ++;\n\n\t\t\t}\n\n\t\t\t// generate indices\n\n\t\t\tfor ( let x = 0; x < radialSegments; x ++ ) {\n\n\t\t\t\tconst c = centerIndexStart + x;\n\t\t\t\tconst i = centerIndexEnd + x;\n\n\t\t\t\tif ( top === true ) {\n\n\t\t\t\t\t// face top\n\n\t\t\t\t\tindices.push( i, i + 1, c );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// face bottom\n\n\t\t\t\t\tindices.push( i + 1, i, c );\n\n\t\t\t\t}\n\n\t\t\t\tgroupCount += 3;\n\n\t\t\t}\n\n\t\t\t// add a group to the geometry. this will ensure multi material support\n\n\t\t\tscope.addGroup( groupStart, groupCount, top === true ? 1 : 2 );\n\n\t\t\t// calculate new start value for groups\n\n\t\t\tgroupStart += groupCount;\n\n\t\t}\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new CylinderGeometry( data.radiusTop, data.radiusBottom, data.height, data.radialSegments, data.heightSegments, data.openEnded, data.thetaStart, data.thetaLength );\n\n\t}\n\n}\n\nclass ConeGeometry extends CylinderGeometry {\n\n\tconstructor( radius = 1, height = 1, radialSegments = 32, heightSegments = 1, openEnded = false, thetaStart = 0, thetaLength = Math.PI * 2 ) {\n\n\t\tsuper( 0, radius, height, radialSegments, heightSegments, openEnded, thetaStart, thetaLength );\n\n\t\tthis.type = 'ConeGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\theight: height,\n\t\t\tradialSegments: radialSegments,\n\t\t\theightSegments: heightSegments,\n\t\t\topenEnded: openEnded,\n\t\t\tthetaStart: thetaStart,\n\t\t\tthetaLength: thetaLength\n\t\t};\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new ConeGeometry( data.radius, data.height, data.radialSegments, data.heightSegments, data.openEnded, data.thetaStart, data.thetaLength );\n\n\t}\n\n}\n\nclass PolyhedronGeometry extends BufferGeometry {\n\n\tconstructor( vertices = [], indices = [], radius = 1, detail = 0 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'PolyhedronGeometry';\n\n\t\tthis.parameters = {\n\t\t\tvertices: vertices,\n\t\t\tindices: indices,\n\t\t\tradius: radius,\n\t\t\tdetail: detail\n\t\t};\n\n\t\t// default buffer data\n\n\t\tconst vertexBuffer = [];\n\t\tconst uvBuffer = [];\n\n\t\t// the subdivision creates the vertex buffer data\n\n\t\tsubdivide( detail );\n\n\t\t// all vertices should lie on a conceptual sphere with a given radius\n\n\t\tapplyRadius( radius );\n\n\t\t// finally, create the uv data\n\n\t\tgenerateUVs();\n\n\t\t// build non-indexed geometry\n\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertexBuffer, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( vertexBuffer.slice(), 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvBuffer, 2 ) );\n\n\t\tif ( detail === 0 ) {\n\n\t\t\tthis.computeVertexNormals(); // flat normals\n\n\t\t} else {\n\n\t\t\tthis.normalizeNormals(); // smooth normals\n\n\t\t}\n\n\t\t// helper functions\n\n\t\tfunction subdivide( detail ) {\n\n\t\t\tconst a = new Vector3();\n\t\t\tconst b = new Vector3();\n\t\t\tconst c = new Vector3();\n\n\t\t\t// iterate over all faces and apply a subdivision with the given detail value\n\n\t\t\tfor ( let i = 0; i < indices.length; i += 3 ) {\n\n\t\t\t\t// get the vertices of the face\n\n\t\t\t\tgetVertexByIndex( indices[ i + 0 ], a );\n\t\t\t\tgetVertexByIndex( indices[ i + 1 ], b );\n\t\t\t\tgetVertexByIndex( indices[ i + 2 ], c );\n\n\t\t\t\t// perform subdivision\n\n\t\t\t\tsubdivideFace( a, b, c, detail );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction subdivideFace( a, b, c, detail ) {\n\n\t\t\tconst cols = detail + 1;\n\n\t\t\t// we use this multidimensional array as a data structure for creating the subdivision\n\n\t\t\tconst v = [];\n\n\t\t\t// construct all of the vertices for this subdivision\n\n\t\t\tfor ( let i = 0; i <= cols; i ++ ) {\n\n\t\t\t\tv[ i ] = [];\n\n\t\t\t\tconst aj = a.clone().lerp( c, i / cols );\n\t\t\t\tconst bj = b.clone().lerp( c, i / cols );\n\n\t\t\t\tconst rows = cols - i;\n\n\t\t\t\tfor ( let j = 0; j <= rows; j ++ ) {\n\n\t\t\t\t\tif ( j === 0 && i === cols ) {\n\n\t\t\t\t\t\tv[ i ][ j ] = aj;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tv[ i ][ j ] = aj.clone().lerp( bj, j / rows );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// construct all of the faces\n\n\t\t\tfor ( let i = 0; i < cols; i ++ ) {\n\n\t\t\t\tfor ( let j = 0; j < 2 * ( cols - i ) - 1; j ++ ) {\n\n\t\t\t\t\tconst k = Math.floor( j / 2 );\n\n\t\t\t\t\tif ( j % 2 === 0 ) {\n\n\t\t\t\t\t\tpushVertex( v[ i ][ k + 1 ] );\n\t\t\t\t\t\tpushVertex( v[ i + 1 ][ k ] );\n\t\t\t\t\t\tpushVertex( v[ i ][ k ] );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tpushVertex( v[ i ][ k + 1 ] );\n\t\t\t\t\t\tpushVertex( v[ i + 1 ][ k + 1 ] );\n\t\t\t\t\t\tpushVertex( v[ i + 1 ][ k ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction applyRadius( radius ) {\n\n\t\t\tconst vertex = new Vector3();\n\n\t\t\t// iterate over the entire buffer and apply the radius to each vertex\n\n\t\t\tfor ( let i = 0; i < vertexBuffer.length; i += 3 ) {\n\n\t\t\t\tvertex.x = vertexBuffer[ i + 0 ];\n\t\t\t\tvertex.y = vertexBuffer[ i + 1 ];\n\t\t\t\tvertex.z = vertexBuffer[ i + 2 ];\n\n\t\t\t\tvertex.normalize().multiplyScalar( radius );\n\n\t\t\t\tvertexBuffer[ i + 0 ] = vertex.x;\n\t\t\t\tvertexBuffer[ i + 1 ] = vertex.y;\n\t\t\t\tvertexBuffer[ i + 2 ] = vertex.z;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction generateUVs() {\n\n\t\t\tconst vertex = new Vector3();\n\n\t\t\tfor ( let i = 0; i < vertexBuffer.length; i += 3 ) {\n\n\t\t\t\tvertex.x = vertexBuffer[ i + 0 ];\n\t\t\t\tvertex.y = vertexBuffer[ i + 1 ];\n\t\t\t\tvertex.z = vertexBuffer[ i + 2 ];\n\n\t\t\t\tconst u = azimuth( vertex ) / 2 / Math.PI + 0.5;\n\t\t\t\tconst v = inclination( vertex ) / Math.PI + 0.5;\n\t\t\t\tuvBuffer.push( u, 1 - v );\n\n\t\t\t}\n\n\t\t\tcorrectUVs();\n\n\t\t\tcorrectSeam();\n\n\t\t}\n\n\t\tfunction correctSeam() {\n\n\t\t\t// handle case when face straddles the seam, see #3269\n\n\t\t\tfor ( let i = 0; i < uvBuffer.length; i += 6 ) {\n\n\t\t\t\t// uv data of a single face\n\n\t\t\t\tconst x0 = uvBuffer[ i + 0 ];\n\t\t\t\tconst x1 = uvBuffer[ i + 2 ];\n\t\t\t\tconst x2 = uvBuffer[ i + 4 ];\n\n\t\t\t\tconst max = Math.max( x0, x1, x2 );\n\t\t\t\tconst min = Math.min( x0, x1, x2 );\n\n\t\t\t\t// 0.9 is somewhat arbitrary\n\n\t\t\t\tif ( max > 0.9 && min < 0.1 ) {\n\n\t\t\t\t\tif ( x0 < 0.2 ) uvBuffer[ i + 0 ] += 1;\n\t\t\t\t\tif ( x1 < 0.2 ) uvBuffer[ i + 2 ] += 1;\n\t\t\t\t\tif ( x2 < 0.2 ) uvBuffer[ i + 4 ] += 1;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction pushVertex( vertex ) {\n\n\t\t\tvertexBuffer.push( vertex.x, vertex.y, vertex.z );\n\n\t\t}\n\n\t\tfunction getVertexByIndex( index, vertex ) {\n\n\t\t\tconst stride = index * 3;\n\n\t\t\tvertex.x = vertices[ stride + 0 ];\n\t\t\tvertex.y = vertices[ stride + 1 ];\n\t\t\tvertex.z = vertices[ stride + 2 ];\n\n\t\t}\n\n\t\tfunction correctUVs() {\n\n\t\t\tconst a = new Vector3();\n\t\t\tconst b = new Vector3();\n\t\t\tconst c = new Vector3();\n\n\t\t\tconst centroid = new Vector3();\n\n\t\t\tconst uvA = new Vector2();\n\t\t\tconst uvB = new Vector2();\n\t\t\tconst uvC = new Vector2();\n\n\t\t\tfor ( let i = 0, j = 0; i < vertexBuffer.length; i += 9, j += 6 ) {\n\n\t\t\t\ta.set( vertexBuffer[ i + 0 ], vertexBuffer[ i + 1 ], vertexBuffer[ i + 2 ] );\n\t\t\t\tb.set( vertexBuffer[ i + 3 ], vertexBuffer[ i + 4 ], vertexBuffer[ i + 5 ] );\n\t\t\t\tc.set( vertexBuffer[ i + 6 ], vertexBuffer[ i + 7 ], vertexBuffer[ i + 8 ] );\n\n\t\t\t\tuvA.set( uvBuffer[ j + 0 ], uvBuffer[ j + 1 ] );\n\t\t\t\tuvB.set( uvBuffer[ j + 2 ], uvBuffer[ j + 3 ] );\n\t\t\t\tuvC.set( uvBuffer[ j + 4 ], uvBuffer[ j + 5 ] );\n\n\t\t\t\tcentroid.copy( a ).add( b ).add( c ).divideScalar( 3 );\n\n\t\t\t\tconst azi = azimuth( centroid );\n\n\t\t\t\tcorrectUV( uvA, j + 0, a, azi );\n\t\t\t\tcorrectUV( uvB, j + 2, b, azi );\n\t\t\t\tcorrectUV( uvC, j + 4, c, azi );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction correctUV( uv, stride, vector, azimuth ) {\n\n\t\t\tif ( ( azimuth < 0 ) && ( uv.x === 1 ) ) {\n\n\t\t\t\tuvBuffer[ stride ] = uv.x - 1;\n\n\t\t\t}\n\n\t\t\tif ( ( vector.x === 0 ) && ( vector.z === 0 ) ) {\n\n\t\t\t\tuvBuffer[ stride ] = azimuth / 2 / Math.PI + 0.5;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Angle around the Y axis, counter-clockwise when looking from above.\n\n\t\tfunction azimuth( vector ) {\n\n\t\t\treturn Math.atan2( vector.z, - vector.x );\n\n\t\t}\n\n\n\t\t// Angle above the XZ plane.\n\n\t\tfunction inclination( vector ) {\n\n\t\t\treturn Math.atan2( - vector.y, Math.sqrt( ( vector.x * vector.x ) + ( vector.z * vector.z ) ) );\n\n\t\t}\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new PolyhedronGeometry( data.vertices, data.indices, data.radius, data.details );\n\n\t}\n\n}\n\nclass DodecahedronGeometry extends PolyhedronGeometry {\n\n\tconstructor( radius = 1, detail = 0 ) {\n\n\t\tconst t = ( 1 + Math.sqrt( 5 ) ) / 2;\n\t\tconst r = 1 / t;\n\n\t\tconst vertices = [\n\n\t\t\t// (±1, ±1, ±1)\n\t\t\t- 1, - 1, - 1,\t- 1, - 1, 1,\n\t\t\t- 1, 1, - 1, - 1, 1, 1,\n\t\t\t1, - 1, - 1, 1, - 1, 1,\n\t\t\t1, 1, - 1, 1, 1, 1,\n\n\t\t\t// (0, ±1/φ, ±φ)\n\t\t\t0, - r, - t, 0, - r, t,\n\t\t\t0, r, - t, 0, r, t,\n\n\t\t\t// (±1/φ, ±φ, 0)\n\t\t\t- r, - t, 0, - r, t, 0,\n\t\t\tr, - t, 0, r, t, 0,\n\n\t\t\t// (±φ, 0, ±1/φ)\n\t\t\t- t, 0, - r, t, 0, - r,\n\t\t\t- t, 0, r, t, 0, r\n\t\t];\n\n\t\tconst indices = [\n\t\t\t3, 11, 7, \t3, 7, 15, \t3, 15, 13,\n\t\t\t7, 19, 17, \t7, 17, 6, \t7, 6, 15,\n\t\t\t17, 4, 8, \t17, 8, 10, \t17, 10, 6,\n\t\t\t8, 0, 16, \t8, 16, 2, \t8, 2, 10,\n\t\t\t0, 12, 1, \t0, 1, 18, \t0, 18, 16,\n\t\t\t6, 10, 2, \t6, 2, 13, \t6, 13, 15,\n\t\t\t2, 16, 18, \t2, 18, 3, \t2, 3, 13,\n\t\t\t18, 1, 9, \t18, 9, 11, \t18, 11, 3,\n\t\t\t4, 14, 12, \t4, 12, 0, \t4, 0, 8,\n\t\t\t11, 9, 5, \t11, 5, 19, \t11, 19, 7,\n\t\t\t19, 5, 14, \t19, 14, 4, \t19, 4, 17,\n\t\t\t1, 12, 14, \t1, 14, 5, \t1, 5, 9\n\t\t];\n\n\t\tsuper( vertices, indices, radius, detail );\n\n\t\tthis.type = 'DodecahedronGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\tdetail: detail\n\t\t};\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new DodecahedronGeometry( data.radius, data.detail );\n\n\t}\n\n}\n\nconst _v0 = /*@__PURE__*/ new Vector3();\nconst _v1$1 = /*@__PURE__*/ new Vector3();\nconst _normal = /*@__PURE__*/ new Vector3();\nconst _triangle = /*@__PURE__*/ new Triangle();\n\nclass EdgesGeometry extends BufferGeometry {\n\n\tconstructor( geometry = null, thresholdAngle = 1 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'EdgesGeometry';\n\n\t\tthis.parameters = {\n\t\t\tgeometry: geometry,\n\t\t\tthresholdAngle: thresholdAngle\n\t\t};\n\n\t\tif ( geometry !== null ) {\n\n\t\t\tconst precisionPoints = 4;\n\t\t\tconst precision = Math.pow( 10, precisionPoints );\n\t\t\tconst thresholdDot = Math.cos( DEG2RAD * thresholdAngle );\n\n\t\t\tconst indexAttr = geometry.getIndex();\n\t\t\tconst positionAttr = geometry.getAttribute( 'position' );\n\t\t\tconst indexCount = indexAttr ? indexAttr.count : positionAttr.count;\n\n\t\t\tconst indexArr = [ 0, 0, 0 ];\n\t\t\tconst vertKeys = [ 'a', 'b', 'c' ];\n\t\t\tconst hashes = new Array( 3 );\n\n\t\t\tconst edgeData = {};\n\t\t\tconst vertices = [];\n\t\t\tfor ( let i = 0; i < indexCount; i += 3 ) {\n\n\t\t\t\tif ( indexAttr ) {\n\n\t\t\t\t\tindexArr[ 0 ] = indexAttr.getX( i );\n\t\t\t\t\tindexArr[ 1 ] = indexAttr.getX( i + 1 );\n\t\t\t\t\tindexArr[ 2 ] = indexAttr.getX( i + 2 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tindexArr[ 0 ] = i;\n\t\t\t\t\tindexArr[ 1 ] = i + 1;\n\t\t\t\t\tindexArr[ 2 ] = i + 2;\n\n\t\t\t\t}\n\n\t\t\t\tconst { a, b, c } = _triangle;\n\t\t\t\ta.fromBufferAttribute( positionAttr, indexArr[ 0 ] );\n\t\t\t\tb.fromBufferAttribute( positionAttr, indexArr[ 1 ] );\n\t\t\t\tc.fromBufferAttribute( positionAttr, indexArr[ 2 ] );\n\t\t\t\t_triangle.getNormal( _normal );\n\n\t\t\t\t// create hashes for the edge from the vertices\n\t\t\t\thashes[ 0 ] = `${ Math.round( a.x * precision ) },${ Math.round( a.y * precision ) },${ Math.round( a.z * precision ) }`;\n\t\t\t\thashes[ 1 ] = `${ Math.round( b.x * precision ) },${ Math.round( b.y * precision ) },${ Math.round( b.z * precision ) }`;\n\t\t\t\thashes[ 2 ] = `${ Math.round( c.x * precision ) },${ Math.round( c.y * precision ) },${ Math.round( c.z * precision ) }`;\n\n\t\t\t\t// skip degenerate triangles\n\t\t\t\tif ( hashes[ 0 ] === hashes[ 1 ] || hashes[ 1 ] === hashes[ 2 ] || hashes[ 2 ] === hashes[ 0 ] ) {\n\n\t\t\t\t\tcontinue;\n\n\t\t\t\t}\n\n\t\t\t\t// iterate over every edge\n\t\t\t\tfor ( let j = 0; j < 3; j ++ ) {\n\n\t\t\t\t\t// get the first and next vertex making up the edge\n\t\t\t\t\tconst jNext = ( j + 1 ) % 3;\n\t\t\t\t\tconst vecHash0 = hashes[ j ];\n\t\t\t\t\tconst vecHash1 = hashes[ jNext ];\n\t\t\t\t\tconst v0 = _triangle[ vertKeys[ j ] ];\n\t\t\t\t\tconst v1 = _triangle[ vertKeys[ jNext ] ];\n\n\t\t\t\t\tconst hash = `${ vecHash0 }_${ vecHash1 }`;\n\t\t\t\t\tconst reverseHash = `${ vecHash1 }_${ vecHash0 }`;\n\n\t\t\t\t\tif ( reverseHash in edgeData && edgeData[ reverseHash ] ) {\n\n\t\t\t\t\t\t// if we found a sibling edge add it into the vertex array if\n\t\t\t\t\t\t// it meets the angle threshold and delete the edge from the map.\n\t\t\t\t\t\tif ( _normal.dot( edgeData[ reverseHash ].normal ) <= thresholdDot ) {\n\n\t\t\t\t\t\t\tvertices.push( v0.x, v0.y, v0.z );\n\t\t\t\t\t\t\tvertices.push( v1.x, v1.y, v1.z );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tedgeData[ reverseHash ] = null;\n\n\t\t\t\t\t} else if ( ! ( hash in edgeData ) ) {\n\n\t\t\t\t\t\t// if we've already got an edge here then skip adding a new one\n\t\t\t\t\t\tedgeData[ hash ] = {\n\n\t\t\t\t\t\t\tindex0: indexArr[ j ],\n\t\t\t\t\t\t\tindex1: indexArr[ jNext ],\n\t\t\t\t\t\t\tnormal: _normal.clone(),\n\n\t\t\t\t\t\t};\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// iterate over all remaining, unmatched edges and add them to the vertex array\n\t\t\tfor ( const key in edgeData ) {\n\n\t\t\t\tif ( edgeData[ key ] ) {\n\n\t\t\t\t\tconst { index0, index1 } = edgeData[ key ];\n\t\t\t\t\t_v0.fromBufferAttribute( positionAttr, index0 );\n\t\t\t\t\t_v1$1.fromBufferAttribute( positionAttr, index1 );\n\n\t\t\t\t\tvertices.push( _v0.x, _v0.y, _v0.z );\n\t\t\t\t\tvertices.push( _v1$1.x, _v1$1.y, _v1$1.z );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\n\t\t}\n\n\t}\n\n}\n\nclass Shape extends Path {\n\n\tconstructor( points ) {\n\n\t\tsuper( points );\n\n\t\tthis.uuid = generateUUID();\n\n\t\tthis.type = 'Shape';\n\n\t\tthis.holes = [];\n\n\t}\n\n\tgetPointsHoles( divisions ) {\n\n\t\tconst holesPts = [];\n\n\t\tfor ( let i = 0, l = this.holes.length; i < l; i ++ ) {\n\n\t\t\tholesPts[ i ] = this.holes[ i ].getPoints( divisions );\n\n\t\t}\n\n\t\treturn holesPts;\n\n\t}\n\n\t// get points of shape and holes (keypoints based on segments parameter)\n\n\textractPoints( divisions ) {\n\n\t\treturn {\n\n\t\t\tshape: this.getPoints( divisions ),\n\t\t\tholes: this.getPointsHoles( divisions )\n\n\t\t};\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.holes = [];\n\n\t\tfor ( let i = 0, l = source.holes.length; i < l; i ++ ) {\n\n\t\t\tconst hole = source.holes[ i ];\n\n\t\t\tthis.holes.push( hole.clone() );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.uuid = this.uuid;\n\t\tdata.holes = [];\n\n\t\tfor ( let i = 0, l = this.holes.length; i < l; i ++ ) {\n\n\t\t\tconst hole = this.holes[ i ];\n\t\t\tdata.holes.push( hole.toJSON() );\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.uuid = json.uuid;\n\t\tthis.holes = [];\n\n\t\tfor ( let i = 0, l = json.holes.length; i < l; i ++ ) {\n\n\t\t\tconst hole = json.holes[ i ];\n\t\t\tthis.holes.push( new Path().fromJSON( hole ) );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n}\n\n/**\n * Port from https://github.com/mapbox/earcut (v2.2.4)\n */\n\nconst Earcut = {\n\n\ttriangulate: function ( data, holeIndices, dim = 2 ) {\n\n\t\tconst hasHoles = holeIndices && holeIndices.length;\n\t\tconst outerLen = hasHoles ? holeIndices[ 0 ] * dim : data.length;\n\t\tlet outerNode = linkedList( data, 0, outerLen, dim, true );\n\t\tconst triangles = [];\n\n\t\tif ( ! outerNode || outerNode.next === outerNode.prev ) return triangles;\n\n\t\tlet minX, minY, maxX, maxY, x, y, invSize;\n\n\t\tif ( hasHoles ) outerNode = eliminateHoles( data, holeIndices, outerNode, dim );\n\n\t\t// if the shape is not too simple, we'll use z-order curve hash later; calculate polygon bbox\n\t\tif ( data.length > 80 * dim ) {\n\n\t\t\tminX = maxX = data[ 0 ];\n\t\t\tminY = maxY = data[ 1 ];\n\n\t\t\tfor ( let i = dim; i < outerLen; i += dim ) {\n\n\t\t\t\tx = data[ i ];\n\t\t\t\ty = data[ i + 1 ];\n\t\t\t\tif ( x < minX ) minX = x;\n\t\t\t\tif ( y < minY ) minY = y;\n\t\t\t\tif ( x > maxX ) maxX = x;\n\t\t\t\tif ( y > maxY ) maxY = y;\n\n\t\t\t}\n\n\t\t\t// minX, minY and invSize are later used to transform coords into integers for z-order calculation\n\t\t\tinvSize = Math.max( maxX - minX, maxY - minY );\n\t\t\tinvSize = invSize !== 0 ? 32767 / invSize : 0;\n\n\t\t}\n\n\t\tearcutLinked( outerNode, triangles, dim, minX, minY, invSize, 0 );\n\n\t\treturn triangles;\n\n\t}\n\n};\n\n// create a circular doubly linked list from polygon points in the specified winding order\nfunction linkedList( data, start, end, dim, clockwise ) {\n\n\tlet i, last;\n\n\tif ( clockwise === ( signedArea( data, start, end, dim ) > 0 ) ) {\n\n\t\tfor ( i = start; i < end; i += dim ) last = insertNode( i, data[ i ], data[ i + 1 ], last );\n\n\t} else {\n\n\t\tfor ( i = end - dim; i >= start; i -= dim ) last = insertNode( i, data[ i ], data[ i + 1 ], last );\n\n\t}\n\n\tif ( last && equals( last, last.next ) ) {\n\n\t\tremoveNode( last );\n\t\tlast = last.next;\n\n\t}\n\n\treturn last;\n\n}\n\n// eliminate colinear or duplicate points\nfunction filterPoints( start, end ) {\n\n\tif ( ! start ) return start;\n\tif ( ! end ) end = start;\n\n\tlet p = start,\n\t\tagain;\n\tdo {\n\n\t\tagain = false;\n\n\t\tif ( ! p.steiner && ( equals( p, p.next ) || area( p.prev, p, p.next ) === 0 ) ) {\n\n\t\t\tremoveNode( p );\n\t\t\tp = end = p.prev;\n\t\t\tif ( p === p.next ) break;\n\t\t\tagain = true;\n\n\t\t} else {\n\n\t\t\tp = p.next;\n\n\t\t}\n\n\t} while ( again || p !== end );\n\n\treturn end;\n\n}\n\n// main ear slicing loop which triangulates a polygon (given as a linked list)\nfunction earcutLinked( ear, triangles, dim, minX, minY, invSize, pass ) {\n\n\tif ( ! ear ) return;\n\n\t// interlink polygon nodes in z-order\n\tif ( ! pass && invSize ) indexCurve( ear, minX, minY, invSize );\n\n\tlet stop = ear,\n\t\tprev, next;\n\n\t// iterate through ears, slicing them one by one\n\twhile ( ear.prev !== ear.next ) {\n\n\t\tprev = ear.prev;\n\t\tnext = ear.next;\n\n\t\tif ( invSize ? isEarHashed( ear, minX, minY, invSize ) : isEar( ear ) ) {\n\n\t\t\t// cut off the triangle\n\t\t\ttriangles.push( prev.i / dim | 0 );\n\t\t\ttriangles.push( ear.i / dim | 0 );\n\t\t\ttriangles.push( next.i / dim | 0 );\n\n\t\t\tremoveNode( ear );\n\n\t\t\t// skipping the next vertex leads to less sliver triangles\n\t\t\tear = next.next;\n\t\t\tstop = next.next;\n\n\t\t\tcontinue;\n\n\t\t}\n\n\t\tear = next;\n\n\t\t// if we looped through the whole remaining polygon and can't find any more ears\n\t\tif ( ear === stop ) {\n\n\t\t\t// try filtering points and slicing again\n\t\t\tif ( ! pass ) {\n\n\t\t\t\tearcutLinked( filterPoints( ear ), triangles, dim, minX, minY, invSize, 1 );\n\n\t\t\t\t// if this didn't work, try curing all small self-intersections locally\n\n\t\t\t} else if ( pass === 1 ) {\n\n\t\t\t\tear = cureLocalIntersections( filterPoints( ear ), triangles, dim );\n\t\t\t\tearcutLinked( ear, triangles, dim, minX, minY, invSize, 2 );\n\n\t\t\t\t// as a last resort, try splitting the remaining polygon into two\n\n\t\t\t} else if ( pass === 2 ) {\n\n\t\t\t\tsplitEarcut( ear, triangles, dim, minX, minY, invSize );\n\n\t\t\t}\n\n\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n}\n\n// check whether a polygon node forms a valid ear with adjacent nodes\nfunction isEar( ear ) {\n\n\tconst a = ear.prev,\n\t\tb = ear,\n\t\tc = ear.next;\n\n\tif ( area( a, b, c ) >= 0 ) return false; // reflex, can't be an ear\n\n\t// now make sure we don't have other points inside the potential ear\n\tconst ax = a.x, bx = b.x, cx = c.x, ay = a.y, by = b.y, cy = c.y;\n\n\t// triangle bbox; min & max are calculated like this for speed\n\tconst x0 = ax < bx ? ( ax < cx ? ax : cx ) : ( bx < cx ? bx : cx ),\n\t\ty0 = ay < by ? ( ay < cy ? ay : cy ) : ( by < cy ? by : cy ),\n\t\tx1 = ax > bx ? ( ax > cx ? ax : cx ) : ( bx > cx ? bx : cx ),\n\t\ty1 = ay > by ? ( ay > cy ? ay : cy ) : ( by > cy ? by : cy );\n\n\tlet p = c.next;\n\twhile ( p !== a ) {\n\n\t\tif ( p.x >= x0 && p.x <= x1 && p.y >= y0 && p.y <= y1 &&\n\t\t\tpointInTriangle( ax, ay, bx, by, cx, cy, p.x, p.y ) &&\n\t\t\tarea( p.prev, p, p.next ) >= 0 ) return false;\n\t\tp = p.next;\n\n\t}\n\n\treturn true;\n\n}\n\nfunction isEarHashed( ear, minX, minY, invSize ) {\n\n\tconst a = ear.prev,\n\t\tb = ear,\n\t\tc = ear.next;\n\n\tif ( area( a, b, c ) >= 0 ) return false; // reflex, can't be an ear\n\n\tconst ax = a.x, bx = b.x, cx = c.x, ay = a.y, by = b.y, cy = c.y;\n\n\t// triangle bbox; min & max are calculated like this for speed\n\tconst x0 = ax < bx ? ( ax < cx ? ax : cx ) : ( bx < cx ? bx : cx ),\n\t\ty0 = ay < by ? ( ay < cy ? ay : cy ) : ( by < cy ? by : cy ),\n\t\tx1 = ax > bx ? ( ax > cx ? ax : cx ) : ( bx > cx ? bx : cx ),\n\t\ty1 = ay > by ? ( ay > cy ? ay : cy ) : ( by > cy ? by : cy );\n\n\t// z-order range for the current triangle bbox;\n\tconst minZ = zOrder( x0, y0, minX, minY, invSize ),\n\t\tmaxZ = zOrder( x1, y1, minX, minY, invSize );\n\n\tlet p = ear.prevZ,\n\t\tn = ear.nextZ;\n\n\t// look for points inside the triangle in both directions\n\twhile ( p && p.z >= minZ && n && n.z <= maxZ ) {\n\n\t\tif ( p.x >= x0 && p.x <= x1 && p.y >= y0 && p.y <= y1 && p !== a && p !== c &&\n\t\t\tpointInTriangle( ax, ay, bx, by, cx, cy, p.x, p.y ) && area( p.prev, p, p.next ) >= 0 ) return false;\n\t\tp = p.prevZ;\n\n\t\tif ( n.x >= x0 && n.x <= x1 && n.y >= y0 && n.y <= y1 && n !== a && n !== c &&\n\t\t\tpointInTriangle( ax, ay, bx, by, cx, cy, n.x, n.y ) && area( n.prev, n, n.next ) >= 0 ) return false;\n\t\tn = n.nextZ;\n\n\t}\n\n\t// look for remaining points in decreasing z-order\n\twhile ( p && p.z >= minZ ) {\n\n\t\tif ( p.x >= x0 && p.x <= x1 && p.y >= y0 && p.y <= y1 && p !== a && p !== c &&\n\t\t\tpointInTriangle( ax, ay, bx, by, cx, cy, p.x, p.y ) && area( p.prev, p, p.next ) >= 0 ) return false;\n\t\tp = p.prevZ;\n\n\t}\n\n\t// look for remaining points in increasing z-order\n\twhile ( n && n.z <= maxZ ) {\n\n\t\tif ( n.x >= x0 && n.x <= x1 && n.y >= y0 && n.y <= y1 && n !== a && n !== c &&\n\t\t\tpointInTriangle( ax, ay, bx, by, cx, cy, n.x, n.y ) && area( n.prev, n, n.next ) >= 0 ) return false;\n\t\tn = n.nextZ;\n\n\t}\n\n\treturn true;\n\n}\n\n// go through all polygon nodes and cure small local self-intersections\nfunction cureLocalIntersections( start, triangles, dim ) {\n\n\tlet p = start;\n\tdo {\n\n\t\tconst a = p.prev,\n\t\t\tb = p.next.next;\n\n\t\tif ( ! equals( a, b ) && intersects( a, p, p.next, b ) && locallyInside( a, b ) && locallyInside( b, a ) ) {\n\n\t\t\ttriangles.push( a.i / dim | 0 );\n\t\t\ttriangles.push( p.i / dim | 0 );\n\t\t\ttriangles.push( b.i / dim | 0 );\n\n\t\t\t// remove two nodes involved\n\t\t\tremoveNode( p );\n\t\t\tremoveNode( p.next );\n\n\t\t\tp = start = b;\n\n\t\t}\n\n\t\tp = p.next;\n\n\t} while ( p !== start );\n\n\treturn filterPoints( p );\n\n}\n\n// try splitting polygon into two and triangulate them independently\nfunction splitEarcut( start, triangles, dim, minX, minY, invSize ) {\n\n\t// look for a valid diagonal that divides the polygon into two\n\tlet a = start;\n\tdo {\n\n\t\tlet b = a.next.next;\n\t\twhile ( b !== a.prev ) {\n\n\t\t\tif ( a.i !== b.i && isValidDiagonal( a, b ) ) {\n\n\t\t\t\t// split the polygon in two by the diagonal\n\t\t\t\tlet c = splitPolygon( a, b );\n\n\t\t\t\t// filter colinear points around the cuts\n\t\t\t\ta = filterPoints( a, a.next );\n\t\t\t\tc = filterPoints( c, c.next );\n\n\t\t\t\t// run earcut on each half\n\t\t\t\tearcutLinked( a, triangles, dim, minX, minY, invSize, 0 );\n\t\t\t\tearcutLinked( c, triangles, dim, minX, minY, invSize, 0 );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tb = b.next;\n\n\t\t}\n\n\t\ta = a.next;\n\n\t} while ( a !== start );\n\n}\n\n// link every hole into the outer loop, producing a single-ring polygon without holes\nfunction eliminateHoles( data, holeIndices, outerNode, dim ) {\n\n\tconst queue = [];\n\tlet i, len, start, end, list;\n\n\tfor ( i = 0, len = holeIndices.length; i < len; i ++ ) {\n\n\t\tstart = holeIndices[ i ] * dim;\n\t\tend = i < len - 1 ? holeIndices[ i + 1 ] * dim : data.length;\n\t\tlist = linkedList( data, start, end, dim, false );\n\t\tif ( list === list.next ) list.steiner = true;\n\t\tqueue.push( getLeftmost( list ) );\n\n\t}\n\n\tqueue.sort( compareX );\n\n\t// process holes from left to right\n\tfor ( i = 0; i < queue.length; i ++ ) {\n\n\t\touterNode = eliminateHole( queue[ i ], outerNode );\n\n\t}\n\n\treturn outerNode;\n\n}\n\nfunction compareX( a, b ) {\n\n\treturn a.x - b.x;\n\n}\n\n// find a bridge between vertices that connects hole with an outer ring and link it\nfunction eliminateHole( hole, outerNode ) {\n\n\tconst bridge = findHoleBridge( hole, outerNode );\n\tif ( ! bridge ) {\n\n\t\treturn outerNode;\n\n\t}\n\n\tconst bridgeReverse = splitPolygon( bridge, hole );\n\n\t// filter collinear points around the cuts\n\tfilterPoints( bridgeReverse, bridgeReverse.next );\n\treturn filterPoints( bridge, bridge.next );\n\n}\n\n// David Eberly's algorithm for finding a bridge between hole and outer polygon\nfunction findHoleBridge( hole, outerNode ) {\n\n\tlet p = outerNode,\n\t\tqx = - Infinity,\n\t\tm;\n\n\tconst hx = hole.x, hy = hole.y;\n\n\t// find a segment intersected by a ray from the hole's leftmost point to the left;\n\t// segment's endpoint with lesser x will be potential connection point\n\tdo {\n\n\t\tif ( hy <= p.y && hy >= p.next.y && p.next.y !== p.y ) {\n\n\t\t\tconst x = p.x + ( hy - p.y ) * ( p.next.x - p.x ) / ( p.next.y - p.y );\n\t\t\tif ( x <= hx && x > qx ) {\n\n\t\t\t\tqx = x;\n\t\t\t\tm = p.x < p.next.x ? p : p.next;\n\t\t\t\tif ( x === hx ) return m; // hole touches outer segment; pick leftmost endpoint\n\n\t\t\t}\n\n\t\t}\n\n\t\tp = p.next;\n\n\t} while ( p !== outerNode );\n\n\tif ( ! m ) return null;\n\n\t// look for points inside the triangle of hole point, segment intersection and endpoint;\n\t// if there are no points found, we have a valid connection;\n\t// otherwise choose the point of the minimum angle with the ray as connection point\n\n\tconst stop = m,\n\t\tmx = m.x,\n\t\tmy = m.y;\n\tlet tanMin = Infinity, tan;\n\n\tp = m;\n\n\tdo {\n\n\t\tif ( hx >= p.x && p.x >= mx && hx !== p.x &&\n\t\t\t\tpointInTriangle( hy < my ? hx : qx, hy, mx, my, hy < my ? qx : hx, hy, p.x, p.y ) ) {\n\n\t\t\ttan = Math.abs( hy - p.y ) / ( hx - p.x ); // tangential\n\n\t\t\tif ( locallyInside( p, hole ) && ( tan < tanMin || ( tan === tanMin && ( p.x > m.x || ( p.x === m.x && sectorContainsSector( m, p ) ) ) ) ) ) {\n\n\t\t\t\tm = p;\n\t\t\t\ttanMin = tan;\n\n\t\t\t}\n\n\t\t}\n\n\t\tp = p.next;\n\n\t} while ( p !== stop );\n\n\treturn m;\n\n}\n\n// whether sector in vertex m contains sector in vertex p in the same coordinates\nfunction sectorContainsSector( m, p ) {\n\n\treturn area( m.prev, m, p.prev ) < 0 && area( p.next, m, m.next ) < 0;\n\n}\n\n// interlink polygon nodes in z-order\nfunction indexCurve( start, minX, minY, invSize ) {\n\n\tlet p = start;\n\tdo {\n\n\t\tif ( p.z === 0 ) p.z = zOrder( p.x, p.y, minX, minY, invSize );\n\t\tp.prevZ = p.prev;\n\t\tp.nextZ = p.next;\n\t\tp = p.next;\n\n\t} while ( p !== start );\n\n\tp.prevZ.nextZ = null;\n\tp.prevZ = null;\n\n\tsortLinked( p );\n\n}\n\n// Simon Tatham's linked list merge sort algorithm\n// http://www.chiark.greenend.org.uk/~sgtatham/algorithms/listsort.html\nfunction sortLinked( list ) {\n\n\tlet i, p, q, e, tail, numMerges, pSize, qSize,\n\t\tinSize = 1;\n\n\tdo {\n\n\t\tp = list;\n\t\tlist = null;\n\t\ttail = null;\n\t\tnumMerges = 0;\n\n\t\twhile ( p ) {\n\n\t\t\tnumMerges ++;\n\t\t\tq = p;\n\t\t\tpSize = 0;\n\t\t\tfor ( i = 0; i < inSize; i ++ ) {\n\n\t\t\t\tpSize ++;\n\t\t\t\tq = q.nextZ;\n\t\t\t\tif ( ! q ) break;\n\n\t\t\t}\n\n\t\t\tqSize = inSize;\n\n\t\t\twhile ( pSize > 0 || ( qSize > 0 && q ) ) {\n\n\t\t\t\tif ( pSize !== 0 && ( qSize === 0 || ! q || p.z <= q.z ) ) {\n\n\t\t\t\t\te = p;\n\t\t\t\t\tp = p.nextZ;\n\t\t\t\t\tpSize --;\n\n\t\t\t\t} else {\n\n\t\t\t\t\te = q;\n\t\t\t\t\tq = q.nextZ;\n\t\t\t\t\tqSize --;\n\n\t\t\t\t}\n\n\t\t\t\tif ( tail ) tail.nextZ = e;\n\t\t\t\telse list = e;\n\n\t\t\t\te.prevZ = tail;\n\t\t\t\ttail = e;\n\n\t\t\t}\n\n\t\t\tp = q;\n\n\t\t}\n\n\t\ttail.nextZ = null;\n\t\tinSize *= 2;\n\n\t} while ( numMerges > 1 );\n\n\treturn list;\n\n}\n\n// z-order of a point given coords and inverse of the longer side of data bbox\nfunction zOrder( x, y, minX, minY, invSize ) {\n\n\t// coords are transformed into non-negative 15-bit integer range\n\tx = ( x - minX ) * invSize | 0;\n\ty = ( y - minY ) * invSize | 0;\n\n\tx = ( x | ( x << 8 ) ) & 0x00FF00FF;\n\tx = ( x | ( x << 4 ) ) & 0x0F0F0F0F;\n\tx = ( x | ( x << 2 ) ) & 0x33333333;\n\tx = ( x | ( x << 1 ) ) & 0x55555555;\n\n\ty = ( y | ( y << 8 ) ) & 0x00FF00FF;\n\ty = ( y | ( y << 4 ) ) & 0x0F0F0F0F;\n\ty = ( y | ( y << 2 ) ) & 0x33333333;\n\ty = ( y | ( y << 1 ) ) & 0x55555555;\n\n\treturn x | ( y << 1 );\n\n}\n\n// find the leftmost node of a polygon ring\nfunction getLeftmost( start ) {\n\n\tlet p = start,\n\t\tleftmost = start;\n\tdo {\n\n\t\tif ( p.x < leftmost.x || ( p.x === leftmost.x && p.y < leftmost.y ) ) leftmost = p;\n\t\tp = p.next;\n\n\t} while ( p !== start );\n\n\treturn leftmost;\n\n}\n\n// check if a point lies within a convex triangle\nfunction pointInTriangle( ax, ay, bx, by, cx, cy, px, py ) {\n\n\treturn ( cx - px ) * ( ay - py ) >= ( ax - px ) * ( cy - py ) &&\n           ( ax - px ) * ( by - py ) >= ( bx - px ) * ( ay - py ) &&\n           ( bx - px ) * ( cy - py ) >= ( cx - px ) * ( by - py );\n\n}\n\n// check if a diagonal between two polygon nodes is valid (lies in polygon interior)\nfunction isValidDiagonal( a, b ) {\n\n\treturn a.next.i !== b.i && a.prev.i !== b.i && ! intersectsPolygon( a, b ) && // dones't intersect other edges\n           ( locallyInside( a, b ) && locallyInside( b, a ) && middleInside( a, b ) && // locally visible\n            ( area( a.prev, a, b.prev ) || area( a, b.prev, b ) ) || // does not create opposite-facing sectors\n            equals( a, b ) && area( a.prev, a, a.next ) > 0 && area( b.prev, b, b.next ) > 0 ); // special zero-length case\n\n}\n\n// signed area of a triangle\nfunction area( p, q, r ) {\n\n\treturn ( q.y - p.y ) * ( r.x - q.x ) - ( q.x - p.x ) * ( r.y - q.y );\n\n}\n\n// check if two points are equal\nfunction equals( p1, p2 ) {\n\n\treturn p1.x === p2.x && p1.y === p2.y;\n\n}\n\n// check if two segments intersect\nfunction intersects( p1, q1, p2, q2 ) {\n\n\tconst o1 = sign( area( p1, q1, p2 ) );\n\tconst o2 = sign( area( p1, q1, q2 ) );\n\tconst o3 = sign( area( p2, q2, p1 ) );\n\tconst o4 = sign( area( p2, q2, q1 ) );\n\n\tif ( o1 !== o2 && o3 !== o4 ) return true; // general case\n\n\tif ( o1 === 0 && onSegment( p1, p2, q1 ) ) return true; // p1, q1 and p2 are collinear and p2 lies on p1q1\n\tif ( o2 === 0 && onSegment( p1, q2, q1 ) ) return true; // p1, q1 and q2 are collinear and q2 lies on p1q1\n\tif ( o3 === 0 && onSegment( p2, p1, q2 ) ) return true; // p2, q2 and p1 are collinear and p1 lies on p2q2\n\tif ( o4 === 0 && onSegment( p2, q1, q2 ) ) return true; // p2, q2 and q1 are collinear and q1 lies on p2q2\n\n\treturn false;\n\n}\n\n// for collinear points p, q, r, check if point q lies on segment pr\nfunction onSegment( p, q, r ) {\n\n\treturn q.x <= Math.max( p.x, r.x ) && q.x >= Math.min( p.x, r.x ) && q.y <= Math.max( p.y, r.y ) && q.y >= Math.min( p.y, r.y );\n\n}\n\nfunction sign( num ) {\n\n\treturn num > 0 ? 1 : num < 0 ? - 1 : 0;\n\n}\n\n// check if a polygon diagonal intersects any polygon segments\nfunction intersectsPolygon( a, b ) {\n\n\tlet p = a;\n\tdo {\n\n\t\tif ( p.i !== a.i && p.next.i !== a.i && p.i !== b.i && p.next.i !== b.i &&\n\t\t\tintersects( p, p.next, a, b ) ) return true;\n\t\tp = p.next;\n\n\t} while ( p !== a );\n\n\treturn false;\n\n}\n\n// check if a polygon diagonal is locally inside the polygon\nfunction locallyInside( a, b ) {\n\n\treturn area( a.prev, a, a.next ) < 0 ?\n\t\tarea( a, b, a.next ) >= 0 && area( a, a.prev, b ) >= 0 :\n\t\tarea( a, b, a.prev ) < 0 || area( a, a.next, b ) < 0;\n\n}\n\n// check if the middle point of a polygon diagonal is inside the polygon\nfunction middleInside( a, b ) {\n\n\tlet p = a,\n\t\tinside = false;\n\tconst px = ( a.x + b.x ) / 2,\n\t\tpy = ( a.y + b.y ) / 2;\n\tdo {\n\n\t\tif ( ( ( p.y > py ) !== ( p.next.y > py ) ) && p.next.y !== p.y &&\n\t\t\t( px < ( p.next.x - p.x ) * ( py - p.y ) / ( p.next.y - p.y ) + p.x ) )\n\t\t\tinside = ! inside;\n\t\tp = p.next;\n\n\t} while ( p !== a );\n\n\treturn inside;\n\n}\n\n// link two polygon vertices with a bridge; if the vertices belong to the same ring, it splits polygon into two;\n// if one belongs to the outer ring and another to a hole, it merges it into a single ring\nfunction splitPolygon( a, b ) {\n\n\tconst a2 = new Node( a.i, a.x, a.y ),\n\t\tb2 = new Node( b.i, b.x, b.y ),\n\t\tan = a.next,\n\t\tbp = b.prev;\n\n\ta.next = b;\n\tb.prev = a;\n\n\ta2.next = an;\n\tan.prev = a2;\n\n\tb2.next = a2;\n\ta2.prev = b2;\n\n\tbp.next = b2;\n\tb2.prev = bp;\n\n\treturn b2;\n\n}\n\n// create a node and optionally link it with previous one (in a circular doubly linked list)\nfunction insertNode( i, x, y, last ) {\n\n\tconst p = new Node( i, x, y );\n\n\tif ( ! last ) {\n\n\t\tp.prev = p;\n\t\tp.next = p;\n\n\t} else {\n\n\t\tp.next = last.next;\n\t\tp.prev = last;\n\t\tlast.next.prev = p;\n\t\tlast.next = p;\n\n\t}\n\n\treturn p;\n\n}\n\nfunction removeNode( p ) {\n\n\tp.next.prev = p.prev;\n\tp.prev.next = p.next;\n\n\tif ( p.prevZ ) p.prevZ.nextZ = p.nextZ;\n\tif ( p.nextZ ) p.nextZ.prevZ = p.prevZ;\n\n}\n\nfunction Node( i, x, y ) {\n\n\t// vertex index in coordinates array\n\tthis.i = i;\n\n\t// vertex coordinates\n\tthis.x = x;\n\tthis.y = y;\n\n\t// previous and next vertex nodes in a polygon ring\n\tthis.prev = null;\n\tthis.next = null;\n\n\t// z-order curve value\n\tthis.z = 0;\n\n\t// previous and next nodes in z-order\n\tthis.prevZ = null;\n\tthis.nextZ = null;\n\n\t// indicates whether this is a steiner point\n\tthis.steiner = false;\n\n}\n\nfunction signedArea( data, start, end, dim ) {\n\n\tlet sum = 0;\n\tfor ( let i = start, j = end - dim; i < end; i += dim ) {\n\n\t\tsum += ( data[ j ] - data[ i ] ) * ( data[ i + 1 ] + data[ j + 1 ] );\n\t\tj = i;\n\n\t}\n\n\treturn sum;\n\n}\n\nclass ShapeUtils {\n\n\t// calculate area of the contour polygon\n\n\tstatic area( contour ) {\n\n\t\tconst n = contour.length;\n\t\tlet a = 0.0;\n\n\t\tfor ( let p = n - 1, q = 0; q < n; p = q ++ ) {\n\n\t\t\ta += contour[ p ].x * contour[ q ].y - contour[ q ].x * contour[ p ].y;\n\n\t\t}\n\n\t\treturn a * 0.5;\n\n\t}\n\n\tstatic isClockWise( pts ) {\n\n\t\treturn ShapeUtils.area( pts ) < 0;\n\n\t}\n\n\tstatic triangulateShape( contour, holes ) {\n\n\t\tconst vertices = []; // flat array of vertices like [ x0,y0, x1,y1, x2,y2, ... ]\n\t\tconst holeIndices = []; // array of hole indices\n\t\tconst faces = []; // final array of vertex indices like [ [ a,b,d ], [ b,c,d ] ]\n\n\t\tremoveDupEndPts( contour );\n\t\taddContour( vertices, contour );\n\n\t\t//\n\n\t\tlet holeIndex = contour.length;\n\n\t\tholes.forEach( removeDupEndPts );\n\n\t\tfor ( let i = 0; i < holes.length; i ++ ) {\n\n\t\t\tholeIndices.push( holeIndex );\n\t\t\tholeIndex += holes[ i ].length;\n\t\t\taddContour( vertices, holes[ i ] );\n\n\t\t}\n\n\t\t//\n\n\t\tconst triangles = Earcut.triangulate( vertices, holeIndices );\n\n\t\t//\n\n\t\tfor ( let i = 0; i < triangles.length; i += 3 ) {\n\n\t\t\tfaces.push( triangles.slice( i, i + 3 ) );\n\n\t\t}\n\n\t\treturn faces;\n\n\t}\n\n}\n\nfunction removeDupEndPts( points ) {\n\n\tconst l = points.length;\n\n\tif ( l > 2 && points[ l - 1 ].equals( points[ 0 ] ) ) {\n\n\t\tpoints.pop();\n\n\t}\n\n}\n\nfunction addContour( vertices, contour ) {\n\n\tfor ( let i = 0; i < contour.length; i ++ ) {\n\n\t\tvertices.push( contour[ i ].x );\n\t\tvertices.push( contour[ i ].y );\n\n\t}\n\n}\n\n/**\n * Creates extruded geometry from a path shape.\n *\n * parameters = {\n *\n *  curveSegments: <int>, // number of points on the curves\n *  steps: <int>, // number of points for z-side extrusions / used for subdividing segments of extrude spline too\n *  depth: <float>, // Depth to extrude the shape\n *\n *  bevelEnabled: <bool>, // turn on bevel\n *  bevelThickness: <float>, // how deep into the original shape bevel goes\n *  bevelSize: <float>, // how far from shape outline (including bevelOffset) is bevel\n *  bevelOffset: <float>, // how far from shape outline does bevel start\n *  bevelSegments: <int>, // number of bevel layers\n *\n *  extrudePath: <THREE.Curve> // curve to extrude shape along\n *\n *  UVGenerator: <Object> // object that provides UV generator functions\n *\n * }\n */\n\nclass ExtrudeGeometry extends BufferGeometry {\n\n\tconstructor( shapes = new Shape( [ new Vector2( 0.5, 0.5 ), new Vector2( - 0.5, 0.5 ), new Vector2( - 0.5, - 0.5 ), new Vector2( 0.5, - 0.5 ) ] ), options = {} ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'ExtrudeGeometry';\n\n\t\tthis.parameters = {\n\t\t\tshapes: shapes,\n\t\t\toptions: options\n\t\t};\n\n\t\tshapes = Array.isArray( shapes ) ? shapes : [ shapes ];\n\n\t\tconst scope = this;\n\n\t\tconst verticesArray = [];\n\t\tconst uvArray = [];\n\n\t\tfor ( let i = 0, l = shapes.length; i < l; i ++ ) {\n\n\t\t\tconst shape = shapes[ i ];\n\t\t\taddShape( shape );\n\n\t\t}\n\n\t\t// build geometry\n\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( verticesArray, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvArray, 2 ) );\n\n\t\tthis.computeVertexNormals();\n\n\t\t// functions\n\n\t\tfunction addShape( shape ) {\n\n\t\t\tconst placeholder = [];\n\n\t\t\t// options\n\n\t\t\tconst curveSegments = options.curveSegments !== undefined ? options.curveSegments : 12;\n\t\t\tconst steps = options.steps !== undefined ? options.steps : 1;\n\t\t\tconst depth = options.depth !== undefined ? options.depth : 1;\n\n\t\t\tlet bevelEnabled = options.bevelEnabled !== undefined ? options.bevelEnabled : true;\n\t\t\tlet bevelThickness = options.bevelThickness !== undefined ? options.bevelThickness : 0.2;\n\t\t\tlet bevelSize = options.bevelSize !== undefined ? options.bevelSize : bevelThickness - 0.1;\n\t\t\tlet bevelOffset = options.bevelOffset !== undefined ? options.bevelOffset : 0;\n\t\t\tlet bevelSegments = options.bevelSegments !== undefined ? options.bevelSegments : 3;\n\n\t\t\tconst extrudePath = options.extrudePath;\n\n\t\t\tconst uvgen = options.UVGenerator !== undefined ? options.UVGenerator : WorldUVGenerator;\n\n\t\t\t//\n\n\t\t\tlet extrudePts, extrudeByPath = false;\n\t\t\tlet splineTube, binormal, normal, position2;\n\n\t\t\tif ( extrudePath ) {\n\n\t\t\t\textrudePts = extrudePath.getSpacedPoints( steps );\n\n\t\t\t\textrudeByPath = true;\n\t\t\t\tbevelEnabled = false; // bevels not supported for path extrusion\n\n\t\t\t\t// SETUP TNB variables\n\n\t\t\t\t// TODO1 - have a .isClosed in spline?\n\n\t\t\t\tsplineTube = extrudePath.computeFrenetFrames( steps, false );\n\n\t\t\t\t// console.log(splineTube, 'splineTube', splineTube.normals.length, 'steps', steps, 'extrudePts', extrudePts.length);\n\n\t\t\t\tbinormal = new Vector3();\n\t\t\t\tnormal = new Vector3();\n\t\t\t\tposition2 = new Vector3();\n\n\t\t\t}\n\n\t\t\t// Safeguards if bevels are not enabled\n\n\t\t\tif ( ! bevelEnabled ) {\n\n\t\t\t\tbevelSegments = 0;\n\t\t\t\tbevelThickness = 0;\n\t\t\t\tbevelSize = 0;\n\t\t\t\tbevelOffset = 0;\n\n\t\t\t}\n\n\t\t\t// Variables initialization\n\n\t\t\tconst shapePoints = shape.extractPoints( curveSegments );\n\n\t\t\tlet vertices = shapePoints.shape;\n\t\t\tconst holes = shapePoints.holes;\n\n\t\t\tconst reverse = ! ShapeUtils.isClockWise( vertices );\n\n\t\t\tif ( reverse ) {\n\n\t\t\t\tvertices = vertices.reverse();\n\n\t\t\t\t// Maybe we should also check if holes are in the opposite direction, just to be safe ...\n\n\t\t\t\tfor ( let h = 0, hl = holes.length; h < hl; h ++ ) {\n\n\t\t\t\t\tconst ahole = holes[ h ];\n\n\t\t\t\t\tif ( ShapeUtils.isClockWise( ahole ) ) {\n\n\t\t\t\t\t\tholes[ h ] = ahole.reverse();\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\n\t\t\tconst faces = ShapeUtils.triangulateShape( vertices, holes );\n\n\t\t\t/* Vertices */\n\n\t\t\tconst contour = vertices; // vertices has all points but contour has only points of circumference\n\n\t\t\tfor ( let h = 0, hl = holes.length; h < hl; h ++ ) {\n\n\t\t\t\tconst ahole = holes[ h ];\n\n\t\t\t\tvertices = vertices.concat( ahole );\n\n\t\t\t}\n\n\n\t\t\tfunction scalePt2( pt, vec, size ) {\n\n\t\t\t\tif ( ! vec ) console.error( 'THREE.ExtrudeGeometry: vec does not exist' );\n\n\t\t\t\treturn vec.clone().multiplyScalar( size ).add( pt );\n\n\t\t\t}\n\n\t\t\tconst vlen = vertices.length, flen = faces.length;\n\n\n\t\t\t// Find directions for point movement\n\n\n\t\t\tfunction getBevelVec( inPt, inPrev, inNext ) {\n\n\t\t\t\t// computes for inPt the corresponding point inPt' on a new contour\n\t\t\t\t//   shifted by 1 unit (length of normalized vector) to the left\n\t\t\t\t// if we walk along contour clockwise, this new contour is outside the old one\n\t\t\t\t//\n\t\t\t\t// inPt' is the intersection of the two lines parallel to the two\n\t\t\t\t//  adjacent edges of inPt at a distance of 1 unit on the left side.\n\n\t\t\t\tlet v_trans_x, v_trans_y, shrink_by; // resulting translation vector for inPt\n\n\t\t\t\t// good reading for geometry algorithms (here: line-line intersection)\n\t\t\t\t// http://geomalgorithms.com/a05-_intersect-1.html\n\n\t\t\t\tconst v_prev_x = inPt.x - inPrev.x,\n\t\t\t\t\tv_prev_y = inPt.y - inPrev.y;\n\t\t\t\tconst v_next_x = inNext.x - inPt.x,\n\t\t\t\t\tv_next_y = inNext.y - inPt.y;\n\n\t\t\t\tconst v_prev_lensq = ( v_prev_x * v_prev_x + v_prev_y * v_prev_y );\n\n\t\t\t\t// check for collinear edges\n\t\t\t\tconst collinear0 = ( v_prev_x * v_next_y - v_prev_y * v_next_x );\n\n\t\t\t\tif ( Math.abs( collinear0 ) > Number.EPSILON ) {\n\n\t\t\t\t\t// not collinear\n\n\t\t\t\t\t// length of vectors for normalizing\n\n\t\t\t\t\tconst v_prev_len = Math.sqrt( v_prev_lensq );\n\t\t\t\t\tconst v_next_len = Math.sqrt( v_next_x * v_next_x + v_next_y * v_next_y );\n\n\t\t\t\t\t// shift adjacent points by unit vectors to the left\n\n\t\t\t\t\tconst ptPrevShift_x = ( inPrev.x - v_prev_y / v_prev_len );\n\t\t\t\t\tconst ptPrevShift_y = ( inPrev.y + v_prev_x / v_prev_len );\n\n\t\t\t\t\tconst ptNextShift_x = ( inNext.x - v_next_y / v_next_len );\n\t\t\t\t\tconst ptNextShift_y = ( inNext.y + v_next_x / v_next_len );\n\n\t\t\t\t\t// scaling factor for v_prev to intersection point\n\n\t\t\t\t\tconst sf = ( ( ptNextShift_x - ptPrevShift_x ) * v_next_y -\n\t\t\t\t\t\t\t( ptNextShift_y - ptPrevShift_y ) * v_next_x ) /\n\t\t\t\t\t\t( v_prev_x * v_next_y - v_prev_y * v_next_x );\n\n\t\t\t\t\t// vector from inPt to intersection point\n\n\t\t\t\t\tv_trans_x = ( ptPrevShift_x + v_prev_x * sf - inPt.x );\n\t\t\t\t\tv_trans_y = ( ptPrevShift_y + v_prev_y * sf - inPt.y );\n\n\t\t\t\t\t// Don't normalize!, otherwise sharp corners become ugly\n\t\t\t\t\t//  but prevent crazy spikes\n\t\t\t\t\tconst v_trans_lensq = ( v_trans_x * v_trans_x + v_trans_y * v_trans_y );\n\t\t\t\t\tif ( v_trans_lensq <= 2 ) {\n\n\t\t\t\t\t\treturn new Vector2( v_trans_x, v_trans_y );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tshrink_by = Math.sqrt( v_trans_lensq / 2 );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// handle special case of collinear edges\n\n\t\t\t\t\tlet direction_eq = false; // assumes: opposite\n\n\t\t\t\t\tif ( v_prev_x > Number.EPSILON ) {\n\n\t\t\t\t\t\tif ( v_next_x > Number.EPSILON ) {\n\n\t\t\t\t\t\t\tdirection_eq = true;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tif ( v_prev_x < - Number.EPSILON ) {\n\n\t\t\t\t\t\t\tif ( v_next_x < - Number.EPSILON ) {\n\n\t\t\t\t\t\t\t\tdirection_eq = true;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tif ( Math.sign( v_prev_y ) === Math.sign( v_next_y ) ) {\n\n\t\t\t\t\t\t\t\tdirection_eq = true;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( direction_eq ) {\n\n\t\t\t\t\t\t// console.log(\"Warning: lines are a straight sequence\");\n\t\t\t\t\t\tv_trans_x = - v_prev_y;\n\t\t\t\t\t\tv_trans_y = v_prev_x;\n\t\t\t\t\t\tshrink_by = Math.sqrt( v_prev_lensq );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// console.log(\"Warning: lines are a straight spike\");\n\t\t\t\t\t\tv_trans_x = v_prev_x;\n\t\t\t\t\t\tv_trans_y = v_prev_y;\n\t\t\t\t\t\tshrink_by = Math.sqrt( v_prev_lensq / 2 );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\treturn new Vector2( v_trans_x / shrink_by, v_trans_y / shrink_by );\n\n\t\t\t}\n\n\n\t\t\tconst contourMovements = [];\n\n\t\t\tfor ( let i = 0, il = contour.length, j = il - 1, k = i + 1; i < il; i ++, j ++, k ++ ) {\n\n\t\t\t\tif ( j === il ) j = 0;\n\t\t\t\tif ( k === il ) k = 0;\n\n\t\t\t\t//  (j)---(i)---(k)\n\t\t\t\t// console.log('i,j,k', i, j , k)\n\n\t\t\t\tcontourMovements[ i ] = getBevelVec( contour[ i ], contour[ j ], contour[ k ] );\n\n\t\t\t}\n\n\t\t\tconst holesMovements = [];\n\t\t\tlet oneHoleMovements, verticesMovements = contourMovements.concat();\n\n\t\t\tfor ( let h = 0, hl = holes.length; h < hl; h ++ ) {\n\n\t\t\t\tconst ahole = holes[ h ];\n\n\t\t\t\toneHoleMovements = [];\n\n\t\t\t\tfor ( let i = 0, il = ahole.length, j = il - 1, k = i + 1; i < il; i ++, j ++, k ++ ) {\n\n\t\t\t\t\tif ( j === il ) j = 0;\n\t\t\t\t\tif ( k === il ) k = 0;\n\n\t\t\t\t\t//  (j)---(i)---(k)\n\t\t\t\t\toneHoleMovements[ i ] = getBevelVec( ahole[ i ], ahole[ j ], ahole[ k ] );\n\n\t\t\t\t}\n\n\t\t\t\tholesMovements.push( oneHoleMovements );\n\t\t\t\tverticesMovements = verticesMovements.concat( oneHoleMovements );\n\n\t\t\t}\n\n\n\t\t\t// Loop bevelSegments, 1 for the front, 1 for the back\n\n\t\t\tfor ( let b = 0; b < bevelSegments; b ++ ) {\n\n\t\t\t\t//for ( b = bevelSegments; b > 0; b -- ) {\n\n\t\t\t\tconst t = b / bevelSegments;\n\t\t\t\tconst z = bevelThickness * Math.cos( t * Math.PI / 2 );\n\t\t\t\tconst bs = bevelSize * Math.sin( t * Math.PI / 2 ) + bevelOffset;\n\n\t\t\t\t// contract shape\n\n\t\t\t\tfor ( let i = 0, il = contour.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst vert = scalePt2( contour[ i ], contourMovements[ i ], bs );\n\n\t\t\t\t\tv( vert.x, vert.y, - z );\n\n\t\t\t\t}\n\n\t\t\t\t// expand holes\n\n\t\t\t\tfor ( let h = 0, hl = holes.length; h < hl; h ++ ) {\n\n\t\t\t\t\tconst ahole = holes[ h ];\n\t\t\t\t\toneHoleMovements = holesMovements[ h ];\n\n\t\t\t\t\tfor ( let i = 0, il = ahole.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tconst vert = scalePt2( ahole[ i ], oneHoleMovements[ i ], bs );\n\n\t\t\t\t\t\tv( vert.x, vert.y, - z );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tconst bs = bevelSize + bevelOffset;\n\n\t\t\t// Back facing vertices\n\n\t\t\tfor ( let i = 0; i < vlen; i ++ ) {\n\n\t\t\t\tconst vert = bevelEnabled ? scalePt2( vertices[ i ], verticesMovements[ i ], bs ) : vertices[ i ];\n\n\t\t\t\tif ( ! extrudeByPath ) {\n\n\t\t\t\t\tv( vert.x, vert.y, 0 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// v( vert.x, vert.y + extrudePts[ 0 ].y, extrudePts[ 0 ].x );\n\n\t\t\t\t\tnormal.copy( splineTube.normals[ 0 ] ).multiplyScalar( vert.x );\n\t\t\t\t\tbinormal.copy( splineTube.binormals[ 0 ] ).multiplyScalar( vert.y );\n\n\t\t\t\t\tposition2.copy( extrudePts[ 0 ] ).add( normal ).add( binormal );\n\n\t\t\t\t\tv( position2.x, position2.y, position2.z );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// Add stepped vertices...\n\t\t\t// Including front facing vertices\n\n\t\t\tfor ( let s = 1; s <= steps; s ++ ) {\n\n\t\t\t\tfor ( let i = 0; i < vlen; i ++ ) {\n\n\t\t\t\t\tconst vert = bevelEnabled ? scalePt2( vertices[ i ], verticesMovements[ i ], bs ) : vertices[ i ];\n\n\t\t\t\t\tif ( ! extrudeByPath ) {\n\n\t\t\t\t\t\tv( vert.x, vert.y, depth / steps * s );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// v( vert.x, vert.y + extrudePts[ s - 1 ].y, extrudePts[ s - 1 ].x );\n\n\t\t\t\t\t\tnormal.copy( splineTube.normals[ s ] ).multiplyScalar( vert.x );\n\t\t\t\t\t\tbinormal.copy( splineTube.binormals[ s ] ).multiplyScalar( vert.y );\n\n\t\t\t\t\t\tposition2.copy( extrudePts[ s ] ).add( normal ).add( binormal );\n\n\t\t\t\t\t\tv( position2.x, position2.y, position2.z );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\n\t\t\t// Add bevel segments planes\n\n\t\t\t//for ( b = 1; b <= bevelSegments; b ++ ) {\n\t\t\tfor ( let b = bevelSegments - 1; b >= 0; b -- ) {\n\n\t\t\t\tconst t = b / bevelSegments;\n\t\t\t\tconst z = bevelThickness * Math.cos( t * Math.PI / 2 );\n\t\t\t\tconst bs = bevelSize * Math.sin( t * Math.PI / 2 ) + bevelOffset;\n\n\t\t\t\t// contract shape\n\n\t\t\t\tfor ( let i = 0, il = contour.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst vert = scalePt2( contour[ i ], contourMovements[ i ], bs );\n\t\t\t\t\tv( vert.x, vert.y, depth + z );\n\n\t\t\t\t}\n\n\t\t\t\t// expand holes\n\n\t\t\t\tfor ( let h = 0, hl = holes.length; h < hl; h ++ ) {\n\n\t\t\t\t\tconst ahole = holes[ h ];\n\t\t\t\t\toneHoleMovements = holesMovements[ h ];\n\n\t\t\t\t\tfor ( let i = 0, il = ahole.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tconst vert = scalePt2( ahole[ i ], oneHoleMovements[ i ], bs );\n\n\t\t\t\t\t\tif ( ! extrudeByPath ) {\n\n\t\t\t\t\t\t\tv( vert.x, vert.y, depth + z );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tv( vert.x, vert.y + extrudePts[ steps - 1 ].y, extrudePts[ steps - 1 ].x + z );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t/* Faces */\n\n\t\t\t// Top and bottom faces\n\n\t\t\tbuildLidFaces();\n\n\t\t\t// Sides faces\n\n\t\t\tbuildSideFaces();\n\n\n\t\t\t/////  Internal functions\n\n\t\t\tfunction buildLidFaces() {\n\n\t\t\t\tconst start = verticesArray.length / 3;\n\n\t\t\t\tif ( bevelEnabled ) {\n\n\t\t\t\t\tlet layer = 0; // steps + 1\n\t\t\t\t\tlet offset = vlen * layer;\n\n\t\t\t\t\t// Bottom faces\n\n\t\t\t\t\tfor ( let i = 0; i < flen; i ++ ) {\n\n\t\t\t\t\t\tconst face = faces[ i ];\n\t\t\t\t\t\tf3( face[ 2 ] + offset, face[ 1 ] + offset, face[ 0 ] + offset );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tlayer = steps + bevelSegments * 2;\n\t\t\t\t\toffset = vlen * layer;\n\n\t\t\t\t\t// Top faces\n\n\t\t\t\t\tfor ( let i = 0; i < flen; i ++ ) {\n\n\t\t\t\t\t\tconst face = faces[ i ];\n\t\t\t\t\t\tf3( face[ 0 ] + offset, face[ 1 ] + offset, face[ 2 ] + offset );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// Bottom faces\n\n\t\t\t\t\tfor ( let i = 0; i < flen; i ++ ) {\n\n\t\t\t\t\t\tconst face = faces[ i ];\n\t\t\t\t\t\tf3( face[ 2 ], face[ 1 ], face[ 0 ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// Top faces\n\n\t\t\t\t\tfor ( let i = 0; i < flen; i ++ ) {\n\n\t\t\t\t\t\tconst face = faces[ i ];\n\t\t\t\t\t\tf3( face[ 0 ] + vlen * steps, face[ 1 ] + vlen * steps, face[ 2 ] + vlen * steps );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tscope.addGroup( start, verticesArray.length / 3 - start, 0 );\n\n\t\t\t}\n\n\t\t\t// Create faces for the z-sides of the shape\n\n\t\t\tfunction buildSideFaces() {\n\n\t\t\t\tconst start = verticesArray.length / 3;\n\t\t\t\tlet layeroffset = 0;\n\t\t\t\tsidewalls( contour, layeroffset );\n\t\t\t\tlayeroffset += contour.length;\n\n\t\t\t\tfor ( let h = 0, hl = holes.length; h < hl; h ++ ) {\n\n\t\t\t\t\tconst ahole = holes[ h ];\n\t\t\t\t\tsidewalls( ahole, layeroffset );\n\n\t\t\t\t\t//, true\n\t\t\t\t\tlayeroffset += ahole.length;\n\n\t\t\t\t}\n\n\n\t\t\t\tscope.addGroup( start, verticesArray.length / 3 - start, 1 );\n\n\n\t\t\t}\n\n\t\t\tfunction sidewalls( contour, layeroffset ) {\n\n\t\t\t\tlet i = contour.length;\n\n\t\t\t\twhile ( -- i >= 0 ) {\n\n\t\t\t\t\tconst j = i;\n\t\t\t\t\tlet k = i - 1;\n\t\t\t\t\tif ( k < 0 ) k = contour.length - 1;\n\n\t\t\t\t\t//console.log('b', i,j, i-1, k,vertices.length);\n\n\t\t\t\t\tfor ( let s = 0, sl = ( steps + bevelSegments * 2 ); s < sl; s ++ ) {\n\n\t\t\t\t\t\tconst slen1 = vlen * s;\n\t\t\t\t\t\tconst slen2 = vlen * ( s + 1 );\n\n\t\t\t\t\t\tconst a = layeroffset + j + slen1,\n\t\t\t\t\t\t\tb = layeroffset + k + slen1,\n\t\t\t\t\t\t\tc = layeroffset + k + slen2,\n\t\t\t\t\t\t\td = layeroffset + j + slen2;\n\n\t\t\t\t\t\tf4( a, b, c, d );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tfunction v( x, y, z ) {\n\n\t\t\t\tplaceholder.push( x );\n\t\t\t\tplaceholder.push( y );\n\t\t\t\tplaceholder.push( z );\n\n\t\t\t}\n\n\n\t\t\tfunction f3( a, b, c ) {\n\n\t\t\t\taddVertex( a );\n\t\t\t\taddVertex( b );\n\t\t\t\taddVertex( c );\n\n\t\t\t\tconst nextIndex = verticesArray.length / 3;\n\t\t\t\tconst uvs = uvgen.generateTopUV( scope, verticesArray, nextIndex - 3, nextIndex - 2, nextIndex - 1 );\n\n\t\t\t\taddUV( uvs[ 0 ] );\n\t\t\t\taddUV( uvs[ 1 ] );\n\t\t\t\taddUV( uvs[ 2 ] );\n\n\t\t\t}\n\n\t\t\tfunction f4( a, b, c, d ) {\n\n\t\t\t\taddVertex( a );\n\t\t\t\taddVertex( b );\n\t\t\t\taddVertex( d );\n\n\t\t\t\taddVertex( b );\n\t\t\t\taddVertex( c );\n\t\t\t\taddVertex( d );\n\n\n\t\t\t\tconst nextIndex = verticesArray.length / 3;\n\t\t\t\tconst uvs = uvgen.generateSideWallUV( scope, verticesArray, nextIndex - 6, nextIndex - 3, nextIndex - 2, nextIndex - 1 );\n\n\t\t\t\taddUV( uvs[ 0 ] );\n\t\t\t\taddUV( uvs[ 1 ] );\n\t\t\t\taddUV( uvs[ 3 ] );\n\n\t\t\t\taddUV( uvs[ 1 ] );\n\t\t\t\taddUV( uvs[ 2 ] );\n\t\t\t\taddUV( uvs[ 3 ] );\n\n\t\t\t}\n\n\t\t\tfunction addVertex( index ) {\n\n\t\t\t\tverticesArray.push( placeholder[ index * 3 + 0 ] );\n\t\t\t\tverticesArray.push( placeholder[ index * 3 + 1 ] );\n\t\t\t\tverticesArray.push( placeholder[ index * 3 + 2 ] );\n\n\t\t\t}\n\n\n\t\t\tfunction addUV( vector2 ) {\n\n\t\t\t\tuvArray.push( vector2.x );\n\t\t\t\tuvArray.push( vector2.y );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tconst shapes = this.parameters.shapes;\n\t\tconst options = this.parameters.options;\n\n\t\treturn toJSON$1( shapes, options, data );\n\n\t}\n\n\tstatic fromJSON( data, shapes ) {\n\n\t\tconst geometryShapes = [];\n\n\t\tfor ( let j = 0, jl = data.shapes.length; j < jl; j ++ ) {\n\n\t\t\tconst shape = shapes[ data.shapes[ j ] ];\n\n\t\t\tgeometryShapes.push( shape );\n\n\t\t}\n\n\t\tconst extrudePath = data.options.extrudePath;\n\n\t\tif ( extrudePath !== undefined ) {\n\n\t\t\tdata.options.extrudePath = new Curves[ extrudePath.type ]().fromJSON( extrudePath );\n\n\t\t}\n\n\t\treturn new ExtrudeGeometry( geometryShapes, data.options );\n\n\t}\n\n}\n\nconst WorldUVGenerator = {\n\n\tgenerateTopUV: function ( geometry, vertices, indexA, indexB, indexC ) {\n\n\t\tconst a_x = vertices[ indexA * 3 ];\n\t\tconst a_y = vertices[ indexA * 3 + 1 ];\n\t\tconst b_x = vertices[ indexB * 3 ];\n\t\tconst b_y = vertices[ indexB * 3 + 1 ];\n\t\tconst c_x = vertices[ indexC * 3 ];\n\t\tconst c_y = vertices[ indexC * 3 + 1 ];\n\n\t\treturn [\n\t\t\tnew Vector2( a_x, a_y ),\n\t\t\tnew Vector2( b_x, b_y ),\n\t\t\tnew Vector2( c_x, c_y )\n\t\t];\n\n\t},\n\n\tgenerateSideWallUV: function ( geometry, vertices, indexA, indexB, indexC, indexD ) {\n\n\t\tconst a_x = vertices[ indexA * 3 ];\n\t\tconst a_y = vertices[ indexA * 3 + 1 ];\n\t\tconst a_z = vertices[ indexA * 3 + 2 ];\n\t\tconst b_x = vertices[ indexB * 3 ];\n\t\tconst b_y = vertices[ indexB * 3 + 1 ];\n\t\tconst b_z = vertices[ indexB * 3 + 2 ];\n\t\tconst c_x = vertices[ indexC * 3 ];\n\t\tconst c_y = vertices[ indexC * 3 + 1 ];\n\t\tconst c_z = vertices[ indexC * 3 + 2 ];\n\t\tconst d_x = vertices[ indexD * 3 ];\n\t\tconst d_y = vertices[ indexD * 3 + 1 ];\n\t\tconst d_z = vertices[ indexD * 3 + 2 ];\n\n\t\tif ( Math.abs( a_y - b_y ) < Math.abs( a_x - b_x ) ) {\n\n\t\t\treturn [\n\t\t\t\tnew Vector2( a_x, 1 - a_z ),\n\t\t\t\tnew Vector2( b_x, 1 - b_z ),\n\t\t\t\tnew Vector2( c_x, 1 - c_z ),\n\t\t\t\tnew Vector2( d_x, 1 - d_z )\n\t\t\t];\n\n\t\t} else {\n\n\t\t\treturn [\n\t\t\t\tnew Vector2( a_y, 1 - a_z ),\n\t\t\t\tnew Vector2( b_y, 1 - b_z ),\n\t\t\t\tnew Vector2( c_y, 1 - c_z ),\n\t\t\t\tnew Vector2( d_y, 1 - d_z )\n\t\t\t];\n\n\t\t}\n\n\t}\n\n};\n\nfunction toJSON$1( shapes, options, data ) {\n\n\tdata.shapes = [];\n\n\tif ( Array.isArray( shapes ) ) {\n\n\t\tfor ( let i = 0, l = shapes.length; i < l; i ++ ) {\n\n\t\t\tconst shape = shapes[ i ];\n\n\t\t\tdata.shapes.push( shape.uuid );\n\n\t\t}\n\n\t} else {\n\n\t\tdata.shapes.push( shapes.uuid );\n\n\t}\n\n\tdata.options = Object.assign( {}, options );\n\n\tif ( options.extrudePath !== undefined ) data.options.extrudePath = options.extrudePath.toJSON();\n\n\treturn data;\n\n}\n\nclass IcosahedronGeometry extends PolyhedronGeometry {\n\n\tconstructor( radius = 1, detail = 0 ) {\n\n\t\tconst t = ( 1 + Math.sqrt( 5 ) ) / 2;\n\n\t\tconst vertices = [\n\t\t\t- 1, t, 0, \t1, t, 0, \t- 1, - t, 0, \t1, - t, 0,\n\t\t\t0, - 1, t, \t0, 1, t,\t0, - 1, - t, \t0, 1, - t,\n\t\t\tt, 0, - 1, \tt, 0, 1, \t- t, 0, - 1, \t- t, 0, 1\n\t\t];\n\n\t\tconst indices = [\n\t\t\t0, 11, 5, \t0, 5, 1, \t0, 1, 7, \t0, 7, 10, \t0, 10, 11,\n\t\t\t1, 5, 9, \t5, 11, 4,\t11, 10, 2,\t10, 7, 6,\t7, 1, 8,\n\t\t\t3, 9, 4, \t3, 4, 2,\t3, 2, 6,\t3, 6, 8,\t3, 8, 9,\n\t\t\t4, 9, 5, \t2, 4, 11,\t6, 2, 10,\t8, 6, 7,\t9, 8, 1\n\t\t];\n\n\t\tsuper( vertices, indices, radius, detail );\n\n\t\tthis.type = 'IcosahedronGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\tdetail: detail\n\t\t};\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new IcosahedronGeometry( data.radius, data.detail );\n\n\t}\n\n}\n\nclass OctahedronGeometry extends PolyhedronGeometry {\n\n\tconstructor( radius = 1, detail = 0 ) {\n\n\t\tconst vertices = [\n\t\t\t1, 0, 0, \t- 1, 0, 0,\t0, 1, 0,\n\t\t\t0, - 1, 0, \t0, 0, 1,\t0, 0, - 1\n\t\t];\n\n\t\tconst indices = [\n\t\t\t0, 2, 4,\t0, 4, 3,\t0, 3, 5,\n\t\t\t0, 5, 2,\t1, 2, 5,\t1, 5, 3,\n\t\t\t1, 3, 4,\t1, 4, 2\n\t\t];\n\n\t\tsuper( vertices, indices, radius, detail );\n\n\t\tthis.type = 'OctahedronGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\tdetail: detail\n\t\t};\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new OctahedronGeometry( data.radius, data.detail );\n\n\t}\n\n}\n\nclass RingGeometry extends BufferGeometry {\n\n\tconstructor( innerRadius = 0.5, outerRadius = 1, thetaSegments = 32, phiSegments = 1, thetaStart = 0, thetaLength = Math.PI * 2 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'RingGeometry';\n\n\t\tthis.parameters = {\n\t\t\tinnerRadius: innerRadius,\n\t\t\touterRadius: outerRadius,\n\t\t\tthetaSegments: thetaSegments,\n\t\t\tphiSegments: phiSegments,\n\t\t\tthetaStart: thetaStart,\n\t\t\tthetaLength: thetaLength\n\t\t};\n\n\t\tthetaSegments = Math.max( 3, thetaSegments );\n\t\tphiSegments = Math.max( 1, phiSegments );\n\n\t\t// buffers\n\n\t\tconst indices = [];\n\t\tconst vertices = [];\n\t\tconst normals = [];\n\t\tconst uvs = [];\n\n\t\t// some helper variables\n\n\t\tlet radius = innerRadius;\n\t\tconst radiusStep = ( ( outerRadius - innerRadius ) / phiSegments );\n\t\tconst vertex = new Vector3();\n\t\tconst uv = new Vector2();\n\n\t\t// generate vertices, normals and uvs\n\n\t\tfor ( let j = 0; j <= phiSegments; j ++ ) {\n\n\t\t\tfor ( let i = 0; i <= thetaSegments; i ++ ) {\n\n\t\t\t\t// values are generate from the inside of the ring to the outside\n\n\t\t\t\tconst segment = thetaStart + i / thetaSegments * thetaLength;\n\n\t\t\t\t// vertex\n\n\t\t\t\tvertex.x = radius * Math.cos( segment );\n\t\t\t\tvertex.y = radius * Math.sin( segment );\n\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\n\n\t\t\t\t// normal\n\n\t\t\t\tnormals.push( 0, 0, 1 );\n\n\t\t\t\t// uv\n\n\t\t\t\tuv.x = ( vertex.x / outerRadius + 1 ) / 2;\n\t\t\t\tuv.y = ( vertex.y / outerRadius + 1 ) / 2;\n\n\t\t\t\tuvs.push( uv.x, uv.y );\n\n\t\t\t}\n\n\t\t\t// increase the radius for next row of vertices\n\n\t\t\tradius += radiusStep;\n\n\t\t}\n\n\t\t// indices\n\n\t\tfor ( let j = 0; j < phiSegments; j ++ ) {\n\n\t\t\tconst thetaSegmentLevel = j * ( thetaSegments + 1 );\n\n\t\t\tfor ( let i = 0; i < thetaSegments; i ++ ) {\n\n\t\t\t\tconst segment = i + thetaSegmentLevel;\n\n\t\t\t\tconst a = segment;\n\t\t\t\tconst b = segment + thetaSegments + 1;\n\t\t\t\tconst c = segment + thetaSegments + 2;\n\t\t\t\tconst d = segment + 1;\n\n\t\t\t\t// faces\n\n\t\t\t\tindices.push( a, b, d );\n\t\t\t\tindices.push( b, c, d );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// build geometry\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new RingGeometry( data.innerRadius, data.outerRadius, data.thetaSegments, data.phiSegments, data.thetaStart, data.thetaLength );\n\n\t}\n\n}\n\nclass ShapeGeometry extends BufferGeometry {\n\n\tconstructor( shapes = new Shape( [ new Vector2( 0, 0.5 ), new Vector2( - 0.5, - 0.5 ), new Vector2( 0.5, - 0.5 ) ] ), curveSegments = 12 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'ShapeGeometry';\n\n\t\tthis.parameters = {\n\t\t\tshapes: shapes,\n\t\t\tcurveSegments: curveSegments\n\t\t};\n\n\t\t// buffers\n\n\t\tconst indices = [];\n\t\tconst vertices = [];\n\t\tconst normals = [];\n\t\tconst uvs = [];\n\n\t\t// helper variables\n\n\t\tlet groupStart = 0;\n\t\tlet groupCount = 0;\n\n\t\t// allow single and array values for \"shapes\" parameter\n\n\t\tif ( Array.isArray( shapes ) === false ) {\n\n\t\t\taddShape( shapes );\n\n\t\t} else {\n\n\t\t\tfor ( let i = 0; i < shapes.length; i ++ ) {\n\n\t\t\t\taddShape( shapes[ i ] );\n\n\t\t\t\tthis.addGroup( groupStart, groupCount, i ); // enables MultiMaterial support\n\n\t\t\t\tgroupStart += groupCount;\n\t\t\t\tgroupCount = 0;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// build geometry\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\n\t\t// helper functions\n\n\t\tfunction addShape( shape ) {\n\n\t\t\tconst indexOffset = vertices.length / 3;\n\t\t\tconst points = shape.extractPoints( curveSegments );\n\n\t\t\tlet shapeVertices = points.shape;\n\t\t\tconst shapeHoles = points.holes;\n\n\t\t\t// check direction of vertices\n\n\t\t\tif ( ShapeUtils.isClockWise( shapeVertices ) === false ) {\n\n\t\t\t\tshapeVertices = shapeVertices.reverse();\n\n\t\t\t}\n\n\t\t\tfor ( let i = 0, l = shapeHoles.length; i < l; i ++ ) {\n\n\t\t\t\tconst shapeHole = shapeHoles[ i ];\n\n\t\t\t\tif ( ShapeUtils.isClockWise( shapeHole ) === true ) {\n\n\t\t\t\t\tshapeHoles[ i ] = shapeHole.reverse();\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tconst faces = ShapeUtils.triangulateShape( shapeVertices, shapeHoles );\n\n\t\t\t// join vertices of inner and outer paths to a single array\n\n\t\t\tfor ( let i = 0, l = shapeHoles.length; i < l; i ++ ) {\n\n\t\t\t\tconst shapeHole = shapeHoles[ i ];\n\t\t\t\tshapeVertices = shapeVertices.concat( shapeHole );\n\n\t\t\t}\n\n\t\t\t// vertices, normals, uvs\n\n\t\t\tfor ( let i = 0, l = shapeVertices.length; i < l; i ++ ) {\n\n\t\t\t\tconst vertex = shapeVertices[ i ];\n\n\t\t\t\tvertices.push( vertex.x, vertex.y, 0 );\n\t\t\t\tnormals.push( 0, 0, 1 );\n\t\t\t\tuvs.push( vertex.x, vertex.y ); // world uvs\n\n\t\t\t}\n\n\t\t\t// indices\n\n\t\t\tfor ( let i = 0, l = faces.length; i < l; i ++ ) {\n\n\t\t\t\tconst face = faces[ i ];\n\n\t\t\t\tconst a = face[ 0 ] + indexOffset;\n\t\t\t\tconst b = face[ 1 ] + indexOffset;\n\t\t\t\tconst c = face[ 2 ] + indexOffset;\n\n\t\t\t\tindices.push( a, b, c );\n\t\t\t\tgroupCount += 3;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tconst shapes = this.parameters.shapes;\n\n\t\treturn toJSON( shapes, data );\n\n\t}\n\n\tstatic fromJSON( data, shapes ) {\n\n\t\tconst geometryShapes = [];\n\n\t\tfor ( let j = 0, jl = data.shapes.length; j < jl; j ++ ) {\n\n\t\t\tconst shape = shapes[ data.shapes[ j ] ];\n\n\t\t\tgeometryShapes.push( shape );\n\n\t\t}\n\n\t\treturn new ShapeGeometry( geometryShapes, data.curveSegments );\n\n\t}\n\n}\n\nfunction toJSON( shapes, data ) {\n\n\tdata.shapes = [];\n\n\tif ( Array.isArray( shapes ) ) {\n\n\t\tfor ( let i = 0, l = shapes.length; i < l; i ++ ) {\n\n\t\t\tconst shape = shapes[ i ];\n\n\t\t\tdata.shapes.push( shape.uuid );\n\n\t\t}\n\n\t} else {\n\n\t\tdata.shapes.push( shapes.uuid );\n\n\t}\n\n\treturn data;\n\n}\n\nclass SphereGeometry extends BufferGeometry {\n\n\tconstructor( radius = 1, widthSegments = 32, heightSegments = 16, phiStart = 0, phiLength = Math.PI * 2, thetaStart = 0, thetaLength = Math.PI ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'SphereGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\twidthSegments: widthSegments,\n\t\t\theightSegments: heightSegments,\n\t\t\tphiStart: phiStart,\n\t\t\tphiLength: phiLength,\n\t\t\tthetaStart: thetaStart,\n\t\t\tthetaLength: thetaLength\n\t\t};\n\n\t\twidthSegments = Math.max( 3, Math.floor( widthSegments ) );\n\t\theightSegments = Math.max( 2, Math.floor( heightSegments ) );\n\n\t\tconst thetaEnd = Math.min( thetaStart + thetaLength, Math.PI );\n\n\t\tlet index = 0;\n\t\tconst grid = [];\n\n\t\tconst vertex = new Vector3();\n\t\tconst normal = new Vector3();\n\n\t\t// buffers\n\n\t\tconst indices = [];\n\t\tconst vertices = [];\n\t\tconst normals = [];\n\t\tconst uvs = [];\n\n\t\t// generate vertices, normals and uvs\n\n\t\tfor ( let iy = 0; iy <= heightSegments; iy ++ ) {\n\n\t\t\tconst verticesRow = [];\n\n\t\t\tconst v = iy / heightSegments;\n\n\t\t\t// special case for the poles\n\n\t\t\tlet uOffset = 0;\n\n\t\t\tif ( iy == 0 && thetaStart == 0 ) {\n\n\t\t\t\tuOffset = 0.5 / widthSegments;\n\n\t\t\t} else if ( iy == heightSegments && thetaEnd == Math.PI ) {\n\n\t\t\t\tuOffset = - 0.5 / widthSegments;\n\n\t\t\t}\n\n\t\t\tfor ( let ix = 0; ix <= widthSegments; ix ++ ) {\n\n\t\t\t\tconst u = ix / widthSegments;\n\n\t\t\t\t// vertex\n\n\t\t\t\tvertex.x = - radius * Math.cos( phiStart + u * phiLength ) * Math.sin( thetaStart + v * thetaLength );\n\t\t\t\tvertex.y = radius * Math.cos( thetaStart + v * thetaLength );\n\t\t\t\tvertex.z = radius * Math.sin( phiStart + u * phiLength ) * Math.sin( thetaStart + v * thetaLength );\n\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\n\n\t\t\t\t// normal\n\n\t\t\t\tnormal.copy( vertex ).normalize();\n\t\t\t\tnormals.push( normal.x, normal.y, normal.z );\n\n\t\t\t\t// uv\n\n\t\t\t\tuvs.push( u + uOffset, 1 - v );\n\n\t\t\t\tverticesRow.push( index ++ );\n\n\t\t\t}\n\n\t\t\tgrid.push( verticesRow );\n\n\t\t}\n\n\t\t// indices\n\n\t\tfor ( let iy = 0; iy < heightSegments; iy ++ ) {\n\n\t\t\tfor ( let ix = 0; ix < widthSegments; ix ++ ) {\n\n\t\t\t\tconst a = grid[ iy ][ ix + 1 ];\n\t\t\t\tconst b = grid[ iy ][ ix ];\n\t\t\t\tconst c = grid[ iy + 1 ][ ix ];\n\t\t\t\tconst d = grid[ iy + 1 ][ ix + 1 ];\n\n\t\t\t\tif ( iy !== 0 || thetaStart > 0 ) indices.push( a, b, d );\n\t\t\t\tif ( iy !== heightSegments - 1 || thetaEnd < Math.PI ) indices.push( b, c, d );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// build geometry\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new SphereGeometry( data.radius, data.widthSegments, data.heightSegments, data.phiStart, data.phiLength, data.thetaStart, data.thetaLength );\n\n\t}\n\n}\n\nclass TetrahedronGeometry extends PolyhedronGeometry {\n\n\tconstructor( radius = 1, detail = 0 ) {\n\n\t\tconst vertices = [\n\t\t\t1, 1, 1, \t- 1, - 1, 1, \t- 1, 1, - 1, \t1, - 1, - 1\n\t\t];\n\n\t\tconst indices = [\n\t\t\t2, 1, 0, \t0, 3, 2,\t1, 3, 0,\t2, 3, 1\n\t\t];\n\n\t\tsuper( vertices, indices, radius, detail );\n\n\t\tthis.type = 'TetrahedronGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\tdetail: detail\n\t\t};\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new TetrahedronGeometry( data.radius, data.detail );\n\n\t}\n\n}\n\nclass TorusGeometry extends BufferGeometry {\n\n\tconstructor( radius = 1, tube = 0.4, radialSegments = 12, tubularSegments = 48, arc = Math.PI * 2 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'TorusGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\ttube: tube,\n\t\t\tradialSegments: radialSegments,\n\t\t\ttubularSegments: tubularSegments,\n\t\t\tarc: arc\n\t\t};\n\n\t\tradialSegments = Math.floor( radialSegments );\n\t\ttubularSegments = Math.floor( tubularSegments );\n\n\t\t// buffers\n\n\t\tconst indices = [];\n\t\tconst vertices = [];\n\t\tconst normals = [];\n\t\tconst uvs = [];\n\n\t\t// helper variables\n\n\t\tconst center = new Vector3();\n\t\tconst vertex = new Vector3();\n\t\tconst normal = new Vector3();\n\n\t\t// generate vertices, normals and uvs\n\n\t\tfor ( let j = 0; j <= radialSegments; j ++ ) {\n\n\t\t\tfor ( let i = 0; i <= tubularSegments; i ++ ) {\n\n\t\t\t\tconst u = i / tubularSegments * arc;\n\t\t\t\tconst v = j / radialSegments * Math.PI * 2;\n\n\t\t\t\t// vertex\n\n\t\t\t\tvertex.x = ( radius + tube * Math.cos( v ) ) * Math.cos( u );\n\t\t\t\tvertex.y = ( radius + tube * Math.cos( v ) ) * Math.sin( u );\n\t\t\t\tvertex.z = tube * Math.sin( v );\n\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\n\n\t\t\t\t// normal\n\n\t\t\t\tcenter.x = radius * Math.cos( u );\n\t\t\t\tcenter.y = radius * Math.sin( u );\n\t\t\t\tnormal.subVectors( vertex, center ).normalize();\n\n\t\t\t\tnormals.push( normal.x, normal.y, normal.z );\n\n\t\t\t\t// uv\n\n\t\t\t\tuvs.push( i / tubularSegments );\n\t\t\t\tuvs.push( j / radialSegments );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// generate indices\n\n\t\tfor ( let j = 1; j <= radialSegments; j ++ ) {\n\n\t\t\tfor ( let i = 1; i <= tubularSegments; i ++ ) {\n\n\t\t\t\t// indices\n\n\t\t\t\tconst a = ( tubularSegments + 1 ) * j + i - 1;\n\t\t\t\tconst b = ( tubularSegments + 1 ) * ( j - 1 ) + i - 1;\n\t\t\t\tconst c = ( tubularSegments + 1 ) * ( j - 1 ) + i;\n\t\t\t\tconst d = ( tubularSegments + 1 ) * j + i;\n\n\t\t\t\t// faces\n\n\t\t\t\tindices.push( a, b, d );\n\t\t\t\tindices.push( b, c, d );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// build geometry\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new TorusGeometry( data.radius, data.tube, data.radialSegments, data.tubularSegments, data.arc );\n\n\t}\n\n}\n\nclass TorusKnotGeometry extends BufferGeometry {\n\n\tconstructor( radius = 1, tube = 0.4, tubularSegments = 64, radialSegments = 8, p = 2, q = 3 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'TorusKnotGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\ttube: tube,\n\t\t\ttubularSegments: tubularSegments,\n\t\t\tradialSegments: radialSegments,\n\t\t\tp: p,\n\t\t\tq: q\n\t\t};\n\n\t\ttubularSegments = Math.floor( tubularSegments );\n\t\tradialSegments = Math.floor( radialSegments );\n\n\t\t// buffers\n\n\t\tconst indices = [];\n\t\tconst vertices = [];\n\t\tconst normals = [];\n\t\tconst uvs = [];\n\n\t\t// helper variables\n\n\t\tconst vertex = new Vector3();\n\t\tconst normal = new Vector3();\n\n\t\tconst P1 = new Vector3();\n\t\tconst P2 = new Vector3();\n\n\t\tconst B = new Vector3();\n\t\tconst T = new Vector3();\n\t\tconst N = new Vector3();\n\n\t\t// generate vertices, normals and uvs\n\n\t\tfor ( let i = 0; i <= tubularSegments; ++ i ) {\n\n\t\t\t// the radian \"u\" is used to calculate the position on the torus curve of the current tubular segment\n\n\t\t\tconst u = i / tubularSegments * p * Math.PI * 2;\n\n\t\t\t// now we calculate two points. P1 is our current position on the curve, P2 is a little farther ahead.\n\t\t\t// these points are used to create a special \"coordinate space\", which is necessary to calculate the correct vertex positions\n\n\t\t\tcalculatePositionOnCurve( u, p, q, radius, P1 );\n\t\t\tcalculatePositionOnCurve( u + 0.01, p, q, radius, P2 );\n\n\t\t\t// calculate orthonormal basis\n\n\t\t\tT.subVectors( P2, P1 );\n\t\t\tN.addVectors( P2, P1 );\n\t\t\tB.crossVectors( T, N );\n\t\t\tN.crossVectors( B, T );\n\n\t\t\t// normalize B, N. T can be ignored, we don't use it\n\n\t\t\tB.normalize();\n\t\t\tN.normalize();\n\n\t\t\tfor ( let j = 0; j <= radialSegments; ++ j ) {\n\n\t\t\t\t// now calculate the vertices. they are nothing more than an extrusion of the torus curve.\n\t\t\t\t// because we extrude a shape in the xy-plane, there is no need to calculate a z-value.\n\n\t\t\t\tconst v = j / radialSegments * Math.PI * 2;\n\t\t\t\tconst cx = - tube * Math.cos( v );\n\t\t\t\tconst cy = tube * Math.sin( v );\n\n\t\t\t\t// now calculate the final vertex position.\n\t\t\t\t// first we orient the extrusion with our basis vectors, then we add it to the current position on the curve\n\n\t\t\t\tvertex.x = P1.x + ( cx * N.x + cy * B.x );\n\t\t\t\tvertex.y = P1.y + ( cx * N.y + cy * B.y );\n\t\t\t\tvertex.z = P1.z + ( cx * N.z + cy * B.z );\n\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\n\n\t\t\t\t// normal (P1 is always the center/origin of the extrusion, thus we can use it to calculate the normal)\n\n\t\t\t\tnormal.subVectors( vertex, P1 ).normalize();\n\n\t\t\t\tnormals.push( normal.x, normal.y, normal.z );\n\n\t\t\t\t// uv\n\n\t\t\t\tuvs.push( i / tubularSegments );\n\t\t\t\tuvs.push( j / radialSegments );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// generate indices\n\n\t\tfor ( let j = 1; j <= tubularSegments; j ++ ) {\n\n\t\t\tfor ( let i = 1; i <= radialSegments; i ++ ) {\n\n\t\t\t\t// indices\n\n\t\t\t\tconst a = ( radialSegments + 1 ) * ( j - 1 ) + ( i - 1 );\n\t\t\t\tconst b = ( radialSegments + 1 ) * j + ( i - 1 );\n\t\t\t\tconst c = ( radialSegments + 1 ) * j + i;\n\t\t\t\tconst d = ( radialSegments + 1 ) * ( j - 1 ) + i;\n\n\t\t\t\t// faces\n\n\t\t\t\tindices.push( a, b, d );\n\t\t\t\tindices.push( b, c, d );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// build geometry\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\t\t// this function calculates the current position on the torus curve\n\n\t\tfunction calculatePositionOnCurve( u, p, q, radius, position ) {\n\n\t\t\tconst cu = Math.cos( u );\n\t\t\tconst su = Math.sin( u );\n\t\t\tconst quOverP = q / p * u;\n\t\t\tconst cs = Math.cos( quOverP );\n\n\t\t\tposition.x = radius * ( 2 + cs ) * 0.5 * cu;\n\t\t\tposition.y = radius * ( 2 + cs ) * su * 0.5;\n\t\t\tposition.z = radius * Math.sin( quOverP ) * 0.5;\n\n\t\t}\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new TorusKnotGeometry( data.radius, data.tube, data.tubularSegments, data.radialSegments, data.p, data.q );\n\n\t}\n\n}\n\nclass TubeGeometry extends BufferGeometry {\n\n\tconstructor( path = new QuadraticBezierCurve3( new Vector3( - 1, - 1, 0 ), new Vector3( - 1, 1, 0 ), new Vector3( 1, 1, 0 ) ), tubularSegments = 64, radius = 1, radialSegments = 8, closed = false ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'TubeGeometry';\n\n\t\tthis.parameters = {\n\t\t\tpath: path,\n\t\t\ttubularSegments: tubularSegments,\n\t\t\tradius: radius,\n\t\t\tradialSegments: radialSegments,\n\t\t\tclosed: closed\n\t\t};\n\n\t\tconst frames = path.computeFrenetFrames( tubularSegments, closed );\n\n\t\t// expose internals\n\n\t\tthis.tangents = frames.tangents;\n\t\tthis.normals = frames.normals;\n\t\tthis.binormals = frames.binormals;\n\n\t\t// helper variables\n\n\t\tconst vertex = new Vector3();\n\t\tconst normal = new Vector3();\n\t\tconst uv = new Vector2();\n\t\tlet P = new Vector3();\n\n\t\t// buffer\n\n\t\tconst vertices = [];\n\t\tconst normals = [];\n\t\tconst uvs = [];\n\t\tconst indices = [];\n\n\t\t// create buffer data\n\n\t\tgenerateBufferData();\n\n\t\t// build geometry\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\t\t// functions\n\n\t\tfunction generateBufferData() {\n\n\t\t\tfor ( let i = 0; i < tubularSegments; i ++ ) {\n\n\t\t\t\tgenerateSegment( i );\n\n\t\t\t}\n\n\t\t\t// if the geometry is not closed, generate the last row of vertices and normals\n\t\t\t// at the regular position on the given path\n\t\t\t//\n\t\t\t// if the geometry is closed, duplicate the first row of vertices and normals (uvs will differ)\n\n\t\t\tgenerateSegment( ( closed === false ) ? tubularSegments : 0 );\n\n\t\t\t// uvs are generated in a separate function.\n\t\t\t// this makes it easy compute correct values for closed geometries\n\n\t\t\tgenerateUVs();\n\n\t\t\t// finally create faces\n\n\t\t\tgenerateIndices();\n\n\t\t}\n\n\t\tfunction generateSegment( i ) {\n\n\t\t\t// we use getPointAt to sample evenly distributed points from the given path\n\n\t\t\tP = path.getPointAt( i / tubularSegments, P );\n\n\t\t\t// retrieve corresponding normal and binormal\n\n\t\t\tconst N = frames.normals[ i ];\n\t\t\tconst B = frames.binormals[ i ];\n\n\t\t\t// generate normals and vertices for the current segment\n\n\t\t\tfor ( let j = 0; j <= radialSegments; j ++ ) {\n\n\t\t\t\tconst v = j / radialSegments * Math.PI * 2;\n\n\t\t\t\tconst sin = Math.sin( v );\n\t\t\t\tconst cos = - Math.cos( v );\n\n\t\t\t\t// normal\n\n\t\t\t\tnormal.x = ( cos * N.x + sin * B.x );\n\t\t\t\tnormal.y = ( cos * N.y + sin * B.y );\n\t\t\t\tnormal.z = ( cos * N.z + sin * B.z );\n\t\t\t\tnormal.normalize();\n\n\t\t\t\tnormals.push( normal.x, normal.y, normal.z );\n\n\t\t\t\t// vertex\n\n\t\t\t\tvertex.x = P.x + radius * normal.x;\n\t\t\t\tvertex.y = P.y + radius * normal.y;\n\t\t\t\tvertex.z = P.z + radius * normal.z;\n\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction generateIndices() {\n\n\t\t\tfor ( let j = 1; j <= tubularSegments; j ++ ) {\n\n\t\t\t\tfor ( let i = 1; i <= radialSegments; i ++ ) {\n\n\t\t\t\t\tconst a = ( radialSegments + 1 ) * ( j - 1 ) + ( i - 1 );\n\t\t\t\t\tconst b = ( radialSegments + 1 ) * j + ( i - 1 );\n\t\t\t\t\tconst c = ( radialSegments + 1 ) * j + i;\n\t\t\t\t\tconst d = ( radialSegments + 1 ) * ( j - 1 ) + i;\n\n\t\t\t\t\t// faces\n\n\t\t\t\t\tindices.push( a, b, d );\n\t\t\t\t\tindices.push( b, c, d );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction generateUVs() {\n\n\t\t\tfor ( let i = 0; i <= tubularSegments; i ++ ) {\n\n\t\t\t\tfor ( let j = 0; j <= radialSegments; j ++ ) {\n\n\t\t\t\t\tuv.x = i / tubularSegments;\n\t\t\t\t\tuv.y = j / radialSegments;\n\n\t\t\t\t\tuvs.push( uv.x, uv.y );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.path = this.parameters.path.toJSON();\n\n\t\treturn data;\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\t// This only works for built-in curves (e.g. CatmullRomCurve3).\n\t\t// User defined curves or instances of CurvePath will not be deserialized.\n\t\treturn new TubeGeometry(\n\t\t\tnew Curves[ data.path.type ]().fromJSON( data.path ),\n\t\t\tdata.tubularSegments,\n\t\t\tdata.radius,\n\t\t\tdata.radialSegments,\n\t\t\tdata.closed\n\t\t);\n\n\t}\n\n}\n\nclass WireframeGeometry extends BufferGeometry {\n\n\tconstructor( geometry = null ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'WireframeGeometry';\n\n\t\tthis.parameters = {\n\t\t\tgeometry: geometry\n\t\t};\n\n\t\tif ( geometry !== null ) {\n\n\t\t\t// buffer\n\n\t\t\tconst vertices = [];\n\t\t\tconst edges = new Set();\n\n\t\t\t// helper variables\n\n\t\t\tconst start = new Vector3();\n\t\t\tconst end = new Vector3();\n\n\t\t\tif ( geometry.index !== null ) {\n\n\t\t\t\t// indexed BufferGeometry\n\n\t\t\t\tconst position = geometry.attributes.position;\n\t\t\t\tconst indices = geometry.index;\n\t\t\t\tlet groups = geometry.groups;\n\n\t\t\t\tif ( groups.length === 0 ) {\n\n\t\t\t\t\tgroups = [ { start: 0, count: indices.count, materialIndex: 0 } ];\n\n\t\t\t\t}\n\n\t\t\t\t// create a data structure that contains all edges without duplicates\n\n\t\t\t\tfor ( let o = 0, ol = groups.length; o < ol; ++ o ) {\n\n\t\t\t\t\tconst group = groups[ o ];\n\n\t\t\t\t\tconst groupStart = group.start;\n\t\t\t\t\tconst groupCount = group.count;\n\n\t\t\t\t\tfor ( let i = groupStart, l = ( groupStart + groupCount ); i < l; i += 3 ) {\n\n\t\t\t\t\t\tfor ( let j = 0; j < 3; j ++ ) {\n\n\t\t\t\t\t\t\tconst index1 = indices.getX( i + j );\n\t\t\t\t\t\t\tconst index2 = indices.getX( i + ( j + 1 ) % 3 );\n\n\t\t\t\t\t\t\tstart.fromBufferAttribute( position, index1 );\n\t\t\t\t\t\t\tend.fromBufferAttribute( position, index2 );\n\n\t\t\t\t\t\t\tif ( isUniqueEdge( start, end, edges ) === true ) {\n\n\t\t\t\t\t\t\t\tvertices.push( start.x, start.y, start.z );\n\t\t\t\t\t\t\t\tvertices.push( end.x, end.y, end.z );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t// non-indexed BufferGeometry\n\n\t\t\t\tconst position = geometry.attributes.position;\n\n\t\t\t\tfor ( let i = 0, l = ( position.count / 3 ); i < l; i ++ ) {\n\n\t\t\t\t\tfor ( let j = 0; j < 3; j ++ ) {\n\n\t\t\t\t\t\t// three edges per triangle, an edge is represented as (index1, index2)\n\t\t\t\t\t\t// e.g. the first triangle has the following edges: (0,1),(1,2),(2,0)\n\n\t\t\t\t\t\tconst index1 = 3 * i + j;\n\t\t\t\t\t\tconst index2 = 3 * i + ( ( j + 1 ) % 3 );\n\n\t\t\t\t\t\tstart.fromBufferAttribute( position, index1 );\n\t\t\t\t\t\tend.fromBufferAttribute( position, index2 );\n\n\t\t\t\t\t\tif ( isUniqueEdge( start, end, edges ) === true ) {\n\n\t\t\t\t\t\t\tvertices.push( start.x, start.y, start.z );\n\t\t\t\t\t\t\tvertices.push( end.x, end.y, end.z );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// build geometry\n\n\t\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\n\t\t}\n\n\t}\n\n}\n\nfunction isUniqueEdge( start, end, edges ) {\n\n\tconst hash1 = `${start.x},${start.y},${start.z}-${end.x},${end.y},${end.z}`;\n\tconst hash2 = `${end.x},${end.y},${end.z}-${start.x},${start.y},${start.z}`; // coincident edge\n\n\tif ( edges.has( hash1 ) === true || edges.has( hash2 ) === true ) {\n\n\t\treturn false;\n\n\t} else {\n\n\t\tedges.add( hash1 );\n\t\tedges.add( hash2 );\n\t\treturn true;\n\n\t}\n\n}\n\nvar Geometries = /*#__PURE__*/Object.freeze({\n\t__proto__: null,\n\tBoxGeometry: BoxGeometry,\n\tCapsuleGeometry: CapsuleGeometry,\n\tCircleGeometry: CircleGeometry,\n\tConeGeometry: ConeGeometry,\n\tCylinderGeometry: CylinderGeometry,\n\tDodecahedronGeometry: DodecahedronGeometry,\n\tEdgesGeometry: EdgesGeometry,\n\tExtrudeGeometry: ExtrudeGeometry,\n\tIcosahedronGeometry: IcosahedronGeometry,\n\tLatheGeometry: LatheGeometry,\n\tOctahedronGeometry: OctahedronGeometry,\n\tPlaneGeometry: PlaneGeometry,\n\tPolyhedronGeometry: PolyhedronGeometry,\n\tRingGeometry: RingGeometry,\n\tShapeGeometry: ShapeGeometry,\n\tSphereGeometry: SphereGeometry,\n\tTetrahedronGeometry: TetrahedronGeometry,\n\tTorusGeometry: TorusGeometry,\n\tTorusKnotGeometry: TorusKnotGeometry,\n\tTubeGeometry: TubeGeometry,\n\tWireframeGeometry: WireframeGeometry\n});\n\nclass ShadowMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isShadowMaterial = true;\n\n\t\tthis.type = 'ShadowMaterial';\n\n\t\tthis.color = new Color( 0x000000 );\n\t\tthis.transparent = true;\n\n\t\tthis.fog = true;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\n\t\tthis.fog = source.fog;\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass RawShaderMaterial extends ShaderMaterial {\n\n\tconstructor( parameters ) {\n\n\t\tsuper( parameters );\n\n\t\tthis.isRawShaderMaterial = true;\n\n\t\tthis.type = 'RawShaderMaterial';\n\n\t}\n\n}\n\nclass MeshStandardMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshStandardMaterial = true;\n\n\t\tthis.defines = { 'STANDARD': '' };\n\n\t\tthis.type = 'MeshStandardMaterial';\n\n\t\tthis.color = new Color( 0xffffff ); // diffuse\n\t\tthis.roughness = 1.0;\n\t\tthis.metalness = 0.0;\n\n\t\tthis.map = null;\n\n\t\tthis.lightMap = null;\n\t\tthis.lightMapIntensity = 1.0;\n\n\t\tthis.aoMap = null;\n\t\tthis.aoMapIntensity = 1.0;\n\n\t\tthis.emissive = new Color( 0x000000 );\n\t\tthis.emissiveIntensity = 1.0;\n\t\tthis.emissiveMap = null;\n\n\t\tthis.bumpMap = null;\n\t\tthis.bumpScale = 1;\n\n\t\tthis.normalMap = null;\n\t\tthis.normalMapType = TangentSpaceNormalMap;\n\t\tthis.normalScale = new Vector2( 1, 1 );\n\n\t\tthis.displacementMap = null;\n\t\tthis.displacementScale = 1;\n\t\tthis.displacementBias = 0;\n\n\t\tthis.roughnessMap = null;\n\n\t\tthis.metalnessMap = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.envMap = null;\n\t\tthis.envMapIntensity = 1.0;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\t\tthis.wireframeLinecap = 'round';\n\t\tthis.wireframeLinejoin = 'round';\n\n\t\tthis.flatShading = false;\n\n\t\tthis.fog = true;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.defines = { 'STANDARD': '' };\n\n\t\tthis.color.copy( source.color );\n\t\tthis.roughness = source.roughness;\n\t\tthis.metalness = source.metalness;\n\n\t\tthis.map = source.map;\n\n\t\tthis.lightMap = source.lightMap;\n\t\tthis.lightMapIntensity = source.lightMapIntensity;\n\n\t\tthis.aoMap = source.aoMap;\n\t\tthis.aoMapIntensity = source.aoMapIntensity;\n\n\t\tthis.emissive.copy( source.emissive );\n\t\tthis.emissiveMap = source.emissiveMap;\n\t\tthis.emissiveIntensity = source.emissiveIntensity;\n\n\t\tthis.bumpMap = source.bumpMap;\n\t\tthis.bumpScale = source.bumpScale;\n\n\t\tthis.normalMap = source.normalMap;\n\t\tthis.normalMapType = source.normalMapType;\n\t\tthis.normalScale.copy( source.normalScale );\n\n\t\tthis.displacementMap = source.displacementMap;\n\t\tthis.displacementScale = source.displacementScale;\n\t\tthis.displacementBias = source.displacementBias;\n\n\t\tthis.roughnessMap = source.roughnessMap;\n\n\t\tthis.metalnessMap = source.metalnessMap;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.envMap = source.envMap;\n\t\tthis.envMapIntensity = source.envMapIntensity;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\t\tthis.wireframeLinecap = source.wireframeLinecap;\n\t\tthis.wireframeLinejoin = source.wireframeLinejoin;\n\n\t\tthis.flatShading = source.flatShading;\n\n\t\tthis.fog = source.fog;\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass MeshPhysicalMaterial extends MeshStandardMaterial {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshPhysicalMaterial = true;\n\n\t\tthis.defines = {\n\n\t\t\t'STANDARD': '',\n\t\t\t'PHYSICAL': ''\n\n\t\t};\n\n\t\tthis.type = 'MeshPhysicalMaterial';\n\n\t\tthis.clearcoatMap = null;\n\t\tthis.clearcoatRoughness = 0.0;\n\t\tthis.clearcoatRoughnessMap = null;\n\t\tthis.clearcoatNormalScale = new Vector2( 1, 1 );\n\t\tthis.clearcoatNormalMap = null;\n\n\t\tthis.ior = 1.5;\n\n\t\tObject.defineProperty( this, 'reflectivity', {\n\t\t\tget: function () {\n\n\t\t\t\treturn ( clamp( 2.5 * ( this.ior - 1 ) / ( this.ior + 1 ), 0, 1 ) );\n\n\t\t\t},\n\t\t\tset: function ( reflectivity ) {\n\n\t\t\t\tthis.ior = ( 1 + 0.4 * reflectivity ) / ( 1 - 0.4 * reflectivity );\n\n\t\t\t}\n\t\t} );\n\n\t\tthis.iridescenceMap = null;\n\t\tthis.iridescenceIOR = 1.3;\n\t\tthis.iridescenceThicknessRange = [ 100, 400 ];\n\t\tthis.iridescenceThicknessMap = null;\n\n\t\tthis.sheenColor = new Color( 0x000000 );\n\t\tthis.sheenColorMap = null;\n\t\tthis.sheenRoughness = 1.0;\n\t\tthis.sheenRoughnessMap = null;\n\n\t\tthis.transmissionMap = null;\n\n\t\tthis.thickness = 0;\n\t\tthis.thicknessMap = null;\n\t\tthis.attenuationDistance = Infinity;\n\t\tthis.attenuationColor = new Color( 1, 1, 1 );\n\n\t\tthis.specularIntensity = 1.0;\n\t\tthis.specularIntensityMap = null;\n\t\tthis.specularColor = new Color( 1, 1, 1 );\n\t\tthis.specularColorMap = null;\n\n\t\tthis._sheen = 0.0;\n\t\tthis._clearcoat = 0;\n\t\tthis._iridescence = 0;\n\t\tthis._transmission = 0;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tget sheen() {\n\n\t\treturn this._sheen;\n\n\t}\n\n\tset sheen( value ) {\n\n\t\tif ( this._sheen > 0 !== value > 0 ) {\n\n\t\t\tthis.version ++;\n\n\t\t}\n\n\t\tthis._sheen = value;\n\n\t}\n\n\tget clearcoat() {\n\n\t\treturn this._clearcoat;\n\n\t}\n\n\tset clearcoat( value ) {\n\n\t\tif ( this._clearcoat > 0 !== value > 0 ) {\n\n\t\t\tthis.version ++;\n\n\t\t}\n\n\t\tthis._clearcoat = value;\n\n\t}\n\n\tget iridescence() {\n\n\t\treturn this._iridescence;\n\n\t}\n\n\tset iridescence( value ) {\n\n\t\tif ( this._iridescence > 0 !== value > 0 ) {\n\n\t\t\tthis.version ++;\n\n\t\t}\n\n\t\tthis._iridescence = value;\n\n\t}\n\n\tget transmission() {\n\n\t\treturn this._transmission;\n\n\t}\n\n\tset transmission( value ) {\n\n\t\tif ( this._transmission > 0 !== value > 0 ) {\n\n\t\t\tthis.version ++;\n\n\t\t}\n\n\t\tthis._transmission = value;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.defines = {\n\n\t\t\t'STANDARD': '',\n\t\t\t'PHYSICAL': ''\n\n\t\t};\n\n\t\tthis.clearcoat = source.clearcoat;\n\t\tthis.clearcoatMap = source.clearcoatMap;\n\t\tthis.clearcoatRoughness = source.clearcoatRoughness;\n\t\tthis.clearcoatRoughnessMap = source.clearcoatRoughnessMap;\n\t\tthis.clearcoatNormalMap = source.clearcoatNormalMap;\n\t\tthis.clearcoatNormalScale.copy( source.clearcoatNormalScale );\n\n\t\tthis.ior = source.ior;\n\n\t\tthis.iridescence = source.iridescence;\n\t\tthis.iridescenceMap = source.iridescenceMap;\n\t\tthis.iridescenceIOR = source.iridescenceIOR;\n\t\tthis.iridescenceThicknessRange = [ ...source.iridescenceThicknessRange ];\n\t\tthis.iridescenceThicknessMap = source.iridescenceThicknessMap;\n\n\t\tthis.sheen = source.sheen;\n\t\tthis.sheenColor.copy( source.sheenColor );\n\t\tthis.sheenColorMap = source.sheenColorMap;\n\t\tthis.sheenRoughness = source.sheenRoughness;\n\t\tthis.sheenRoughnessMap = source.sheenRoughnessMap;\n\n\t\tthis.transmission = source.transmission;\n\t\tthis.transmissionMap = source.transmissionMap;\n\n\t\tthis.thickness = source.thickness;\n\t\tthis.thicknessMap = source.thicknessMap;\n\t\tthis.attenuationDistance = source.attenuationDistance;\n\t\tthis.attenuationColor.copy( source.attenuationColor );\n\n\t\tthis.specularIntensity = source.specularIntensity;\n\t\tthis.specularIntensityMap = source.specularIntensityMap;\n\t\tthis.specularColor.copy( source.specularColor );\n\t\tthis.specularColorMap = source.specularColorMap;\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass MeshPhongMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshPhongMaterial = true;\n\n\t\tthis.type = 'MeshPhongMaterial';\n\n\t\tthis.color = new Color( 0xffffff ); // diffuse\n\t\tthis.specular = new Color( 0x111111 );\n\t\tthis.shininess = 30;\n\n\t\tthis.map = null;\n\n\t\tthis.lightMap = null;\n\t\tthis.lightMapIntensity = 1.0;\n\n\t\tthis.aoMap = null;\n\t\tthis.aoMapIntensity = 1.0;\n\n\t\tthis.emissive = new Color( 0x000000 );\n\t\tthis.emissiveIntensity = 1.0;\n\t\tthis.emissiveMap = null;\n\n\t\tthis.bumpMap = null;\n\t\tthis.bumpScale = 1;\n\n\t\tthis.normalMap = null;\n\t\tthis.normalMapType = TangentSpaceNormalMap;\n\t\tthis.normalScale = new Vector2( 1, 1 );\n\n\t\tthis.displacementMap = null;\n\t\tthis.displacementScale = 1;\n\t\tthis.displacementBias = 0;\n\n\t\tthis.specularMap = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.envMap = null;\n\t\tthis.combine = MultiplyOperation;\n\t\tthis.reflectivity = 1;\n\t\tthis.refractionRatio = 0.98;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\t\tthis.wireframeLinecap = 'round';\n\t\tthis.wireframeLinejoin = 'round';\n\n\t\tthis.flatShading = false;\n\n\t\tthis.fog = true;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\t\tthis.specular.copy( source.specular );\n\t\tthis.shininess = source.shininess;\n\n\t\tthis.map = source.map;\n\n\t\tthis.lightMap = source.lightMap;\n\t\tthis.lightMapIntensity = source.lightMapIntensity;\n\n\t\tthis.aoMap = source.aoMap;\n\t\tthis.aoMapIntensity = source.aoMapIntensity;\n\n\t\tthis.emissive.copy( source.emissive );\n\t\tthis.emissiveMap = source.emissiveMap;\n\t\tthis.emissiveIntensity = source.emissiveIntensity;\n\n\t\tthis.bumpMap = source.bumpMap;\n\t\tthis.bumpScale = source.bumpScale;\n\n\t\tthis.normalMap = source.normalMap;\n\t\tthis.normalMapType = source.normalMapType;\n\t\tthis.normalScale.copy( source.normalScale );\n\n\t\tthis.displacementMap = source.displacementMap;\n\t\tthis.displacementScale = source.displacementScale;\n\t\tthis.displacementBias = source.displacementBias;\n\n\t\tthis.specularMap = source.specularMap;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.envMap = source.envMap;\n\t\tthis.combine = source.combine;\n\t\tthis.reflectivity = source.reflectivity;\n\t\tthis.refractionRatio = source.refractionRatio;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\t\tthis.wireframeLinecap = source.wireframeLinecap;\n\t\tthis.wireframeLinejoin = source.wireframeLinejoin;\n\n\t\tthis.flatShading = source.flatShading;\n\n\t\tthis.fog = source.fog;\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass MeshToonMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshToonMaterial = true;\n\n\t\tthis.defines = { 'TOON': '' };\n\n\t\tthis.type = 'MeshToonMaterial';\n\n\t\tthis.color = new Color( 0xffffff );\n\n\t\tthis.map = null;\n\t\tthis.gradientMap = null;\n\n\t\tthis.lightMap = null;\n\t\tthis.lightMapIntensity = 1.0;\n\n\t\tthis.aoMap = null;\n\t\tthis.aoMapIntensity = 1.0;\n\n\t\tthis.emissive = new Color( 0x000000 );\n\t\tthis.emissiveIntensity = 1.0;\n\t\tthis.emissiveMap = null;\n\n\t\tthis.bumpMap = null;\n\t\tthis.bumpScale = 1;\n\n\t\tthis.normalMap = null;\n\t\tthis.normalMapType = TangentSpaceNormalMap;\n\t\tthis.normalScale = new Vector2( 1, 1 );\n\n\t\tthis.displacementMap = null;\n\t\tthis.displacementScale = 1;\n\t\tthis.displacementBias = 0;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\t\tthis.wireframeLinecap = 'round';\n\t\tthis.wireframeLinejoin = 'round';\n\n\t\tthis.fog = true;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\n\t\tthis.map = source.map;\n\t\tthis.gradientMap = source.gradientMap;\n\n\t\tthis.lightMap = source.lightMap;\n\t\tthis.lightMapIntensity = source.lightMapIntensity;\n\n\t\tthis.aoMap = source.aoMap;\n\t\tthis.aoMapIntensity = source.aoMapIntensity;\n\n\t\tthis.emissive.copy( source.emissive );\n\t\tthis.emissiveMap = source.emissiveMap;\n\t\tthis.emissiveIntensity = source.emissiveIntensity;\n\n\t\tthis.bumpMap = source.bumpMap;\n\t\tthis.bumpScale = source.bumpScale;\n\n\t\tthis.normalMap = source.normalMap;\n\t\tthis.normalMapType = source.normalMapType;\n\t\tthis.normalScale.copy( source.normalScale );\n\n\t\tthis.displacementMap = source.displacementMap;\n\t\tthis.displacementScale = source.displacementScale;\n\t\tthis.displacementBias = source.displacementBias;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\t\tthis.wireframeLinecap = source.wireframeLinecap;\n\t\tthis.wireframeLinejoin = source.wireframeLinejoin;\n\n\t\tthis.fog = source.fog;\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass MeshNormalMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshNormalMaterial = true;\n\n\t\tthis.type = 'MeshNormalMaterial';\n\n\t\tthis.bumpMap = null;\n\t\tthis.bumpScale = 1;\n\n\t\tthis.normalMap = null;\n\t\tthis.normalMapType = TangentSpaceNormalMap;\n\t\tthis.normalScale = new Vector2( 1, 1 );\n\n\t\tthis.displacementMap = null;\n\t\tthis.displacementScale = 1;\n\t\tthis.displacementBias = 0;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\n\t\tthis.flatShading = false;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.bumpMap = source.bumpMap;\n\t\tthis.bumpScale = source.bumpScale;\n\n\t\tthis.normalMap = source.normalMap;\n\t\tthis.normalMapType = source.normalMapType;\n\t\tthis.normalScale.copy( source.normalScale );\n\n\t\tthis.displacementMap = source.displacementMap;\n\t\tthis.displacementScale = source.displacementScale;\n\t\tthis.displacementBias = source.displacementBias;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\n\t\tthis.flatShading = source.flatShading;\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass MeshLambertMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshLambertMaterial = true;\n\n\t\tthis.type = 'MeshLambertMaterial';\n\n\t\tthis.color = new Color( 0xffffff ); // diffuse\n\n\t\tthis.map = null;\n\n\t\tthis.lightMap = null;\n\t\tthis.lightMapIntensity = 1.0;\n\n\t\tthis.aoMap = null;\n\t\tthis.aoMapIntensity = 1.0;\n\n\t\tthis.emissive = new Color( 0x000000 );\n\t\tthis.emissiveIntensity = 1.0;\n\t\tthis.emissiveMap = null;\n\n\t\tthis.bumpMap = null;\n\t\tthis.bumpScale = 1;\n\n\t\tthis.normalMap = null;\n\t\tthis.normalMapType = TangentSpaceNormalMap;\n\t\tthis.normalScale = new Vector2( 1, 1 );\n\n\t\tthis.displacementMap = null;\n\t\tthis.displacementScale = 1;\n\t\tthis.displacementBias = 0;\n\n\t\tthis.specularMap = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.envMap = null;\n\t\tthis.combine = MultiplyOperation;\n\t\tthis.reflectivity = 1;\n\t\tthis.refractionRatio = 0.98;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\t\tthis.wireframeLinecap = 'round';\n\t\tthis.wireframeLinejoin = 'round';\n\n\t\tthis.flatShading = false;\n\n\t\tthis.fog = true;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\n\t\tthis.map = source.map;\n\n\t\tthis.lightMap = source.lightMap;\n\t\tthis.lightMapIntensity = source.lightMapIntensity;\n\n\t\tthis.aoMap = source.aoMap;\n\t\tthis.aoMapIntensity = source.aoMapIntensity;\n\n\t\tthis.emissive.copy( source.emissive );\n\t\tthis.emissiveMap = source.emissiveMap;\n\t\tthis.emissiveIntensity = source.emissiveIntensity;\n\n\t\tthis.bumpMap = source.bumpMap;\n\t\tthis.bumpScale = source.bumpScale;\n\n\t\tthis.normalMap = source.normalMap;\n\t\tthis.normalMapType = source.normalMapType;\n\t\tthis.normalScale.copy( source.normalScale );\n\n\t\tthis.displacementMap = source.displacementMap;\n\t\tthis.displacementScale = source.displacementScale;\n\t\tthis.displacementBias = source.displacementBias;\n\n\t\tthis.specularMap = source.specularMap;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.envMap = source.envMap;\n\t\tthis.combine = source.combine;\n\t\tthis.reflectivity = source.reflectivity;\n\t\tthis.refractionRatio = source.refractionRatio;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\t\tthis.wireframeLinecap = source.wireframeLinecap;\n\t\tthis.wireframeLinejoin = source.wireframeLinejoin;\n\n\t\tthis.flatShading = source.flatShading;\n\n\t\tthis.fog = source.fog;\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass MeshMatcapMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshMatcapMaterial = true;\n\n\t\tthis.defines = { 'MATCAP': '' };\n\n\t\tthis.type = 'MeshMatcapMaterial';\n\n\t\tthis.color = new Color( 0xffffff ); // diffuse\n\n\t\tthis.matcap = null;\n\n\t\tthis.map = null;\n\n\t\tthis.bumpMap = null;\n\t\tthis.bumpScale = 1;\n\n\t\tthis.normalMap = null;\n\t\tthis.normalMapType = TangentSpaceNormalMap;\n\t\tthis.normalScale = new Vector2( 1, 1 );\n\n\t\tthis.displacementMap = null;\n\t\tthis.displacementScale = 1;\n\t\tthis.displacementBias = 0;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.flatShading = false;\n\n\t\tthis.fog = true;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.defines = { 'MATCAP': '' };\n\n\t\tthis.color.copy( source.color );\n\n\t\tthis.matcap = source.matcap;\n\n\t\tthis.map = source.map;\n\n\t\tthis.bumpMap = source.bumpMap;\n\t\tthis.bumpScale = source.bumpScale;\n\n\t\tthis.normalMap = source.normalMap;\n\t\tthis.normalMapType = source.normalMapType;\n\t\tthis.normalScale.copy( source.normalScale );\n\n\t\tthis.displacementMap = source.displacementMap;\n\t\tthis.displacementScale = source.displacementScale;\n\t\tthis.displacementBias = source.displacementBias;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.flatShading = source.flatShading;\n\n\t\tthis.fog = source.fog;\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass LineDashedMaterial extends LineBasicMaterial {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isLineDashedMaterial = true;\n\n\t\tthis.type = 'LineDashedMaterial';\n\n\t\tthis.scale = 1;\n\t\tthis.dashSize = 3;\n\t\tthis.gapSize = 1;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.scale = source.scale;\n\t\tthis.dashSize = source.dashSize;\n\t\tthis.gapSize = source.gapSize;\n\n\t\treturn this;\n\n\t}\n\n}\n\n// same as Array.prototype.slice, but also works on typed arrays\nfunction arraySlice( array, from, to ) {\n\n\tif ( isTypedArray( array ) ) {\n\n\t\t// in ios9 array.subarray(from, undefined) will return empty array\n\t\t// but array.subarray(from) or array.subarray(from, len) is correct\n\t\treturn new array.constructor( array.subarray( from, to !== undefined ? to : array.length ) );\n\n\t}\n\n\treturn array.slice( from, to );\n\n}\n\n// converts an array to a specific type\nfunction convertArray( array, type, forceClone ) {\n\n\tif ( ! array || // let 'undefined' and 'null' pass\n\t\t! forceClone && array.constructor === type ) return array;\n\n\tif ( typeof type.BYTES_PER_ELEMENT === 'number' ) {\n\n\t\treturn new type( array ); // create typed array\n\n\t}\n\n\treturn Array.prototype.slice.call( array ); // create Array\n\n}\n\nfunction isTypedArray( object ) {\n\n\treturn ArrayBuffer.isView( object ) &&\n\t\t! ( object instanceof DataView );\n\n}\n\n// returns an array by which times and values can be sorted\nfunction getKeyframeOrder( times ) {\n\n\tfunction compareTime( i, j ) {\n\n\t\treturn times[ i ] - times[ j ];\n\n\t}\n\n\tconst n = times.length;\n\tconst result = new Array( n );\n\tfor ( let i = 0; i !== n; ++ i ) result[ i ] = i;\n\n\tresult.sort( compareTime );\n\n\treturn result;\n\n}\n\n// uses the array previously returned by 'getKeyframeOrder' to sort data\nfunction sortedArray( values, stride, order ) {\n\n\tconst nValues = values.length;\n\tconst result = new values.constructor( nValues );\n\n\tfor ( let i = 0, dstOffset = 0; dstOffset !== nValues; ++ i ) {\n\n\t\tconst srcOffset = order[ i ] * stride;\n\n\t\tfor ( let j = 0; j !== stride; ++ j ) {\n\n\t\t\tresult[ dstOffset ++ ] = values[ srcOffset + j ];\n\n\t\t}\n\n\t}\n\n\treturn result;\n\n}\n\n// function for parsing AOS keyframe formats\nfunction flattenJSON( jsonKeys, times, values, valuePropertyName ) {\n\n\tlet i = 1, key = jsonKeys[ 0 ];\n\n\twhile ( key !== undefined && key[ valuePropertyName ] === undefined ) {\n\n\t\tkey = jsonKeys[ i ++ ];\n\n\t}\n\n\tif ( key === undefined ) return; // no data\n\n\tlet value = key[ valuePropertyName ];\n\tif ( value === undefined ) return; // no data\n\n\tif ( Array.isArray( value ) ) {\n\n\t\tdo {\n\n\t\t\tvalue = key[ valuePropertyName ];\n\n\t\t\tif ( value !== undefined ) {\n\n\t\t\t\ttimes.push( key.time );\n\t\t\t\tvalues.push.apply( values, value ); // push all elements\n\n\t\t\t}\n\n\t\t\tkey = jsonKeys[ i ++ ];\n\n\t\t} while ( key !== undefined );\n\n\t} else if ( value.toArray !== undefined ) {\n\n\t\t// ...assume THREE.Math-ish\n\n\t\tdo {\n\n\t\t\tvalue = key[ valuePropertyName ];\n\n\t\t\tif ( value !== undefined ) {\n\n\t\t\t\ttimes.push( key.time );\n\t\t\t\tvalue.toArray( values, values.length );\n\n\t\t\t}\n\n\t\t\tkey = jsonKeys[ i ++ ];\n\n\t\t} while ( key !== undefined );\n\n\t} else {\n\n\t\t// otherwise push as-is\n\n\t\tdo {\n\n\t\t\tvalue = key[ valuePropertyName ];\n\n\t\t\tif ( value !== undefined ) {\n\n\t\t\t\ttimes.push( key.time );\n\t\t\t\tvalues.push( value );\n\n\t\t\t}\n\n\t\t\tkey = jsonKeys[ i ++ ];\n\n\t\t} while ( key !== undefined );\n\n\t}\n\n}\n\nfunction subclip( sourceClip, name, startFrame, endFrame, fps = 30 ) {\n\n\tconst clip = sourceClip.clone();\n\n\tclip.name = name;\n\n\tconst tracks = [];\n\n\tfor ( let i = 0; i < clip.tracks.length; ++ i ) {\n\n\t\tconst track = clip.tracks[ i ];\n\t\tconst valueSize = track.getValueSize();\n\n\t\tconst times = [];\n\t\tconst values = [];\n\n\t\tfor ( let j = 0; j < track.times.length; ++ j ) {\n\n\t\t\tconst frame = track.times[ j ] * fps;\n\n\t\t\tif ( frame < startFrame || frame >= endFrame ) continue;\n\n\t\t\ttimes.push( track.times[ j ] );\n\n\t\t\tfor ( let k = 0; k < valueSize; ++ k ) {\n\n\t\t\t\tvalues.push( track.values[ j * valueSize + k ] );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( times.length === 0 ) continue;\n\n\t\ttrack.times = convertArray( times, track.times.constructor );\n\t\ttrack.values = convertArray( values, track.values.constructor );\n\n\t\ttracks.push( track );\n\n\t}\n\n\tclip.tracks = tracks;\n\n\t// find minimum .times value across all tracks in the trimmed clip\n\n\tlet minStartTime = Infinity;\n\n\tfor ( let i = 0; i < clip.tracks.length; ++ i ) {\n\n\t\tif ( minStartTime > clip.tracks[ i ].times[ 0 ] ) {\n\n\t\t\tminStartTime = clip.tracks[ i ].times[ 0 ];\n\n\t\t}\n\n\t}\n\n\t// shift all tracks such that clip begins at t=0\n\n\tfor ( let i = 0; i < clip.tracks.length; ++ i ) {\n\n\t\tclip.tracks[ i ].shift( - 1 * minStartTime );\n\n\t}\n\n\tclip.resetDuration();\n\n\treturn clip;\n\n}\n\nfunction makeClipAdditive( targetClip, referenceFrame = 0, referenceClip = targetClip, fps = 30 ) {\n\n\tif ( fps <= 0 ) fps = 30;\n\n\tconst numTracks = referenceClip.tracks.length;\n\tconst referenceTime = referenceFrame / fps;\n\n\t// Make each track's values relative to the values at the reference frame\n\tfor ( let i = 0; i < numTracks; ++ i ) {\n\n\t\tconst referenceTrack = referenceClip.tracks[ i ];\n\t\tconst referenceTrackType = referenceTrack.ValueTypeName;\n\n\t\t// Skip this track if it's non-numeric\n\t\tif ( referenceTrackType === 'bool' || referenceTrackType === 'string' ) continue;\n\n\t\t// Find the track in the target clip whose name and type matches the reference track\n\t\tconst targetTrack = targetClip.tracks.find( function ( track ) {\n\n\t\t\treturn track.name === referenceTrack.name\n\t\t\t\t&& track.ValueTypeName === referenceTrackType;\n\n\t\t} );\n\n\t\tif ( targetTrack === undefined ) continue;\n\n\t\tlet referenceOffset = 0;\n\t\tconst referenceValueSize = referenceTrack.getValueSize();\n\n\t\tif ( referenceTrack.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline ) {\n\n\t\t\treferenceOffset = referenceValueSize / 3;\n\n\t\t}\n\n\t\tlet targetOffset = 0;\n\t\tconst targetValueSize = targetTrack.getValueSize();\n\n\t\tif ( targetTrack.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline ) {\n\n\t\t\ttargetOffset = targetValueSize / 3;\n\n\t\t}\n\n\t\tconst lastIndex = referenceTrack.times.length - 1;\n\t\tlet referenceValue;\n\n\t\t// Find the value to subtract out of the track\n\t\tif ( referenceTime <= referenceTrack.times[ 0 ] ) {\n\n\t\t\t// Reference frame is earlier than the first keyframe, so just use the first keyframe\n\t\t\tconst startIndex = referenceOffset;\n\t\t\tconst endIndex = referenceValueSize - referenceOffset;\n\t\t\treferenceValue = arraySlice( referenceTrack.values, startIndex, endIndex );\n\n\t\t} else if ( referenceTime >= referenceTrack.times[ lastIndex ] ) {\n\n\t\t\t// Reference frame is after the last keyframe, so just use the last keyframe\n\t\t\tconst startIndex = lastIndex * referenceValueSize + referenceOffset;\n\t\t\tconst endIndex = startIndex + referenceValueSize - referenceOffset;\n\t\t\treferenceValue = arraySlice( referenceTrack.values, startIndex, endIndex );\n\n\t\t} else {\n\n\t\t\t// Interpolate to the reference value\n\t\t\tconst interpolant = referenceTrack.createInterpolant();\n\t\t\tconst startIndex = referenceOffset;\n\t\t\tconst endIndex = referenceValueSize - referenceOffset;\n\t\t\tinterpolant.evaluate( referenceTime );\n\t\t\treferenceValue = arraySlice( interpolant.resultBuffer, startIndex, endIndex );\n\n\t\t}\n\n\t\t// Conjugate the quaternion\n\t\tif ( referenceTrackType === 'quaternion' ) {\n\n\t\t\tconst referenceQuat = new Quaternion().fromArray( referenceValue ).normalize().conjugate();\n\t\t\treferenceQuat.toArray( referenceValue );\n\n\t\t}\n\n\t\t// Subtract the reference value from all of the track values\n\n\t\tconst numTimes = targetTrack.times.length;\n\t\tfor ( let j = 0; j < numTimes; ++ j ) {\n\n\t\t\tconst valueStart = j * targetValueSize + targetOffset;\n\n\t\t\tif ( referenceTrackType === 'quaternion' ) {\n\n\t\t\t\t// Multiply the conjugate for quaternion track types\n\t\t\t\tQuaternion.multiplyQuaternionsFlat(\n\t\t\t\t\ttargetTrack.values,\n\t\t\t\t\tvalueStart,\n\t\t\t\t\treferenceValue,\n\t\t\t\t\t0,\n\t\t\t\t\ttargetTrack.values,\n\t\t\t\t\tvalueStart\n\t\t\t\t);\n\n\t\t\t} else {\n\n\t\t\t\tconst valueEnd = targetValueSize - targetOffset * 2;\n\n\t\t\t\t// Subtract each value for all other numeric track types\n\t\t\t\tfor ( let k = 0; k < valueEnd; ++ k ) {\n\n\t\t\t\t\ttargetTrack.values[ valueStart + k ] -= referenceValue[ k ];\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\ttargetClip.blendMode = AdditiveAnimationBlendMode;\n\n\treturn targetClip;\n\n}\n\nvar AnimationUtils = /*#__PURE__*/Object.freeze({\n\t__proto__: null,\n\tarraySlice: arraySlice,\n\tconvertArray: convertArray,\n\tisTypedArray: isTypedArray,\n\tgetKeyframeOrder: getKeyframeOrder,\n\tsortedArray: sortedArray,\n\tflattenJSON: flattenJSON,\n\tsubclip: subclip,\n\tmakeClipAdditive: makeClipAdditive\n});\n\n/**\n * Abstract base class of interpolants over parametric samples.\n *\n * The parameter domain is one dimensional, typically the time or a path\n * along a curve defined by the data.\n *\n * The sample values can have any dimensionality and derived classes may\n * apply special interpretations to the data.\n *\n * This class provides the interval seek in a Template Method, deferring\n * the actual interpolation to derived classes.\n *\n * Time complexity is O(1) for linear access crossing at most two points\n * and O(log N) for random access, where N is the number of positions.\n *\n * References:\n *\n * \t\thttp://www.oodesign.com/template-method-pattern.html\n *\n */\n\nclass Interpolant {\n\n\tconstructor( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tthis.parameterPositions = parameterPositions;\n\t\tthis._cachedIndex = 0;\n\n\t\tthis.resultBuffer = resultBuffer !== undefined ?\n\t\t\tresultBuffer : new sampleValues.constructor( sampleSize );\n\t\tthis.sampleValues = sampleValues;\n\t\tthis.valueSize = sampleSize;\n\n\t\tthis.settings = null;\n\t\tthis.DefaultSettings_ = {};\n\n\t}\n\n\tevaluate( t ) {\n\n\t\tconst pp = this.parameterPositions;\n\t\tlet i1 = this._cachedIndex,\n\t\t\tt1 = pp[ i1 ],\n\t\t\tt0 = pp[ i1 - 1 ];\n\n\t\tvalidate_interval: {\n\n\t\t\tseek: {\n\n\t\t\t\tlet right;\n\n\t\t\t\tlinear_scan: {\n\n\t\t\t\t\t//- See http://jsperf.com/comparison-to-undefined/3\n\t\t\t\t\t//- slower code:\n\t\t\t\t\t//-\n\t\t\t\t\t//- \t\t\t\tif ( t >= t1 || t1 === undefined ) {\n\t\t\t\t\tforward_scan: if ( ! ( t < t1 ) ) {\n\n\t\t\t\t\t\tfor ( let giveUpAt = i1 + 2; ; ) {\n\n\t\t\t\t\t\t\tif ( t1 === undefined ) {\n\n\t\t\t\t\t\t\t\tif ( t < t0 ) break forward_scan;\n\n\t\t\t\t\t\t\t\t// after end\n\n\t\t\t\t\t\t\t\ti1 = pp.length;\n\t\t\t\t\t\t\t\tthis._cachedIndex = i1;\n\t\t\t\t\t\t\t\treturn this.copySampleValue_( i1 - 1 );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif ( i1 === giveUpAt ) break; // this loop\n\n\t\t\t\t\t\t\tt0 = t1;\n\t\t\t\t\t\t\tt1 = pp[ ++ i1 ];\n\n\t\t\t\t\t\t\tif ( t < t1 ) {\n\n\t\t\t\t\t\t\t\t// we have arrived at the sought interval\n\t\t\t\t\t\t\t\tbreak seek;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// prepare binary search on the right side of the index\n\t\t\t\t\t\tright = pp.length;\n\t\t\t\t\t\tbreak linear_scan;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t//- slower code:\n\t\t\t\t\t//-\t\t\t\t\tif ( t < t0 || t0 === undefined ) {\n\t\t\t\t\tif ( ! ( t >= t0 ) ) {\n\n\t\t\t\t\t\t// looping?\n\n\t\t\t\t\t\tconst t1global = pp[ 1 ];\n\n\t\t\t\t\t\tif ( t < t1global ) {\n\n\t\t\t\t\t\t\ti1 = 2; // + 1, using the scan for the details\n\t\t\t\t\t\t\tt0 = t1global;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// linear reverse scan\n\n\t\t\t\t\t\tfor ( let giveUpAt = i1 - 2; ; ) {\n\n\t\t\t\t\t\t\tif ( t0 === undefined ) {\n\n\t\t\t\t\t\t\t\t// before start\n\n\t\t\t\t\t\t\t\tthis._cachedIndex = 0;\n\t\t\t\t\t\t\t\treturn this.copySampleValue_( 0 );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif ( i1 === giveUpAt ) break; // this loop\n\n\t\t\t\t\t\t\tt1 = t0;\n\t\t\t\t\t\t\tt0 = pp[ -- i1 - 1 ];\n\n\t\t\t\t\t\t\tif ( t >= t0 ) {\n\n\t\t\t\t\t\t\t\t// we have arrived at the sought interval\n\t\t\t\t\t\t\t\tbreak seek;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// prepare binary search on the left side of the index\n\t\t\t\t\t\tright = i1;\n\t\t\t\t\t\ti1 = 0;\n\t\t\t\t\t\tbreak linear_scan;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// the interval is valid\n\n\t\t\t\t\tbreak validate_interval;\n\n\t\t\t\t} // linear scan\n\n\t\t\t\t// binary search\n\n\t\t\t\twhile ( i1 < right ) {\n\n\t\t\t\t\tconst mid = ( i1 + right ) >>> 1;\n\n\t\t\t\t\tif ( t < pp[ mid ] ) {\n\n\t\t\t\t\t\tright = mid;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\ti1 = mid + 1;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tt1 = pp[ i1 ];\n\t\t\t\tt0 = pp[ i1 - 1 ];\n\n\t\t\t\t// check boundary cases, again\n\n\t\t\t\tif ( t0 === undefined ) {\n\n\t\t\t\t\tthis._cachedIndex = 0;\n\t\t\t\t\treturn this.copySampleValue_( 0 );\n\n\t\t\t\t}\n\n\t\t\t\tif ( t1 === undefined ) {\n\n\t\t\t\t\ti1 = pp.length;\n\t\t\t\t\tthis._cachedIndex = i1;\n\t\t\t\t\treturn this.copySampleValue_( i1 - 1 );\n\n\t\t\t\t}\n\n\t\t\t} // seek\n\n\t\t\tthis._cachedIndex = i1;\n\n\t\t\tthis.intervalChanged_( i1, t0, t1 );\n\n\t\t} // validate_interval\n\n\t\treturn this.interpolate_( i1, t0, t, t1 );\n\n\t}\n\n\tgetSettings_() {\n\n\t\treturn this.settings || this.DefaultSettings_;\n\n\t}\n\n\tcopySampleValue_( index ) {\n\n\t\t// copies a sample value to the result buffer\n\n\t\tconst result = this.resultBuffer,\n\t\t\tvalues = this.sampleValues,\n\t\t\tstride = this.valueSize,\n\t\t\toffset = index * stride;\n\n\t\tfor ( let i = 0; i !== stride; ++ i ) {\n\n\t\t\tresult[ i ] = values[ offset + i ];\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n\t// Template methods for derived classes:\n\n\tinterpolate_( /* i1, t0, t, t1 */ ) {\n\n\t\tthrow new Error( 'call to abstract method' );\n\t\t// implementations shall return this.resultBuffer\n\n\t}\n\n\tintervalChanged_( /* i1, t0, t1 */ ) {\n\n\t\t// empty\n\n\t}\n\n}\n\n/**\n * Fast and simple cubic spline interpolant.\n *\n * It was derived from a Hermitian construction setting the first derivative\n * at each sample position to the linear slope between neighboring positions\n * over their parameter interval.\n */\n\nclass CubicInterpolant extends Interpolant {\n\n\tconstructor( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tsuper( parameterPositions, sampleValues, sampleSize, resultBuffer );\n\n\t\tthis._weightPrev = - 0;\n\t\tthis._offsetPrev = - 0;\n\t\tthis._weightNext = - 0;\n\t\tthis._offsetNext = - 0;\n\n\t\tthis.DefaultSettings_ = {\n\n\t\t\tendingStart: ZeroCurvatureEnding,\n\t\t\tendingEnd: ZeroCurvatureEnding\n\n\t\t};\n\n\t}\n\n\tintervalChanged_( i1, t0, t1 ) {\n\n\t\tconst pp = this.parameterPositions;\n\t\tlet iPrev = i1 - 2,\n\t\t\tiNext = i1 + 1,\n\n\t\t\ttPrev = pp[ iPrev ],\n\t\t\ttNext = pp[ iNext ];\n\n\t\tif ( tPrev === undefined ) {\n\n\t\t\tswitch ( this.getSettings_().endingStart ) {\n\n\t\t\t\tcase ZeroSlopeEnding:\n\n\t\t\t\t\t// f'(t0) = 0\n\t\t\t\t\tiPrev = i1;\n\t\t\t\t\ttPrev = 2 * t0 - t1;\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase WrapAroundEnding:\n\n\t\t\t\t\t// use the other end of the curve\n\t\t\t\t\tiPrev = pp.length - 2;\n\t\t\t\t\ttPrev = t0 + pp[ iPrev ] - pp[ iPrev + 1 ];\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault: // ZeroCurvatureEnding\n\n\t\t\t\t\t// f''(t0) = 0 a.k.a. Natural Spline\n\t\t\t\t\tiPrev = i1;\n\t\t\t\t\ttPrev = t1;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( tNext === undefined ) {\n\n\t\t\tswitch ( this.getSettings_().endingEnd ) {\n\n\t\t\t\tcase ZeroSlopeEnding:\n\n\t\t\t\t\t// f'(tN) = 0\n\t\t\t\t\tiNext = i1;\n\t\t\t\t\ttNext = 2 * t1 - t0;\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase WrapAroundEnding:\n\n\t\t\t\t\t// use the other end of the curve\n\t\t\t\t\tiNext = 1;\n\t\t\t\t\ttNext = t1 + pp[ 1 ] - pp[ 0 ];\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault: // ZeroCurvatureEnding\n\n\t\t\t\t\t// f''(tN) = 0, a.k.a. Natural Spline\n\t\t\t\t\tiNext = i1 - 1;\n\t\t\t\t\ttNext = t0;\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst halfDt = ( t1 - t0 ) * 0.5,\n\t\t\tstride = this.valueSize;\n\n\t\tthis._weightPrev = halfDt / ( t0 - tPrev );\n\t\tthis._weightNext = halfDt / ( tNext - t1 );\n\t\tthis._offsetPrev = iPrev * stride;\n\t\tthis._offsetNext = iNext * stride;\n\n\t}\n\n\tinterpolate_( i1, t0, t, t1 ) {\n\n\t\tconst result = this.resultBuffer,\n\t\t\tvalues = this.sampleValues,\n\t\t\tstride = this.valueSize,\n\n\t\t\to1 = i1 * stride,\t\to0 = o1 - stride,\n\t\t\toP = this._offsetPrev, \toN = this._offsetNext,\n\t\t\twP = this._weightPrev,\twN = this._weightNext,\n\n\t\t\tp = ( t - t0 ) / ( t1 - t0 ),\n\t\t\tpp = p * p,\n\t\t\tppp = pp * p;\n\n\t\t// evaluate polynomials\n\n\t\tconst sP = - wP * ppp + 2 * wP * pp - wP * p;\n\t\tconst s0 = ( 1 + wP ) * ppp + ( - 1.5 - 2 * wP ) * pp + ( - 0.5 + wP ) * p + 1;\n\t\tconst s1 = ( - 1 - wN ) * ppp + ( 1.5 + wN ) * pp + 0.5 * p;\n\t\tconst sN = wN * ppp - wN * pp;\n\n\t\t// combine data linearly\n\n\t\tfor ( let i = 0; i !== stride; ++ i ) {\n\n\t\t\tresult[ i ] =\n\t\t\t\t\tsP * values[ oP + i ] +\n\t\t\t\t\ts0 * values[ o0 + i ] +\n\t\t\t\t\ts1 * values[ o1 + i ] +\n\t\t\t\t\tsN * values[ oN + i ];\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n}\n\nclass LinearInterpolant extends Interpolant {\n\n\tconstructor( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tsuper( parameterPositions, sampleValues, sampleSize, resultBuffer );\n\n\t}\n\n\tinterpolate_( i1, t0, t, t1 ) {\n\n\t\tconst result = this.resultBuffer,\n\t\t\tvalues = this.sampleValues,\n\t\t\tstride = this.valueSize,\n\n\t\t\toffset1 = i1 * stride,\n\t\t\toffset0 = offset1 - stride,\n\n\t\t\tweight1 = ( t - t0 ) / ( t1 - t0 ),\n\t\t\tweight0 = 1 - weight1;\n\n\t\tfor ( let i = 0; i !== stride; ++ i ) {\n\n\t\t\tresult[ i ] =\n\t\t\t\t\tvalues[ offset0 + i ] * weight0 +\n\t\t\t\t\tvalues[ offset1 + i ] * weight1;\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n}\n\n/**\n *\n * Interpolant that evaluates to the sample value at the position preceding\n * the parameter.\n */\n\nclass DiscreteInterpolant extends Interpolant {\n\n\tconstructor( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tsuper( parameterPositions, sampleValues, sampleSize, resultBuffer );\n\n\t}\n\n\tinterpolate_( i1 /*, t0, t, t1 */ ) {\n\n\t\treturn this.copySampleValue_( i1 - 1 );\n\n\t}\n\n}\n\nclass KeyframeTrack {\n\n\tconstructor( name, times, values, interpolation ) {\n\n\t\tif ( name === undefined ) throw new Error( 'THREE.KeyframeTrack: track name is undefined' );\n\t\tif ( times === undefined || times.length === 0 ) throw new Error( 'THREE.KeyframeTrack: no keyframes in track named ' + name );\n\n\t\tthis.name = name;\n\n\t\tthis.times = convertArray( times, this.TimeBufferType );\n\t\tthis.values = convertArray( values, this.ValueBufferType );\n\n\t\tthis.setInterpolation( interpolation || this.DefaultInterpolation );\n\n\t}\n\n\t// Serialization (in static context, because of constructor invocation\n\t// and automatic invocation of .toJSON):\n\n\tstatic toJSON( track ) {\n\n\t\tconst trackType = track.constructor;\n\n\t\tlet json;\n\n\t\t// derived classes can define a static toJSON method\n\t\tif ( trackType.toJSON !== this.toJSON ) {\n\n\t\t\tjson = trackType.toJSON( track );\n\n\t\t} else {\n\n\t\t\t// by default, we assume the data can be serialized as-is\n\t\t\tjson = {\n\n\t\t\t\t'name': track.name,\n\t\t\t\t'times': convertArray( track.times, Array ),\n\t\t\t\t'values': convertArray( track.values, Array )\n\n\t\t\t};\n\n\t\t\tconst interpolation = track.getInterpolation();\n\n\t\t\tif ( interpolation !== track.DefaultInterpolation ) {\n\n\t\t\t\tjson.interpolation = interpolation;\n\n\t\t\t}\n\n\t\t}\n\n\t\tjson.type = track.ValueTypeName; // mandatory\n\n\t\treturn json;\n\n\t}\n\n\tInterpolantFactoryMethodDiscrete( result ) {\n\n\t\treturn new DiscreteInterpolant( this.times, this.values, this.getValueSize(), result );\n\n\t}\n\n\tInterpolantFactoryMethodLinear( result ) {\n\n\t\treturn new LinearInterpolant( this.times, this.values, this.getValueSize(), result );\n\n\t}\n\n\tInterpolantFactoryMethodSmooth( result ) {\n\n\t\treturn new CubicInterpolant( this.times, this.values, this.getValueSize(), result );\n\n\t}\n\n\tsetInterpolation( interpolation ) {\n\n\t\tlet factoryMethod;\n\n\t\tswitch ( interpolation ) {\n\n\t\t\tcase InterpolateDiscrete:\n\n\t\t\t\tfactoryMethod = this.InterpolantFactoryMethodDiscrete;\n\n\t\t\t\tbreak;\n\n\t\t\tcase InterpolateLinear:\n\n\t\t\t\tfactoryMethod = this.InterpolantFactoryMethodLinear;\n\n\t\t\t\tbreak;\n\n\t\t\tcase InterpolateSmooth:\n\n\t\t\t\tfactoryMethod = this.InterpolantFactoryMethodSmooth;\n\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\tif ( factoryMethod === undefined ) {\n\n\t\t\tconst message = 'unsupported interpolation for ' +\n\t\t\t\tthis.ValueTypeName + ' keyframe track named ' + this.name;\n\n\t\t\tif ( this.createInterpolant === undefined ) {\n\n\t\t\t\t// fall back to default, unless the default itself is messed up\n\t\t\t\tif ( interpolation !== this.DefaultInterpolation ) {\n\n\t\t\t\t\tthis.setInterpolation( this.DefaultInterpolation );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthrow new Error( message ); // fatal, in this case\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tconsole.warn( 'THREE.KeyframeTrack:', message );\n\t\t\treturn this;\n\n\t\t}\n\n\t\tthis.createInterpolant = factoryMethod;\n\n\t\treturn this;\n\n\t}\n\n\tgetInterpolation() {\n\n\t\tswitch ( this.createInterpolant ) {\n\n\t\t\tcase this.InterpolantFactoryMethodDiscrete:\n\n\t\t\t\treturn InterpolateDiscrete;\n\n\t\t\tcase this.InterpolantFactoryMethodLinear:\n\n\t\t\t\treturn InterpolateLinear;\n\n\t\t\tcase this.InterpolantFactoryMethodSmooth:\n\n\t\t\t\treturn InterpolateSmooth;\n\n\t\t}\n\n\t}\n\n\tgetValueSize() {\n\n\t\treturn this.values.length / this.times.length;\n\n\t}\n\n\t// move all keyframes either forwards or backwards in time\n\tshift( timeOffset ) {\n\n\t\tif ( timeOffset !== 0.0 ) {\n\n\t\t\tconst times = this.times;\n\n\t\t\tfor ( let i = 0, n = times.length; i !== n; ++ i ) {\n\n\t\t\t\ttimes[ i ] += timeOffset;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t// scale all keyframe times by a factor (useful for frame <-> seconds conversions)\n\tscale( timeScale ) {\n\n\t\tif ( timeScale !== 1.0 ) {\n\n\t\t\tconst times = this.times;\n\n\t\t\tfor ( let i = 0, n = times.length; i !== n; ++ i ) {\n\n\t\t\t\ttimes[ i ] *= timeScale;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t// removes keyframes before and after animation without changing any values within the range [startTime, endTime].\n\t// IMPORTANT: We do not shift around keys to the start of the track time, because for interpolated keys this will change their values\n\ttrim( startTime, endTime ) {\n\n\t\tconst times = this.times,\n\t\t\tnKeys = times.length;\n\n\t\tlet from = 0,\n\t\t\tto = nKeys - 1;\n\n\t\twhile ( from !== nKeys && times[ from ] < startTime ) {\n\n\t\t\t++ from;\n\n\t\t}\n\n\t\twhile ( to !== - 1 && times[ to ] > endTime ) {\n\n\t\t\t-- to;\n\n\t\t}\n\n\t\t++ to; // inclusive -> exclusive bound\n\n\t\tif ( from !== 0 || to !== nKeys ) {\n\n\t\t\t// empty tracks are forbidden, so keep at least one keyframe\n\t\t\tif ( from >= to ) {\n\n\t\t\t\tto = Math.max( to, 1 );\n\t\t\t\tfrom = to - 1;\n\n\t\t\t}\n\n\t\t\tconst stride = this.getValueSize();\n\t\t\tthis.times = arraySlice( times, from, to );\n\t\t\tthis.values = arraySlice( this.values, from * stride, to * stride );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t// ensure we do not get a GarbageInGarbageOut situation, make sure tracks are at least minimally viable\n\tvalidate() {\n\n\t\tlet valid = true;\n\n\t\tconst valueSize = this.getValueSize();\n\t\tif ( valueSize - Math.floor( valueSize ) !== 0 ) {\n\n\t\t\tconsole.error( 'THREE.KeyframeTrack: Invalid value size in track.', this );\n\t\t\tvalid = false;\n\n\t\t}\n\n\t\tconst times = this.times,\n\t\t\tvalues = this.values,\n\n\t\t\tnKeys = times.length;\n\n\t\tif ( nKeys === 0 ) {\n\n\t\t\tconsole.error( 'THREE.KeyframeTrack: Track is empty.', this );\n\t\t\tvalid = false;\n\n\t\t}\n\n\t\tlet prevTime = null;\n\n\t\tfor ( let i = 0; i !== nKeys; i ++ ) {\n\n\t\t\tconst currTime = times[ i ];\n\n\t\t\tif ( typeof currTime === 'number' && isNaN( currTime ) ) {\n\n\t\t\t\tconsole.error( 'THREE.KeyframeTrack: Time is not a valid number.', this, i, currTime );\n\t\t\t\tvalid = false;\n\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tif ( prevTime !== null && prevTime > currTime ) {\n\n\t\t\t\tconsole.error( 'THREE.KeyframeTrack: Out of order keys.', this, i, currTime, prevTime );\n\t\t\t\tvalid = false;\n\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tprevTime = currTime;\n\n\t\t}\n\n\t\tif ( values !== undefined ) {\n\n\t\t\tif ( isTypedArray( values ) ) {\n\n\t\t\t\tfor ( let i = 0, n = values.length; i !== n; ++ i ) {\n\n\t\t\t\t\tconst value = values[ i ];\n\n\t\t\t\t\tif ( isNaN( value ) ) {\n\n\t\t\t\t\t\tconsole.error( 'THREE.KeyframeTrack: Value is not a valid number.', this, i, value );\n\t\t\t\t\t\tvalid = false;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn valid;\n\n\t}\n\n\t// removes equivalent sequential keys as common in morph target sequences\n\t// (0,0,0,0,1,1,1,0,0,0,0,0,0,0) --> (0,0,1,1,0,0)\n\toptimize() {\n\n\t\t// times or values may be shared with other tracks, so overwriting is unsafe\n\t\tconst times = arraySlice( this.times ),\n\t\t\tvalues = arraySlice( this.values ),\n\t\t\tstride = this.getValueSize(),\n\n\t\t\tsmoothInterpolation = this.getInterpolation() === InterpolateSmooth,\n\n\t\t\tlastIndex = times.length - 1;\n\n\t\tlet writeIndex = 1;\n\n\t\tfor ( let i = 1; i < lastIndex; ++ i ) {\n\n\t\t\tlet keep = false;\n\n\t\t\tconst time = times[ i ];\n\t\t\tconst timeNext = times[ i + 1 ];\n\n\t\t\t// remove adjacent keyframes scheduled at the same time\n\n\t\t\tif ( time !== timeNext && ( i !== 1 || time !== times[ 0 ] ) ) {\n\n\t\t\t\tif ( ! smoothInterpolation ) {\n\n\t\t\t\t\t// remove unnecessary keyframes same as their neighbors\n\n\t\t\t\t\tconst offset = i * stride,\n\t\t\t\t\t\toffsetP = offset - stride,\n\t\t\t\t\t\toffsetN = offset + stride;\n\n\t\t\t\t\tfor ( let j = 0; j !== stride; ++ j ) {\n\n\t\t\t\t\t\tconst value = values[ offset + j ];\n\n\t\t\t\t\t\tif ( value !== values[ offsetP + j ] ||\n\t\t\t\t\t\t\tvalue !== values[ offsetN + j ] ) {\n\n\t\t\t\t\t\t\tkeep = true;\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tkeep = true;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// in-place compaction\n\n\t\t\tif ( keep ) {\n\n\t\t\t\tif ( i !== writeIndex ) {\n\n\t\t\t\t\ttimes[ writeIndex ] = times[ i ];\n\n\t\t\t\t\tconst readOffset = i * stride,\n\t\t\t\t\t\twriteOffset = writeIndex * stride;\n\n\t\t\t\t\tfor ( let j = 0; j !== stride; ++ j ) {\n\n\t\t\t\t\t\tvalues[ writeOffset + j ] = values[ readOffset + j ];\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t++ writeIndex;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// flush last keyframe (compaction looks ahead)\n\n\t\tif ( lastIndex > 0 ) {\n\n\t\t\ttimes[ writeIndex ] = times[ lastIndex ];\n\n\t\t\tfor ( let readOffset = lastIndex * stride, writeOffset = writeIndex * stride, j = 0; j !== stride; ++ j ) {\n\n\t\t\t\tvalues[ writeOffset + j ] = values[ readOffset + j ];\n\n\t\t\t}\n\n\t\t\t++ writeIndex;\n\n\t\t}\n\n\t\tif ( writeIndex !== times.length ) {\n\n\t\t\tthis.times = arraySlice( times, 0, writeIndex );\n\t\t\tthis.values = arraySlice( values, 0, writeIndex * stride );\n\n\t\t} else {\n\n\t\t\tthis.times = times;\n\t\t\tthis.values = values;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\tconst times = arraySlice( this.times, 0 );\n\t\tconst values = arraySlice( this.values, 0 );\n\n\t\tconst TypedKeyframeTrack = this.constructor;\n\t\tconst track = new TypedKeyframeTrack( this.name, times, values );\n\n\t\t// Interpolant argument to constructor is not saved, so copy the factory method directly.\n\t\ttrack.createInterpolant = this.createInterpolant;\n\n\t\treturn track;\n\n\t}\n\n}\n\nKeyframeTrack.prototype.TimeBufferType = Float32Array;\nKeyframeTrack.prototype.ValueBufferType = Float32Array;\nKeyframeTrack.prototype.DefaultInterpolation = InterpolateLinear;\n\n/**\n * A Track of Boolean keyframe values.\n */\nclass BooleanKeyframeTrack extends KeyframeTrack {}\n\nBooleanKeyframeTrack.prototype.ValueTypeName = 'bool';\nBooleanKeyframeTrack.prototype.ValueBufferType = Array;\nBooleanKeyframeTrack.prototype.DefaultInterpolation = InterpolateDiscrete;\nBooleanKeyframeTrack.prototype.InterpolantFactoryMethodLinear = undefined;\nBooleanKeyframeTrack.prototype.InterpolantFactoryMethodSmooth = undefined;\n\n/**\n * A Track of keyframe values that represent color.\n */\nclass ColorKeyframeTrack extends KeyframeTrack {}\n\nColorKeyframeTrack.prototype.ValueTypeName = 'color';\n\n/**\n * A Track of numeric keyframe values.\n */\nclass NumberKeyframeTrack extends KeyframeTrack {}\n\nNumberKeyframeTrack.prototype.ValueTypeName = 'number';\n\n/**\n * Spherical linear unit quaternion interpolant.\n */\n\nclass QuaternionLinearInterpolant extends Interpolant {\n\n\tconstructor( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tsuper( parameterPositions, sampleValues, sampleSize, resultBuffer );\n\n\t}\n\n\tinterpolate_( i1, t0, t, t1 ) {\n\n\t\tconst result = this.resultBuffer,\n\t\t\tvalues = this.sampleValues,\n\t\t\tstride = this.valueSize,\n\n\t\t\talpha = ( t - t0 ) / ( t1 - t0 );\n\n\t\tlet offset = i1 * stride;\n\n\t\tfor ( let end = offset + stride; offset !== end; offset += 4 ) {\n\n\t\t\tQuaternion.slerpFlat( result, 0, values, offset - stride, values, offset, alpha );\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n}\n\n/**\n * A Track of quaternion keyframe values.\n */\nclass QuaternionKeyframeTrack extends KeyframeTrack {\n\n\tInterpolantFactoryMethodLinear( result ) {\n\n\t\treturn new QuaternionLinearInterpolant( this.times, this.values, this.getValueSize(), result );\n\n\t}\n\n}\n\nQuaternionKeyframeTrack.prototype.ValueTypeName = 'quaternion';\n// ValueBufferType is inherited\nQuaternionKeyframeTrack.prototype.DefaultInterpolation = InterpolateLinear;\nQuaternionKeyframeTrack.prototype.InterpolantFactoryMethodSmooth = undefined;\n\n/**\n * A Track that interpolates Strings\n */\nclass StringKeyframeTrack extends KeyframeTrack {}\n\nStringKeyframeTrack.prototype.ValueTypeName = 'string';\nStringKeyframeTrack.prototype.ValueBufferType = Array;\nStringKeyframeTrack.prototype.DefaultInterpolation = InterpolateDiscrete;\nStringKeyframeTrack.prototype.InterpolantFactoryMethodLinear = undefined;\nStringKeyframeTrack.prototype.InterpolantFactoryMethodSmooth = undefined;\n\n/**\n * A Track of vectored keyframe values.\n */\nclass VectorKeyframeTrack extends KeyframeTrack {}\n\nVectorKeyframeTrack.prototype.ValueTypeName = 'vector';\n\nclass AnimationClip {\n\n\tconstructor( name, duration = - 1, tracks, blendMode = NormalAnimationBlendMode ) {\n\n\t\tthis.name = name;\n\t\tthis.tracks = tracks;\n\t\tthis.duration = duration;\n\t\tthis.blendMode = blendMode;\n\n\t\tthis.uuid = generateUUID();\n\n\t\t// this means it should figure out its duration by scanning the tracks\n\t\tif ( this.duration < 0 ) {\n\n\t\t\tthis.resetDuration();\n\n\t\t}\n\n\t}\n\n\n\tstatic parse( json ) {\n\n\t\tconst tracks = [],\n\t\t\tjsonTracks = json.tracks,\n\t\t\tframeTime = 1.0 / ( json.fps || 1.0 );\n\n\t\tfor ( let i = 0, n = jsonTracks.length; i !== n; ++ i ) {\n\n\t\t\ttracks.push( parseKeyframeTrack( jsonTracks[ i ] ).scale( frameTime ) );\n\n\t\t}\n\n\t\tconst clip = new this( json.name, json.duration, tracks, json.blendMode );\n\t\tclip.uuid = json.uuid;\n\n\t\treturn clip;\n\n\t}\n\n\tstatic toJSON( clip ) {\n\n\t\tconst tracks = [],\n\t\t\tclipTracks = clip.tracks;\n\n\t\tconst json = {\n\n\t\t\t'name': clip.name,\n\t\t\t'duration': clip.duration,\n\t\t\t'tracks': tracks,\n\t\t\t'uuid': clip.uuid,\n\t\t\t'blendMode': clip.blendMode\n\n\t\t};\n\n\t\tfor ( let i = 0, n = clipTracks.length; i !== n; ++ i ) {\n\n\t\t\ttracks.push( KeyframeTrack.toJSON( clipTracks[ i ] ) );\n\n\t\t}\n\n\t\treturn json;\n\n\t}\n\n\tstatic CreateFromMorphTargetSequence( name, morphTargetSequence, fps, noLoop ) {\n\n\t\tconst numMorphTargets = morphTargetSequence.length;\n\t\tconst tracks = [];\n\n\t\tfor ( let i = 0; i < numMorphTargets; i ++ ) {\n\n\t\t\tlet times = [];\n\t\t\tlet values = [];\n\n\t\t\ttimes.push(\n\t\t\t\t( i + numMorphTargets - 1 ) % numMorphTargets,\n\t\t\t\ti,\n\t\t\t\t( i + 1 ) % numMorphTargets );\n\n\t\t\tvalues.push( 0, 1, 0 );\n\n\t\t\tconst order = getKeyframeOrder( times );\n\t\t\ttimes = sortedArray( times, 1, order );\n\t\t\tvalues = sortedArray( values, 1, order );\n\n\t\t\t// if there is a key at the first frame, duplicate it as the\n\t\t\t// last frame as well for perfect loop.\n\t\t\tif ( ! noLoop && times[ 0 ] === 0 ) {\n\n\t\t\t\ttimes.push( numMorphTargets );\n\t\t\t\tvalues.push( values[ 0 ] );\n\n\t\t\t}\n\n\t\t\ttracks.push(\n\t\t\t\tnew NumberKeyframeTrack(\n\t\t\t\t\t'.morphTargetInfluences[' + morphTargetSequence[ i ].name + ']',\n\t\t\t\t\ttimes, values\n\t\t\t\t).scale( 1.0 / fps ) );\n\n\t\t}\n\n\t\treturn new this( name, - 1, tracks );\n\n\t}\n\n\tstatic findByName( objectOrClipArray, name ) {\n\n\t\tlet clipArray = objectOrClipArray;\n\n\t\tif ( ! Array.isArray( objectOrClipArray ) ) {\n\n\t\t\tconst o = objectOrClipArray;\n\t\t\tclipArray = o.geometry && o.geometry.animations || o.animations;\n\n\t\t}\n\n\t\tfor ( let i = 0; i < clipArray.length; i ++ ) {\n\n\t\t\tif ( clipArray[ i ].name === name ) {\n\n\t\t\t\treturn clipArray[ i ];\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn null;\n\n\t}\n\n\tstatic CreateClipsFromMorphTargetSequences( morphTargets, fps, noLoop ) {\n\n\t\tconst animationToMorphTargets = {};\n\n\t\t// tested with https://regex101.com/ on trick sequences\n\t\t// such flamingo_flyA_003, flamingo_run1_003, crdeath0059\n\t\tconst pattern = /^([\\w-]*?)([\\d]+)$/;\n\n\t\t// sort morph target names into animation groups based\n\t\t// patterns like Walk_001, Walk_002, Run_001, Run_002\n\t\tfor ( let i = 0, il = morphTargets.length; i < il; i ++ ) {\n\n\t\t\tconst morphTarget = morphTargets[ i ];\n\t\t\tconst parts = morphTarget.name.match( pattern );\n\n\t\t\tif ( parts && parts.length > 1 ) {\n\n\t\t\t\tconst name = parts[ 1 ];\n\n\t\t\t\tlet animationMorphTargets = animationToMorphTargets[ name ];\n\n\t\t\t\tif ( ! animationMorphTargets ) {\n\n\t\t\t\t\tanimationToMorphTargets[ name ] = animationMorphTargets = [];\n\n\t\t\t\t}\n\n\t\t\t\tanimationMorphTargets.push( morphTarget );\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst clips = [];\n\n\t\tfor ( const name in animationToMorphTargets ) {\n\n\t\t\tclips.push( this.CreateFromMorphTargetSequence( name, animationToMorphTargets[ name ], fps, noLoop ) );\n\n\t\t}\n\n\t\treturn clips;\n\n\t}\n\n\t// parse the animation.hierarchy format\n\tstatic parseAnimation( animation, bones ) {\n\n\t\tif ( ! animation ) {\n\n\t\t\tconsole.error( 'THREE.AnimationClip: No animation in JSONLoader data.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst addNonemptyTrack = function ( trackType, trackName, animationKeys, propertyName, destTracks ) {\n\n\t\t\t// only return track if there are actually keys.\n\t\t\tif ( animationKeys.length !== 0 ) {\n\n\t\t\t\tconst times = [];\n\t\t\t\tconst values = [];\n\n\t\t\t\tflattenJSON( animationKeys, times, values, propertyName );\n\n\t\t\t\t// empty keys are filtered out, so check again\n\t\t\t\tif ( times.length !== 0 ) {\n\n\t\t\t\t\tdestTracks.push( new trackType( trackName, times, values ) );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t};\n\n\t\tconst tracks = [];\n\n\t\tconst clipName = animation.name || 'default';\n\t\tconst fps = animation.fps || 30;\n\t\tconst blendMode = animation.blendMode;\n\n\t\t// automatic length determination in AnimationClip.\n\t\tlet duration = animation.length || - 1;\n\n\t\tconst hierarchyTracks = animation.hierarchy || [];\n\n\t\tfor ( let h = 0; h < hierarchyTracks.length; h ++ ) {\n\n\t\t\tconst animationKeys = hierarchyTracks[ h ].keys;\n\n\t\t\t// skip empty tracks\n\t\t\tif ( ! animationKeys || animationKeys.length === 0 ) continue;\n\n\t\t\t// process morph targets\n\t\t\tif ( animationKeys[ 0 ].morphTargets ) {\n\n\t\t\t\t// figure out all morph targets used in this track\n\t\t\t\tconst morphTargetNames = {};\n\n\t\t\t\tlet k;\n\n\t\t\t\tfor ( k = 0; k < animationKeys.length; k ++ ) {\n\n\t\t\t\t\tif ( animationKeys[ k ].morphTargets ) {\n\n\t\t\t\t\t\tfor ( let m = 0; m < animationKeys[ k ].morphTargets.length; m ++ ) {\n\n\t\t\t\t\t\t\tmorphTargetNames[ animationKeys[ k ].morphTargets[ m ] ] = - 1;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t// create a track for each morph target with all zero\n\t\t\t\t// morphTargetInfluences except for the keys in which\n\t\t\t\t// the morphTarget is named.\n\t\t\t\tfor ( const morphTargetName in morphTargetNames ) {\n\n\t\t\t\t\tconst times = [];\n\t\t\t\t\tconst values = [];\n\n\t\t\t\t\tfor ( let m = 0; m !== animationKeys[ k ].morphTargets.length; ++ m ) {\n\n\t\t\t\t\t\tconst animationKey = animationKeys[ k ];\n\n\t\t\t\t\t\ttimes.push( animationKey.time );\n\t\t\t\t\t\tvalues.push( ( animationKey.morphTarget === morphTargetName ) ? 1 : 0 );\n\n\t\t\t\t\t}\n\n\t\t\t\t\ttracks.push( new NumberKeyframeTrack( '.morphTargetInfluence[' + morphTargetName + ']', times, values ) );\n\n\t\t\t\t}\n\n\t\t\t\tduration = morphTargetNames.length * fps;\n\n\t\t\t} else {\n\n\t\t\t\t// ...assume skeletal animation\n\n\t\t\t\tconst boneName = '.bones[' + bones[ h ].name + ']';\n\n\t\t\t\taddNonemptyTrack(\n\t\t\t\t\tVectorKeyframeTrack, boneName + '.position',\n\t\t\t\t\tanimationKeys, 'pos', tracks );\n\n\t\t\t\taddNonemptyTrack(\n\t\t\t\t\tQuaternionKeyframeTrack, boneName + '.quaternion',\n\t\t\t\t\tanimationKeys, 'rot', tracks );\n\n\t\t\t\taddNonemptyTrack(\n\t\t\t\t\tVectorKeyframeTrack, boneName + '.scale',\n\t\t\t\t\tanimationKeys, 'scl', tracks );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( tracks.length === 0 ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst clip = new this( clipName, duration, tracks, blendMode );\n\n\t\treturn clip;\n\n\t}\n\n\tresetDuration() {\n\n\t\tconst tracks = this.tracks;\n\t\tlet duration = 0;\n\n\t\tfor ( let i = 0, n = tracks.length; i !== n; ++ i ) {\n\n\t\t\tconst track = this.tracks[ i ];\n\n\t\t\tduration = Math.max( duration, track.times[ track.times.length - 1 ] );\n\n\t\t}\n\n\t\tthis.duration = duration;\n\n\t\treturn this;\n\n\t}\n\n\ttrim() {\n\n\t\tfor ( let i = 0; i < this.tracks.length; i ++ ) {\n\n\t\t\tthis.tracks[ i ].trim( 0, this.duration );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tvalidate() {\n\n\t\tlet valid = true;\n\n\t\tfor ( let i = 0; i < this.tracks.length; i ++ ) {\n\n\t\t\tvalid = valid && this.tracks[ i ].validate();\n\n\t\t}\n\n\t\treturn valid;\n\n\t}\n\n\toptimize() {\n\n\t\tfor ( let i = 0; i < this.tracks.length; i ++ ) {\n\n\t\t\tthis.tracks[ i ].optimize();\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\tconst tracks = [];\n\n\t\tfor ( let i = 0; i < this.tracks.length; i ++ ) {\n\n\t\t\ttracks.push( this.tracks[ i ].clone() );\n\n\t\t}\n\n\t\treturn new this.constructor( this.name, this.duration, tracks, this.blendMode );\n\n\t}\n\n\ttoJSON() {\n\n\t\treturn this.constructor.toJSON( this );\n\n\t}\n\n}\n\nfunction getTrackTypeForValueTypeName( typeName ) {\n\n\tswitch ( typeName.toLowerCase() ) {\n\n\t\tcase 'scalar':\n\t\tcase 'double':\n\t\tcase 'float':\n\t\tcase 'number':\n\t\tcase 'integer':\n\n\t\t\treturn NumberKeyframeTrack;\n\n\t\tcase 'vector':\n\t\tcase 'vector2':\n\t\tcase 'vector3':\n\t\tcase 'vector4':\n\n\t\t\treturn VectorKeyframeTrack;\n\n\t\tcase 'color':\n\n\t\t\treturn ColorKeyframeTrack;\n\n\t\tcase 'quaternion':\n\n\t\t\treturn QuaternionKeyframeTrack;\n\n\t\tcase 'bool':\n\t\tcase 'boolean':\n\n\t\t\treturn BooleanKeyframeTrack;\n\n\t\tcase 'string':\n\n\t\t\treturn StringKeyframeTrack;\n\n\t}\n\n\tthrow new Error( 'THREE.KeyframeTrack: Unsupported typeName: ' + typeName );\n\n}\n\nfunction parseKeyframeTrack( json ) {\n\n\tif ( json.type === undefined ) {\n\n\t\tthrow new Error( 'THREE.KeyframeTrack: track type undefined, can not parse' );\n\n\t}\n\n\tconst trackType = getTrackTypeForValueTypeName( json.type );\n\n\tif ( json.times === undefined ) {\n\n\t\tconst times = [], values = [];\n\n\t\tflattenJSON( json.keys, times, values, 'value' );\n\n\t\tjson.times = times;\n\t\tjson.values = values;\n\n\t}\n\n\t// derived classes can define a static parse method\n\tif ( trackType.parse !== undefined ) {\n\n\t\treturn trackType.parse( json );\n\n\t} else {\n\n\t\t// by default, we assume a constructor compatible with the base\n\t\treturn new trackType( json.name, json.times, json.values, json.interpolation );\n\n\t}\n\n}\n\nconst Cache = {\n\n\tenabled: false,\n\n\tfiles: {},\n\n\tadd: function ( key, file ) {\n\n\t\tif ( this.enabled === false ) return;\n\n\t\t// console.log( 'THREE.Cache', 'Adding key:', key );\n\n\t\tthis.files[ key ] = file;\n\n\t},\n\n\tget: function ( key ) {\n\n\t\tif ( this.enabled === false ) return;\n\n\t\t// console.log( 'THREE.Cache', 'Checking key:', key );\n\n\t\treturn this.files[ key ];\n\n\t},\n\n\tremove: function ( key ) {\n\n\t\tdelete this.files[ key ];\n\n\t},\n\n\tclear: function () {\n\n\t\tthis.files = {};\n\n\t}\n\n};\n\nclass LoadingManager {\n\n\tconstructor( onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tlet isLoading = false;\n\t\tlet itemsLoaded = 0;\n\t\tlet itemsTotal = 0;\n\t\tlet urlModifier = undefined;\n\t\tconst handlers = [];\n\n\t\t// Refer to #5689 for the reason why we don't set .onStart\n\t\t// in the constructor\n\n\t\tthis.onStart = undefined;\n\t\tthis.onLoad = onLoad;\n\t\tthis.onProgress = onProgress;\n\t\tthis.onError = onError;\n\n\t\tthis.itemStart = function ( url ) {\n\n\t\t\titemsTotal ++;\n\n\t\t\tif ( isLoading === false ) {\n\n\t\t\t\tif ( scope.onStart !== undefined ) {\n\n\t\t\t\t\tscope.onStart( url, itemsLoaded, itemsTotal );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tisLoading = true;\n\n\t\t};\n\n\t\tthis.itemEnd = function ( url ) {\n\n\t\t\titemsLoaded ++;\n\n\t\t\tif ( scope.onProgress !== undefined ) {\n\n\t\t\t\tscope.onProgress( url, itemsLoaded, itemsTotal );\n\n\t\t\t}\n\n\t\t\tif ( itemsLoaded === itemsTotal ) {\n\n\t\t\t\tisLoading = false;\n\n\t\t\t\tif ( scope.onLoad !== undefined ) {\n\n\t\t\t\t\tscope.onLoad();\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t};\n\n\t\tthis.itemError = function ( url ) {\n\n\t\t\tif ( scope.onError !== undefined ) {\n\n\t\t\t\tscope.onError( url );\n\n\t\t\t}\n\n\t\t};\n\n\t\tthis.resolveURL = function ( url ) {\n\n\t\t\tif ( urlModifier ) {\n\n\t\t\t\treturn urlModifier( url );\n\n\t\t\t}\n\n\t\t\treturn url;\n\n\t\t};\n\n\t\tthis.setURLModifier = function ( transform ) {\n\n\t\t\turlModifier = transform;\n\n\t\t\treturn this;\n\n\t\t};\n\n\t\tthis.addHandler = function ( regex, loader ) {\n\n\t\t\thandlers.push( regex, loader );\n\n\t\t\treturn this;\n\n\t\t};\n\n\t\tthis.removeHandler = function ( regex ) {\n\n\t\t\tconst index = handlers.indexOf( regex );\n\n\t\t\tif ( index !== - 1 ) {\n\n\t\t\t\thandlers.splice( index, 2 );\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t};\n\n\t\tthis.getHandler = function ( file ) {\n\n\t\t\tfor ( let i = 0, l = handlers.length; i < l; i += 2 ) {\n\n\t\t\t\tconst regex = handlers[ i ];\n\t\t\t\tconst loader = handlers[ i + 1 ];\n\n\t\t\t\tif ( regex.global ) regex.lastIndex = 0; // see #17920\n\n\t\t\t\tif ( regex.test( file ) ) {\n\n\t\t\t\t\treturn loader;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn null;\n\n\t\t};\n\n\t}\n\n}\n\nconst DefaultLoadingManager = /*@__PURE__*/ new LoadingManager();\n\nclass Loader {\n\n\tconstructor( manager ) {\n\n\t\tthis.manager = ( manager !== undefined ) ? manager : DefaultLoadingManager;\n\n\t\tthis.crossOrigin = 'anonymous';\n\t\tthis.withCredentials = false;\n\t\tthis.path = '';\n\t\tthis.resourcePath = '';\n\t\tthis.requestHeader = {};\n\n\t}\n\n\tload( /* url, onLoad, onProgress, onError */ ) {}\n\n\tloadAsync( url, onProgress ) {\n\n\t\tconst scope = this;\n\n\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\tscope.load( url, resolve, onProgress, reject );\n\n\t\t} );\n\n\t}\n\n\tparse( /* data */ ) {}\n\n\tsetCrossOrigin( crossOrigin ) {\n\n\t\tthis.crossOrigin = crossOrigin;\n\t\treturn this;\n\n\t}\n\n\tsetWithCredentials( value ) {\n\n\t\tthis.withCredentials = value;\n\t\treturn this;\n\n\t}\n\n\tsetPath( path ) {\n\n\t\tthis.path = path;\n\t\treturn this;\n\n\t}\n\n\tsetResourcePath( resourcePath ) {\n\n\t\tthis.resourcePath = resourcePath;\n\t\treturn this;\n\n\t}\n\n\tsetRequestHeader( requestHeader ) {\n\n\t\tthis.requestHeader = requestHeader;\n\t\treturn this;\n\n\t}\n\n}\n\nconst loading = {};\n\nclass HttpError extends Error {\n\n\tconstructor( message, response ) {\n\n\t\tsuper( message );\n\t\tthis.response = response;\n\n\t}\n\n}\n\nclass FileLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tif ( url === undefined ) url = '';\n\n\t\tif ( this.path !== undefined ) url = this.path + url;\n\n\t\turl = this.manager.resolveURL( url );\n\n\t\tconst cached = Cache.get( url );\n\n\t\tif ( cached !== undefined ) {\n\n\t\t\tthis.manager.itemStart( url );\n\n\t\t\tsetTimeout( () => {\n\n\t\t\t\tif ( onLoad ) onLoad( cached );\n\n\t\t\t\tthis.manager.itemEnd( url );\n\n\t\t\t}, 0 );\n\n\t\t\treturn cached;\n\n\t\t}\n\n\t\t// Check if request is duplicate\n\n\t\tif ( loading[ url ] !== undefined ) {\n\n\t\t\tloading[ url ].push( {\n\n\t\t\t\tonLoad: onLoad,\n\t\t\t\tonProgress: onProgress,\n\t\t\t\tonError: onError\n\n\t\t\t} );\n\n\t\t\treturn;\n\n\t\t}\n\n\t\t// Initialise array for duplicate requests\n\t\tloading[ url ] = [];\n\n\t\tloading[ url ].push( {\n\t\t\tonLoad: onLoad,\n\t\t\tonProgress: onProgress,\n\t\t\tonError: onError,\n\t\t} );\n\n\t\t// create request\n\t\tconst req = new Request( url, {\n\t\t\theaders: new Headers( this.requestHeader ),\n\t\t\tcredentials: this.withCredentials ? 'include' : 'same-origin',\n\t\t\t// An abort controller could be added within a future PR\n\t\t} );\n\n\t\t// record states ( avoid data race )\n\t\tconst mimeType = this.mimeType;\n\t\tconst responseType = this.responseType;\n\n\t\t// start the fetch\n\t\tfetch( req )\n\t\t\t.then( response => {\n\n\t\t\t\tif ( response.status === 200 || response.status === 0 ) {\n\n\t\t\t\t\t// Some browsers return HTTP Status 0 when using non-http protocol\n\t\t\t\t\t// e.g. 'file://' or 'data://'. Handle as success.\n\n\t\t\t\t\tif ( response.status === 0 ) {\n\n\t\t\t\t\t\tconsole.warn( 'THREE.FileLoader: HTTP Status 0 received.' );\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// Workaround: Checking if response.body === undefined for Alipay browser #23548\n\n\t\t\t\t\tif ( typeof ReadableStream === 'undefined' || response.body === undefined || response.body.getReader === undefined ) {\n\n\t\t\t\t\t\treturn response;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tconst callbacks = loading[ url ];\n\t\t\t\t\tconst reader = response.body.getReader();\n\n\t\t\t\t\t// Nginx needs X-File-Size check\n\t\t\t\t\t// https://serverfault.com/questions/482875/why-does-nginx-remove-content-length-header-for-chunked-content\n\t\t\t\t\tconst contentLength = response.headers.get( 'Content-Length' ) || response.headers.get( 'X-File-Size' );\n\t\t\t\t\tconst total = contentLength ? parseInt( contentLength ) : 0;\n\t\t\t\t\tconst lengthComputable = total !== 0;\n\t\t\t\t\tlet loaded = 0;\n\n\t\t\t\t\t// periodically read data into the new stream tracking while download progress\n\t\t\t\t\tconst stream = new ReadableStream( {\n\t\t\t\t\t\tstart( controller ) {\n\n\t\t\t\t\t\t\treadData();\n\n\t\t\t\t\t\t\tfunction readData() {\n\n\t\t\t\t\t\t\t\treader.read().then( ( { done, value } ) => {\n\n\t\t\t\t\t\t\t\t\tif ( done ) {\n\n\t\t\t\t\t\t\t\t\t\tcontroller.close();\n\n\t\t\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\t\t\tloaded += value.byteLength;\n\n\t\t\t\t\t\t\t\t\t\tconst event = new ProgressEvent( 'progress', { lengthComputable, loaded, total } );\n\t\t\t\t\t\t\t\t\t\tfor ( let i = 0, il = callbacks.length; i < il; i ++ ) {\n\n\t\t\t\t\t\t\t\t\t\t\tconst callback = callbacks[ i ];\n\t\t\t\t\t\t\t\t\t\t\tif ( callback.onProgress ) callback.onProgress( event );\n\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\tcontroller.enqueue( value );\n\t\t\t\t\t\t\t\t\t\treadData();\n\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} );\n\n\t\t\t\t\treturn new Response( stream );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthrow new HttpError( `fetch for \"${response.url}\" responded with ${response.status}: ${response.statusText}`, response );\n\n\t\t\t\t}\n\n\t\t\t} )\n\t\t\t.then( response => {\n\n\t\t\t\tswitch ( responseType ) {\n\n\t\t\t\t\tcase 'arraybuffer':\n\n\t\t\t\t\t\treturn response.arrayBuffer();\n\n\t\t\t\t\tcase 'blob':\n\n\t\t\t\t\t\treturn response.blob();\n\n\t\t\t\t\tcase 'document':\n\n\t\t\t\t\t\treturn response.text()\n\t\t\t\t\t\t\t.then( text => {\n\n\t\t\t\t\t\t\t\tconst parser = new DOMParser();\n\t\t\t\t\t\t\t\treturn parser.parseFromString( text, mimeType );\n\n\t\t\t\t\t\t\t} );\n\n\t\t\t\t\tcase 'json':\n\n\t\t\t\t\t\treturn response.json();\n\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tif ( mimeType === undefined ) {\n\n\t\t\t\t\t\t\treturn response.text();\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t// sniff encoding\n\t\t\t\t\t\t\tconst re = /charset=\"?([^;\"\\s]*)\"?/i;\n\t\t\t\t\t\t\tconst exec = re.exec( mimeType );\n\t\t\t\t\t\t\tconst label = exec && exec[ 1 ] ? exec[ 1 ].toLowerCase() : undefined;\n\t\t\t\t\t\t\tconst decoder = new TextDecoder( label );\n\t\t\t\t\t\t\treturn response.arrayBuffer().then( ab => decoder.decode( ab ) );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} )\n\t\t\t.then( data => {\n\n\t\t\t\t// Add to cache only on HTTP success, so that we do not cache\n\t\t\t\t// error response bodies as proper responses to requests.\n\t\t\t\tCache.add( url, data );\n\n\t\t\t\tconst callbacks = loading[ url ];\n\t\t\t\tdelete loading[ url ];\n\n\t\t\t\tfor ( let i = 0, il = callbacks.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst callback = callbacks[ i ];\n\t\t\t\t\tif ( callback.onLoad ) callback.onLoad( data );\n\n\t\t\t\t}\n\n\t\t\t} )\n\t\t\t.catch( err => {\n\n\t\t\t\t// Abort errors and other errors are handled the same\n\n\t\t\t\tconst callbacks = loading[ url ];\n\n\t\t\t\tif ( callbacks === undefined ) {\n\n\t\t\t\t\t// When onLoad was called and url was deleted in `loading`\n\t\t\t\t\tthis.manager.itemError( url );\n\t\t\t\t\tthrow err;\n\n\t\t\t\t}\n\n\t\t\t\tdelete loading[ url ];\n\n\t\t\t\tfor ( let i = 0, il = callbacks.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst callback = callbacks[ i ];\n\t\t\t\t\tif ( callback.onError ) callback.onError( err );\n\n\t\t\t\t}\n\n\t\t\t\tthis.manager.itemError( url );\n\n\t\t\t} )\n\t\t\t.finally( () => {\n\n\t\t\t\tthis.manager.itemEnd( url );\n\n\t\t\t} );\n\n\t\tthis.manager.itemStart( url );\n\n\t}\n\n\tsetResponseType( value ) {\n\n\t\tthis.responseType = value;\n\t\treturn this;\n\n\t}\n\n\tsetMimeType( value ) {\n\n\t\tthis.mimeType = value;\n\t\treturn this;\n\n\t}\n\n}\n\nclass AnimationLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tconst loader = new FileLoader( this.manager );\n\t\tloader.setPath( this.path );\n\t\tloader.setRequestHeader( this.requestHeader );\n\t\tloader.setWithCredentials( this.withCredentials );\n\t\tloader.load( url, function ( text ) {\n\n\t\t\ttry {\n\n\t\t\t\tonLoad( scope.parse( JSON.parse( text ) ) );\n\n\t\t\t} catch ( e ) {\n\n\t\t\t\tif ( onError ) {\n\n\t\t\t\t\tonError( e );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( e );\n\n\t\t\t\t}\n\n\t\t\t\tscope.manager.itemError( url );\n\n\t\t\t}\n\n\t\t}, onProgress, onError );\n\n\t}\n\n\tparse( json ) {\n\n\t\tconst animations = [];\n\n\t\tfor ( let i = 0; i < json.length; i ++ ) {\n\n\t\t\tconst clip = AnimationClip.parse( json[ i ] );\n\n\t\t\tanimations.push( clip );\n\n\t\t}\n\n\t\treturn animations;\n\n\t}\n\n}\n\n/**\n * Abstract Base class to block based textures loader (dds, pvr, ...)\n *\n * Sub classes have to implement the parse() method which will be used in load().\n */\n\nclass CompressedTextureLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tconst images = [];\n\n\t\tconst texture = new CompressedTexture();\n\n\t\tconst loader = new FileLoader( this.manager );\n\t\tloader.setPath( this.path );\n\t\tloader.setResponseType( 'arraybuffer' );\n\t\tloader.setRequestHeader( this.requestHeader );\n\t\tloader.setWithCredentials( scope.withCredentials );\n\n\t\tlet loaded = 0;\n\n\t\tfunction loadTexture( i ) {\n\n\t\t\tloader.load( url[ i ], function ( buffer ) {\n\n\t\t\t\tconst texDatas = scope.parse( buffer, true );\n\n\t\t\t\timages[ i ] = {\n\t\t\t\t\twidth: texDatas.width,\n\t\t\t\t\theight: texDatas.height,\n\t\t\t\t\tformat: texDatas.format,\n\t\t\t\t\tmipmaps: texDatas.mipmaps\n\t\t\t\t};\n\n\t\t\t\tloaded += 1;\n\n\t\t\t\tif ( loaded === 6 ) {\n\n\t\t\t\t\tif ( texDatas.mipmapCount === 1 ) texture.minFilter = LinearFilter;\n\n\t\t\t\t\ttexture.image = images;\n\t\t\t\t\ttexture.format = texDatas.format;\n\t\t\t\t\ttexture.needsUpdate = true;\n\n\t\t\t\t\tif ( onLoad ) onLoad( texture );\n\n\t\t\t\t}\n\n\t\t\t}, onProgress, onError );\n\n\t\t}\n\n\t\tif ( Array.isArray( url ) ) {\n\n\t\t\tfor ( let i = 0, il = url.length; i < il; ++ i ) {\n\n\t\t\t\tloadTexture( i );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\t// compressed cubemap texture stored in a single DDS file\n\n\t\t\tloader.load( url, function ( buffer ) {\n\n\t\t\t\tconst texDatas = scope.parse( buffer, true );\n\n\t\t\t\tif ( texDatas.isCubemap ) {\n\n\t\t\t\t\tconst faces = texDatas.mipmaps.length / texDatas.mipmapCount;\n\n\t\t\t\t\tfor ( let f = 0; f < faces; f ++ ) {\n\n\t\t\t\t\t\timages[ f ] = { mipmaps: [] };\n\n\t\t\t\t\t\tfor ( let i = 0; i < texDatas.mipmapCount; i ++ ) {\n\n\t\t\t\t\t\t\timages[ f ].mipmaps.push( texDatas.mipmaps[ f * texDatas.mipmapCount + i ] );\n\t\t\t\t\t\t\timages[ f ].format = texDatas.format;\n\t\t\t\t\t\t\timages[ f ].width = texDatas.width;\n\t\t\t\t\t\t\timages[ f ].height = texDatas.height;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\ttexture.image = images;\n\n\t\t\t\t} else {\n\n\t\t\t\t\ttexture.image.width = texDatas.width;\n\t\t\t\t\ttexture.image.height = texDatas.height;\n\t\t\t\t\ttexture.mipmaps = texDatas.mipmaps;\n\n\t\t\t\t}\n\n\t\t\t\tif ( texDatas.mipmapCount === 1 ) {\n\n\t\t\t\t\ttexture.minFilter = LinearFilter;\n\n\t\t\t\t}\n\n\t\t\t\ttexture.format = texDatas.format;\n\t\t\t\ttexture.needsUpdate = true;\n\n\t\t\t\tif ( onLoad ) onLoad( texture );\n\n\t\t\t}, onProgress, onError );\n\n\t\t}\n\n\t\treturn texture;\n\n\t}\n\n}\n\nclass ImageLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tif ( this.path !== undefined ) url = this.path + url;\n\n\t\turl = this.manager.resolveURL( url );\n\n\t\tconst scope = this;\n\n\t\tconst cached = Cache.get( url );\n\n\t\tif ( cached !== undefined ) {\n\n\t\t\tscope.manager.itemStart( url );\n\n\t\t\tsetTimeout( function () {\n\n\t\t\t\tif ( onLoad ) onLoad( cached );\n\n\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t}, 0 );\n\n\t\t\treturn cached;\n\n\t\t}\n\n\t\tconst image = createElementNS( 'img' );\n\n\t\tfunction onImageLoad() {\n\n\t\t\tremoveEventListeners();\n\n\t\t\tCache.add( url, this );\n\n\t\t\tif ( onLoad ) onLoad( this );\n\n\t\t\tscope.manager.itemEnd( url );\n\n\t\t}\n\n\t\tfunction onImageError( event ) {\n\n\t\t\tremoveEventListeners();\n\n\t\t\tif ( onError ) onError( event );\n\n\t\t\tscope.manager.itemError( url );\n\t\t\tscope.manager.itemEnd( url );\n\n\t\t}\n\n\t\tfunction removeEventListeners() {\n\n\t\t\timage.removeEventListener( 'load', onImageLoad, false );\n\t\t\timage.removeEventListener( 'error', onImageError, false );\n\n\t\t}\n\n\t\timage.addEventListener( 'load', onImageLoad, false );\n\t\timage.addEventListener( 'error', onImageError, false );\n\n\t\tif ( url.slice( 0, 5 ) !== 'data:' ) {\n\n\t\t\tif ( this.crossOrigin !== undefined ) image.crossOrigin = this.crossOrigin;\n\n\t\t}\n\n\t\tscope.manager.itemStart( url );\n\n\t\timage.src = url;\n\n\t\treturn image;\n\n\t}\n\n}\n\nclass CubeTextureLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( urls, onLoad, onProgress, onError ) {\n\n\t\tconst texture = new CubeTexture();\n\n\t\tconst loader = new ImageLoader( this.manager );\n\t\tloader.setCrossOrigin( this.crossOrigin );\n\t\tloader.setPath( this.path );\n\n\t\tlet loaded = 0;\n\n\t\tfunction loadTexture( i ) {\n\n\t\t\tloader.load( urls[ i ], function ( image ) {\n\n\t\t\t\ttexture.images[ i ] = image;\n\n\t\t\t\tloaded ++;\n\n\t\t\t\tif ( loaded === 6 ) {\n\n\t\t\t\t\ttexture.needsUpdate = true;\n\n\t\t\t\t\tif ( onLoad ) onLoad( texture );\n\n\t\t\t\t}\n\n\t\t\t}, undefined, onError );\n\n\t\t}\n\n\t\tfor ( let i = 0; i < urls.length; ++ i ) {\n\n\t\t\tloadTexture( i );\n\n\t\t}\n\n\t\treturn texture;\n\n\t}\n\n}\n\n/**\n * Abstract Base class to load generic binary textures formats (rgbe, hdr, ...)\n *\n * Sub classes have to implement the parse() method which will be used in load().\n */\n\nclass DataTextureLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tconst texture = new DataTexture();\n\n\t\tconst loader = new FileLoader( this.manager );\n\t\tloader.setResponseType( 'arraybuffer' );\n\t\tloader.setRequestHeader( this.requestHeader );\n\t\tloader.setPath( this.path );\n\t\tloader.setWithCredentials( scope.withCredentials );\n\t\tloader.load( url, function ( buffer ) {\n\n\t\t\tconst texData = scope.parse( buffer );\n\n\t\t\tif ( ! texData ) return;\n\n\t\t\tif ( texData.image !== undefined ) {\n\n\t\t\t\ttexture.image = texData.image;\n\n\t\t\t} else if ( texData.data !== undefined ) {\n\n\t\t\t\ttexture.image.width = texData.width;\n\t\t\t\ttexture.image.height = texData.height;\n\t\t\t\ttexture.image.data = texData.data;\n\n\t\t\t}\n\n\t\t\ttexture.wrapS = texData.wrapS !== undefined ? texData.wrapS : ClampToEdgeWrapping;\n\t\t\ttexture.wrapT = texData.wrapT !== undefined ? texData.wrapT : ClampToEdgeWrapping;\n\n\t\t\ttexture.magFilter = texData.magFilter !== undefined ? texData.magFilter : LinearFilter;\n\t\t\ttexture.minFilter = texData.minFilter !== undefined ? texData.minFilter : LinearFilter;\n\n\t\t\ttexture.anisotropy = texData.anisotropy !== undefined ? texData.anisotropy : 1;\n\n\t\t\tif ( texData.encoding !== undefined ) {\n\n\t\t\t\ttexture.encoding = texData.encoding;\n\n\t\t\t}\n\n\t\t\tif ( texData.flipY !== undefined ) {\n\n\t\t\t\ttexture.flipY = texData.flipY;\n\n\t\t\t}\n\n\t\t\tif ( texData.format !== undefined ) {\n\n\t\t\t\ttexture.format = texData.format;\n\n\t\t\t}\n\n\t\t\tif ( texData.type !== undefined ) {\n\n\t\t\t\ttexture.type = texData.type;\n\n\t\t\t}\n\n\t\t\tif ( texData.mipmaps !== undefined ) {\n\n\t\t\t\ttexture.mipmaps = texData.mipmaps;\n\t\t\t\ttexture.minFilter = LinearMipmapLinearFilter; // presumably...\n\n\t\t\t}\n\n\t\t\tif ( texData.mipmapCount === 1 ) {\n\n\t\t\t\ttexture.minFilter = LinearFilter;\n\n\t\t\t}\n\n\t\t\tif ( texData.generateMipmaps !== undefined ) {\n\n\t\t\t\ttexture.generateMipmaps = texData.generateMipmaps;\n\n\t\t\t}\n\n\t\t\ttexture.needsUpdate = true;\n\n\t\t\tif ( onLoad ) onLoad( texture, texData );\n\n\t\t}, onProgress, onError );\n\n\n\t\treturn texture;\n\n\t}\n\n}\n\nclass TextureLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst texture = new Texture();\n\n\t\tconst loader = new ImageLoader( this.manager );\n\t\tloader.setCrossOrigin( this.crossOrigin );\n\t\tloader.setPath( this.path );\n\n\t\tloader.load( url, function ( image ) {\n\n\t\t\ttexture.image = image;\n\t\t\ttexture.needsUpdate = true;\n\n\t\t\tif ( onLoad !== undefined ) {\n\n\t\t\t\tonLoad( texture );\n\n\t\t\t}\n\n\t\t}, onProgress, onError );\n\n\t\treturn texture;\n\n\t}\n\n}\n\nclass Light extends Object3D {\n\n\tconstructor( color, intensity = 1 ) {\n\n\t\tsuper();\n\n\t\tthis.isLight = true;\n\n\t\tthis.type = 'Light';\n\n\t\tthis.color = new Color( color );\n\t\tthis.intensity = intensity;\n\n\t}\n\n\tdispose() {\n\n\t\t// Empty here in base class; some subclasses override.\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.color.copy( source.color );\n\t\tthis.intensity = source.intensity;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst data = super.toJSON( meta );\n\n\t\tdata.object.color = this.color.getHex();\n\t\tdata.object.intensity = this.intensity;\n\n\t\tif ( this.groundColor !== undefined ) data.object.groundColor = this.groundColor.getHex();\n\n\t\tif ( this.distance !== undefined ) data.object.distance = this.distance;\n\t\tif ( this.angle !== undefined ) data.object.angle = this.angle;\n\t\tif ( this.decay !== undefined ) data.object.decay = this.decay;\n\t\tif ( this.penumbra !== undefined ) data.object.penumbra = this.penumbra;\n\n\t\tif ( this.shadow !== undefined ) data.object.shadow = this.shadow.toJSON();\n\n\t\treturn data;\n\n\t}\n\n}\n\nclass HemisphereLight extends Light {\n\n\tconstructor( skyColor, groundColor, intensity ) {\n\n\t\tsuper( skyColor, intensity );\n\n\t\tthis.isHemisphereLight = true;\n\n\t\tthis.type = 'HemisphereLight';\n\n\t\tthis.position.copy( Object3D.DefaultUp );\n\t\tthis.updateMatrix();\n\n\t\tthis.groundColor = new Color( groundColor );\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.groundColor.copy( source.groundColor );\n\n\t\treturn this;\n\n\t}\n\n}\n\nconst _projScreenMatrix$1 = /*@__PURE__*/ new Matrix4();\nconst _lightPositionWorld$1 = /*@__PURE__*/ new Vector3();\nconst _lookTarget$1 = /*@__PURE__*/ new Vector3();\n\nclass LightShadow {\n\n\tconstructor( camera ) {\n\n\t\tthis.camera = camera;\n\n\t\tthis.bias = 0;\n\t\tthis.normalBias = 0;\n\t\tthis.radius = 1;\n\t\tthis.blurSamples = 8;\n\n\t\tthis.mapSize = new Vector2( 512, 512 );\n\n\t\tthis.map = null;\n\t\tthis.mapPass = null;\n\t\tthis.matrix = new Matrix4();\n\n\t\tthis.autoUpdate = true;\n\t\tthis.needsUpdate = false;\n\n\t\tthis._frustum = new Frustum();\n\t\tthis._frameExtents = new Vector2( 1, 1 );\n\n\t\tthis._viewportCount = 1;\n\n\t\tthis._viewports = [\n\n\t\t\tnew Vector4( 0, 0, 1, 1 )\n\n\t\t];\n\n\t}\n\n\tgetViewportCount() {\n\n\t\treturn this._viewportCount;\n\n\t}\n\n\tgetFrustum() {\n\n\t\treturn this._frustum;\n\n\t}\n\n\tupdateMatrices( light ) {\n\n\t\tconst shadowCamera = this.camera;\n\t\tconst shadowMatrix = this.matrix;\n\n\t\t_lightPositionWorld$1.setFromMatrixPosition( light.matrixWorld );\n\t\tshadowCamera.position.copy( _lightPositionWorld$1 );\n\n\t\t_lookTarget$1.setFromMatrixPosition( light.target.matrixWorld );\n\t\tshadowCamera.lookAt( _lookTarget$1 );\n\t\tshadowCamera.updateMatrixWorld();\n\n\t\t_projScreenMatrix$1.multiplyMatrices( shadowCamera.projectionMatrix, shadowCamera.matrixWorldInverse );\n\t\tthis._frustum.setFromProjectionMatrix( _projScreenMatrix$1 );\n\n\t\tshadowMatrix.set(\n\t\t\t0.5, 0.0, 0.0, 0.5,\n\t\t\t0.0, 0.5, 0.0, 0.5,\n\t\t\t0.0, 0.0, 0.5, 0.5,\n\t\t\t0.0, 0.0, 0.0, 1.0\n\t\t);\n\n\t\tshadowMatrix.multiply( _projScreenMatrix$1 );\n\n\t}\n\n\tgetViewport( viewportIndex ) {\n\n\t\treturn this._viewports[ viewportIndex ];\n\n\t}\n\n\tgetFrameExtents() {\n\n\t\treturn this._frameExtents;\n\n\t}\n\n\tdispose() {\n\n\t\tif ( this.map ) {\n\n\t\t\tthis.map.dispose();\n\n\t\t}\n\n\t\tif ( this.mapPass ) {\n\n\t\t\tthis.mapPass.dispose();\n\n\t\t}\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.camera = source.camera.clone();\n\n\t\tthis.bias = source.bias;\n\t\tthis.radius = source.radius;\n\n\t\tthis.mapSize.copy( source.mapSize );\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst object = {};\n\n\t\tif ( this.bias !== 0 ) object.bias = this.bias;\n\t\tif ( this.normalBias !== 0 ) object.normalBias = this.normalBias;\n\t\tif ( this.radius !== 1 ) object.radius = this.radius;\n\t\tif ( this.mapSize.x !== 512 || this.mapSize.y !== 512 ) object.mapSize = this.mapSize.toArray();\n\n\t\tobject.camera = this.camera.toJSON( false ).object;\n\t\tdelete object.camera.matrix;\n\n\t\treturn object;\n\n\t}\n\n}\n\nclass SpotLightShadow extends LightShadow {\n\n\tconstructor() {\n\n\t\tsuper( new PerspectiveCamera( 50, 1, 0.5, 500 ) );\n\n\t\tthis.isSpotLightShadow = true;\n\n\t\tthis.focus = 1;\n\n\t}\n\n\tupdateMatrices( light ) {\n\n\t\tconst camera = this.camera;\n\n\t\tconst fov = RAD2DEG * 2 * light.angle * this.focus;\n\t\tconst aspect = this.mapSize.width / this.mapSize.height;\n\t\tconst far = light.distance || camera.far;\n\n\t\tif ( fov !== camera.fov || aspect !== camera.aspect || far !== camera.far ) {\n\n\t\t\tcamera.fov = fov;\n\t\t\tcamera.aspect = aspect;\n\t\t\tcamera.far = far;\n\t\t\tcamera.updateProjectionMatrix();\n\n\t\t}\n\n\t\tsuper.updateMatrices( light );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.focus = source.focus;\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass SpotLight extends Light {\n\n\tconstructor( color, intensity, distance = 0, angle = Math.PI / 3, penumbra = 0, decay = 2 ) {\n\n\t\tsuper( color, intensity );\n\n\t\tthis.isSpotLight = true;\n\n\t\tthis.type = 'SpotLight';\n\n\t\tthis.position.copy( Object3D.DefaultUp );\n\t\tthis.updateMatrix();\n\n\t\tthis.target = new Object3D();\n\n\t\tthis.distance = distance;\n\t\tthis.angle = angle;\n\t\tthis.penumbra = penumbra;\n\t\tthis.decay = decay;\n\n\t\tthis.map = null;\n\n\t\tthis.shadow = new SpotLightShadow();\n\n\t}\n\n\tget power() {\n\n\t\t// compute the light's luminous power (in lumens) from its intensity (in candela)\n\t\t// by convention for a spotlight, luminous power (lm) = π * luminous intensity (cd)\n\t\treturn this.intensity * Math.PI;\n\n\t}\n\n\tset power( power ) {\n\n\t\t// set the light's intensity (in candela) from the desired luminous power (in lumens)\n\t\tthis.intensity = power / Math.PI;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.shadow.dispose();\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.distance = source.distance;\n\t\tthis.angle = source.angle;\n\t\tthis.penumbra = source.penumbra;\n\t\tthis.decay = source.decay;\n\n\t\tthis.target = source.target.clone();\n\n\t\tthis.shadow = source.shadow.clone();\n\n\t\treturn this;\n\n\t}\n\n}\n\nconst _projScreenMatrix = /*@__PURE__*/ new Matrix4();\nconst _lightPositionWorld = /*@__PURE__*/ new Vector3();\nconst _lookTarget = /*@__PURE__*/ new Vector3();\n\nclass PointLightShadow extends LightShadow {\n\n\tconstructor() {\n\n\t\tsuper( new PerspectiveCamera( 90, 1, 0.5, 500 ) );\n\n\t\tthis.isPointLightShadow = true;\n\n\t\tthis._frameExtents = new Vector2( 4, 2 );\n\n\t\tthis._viewportCount = 6;\n\n\t\tthis._viewports = [\n\t\t\t// These viewports map a cube-map onto a 2D texture with the\n\t\t\t// following orientation:\n\t\t\t//\n\t\t\t//  xzXZ\n\t\t\t//   y Y\n\t\t\t//\n\t\t\t// X - Positive x direction\n\t\t\t// x - Negative x direction\n\t\t\t// Y - Positive y direction\n\t\t\t// y - Negative y direction\n\t\t\t// Z - Positive z direction\n\t\t\t// z - Negative z direction\n\n\t\t\t// positive X\n\t\t\tnew Vector4( 2, 1, 1, 1 ),\n\t\t\t// negative X\n\t\t\tnew Vector4( 0, 1, 1, 1 ),\n\t\t\t// positive Z\n\t\t\tnew Vector4( 3, 1, 1, 1 ),\n\t\t\t// negative Z\n\t\t\tnew Vector4( 1, 1, 1, 1 ),\n\t\t\t// positive Y\n\t\t\tnew Vector4( 3, 0, 1, 1 ),\n\t\t\t// negative Y\n\t\t\tnew Vector4( 1, 0, 1, 1 )\n\t\t];\n\n\t\tthis._cubeDirections = [\n\t\t\tnew Vector3( 1, 0, 0 ), new Vector3( - 1, 0, 0 ), new Vector3( 0, 0, 1 ),\n\t\t\tnew Vector3( 0, 0, - 1 ), new Vector3( 0, 1, 0 ), new Vector3( 0, - 1, 0 )\n\t\t];\n\n\t\tthis._cubeUps = [\n\t\t\tnew Vector3( 0, 1, 0 ), new Vector3( 0, 1, 0 ), new Vector3( 0, 1, 0 ),\n\t\t\tnew Vector3( 0, 1, 0 ), new Vector3( 0, 0, 1 ),\tnew Vector3( 0, 0, - 1 )\n\t\t];\n\n\t}\n\n\tupdateMatrices( light, viewportIndex = 0 ) {\n\n\t\tconst camera = this.camera;\n\t\tconst shadowMatrix = this.matrix;\n\n\t\tconst far = light.distance || camera.far;\n\n\t\tif ( far !== camera.far ) {\n\n\t\t\tcamera.far = far;\n\t\t\tcamera.updateProjectionMatrix();\n\n\t\t}\n\n\t\t_lightPositionWorld.setFromMatrixPosition( light.matrixWorld );\n\t\tcamera.position.copy( _lightPositionWorld );\n\n\t\t_lookTarget.copy( camera.position );\n\t\t_lookTarget.add( this._cubeDirections[ viewportIndex ] );\n\t\tcamera.up.copy( this._cubeUps[ viewportIndex ] );\n\t\tcamera.lookAt( _lookTarget );\n\t\tcamera.updateMatrixWorld();\n\n\t\tshadowMatrix.makeTranslation( - _lightPositionWorld.x, - _lightPositionWorld.y, - _lightPositionWorld.z );\n\n\t\t_projScreenMatrix.multiplyMatrices( camera.projectionMatrix, camera.matrixWorldInverse );\n\t\tthis._frustum.setFromProjectionMatrix( _projScreenMatrix );\n\n\t}\n\n}\n\nclass PointLight extends Light {\n\n\tconstructor( color, intensity, distance = 0, decay = 2 ) {\n\n\t\tsuper( color, intensity );\n\n\t\tthis.isPointLight = true;\n\n\t\tthis.type = 'PointLight';\n\n\t\tthis.distance = distance;\n\t\tthis.decay = decay;\n\n\t\tthis.shadow = new PointLightShadow();\n\n\t}\n\n\tget power() {\n\n\t\t// compute the light's luminous power (in lumens) from its intensity (in candela)\n\t\t// for an isotropic light source, luminous power (lm) = 4 π luminous intensity (cd)\n\t\treturn this.intensity * 4 * Math.PI;\n\n\t}\n\n\tset power( power ) {\n\n\t\t// set the light's intensity (in candela) from the desired luminous power (in lumens)\n\t\tthis.intensity = power / ( 4 * Math.PI );\n\n\t}\n\n\tdispose() {\n\n\t\tthis.shadow.dispose();\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.distance = source.distance;\n\t\tthis.decay = source.decay;\n\n\t\tthis.shadow = source.shadow.clone();\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass DirectionalLightShadow extends LightShadow {\n\n\tconstructor() {\n\n\t\tsuper( new OrthographicCamera( - 5, 5, 5, - 5, 0.5, 500 ) );\n\n\t\tthis.isDirectionalLightShadow = true;\n\n\t}\n\n}\n\nclass DirectionalLight extends Light {\n\n\tconstructor( color, intensity ) {\n\n\t\tsuper( color, intensity );\n\n\t\tthis.isDirectionalLight = true;\n\n\t\tthis.type = 'DirectionalLight';\n\n\t\tthis.position.copy( Object3D.DefaultUp );\n\t\tthis.updateMatrix();\n\n\t\tthis.target = new Object3D();\n\n\t\tthis.shadow = new DirectionalLightShadow();\n\n\t}\n\n\tdispose() {\n\n\t\tthis.shadow.dispose();\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.target = source.target.clone();\n\t\tthis.shadow = source.shadow.clone();\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass AmbientLight extends Light {\n\n\tconstructor( color, intensity ) {\n\n\t\tsuper( color, intensity );\n\n\t\tthis.isAmbientLight = true;\n\n\t\tthis.type = 'AmbientLight';\n\n\t}\n\n}\n\nclass RectAreaLight extends Light {\n\n\tconstructor( color, intensity, width = 10, height = 10 ) {\n\n\t\tsuper( color, intensity );\n\n\t\tthis.isRectAreaLight = true;\n\n\t\tthis.type = 'RectAreaLight';\n\n\t\tthis.width = width;\n\t\tthis.height = height;\n\n\t}\n\n\tget power() {\n\n\t\t// compute the light's luminous power (in lumens) from its intensity (in nits)\n\t\treturn this.intensity * this.width * this.height * Math.PI;\n\n\t}\n\n\tset power( power ) {\n\n\t\t// set the light's intensity (in nits) from the desired luminous power (in lumens)\n\t\tthis.intensity = power / ( this.width * this.height * Math.PI );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.width = source.width;\n\t\tthis.height = source.height;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst data = super.toJSON( meta );\n\n\t\tdata.object.width = this.width;\n\t\tdata.object.height = this.height;\n\n\t\treturn data;\n\n\t}\n\n}\n\n/**\n * Primary reference:\n *   https://graphics.stanford.edu/papers/envmap/envmap.pdf\n *\n * Secondary reference:\n *   https://www.ppsloan.org/publications/StupidSH36.pdf\n */\n\n// 3-band SH defined by 9 coefficients\n\nclass SphericalHarmonics3 {\n\n\tconstructor() {\n\n\t\tthis.isSphericalHarmonics3 = true;\n\n\t\tthis.coefficients = [];\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tthis.coefficients.push( new Vector3() );\n\n\t\t}\n\n\t}\n\n\tset( coefficients ) {\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tthis.coefficients[ i ].copy( coefficients[ i ] );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tzero() {\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tthis.coefficients[ i ].set( 0, 0, 0 );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t// get the radiance in the direction of the normal\n\t// target is a Vector3\n\tgetAt( normal, target ) {\n\n\t\t// normal is assumed to be unit length\n\n\t\tconst x = normal.x, y = normal.y, z = normal.z;\n\n\t\tconst coeff = this.coefficients;\n\n\t\t// band 0\n\t\ttarget.copy( coeff[ 0 ] ).multiplyScalar( 0.282095 );\n\n\t\t// band 1\n\t\ttarget.addScaledVector( coeff[ 1 ], 0.488603 * y );\n\t\ttarget.addScaledVector( coeff[ 2 ], 0.488603 * z );\n\t\ttarget.addScaledVector( coeff[ 3 ], 0.488603 * x );\n\n\t\t// band 2\n\t\ttarget.addScaledVector( coeff[ 4 ], 1.092548 * ( x * y ) );\n\t\ttarget.addScaledVector( coeff[ 5 ], 1.092548 * ( y * z ) );\n\t\ttarget.addScaledVector( coeff[ 6 ], 0.315392 * ( 3.0 * z * z - 1.0 ) );\n\t\ttarget.addScaledVector( coeff[ 7 ], 1.092548 * ( x * z ) );\n\t\ttarget.addScaledVector( coeff[ 8 ], 0.546274 * ( x * x - y * y ) );\n\n\t\treturn target;\n\n\t}\n\n\t// get the irradiance (radiance convolved with cosine lobe) in the direction of the normal\n\t// target is a Vector3\n\t// https://graphics.stanford.edu/papers/envmap/envmap.pdf\n\tgetIrradianceAt( normal, target ) {\n\n\t\t// normal is assumed to be unit length\n\n\t\tconst x = normal.x, y = normal.y, z = normal.z;\n\n\t\tconst coeff = this.coefficients;\n\n\t\t// band 0\n\t\ttarget.copy( coeff[ 0 ] ).multiplyScalar( 0.886227 ); // π * 0.282095\n\n\t\t// band 1\n\t\ttarget.addScaledVector( coeff[ 1 ], 2.0 * 0.511664 * y ); // ( 2 * π / 3 ) * 0.488603\n\t\ttarget.addScaledVector( coeff[ 2 ], 2.0 * 0.511664 * z );\n\t\ttarget.addScaledVector( coeff[ 3 ], 2.0 * 0.511664 * x );\n\n\t\t// band 2\n\t\ttarget.addScaledVector( coeff[ 4 ], 2.0 * 0.429043 * x * y ); // ( π / 4 ) * 1.092548\n\t\ttarget.addScaledVector( coeff[ 5 ], 2.0 * 0.429043 * y * z );\n\t\ttarget.addScaledVector( coeff[ 6 ], 0.743125 * z * z - 0.247708 ); // ( π / 4 ) * 0.315392 * 3\n\t\ttarget.addScaledVector( coeff[ 7 ], 2.0 * 0.429043 * x * z );\n\t\ttarget.addScaledVector( coeff[ 8 ], 0.429043 * ( x * x - y * y ) ); // ( π / 4 ) * 0.546274\n\n\t\treturn target;\n\n\t}\n\n\tadd( sh ) {\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tthis.coefficients[ i ].add( sh.coefficients[ i ] );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\taddScaledSH( sh, s ) {\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tthis.coefficients[ i ].addScaledVector( sh.coefficients[ i ], s );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tscale( s ) {\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tthis.coefficients[ i ].multiplyScalar( s );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tlerp( sh, alpha ) {\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tthis.coefficients[ i ].lerp( sh.coefficients[ i ], alpha );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tequals( sh ) {\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tif ( ! this.coefficients[ i ].equals( sh.coefficients[ i ] ) ) {\n\n\t\t\t\treturn false;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tcopy( sh ) {\n\n\t\treturn this.set( sh.coefficients );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tconst coefficients = this.coefficients;\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tcoefficients[ i ].fromArray( array, offset + ( i * 3 ) );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tconst coefficients = this.coefficients;\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tcoefficients[ i ].toArray( array, offset + ( i * 3 ) );\n\n\t\t}\n\n\t\treturn array;\n\n\t}\n\n\t// evaluate the basis functions\n\t// shBasis is an Array[ 9 ]\n\tstatic getBasisAt( normal, shBasis ) {\n\n\t\t// normal is assumed to be unit length\n\n\t\tconst x = normal.x, y = normal.y, z = normal.z;\n\n\t\t// band 0\n\t\tshBasis[ 0 ] = 0.282095;\n\n\t\t// band 1\n\t\tshBasis[ 1 ] = 0.488603 * y;\n\t\tshBasis[ 2 ] = 0.488603 * z;\n\t\tshBasis[ 3 ] = 0.488603 * x;\n\n\t\t// band 2\n\t\tshBasis[ 4 ] = 1.092548 * x * y;\n\t\tshBasis[ 5 ] = 1.092548 * y * z;\n\t\tshBasis[ 6 ] = 0.315392 * ( 3 * z * z - 1 );\n\t\tshBasis[ 7 ] = 1.092548 * x * z;\n\t\tshBasis[ 8 ] = 0.546274 * ( x * x - y * y );\n\n\t}\n\n}\n\nclass LightProbe extends Light {\n\n\tconstructor( sh = new SphericalHarmonics3(), intensity = 1 ) {\n\n\t\tsuper( undefined, intensity );\n\n\t\tthis.isLightProbe = true;\n\n\t\tthis.sh = sh;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.sh.copy( source.sh );\n\n\t\treturn this;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tthis.intensity = json.intensity; // TODO: Move this bit to Light.fromJSON();\n\t\tthis.sh.fromArray( json.sh );\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst data = super.toJSON( meta );\n\n\t\tdata.object.sh = this.sh.toArray();\n\n\t\treturn data;\n\n\t}\n\n}\n\nclass MaterialLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\t\tthis.textures = {};\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tconst loader = new FileLoader( scope.manager );\n\t\tloader.setPath( scope.path );\n\t\tloader.setRequestHeader( scope.requestHeader );\n\t\tloader.setWithCredentials( scope.withCredentials );\n\t\tloader.load( url, function ( text ) {\n\n\t\t\ttry {\n\n\t\t\t\tonLoad( scope.parse( JSON.parse( text ) ) );\n\n\t\t\t} catch ( e ) {\n\n\t\t\t\tif ( onError ) {\n\n\t\t\t\t\tonError( e );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( e );\n\n\t\t\t\t}\n\n\t\t\t\tscope.manager.itemError( url );\n\n\t\t\t}\n\n\t\t}, onProgress, onError );\n\n\t}\n\n\tparse( json ) {\n\n\t\tconst textures = this.textures;\n\n\t\tfunction getTexture( name ) {\n\n\t\t\tif ( textures[ name ] === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.MaterialLoader: Undefined texture', name );\n\n\t\t\t}\n\n\t\t\treturn textures[ name ];\n\n\t\t}\n\n\t\tconst material = MaterialLoader.createMaterialFromType( json.type );\n\n\t\tif ( json.uuid !== undefined ) material.uuid = json.uuid;\n\t\tif ( json.name !== undefined ) material.name = json.name;\n\t\tif ( json.color !== undefined && material.color !== undefined ) material.color.setHex( json.color );\n\t\tif ( json.roughness !== undefined ) material.roughness = json.roughness;\n\t\tif ( json.metalness !== undefined ) material.metalness = json.metalness;\n\t\tif ( json.sheen !== undefined ) material.sheen = json.sheen;\n\t\tif ( json.sheenColor !== undefined ) material.sheenColor = new Color().setHex( json.sheenColor );\n\t\tif ( json.sheenRoughness !== undefined ) material.sheenRoughness = json.sheenRoughness;\n\t\tif ( json.emissive !== undefined && material.emissive !== undefined ) material.emissive.setHex( json.emissive );\n\t\tif ( json.specular !== undefined && material.specular !== undefined ) material.specular.setHex( json.specular );\n\t\tif ( json.specularIntensity !== undefined ) material.specularIntensity = json.specularIntensity;\n\t\tif ( json.specularColor !== undefined && material.specularColor !== undefined ) material.specularColor.setHex( json.specularColor );\n\t\tif ( json.shininess !== undefined ) material.shininess = json.shininess;\n\t\tif ( json.clearcoat !== undefined ) material.clearcoat = json.clearcoat;\n\t\tif ( json.clearcoatRoughness !== undefined ) material.clearcoatRoughness = json.clearcoatRoughness;\n\t\tif ( json.iridescence !== undefined ) material.iridescence = json.iridescence;\n\t\tif ( json.iridescenceIOR !== undefined ) material.iridescenceIOR = json.iridescenceIOR;\n\t\tif ( json.iridescenceThicknessRange !== undefined ) material.iridescenceThicknessRange = json.iridescenceThicknessRange;\n\t\tif ( json.transmission !== undefined ) material.transmission = json.transmission;\n\t\tif ( json.thickness !== undefined ) material.thickness = json.thickness;\n\t\tif ( json.attenuationDistance !== undefined ) material.attenuationDistance = json.attenuationDistance;\n\t\tif ( json.attenuationColor !== undefined && material.attenuationColor !== undefined ) material.attenuationColor.setHex( json.attenuationColor );\n\t\tif ( json.fog !== undefined ) material.fog = json.fog;\n\t\tif ( json.flatShading !== undefined ) material.flatShading = json.flatShading;\n\t\tif ( json.blending !== undefined ) material.blending = json.blending;\n\t\tif ( json.combine !== undefined ) material.combine = json.combine;\n\t\tif ( json.side !== undefined ) material.side = json.side;\n\t\tif ( json.shadowSide !== undefined ) material.shadowSide = json.shadowSide;\n\t\tif ( json.opacity !== undefined ) material.opacity = json.opacity;\n\t\tif ( json.transparent !== undefined ) material.transparent = json.transparent;\n\t\tif ( json.alphaTest !== undefined ) material.alphaTest = json.alphaTest;\n\t\tif ( json.depthTest !== undefined ) material.depthTest = json.depthTest;\n\t\tif ( json.depthWrite !== undefined ) material.depthWrite = json.depthWrite;\n\t\tif ( json.colorWrite !== undefined ) material.colorWrite = json.colorWrite;\n\n\t\tif ( json.stencilWrite !== undefined ) material.stencilWrite = json.stencilWrite;\n\t\tif ( json.stencilWriteMask !== undefined ) material.stencilWriteMask = json.stencilWriteMask;\n\t\tif ( json.stencilFunc !== undefined ) material.stencilFunc = json.stencilFunc;\n\t\tif ( json.stencilRef !== undefined ) material.stencilRef = json.stencilRef;\n\t\tif ( json.stencilFuncMask !== undefined ) material.stencilFuncMask = json.stencilFuncMask;\n\t\tif ( json.stencilFail !== undefined ) material.stencilFail = json.stencilFail;\n\t\tif ( json.stencilZFail !== undefined ) material.stencilZFail = json.stencilZFail;\n\t\tif ( json.stencilZPass !== undefined ) material.stencilZPass = json.stencilZPass;\n\n\t\tif ( json.wireframe !== undefined ) material.wireframe = json.wireframe;\n\t\tif ( json.wireframeLinewidth !== undefined ) material.wireframeLinewidth = json.wireframeLinewidth;\n\t\tif ( json.wireframeLinecap !== undefined ) material.wireframeLinecap = json.wireframeLinecap;\n\t\tif ( json.wireframeLinejoin !== undefined ) material.wireframeLinejoin = json.wireframeLinejoin;\n\n\t\tif ( json.rotation !== undefined ) material.rotation = json.rotation;\n\n\t\tif ( json.linewidth !== 1 ) material.linewidth = json.linewidth;\n\t\tif ( json.dashSize !== undefined ) material.dashSize = json.dashSize;\n\t\tif ( json.gapSize !== undefined ) material.gapSize = json.gapSize;\n\t\tif ( json.scale !== undefined ) material.scale = json.scale;\n\n\t\tif ( json.polygonOffset !== undefined ) material.polygonOffset = json.polygonOffset;\n\t\tif ( json.polygonOffsetFactor !== undefined ) material.polygonOffsetFactor = json.polygonOffsetFactor;\n\t\tif ( json.polygonOffsetUnits !== undefined ) material.polygonOffsetUnits = json.polygonOffsetUnits;\n\n\t\tif ( json.dithering !== undefined ) material.dithering = json.dithering;\n\n\t\tif ( json.alphaToCoverage !== undefined ) material.alphaToCoverage = json.alphaToCoverage;\n\t\tif ( json.premultipliedAlpha !== undefined ) material.premultipliedAlpha = json.premultipliedAlpha;\n\n\t\tif ( json.visible !== undefined ) material.visible = json.visible;\n\n\t\tif ( json.toneMapped !== undefined ) material.toneMapped = json.toneMapped;\n\n\t\tif ( json.userData !== undefined ) material.userData = json.userData;\n\n\t\tif ( json.vertexColors !== undefined ) {\n\n\t\t\tif ( typeof json.vertexColors === 'number' ) {\n\n\t\t\t\tmaterial.vertexColors = ( json.vertexColors > 0 ) ? true : false;\n\n\t\t\t} else {\n\n\t\t\t\tmaterial.vertexColors = json.vertexColors;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Shader Material\n\n\t\tif ( json.uniforms !== undefined ) {\n\n\t\t\tfor ( const name in json.uniforms ) {\n\n\t\t\t\tconst uniform = json.uniforms[ name ];\n\n\t\t\t\tmaterial.uniforms[ name ] = {};\n\n\t\t\t\tswitch ( uniform.type ) {\n\n\t\t\t\t\tcase 't':\n\t\t\t\t\t\tmaterial.uniforms[ name ].value = getTexture( uniform.value );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'c':\n\t\t\t\t\t\tmaterial.uniforms[ name ].value = new Color().setHex( uniform.value );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'v2':\n\t\t\t\t\t\tmaterial.uniforms[ name ].value = new Vector2().fromArray( uniform.value );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'v3':\n\t\t\t\t\t\tmaterial.uniforms[ name ].value = new Vector3().fromArray( uniform.value );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'v4':\n\t\t\t\t\t\tmaterial.uniforms[ name ].value = new Vector4().fromArray( uniform.value );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'm3':\n\t\t\t\t\t\tmaterial.uniforms[ name ].value = new Matrix3().fromArray( uniform.value );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'm4':\n\t\t\t\t\t\tmaterial.uniforms[ name ].value = new Matrix4().fromArray( uniform.value );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tmaterial.uniforms[ name ].value = uniform.value;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( json.defines !== undefined ) material.defines = json.defines;\n\t\tif ( json.vertexShader !== undefined ) material.vertexShader = json.vertexShader;\n\t\tif ( json.fragmentShader !== undefined ) material.fragmentShader = json.fragmentShader;\n\t\tif ( json.glslVersion !== undefined ) material.glslVersion = json.glslVersion;\n\n\t\tif ( json.extensions !== undefined ) {\n\n\t\t\tfor ( const key in json.extensions ) {\n\n\t\t\t\tmaterial.extensions[ key ] = json.extensions[ key ];\n\n\t\t\t}\n\n\t\t}\n\n\t\t// for PointsMaterial\n\n\t\tif ( json.size !== undefined ) material.size = json.size;\n\t\tif ( json.sizeAttenuation !== undefined ) material.sizeAttenuation = json.sizeAttenuation;\n\n\t\t// maps\n\n\t\tif ( json.map !== undefined ) material.map = getTexture( json.map );\n\t\tif ( json.matcap !== undefined ) material.matcap = getTexture( json.matcap );\n\n\t\tif ( json.alphaMap !== undefined ) material.alphaMap = getTexture( json.alphaMap );\n\n\t\tif ( json.bumpMap !== undefined ) material.bumpMap = getTexture( json.bumpMap );\n\t\tif ( json.bumpScale !== undefined ) material.bumpScale = json.bumpScale;\n\n\t\tif ( json.normalMap !== undefined ) material.normalMap = getTexture( json.normalMap );\n\t\tif ( json.normalMapType !== undefined ) material.normalMapType = json.normalMapType;\n\t\tif ( json.normalScale !== undefined ) {\n\n\t\t\tlet normalScale = json.normalScale;\n\n\t\t\tif ( Array.isArray( normalScale ) === false ) {\n\n\t\t\t\t// Blender exporter used to export a scalar. See #7459\n\n\t\t\t\tnormalScale = [ normalScale, normalScale ];\n\n\t\t\t}\n\n\t\t\tmaterial.normalScale = new Vector2().fromArray( normalScale );\n\n\t\t}\n\n\t\tif ( json.displacementMap !== undefined ) material.displacementMap = getTexture( json.displacementMap );\n\t\tif ( json.displacementScale !== undefined ) material.displacementScale = json.displacementScale;\n\t\tif ( json.displacementBias !== undefined ) material.displacementBias = json.displacementBias;\n\n\t\tif ( json.roughnessMap !== undefined ) material.roughnessMap = getTexture( json.roughnessMap );\n\t\tif ( json.metalnessMap !== undefined ) material.metalnessMap = getTexture( json.metalnessMap );\n\n\t\tif ( json.emissiveMap !== undefined ) material.emissiveMap = getTexture( json.emissiveMap );\n\t\tif ( json.emissiveIntensity !== undefined ) material.emissiveIntensity = json.emissiveIntensity;\n\n\t\tif ( json.specularMap !== undefined ) material.specularMap = getTexture( json.specularMap );\n\t\tif ( json.specularIntensityMap !== undefined ) material.specularIntensityMap = getTexture( json.specularIntensityMap );\n\t\tif ( json.specularColorMap !== undefined ) material.specularColorMap = getTexture( json.specularColorMap );\n\n\t\tif ( json.envMap !== undefined ) material.envMap = getTexture( json.envMap );\n\t\tif ( json.envMapIntensity !== undefined ) material.envMapIntensity = json.envMapIntensity;\n\n\t\tif ( json.reflectivity !== undefined ) material.reflectivity = json.reflectivity;\n\t\tif ( json.refractionRatio !== undefined ) material.refractionRatio = json.refractionRatio;\n\n\t\tif ( json.lightMap !== undefined ) material.lightMap = getTexture( json.lightMap );\n\t\tif ( json.lightMapIntensity !== undefined ) material.lightMapIntensity = json.lightMapIntensity;\n\n\t\tif ( json.aoMap !== undefined ) material.aoMap = getTexture( json.aoMap );\n\t\tif ( json.aoMapIntensity !== undefined ) material.aoMapIntensity = json.aoMapIntensity;\n\n\t\tif ( json.gradientMap !== undefined ) material.gradientMap = getTexture( json.gradientMap );\n\n\t\tif ( json.clearcoatMap !== undefined ) material.clearcoatMap = getTexture( json.clearcoatMap );\n\t\tif ( json.clearcoatRoughnessMap !== undefined ) material.clearcoatRoughnessMap = getTexture( json.clearcoatRoughnessMap );\n\t\tif ( json.clearcoatNormalMap !== undefined ) material.clearcoatNormalMap = getTexture( json.clearcoatNormalMap );\n\t\tif ( json.clearcoatNormalScale !== undefined ) material.clearcoatNormalScale = new Vector2().fromArray( json.clearcoatNormalScale );\n\n\t\tif ( json.iridescenceMap !== undefined ) material.iridescenceMap = getTexture( json.iridescenceMap );\n\t\tif ( json.iridescenceThicknessMap !== undefined ) material.iridescenceThicknessMap = getTexture( json.iridescenceThicknessMap );\n\n\t\tif ( json.transmissionMap !== undefined ) material.transmissionMap = getTexture( json.transmissionMap );\n\t\tif ( json.thicknessMap !== undefined ) material.thicknessMap = getTexture( json.thicknessMap );\n\n\t\tif ( json.sheenColorMap !== undefined ) material.sheenColorMap = getTexture( json.sheenColorMap );\n\t\tif ( json.sheenRoughnessMap !== undefined ) material.sheenRoughnessMap = getTexture( json.sheenRoughnessMap );\n\n\t\treturn material;\n\n\t}\n\n\tsetTextures( value ) {\n\n\t\tthis.textures = value;\n\t\treturn this;\n\n\t}\n\n\tstatic createMaterialFromType( type ) {\n\n\t\tconst materialLib = {\n\t\t\tShadowMaterial,\n\t\t\tSpriteMaterial,\n\t\t\tRawShaderMaterial,\n\t\t\tShaderMaterial,\n\t\t\tPointsMaterial,\n\t\t\tMeshPhysicalMaterial,\n\t\t\tMeshStandardMaterial,\n\t\t\tMeshPhongMaterial,\n\t\t\tMeshToonMaterial,\n\t\t\tMeshNormalMaterial,\n\t\t\tMeshLambertMaterial,\n\t\t\tMeshDepthMaterial,\n\t\t\tMeshDistanceMaterial,\n\t\t\tMeshBasicMaterial,\n\t\t\tMeshMatcapMaterial,\n\t\t\tLineDashedMaterial,\n\t\t\tLineBasicMaterial,\n\t\t\tMaterial\n\t\t};\n\n\t\treturn new materialLib[ type ]();\n\n\t}\n\n}\n\nclass LoaderUtils {\n\n\tstatic decodeText( array ) {\n\n\t\tif ( typeof TextDecoder !== 'undefined' ) {\n\n\t\t\treturn new TextDecoder().decode( array );\n\n\t\t}\n\n\t\t// Avoid the String.fromCharCode.apply(null, array) shortcut, which\n\t\t// throws a \"maximum call stack size exceeded\" error for large arrays.\n\n\t\tlet s = '';\n\n\t\tfor ( let i = 0, il = array.length; i < il; i ++ ) {\n\n\t\t\t// Implicitly assumes little-endian.\n\t\t\ts += String.fromCharCode( array[ i ] );\n\n\t\t}\n\n\t\ttry {\n\n\t\t\t// merges multi-byte utf-8 characters.\n\n\t\t\treturn decodeURIComponent( escape( s ) );\n\n\t\t} catch ( e ) { // see #16358\n\n\t\t\treturn s;\n\n\t\t}\n\n\t}\n\n\tstatic extractUrlBase( url ) {\n\n\t\tconst index = url.lastIndexOf( '/' );\n\n\t\tif ( index === - 1 ) return './';\n\n\t\treturn url.slice( 0, index + 1 );\n\n\t}\n\n\tstatic resolveURL( url, path ) {\n\n\t\t// Invalid URL\n\t\tif ( typeof url !== 'string' || url === '' ) return '';\n\n\t\t// Host Relative URL\n\t\tif ( /^https?:\\/\\//i.test( path ) && /^\\//.test( url ) ) {\n\n\t\t\tpath = path.replace( /(^https?:\\/\\/[^\\/]+).*/i, '$1' );\n\n\t\t}\n\n\t\t// Absolute URL http://,https://,//\n\t\tif ( /^(https?:)?\\/\\//i.test( url ) ) return url;\n\n\t\t// Data URI\n\t\tif ( /^data:.*,.*$/i.test( url ) ) return url;\n\n\t\t// Blob URL\n\t\tif ( /^blob:.*$/i.test( url ) ) return url;\n\n\t\t// Relative URL\n\t\treturn path + url;\n\n\t}\n\n}\n\nclass InstancedBufferGeometry extends BufferGeometry {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.isInstancedBufferGeometry = true;\n\n\t\tthis.type = 'InstancedBufferGeometry';\n\t\tthis.instanceCount = Infinity;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.instanceCount = source.instanceCount;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.instanceCount = this.instanceCount;\n\n\t\tdata.isInstancedBufferGeometry = true;\n\n\t\treturn data;\n\n\t}\n\n}\n\nclass BufferGeometryLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tconst loader = new FileLoader( scope.manager );\n\t\tloader.setPath( scope.path );\n\t\tloader.setRequestHeader( scope.requestHeader );\n\t\tloader.setWithCredentials( scope.withCredentials );\n\t\tloader.load( url, function ( text ) {\n\n\t\t\ttry {\n\n\t\t\t\tonLoad( scope.parse( JSON.parse( text ) ) );\n\n\t\t\t} catch ( e ) {\n\n\t\t\t\tif ( onError ) {\n\n\t\t\t\t\tonError( e );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( e );\n\n\t\t\t\t}\n\n\t\t\t\tscope.manager.itemError( url );\n\n\t\t\t}\n\n\t\t}, onProgress, onError );\n\n\t}\n\n\tparse( json ) {\n\n\t\tconst interleavedBufferMap = {};\n\t\tconst arrayBufferMap = {};\n\n\t\tfunction getInterleavedBuffer( json, uuid ) {\n\n\t\t\tif ( interleavedBufferMap[ uuid ] !== undefined ) return interleavedBufferMap[ uuid ];\n\n\t\t\tconst interleavedBuffers = json.interleavedBuffers;\n\t\t\tconst interleavedBuffer = interleavedBuffers[ uuid ];\n\n\t\t\tconst buffer = getArrayBuffer( json, interleavedBuffer.buffer );\n\n\t\t\tconst array = getTypedArray( interleavedBuffer.type, buffer );\n\t\t\tconst ib = new InterleavedBuffer( array, interleavedBuffer.stride );\n\t\t\tib.uuid = interleavedBuffer.uuid;\n\n\t\t\tinterleavedBufferMap[ uuid ] = ib;\n\n\t\t\treturn ib;\n\n\t\t}\n\n\t\tfunction getArrayBuffer( json, uuid ) {\n\n\t\t\tif ( arrayBufferMap[ uuid ] !== undefined ) return arrayBufferMap[ uuid ];\n\n\t\t\tconst arrayBuffers = json.arrayBuffers;\n\t\t\tconst arrayBuffer = arrayBuffers[ uuid ];\n\n\t\t\tconst ab = new Uint32Array( arrayBuffer ).buffer;\n\n\t\t\tarrayBufferMap[ uuid ] = ab;\n\n\t\t\treturn ab;\n\n\t\t}\n\n\t\tconst geometry = json.isInstancedBufferGeometry ? new InstancedBufferGeometry() : new BufferGeometry();\n\n\t\tconst index = json.data.index;\n\n\t\tif ( index !== undefined ) {\n\n\t\t\tconst typedArray = getTypedArray( index.type, index.array );\n\t\t\tgeometry.setIndex( new BufferAttribute( typedArray, 1 ) );\n\n\t\t}\n\n\t\tconst attributes = json.data.attributes;\n\n\t\tfor ( const key in attributes ) {\n\n\t\t\tconst attribute = attributes[ key ];\n\t\t\tlet bufferAttribute;\n\n\t\t\tif ( attribute.isInterleavedBufferAttribute ) {\n\n\t\t\t\tconst interleavedBuffer = getInterleavedBuffer( json.data, attribute.data );\n\t\t\t\tbufferAttribute = new InterleavedBufferAttribute( interleavedBuffer, attribute.itemSize, attribute.offset, attribute.normalized );\n\n\t\t\t} else {\n\n\t\t\t\tconst typedArray = getTypedArray( attribute.type, attribute.array );\n\t\t\t\tconst bufferAttributeConstr = attribute.isInstancedBufferAttribute ? InstancedBufferAttribute : BufferAttribute;\n\t\t\t\tbufferAttribute = new bufferAttributeConstr( typedArray, attribute.itemSize, attribute.normalized );\n\n\t\t\t}\n\n\t\t\tif ( attribute.name !== undefined ) bufferAttribute.name = attribute.name;\n\t\t\tif ( attribute.usage !== undefined ) bufferAttribute.setUsage( attribute.usage );\n\n\t\t\tif ( attribute.updateRange !== undefined ) {\n\n\t\t\t\tbufferAttribute.updateRange.offset = attribute.updateRange.offset;\n\t\t\t\tbufferAttribute.updateRange.count = attribute.updateRange.count;\n\n\t\t\t}\n\n\t\t\tgeometry.setAttribute( key, bufferAttribute );\n\n\t\t}\n\n\t\tconst morphAttributes = json.data.morphAttributes;\n\n\t\tif ( morphAttributes ) {\n\n\t\t\tfor ( const key in morphAttributes ) {\n\n\t\t\t\tconst attributeArray = morphAttributes[ key ];\n\n\t\t\t\tconst array = [];\n\n\t\t\t\tfor ( let i = 0, il = attributeArray.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst attribute = attributeArray[ i ];\n\t\t\t\t\tlet bufferAttribute;\n\n\t\t\t\t\tif ( attribute.isInterleavedBufferAttribute ) {\n\n\t\t\t\t\t\tconst interleavedBuffer = getInterleavedBuffer( json.data, attribute.data );\n\t\t\t\t\t\tbufferAttribute = new InterleavedBufferAttribute( interleavedBuffer, attribute.itemSize, attribute.offset, attribute.normalized );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tconst typedArray = getTypedArray( attribute.type, attribute.array );\n\t\t\t\t\t\tbufferAttribute = new BufferAttribute( typedArray, attribute.itemSize, attribute.normalized );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( attribute.name !== undefined ) bufferAttribute.name = attribute.name;\n\t\t\t\t\tarray.push( bufferAttribute );\n\n\t\t\t\t}\n\n\t\t\t\tgeometry.morphAttributes[ key ] = array;\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst morphTargetsRelative = json.data.morphTargetsRelative;\n\n\t\tif ( morphTargetsRelative ) {\n\n\t\t\tgeometry.morphTargetsRelative = true;\n\n\t\t}\n\n\t\tconst groups = json.data.groups || json.data.drawcalls || json.data.offsets;\n\n\t\tif ( groups !== undefined ) {\n\n\t\t\tfor ( let i = 0, n = groups.length; i !== n; ++ i ) {\n\n\t\t\t\tconst group = groups[ i ];\n\n\t\t\t\tgeometry.addGroup( group.start, group.count, group.materialIndex );\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst boundingSphere = json.data.boundingSphere;\n\n\t\tif ( boundingSphere !== undefined ) {\n\n\t\t\tconst center = new Vector3();\n\n\t\t\tif ( boundingSphere.center !== undefined ) {\n\n\t\t\t\tcenter.fromArray( boundingSphere.center );\n\n\t\t\t}\n\n\t\t\tgeometry.boundingSphere = new Sphere( center, boundingSphere.radius );\n\n\t\t}\n\n\t\tif ( json.name ) geometry.name = json.name;\n\t\tif ( json.userData ) geometry.userData = json.userData;\n\n\t\treturn geometry;\n\n\t}\n\n}\n\nclass ObjectLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tconst path = ( this.path === '' ) ? LoaderUtils.extractUrlBase( url ) : this.path;\n\t\tthis.resourcePath = this.resourcePath || path;\n\n\t\tconst loader = new FileLoader( this.manager );\n\t\tloader.setPath( this.path );\n\t\tloader.setRequestHeader( this.requestHeader );\n\t\tloader.setWithCredentials( this.withCredentials );\n\t\tloader.load( url, function ( text ) {\n\n\t\t\tlet json = null;\n\n\t\t\ttry {\n\n\t\t\t\tjson = JSON.parse( text );\n\n\t\t\t} catch ( error ) {\n\n\t\t\t\tif ( onError !== undefined ) onError( error );\n\n\t\t\t\tconsole.error( 'THREE:ObjectLoader: Can\\'t parse ' + url + '.', error.message );\n\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tconst metadata = json.metadata;\n\n\t\t\tif ( metadata === undefined || metadata.type === undefined || metadata.type.toLowerCase() === 'geometry' ) {\n\n\t\t\t\tif ( onError !== undefined ) onError( new Error( 'THREE.ObjectLoader: Can\\'t load ' + url ) );\n\n\t\t\t\tconsole.error( 'THREE.ObjectLoader: Can\\'t load ' + url );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tscope.parse( json, onLoad );\n\n\t\t}, onProgress, onError );\n\n\t}\n\n\tasync loadAsync( url, onProgress ) {\n\n\t\tconst scope = this;\n\n\t\tconst path = ( this.path === '' ) ? LoaderUtils.extractUrlBase( url ) : this.path;\n\t\tthis.resourcePath = this.resourcePath || path;\n\n\t\tconst loader = new FileLoader( this.manager );\n\t\tloader.setPath( this.path );\n\t\tloader.setRequestHeader( this.requestHeader );\n\t\tloader.setWithCredentials( this.withCredentials );\n\n\t\tconst text = await loader.loadAsync( url, onProgress );\n\n\t\tconst json = JSON.parse( text );\n\n\t\tconst metadata = json.metadata;\n\n\t\tif ( metadata === undefined || metadata.type === undefined || metadata.type.toLowerCase() === 'geometry' ) {\n\n\t\t\tthrow new Error( 'THREE.ObjectLoader: Can\\'t load ' + url );\n\n\t\t}\n\n\t\treturn await scope.parseAsync( json );\n\n\t}\n\n\tparse( json, onLoad ) {\n\n\t\tconst animations = this.parseAnimations( json.animations );\n\t\tconst shapes = this.parseShapes( json.shapes );\n\t\tconst geometries = this.parseGeometries( json.geometries, shapes );\n\n\t\tconst images = this.parseImages( json.images, function () {\n\n\t\t\tif ( onLoad !== undefined ) onLoad( object );\n\n\t\t} );\n\n\t\tconst textures = this.parseTextures( json.textures, images );\n\t\tconst materials = this.parseMaterials( json.materials, textures );\n\n\t\tconst object = this.parseObject( json.object, geometries, materials, textures, animations );\n\t\tconst skeletons = this.parseSkeletons( json.skeletons, object );\n\n\t\tthis.bindSkeletons( object, skeletons );\n\n\t\t//\n\n\t\tif ( onLoad !== undefined ) {\n\n\t\t\tlet hasImages = false;\n\n\t\t\tfor ( const uuid in images ) {\n\n\t\t\t\tif ( images[ uuid ].data instanceof HTMLImageElement ) {\n\n\t\t\t\t\thasImages = true;\n\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( hasImages === false ) onLoad( object );\n\n\t\t}\n\n\t\treturn object;\n\n\t}\n\n\tasync parseAsync( json ) {\n\n\t\tconst animations = this.parseAnimations( json.animations );\n\t\tconst shapes = this.parseShapes( json.shapes );\n\t\tconst geometries = this.parseGeometries( json.geometries, shapes );\n\n\t\tconst images = await this.parseImagesAsync( json.images );\n\n\t\tconst textures = this.parseTextures( json.textures, images );\n\t\tconst materials = this.parseMaterials( json.materials, textures );\n\n\t\tconst object = this.parseObject( json.object, geometries, materials, textures, animations );\n\t\tconst skeletons = this.parseSkeletons( json.skeletons, object );\n\n\t\tthis.bindSkeletons( object, skeletons );\n\n\t\treturn object;\n\n\t}\n\n\tparseShapes( json ) {\n\n\t\tconst shapes = {};\n\n\t\tif ( json !== undefined ) {\n\n\t\t\tfor ( let i = 0, l = json.length; i < l; i ++ ) {\n\n\t\t\t\tconst shape = new Shape().fromJSON( json[ i ] );\n\n\t\t\t\tshapes[ shape.uuid ] = shape;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn shapes;\n\n\t}\n\n\tparseSkeletons( json, object ) {\n\n\t\tconst skeletons = {};\n\t\tconst bones = {};\n\n\t\t// generate bone lookup table\n\n\t\tobject.traverse( function ( child ) {\n\n\t\t\tif ( child.isBone ) bones[ child.uuid ] = child;\n\n\t\t} );\n\n\t\t// create skeletons\n\n\t\tif ( json !== undefined ) {\n\n\t\t\tfor ( let i = 0, l = json.length; i < l; i ++ ) {\n\n\t\t\t\tconst skeleton = new Skeleton().fromJSON( json[ i ], bones );\n\n\t\t\t\tskeletons[ skeleton.uuid ] = skeleton;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn skeletons;\n\n\t}\n\n\tparseGeometries( json, shapes ) {\n\n\t\tconst geometries = {};\n\n\t\tif ( json !== undefined ) {\n\n\t\t\tconst bufferGeometryLoader = new BufferGeometryLoader();\n\n\t\t\tfor ( let i = 0, l = json.length; i < l; i ++ ) {\n\n\t\t\t\tlet geometry;\n\t\t\t\tconst data = json[ i ];\n\n\t\t\t\tswitch ( data.type ) {\n\n\t\t\t\t\tcase 'BufferGeometry':\n\t\t\t\t\tcase 'InstancedBufferGeometry':\n\n\t\t\t\t\t\tgeometry = bufferGeometryLoader.parse( data );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tif ( data.type in Geometries ) {\n\n\t\t\t\t\t\t\tgeometry = Geometries[ data.type ].fromJSON( data, shapes );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tconsole.warn( `THREE.ObjectLoader: Unsupported geometry type \"${ data.type }\"` );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tgeometry.uuid = data.uuid;\n\n\t\t\t\tif ( data.name !== undefined ) geometry.name = data.name;\n\t\t\t\tif ( geometry.isBufferGeometry === true && data.userData !== undefined ) geometry.userData = data.userData;\n\n\t\t\t\tgeometries[ data.uuid ] = geometry;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn geometries;\n\n\t}\n\n\tparseMaterials( json, textures ) {\n\n\t\tconst cache = {}; // MultiMaterial\n\t\tconst materials = {};\n\n\t\tif ( json !== undefined ) {\n\n\t\t\tconst loader = new MaterialLoader();\n\t\t\tloader.setTextures( textures );\n\n\t\t\tfor ( let i = 0, l = json.length; i < l; i ++ ) {\n\n\t\t\t\tconst data = json[ i ];\n\n\t\t\t\tif ( cache[ data.uuid ] === undefined ) {\n\n\t\t\t\t\tcache[ data.uuid ] = loader.parse( data );\n\n\t\t\t\t}\n\n\t\t\t\tmaterials[ data.uuid ] = cache[ data.uuid ];\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn materials;\n\n\t}\n\n\tparseAnimations( json ) {\n\n\t\tconst animations = {};\n\n\t\tif ( json !== undefined ) {\n\n\t\t\tfor ( let i = 0; i < json.length; i ++ ) {\n\n\t\t\t\tconst data = json[ i ];\n\n\t\t\t\tconst clip = AnimationClip.parse( data );\n\n\t\t\t\tanimations[ clip.uuid ] = clip;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn animations;\n\n\t}\n\n\tparseImages( json, onLoad ) {\n\n\t\tconst scope = this;\n\t\tconst images = {};\n\n\t\tlet loader;\n\n\t\tfunction loadImage( url ) {\n\n\t\t\tscope.manager.itemStart( url );\n\n\t\t\treturn loader.load( url, function () {\n\n\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t}, undefined, function () {\n\n\t\t\t\tscope.manager.itemError( url );\n\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t} );\n\n\t\t}\n\n\t\tfunction deserializeImage( image ) {\n\n\t\t\tif ( typeof image === 'string' ) {\n\n\t\t\t\tconst url = image;\n\n\t\t\t\tconst path = /^(\\/\\/)|([a-z]+:(\\/\\/)?)/i.test( url ) ? url : scope.resourcePath + url;\n\n\t\t\t\treturn loadImage( path );\n\n\t\t\t} else {\n\n\t\t\t\tif ( image.data ) {\n\n\t\t\t\t\treturn {\n\t\t\t\t\t\tdata: getTypedArray( image.type, image.data ),\n\t\t\t\t\t\twidth: image.width,\n\t\t\t\t\t\theight: image.height\n\t\t\t\t\t};\n\n\t\t\t\t} else {\n\n\t\t\t\t\treturn null;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( json !== undefined && json.length > 0 ) {\n\n\t\t\tconst manager = new LoadingManager( onLoad );\n\n\t\t\tloader = new ImageLoader( manager );\n\t\t\tloader.setCrossOrigin( this.crossOrigin );\n\n\t\t\tfor ( let i = 0, il = json.length; i < il; i ++ ) {\n\n\t\t\t\tconst image = json[ i ];\n\t\t\t\tconst url = image.url;\n\n\t\t\t\tif ( Array.isArray( url ) ) {\n\n\t\t\t\t\t// load array of images e.g CubeTexture\n\n\t\t\t\t\tconst imageArray = [];\n\n\t\t\t\t\tfor ( let j = 0, jl = url.length; j < jl; j ++ ) {\n\n\t\t\t\t\t\tconst currentUrl = url[ j ];\n\n\t\t\t\t\t\tconst deserializedImage = deserializeImage( currentUrl );\n\n\t\t\t\t\t\tif ( deserializedImage !== null ) {\n\n\t\t\t\t\t\t\tif ( deserializedImage instanceof HTMLImageElement ) {\n\n\t\t\t\t\t\t\t\timageArray.push( deserializedImage );\n\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\t// special case: handle array of data textures for cube textures\n\n\t\t\t\t\t\t\t\timageArray.push( new DataTexture( deserializedImage.data, deserializedImage.width, deserializedImage.height ) );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\timages[ image.uuid ] = new Source( imageArray );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// load single image\n\n\t\t\t\t\tconst deserializedImage = deserializeImage( image.url );\n\t\t\t\t\timages[ image.uuid ] = new Source( deserializedImage );\n\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn images;\n\n\t}\n\n\tasync parseImagesAsync( json ) {\n\n\t\tconst scope = this;\n\t\tconst images = {};\n\n\t\tlet loader;\n\n\t\tasync function deserializeImage( image ) {\n\n\t\t\tif ( typeof image === 'string' ) {\n\n\t\t\t\tconst url = image;\n\n\t\t\t\tconst path = /^(\\/\\/)|([a-z]+:(\\/\\/)?)/i.test( url ) ? url : scope.resourcePath + url;\n\n\t\t\t\treturn await loader.loadAsync( path );\n\n\t\t\t} else {\n\n\t\t\t\tif ( image.data ) {\n\n\t\t\t\t\treturn {\n\t\t\t\t\t\tdata: getTypedArray( image.type, image.data ),\n\t\t\t\t\t\twidth: image.width,\n\t\t\t\t\t\theight: image.height\n\t\t\t\t\t};\n\n\t\t\t\t} else {\n\n\t\t\t\t\treturn null;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( json !== undefined && json.length > 0 ) {\n\n\t\t\tloader = new ImageLoader( this.manager );\n\t\t\tloader.setCrossOrigin( this.crossOrigin );\n\n\t\t\tfor ( let i = 0, il = json.length; i < il; i ++ ) {\n\n\t\t\t\tconst image = json[ i ];\n\t\t\t\tconst url = image.url;\n\n\t\t\t\tif ( Array.isArray( url ) ) {\n\n\t\t\t\t\t// load array of images e.g CubeTexture\n\n\t\t\t\t\tconst imageArray = [];\n\n\t\t\t\t\tfor ( let j = 0, jl = url.length; j < jl; j ++ ) {\n\n\t\t\t\t\t\tconst currentUrl = url[ j ];\n\n\t\t\t\t\t\tconst deserializedImage = await deserializeImage( currentUrl );\n\n\t\t\t\t\t\tif ( deserializedImage !== null ) {\n\n\t\t\t\t\t\t\tif ( deserializedImage instanceof HTMLImageElement ) {\n\n\t\t\t\t\t\t\t\timageArray.push( deserializedImage );\n\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\t// special case: handle array of data textures for cube textures\n\n\t\t\t\t\t\t\t\timageArray.push( new DataTexture( deserializedImage.data, deserializedImage.width, deserializedImage.height ) );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\timages[ image.uuid ] = new Source( imageArray );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// load single image\n\n\t\t\t\t\tconst deserializedImage = await deserializeImage( image.url );\n\t\t\t\t\timages[ image.uuid ] = new Source( deserializedImage );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn images;\n\n\t}\n\n\tparseTextures( json, images ) {\n\n\t\tfunction parseConstant( value, type ) {\n\n\t\t\tif ( typeof value === 'number' ) return value;\n\n\t\t\tconsole.warn( 'THREE.ObjectLoader.parseTexture: Constant should be in numeric form.', value );\n\n\t\t\treturn type[ value ];\n\n\t\t}\n\n\t\tconst textures = {};\n\n\t\tif ( json !== undefined ) {\n\n\t\t\tfor ( let i = 0, l = json.length; i < l; i ++ ) {\n\n\t\t\t\tconst data = json[ i ];\n\n\t\t\t\tif ( data.image === undefined ) {\n\n\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: No \"image\" specified for', data.uuid );\n\n\t\t\t\t}\n\n\t\t\t\tif ( images[ data.image ] === undefined ) {\n\n\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Undefined image', data.image );\n\n\t\t\t\t}\n\n\t\t\t\tconst source = images[ data.image ];\n\t\t\t\tconst image = source.data;\n\n\t\t\t\tlet texture;\n\n\t\t\t\tif ( Array.isArray( image ) ) {\n\n\t\t\t\t\ttexture = new CubeTexture();\n\n\t\t\t\t\tif ( image.length === 6 ) texture.needsUpdate = true;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( image && image.data ) {\n\n\t\t\t\t\t\ttexture = new DataTexture();\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\ttexture = new Texture();\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( image ) texture.needsUpdate = true; // textures can have undefined image data\n\n\t\t\t\t}\n\n\t\t\t\ttexture.source = source;\n\n\t\t\t\ttexture.uuid = data.uuid;\n\n\t\t\t\tif ( data.name !== undefined ) texture.name = data.name;\n\n\t\t\t\tif ( data.mapping !== undefined ) texture.mapping = parseConstant( data.mapping, TEXTURE_MAPPING );\n\n\t\t\t\tif ( data.offset !== undefined ) texture.offset.fromArray( data.offset );\n\t\t\t\tif ( data.repeat !== undefined ) texture.repeat.fromArray( data.repeat );\n\t\t\t\tif ( data.center !== undefined ) texture.center.fromArray( data.center );\n\t\t\t\tif ( data.rotation !== undefined ) texture.rotation = data.rotation;\n\n\t\t\t\tif ( data.wrap !== undefined ) {\n\n\t\t\t\t\ttexture.wrapS = parseConstant( data.wrap[ 0 ], TEXTURE_WRAPPING );\n\t\t\t\t\ttexture.wrapT = parseConstant( data.wrap[ 1 ], TEXTURE_WRAPPING );\n\n\t\t\t\t}\n\n\t\t\t\tif ( data.format !== undefined ) texture.format = data.format;\n\t\t\t\tif ( data.type !== undefined ) texture.type = data.type;\n\t\t\t\tif ( data.encoding !== undefined ) texture.encoding = data.encoding;\n\n\t\t\t\tif ( data.minFilter !== undefined ) texture.minFilter = parseConstant( data.minFilter, TEXTURE_FILTER );\n\t\t\t\tif ( data.magFilter !== undefined ) texture.magFilter = parseConstant( data.magFilter, TEXTURE_FILTER );\n\t\t\t\tif ( data.anisotropy !== undefined ) texture.anisotropy = data.anisotropy;\n\n\t\t\t\tif ( data.flipY !== undefined ) texture.flipY = data.flipY;\n\n\t\t\t\tif ( data.generateMipmaps !== undefined ) texture.generateMipmaps = data.generateMipmaps;\n\t\t\t\tif ( data.premultiplyAlpha !== undefined ) texture.premultiplyAlpha = data.premultiplyAlpha;\n\t\t\t\tif ( data.unpackAlignment !== undefined ) texture.unpackAlignment = data.unpackAlignment;\n\n\t\t\t\tif ( data.userData !== undefined ) texture.userData = data.userData;\n\n\t\t\t\ttextures[ data.uuid ] = texture;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn textures;\n\n\t}\n\n\tparseObject( data, geometries, materials, textures, animations ) {\n\n\t\tlet object;\n\n\t\tfunction getGeometry( name ) {\n\n\t\t\tif ( geometries[ name ] === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Undefined geometry', name );\n\n\t\t\t}\n\n\t\t\treturn geometries[ name ];\n\n\t\t}\n\n\t\tfunction getMaterial( name ) {\n\n\t\t\tif ( name === undefined ) return undefined;\n\n\t\t\tif ( Array.isArray( name ) ) {\n\n\t\t\t\tconst array = [];\n\n\t\t\t\tfor ( let i = 0, l = name.length; i < l; i ++ ) {\n\n\t\t\t\t\tconst uuid = name[ i ];\n\n\t\t\t\t\tif ( materials[ uuid ] === undefined ) {\n\n\t\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Undefined material', uuid );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tarray.push( materials[ uuid ] );\n\n\t\t\t\t}\n\n\t\t\t\treturn array;\n\n\t\t\t}\n\n\t\t\tif ( materials[ name ] === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Undefined material', name );\n\n\t\t\t}\n\n\t\t\treturn materials[ name ];\n\n\t\t}\n\n\t\tfunction getTexture( uuid ) {\n\n\t\t\tif ( textures[ uuid ] === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Undefined texture', uuid );\n\n\t\t\t}\n\n\t\t\treturn textures[ uuid ];\n\n\t\t}\n\n\t\tlet geometry, material;\n\n\t\tswitch ( data.type ) {\n\n\t\t\tcase 'Scene':\n\n\t\t\t\tobject = new Scene();\n\n\t\t\t\tif ( data.background !== undefined ) {\n\n\t\t\t\t\tif ( Number.isInteger( data.background ) ) {\n\n\t\t\t\t\t\tobject.background = new Color( data.background );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tobject.background = getTexture( data.background );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( data.environment !== undefined ) {\n\n\t\t\t\t\tobject.environment = getTexture( data.environment );\n\n\t\t\t\t}\n\n\t\t\t\tif ( data.fog !== undefined ) {\n\n\t\t\t\t\tif ( data.fog.type === 'Fog' ) {\n\n\t\t\t\t\t\tobject.fog = new Fog( data.fog.color, data.fog.near, data.fog.far );\n\n\t\t\t\t\t} else if ( data.fog.type === 'FogExp2' ) {\n\n\t\t\t\t\t\tobject.fog = new FogExp2( data.fog.color, data.fog.density );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( data.backgroundBlurriness !== undefined ) object.backgroundBlurriness = data.backgroundBlurriness;\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'PerspectiveCamera':\n\n\t\t\t\tobject = new PerspectiveCamera( data.fov, data.aspect, data.near, data.far );\n\n\t\t\t\tif ( data.focus !== undefined ) object.focus = data.focus;\n\t\t\t\tif ( data.zoom !== undefined ) object.zoom = data.zoom;\n\t\t\t\tif ( data.filmGauge !== undefined ) object.filmGauge = data.filmGauge;\n\t\t\t\tif ( data.filmOffset !== undefined ) object.filmOffset = data.filmOffset;\n\t\t\t\tif ( data.view !== undefined ) object.view = Object.assign( {}, data.view );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'OrthographicCamera':\n\n\t\t\t\tobject = new OrthographicCamera( data.left, data.right, data.top, data.bottom, data.near, data.far );\n\n\t\t\t\tif ( data.zoom !== undefined ) object.zoom = data.zoom;\n\t\t\t\tif ( data.view !== undefined ) object.view = Object.assign( {}, data.view );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'AmbientLight':\n\n\t\t\t\tobject = new AmbientLight( data.color, data.intensity );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'DirectionalLight':\n\n\t\t\t\tobject = new DirectionalLight( data.color, data.intensity );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'PointLight':\n\n\t\t\t\tobject = new PointLight( data.color, data.intensity, data.distance, data.decay );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'RectAreaLight':\n\n\t\t\t\tobject = new RectAreaLight( data.color, data.intensity, data.width, data.height );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'SpotLight':\n\n\t\t\t\tobject = new SpotLight( data.color, data.intensity, data.distance, data.angle, data.penumbra, data.decay );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'HemisphereLight':\n\n\t\t\t\tobject = new HemisphereLight( data.color, data.groundColor, data.intensity );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'LightProbe':\n\n\t\t\t\tobject = new LightProbe().fromJSON( data );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'SkinnedMesh':\n\n\t\t\t\tgeometry = getGeometry( data.geometry );\n\t\t\t \tmaterial = getMaterial( data.material );\n\n\t\t\t\tobject = new SkinnedMesh( geometry, material );\n\n\t\t\t\tif ( data.bindMode !== undefined ) object.bindMode = data.bindMode;\n\t\t\t\tif ( data.bindMatrix !== undefined ) object.bindMatrix.fromArray( data.bindMatrix );\n\t\t\t\tif ( data.skeleton !== undefined ) object.skeleton = data.skeleton;\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'Mesh':\n\n\t\t\t\tgeometry = getGeometry( data.geometry );\n\t\t\t\tmaterial = getMaterial( data.material );\n\n\t\t\t\tobject = new Mesh( geometry, material );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'InstancedMesh':\n\n\t\t\t\tgeometry = getGeometry( data.geometry );\n\t\t\t\tmaterial = getMaterial( data.material );\n\t\t\t\tconst count = data.count;\n\t\t\t\tconst instanceMatrix = data.instanceMatrix;\n\t\t\t\tconst instanceColor = data.instanceColor;\n\n\t\t\t\tobject = new InstancedMesh( geometry, material, count );\n\t\t\t\tobject.instanceMatrix = new InstancedBufferAttribute( new Float32Array( instanceMatrix.array ), 16 );\n\t\t\t\tif ( instanceColor !== undefined ) object.instanceColor = new InstancedBufferAttribute( new Float32Array( instanceColor.array ), instanceColor.itemSize );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'LOD':\n\n\t\t\t\tobject = new LOD();\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'Line':\n\n\t\t\t\tobject = new Line( getGeometry( data.geometry ), getMaterial( data.material ) );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'LineLoop':\n\n\t\t\t\tobject = new LineLoop( getGeometry( data.geometry ), getMaterial( data.material ) );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'LineSegments':\n\n\t\t\t\tobject = new LineSegments( getGeometry( data.geometry ), getMaterial( data.material ) );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'PointCloud':\n\t\t\tcase 'Points':\n\n\t\t\t\tobject = new Points( getGeometry( data.geometry ), getMaterial( data.material ) );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'Sprite':\n\n\t\t\t\tobject = new Sprite( getMaterial( data.material ) );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'Group':\n\n\t\t\t\tobject = new Group();\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'Bone':\n\n\t\t\t\tobject = new Bone();\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tobject = new Object3D();\n\n\t\t}\n\n\t\tobject.uuid = data.uuid;\n\n\t\tif ( data.name !== undefined ) object.name = data.name;\n\n\t\tif ( data.matrix !== undefined ) {\n\n\t\t\tobject.matrix.fromArray( data.matrix );\n\n\t\t\tif ( data.matrixAutoUpdate !== undefined ) object.matrixAutoUpdate = data.matrixAutoUpdate;\n\t\t\tif ( object.matrixAutoUpdate ) object.matrix.decompose( object.position, object.quaternion, object.scale );\n\n\t\t} else {\n\n\t\t\tif ( data.position !== undefined ) object.position.fromArray( data.position );\n\t\t\tif ( data.rotation !== undefined ) object.rotation.fromArray( data.rotation );\n\t\t\tif ( data.quaternion !== undefined ) object.quaternion.fromArray( data.quaternion );\n\t\t\tif ( data.scale !== undefined ) object.scale.fromArray( data.scale );\n\n\t\t}\n\n\t\tif ( data.castShadow !== undefined ) object.castShadow = data.castShadow;\n\t\tif ( data.receiveShadow !== undefined ) object.receiveShadow = data.receiveShadow;\n\n\t\tif ( data.shadow ) {\n\n\t\t\tif ( data.shadow.bias !== undefined ) object.shadow.bias = data.shadow.bias;\n\t\t\tif ( data.shadow.normalBias !== undefined ) object.shadow.normalBias = data.shadow.normalBias;\n\t\t\tif ( data.shadow.radius !== undefined ) object.shadow.radius = data.shadow.radius;\n\t\t\tif ( data.shadow.mapSize !== undefined ) object.shadow.mapSize.fromArray( data.shadow.mapSize );\n\t\t\tif ( data.shadow.camera !== undefined ) object.shadow.camera = this.parseObject( data.shadow.camera );\n\n\t\t}\n\n\t\tif ( data.visible !== undefined ) object.visible = data.visible;\n\t\tif ( data.frustumCulled !== undefined ) object.frustumCulled = data.frustumCulled;\n\t\tif ( data.renderOrder !== undefined ) object.renderOrder = data.renderOrder;\n\t\tif ( data.userData !== undefined ) object.userData = data.userData;\n\t\tif ( data.layers !== undefined ) object.layers.mask = data.layers;\n\n\t\tif ( data.children !== undefined ) {\n\n\t\t\tconst children = data.children;\n\n\t\t\tfor ( let i = 0; i < children.length; i ++ ) {\n\n\t\t\t\tobject.add( this.parseObject( children[ i ], geometries, materials, textures, animations ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( data.animations !== undefined ) {\n\n\t\t\tconst objectAnimations = data.animations;\n\n\t\t\tfor ( let i = 0; i < objectAnimations.length; i ++ ) {\n\n\t\t\t\tconst uuid = objectAnimations[ i ];\n\n\t\t\t\tobject.animations.push( animations[ uuid ] );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( data.type === 'LOD' ) {\n\n\t\t\tif ( data.autoUpdate !== undefined ) object.autoUpdate = data.autoUpdate;\n\n\t\t\tconst levels = data.levels;\n\n\t\t\tfor ( let l = 0; l < levels.length; l ++ ) {\n\n\t\t\t\tconst level = levels[ l ];\n\t\t\t\tconst child = object.getObjectByProperty( 'uuid', level.object );\n\n\t\t\t\tif ( child !== undefined ) {\n\n\t\t\t\t\tobject.addLevel( child, level.distance, level.hysteresis );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn object;\n\n\t}\n\n\tbindSkeletons( object, skeletons ) {\n\n\t\tif ( Object.keys( skeletons ).length === 0 ) return;\n\n\t\tobject.traverse( function ( child ) {\n\n\t\t\tif ( child.isSkinnedMesh === true && child.skeleton !== undefined ) {\n\n\t\t\t\tconst skeleton = skeletons[ child.skeleton ];\n\n\t\t\t\tif ( skeleton === undefined ) {\n\n\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: No skeleton found with UUID:', child.skeleton );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tchild.bind( skeleton, child.bindMatrix );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} );\n\n\t}\n\n}\n\nconst TEXTURE_MAPPING = {\n\tUVMapping: UVMapping,\n\tCubeReflectionMapping: CubeReflectionMapping,\n\tCubeRefractionMapping: CubeRefractionMapping,\n\tEquirectangularReflectionMapping: EquirectangularReflectionMapping,\n\tEquirectangularRefractionMapping: EquirectangularRefractionMapping,\n\tCubeUVReflectionMapping: CubeUVReflectionMapping\n};\n\nconst TEXTURE_WRAPPING = {\n\tRepeatWrapping: RepeatWrapping,\n\tClampToEdgeWrapping: ClampToEdgeWrapping,\n\tMirroredRepeatWrapping: MirroredRepeatWrapping\n};\n\nconst TEXTURE_FILTER = {\n\tNearestFilter: NearestFilter,\n\tNearestMipmapNearestFilter: NearestMipmapNearestFilter,\n\tNearestMipmapLinearFilter: NearestMipmapLinearFilter,\n\tLinearFilter: LinearFilter,\n\tLinearMipmapNearestFilter: LinearMipmapNearestFilter,\n\tLinearMipmapLinearFilter: LinearMipmapLinearFilter\n};\n\nclass ImageBitmapLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t\tthis.isImageBitmapLoader = true;\n\n\t\tif ( typeof createImageBitmap === 'undefined' ) {\n\n\t\t\tconsole.warn( 'THREE.ImageBitmapLoader: createImageBitmap() not supported.' );\n\n\t\t}\n\n\t\tif ( typeof fetch === 'undefined' ) {\n\n\t\t\tconsole.warn( 'THREE.ImageBitmapLoader: fetch() not supported.' );\n\n\t\t}\n\n\t\tthis.options = { premultiplyAlpha: 'none' };\n\n\t}\n\n\tsetOptions( options ) {\n\n\t\tthis.options = options;\n\n\t\treturn this;\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tif ( url === undefined ) url = '';\n\n\t\tif ( this.path !== undefined ) url = this.path + url;\n\n\t\turl = this.manager.resolveURL( url );\n\n\t\tconst scope = this;\n\n\t\tconst cached = Cache.get( url );\n\n\t\tif ( cached !== undefined ) {\n\n\t\t\tscope.manager.itemStart( url );\n\n\t\t\tsetTimeout( function () {\n\n\t\t\t\tif ( onLoad ) onLoad( cached );\n\n\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t}, 0 );\n\n\t\t\treturn cached;\n\n\t\t}\n\n\t\tconst fetchOptions = {};\n\t\tfetchOptions.credentials = ( this.crossOrigin === 'anonymous' ) ? 'same-origin' : 'include';\n\t\tfetchOptions.headers = this.requestHeader;\n\n\t\tfetch( url, fetchOptions ).then( function ( res ) {\n\n\t\t\treturn res.blob();\n\n\t\t} ).then( function ( blob ) {\n\n\t\t\treturn createImageBitmap( blob, Object.assign( scope.options, { colorSpaceConversion: 'none' } ) );\n\n\t\t} ).then( function ( imageBitmap ) {\n\n\t\t\tCache.add( url, imageBitmap );\n\n\t\t\tif ( onLoad ) onLoad( imageBitmap );\n\n\t\t\tscope.manager.itemEnd( url );\n\n\t\t} ).catch( function ( e ) {\n\n\t\t\tif ( onError ) onError( e );\n\n\t\t\tscope.manager.itemError( url );\n\t\t\tscope.manager.itemEnd( url );\n\n\t\t} );\n\n\t\tscope.manager.itemStart( url );\n\n\t}\n\n}\n\nlet _context;\n\nclass AudioContext {\n\n\tstatic getContext() {\n\n\t\tif ( _context === undefined ) {\n\n\t\t\t_context = new ( window.AudioContext || window.webkitAudioContext )();\n\n\t\t}\n\n\t\treturn _context;\n\n\t}\n\n\tstatic setContext( value ) {\n\n\t\t_context = value;\n\n\t}\n\n}\n\nclass AudioLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tconst loader = new FileLoader( this.manager );\n\t\tloader.setResponseType( 'arraybuffer' );\n\t\tloader.setPath( this.path );\n\t\tloader.setRequestHeader( this.requestHeader );\n\t\tloader.setWithCredentials( this.withCredentials );\n\t\tloader.load( url, function ( buffer ) {\n\n\t\t\ttry {\n\n\t\t\t\t// Create a copy of the buffer. The `decodeAudioData` method\n\t\t\t\t// detaches the buffer when complete, preventing reuse.\n\t\t\t\tconst bufferCopy = buffer.slice( 0 );\n\n\t\t\t\tconst context = AudioContext.getContext();\n\t\t\t\tcontext.decodeAudioData( bufferCopy, function ( audioBuffer ) {\n\n\t\t\t\t\tonLoad( audioBuffer );\n\n\t\t\t\t} );\n\n\t\t\t} catch ( e ) {\n\n\t\t\t\tif ( onError ) {\n\n\t\t\t\t\tonError( e );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( e );\n\n\t\t\t\t}\n\n\t\t\t\tscope.manager.itemError( url );\n\n\t\t\t}\n\n\t\t}, onProgress, onError );\n\n\t}\n\n}\n\nclass HemisphereLightProbe extends LightProbe {\n\n\tconstructor( skyColor, groundColor, intensity = 1 ) {\n\n\t\tsuper( undefined, intensity );\n\n\t\tthis.isHemisphereLightProbe = true;\n\n\t\tconst color1 = new Color().set( skyColor );\n\t\tconst color2 = new Color().set( groundColor );\n\n\t\tconst sky = new Vector3( color1.r, color1.g, color1.b );\n\t\tconst ground = new Vector3( color2.r, color2.g, color2.b );\n\n\t\t// without extra factor of PI in the shader, should = 1 / Math.sqrt( Math.PI );\n\t\tconst c0 = Math.sqrt( Math.PI );\n\t\tconst c1 = c0 * Math.sqrt( 0.75 );\n\n\t\tthis.sh.coefficients[ 0 ].copy( sky ).add( ground ).multiplyScalar( c0 );\n\t\tthis.sh.coefficients[ 1 ].copy( sky ).sub( ground ).multiplyScalar( c1 );\n\n\t}\n\n}\n\nclass AmbientLightProbe extends LightProbe {\n\n\tconstructor( color, intensity = 1 ) {\n\n\t\tsuper( undefined, intensity );\n\n\t\tthis.isAmbientLightProbe = true;\n\n\t\tconst color1 = new Color().set( color );\n\n\t\t// without extra factor of PI in the shader, would be 2 / Math.sqrt( Math.PI );\n\t\tthis.sh.coefficients[ 0 ].set( color1.r, color1.g, color1.b ).multiplyScalar( 2 * Math.sqrt( Math.PI ) );\n\n\t}\n\n}\n\nconst _eyeRight = /*@__PURE__*/ new Matrix4();\nconst _eyeLeft = /*@__PURE__*/ new Matrix4();\nconst _projectionMatrix = /*@__PURE__*/ new Matrix4();\n\nclass StereoCamera {\n\n\tconstructor() {\n\n\t\tthis.type = 'StereoCamera';\n\n\t\tthis.aspect = 1;\n\n\t\tthis.eyeSep = 0.064;\n\n\t\tthis.cameraL = new PerspectiveCamera();\n\t\tthis.cameraL.layers.enable( 1 );\n\t\tthis.cameraL.matrixAutoUpdate = false;\n\n\t\tthis.cameraR = new PerspectiveCamera();\n\t\tthis.cameraR.layers.enable( 2 );\n\t\tthis.cameraR.matrixAutoUpdate = false;\n\n\t\tthis._cache = {\n\t\t\tfocus: null,\n\t\t\tfov: null,\n\t\t\taspect: null,\n\t\t\tnear: null,\n\t\t\tfar: null,\n\t\t\tzoom: null,\n\t\t\teyeSep: null\n\t\t};\n\n\t}\n\n\tupdate( camera ) {\n\n\t\tconst cache = this._cache;\n\n\t\tconst needsUpdate = cache.focus !== camera.focus || cache.fov !== camera.fov ||\n\t\t\tcache.aspect !== camera.aspect * this.aspect || cache.near !== camera.near ||\n\t\t\tcache.far !== camera.far || cache.zoom !== camera.zoom || cache.eyeSep !== this.eyeSep;\n\n\t\tif ( needsUpdate ) {\n\n\t\t\tcache.focus = camera.focus;\n\t\t\tcache.fov = camera.fov;\n\t\t\tcache.aspect = camera.aspect * this.aspect;\n\t\t\tcache.near = camera.near;\n\t\t\tcache.far = camera.far;\n\t\t\tcache.zoom = camera.zoom;\n\t\t\tcache.eyeSep = this.eyeSep;\n\n\t\t\t// Off-axis stereoscopic effect based on\n\t\t\t// http://paulbourke.net/stereographics/stereorender/\n\n\t\t\t_projectionMatrix.copy( camera.projectionMatrix );\n\t\t\tconst eyeSepHalf = cache.eyeSep / 2;\n\t\t\tconst eyeSepOnProjection = eyeSepHalf * cache.near / cache.focus;\n\t\t\tconst ymax = ( cache.near * Math.tan( DEG2RAD * cache.fov * 0.5 ) ) / cache.zoom;\n\t\t\tlet xmin, xmax;\n\n\t\t\t// translate xOffset\n\n\t\t\t_eyeLeft.elements[ 12 ] = - eyeSepHalf;\n\t\t\t_eyeRight.elements[ 12 ] = eyeSepHalf;\n\n\t\t\t// for left eye\n\n\t\t\txmin = - ymax * cache.aspect + eyeSepOnProjection;\n\t\t\txmax = ymax * cache.aspect + eyeSepOnProjection;\n\n\t\t\t_projectionMatrix.elements[ 0 ] = 2 * cache.near / ( xmax - xmin );\n\t\t\t_projectionMatrix.elements[ 8 ] = ( xmax + xmin ) / ( xmax - xmin );\n\n\t\t\tthis.cameraL.projectionMatrix.copy( _projectionMatrix );\n\n\t\t\t// for right eye\n\n\t\t\txmin = - ymax * cache.aspect - eyeSepOnProjection;\n\t\t\txmax = ymax * cache.aspect - eyeSepOnProjection;\n\n\t\t\t_projectionMatrix.elements[ 0 ] = 2 * cache.near / ( xmax - xmin );\n\t\t\t_projectionMatrix.elements[ 8 ] = ( xmax + xmin ) / ( xmax - xmin );\n\n\t\t\tthis.cameraR.projectionMatrix.copy( _projectionMatrix );\n\n\t\t}\n\n\t\tthis.cameraL.matrixWorld.copy( camera.matrixWorld ).multiply( _eyeLeft );\n\t\tthis.cameraR.matrixWorld.copy( camera.matrixWorld ).multiply( _eyeRight );\n\n\t}\n\n}\n\nclass Clock {\n\n\tconstructor( autoStart = true ) {\n\n\t\tthis.autoStart = autoStart;\n\n\t\tthis.startTime = 0;\n\t\tthis.oldTime = 0;\n\t\tthis.elapsedTime = 0;\n\n\t\tthis.running = false;\n\n\t}\n\n\tstart() {\n\n\t\tthis.startTime = now();\n\n\t\tthis.oldTime = this.startTime;\n\t\tthis.elapsedTime = 0;\n\t\tthis.running = true;\n\n\t}\n\n\tstop() {\n\n\t\tthis.getElapsedTime();\n\t\tthis.running = false;\n\t\tthis.autoStart = false;\n\n\t}\n\n\tgetElapsedTime() {\n\n\t\tthis.getDelta();\n\t\treturn this.elapsedTime;\n\n\t}\n\n\tgetDelta() {\n\n\t\tlet diff = 0;\n\n\t\tif ( this.autoStart && ! this.running ) {\n\n\t\t\tthis.start();\n\t\t\treturn 0;\n\n\t\t}\n\n\t\tif ( this.running ) {\n\n\t\t\tconst newTime = now();\n\n\t\t\tdiff = ( newTime - this.oldTime ) / 1000;\n\t\t\tthis.oldTime = newTime;\n\n\t\t\tthis.elapsedTime += diff;\n\n\t\t}\n\n\t\treturn diff;\n\n\t}\n\n}\n\nfunction now() {\n\n\treturn ( typeof performance === 'undefined' ? Date : performance ).now(); // see #10732\n\n}\n\nconst _position$1 = /*@__PURE__*/ new Vector3();\nconst _quaternion$1 = /*@__PURE__*/ new Quaternion();\nconst _scale$1 = /*@__PURE__*/ new Vector3();\nconst _orientation$1 = /*@__PURE__*/ new Vector3();\n\nclass AudioListener extends Object3D {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.type = 'AudioListener';\n\n\t\tthis.context = AudioContext.getContext();\n\n\t\tthis.gain = this.context.createGain();\n\t\tthis.gain.connect( this.context.destination );\n\n\t\tthis.filter = null;\n\n\t\tthis.timeDelta = 0;\n\n\t\t// private\n\n\t\tthis._clock = new Clock();\n\n\t}\n\n\tgetInput() {\n\n\t\treturn this.gain;\n\n\t}\n\n\tremoveFilter() {\n\n\t\tif ( this.filter !== null ) {\n\n\t\t\tthis.gain.disconnect( this.filter );\n\t\t\tthis.filter.disconnect( this.context.destination );\n\t\t\tthis.gain.connect( this.context.destination );\n\t\t\tthis.filter = null;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tgetFilter() {\n\n\t\treturn this.filter;\n\n\t}\n\n\tsetFilter( value ) {\n\n\t\tif ( this.filter !== null ) {\n\n\t\t\tthis.gain.disconnect( this.filter );\n\t\t\tthis.filter.disconnect( this.context.destination );\n\n\t\t} else {\n\n\t\t\tthis.gain.disconnect( this.context.destination );\n\n\t\t}\n\n\t\tthis.filter = value;\n\t\tthis.gain.connect( this.filter );\n\t\tthis.filter.connect( this.context.destination );\n\n\t\treturn this;\n\n\t}\n\n\tgetMasterVolume() {\n\n\t\treturn this.gain.gain.value;\n\n\t}\n\n\tsetMasterVolume( value ) {\n\n\t\tthis.gain.gain.setTargetAtTime( value, this.context.currentTime, 0.01 );\n\n\t\treturn this;\n\n\t}\n\n\tupdateMatrixWorld( force ) {\n\n\t\tsuper.updateMatrixWorld( force );\n\n\t\tconst listener = this.context.listener;\n\t\tconst up = this.up;\n\n\t\tthis.timeDelta = this._clock.getDelta();\n\n\t\tthis.matrixWorld.decompose( _position$1, _quaternion$1, _scale$1 );\n\n\t\t_orientation$1.set( 0, 0, - 1 ).applyQuaternion( _quaternion$1 );\n\n\t\tif ( listener.positionX ) {\n\n\t\t\t// code path for Chrome (see #14393)\n\n\t\t\tconst endTime = this.context.currentTime + this.timeDelta;\n\n\t\t\tlistener.positionX.linearRampToValueAtTime( _position$1.x, endTime );\n\t\t\tlistener.positionY.linearRampToValueAtTime( _position$1.y, endTime );\n\t\t\tlistener.positionZ.linearRampToValueAtTime( _position$1.z, endTime );\n\t\t\tlistener.forwardX.linearRampToValueAtTime( _orientation$1.x, endTime );\n\t\t\tlistener.forwardY.linearRampToValueAtTime( _orientation$1.y, endTime );\n\t\t\tlistener.forwardZ.linearRampToValueAtTime( _orientation$1.z, endTime );\n\t\t\tlistener.upX.linearRampToValueAtTime( up.x, endTime );\n\t\t\tlistener.upY.linearRampToValueAtTime( up.y, endTime );\n\t\t\tlistener.upZ.linearRampToValueAtTime( up.z, endTime );\n\n\t\t} else {\n\n\t\t\tlistener.setPosition( _position$1.x, _position$1.y, _position$1.z );\n\t\t\tlistener.setOrientation( _orientation$1.x, _orientation$1.y, _orientation$1.z, up.x, up.y, up.z );\n\n\t\t}\n\n\t}\n\n}\n\nclass Audio extends Object3D {\n\n\tconstructor( listener ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'Audio';\n\n\t\tthis.listener = listener;\n\t\tthis.context = listener.context;\n\n\t\tthis.gain = this.context.createGain();\n\t\tthis.gain.connect( listener.getInput() );\n\n\t\tthis.autoplay = false;\n\n\t\tthis.buffer = null;\n\t\tthis.detune = 0;\n\t\tthis.loop = false;\n\t\tthis.loopStart = 0;\n\t\tthis.loopEnd = 0;\n\t\tthis.offset = 0;\n\t\tthis.duration = undefined;\n\t\tthis.playbackRate = 1;\n\t\tthis.isPlaying = false;\n\t\tthis.hasPlaybackControl = true;\n\t\tthis.source = null;\n\t\tthis.sourceType = 'empty';\n\n\t\tthis._startedAt = 0;\n\t\tthis._progress = 0;\n\t\tthis._connected = false;\n\n\t\tthis.filters = [];\n\n\t}\n\n\tgetOutput() {\n\n\t\treturn this.gain;\n\n\t}\n\n\tsetNodeSource( audioNode ) {\n\n\t\tthis.hasPlaybackControl = false;\n\t\tthis.sourceType = 'audioNode';\n\t\tthis.source = audioNode;\n\t\tthis.connect();\n\n\t\treturn this;\n\n\t}\n\n\tsetMediaElementSource( mediaElement ) {\n\n\t\tthis.hasPlaybackControl = false;\n\t\tthis.sourceType = 'mediaNode';\n\t\tthis.source = this.context.createMediaElementSource( mediaElement );\n\t\tthis.connect();\n\n\t\treturn this;\n\n\t}\n\n\tsetMediaStreamSource( mediaStream ) {\n\n\t\tthis.hasPlaybackControl = false;\n\t\tthis.sourceType = 'mediaStreamNode';\n\t\tthis.source = this.context.createMediaStreamSource( mediaStream );\n\t\tthis.connect();\n\n\t\treturn this;\n\n\t}\n\n\tsetBuffer( audioBuffer ) {\n\n\t\tthis.buffer = audioBuffer;\n\t\tthis.sourceType = 'buffer';\n\n\t\tif ( this.autoplay ) this.play();\n\n\t\treturn this;\n\n\t}\n\n\tplay( delay = 0 ) {\n\n\t\tif ( this.isPlaying === true ) {\n\n\t\t\tconsole.warn( 'THREE.Audio: Audio is already playing.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( this.hasPlaybackControl === false ) {\n\n\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tthis._startedAt = this.context.currentTime + delay;\n\n\t\tconst source = this.context.createBufferSource();\n\t\tsource.buffer = this.buffer;\n\t\tsource.loop = this.loop;\n\t\tsource.loopStart = this.loopStart;\n\t\tsource.loopEnd = this.loopEnd;\n\t\tsource.onended = this.onEnded.bind( this );\n\t\tsource.start( this._startedAt, this._progress + this.offset, this.duration );\n\n\t\tthis.isPlaying = true;\n\n\t\tthis.source = source;\n\n\t\tthis.setDetune( this.detune );\n\t\tthis.setPlaybackRate( this.playbackRate );\n\n\t\treturn this.connect();\n\n\t}\n\n\tpause() {\n\n\t\tif ( this.hasPlaybackControl === false ) {\n\n\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( this.isPlaying === true ) {\n\n\t\t\t// update current progress\n\n\t\t\tthis._progress += Math.max( this.context.currentTime - this._startedAt, 0 ) * this.playbackRate;\n\n\t\t\tif ( this.loop === true ) {\n\n\t\t\t\t// ensure _progress does not exceed duration with looped audios\n\n\t\t\t\tthis._progress = this._progress % ( this.duration || this.buffer.duration );\n\n\t\t\t}\n\n\t\t\tthis.source.stop();\n\t\t\tthis.source.onended = null;\n\n\t\t\tthis.isPlaying = false;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tstop() {\n\n\t\tif ( this.hasPlaybackControl === false ) {\n\n\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tthis._progress = 0;\n\n\t\tthis.source.stop();\n\t\tthis.source.onended = null;\n\t\tthis.isPlaying = false;\n\n\t\treturn this;\n\n\t}\n\n\tconnect() {\n\n\t\tif ( this.filters.length > 0 ) {\n\n\t\t\tthis.source.connect( this.filters[ 0 ] );\n\n\t\t\tfor ( let i = 1, l = this.filters.length; i < l; i ++ ) {\n\n\t\t\t\tthis.filters[ i - 1 ].connect( this.filters[ i ] );\n\n\t\t\t}\n\n\t\t\tthis.filters[ this.filters.length - 1 ].connect( this.getOutput() );\n\n\t\t} else {\n\n\t\t\tthis.source.connect( this.getOutput() );\n\n\t\t}\n\n\t\tthis._connected = true;\n\n\t\treturn this;\n\n\t}\n\n\tdisconnect() {\n\n\t\tif ( this.filters.length > 0 ) {\n\n\t\t\tthis.source.disconnect( this.filters[ 0 ] );\n\n\t\t\tfor ( let i = 1, l = this.filters.length; i < l; i ++ ) {\n\n\t\t\t\tthis.filters[ i - 1 ].disconnect( this.filters[ i ] );\n\n\t\t\t}\n\n\t\t\tthis.filters[ this.filters.length - 1 ].disconnect( this.getOutput() );\n\n\t\t} else {\n\n\t\t\tthis.source.disconnect( this.getOutput() );\n\n\t\t}\n\n\t\tthis._connected = false;\n\n\t\treturn this;\n\n\t}\n\n\tgetFilters() {\n\n\t\treturn this.filters;\n\n\t}\n\n\tsetFilters( value ) {\n\n\t\tif ( ! value ) value = [];\n\n\t\tif ( this._connected === true ) {\n\n\t\t\tthis.disconnect();\n\t\t\tthis.filters = value.slice();\n\t\t\tthis.connect();\n\n\t\t} else {\n\n\t\t\tthis.filters = value.slice();\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetDetune( value ) {\n\n\t\tthis.detune = value;\n\n\t\tif ( this.source.detune === undefined ) return; // only set detune when available\n\n\t\tif ( this.isPlaying === true ) {\n\n\t\t\tthis.source.detune.setTargetAtTime( this.detune, this.context.currentTime, 0.01 );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tgetDetune() {\n\n\t\treturn this.detune;\n\n\t}\n\n\tgetFilter() {\n\n\t\treturn this.getFilters()[ 0 ];\n\n\t}\n\n\tsetFilter( filter ) {\n\n\t\treturn this.setFilters( filter ? [ filter ] : [] );\n\n\t}\n\n\tsetPlaybackRate( value ) {\n\n\t\tif ( this.hasPlaybackControl === false ) {\n\n\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tthis.playbackRate = value;\n\n\t\tif ( this.isPlaying === true ) {\n\n\t\t\tthis.source.playbackRate.setTargetAtTime( this.playbackRate, this.context.currentTime, 0.01 );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tgetPlaybackRate() {\n\n\t\treturn this.playbackRate;\n\n\t}\n\n\tonEnded() {\n\n\t\tthis.isPlaying = false;\n\n\t}\n\n\tgetLoop() {\n\n\t\tif ( this.hasPlaybackControl === false ) {\n\n\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\n\t\t\treturn false;\n\n\t\t}\n\n\t\treturn this.loop;\n\n\t}\n\n\tsetLoop( value ) {\n\n\t\tif ( this.hasPlaybackControl === false ) {\n\n\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tthis.loop = value;\n\n\t\tif ( this.isPlaying === true ) {\n\n\t\t\tthis.source.loop = this.loop;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetLoopStart( value ) {\n\n\t\tthis.loopStart = value;\n\n\t\treturn this;\n\n\t}\n\n\tsetLoopEnd( value ) {\n\n\t\tthis.loopEnd = value;\n\n\t\treturn this;\n\n\t}\n\n\tgetVolume() {\n\n\t\treturn this.gain.gain.value;\n\n\t}\n\n\tsetVolume( value ) {\n\n\t\tthis.gain.gain.setTargetAtTime( value, this.context.currentTime, 0.01 );\n\n\t\treturn this;\n\n\t}\n\n}\n\nconst _position = /*@__PURE__*/ new Vector3();\nconst _quaternion = /*@__PURE__*/ new Quaternion();\nconst _scale = /*@__PURE__*/ new Vector3();\nconst _orientation = /*@__PURE__*/ new Vector3();\n\nclass PositionalAudio extends Audio {\n\n\tconstructor( listener ) {\n\n\t\tsuper( listener );\n\n\t\tthis.panner = this.context.createPanner();\n\t\tthis.panner.panningModel = 'HRTF';\n\t\tthis.panner.connect( this.gain );\n\n\t}\n\n\tdisconnect() {\n\n\t\tsuper.disconnect();\n\n\t\tthis.panner.disconnect( this.gain );\n\n\t}\n\n\tgetOutput() {\n\n\t\treturn this.panner;\n\n\t}\n\n\tgetRefDistance() {\n\n\t\treturn this.panner.refDistance;\n\n\t}\n\n\tsetRefDistance( value ) {\n\n\t\tthis.panner.refDistance = value;\n\n\t\treturn this;\n\n\t}\n\n\tgetRolloffFactor() {\n\n\t\treturn this.panner.rolloffFactor;\n\n\t}\n\n\tsetRolloffFactor( value ) {\n\n\t\tthis.panner.rolloffFactor = value;\n\n\t\treturn this;\n\n\t}\n\n\tgetDistanceModel() {\n\n\t\treturn this.panner.distanceModel;\n\n\t}\n\n\tsetDistanceModel( value ) {\n\n\t\tthis.panner.distanceModel = value;\n\n\t\treturn this;\n\n\t}\n\n\tgetMaxDistance() {\n\n\t\treturn this.panner.maxDistance;\n\n\t}\n\n\tsetMaxDistance( value ) {\n\n\t\tthis.panner.maxDistance = value;\n\n\t\treturn this;\n\n\t}\n\n\tsetDirectionalCone( coneInnerAngle, coneOuterAngle, coneOuterGain ) {\n\n\t\tthis.panner.coneInnerAngle = coneInnerAngle;\n\t\tthis.panner.coneOuterAngle = coneOuterAngle;\n\t\tthis.panner.coneOuterGain = coneOuterGain;\n\n\t\treturn this;\n\n\t}\n\n\tupdateMatrixWorld( force ) {\n\n\t\tsuper.updateMatrixWorld( force );\n\n\t\tif ( this.hasPlaybackControl === true && this.isPlaying === false ) return;\n\n\t\tthis.matrixWorld.decompose( _position, _quaternion, _scale );\n\n\t\t_orientation.set( 0, 0, 1 ).applyQuaternion( _quaternion );\n\n\t\tconst panner = this.panner;\n\n\t\tif ( panner.positionX ) {\n\n\t\t\t// code path for Chrome and Firefox (see #14393)\n\n\t\t\tconst endTime = this.context.currentTime + this.listener.timeDelta;\n\n\t\t\tpanner.positionX.linearRampToValueAtTime( _position.x, endTime );\n\t\t\tpanner.positionY.linearRampToValueAtTime( _position.y, endTime );\n\t\t\tpanner.positionZ.linearRampToValueAtTime( _position.z, endTime );\n\t\t\tpanner.orientationX.linearRampToValueAtTime( _orientation.x, endTime );\n\t\t\tpanner.orientationY.linearRampToValueAtTime( _orientation.y, endTime );\n\t\t\tpanner.orientationZ.linearRampToValueAtTime( _orientation.z, endTime );\n\n\t\t} else {\n\n\t\t\tpanner.setPosition( _position.x, _position.y, _position.z );\n\t\t\tpanner.setOrientation( _orientation.x, _orientation.y, _orientation.z );\n\n\t\t}\n\n\t}\n\n}\n\nclass AudioAnalyser {\n\n\tconstructor( audio, fftSize = 2048 ) {\n\n\t\tthis.analyser = audio.context.createAnalyser();\n\t\tthis.analyser.fftSize = fftSize;\n\n\t\tthis.data = new Uint8Array( this.analyser.frequencyBinCount );\n\n\t\taudio.getOutput().connect( this.analyser );\n\n\t}\n\n\n\tgetFrequencyData() {\n\n\t\tthis.analyser.getByteFrequencyData( this.data );\n\n\t\treturn this.data;\n\n\t}\n\n\tgetAverageFrequency() {\n\n\t\tlet value = 0;\n\t\tconst data = this.getFrequencyData();\n\n\t\tfor ( let i = 0; i < data.length; i ++ ) {\n\n\t\t\tvalue += data[ i ];\n\n\t\t}\n\n\t\treturn value / data.length;\n\n\t}\n\n}\n\nclass PropertyMixer {\n\n\tconstructor( binding, typeName, valueSize ) {\n\n\t\tthis.binding = binding;\n\t\tthis.valueSize = valueSize;\n\n\t\tlet mixFunction,\n\t\t\tmixFunctionAdditive,\n\t\t\tsetIdentity;\n\n\t\t// buffer layout: [ incoming | accu0 | accu1 | orig | addAccu | (optional work) ]\n\t\t//\n\t\t// interpolators can use .buffer as their .result\n\t\t// the data then goes to 'incoming'\n\t\t//\n\t\t// 'accu0' and 'accu1' are used frame-interleaved for\n\t\t// the cumulative result and are compared to detect\n\t\t// changes\n\t\t//\n\t\t// 'orig' stores the original state of the property\n\t\t//\n\t\t// 'add' is used for additive cumulative results\n\t\t//\n\t\t// 'work' is optional and is only present for quaternion types. It is used\n\t\t// to store intermediate quaternion multiplication results\n\n\t\tswitch ( typeName ) {\n\n\t\t\tcase 'quaternion':\n\t\t\t\tmixFunction = this._slerp;\n\t\t\t\tmixFunctionAdditive = this._slerpAdditive;\n\t\t\t\tsetIdentity = this._setAdditiveIdentityQuaternion;\n\n\t\t\t\tthis.buffer = new Float64Array( valueSize * 6 );\n\t\t\t\tthis._workIndex = 5;\n\t\t\t\tbreak;\n\n\t\t\tcase 'string':\n\t\t\tcase 'bool':\n\t\t\t\tmixFunction = this._select;\n\n\t\t\t\t// Use the regular mix function and for additive on these types,\n\t\t\t\t// additive is not relevant for non-numeric types\n\t\t\t\tmixFunctionAdditive = this._select;\n\n\t\t\t\tsetIdentity = this._setAdditiveIdentityOther;\n\n\t\t\t\tthis.buffer = new Array( valueSize * 5 );\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tmixFunction = this._lerp;\n\t\t\t\tmixFunctionAdditive = this._lerpAdditive;\n\t\t\t\tsetIdentity = this._setAdditiveIdentityNumeric;\n\n\t\t\t\tthis.buffer = new Float64Array( valueSize * 5 );\n\n\t\t}\n\n\t\tthis._mixBufferRegion = mixFunction;\n\t\tthis._mixBufferRegionAdditive = mixFunctionAdditive;\n\t\tthis._setIdentity = setIdentity;\n\t\tthis._origIndex = 3;\n\t\tthis._addIndex = 4;\n\n\t\tthis.cumulativeWeight = 0;\n\t\tthis.cumulativeWeightAdditive = 0;\n\n\t\tthis.useCount = 0;\n\t\tthis.referenceCount = 0;\n\n\t}\n\n\t// accumulate data in the 'incoming' region into 'accu<i>'\n\taccumulate( accuIndex, weight ) {\n\n\t\t// note: happily accumulating nothing when weight = 0, the caller knows\n\t\t// the weight and shouldn't have made the call in the first place\n\n\t\tconst buffer = this.buffer,\n\t\t\tstride = this.valueSize,\n\t\t\toffset = accuIndex * stride + stride;\n\n\t\tlet currentWeight = this.cumulativeWeight;\n\n\t\tif ( currentWeight === 0 ) {\n\n\t\t\t// accuN := incoming * weight\n\n\t\t\tfor ( let i = 0; i !== stride; ++ i ) {\n\n\t\t\t\tbuffer[ offset + i ] = buffer[ i ];\n\n\t\t\t}\n\n\t\t\tcurrentWeight = weight;\n\n\t\t} else {\n\n\t\t\t// accuN := accuN + incoming * weight\n\n\t\t\tcurrentWeight += weight;\n\t\t\tconst mix = weight / currentWeight;\n\t\t\tthis._mixBufferRegion( buffer, offset, 0, mix, stride );\n\n\t\t}\n\n\t\tthis.cumulativeWeight = currentWeight;\n\n\t}\n\n\t// accumulate data in the 'incoming' region into 'add'\n\taccumulateAdditive( weight ) {\n\n\t\tconst buffer = this.buffer,\n\t\t\tstride = this.valueSize,\n\t\t\toffset = stride * this._addIndex;\n\n\t\tif ( this.cumulativeWeightAdditive === 0 ) {\n\n\t\t\t// add = identity\n\n\t\t\tthis._setIdentity();\n\n\t\t}\n\n\t\t// add := add + incoming * weight\n\n\t\tthis._mixBufferRegionAdditive( buffer, offset, 0, weight, stride );\n\t\tthis.cumulativeWeightAdditive += weight;\n\n\t}\n\n\t// apply the state of 'accu<i>' to the binding when accus differ\n\tapply( accuIndex ) {\n\n\t\tconst stride = this.valueSize,\n\t\t\tbuffer = this.buffer,\n\t\t\toffset = accuIndex * stride + stride,\n\n\t\t\tweight = this.cumulativeWeight,\n\t\t\tweightAdditive = this.cumulativeWeightAdditive,\n\n\t\t\tbinding = this.binding;\n\n\t\tthis.cumulativeWeight = 0;\n\t\tthis.cumulativeWeightAdditive = 0;\n\n\t\tif ( weight < 1 ) {\n\n\t\t\t// accuN := accuN + original * ( 1 - cumulativeWeight )\n\n\t\t\tconst originalValueOffset = stride * this._origIndex;\n\n\t\t\tthis._mixBufferRegion(\n\t\t\t\tbuffer, offset, originalValueOffset, 1 - weight, stride );\n\n\t\t}\n\n\t\tif ( weightAdditive > 0 ) {\n\n\t\t\t// accuN := accuN + additive accuN\n\n\t\t\tthis._mixBufferRegionAdditive( buffer, offset, this._addIndex * stride, 1, stride );\n\n\t\t}\n\n\t\tfor ( let i = stride, e = stride + stride; i !== e; ++ i ) {\n\n\t\t\tif ( buffer[ i ] !== buffer[ i + stride ] ) {\n\n\t\t\t\t// value has changed -> update scene graph\n\n\t\t\t\tbinding.setValue( buffer, offset );\n\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t// remember the state of the bound property and copy it to both accus\n\tsaveOriginalState() {\n\n\t\tconst binding = this.binding;\n\n\t\tconst buffer = this.buffer,\n\t\t\tstride = this.valueSize,\n\n\t\t\toriginalValueOffset = stride * this._origIndex;\n\n\t\tbinding.getValue( buffer, originalValueOffset );\n\n\t\t// accu[0..1] := orig -- initially detect changes against the original\n\t\tfor ( let i = stride, e = originalValueOffset; i !== e; ++ i ) {\n\n\t\t\tbuffer[ i ] = buffer[ originalValueOffset + ( i % stride ) ];\n\n\t\t}\n\n\t\t// Add to identity for additive\n\t\tthis._setIdentity();\n\n\t\tthis.cumulativeWeight = 0;\n\t\tthis.cumulativeWeightAdditive = 0;\n\n\t}\n\n\t// apply the state previously taken via 'saveOriginalState' to the binding\n\trestoreOriginalState() {\n\n\t\tconst originalValueOffset = this.valueSize * 3;\n\t\tthis.binding.setValue( this.buffer, originalValueOffset );\n\n\t}\n\n\t_setAdditiveIdentityNumeric() {\n\n\t\tconst startIndex = this._addIndex * this.valueSize;\n\t\tconst endIndex = startIndex + this.valueSize;\n\n\t\tfor ( let i = startIndex; i < endIndex; i ++ ) {\n\n\t\t\tthis.buffer[ i ] = 0;\n\n\t\t}\n\n\t}\n\n\t_setAdditiveIdentityQuaternion() {\n\n\t\tthis._setAdditiveIdentityNumeric();\n\t\tthis.buffer[ this._addIndex * this.valueSize + 3 ] = 1;\n\n\t}\n\n\t_setAdditiveIdentityOther() {\n\n\t\tconst startIndex = this._origIndex * this.valueSize;\n\t\tconst targetIndex = this._addIndex * this.valueSize;\n\n\t\tfor ( let i = 0; i < this.valueSize; i ++ ) {\n\n\t\t\tthis.buffer[ targetIndex + i ] = this.buffer[ startIndex + i ];\n\n\t\t}\n\n\t}\n\n\n\t// mix functions\n\n\t_select( buffer, dstOffset, srcOffset, t, stride ) {\n\n\t\tif ( t >= 0.5 ) {\n\n\t\t\tfor ( let i = 0; i !== stride; ++ i ) {\n\n\t\t\t\tbuffer[ dstOffset + i ] = buffer[ srcOffset + i ];\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t_slerp( buffer, dstOffset, srcOffset, t ) {\n\n\t\tQuaternion.slerpFlat( buffer, dstOffset, buffer, dstOffset, buffer, srcOffset, t );\n\n\t}\n\n\t_slerpAdditive( buffer, dstOffset, srcOffset, t, stride ) {\n\n\t\tconst workOffset = this._workIndex * stride;\n\n\t\t// Store result in intermediate buffer offset\n\t\tQuaternion.multiplyQuaternionsFlat( buffer, workOffset, buffer, dstOffset, buffer, srcOffset );\n\n\t\t// Slerp to the intermediate result\n\t\tQuaternion.slerpFlat( buffer, dstOffset, buffer, dstOffset, buffer, workOffset, t );\n\n\t}\n\n\t_lerp( buffer, dstOffset, srcOffset, t, stride ) {\n\n\t\tconst s = 1 - t;\n\n\t\tfor ( let i = 0; i !== stride; ++ i ) {\n\n\t\t\tconst j = dstOffset + i;\n\n\t\t\tbuffer[ j ] = buffer[ j ] * s + buffer[ srcOffset + i ] * t;\n\n\t\t}\n\n\t}\n\n\t_lerpAdditive( buffer, dstOffset, srcOffset, t, stride ) {\n\n\t\tfor ( let i = 0; i !== stride; ++ i ) {\n\n\t\t\tconst j = dstOffset + i;\n\n\t\t\tbuffer[ j ] = buffer[ j ] + buffer[ srcOffset + i ] * t;\n\n\t\t}\n\n\t}\n\n}\n\n// Characters [].:/ are reserved for track binding syntax.\nconst _RESERVED_CHARS_RE = '\\\\[\\\\]\\\\.:\\\\/';\nconst _reservedRe = new RegExp( '[' + _RESERVED_CHARS_RE + ']', 'g' );\n\n// Attempts to allow node names from any language. ES5's `\\w` regexp matches\n// only latin characters, and the unicode \\p{L} is not yet supported. So\n// instead, we exclude reserved characters and match everything else.\nconst _wordChar = '[^' + _RESERVED_CHARS_RE + ']';\nconst _wordCharOrDot = '[^' + _RESERVED_CHARS_RE.replace( '\\\\.', '' ) + ']';\n\n// Parent directories, delimited by '/' or ':'. Currently unused, but must\n// be matched to parse the rest of the track name.\nconst _directoryRe = /*@__PURE__*/ /((?:WC+[\\/:])*)/.source.replace( 'WC', _wordChar );\n\n// Target node. May contain word characters (a-zA-Z0-9_) and '.' or '-'.\nconst _nodeRe = /*@__PURE__*/ /(WCOD+)?/.source.replace( 'WCOD', _wordCharOrDot );\n\n// Object on target node, and accessor. May not contain reserved\n// characters. Accessor may contain any character except closing bracket.\nconst _objectRe = /*@__PURE__*/ /(?:\\.(WC+)(?:\\[(.+)\\])?)?/.source.replace( 'WC', _wordChar );\n\n// Property and accessor. May not contain reserved characters. Accessor may\n// contain any non-bracket characters.\nconst _propertyRe = /*@__PURE__*/ /\\.(WC+)(?:\\[(.+)\\])?/.source.replace( 'WC', _wordChar );\n\nconst _trackRe = new RegExp( ''\n\t+ '^'\n\t+ _directoryRe\n\t+ _nodeRe\n\t+ _objectRe\n\t+ _propertyRe\n\t+ '$'\n);\n\nconst _supportedObjectNames = [ 'material', 'materials', 'bones', 'map' ];\n\nclass Composite {\n\n\tconstructor( targetGroup, path, optionalParsedPath ) {\n\n\t\tconst parsedPath = optionalParsedPath || PropertyBinding.parseTrackName( path );\n\n\t\tthis._targetGroup = targetGroup;\n\t\tthis._bindings = targetGroup.subscribe_( path, parsedPath );\n\n\t}\n\n\tgetValue( array, offset ) {\n\n\t\tthis.bind(); // bind all binding\n\n\t\tconst firstValidIndex = this._targetGroup.nCachedObjects_,\n\t\t\tbinding = this._bindings[ firstValidIndex ];\n\n\t\t// and only call .getValue on the first\n\t\tif ( binding !== undefined ) binding.getValue( array, offset );\n\n\t}\n\n\tsetValue( array, offset ) {\n\n\t\tconst bindings = this._bindings;\n\n\t\tfor ( let i = this._targetGroup.nCachedObjects_, n = bindings.length; i !== n; ++ i ) {\n\n\t\t\tbindings[ i ].setValue( array, offset );\n\n\t\t}\n\n\t}\n\n\tbind() {\n\n\t\tconst bindings = this._bindings;\n\n\t\tfor ( let i = this._targetGroup.nCachedObjects_, n = bindings.length; i !== n; ++ i ) {\n\n\t\t\tbindings[ i ].bind();\n\n\t\t}\n\n\t}\n\n\tunbind() {\n\n\t\tconst bindings = this._bindings;\n\n\t\tfor ( let i = this._targetGroup.nCachedObjects_, n = bindings.length; i !== n; ++ i ) {\n\n\t\t\tbindings[ i ].unbind();\n\n\t\t}\n\n\t}\n\n}\n\n// Note: This class uses a State pattern on a per-method basis:\n// 'bind' sets 'this.getValue' / 'setValue' and shadows the\n// prototype version of these methods with one that represents\n// the bound state. When the property is not found, the methods\n// become no-ops.\nclass PropertyBinding {\n\n\tconstructor( rootNode, path, parsedPath ) {\n\n\t\tthis.path = path;\n\t\tthis.parsedPath = parsedPath || PropertyBinding.parseTrackName( path );\n\n\t\tthis.node = PropertyBinding.findNode( rootNode, this.parsedPath.nodeName ) || rootNode;\n\n\t\tthis.rootNode = rootNode;\n\n\t\t// initial state of these methods that calls 'bind'\n\t\tthis.getValue = this._getValue_unbound;\n\t\tthis.setValue = this._setValue_unbound;\n\n\t}\n\n\n\tstatic create( root, path, parsedPath ) {\n\n\t\tif ( ! ( root && root.isAnimationObjectGroup ) ) {\n\n\t\t\treturn new PropertyBinding( root, path, parsedPath );\n\n\t\t} else {\n\n\t\t\treturn new PropertyBinding.Composite( root, path, parsedPath );\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Replaces spaces with underscores and removes unsupported characters from\n\t * node names, to ensure compatibility with parseTrackName().\n\t *\n\t * @param {string} name Node name to be sanitized.\n\t * @return {string}\n\t */\n\tstatic sanitizeNodeName( name ) {\n\n\t\treturn name.replace( /\\s/g, '_' ).replace( _reservedRe, '' );\n\n\t}\n\n\tstatic parseTrackName( trackName ) {\n\n\t\tconst matches = _trackRe.exec( trackName );\n\n\t\tif ( matches === null ) {\n\n\t\t\tthrow new Error( 'PropertyBinding: Cannot parse trackName: ' + trackName );\n\n\t\t}\n\n\t\tconst results = {\n\t\t\t// directoryName: matches[ 1 ], // (tschw) currently unused\n\t\t\tnodeName: matches[ 2 ],\n\t\t\tobjectName: matches[ 3 ],\n\t\t\tobjectIndex: matches[ 4 ],\n\t\t\tpropertyName: matches[ 5 ], // required\n\t\t\tpropertyIndex: matches[ 6 ]\n\t\t};\n\n\t\tconst lastDot = results.nodeName && results.nodeName.lastIndexOf( '.' );\n\n\t\tif ( lastDot !== undefined && lastDot !== - 1 ) {\n\n\t\t\tconst objectName = results.nodeName.substring( lastDot + 1 );\n\n\t\t\t// Object names must be checked against an allowlist. Otherwise, there\n\t\t\t// is no way to parse 'foo.bar.baz': 'baz' must be a property, but\n\t\t\t// 'bar' could be the objectName, or part of a nodeName (which can\n\t\t\t// include '.' characters).\n\t\t\tif ( _supportedObjectNames.indexOf( objectName ) !== - 1 ) {\n\n\t\t\t\tresults.nodeName = results.nodeName.substring( 0, lastDot );\n\t\t\t\tresults.objectName = objectName;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( results.propertyName === null || results.propertyName.length === 0 ) {\n\n\t\t\tthrow new Error( 'PropertyBinding: can not parse propertyName from trackName: ' + trackName );\n\n\t\t}\n\n\t\treturn results;\n\n\t}\n\n\tstatic findNode( root, nodeName ) {\n\n\t\tif ( nodeName === undefined || nodeName === '' || nodeName === '.' || nodeName === - 1 || nodeName === root.name || nodeName === root.uuid ) {\n\n\t\t\treturn root;\n\n\t\t}\n\n\t\t// search into skeleton bones.\n\t\tif ( root.skeleton ) {\n\n\t\t\tconst bone = root.skeleton.getBoneByName( nodeName );\n\n\t\t\tif ( bone !== undefined ) {\n\n\t\t\t\treturn bone;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// search into node subtree.\n\t\tif ( root.children ) {\n\n\t\t\tconst searchNodeSubtree = function ( children ) {\n\n\t\t\t\tfor ( let i = 0; i < children.length; i ++ ) {\n\n\t\t\t\t\tconst childNode = children[ i ];\n\n\t\t\t\t\tif ( childNode.name === nodeName || childNode.uuid === nodeName ) {\n\n\t\t\t\t\t\treturn childNode;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tconst result = searchNodeSubtree( childNode.children );\n\n\t\t\t\t\tif ( result ) return result;\n\n\t\t\t\t}\n\n\t\t\t\treturn null;\n\n\t\t\t};\n\n\t\t\tconst subTreeNode = searchNodeSubtree( root.children );\n\n\t\t\tif ( subTreeNode ) {\n\n\t\t\t\treturn subTreeNode;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn null;\n\n\t}\n\n\t// these are used to \"bind\" a nonexistent property\n\t_getValue_unavailable() {}\n\t_setValue_unavailable() {}\n\n\t// Getters\n\n\t_getValue_direct( buffer, offset ) {\n\n\t\tbuffer[ offset ] = this.targetObject[ this.propertyName ];\n\n\t}\n\n\t_getValue_array( buffer, offset ) {\n\n\t\tconst source = this.resolvedProperty;\n\n\t\tfor ( let i = 0, n = source.length; i !== n; ++ i ) {\n\n\t\t\tbuffer[ offset ++ ] = source[ i ];\n\n\t\t}\n\n\t}\n\n\t_getValue_arrayElement( buffer, offset ) {\n\n\t\tbuffer[ offset ] = this.resolvedProperty[ this.propertyIndex ];\n\n\t}\n\n\t_getValue_toArray( buffer, offset ) {\n\n\t\tthis.resolvedProperty.toArray( buffer, offset );\n\n\t}\n\n\t// Direct\n\n\t_setValue_direct( buffer, offset ) {\n\n\t\tthis.targetObject[ this.propertyName ] = buffer[ offset ];\n\n\t}\n\n\t_setValue_direct_setNeedsUpdate( buffer, offset ) {\n\n\t\tthis.targetObject[ this.propertyName ] = buffer[ offset ];\n\t\tthis.targetObject.needsUpdate = true;\n\n\t}\n\n\t_setValue_direct_setMatrixWorldNeedsUpdate( buffer, offset ) {\n\n\t\tthis.targetObject[ this.propertyName ] = buffer[ offset ];\n\t\tthis.targetObject.matrixWorldNeedsUpdate = true;\n\n\t}\n\n\t// EntireArray\n\n\t_setValue_array( buffer, offset ) {\n\n\t\tconst dest = this.resolvedProperty;\n\n\t\tfor ( let i = 0, n = dest.length; i !== n; ++ i ) {\n\n\t\t\tdest[ i ] = buffer[ offset ++ ];\n\n\t\t}\n\n\t}\n\n\t_setValue_array_setNeedsUpdate( buffer, offset ) {\n\n\t\tconst dest = this.resolvedProperty;\n\n\t\tfor ( let i = 0, n = dest.length; i !== n; ++ i ) {\n\n\t\t\tdest[ i ] = buffer[ offset ++ ];\n\n\t\t}\n\n\t\tthis.targetObject.needsUpdate = true;\n\n\t}\n\n\t_setValue_array_setMatrixWorldNeedsUpdate( buffer, offset ) {\n\n\t\tconst dest = this.resolvedProperty;\n\n\t\tfor ( let i = 0, n = dest.length; i !== n; ++ i ) {\n\n\t\t\tdest[ i ] = buffer[ offset ++ ];\n\n\t\t}\n\n\t\tthis.targetObject.matrixWorldNeedsUpdate = true;\n\n\t}\n\n\t// ArrayElement\n\n\t_setValue_arrayElement( buffer, offset ) {\n\n\t\tthis.resolvedProperty[ this.propertyIndex ] = buffer[ offset ];\n\n\t}\n\n\t_setValue_arrayElement_setNeedsUpdate( buffer, offset ) {\n\n\t\tthis.resolvedProperty[ this.propertyIndex ] = buffer[ offset ];\n\t\tthis.targetObject.needsUpdate = true;\n\n\t}\n\n\t_setValue_arrayElement_setMatrixWorldNeedsUpdate( buffer, offset ) {\n\n\t\tthis.resolvedProperty[ this.propertyIndex ] = buffer[ offset ];\n\t\tthis.targetObject.matrixWorldNeedsUpdate = true;\n\n\t}\n\n\t// HasToFromArray\n\n\t_setValue_fromArray( buffer, offset ) {\n\n\t\tthis.resolvedProperty.fromArray( buffer, offset );\n\n\t}\n\n\t_setValue_fromArray_setNeedsUpdate( buffer, offset ) {\n\n\t\tthis.resolvedProperty.fromArray( buffer, offset );\n\t\tthis.targetObject.needsUpdate = true;\n\n\t}\n\n\t_setValue_fromArray_setMatrixWorldNeedsUpdate( buffer, offset ) {\n\n\t\tthis.resolvedProperty.fromArray( buffer, offset );\n\t\tthis.targetObject.matrixWorldNeedsUpdate = true;\n\n\t}\n\n\t_getValue_unbound( targetArray, offset ) {\n\n\t\tthis.bind();\n\t\tthis.getValue( targetArray, offset );\n\n\t}\n\n\t_setValue_unbound( sourceArray, offset ) {\n\n\t\tthis.bind();\n\t\tthis.setValue( sourceArray, offset );\n\n\t}\n\n\t// create getter / setter pair for a property in the scene graph\n\tbind() {\n\n\t\tlet targetObject = this.node;\n\t\tconst parsedPath = this.parsedPath;\n\n\t\tconst objectName = parsedPath.objectName;\n\t\tconst propertyName = parsedPath.propertyName;\n\t\tlet propertyIndex = parsedPath.propertyIndex;\n\n\t\tif ( ! targetObject ) {\n\n\t\t\ttargetObject = PropertyBinding.findNode( this.rootNode, parsedPath.nodeName ) || this.rootNode;\n\n\t\t\tthis.node = targetObject;\n\n\t\t}\n\n\t\t// set fail state so we can just 'return' on error\n\t\tthis.getValue = this._getValue_unavailable;\n\t\tthis.setValue = this._setValue_unavailable;\n\n\t\t// ensure there is a value node\n\t\tif ( ! targetObject ) {\n\n\t\t\tconsole.error( 'THREE.PropertyBinding: Trying to update node for track: ' + this.path + ' but it wasn\\'t found.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( objectName ) {\n\n\t\t\tlet objectIndex = parsedPath.objectIndex;\n\n\t\t\t// special cases were we need to reach deeper into the hierarchy to get the face materials....\n\t\t\tswitch ( objectName ) {\n\n\t\t\t\tcase 'materials':\n\n\t\t\t\t\tif ( ! targetObject.material ) {\n\n\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to material as node does not have a material.', this );\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( ! targetObject.material.materials ) {\n\n\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.', this );\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\ttargetObject = targetObject.material.materials;\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'bones':\n\n\t\t\t\t\tif ( ! targetObject.skeleton ) {\n\n\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.', this );\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// potential future optimization: skip this if propertyIndex is already an integer\n\t\t\t\t\t// and convert the integer string to a true integer.\n\n\t\t\t\t\ttargetObject = targetObject.skeleton.bones;\n\n\t\t\t\t\t// support resolving morphTarget names into indices.\n\t\t\t\t\tfor ( let i = 0; i < targetObject.length; i ++ ) {\n\n\t\t\t\t\t\tif ( targetObject[ i ].name === objectIndex ) {\n\n\t\t\t\t\t\t\tobjectIndex = i;\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'map':\n\n\t\t\t\t\tif ( 'map' in targetObject ) {\n\n\t\t\t\t\t\ttargetObject = targetObject.map;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( ! targetObject.material ) {\n\n\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to material as node does not have a material.', this );\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( ! targetObject.material.map ) {\n\n\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.', this );\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\ttargetObject = targetObject.material.map;\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\n\t\t\t\t\tif ( targetObject[ objectName ] === undefined ) {\n\n\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to objectName of node undefined.', this );\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\ttargetObject = targetObject[ objectName ];\n\n\t\t\t}\n\n\n\t\t\tif ( objectIndex !== undefined ) {\n\n\t\t\t\tif ( targetObject[ objectIndex ] === undefined ) {\n\n\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.', this, targetObject );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\ttargetObject = targetObject[ objectIndex ];\n\n\t\t\t}\n\n\t\t}\n\n\t\t// resolve property\n\t\tconst nodeProperty = targetObject[ propertyName ];\n\n\t\tif ( nodeProperty === undefined ) {\n\n\t\t\tconst nodeName = parsedPath.nodeName;\n\n\t\t\tconsole.error( 'THREE.PropertyBinding: Trying to update property for track: ' + nodeName +\n\t\t\t\t'.' + propertyName + ' but it wasn\\'t found.', targetObject );\n\t\t\treturn;\n\n\t\t}\n\n\t\t// determine versioning scheme\n\t\tlet versioning = this.Versioning.None;\n\n\t\tthis.targetObject = targetObject;\n\n\t\tif ( targetObject.needsUpdate !== undefined ) { // material\n\n\t\t\tversioning = this.Versioning.NeedsUpdate;\n\n\t\t} else if ( targetObject.matrixWorldNeedsUpdate !== undefined ) { // node transform\n\n\t\t\tversioning = this.Versioning.MatrixWorldNeedsUpdate;\n\n\t\t}\n\n\t\t// determine how the property gets bound\n\t\tlet bindingType = this.BindingType.Direct;\n\n\t\tif ( propertyIndex !== undefined ) {\n\n\t\t\t// access a sub element of the property array (only primitives are supported right now)\n\n\t\t\tif ( propertyName === 'morphTargetInfluences' ) {\n\n\t\t\t\t// potential optimization, skip this if propertyIndex is already an integer, and convert the integer string to a true integer.\n\n\t\t\t\t// support resolving morphTarget names into indices.\n\t\t\t\tif ( ! targetObject.geometry ) {\n\n\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.', this );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\tif ( ! targetObject.geometry.morphAttributes ) {\n\n\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.', this );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\tif ( targetObject.morphTargetDictionary[ propertyIndex ] !== undefined ) {\n\n\t\t\t\t\tpropertyIndex = targetObject.morphTargetDictionary[ propertyIndex ];\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tbindingType = this.BindingType.ArrayElement;\n\n\t\t\tthis.resolvedProperty = nodeProperty;\n\t\t\tthis.propertyIndex = propertyIndex;\n\n\t\t} else if ( nodeProperty.fromArray !== undefined && nodeProperty.toArray !== undefined ) {\n\n\t\t\t// must use copy for Object3D.Euler/Quaternion\n\n\t\t\tbindingType = this.BindingType.HasFromToArray;\n\n\t\t\tthis.resolvedProperty = nodeProperty;\n\n\t\t} else if ( Array.isArray( nodeProperty ) ) {\n\n\t\t\tbindingType = this.BindingType.EntireArray;\n\n\t\t\tthis.resolvedProperty = nodeProperty;\n\n\t\t} else {\n\n\t\t\tthis.propertyName = propertyName;\n\n\t\t}\n\n\t\t// select getter / setter\n\t\tthis.getValue = this.GetterByBindingType[ bindingType ];\n\t\tthis.setValue = this.SetterByBindingTypeAndVersioning[ bindingType ][ versioning ];\n\n\t}\n\n\tunbind() {\n\n\t\tthis.node = null;\n\n\t\t// back to the prototype version of getValue / setValue\n\t\t// note: avoiding to mutate the shape of 'this' via 'delete'\n\t\tthis.getValue = this._getValue_unbound;\n\t\tthis.setValue = this._setValue_unbound;\n\n\t}\n\n}\n\nPropertyBinding.Composite = Composite;\n\nPropertyBinding.prototype.BindingType = {\n\tDirect: 0,\n\tEntireArray: 1,\n\tArrayElement: 2,\n\tHasFromToArray: 3\n};\n\nPropertyBinding.prototype.Versioning = {\n\tNone: 0,\n\tNeedsUpdate: 1,\n\tMatrixWorldNeedsUpdate: 2\n};\n\nPropertyBinding.prototype.GetterByBindingType = [\n\n\tPropertyBinding.prototype._getValue_direct,\n\tPropertyBinding.prototype._getValue_array,\n\tPropertyBinding.prototype._getValue_arrayElement,\n\tPropertyBinding.prototype._getValue_toArray,\n\n];\n\nPropertyBinding.prototype.SetterByBindingTypeAndVersioning = [\n\n\t[\n\t\t// Direct\n\t\tPropertyBinding.prototype._setValue_direct,\n\t\tPropertyBinding.prototype._setValue_direct_setNeedsUpdate,\n\t\tPropertyBinding.prototype._setValue_direct_setMatrixWorldNeedsUpdate,\n\n\t], [\n\n\t\t// EntireArray\n\n\t\tPropertyBinding.prototype._setValue_array,\n\t\tPropertyBinding.prototype._setValue_array_setNeedsUpdate,\n\t\tPropertyBinding.prototype._setValue_array_setMatrixWorldNeedsUpdate,\n\n\t], [\n\n\t\t// ArrayElement\n\t\tPropertyBinding.prototype._setValue_arrayElement,\n\t\tPropertyBinding.prototype._setValue_arrayElement_setNeedsUpdate,\n\t\tPropertyBinding.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate,\n\n\t], [\n\n\t\t// HasToFromArray\n\t\tPropertyBinding.prototype._setValue_fromArray,\n\t\tPropertyBinding.prototype._setValue_fromArray_setNeedsUpdate,\n\t\tPropertyBinding.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate,\n\n\t]\n\n];\n\n/**\n *\n * A group of objects that receives a shared animation state.\n *\n * Usage:\n *\n *  - Add objects you would otherwise pass as 'root' to the\n *    constructor or the .clipAction method of AnimationMixer.\n *\n *  - Instead pass this object as 'root'.\n *\n *  - You can also add and remove objects later when the mixer\n *    is running.\n *\n * Note:\n *\n *    Objects of this class appear as one object to the mixer,\n *    so cache control of the individual objects must be done\n *    on the group.\n *\n * Limitation:\n *\n *  - The animated properties must be compatible among the\n *    all objects in the group.\n *\n *  - A single property can either be controlled through a\n *    target group or directly, but not both.\n */\n\nclass AnimationObjectGroup {\n\n\tconstructor() {\n\n\t\tthis.isAnimationObjectGroup = true;\n\n\t\tthis.uuid = generateUUID();\n\n\t\t// cached objects followed by the active ones\n\t\tthis._objects = Array.prototype.slice.call( arguments );\n\n\t\tthis.nCachedObjects_ = 0; // threshold\n\t\t// note: read by PropertyBinding.Composite\n\n\t\tconst indices = {};\n\t\tthis._indicesByUUID = indices; // for bookkeeping\n\n\t\tfor ( let i = 0, n = arguments.length; i !== n; ++ i ) {\n\n\t\t\tindices[ arguments[ i ].uuid ] = i;\n\n\t\t}\n\n\t\tthis._paths = []; // inside: string\n\t\tthis._parsedPaths = []; // inside: { we don't care, here }\n\t\tthis._bindings = []; // inside: Array< PropertyBinding >\n\t\tthis._bindingsIndicesByPath = {}; // inside: indices in these arrays\n\n\t\tconst scope = this;\n\n\t\tthis.stats = {\n\n\t\t\tobjects: {\n\t\t\t\tget total() {\n\n\t\t\t\t\treturn scope._objects.length;\n\n\t\t\t\t},\n\t\t\t\tget inUse() {\n\n\t\t\t\t\treturn this.total - scope.nCachedObjects_;\n\n\t\t\t\t}\n\t\t\t},\n\t\t\tget bindingsPerObject() {\n\n\t\t\t\treturn scope._bindings.length;\n\n\t\t\t}\n\n\t\t};\n\n\t}\n\n\tadd() {\n\n\t\tconst objects = this._objects,\n\t\t\tindicesByUUID = this._indicesByUUID,\n\t\t\tpaths = this._paths,\n\t\t\tparsedPaths = this._parsedPaths,\n\t\t\tbindings = this._bindings,\n\t\t\tnBindings = bindings.length;\n\n\t\tlet knownObject = undefined,\n\t\t\tnObjects = objects.length,\n\t\t\tnCachedObjects = this.nCachedObjects_;\n\n\t\tfor ( let i = 0, n = arguments.length; i !== n; ++ i ) {\n\n\t\t\tconst object = arguments[ i ],\n\t\t\t\tuuid = object.uuid;\n\t\t\tlet index = indicesByUUID[ uuid ];\n\n\t\t\tif ( index === undefined ) {\n\n\t\t\t\t// unknown object -> add it to the ACTIVE region\n\n\t\t\t\tindex = nObjects ++;\n\t\t\t\tindicesByUUID[ uuid ] = index;\n\t\t\t\tobjects.push( object );\n\n\t\t\t\t// accounting is done, now do the same for all bindings\n\n\t\t\t\tfor ( let j = 0, m = nBindings; j !== m; ++ j ) {\n\n\t\t\t\t\tbindings[ j ].push( new PropertyBinding( object, paths[ j ], parsedPaths[ j ] ) );\n\n\t\t\t\t}\n\n\t\t\t} else if ( index < nCachedObjects ) {\n\n\t\t\t\tknownObject = objects[ index ];\n\n\t\t\t\t// move existing object to the ACTIVE region\n\n\t\t\t\tconst firstActiveIndex = -- nCachedObjects,\n\t\t\t\t\tlastCachedObject = objects[ firstActiveIndex ];\n\n\t\t\t\tindicesByUUID[ lastCachedObject.uuid ] = index;\n\t\t\t\tobjects[ index ] = lastCachedObject;\n\n\t\t\t\tindicesByUUID[ uuid ] = firstActiveIndex;\n\t\t\t\tobjects[ firstActiveIndex ] = object;\n\n\t\t\t\t// accounting is done, now do the same for all bindings\n\n\t\t\t\tfor ( let j = 0, m = nBindings; j !== m; ++ j ) {\n\n\t\t\t\t\tconst bindingsForPath = bindings[ j ],\n\t\t\t\t\t\tlastCached = bindingsForPath[ firstActiveIndex ];\n\n\t\t\t\t\tlet binding = bindingsForPath[ index ];\n\n\t\t\t\t\tbindingsForPath[ index ] = lastCached;\n\n\t\t\t\t\tif ( binding === undefined ) {\n\n\t\t\t\t\t\t// since we do not bother to create new bindings\n\t\t\t\t\t\t// for objects that are cached, the binding may\n\t\t\t\t\t\t// or may not exist\n\n\t\t\t\t\t\tbinding = new PropertyBinding( object, paths[ j ], parsedPaths[ j ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbindingsForPath[ firstActiveIndex ] = binding;\n\n\t\t\t\t}\n\n\t\t\t} else if ( objects[ index ] !== knownObject ) {\n\n\t\t\t\tconsole.error( 'THREE.AnimationObjectGroup: Different objects with the same UUID ' +\n\t\t\t\t\t'detected. Clean the caches or recreate your infrastructure when reloading scenes.' );\n\n\t\t\t} // else the object is already where we want it to be\n\n\t\t} // for arguments\n\n\t\tthis.nCachedObjects_ = nCachedObjects;\n\n\t}\n\n\tremove() {\n\n\t\tconst objects = this._objects,\n\t\t\tindicesByUUID = this._indicesByUUID,\n\t\t\tbindings = this._bindings,\n\t\t\tnBindings = bindings.length;\n\n\t\tlet nCachedObjects = this.nCachedObjects_;\n\n\t\tfor ( let i = 0, n = arguments.length; i !== n; ++ i ) {\n\n\t\t\tconst object = arguments[ i ],\n\t\t\t\tuuid = object.uuid,\n\t\t\t\tindex = indicesByUUID[ uuid ];\n\n\t\t\tif ( index !== undefined && index >= nCachedObjects ) {\n\n\t\t\t\t// move existing object into the CACHED region\n\n\t\t\t\tconst lastCachedIndex = nCachedObjects ++,\n\t\t\t\t\tfirstActiveObject = objects[ lastCachedIndex ];\n\n\t\t\t\tindicesByUUID[ firstActiveObject.uuid ] = index;\n\t\t\t\tobjects[ index ] = firstActiveObject;\n\n\t\t\t\tindicesByUUID[ uuid ] = lastCachedIndex;\n\t\t\t\tobjects[ lastCachedIndex ] = object;\n\n\t\t\t\t// accounting is done, now do the same for all bindings\n\n\t\t\t\tfor ( let j = 0, m = nBindings; j !== m; ++ j ) {\n\n\t\t\t\t\tconst bindingsForPath = bindings[ j ],\n\t\t\t\t\t\tfirstActive = bindingsForPath[ lastCachedIndex ],\n\t\t\t\t\t\tbinding = bindingsForPath[ index ];\n\n\t\t\t\t\tbindingsForPath[ index ] = firstActive;\n\t\t\t\t\tbindingsForPath[ lastCachedIndex ] = binding;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} // for arguments\n\n\t\tthis.nCachedObjects_ = nCachedObjects;\n\n\t}\n\n\t// remove & forget\n\tuncache() {\n\n\t\tconst objects = this._objects,\n\t\t\tindicesByUUID = this._indicesByUUID,\n\t\t\tbindings = this._bindings,\n\t\t\tnBindings = bindings.length;\n\n\t\tlet nCachedObjects = this.nCachedObjects_,\n\t\t\tnObjects = objects.length;\n\n\t\tfor ( let i = 0, n = arguments.length; i !== n; ++ i ) {\n\n\t\t\tconst object = arguments[ i ],\n\t\t\t\tuuid = object.uuid,\n\t\t\t\tindex = indicesByUUID[ uuid ];\n\n\t\t\tif ( index !== undefined ) {\n\n\t\t\t\tdelete indicesByUUID[ uuid ];\n\n\t\t\t\tif ( index < nCachedObjects ) {\n\n\t\t\t\t\t// object is cached, shrink the CACHED region\n\n\t\t\t\t\tconst firstActiveIndex = -- nCachedObjects,\n\t\t\t\t\t\tlastCachedObject = objects[ firstActiveIndex ],\n\t\t\t\t\t\tlastIndex = -- nObjects,\n\t\t\t\t\t\tlastObject = objects[ lastIndex ];\n\n\t\t\t\t\t// last cached object takes this object's place\n\t\t\t\t\tindicesByUUID[ lastCachedObject.uuid ] = index;\n\t\t\t\t\tobjects[ index ] = lastCachedObject;\n\n\t\t\t\t\t// last object goes to the activated slot and pop\n\t\t\t\t\tindicesByUUID[ lastObject.uuid ] = firstActiveIndex;\n\t\t\t\t\tobjects[ firstActiveIndex ] = lastObject;\n\t\t\t\t\tobjects.pop();\n\n\t\t\t\t\t// accounting is done, now do the same for all bindings\n\n\t\t\t\t\tfor ( let j = 0, m = nBindings; j !== m; ++ j ) {\n\n\t\t\t\t\t\tconst bindingsForPath = bindings[ j ],\n\t\t\t\t\t\t\tlastCached = bindingsForPath[ firstActiveIndex ],\n\t\t\t\t\t\t\tlast = bindingsForPath[ lastIndex ];\n\n\t\t\t\t\t\tbindingsForPath[ index ] = lastCached;\n\t\t\t\t\t\tbindingsForPath[ firstActiveIndex ] = last;\n\t\t\t\t\t\tbindingsForPath.pop();\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// object is active, just swap with the last and pop\n\n\t\t\t\t\tconst lastIndex = -- nObjects,\n\t\t\t\t\t\tlastObject = objects[ lastIndex ];\n\n\t\t\t\t\tif ( lastIndex > 0 ) {\n\n\t\t\t\t\t\tindicesByUUID[ lastObject.uuid ] = index;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tobjects[ index ] = lastObject;\n\t\t\t\t\tobjects.pop();\n\n\t\t\t\t\t// accounting is done, now do the same for all bindings\n\n\t\t\t\t\tfor ( let j = 0, m = nBindings; j !== m; ++ j ) {\n\n\t\t\t\t\t\tconst bindingsForPath = bindings[ j ];\n\n\t\t\t\t\t\tbindingsForPath[ index ] = bindingsForPath[ lastIndex ];\n\t\t\t\t\t\tbindingsForPath.pop();\n\n\t\t\t\t\t}\n\n\t\t\t\t} // cached or active\n\n\t\t\t} // if object is known\n\n\t\t} // for arguments\n\n\t\tthis.nCachedObjects_ = nCachedObjects;\n\n\t}\n\n\t// Internal interface used by befriended PropertyBinding.Composite:\n\n\tsubscribe_( path, parsedPath ) {\n\n\t\t// returns an array of bindings for the given path that is changed\n\t\t// according to the contained objects in the group\n\n\t\tconst indicesByPath = this._bindingsIndicesByPath;\n\t\tlet index = indicesByPath[ path ];\n\t\tconst bindings = this._bindings;\n\n\t\tif ( index !== undefined ) return bindings[ index ];\n\n\t\tconst paths = this._paths,\n\t\t\tparsedPaths = this._parsedPaths,\n\t\t\tobjects = this._objects,\n\t\t\tnObjects = objects.length,\n\t\t\tnCachedObjects = this.nCachedObjects_,\n\t\t\tbindingsForPath = new Array( nObjects );\n\n\t\tindex = bindings.length;\n\n\t\tindicesByPath[ path ] = index;\n\n\t\tpaths.push( path );\n\t\tparsedPaths.push( parsedPath );\n\t\tbindings.push( bindingsForPath );\n\n\t\tfor ( let i = nCachedObjects, n = objects.length; i !== n; ++ i ) {\n\n\t\t\tconst object = objects[ i ];\n\t\t\tbindingsForPath[ i ] = new PropertyBinding( object, path, parsedPath );\n\n\t\t}\n\n\t\treturn bindingsForPath;\n\n\t}\n\n\tunsubscribe_( path ) {\n\n\t\t// tells the group to forget about a property path and no longer\n\t\t// update the array previously obtained with 'subscribe_'\n\n\t\tconst indicesByPath = this._bindingsIndicesByPath,\n\t\t\tindex = indicesByPath[ path ];\n\n\t\tif ( index !== undefined ) {\n\n\t\t\tconst paths = this._paths,\n\t\t\t\tparsedPaths = this._parsedPaths,\n\t\t\t\tbindings = this._bindings,\n\t\t\t\tlastBindingsIndex = bindings.length - 1,\n\t\t\t\tlastBindings = bindings[ lastBindingsIndex ],\n\t\t\t\tlastBindingsPath = path[ lastBindingsIndex ];\n\n\t\t\tindicesByPath[ lastBindingsPath ] = index;\n\n\t\t\tbindings[ index ] = lastBindings;\n\t\t\tbindings.pop();\n\n\t\t\tparsedPaths[ index ] = parsedPaths[ lastBindingsIndex ];\n\t\t\tparsedPaths.pop();\n\n\t\t\tpaths[ index ] = paths[ lastBindingsIndex ];\n\t\t\tpaths.pop();\n\n\t\t}\n\n\t}\n\n}\n\nclass AnimationAction {\n\n\tconstructor( mixer, clip, localRoot = null, blendMode = clip.blendMode ) {\n\n\t\tthis._mixer = mixer;\n\t\tthis._clip = clip;\n\t\tthis._localRoot = localRoot;\n\t\tthis.blendMode = blendMode;\n\n\t\tconst tracks = clip.tracks,\n\t\t\tnTracks = tracks.length,\n\t\t\tinterpolants = new Array( nTracks );\n\n\t\tconst interpolantSettings = {\n\t\t\tendingStart: ZeroCurvatureEnding,\n\t\t\tendingEnd: ZeroCurvatureEnding\n\t\t};\n\n\t\tfor ( let i = 0; i !== nTracks; ++ i ) {\n\n\t\t\tconst interpolant = tracks[ i ].createInterpolant( null );\n\t\t\tinterpolants[ i ] = interpolant;\n\t\t\tinterpolant.settings = interpolantSettings;\n\n\t\t}\n\n\t\tthis._interpolantSettings = interpolantSettings;\n\n\t\tthis._interpolants = interpolants; // bound by the mixer\n\n\t\t// inside: PropertyMixer (managed by the mixer)\n\t\tthis._propertyBindings = new Array( nTracks );\n\n\t\tthis._cacheIndex = null; // for the memory manager\n\t\tthis._byClipCacheIndex = null; // for the memory manager\n\n\t\tthis._timeScaleInterpolant = null;\n\t\tthis._weightInterpolant = null;\n\n\t\tthis.loop = LoopRepeat;\n\t\tthis._loopCount = - 1;\n\n\t\t// global mixer time when the action is to be started\n\t\t// it's set back to 'null' upon start of the action\n\t\tthis._startTime = null;\n\n\t\t// scaled local time of the action\n\t\t// gets clamped or wrapped to 0..clip.duration according to loop\n\t\tthis.time = 0;\n\n\t\tthis.timeScale = 1;\n\t\tthis._effectiveTimeScale = 1;\n\n\t\tthis.weight = 1;\n\t\tthis._effectiveWeight = 1;\n\n\t\tthis.repetitions = Infinity; // no. of repetitions when looping\n\n\t\tthis.paused = false; // true -> zero effective time scale\n\t\tthis.enabled = true; // false -> zero effective weight\n\n\t\tthis.clampWhenFinished = false;// keep feeding the last frame?\n\n\t\tthis.zeroSlopeAtStart = true;// for smooth interpolation w/o separate\n\t\tthis.zeroSlopeAtEnd = true;// clips for start, loop and end\n\n\t}\n\n\t// State & Scheduling\n\n\tplay() {\n\n\t\tthis._mixer._activateAction( this );\n\n\t\treturn this;\n\n\t}\n\n\tstop() {\n\n\t\tthis._mixer._deactivateAction( this );\n\n\t\treturn this.reset();\n\n\t}\n\n\treset() {\n\n\t\tthis.paused = false;\n\t\tthis.enabled = true;\n\n\t\tthis.time = 0; // restart clip\n\t\tthis._loopCount = - 1;// forget previous loops\n\t\tthis._startTime = null;// forget scheduling\n\n\t\treturn this.stopFading().stopWarping();\n\n\t}\n\n\tisRunning() {\n\n\t\treturn this.enabled && ! this.paused && this.timeScale !== 0 &&\n\t\t\tthis._startTime === null && this._mixer._isActiveAction( this );\n\n\t}\n\n\t// return true when play has been called\n\tisScheduled() {\n\n\t\treturn this._mixer._isActiveAction( this );\n\n\t}\n\n\tstartAt( time ) {\n\n\t\tthis._startTime = time;\n\n\t\treturn this;\n\n\t}\n\n\tsetLoop( mode, repetitions ) {\n\n\t\tthis.loop = mode;\n\t\tthis.repetitions = repetitions;\n\n\t\treturn this;\n\n\t}\n\n\t// Weight\n\n\t// set the weight stopping any scheduled fading\n\t// although .enabled = false yields an effective weight of zero, this\n\t// method does *not* change .enabled, because it would be confusing\n\tsetEffectiveWeight( weight ) {\n\n\t\tthis.weight = weight;\n\n\t\t// note: same logic as when updated at runtime\n\t\tthis._effectiveWeight = this.enabled ? weight : 0;\n\n\t\treturn this.stopFading();\n\n\t}\n\n\t// return the weight considering fading and .enabled\n\tgetEffectiveWeight() {\n\n\t\treturn this._effectiveWeight;\n\n\t}\n\n\tfadeIn( duration ) {\n\n\t\treturn this._scheduleFading( duration, 0, 1 );\n\n\t}\n\n\tfadeOut( duration ) {\n\n\t\treturn this._scheduleFading( duration, 1, 0 );\n\n\t}\n\n\tcrossFadeFrom( fadeOutAction, duration, warp ) {\n\n\t\tfadeOutAction.fadeOut( duration );\n\t\tthis.fadeIn( duration );\n\n\t\tif ( warp ) {\n\n\t\t\tconst fadeInDuration = this._clip.duration,\n\t\t\t\tfadeOutDuration = fadeOutAction._clip.duration,\n\n\t\t\t\tstartEndRatio = fadeOutDuration / fadeInDuration,\n\t\t\t\tendStartRatio = fadeInDuration / fadeOutDuration;\n\n\t\t\tfadeOutAction.warp( 1.0, startEndRatio, duration );\n\t\t\tthis.warp( endStartRatio, 1.0, duration );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tcrossFadeTo( fadeInAction, duration, warp ) {\n\n\t\treturn fadeInAction.crossFadeFrom( this, duration, warp );\n\n\t}\n\n\tstopFading() {\n\n\t\tconst weightInterpolant = this._weightInterpolant;\n\n\t\tif ( weightInterpolant !== null ) {\n\n\t\t\tthis._weightInterpolant = null;\n\t\t\tthis._mixer._takeBackControlInterpolant( weightInterpolant );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t// Time Scale Control\n\n\t// set the time scale stopping any scheduled warping\n\t// although .paused = true yields an effective time scale of zero, this\n\t// method does *not* change .paused, because it would be confusing\n\tsetEffectiveTimeScale( timeScale ) {\n\n\t\tthis.timeScale = timeScale;\n\t\tthis._effectiveTimeScale = this.paused ? 0 : timeScale;\n\n\t\treturn this.stopWarping();\n\n\t}\n\n\t// return the time scale considering warping and .paused\n\tgetEffectiveTimeScale() {\n\n\t\treturn this._effectiveTimeScale;\n\n\t}\n\n\tsetDuration( duration ) {\n\n\t\tthis.timeScale = this._clip.duration / duration;\n\n\t\treturn this.stopWarping();\n\n\t}\n\n\tsyncWith( action ) {\n\n\t\tthis.time = action.time;\n\t\tthis.timeScale = action.timeScale;\n\n\t\treturn this.stopWarping();\n\n\t}\n\n\thalt( duration ) {\n\n\t\treturn this.warp( this._effectiveTimeScale, 0, duration );\n\n\t}\n\n\twarp( startTimeScale, endTimeScale, duration ) {\n\n\t\tconst mixer = this._mixer,\n\t\t\tnow = mixer.time,\n\t\t\ttimeScale = this.timeScale;\n\n\t\tlet interpolant = this._timeScaleInterpolant;\n\n\t\tif ( interpolant === null ) {\n\n\t\t\tinterpolant = mixer._lendControlInterpolant();\n\t\t\tthis._timeScaleInterpolant = interpolant;\n\n\t\t}\n\n\t\tconst times = interpolant.parameterPositions,\n\t\t\tvalues = interpolant.sampleValues;\n\n\t\ttimes[ 0 ] = now;\n\t\ttimes[ 1 ] = now + duration;\n\n\t\tvalues[ 0 ] = startTimeScale / timeScale;\n\t\tvalues[ 1 ] = endTimeScale / timeScale;\n\n\t\treturn this;\n\n\t}\n\n\tstopWarping() {\n\n\t\tconst timeScaleInterpolant = this._timeScaleInterpolant;\n\n\t\tif ( timeScaleInterpolant !== null ) {\n\n\t\t\tthis._timeScaleInterpolant = null;\n\t\t\tthis._mixer._takeBackControlInterpolant( timeScaleInterpolant );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t// Object Accessors\n\n\tgetMixer() {\n\n\t\treturn this._mixer;\n\n\t}\n\n\tgetClip() {\n\n\t\treturn this._clip;\n\n\t}\n\n\tgetRoot() {\n\n\t\treturn this._localRoot || this._mixer._root;\n\n\t}\n\n\t// Interna\n\n\t_update( time, deltaTime, timeDirection, accuIndex ) {\n\n\t\t// called by the mixer\n\n\t\tif ( ! this.enabled ) {\n\n\t\t\t// call ._updateWeight() to update ._effectiveWeight\n\n\t\t\tthis._updateWeight( time );\n\t\t\treturn;\n\n\t\t}\n\n\t\tconst startTime = this._startTime;\n\n\t\tif ( startTime !== null ) {\n\n\t\t\t// check for scheduled start of action\n\n\t\t\tconst timeRunning = ( time - startTime ) * timeDirection;\n\t\t\tif ( timeRunning < 0 || timeDirection === 0 ) {\n\n\t\t\t\tdeltaTime = 0;\n\n\t\t\t} else {\n\n\n\t\t\t\tthis._startTime = null; // unschedule\n\t\t\t\tdeltaTime = timeDirection * timeRunning;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// apply time scale and advance time\n\n\t\tdeltaTime *= this._updateTimeScale( time );\n\t\tconst clipTime = this._updateTime( deltaTime );\n\n\t\t// note: _updateTime may disable the action resulting in\n\t\t// an effective weight of 0\n\n\t\tconst weight = this._updateWeight( time );\n\n\t\tif ( weight > 0 ) {\n\n\t\t\tconst interpolants = this._interpolants;\n\t\t\tconst propertyMixers = this._propertyBindings;\n\n\t\t\tswitch ( this.blendMode ) {\n\n\t\t\t\tcase AdditiveAnimationBlendMode:\n\n\t\t\t\t\tfor ( let j = 0, m = interpolants.length; j !== m; ++ j ) {\n\n\t\t\t\t\t\tinterpolants[ j ].evaluate( clipTime );\n\t\t\t\t\t\tpropertyMixers[ j ].accumulateAdditive( weight );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase NormalAnimationBlendMode:\n\t\t\t\tdefault:\n\n\t\t\t\t\tfor ( let j = 0, m = interpolants.length; j !== m; ++ j ) {\n\n\t\t\t\t\t\tinterpolants[ j ].evaluate( clipTime );\n\t\t\t\t\t\tpropertyMixers[ j ].accumulate( accuIndex, weight );\n\n\t\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t_updateWeight( time ) {\n\n\t\tlet weight = 0;\n\n\t\tif ( this.enabled ) {\n\n\t\t\tweight = this.weight;\n\t\t\tconst interpolant = this._weightInterpolant;\n\n\t\t\tif ( interpolant !== null ) {\n\n\t\t\t\tconst interpolantValue = interpolant.evaluate( time )[ 0 ];\n\n\t\t\t\tweight *= interpolantValue;\n\n\t\t\t\tif ( time > interpolant.parameterPositions[ 1 ] ) {\n\n\t\t\t\t\tthis.stopFading();\n\n\t\t\t\t\tif ( interpolantValue === 0 ) {\n\n\t\t\t\t\t\t// faded out, disable\n\t\t\t\t\t\tthis.enabled = false;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis._effectiveWeight = weight;\n\t\treturn weight;\n\n\t}\n\n\t_updateTimeScale( time ) {\n\n\t\tlet timeScale = 0;\n\n\t\tif ( ! this.paused ) {\n\n\t\t\ttimeScale = this.timeScale;\n\n\t\t\tconst interpolant = this._timeScaleInterpolant;\n\n\t\t\tif ( interpolant !== null ) {\n\n\t\t\t\tconst interpolantValue = interpolant.evaluate( time )[ 0 ];\n\n\t\t\t\ttimeScale *= interpolantValue;\n\n\t\t\t\tif ( time > interpolant.parameterPositions[ 1 ] ) {\n\n\t\t\t\t\tthis.stopWarping();\n\n\t\t\t\t\tif ( timeScale === 0 ) {\n\n\t\t\t\t\t\t// motion has halted, pause\n\t\t\t\t\t\tthis.paused = true;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// warp done - apply final time scale\n\t\t\t\t\t\tthis.timeScale = timeScale;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis._effectiveTimeScale = timeScale;\n\t\treturn timeScale;\n\n\t}\n\n\t_updateTime( deltaTime ) {\n\n\t\tconst duration = this._clip.duration;\n\t\tconst loop = this.loop;\n\n\t\tlet time = this.time + deltaTime;\n\t\tlet loopCount = this._loopCount;\n\n\t\tconst pingPong = ( loop === LoopPingPong );\n\n\t\tif ( deltaTime === 0 ) {\n\n\t\t\tif ( loopCount === - 1 ) return time;\n\n\t\t\treturn ( pingPong && ( loopCount & 1 ) === 1 ) ? duration - time : time;\n\n\t\t}\n\n\t\tif ( loop === LoopOnce ) {\n\n\t\t\tif ( loopCount === - 1 ) {\n\n\t\t\t\t// just started\n\n\t\t\t\tthis._loopCount = 0;\n\t\t\t\tthis._setEndings( true, true, false );\n\n\t\t\t}\n\n\t\t\thandle_stop: {\n\n\t\t\t\tif ( time >= duration ) {\n\n\t\t\t\t\ttime = duration;\n\n\t\t\t\t} else if ( time < 0 ) {\n\n\t\t\t\t\ttime = 0;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis.time = time;\n\n\t\t\t\t\tbreak handle_stop;\n\n\t\t\t\t}\n\n\t\t\t\tif ( this.clampWhenFinished ) this.paused = true;\n\t\t\t\telse this.enabled = false;\n\n\t\t\t\tthis.time = time;\n\n\t\t\t\tthis._mixer.dispatchEvent( {\n\t\t\t\t\ttype: 'finished', action: this,\n\t\t\t\t\tdirection: deltaTime < 0 ? - 1 : 1\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t} else { // repetitive Repeat or PingPong\n\n\t\t\tif ( loopCount === - 1 ) {\n\n\t\t\t\t// just started\n\n\t\t\t\tif ( deltaTime >= 0 ) {\n\n\t\t\t\t\tloopCount = 0;\n\n\t\t\t\t\tthis._setEndings( true, this.repetitions === 0, pingPong );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// when looping in reverse direction, the initial\n\t\t\t\t\t// transition through zero counts as a repetition,\n\t\t\t\t\t// so leave loopCount at -1\n\n\t\t\t\t\tthis._setEndings( this.repetitions === 0, true, pingPong );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( time >= duration || time < 0 ) {\n\n\t\t\t\t// wrap around\n\n\t\t\t\tconst loopDelta = Math.floor( time / duration ); // signed\n\t\t\t\ttime -= duration * loopDelta;\n\n\t\t\t\tloopCount += Math.abs( loopDelta );\n\n\t\t\t\tconst pending = this.repetitions - loopCount;\n\n\t\t\t\tif ( pending <= 0 ) {\n\n\t\t\t\t\t// have to stop (switch state, clamp time, fire event)\n\n\t\t\t\t\tif ( this.clampWhenFinished ) this.paused = true;\n\t\t\t\t\telse this.enabled = false;\n\n\t\t\t\t\ttime = deltaTime > 0 ? duration : 0;\n\n\t\t\t\t\tthis.time = time;\n\n\t\t\t\t\tthis._mixer.dispatchEvent( {\n\t\t\t\t\t\ttype: 'finished', action: this,\n\t\t\t\t\t\tdirection: deltaTime > 0 ? 1 : - 1\n\t\t\t\t\t} );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// keep running\n\n\t\t\t\t\tif ( pending === 1 ) {\n\n\t\t\t\t\t\t// entering the last round\n\n\t\t\t\t\t\tconst atStart = deltaTime < 0;\n\t\t\t\t\t\tthis._setEndings( atStart, ! atStart, pingPong );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tthis._setEndings( false, false, pingPong );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tthis._loopCount = loopCount;\n\n\t\t\t\t\tthis.time = time;\n\n\t\t\t\t\tthis._mixer.dispatchEvent( {\n\t\t\t\t\t\ttype: 'loop', action: this, loopDelta: loopDelta\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tthis.time = time;\n\n\t\t\t}\n\n\t\t\tif ( pingPong && ( loopCount & 1 ) === 1 ) {\n\n\t\t\t\t// invert time for the \"pong round\"\n\n\t\t\t\treturn duration - time;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn time;\n\n\t}\n\n\t_setEndings( atStart, atEnd, pingPong ) {\n\n\t\tconst settings = this._interpolantSettings;\n\n\t\tif ( pingPong ) {\n\n\t\t\tsettings.endingStart = ZeroSlopeEnding;\n\t\t\tsettings.endingEnd = ZeroSlopeEnding;\n\n\t\t} else {\n\n\t\t\t// assuming for LoopOnce atStart == atEnd == true\n\n\t\t\tif ( atStart ) {\n\n\t\t\t\tsettings.endingStart = this.zeroSlopeAtStart ? ZeroSlopeEnding : ZeroCurvatureEnding;\n\n\t\t\t} else {\n\n\t\t\t\tsettings.endingStart = WrapAroundEnding;\n\n\t\t\t}\n\n\t\t\tif ( atEnd ) {\n\n\t\t\t\tsettings.endingEnd = this.zeroSlopeAtEnd ? ZeroSlopeEnding : ZeroCurvatureEnding;\n\n\t\t\t} else {\n\n\t\t\t\tsettings.endingEnd \t = WrapAroundEnding;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t_scheduleFading( duration, weightNow, weightThen ) {\n\n\t\tconst mixer = this._mixer, now = mixer.time;\n\t\tlet interpolant = this._weightInterpolant;\n\n\t\tif ( interpolant === null ) {\n\n\t\t\tinterpolant = mixer._lendControlInterpolant();\n\t\t\tthis._weightInterpolant = interpolant;\n\n\t\t}\n\n\t\tconst times = interpolant.parameterPositions,\n\t\t\tvalues = interpolant.sampleValues;\n\n\t\ttimes[ 0 ] = now;\n\t\tvalues[ 0 ] = weightNow;\n\t\ttimes[ 1 ] = now + duration;\n\t\tvalues[ 1 ] = weightThen;\n\n\t\treturn this;\n\n\t}\n\n}\n\nconst _controlInterpolantsResultBuffer = new Float32Array( 1 );\n\n\nclass AnimationMixer extends EventDispatcher {\n\n\tconstructor( root ) {\n\n\t\tsuper();\n\n\t\tthis._root = root;\n\t\tthis._initMemoryManager();\n\t\tthis._accuIndex = 0;\n\t\tthis.time = 0;\n\t\tthis.timeScale = 1.0;\n\n\t}\n\n\t_bindAction( action, prototypeAction ) {\n\n\t\tconst root = action._localRoot || this._root,\n\t\t\ttracks = action._clip.tracks,\n\t\t\tnTracks = tracks.length,\n\t\t\tbindings = action._propertyBindings,\n\t\t\tinterpolants = action._interpolants,\n\t\t\trootUuid = root.uuid,\n\t\t\tbindingsByRoot = this._bindingsByRootAndName;\n\n\t\tlet bindingsByName = bindingsByRoot[ rootUuid ];\n\n\t\tif ( bindingsByName === undefined ) {\n\n\t\t\tbindingsByName = {};\n\t\t\tbindingsByRoot[ rootUuid ] = bindingsByName;\n\n\t\t}\n\n\t\tfor ( let i = 0; i !== nTracks; ++ i ) {\n\n\t\t\tconst track = tracks[ i ],\n\t\t\t\ttrackName = track.name;\n\n\t\t\tlet binding = bindingsByName[ trackName ];\n\n\t\t\tif ( binding !== undefined ) {\n\n\t\t\t\t++ binding.referenceCount;\n\t\t\t\tbindings[ i ] = binding;\n\n\t\t\t} else {\n\n\t\t\t\tbinding = bindings[ i ];\n\n\t\t\t\tif ( binding !== undefined ) {\n\n\t\t\t\t\t// existing binding, make sure the cache knows\n\n\t\t\t\t\tif ( binding._cacheIndex === null ) {\n\n\t\t\t\t\t\t++ binding.referenceCount;\n\t\t\t\t\t\tthis._addInactiveBinding( binding, rootUuid, trackName );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tcontinue;\n\n\t\t\t\t}\n\n\t\t\t\tconst path = prototypeAction && prototypeAction.\n\t\t\t\t\t_propertyBindings[ i ].binding.parsedPath;\n\n\t\t\t\tbinding = new PropertyMixer(\n\t\t\t\t\tPropertyBinding.create( root, trackName, path ),\n\t\t\t\t\ttrack.ValueTypeName, track.getValueSize() );\n\n\t\t\t\t++ binding.referenceCount;\n\t\t\t\tthis._addInactiveBinding( binding, rootUuid, trackName );\n\n\t\t\t\tbindings[ i ] = binding;\n\n\t\t\t}\n\n\t\t\tinterpolants[ i ].resultBuffer = binding.buffer;\n\n\t\t}\n\n\t}\n\n\t_activateAction( action ) {\n\n\t\tif ( ! this._isActiveAction( action ) ) {\n\n\t\t\tif ( action._cacheIndex === null ) {\n\n\t\t\t\t// this action has been forgotten by the cache, but the user\n\t\t\t\t// appears to be still using it -> rebind\n\n\t\t\t\tconst rootUuid = ( action._localRoot || this._root ).uuid,\n\t\t\t\t\tclipUuid = action._clip.uuid,\n\t\t\t\t\tactionsForClip = this._actionsByClip[ clipUuid ];\n\n\t\t\t\tthis._bindAction( action,\n\t\t\t\t\tactionsForClip && actionsForClip.knownActions[ 0 ] );\n\n\t\t\t\tthis._addInactiveAction( action, clipUuid, rootUuid );\n\n\t\t\t}\n\n\t\t\tconst bindings = action._propertyBindings;\n\n\t\t\t// increment reference counts / sort out state\n\t\t\tfor ( let i = 0, n = bindings.length; i !== n; ++ i ) {\n\n\t\t\t\tconst binding = bindings[ i ];\n\n\t\t\t\tif ( binding.useCount ++ === 0 ) {\n\n\t\t\t\t\tthis._lendBinding( binding );\n\t\t\t\t\tbinding.saveOriginalState();\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis._lendAction( action );\n\n\t\t}\n\n\t}\n\n\t_deactivateAction( action ) {\n\n\t\tif ( this._isActiveAction( action ) ) {\n\n\t\t\tconst bindings = action._propertyBindings;\n\n\t\t\t// decrement reference counts / sort out state\n\t\t\tfor ( let i = 0, n = bindings.length; i !== n; ++ i ) {\n\n\t\t\t\tconst binding = bindings[ i ];\n\n\t\t\t\tif ( -- binding.useCount === 0 ) {\n\n\t\t\t\t\tbinding.restoreOriginalState();\n\t\t\t\t\tthis._takeBackBinding( binding );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis._takeBackAction( action );\n\n\t\t}\n\n\t}\n\n\t// Memory manager\n\n\t_initMemoryManager() {\n\n\t\tthis._actions = []; // 'nActiveActions' followed by inactive ones\n\t\tthis._nActiveActions = 0;\n\n\t\tthis._actionsByClip = {};\n\t\t// inside:\n\t\t// {\n\t\t// \tknownActions: Array< AnimationAction > - used as prototypes\n\t\t// \tactionByRoot: AnimationAction - lookup\n\t\t// }\n\n\n\t\tthis._bindings = []; // 'nActiveBindings' followed by inactive ones\n\t\tthis._nActiveBindings = 0;\n\n\t\tthis._bindingsByRootAndName = {}; // inside: Map< name, PropertyMixer >\n\n\n\t\tthis._controlInterpolants = []; // same game as above\n\t\tthis._nActiveControlInterpolants = 0;\n\n\t\tconst scope = this;\n\n\t\tthis.stats = {\n\n\t\t\tactions: {\n\t\t\t\tget total() {\n\n\t\t\t\t\treturn scope._actions.length;\n\n\t\t\t\t},\n\t\t\t\tget inUse() {\n\n\t\t\t\t\treturn scope._nActiveActions;\n\n\t\t\t\t}\n\t\t\t},\n\t\t\tbindings: {\n\t\t\t\tget total() {\n\n\t\t\t\t\treturn scope._bindings.length;\n\n\t\t\t\t},\n\t\t\t\tget inUse() {\n\n\t\t\t\t\treturn scope._nActiveBindings;\n\n\t\t\t\t}\n\t\t\t},\n\t\t\tcontrolInterpolants: {\n\t\t\t\tget total() {\n\n\t\t\t\t\treturn scope._controlInterpolants.length;\n\n\t\t\t\t},\n\t\t\t\tget inUse() {\n\n\t\t\t\t\treturn scope._nActiveControlInterpolants;\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t};\n\n\t}\n\n\t// Memory management for AnimationAction objects\n\n\t_isActiveAction( action ) {\n\n\t\tconst index = action._cacheIndex;\n\t\treturn index !== null && index < this._nActiveActions;\n\n\t}\n\n\t_addInactiveAction( action, clipUuid, rootUuid ) {\n\n\t\tconst actions = this._actions,\n\t\t\tactionsByClip = this._actionsByClip;\n\n\t\tlet actionsForClip = actionsByClip[ clipUuid ];\n\n\t\tif ( actionsForClip === undefined ) {\n\n\t\t\tactionsForClip = {\n\n\t\t\t\tknownActions: [ action ],\n\t\t\t\tactionByRoot: {}\n\n\t\t\t};\n\n\t\t\taction._byClipCacheIndex = 0;\n\n\t\t\tactionsByClip[ clipUuid ] = actionsForClip;\n\n\t\t} else {\n\n\t\t\tconst knownActions = actionsForClip.knownActions;\n\n\t\t\taction._byClipCacheIndex = knownActions.length;\n\t\t\tknownActions.push( action );\n\n\t\t}\n\n\t\taction._cacheIndex = actions.length;\n\t\tactions.push( action );\n\n\t\tactionsForClip.actionByRoot[ rootUuid ] = action;\n\n\t}\n\n\t_removeInactiveAction( action ) {\n\n\t\tconst actions = this._actions,\n\t\t\tlastInactiveAction = actions[ actions.length - 1 ],\n\t\t\tcacheIndex = action._cacheIndex;\n\n\t\tlastInactiveAction._cacheIndex = cacheIndex;\n\t\tactions[ cacheIndex ] = lastInactiveAction;\n\t\tactions.pop();\n\n\t\taction._cacheIndex = null;\n\n\n\t\tconst clipUuid = action._clip.uuid,\n\t\t\tactionsByClip = this._actionsByClip,\n\t\t\tactionsForClip = actionsByClip[ clipUuid ],\n\t\t\tknownActionsForClip = actionsForClip.knownActions,\n\n\t\t\tlastKnownAction =\n\t\t\t\tknownActionsForClip[ knownActionsForClip.length - 1 ],\n\n\t\t\tbyClipCacheIndex = action._byClipCacheIndex;\n\n\t\tlastKnownAction._byClipCacheIndex = byClipCacheIndex;\n\t\tknownActionsForClip[ byClipCacheIndex ] = lastKnownAction;\n\t\tknownActionsForClip.pop();\n\n\t\taction._byClipCacheIndex = null;\n\n\n\t\tconst actionByRoot = actionsForClip.actionByRoot,\n\t\t\trootUuid = ( action._localRoot || this._root ).uuid;\n\n\t\tdelete actionByRoot[ rootUuid ];\n\n\t\tif ( knownActionsForClip.length === 0 ) {\n\n\t\t\tdelete actionsByClip[ clipUuid ];\n\n\t\t}\n\n\t\tthis._removeInactiveBindingsForAction( action );\n\n\t}\n\n\t_removeInactiveBindingsForAction( action ) {\n\n\t\tconst bindings = action._propertyBindings;\n\n\t\tfor ( let i = 0, n = bindings.length; i !== n; ++ i ) {\n\n\t\t\tconst binding = bindings[ i ];\n\n\t\t\tif ( -- binding.referenceCount === 0 ) {\n\n\t\t\t\tthis._removeInactiveBinding( binding );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t_lendAction( action ) {\n\n\t\t// [ active actions |  inactive actions  ]\n\t\t// [  active actions >| inactive actions ]\n\t\t//                 s        a\n\t\t//                  <-swap->\n\t\t//                 a        s\n\n\t\tconst actions = this._actions,\n\t\t\tprevIndex = action._cacheIndex,\n\n\t\t\tlastActiveIndex = this._nActiveActions ++,\n\n\t\t\tfirstInactiveAction = actions[ lastActiveIndex ];\n\n\t\taction._cacheIndex = lastActiveIndex;\n\t\tactions[ lastActiveIndex ] = action;\n\n\t\tfirstInactiveAction._cacheIndex = prevIndex;\n\t\tactions[ prevIndex ] = firstInactiveAction;\n\n\t}\n\n\t_takeBackAction( action ) {\n\n\t\t// [  active actions  | inactive actions ]\n\t\t// [ active actions |< inactive actions  ]\n\t\t//        a        s\n\t\t//         <-swap->\n\t\t//        s        a\n\n\t\tconst actions = this._actions,\n\t\t\tprevIndex = action._cacheIndex,\n\n\t\t\tfirstInactiveIndex = -- this._nActiveActions,\n\n\t\t\tlastActiveAction = actions[ firstInactiveIndex ];\n\n\t\taction._cacheIndex = firstInactiveIndex;\n\t\tactions[ firstInactiveIndex ] = action;\n\n\t\tlastActiveAction._cacheIndex = prevIndex;\n\t\tactions[ prevIndex ] = lastActiveAction;\n\n\t}\n\n\t// Memory management for PropertyMixer objects\n\n\t_addInactiveBinding( binding, rootUuid, trackName ) {\n\n\t\tconst bindingsByRoot = this._bindingsByRootAndName,\n\t\t\tbindings = this._bindings;\n\n\t\tlet bindingByName = bindingsByRoot[ rootUuid ];\n\n\t\tif ( bindingByName === undefined ) {\n\n\t\t\tbindingByName = {};\n\t\t\tbindingsByRoot[ rootUuid ] = bindingByName;\n\n\t\t}\n\n\t\tbindingByName[ trackName ] = binding;\n\n\t\tbinding._cacheIndex = bindings.length;\n\t\tbindings.push( binding );\n\n\t}\n\n\t_removeInactiveBinding( binding ) {\n\n\t\tconst bindings = this._bindings,\n\t\t\tpropBinding = binding.binding,\n\t\t\trootUuid = propBinding.rootNode.uuid,\n\t\t\ttrackName = propBinding.path,\n\t\t\tbindingsByRoot = this._bindingsByRootAndName,\n\t\t\tbindingByName = bindingsByRoot[ rootUuid ],\n\n\t\t\tlastInactiveBinding = bindings[ bindings.length - 1 ],\n\t\t\tcacheIndex = binding._cacheIndex;\n\n\t\tlastInactiveBinding._cacheIndex = cacheIndex;\n\t\tbindings[ cacheIndex ] = lastInactiveBinding;\n\t\tbindings.pop();\n\n\t\tdelete bindingByName[ trackName ];\n\n\t\tif ( Object.keys( bindingByName ).length === 0 ) {\n\n\t\t\tdelete bindingsByRoot[ rootUuid ];\n\n\t\t}\n\n\t}\n\n\t_lendBinding( binding ) {\n\n\t\tconst bindings = this._bindings,\n\t\t\tprevIndex = binding._cacheIndex,\n\n\t\t\tlastActiveIndex = this._nActiveBindings ++,\n\n\t\t\tfirstInactiveBinding = bindings[ lastActiveIndex ];\n\n\t\tbinding._cacheIndex = lastActiveIndex;\n\t\tbindings[ lastActiveIndex ] = binding;\n\n\t\tfirstInactiveBinding._cacheIndex = prevIndex;\n\t\tbindings[ prevIndex ] = firstInactiveBinding;\n\n\t}\n\n\t_takeBackBinding( binding ) {\n\n\t\tconst bindings = this._bindings,\n\t\t\tprevIndex = binding._cacheIndex,\n\n\t\t\tfirstInactiveIndex = -- this._nActiveBindings,\n\n\t\t\tlastActiveBinding = bindings[ firstInactiveIndex ];\n\n\t\tbinding._cacheIndex = firstInactiveIndex;\n\t\tbindings[ firstInactiveIndex ] = binding;\n\n\t\tlastActiveBinding._cacheIndex = prevIndex;\n\t\tbindings[ prevIndex ] = lastActiveBinding;\n\n\t}\n\n\n\t// Memory management of Interpolants for weight and time scale\n\n\t_lendControlInterpolant() {\n\n\t\tconst interpolants = this._controlInterpolants,\n\t\t\tlastActiveIndex = this._nActiveControlInterpolants ++;\n\n\t\tlet interpolant = interpolants[ lastActiveIndex ];\n\n\t\tif ( interpolant === undefined ) {\n\n\t\t\tinterpolant = new LinearInterpolant(\n\t\t\t\tnew Float32Array( 2 ), new Float32Array( 2 ),\n\t\t\t\t1, _controlInterpolantsResultBuffer );\n\n\t\t\tinterpolant.__cacheIndex = lastActiveIndex;\n\t\t\tinterpolants[ lastActiveIndex ] = interpolant;\n\n\t\t}\n\n\t\treturn interpolant;\n\n\t}\n\n\t_takeBackControlInterpolant( interpolant ) {\n\n\t\tconst interpolants = this._controlInterpolants,\n\t\t\tprevIndex = interpolant.__cacheIndex,\n\n\t\t\tfirstInactiveIndex = -- this._nActiveControlInterpolants,\n\n\t\t\tlastActiveInterpolant = interpolants[ firstInactiveIndex ];\n\n\t\tinterpolant.__cacheIndex = firstInactiveIndex;\n\t\tinterpolants[ firstInactiveIndex ] = interpolant;\n\n\t\tlastActiveInterpolant.__cacheIndex = prevIndex;\n\t\tinterpolants[ prevIndex ] = lastActiveInterpolant;\n\n\t}\n\n\t// return an action for a clip optionally using a custom root target\n\t// object (this method allocates a lot of dynamic memory in case a\n\t// previously unknown clip/root combination is specified)\n\tclipAction( clip, optionalRoot, blendMode ) {\n\n\t\tconst root = optionalRoot || this._root,\n\t\t\trootUuid = root.uuid;\n\n\t\tlet clipObject = typeof clip === 'string' ? AnimationClip.findByName( root, clip ) : clip;\n\n\t\tconst clipUuid = clipObject !== null ? clipObject.uuid : clip;\n\n\t\tconst actionsForClip = this._actionsByClip[ clipUuid ];\n\t\tlet prototypeAction = null;\n\n\t\tif ( blendMode === undefined ) {\n\n\t\t\tif ( clipObject !== null ) {\n\n\t\t\t\tblendMode = clipObject.blendMode;\n\n\t\t\t} else {\n\n\t\t\t\tblendMode = NormalAnimationBlendMode;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( actionsForClip !== undefined ) {\n\n\t\t\tconst existingAction = actionsForClip.actionByRoot[ rootUuid ];\n\n\t\t\tif ( existingAction !== undefined && existingAction.blendMode === blendMode ) {\n\n\t\t\t\treturn existingAction;\n\n\t\t\t}\n\n\t\t\t// we know the clip, so we don't have to parse all\n\t\t\t// the bindings again but can just copy\n\t\t\tprototypeAction = actionsForClip.knownActions[ 0 ];\n\n\t\t\t// also, take the clip from the prototype action\n\t\t\tif ( clipObject === null )\n\t\t\t\tclipObject = prototypeAction._clip;\n\n\t\t}\n\n\t\t// clip must be known when specified via string\n\t\tif ( clipObject === null ) return null;\n\n\t\t// allocate all resources required to run it\n\t\tconst newAction = new AnimationAction( this, clipObject, optionalRoot, blendMode );\n\n\t\tthis._bindAction( newAction, prototypeAction );\n\n\t\t// and make the action known to the memory manager\n\t\tthis._addInactiveAction( newAction, clipUuid, rootUuid );\n\n\t\treturn newAction;\n\n\t}\n\n\t// get an existing action\n\texistingAction( clip, optionalRoot ) {\n\n\t\tconst root = optionalRoot || this._root,\n\t\t\trootUuid = root.uuid,\n\n\t\t\tclipObject = typeof clip === 'string' ?\n\t\t\t\tAnimationClip.findByName( root, clip ) : clip,\n\n\t\t\tclipUuid = clipObject ? clipObject.uuid : clip,\n\n\t\t\tactionsForClip = this._actionsByClip[ clipUuid ];\n\n\t\tif ( actionsForClip !== undefined ) {\n\n\t\t\treturn actionsForClip.actionByRoot[ rootUuid ] || null;\n\n\t\t}\n\n\t\treturn null;\n\n\t}\n\n\t// deactivates all previously scheduled actions\n\tstopAllAction() {\n\n\t\tconst actions = this._actions,\n\t\t\tnActions = this._nActiveActions;\n\n\t\tfor ( let i = nActions - 1; i >= 0; -- i ) {\n\n\t\t\tactions[ i ].stop();\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t// advance the time and update apply the animation\n\tupdate( deltaTime ) {\n\n\t\tdeltaTime *= this.timeScale;\n\n\t\tconst actions = this._actions,\n\t\t\tnActions = this._nActiveActions,\n\n\t\t\ttime = this.time += deltaTime,\n\t\t\ttimeDirection = Math.sign( deltaTime ),\n\n\t\t\taccuIndex = this._accuIndex ^= 1;\n\n\t\t// run active actions\n\n\t\tfor ( let i = 0; i !== nActions; ++ i ) {\n\n\t\t\tconst action = actions[ i ];\n\n\t\t\taction._update( time, deltaTime, timeDirection, accuIndex );\n\n\t\t}\n\n\t\t// update scene graph\n\n\t\tconst bindings = this._bindings,\n\t\t\tnBindings = this._nActiveBindings;\n\n\t\tfor ( let i = 0; i !== nBindings; ++ i ) {\n\n\t\t\tbindings[ i ].apply( accuIndex );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t// Allows you to seek to a specific time in an animation.\n\tsetTime( timeInSeconds ) {\n\n\t\tthis.time = 0; // Zero out time attribute for AnimationMixer object;\n\t\tfor ( let i = 0; i < this._actions.length; i ++ ) {\n\n\t\t\tthis._actions[ i ].time = 0; // Zero out time attribute for all associated AnimationAction objects.\n\n\t\t}\n\n\t\treturn this.update( timeInSeconds ); // Update used to set exact time. Returns \"this\" AnimationMixer object.\n\n\t}\n\n\t// return this mixer's root target object\n\tgetRoot() {\n\n\t\treturn this._root;\n\n\t}\n\n\t// free all resources specific to a particular clip\n\tuncacheClip( clip ) {\n\n\t\tconst actions = this._actions,\n\t\t\tclipUuid = clip.uuid,\n\t\t\tactionsByClip = this._actionsByClip,\n\t\t\tactionsForClip = actionsByClip[ clipUuid ];\n\n\t\tif ( actionsForClip !== undefined ) {\n\n\t\t\t// note: just calling _removeInactiveAction would mess up the\n\t\t\t// iteration state and also require updating the state we can\n\t\t\t// just throw away\n\n\t\t\tconst actionsToRemove = actionsForClip.knownActions;\n\n\t\t\tfor ( let i = 0, n = actionsToRemove.length; i !== n; ++ i ) {\n\n\t\t\t\tconst action = actionsToRemove[ i ];\n\n\t\t\t\tthis._deactivateAction( action );\n\n\t\t\t\tconst cacheIndex = action._cacheIndex,\n\t\t\t\t\tlastInactiveAction = actions[ actions.length - 1 ];\n\n\t\t\t\taction._cacheIndex = null;\n\t\t\t\taction._byClipCacheIndex = null;\n\n\t\t\t\tlastInactiveAction._cacheIndex = cacheIndex;\n\t\t\t\tactions[ cacheIndex ] = lastInactiveAction;\n\t\t\t\tactions.pop();\n\n\t\t\t\tthis._removeInactiveBindingsForAction( action );\n\n\t\t\t}\n\n\t\t\tdelete actionsByClip[ clipUuid ];\n\n\t\t}\n\n\t}\n\n\t// free all resources specific to a particular root target object\n\tuncacheRoot( root ) {\n\n\t\tconst rootUuid = root.uuid,\n\t\t\tactionsByClip = this._actionsByClip;\n\n\t\tfor ( const clipUuid in actionsByClip ) {\n\n\t\t\tconst actionByRoot = actionsByClip[ clipUuid ].actionByRoot,\n\t\t\t\taction = actionByRoot[ rootUuid ];\n\n\t\t\tif ( action !== undefined ) {\n\n\t\t\t\tthis._deactivateAction( action );\n\t\t\t\tthis._removeInactiveAction( action );\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst bindingsByRoot = this._bindingsByRootAndName,\n\t\t\tbindingByName = bindingsByRoot[ rootUuid ];\n\n\t\tif ( bindingByName !== undefined ) {\n\n\t\t\tfor ( const trackName in bindingByName ) {\n\n\t\t\t\tconst binding = bindingByName[ trackName ];\n\t\t\t\tbinding.restoreOriginalState();\n\t\t\t\tthis._removeInactiveBinding( binding );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t// remove a targeted clip from the cache\n\tuncacheAction( clip, optionalRoot ) {\n\n\t\tconst action = this.existingAction( clip, optionalRoot );\n\n\t\tif ( action !== null ) {\n\n\t\t\tthis._deactivateAction( action );\n\t\t\tthis._removeInactiveAction( action );\n\n\t\t}\n\n\t}\n\n}\n\nclass Uniform {\n\n\tconstructor( value ) {\n\n\t\tthis.value = value;\n\n\t}\n\n\tclone() {\n\n\t\treturn new Uniform( this.value.clone === undefined ? this.value : this.value.clone() );\n\n\t}\n\n}\n\nlet id = 0;\n\nclass UniformsGroup extends EventDispatcher {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.isUniformsGroup = true;\n\n\t\tObject.defineProperty( this, 'id', { value: id ++ } );\n\n\t\tthis.name = '';\n\n\t\tthis.usage = StaticDrawUsage;\n\t\tthis.uniforms = [];\n\n\t}\n\n\tadd( uniform ) {\n\n\t\tthis.uniforms.push( uniform );\n\n\t\treturn this;\n\n\t}\n\n\tremove( uniform ) {\n\n\t\tconst index = this.uniforms.indexOf( uniform );\n\n\t\tif ( index !== - 1 ) this.uniforms.splice( index, 1 );\n\n\t\treturn this;\n\n\t}\n\n\tsetName( name ) {\n\n\t\tthis.name = name;\n\n\t\treturn this;\n\n\t}\n\n\tsetUsage( value ) {\n\n\t\tthis.usage = value;\n\n\t\treturn this;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t\treturn this;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.name = source.name;\n\t\tthis.usage = source.usage;\n\n\t\tconst uniformsSource = source.uniforms;\n\n\t\tthis.uniforms.length = 0;\n\n\t\tfor ( let i = 0, l = uniformsSource.length; i < l; i ++ ) {\n\n\t\t\tthis.uniforms.push( uniformsSource[ i ].clone() );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n}\n\nclass InstancedInterleavedBuffer extends InterleavedBuffer {\n\n\tconstructor( array, stride, meshPerAttribute = 1 ) {\n\n\t\tsuper( array, stride );\n\n\t\tthis.isInstancedInterleavedBuffer = true;\n\n\t\tthis.meshPerAttribute = meshPerAttribute;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.meshPerAttribute = source.meshPerAttribute;\n\n\t\treturn this;\n\n\t}\n\n\tclone( data ) {\n\n\t\tconst ib = super.clone( data );\n\n\t\tib.meshPerAttribute = this.meshPerAttribute;\n\n\t\treturn ib;\n\n\t}\n\n\ttoJSON( data ) {\n\n\t\tconst json = super.toJSON( data );\n\n\t\tjson.isInstancedInterleavedBuffer = true;\n\t\tjson.meshPerAttribute = this.meshPerAttribute;\n\n\t\treturn json;\n\n\t}\n\n}\n\nclass GLBufferAttribute {\n\n\tconstructor( buffer, type, itemSize, elementSize, count ) {\n\n\t\tthis.isGLBufferAttribute = true;\n\n\t\tthis.buffer = buffer;\n\t\tthis.type = type;\n\t\tthis.itemSize = itemSize;\n\t\tthis.elementSize = elementSize;\n\t\tthis.count = count;\n\n\t\tthis.version = 0;\n\n\t}\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) this.version ++;\n\n\t}\n\n\tsetBuffer( buffer ) {\n\n\t\tthis.buffer = buffer;\n\n\t\treturn this;\n\n\t}\n\n\tsetType( type, elementSize ) {\n\n\t\tthis.type = type;\n\t\tthis.elementSize = elementSize;\n\n\t\treturn this;\n\n\t}\n\n\tsetItemSize( itemSize ) {\n\n\t\tthis.itemSize = itemSize;\n\n\t\treturn this;\n\n\t}\n\n\tsetCount( count ) {\n\n\t\tthis.count = count;\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass Raycaster {\n\n\tconstructor( origin, direction, near = 0, far = Infinity ) {\n\n\t\tthis.ray = new Ray( origin, direction );\n\t\t// direction is assumed to be normalized (for accurate distance calculations)\n\n\t\tthis.near = near;\n\t\tthis.far = far;\n\t\tthis.camera = null;\n\t\tthis.layers = new Layers();\n\n\t\tthis.params = {\n\t\t\tMesh: {},\n\t\t\tLine: { threshold: 1 },\n\t\t\tLOD: {},\n\t\t\tPoints: { threshold: 1 },\n\t\t\tSprite: {}\n\t\t};\n\n\t}\n\n\tset( origin, direction ) {\n\n\t\t// direction is assumed to be normalized (for accurate distance calculations)\n\n\t\tthis.ray.set( origin, direction );\n\n\t}\n\n\tsetFromCamera( coords, camera ) {\n\n\t\tif ( camera.isPerspectiveCamera ) {\n\n\t\t\tthis.ray.origin.setFromMatrixPosition( camera.matrixWorld );\n\t\t\tthis.ray.direction.set( coords.x, coords.y, 0.5 ).unproject( camera ).sub( this.ray.origin ).normalize();\n\t\t\tthis.camera = camera;\n\n\t\t} else if ( camera.isOrthographicCamera ) {\n\n\t\t\tthis.ray.origin.set( coords.x, coords.y, ( camera.near + camera.far ) / ( camera.near - camera.far ) ).unproject( camera ); // set origin in plane of camera\n\t\t\tthis.ray.direction.set( 0, 0, - 1 ).transformDirection( camera.matrixWorld );\n\t\t\tthis.camera = camera;\n\n\t\t} else {\n\n\t\t\tconsole.error( 'THREE.Raycaster: Unsupported camera type: ' + camera.type );\n\n\t\t}\n\n\t}\n\n\tintersectObject( object, recursive = true, intersects = [] ) {\n\n\t\tintersectObject( object, this, intersects, recursive );\n\n\t\tintersects.sort( ascSort );\n\n\t\treturn intersects;\n\n\t}\n\n\tintersectObjects( objects, recursive = true, intersects = [] ) {\n\n\t\tfor ( let i = 0, l = objects.length; i < l; i ++ ) {\n\n\t\t\tintersectObject( objects[ i ], this, intersects, recursive );\n\n\t\t}\n\n\t\tintersects.sort( ascSort );\n\n\t\treturn intersects;\n\n\t}\n\n}\n\nfunction ascSort( a, b ) {\n\n\treturn a.distance - b.distance;\n\n}\n\nfunction intersectObject( object, raycaster, intersects, recursive ) {\n\n\tif ( object.layers.test( raycaster.layers ) ) {\n\n\t\tobject.raycast( raycaster, intersects );\n\n\t}\n\n\tif ( recursive === true ) {\n\n\t\tconst children = object.children;\n\n\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\tintersectObject( children[ i ], raycaster, intersects, true );\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * Ref: https://en.wikipedia.org/wiki/Spherical_coordinate_system\n *\n * The polar angle (phi) is measured from the positive y-axis. The positive y-axis is up.\n * The azimuthal angle (theta) is measured from the positive z-axis.\n */\n\nclass Spherical {\n\n\tconstructor( radius = 1, phi = 0, theta = 0 ) {\n\n\t\tthis.radius = radius;\n\t\tthis.phi = phi; // polar angle\n\t\tthis.theta = theta; // azimuthal angle\n\n\t\treturn this;\n\n\t}\n\n\tset( radius, phi, theta ) {\n\n\t\tthis.radius = radius;\n\t\tthis.phi = phi;\n\t\tthis.theta = theta;\n\n\t\treturn this;\n\n\t}\n\n\tcopy( other ) {\n\n\t\tthis.radius = other.radius;\n\t\tthis.phi = other.phi;\n\t\tthis.theta = other.theta;\n\n\t\treturn this;\n\n\t}\n\n\t// restrict phi to be between EPS and PI-EPS\n\tmakeSafe() {\n\n\t\tconst EPS = 0.000001;\n\t\tthis.phi = Math.max( EPS, Math.min( Math.PI - EPS, this.phi ) );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromVector3( v ) {\n\n\t\treturn this.setFromCartesianCoords( v.x, v.y, v.z );\n\n\t}\n\n\tsetFromCartesianCoords( x, y, z ) {\n\n\t\tthis.radius = Math.sqrt( x * x + y * y + z * z );\n\n\t\tif ( this.radius === 0 ) {\n\n\t\t\tthis.theta = 0;\n\t\t\tthis.phi = 0;\n\n\t\t} else {\n\n\t\t\tthis.theta = Math.atan2( x, z );\n\t\t\tthis.phi = Math.acos( clamp( y / this.radius, - 1, 1 ) );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n}\n\n/**\n * Ref: https://en.wikipedia.org/wiki/Cylindrical_coordinate_system\n */\n\nclass Cylindrical {\n\n\tconstructor( radius = 1, theta = 0, y = 0 ) {\n\n\t\tthis.radius = radius; // distance from the origin to a point in the x-z plane\n\t\tthis.theta = theta; // counterclockwise angle in the x-z plane measured in radians from the positive z-axis\n\t\tthis.y = y; // height above the x-z plane\n\n\t\treturn this;\n\n\t}\n\n\tset( radius, theta, y ) {\n\n\t\tthis.radius = radius;\n\t\tthis.theta = theta;\n\t\tthis.y = y;\n\n\t\treturn this;\n\n\t}\n\n\tcopy( other ) {\n\n\t\tthis.radius = other.radius;\n\t\tthis.theta = other.theta;\n\t\tthis.y = other.y;\n\n\t\treturn this;\n\n\t}\n\n\tsetFromVector3( v ) {\n\n\t\treturn this.setFromCartesianCoords( v.x, v.y, v.z );\n\n\t}\n\n\tsetFromCartesianCoords( x, y, z ) {\n\n\t\tthis.radius = Math.sqrt( x * x + z * z );\n\t\tthis.theta = Math.atan2( x, z );\n\t\tthis.y = y;\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n}\n\nconst _vector$4 = /*@__PURE__*/ new Vector2();\n\nclass Box2 {\n\n\tconstructor( min = new Vector2( + Infinity, + Infinity ), max = new Vector2( - Infinity, - Infinity ) ) {\n\n\t\tthis.isBox2 = true;\n\n\t\tthis.min = min;\n\t\tthis.max = max;\n\n\t}\n\n\tset( min, max ) {\n\n\t\tthis.min.copy( min );\n\t\tthis.max.copy( max );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromPoints( points ) {\n\n\t\tthis.makeEmpty();\n\n\t\tfor ( let i = 0, il = points.length; i < il; i ++ ) {\n\n\t\t\tthis.expandByPoint( points[ i ] );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetFromCenterAndSize( center, size ) {\n\n\t\tconst halfSize = _vector$4.copy( size ).multiplyScalar( 0.5 );\n\t\tthis.min.copy( center ).sub( halfSize );\n\t\tthis.max.copy( center ).add( halfSize );\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\tcopy( box ) {\n\n\t\tthis.min.copy( box.min );\n\t\tthis.max.copy( box.max );\n\n\t\treturn this;\n\n\t}\n\n\tmakeEmpty() {\n\n\t\tthis.min.x = this.min.y = + Infinity;\n\t\tthis.max.x = this.max.y = - Infinity;\n\n\t\treturn this;\n\n\t}\n\n\tisEmpty() {\n\n\t\t// this is a more robust check for empty than ( volume <= 0 ) because volume can get positive with two negative axes\n\n\t\treturn ( this.max.x < this.min.x ) || ( this.max.y < this.min.y );\n\n\t}\n\n\tgetCenter( target ) {\n\n\t\treturn this.isEmpty() ? target.set( 0, 0 ) : target.addVectors( this.min, this.max ).multiplyScalar( 0.5 );\n\n\t}\n\n\tgetSize( target ) {\n\n\t\treturn this.isEmpty() ? target.set( 0, 0 ) : target.subVectors( this.max, this.min );\n\n\t}\n\n\texpandByPoint( point ) {\n\n\t\tthis.min.min( point );\n\t\tthis.max.max( point );\n\n\t\treturn this;\n\n\t}\n\n\texpandByVector( vector ) {\n\n\t\tthis.min.sub( vector );\n\t\tthis.max.add( vector );\n\n\t\treturn this;\n\n\t}\n\n\texpandByScalar( scalar ) {\n\n\t\tthis.min.addScalar( - scalar );\n\t\tthis.max.addScalar( scalar );\n\n\t\treturn this;\n\n\t}\n\n\tcontainsPoint( point ) {\n\n\t\treturn point.x < this.min.x || point.x > this.max.x ||\n\t\t\tpoint.y < this.min.y || point.y > this.max.y ? false : true;\n\n\t}\n\n\tcontainsBox( box ) {\n\n\t\treturn this.min.x <= box.min.x && box.max.x <= this.max.x &&\n\t\t\tthis.min.y <= box.min.y && box.max.y <= this.max.y;\n\n\t}\n\n\tgetParameter( point, target ) {\n\n\t\t// This can potentially have a divide by zero if the box\n\t\t// has a size dimension of 0.\n\n\t\treturn target.set(\n\t\t\t( point.x - this.min.x ) / ( this.max.x - this.min.x ),\n\t\t\t( point.y - this.min.y ) / ( this.max.y - this.min.y )\n\t\t);\n\n\t}\n\n\tintersectsBox( box ) {\n\n\t\t// using 4 splitting planes to rule out intersections\n\n\t\treturn box.max.x < this.min.x || box.min.x > this.max.x ||\n\t\t\tbox.max.y < this.min.y || box.min.y > this.max.y ? false : true;\n\n\t}\n\n\tclampPoint( point, target ) {\n\n\t\treturn target.copy( point ).clamp( this.min, this.max );\n\n\t}\n\n\tdistanceToPoint( point ) {\n\n\t\tconst clampedPoint = _vector$4.copy( point ).clamp( this.min, this.max );\n\t\treturn clampedPoint.sub( point ).length();\n\n\t}\n\n\tintersect( box ) {\n\n\t\tthis.min.max( box.min );\n\t\tthis.max.min( box.max );\n\n\t\treturn this;\n\n\t}\n\n\tunion( box ) {\n\n\t\tthis.min.min( box.min );\n\t\tthis.max.max( box.max );\n\n\t\treturn this;\n\n\t}\n\n\ttranslate( offset ) {\n\n\t\tthis.min.add( offset );\n\t\tthis.max.add( offset );\n\n\t\treturn this;\n\n\t}\n\n\tequals( box ) {\n\n\t\treturn box.min.equals( this.min ) && box.max.equals( this.max );\n\n\t}\n\n}\n\nconst _startP = /*@__PURE__*/ new Vector3();\nconst _startEnd = /*@__PURE__*/ new Vector3();\n\nclass Line3 {\n\n\tconstructor( start = new Vector3(), end = new Vector3() ) {\n\n\t\tthis.start = start;\n\t\tthis.end = end;\n\n\t}\n\n\tset( start, end ) {\n\n\t\tthis.start.copy( start );\n\t\tthis.end.copy( end );\n\n\t\treturn this;\n\n\t}\n\n\tcopy( line ) {\n\n\t\tthis.start.copy( line.start );\n\t\tthis.end.copy( line.end );\n\n\t\treturn this;\n\n\t}\n\n\tgetCenter( target ) {\n\n\t\treturn target.addVectors( this.start, this.end ).multiplyScalar( 0.5 );\n\n\t}\n\n\tdelta( target ) {\n\n\t\treturn target.subVectors( this.end, this.start );\n\n\t}\n\n\tdistanceSq() {\n\n\t\treturn this.start.distanceToSquared( this.end );\n\n\t}\n\n\tdistance() {\n\n\t\treturn this.start.distanceTo( this.end );\n\n\t}\n\n\tat( t, target ) {\n\n\t\treturn this.delta( target ).multiplyScalar( t ).add( this.start );\n\n\t}\n\n\tclosestPointToPointParameter( point, clampToLine ) {\n\n\t\t_startP.subVectors( point, this.start );\n\t\t_startEnd.subVectors( this.end, this.start );\n\n\t\tconst startEnd2 = _startEnd.dot( _startEnd );\n\t\tconst startEnd_startP = _startEnd.dot( _startP );\n\n\t\tlet t = startEnd_startP / startEnd2;\n\n\t\tif ( clampToLine ) {\n\n\t\t\tt = clamp( t, 0, 1 );\n\n\t\t}\n\n\t\treturn t;\n\n\t}\n\n\tclosestPointToPoint( point, clampToLine, target ) {\n\n\t\tconst t = this.closestPointToPointParameter( point, clampToLine );\n\n\t\treturn this.delta( target ).multiplyScalar( t ).add( this.start );\n\n\t}\n\n\tapplyMatrix4( matrix ) {\n\n\t\tthis.start.applyMatrix4( matrix );\n\t\tthis.end.applyMatrix4( matrix );\n\n\t\treturn this;\n\n\t}\n\n\tequals( line ) {\n\n\t\treturn line.start.equals( this.start ) && line.end.equals( this.end );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n}\n\nconst _vector$3 = /*@__PURE__*/ new Vector3();\n\nclass SpotLightHelper extends Object3D {\n\n\tconstructor( light, color ) {\n\n\t\tsuper();\n\n\t\tthis.light = light;\n\n\t\tthis.matrix = light.matrixWorld;\n\t\tthis.matrixAutoUpdate = false;\n\n\t\tthis.color = color;\n\n\t\tthis.type = 'SpotLightHelper';\n\n\t\tconst geometry = new BufferGeometry();\n\n\t\tconst positions = [\n\t\t\t0, 0, 0, \t0, 0, 1,\n\t\t\t0, 0, 0, \t1, 0, 1,\n\t\t\t0, 0, 0,\t- 1, 0, 1,\n\t\t\t0, 0, 0, \t0, 1, 1,\n\t\t\t0, 0, 0, \t0, - 1, 1\n\t\t];\n\n\t\tfor ( let i = 0, j = 1, l = 32; i < l; i ++, j ++ ) {\n\n\t\t\tconst p1 = ( i / l ) * Math.PI * 2;\n\t\t\tconst p2 = ( j / l ) * Math.PI * 2;\n\n\t\t\tpositions.push(\n\t\t\t\tMath.cos( p1 ), Math.sin( p1 ), 1,\n\t\t\t\tMath.cos( p2 ), Math.sin( p2 ), 1\n\t\t\t);\n\n\t\t}\n\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( positions, 3 ) );\n\n\t\tconst material = new LineBasicMaterial( { fog: false, toneMapped: false } );\n\n\t\tthis.cone = new LineSegments( geometry, material );\n\t\tthis.add( this.cone );\n\n\t\tthis.update();\n\n\t}\n\n\tdispose() {\n\n\t\tthis.cone.geometry.dispose();\n\t\tthis.cone.material.dispose();\n\n\t}\n\n\tupdate() {\n\n\t\tthis.light.updateWorldMatrix( true, false );\n\t\tthis.light.target.updateWorldMatrix( true, false );\n\n\t\tconst coneLength = this.light.distance ? this.light.distance : 1000;\n\t\tconst coneWidth = coneLength * Math.tan( this.light.angle );\n\n\t\tthis.cone.scale.set( coneWidth, coneWidth, coneLength );\n\n\t\t_vector$3.setFromMatrixPosition( this.light.target.matrixWorld );\n\n\t\tthis.cone.lookAt( _vector$3 );\n\n\t\tif ( this.color !== undefined ) {\n\n\t\t\tthis.cone.material.color.set( this.color );\n\n\t\t} else {\n\n\t\t\tthis.cone.material.color.copy( this.light.color );\n\n\t\t}\n\n\t}\n\n}\n\nconst _vector$2 = /*@__PURE__*/ new Vector3();\nconst _boneMatrix = /*@__PURE__*/ new Matrix4();\nconst _matrixWorldInv = /*@__PURE__*/ new Matrix4();\n\n\nclass SkeletonHelper extends LineSegments {\n\n\tconstructor( object ) {\n\n\t\tconst bones = getBoneList( object );\n\n\t\tconst geometry = new BufferGeometry();\n\n\t\tconst vertices = [];\n\t\tconst colors = [];\n\n\t\tconst color1 = new Color( 0, 0, 1 );\n\t\tconst color2 = new Color( 0, 1, 0 );\n\n\t\tfor ( let i = 0; i < bones.length; i ++ ) {\n\n\t\t\tconst bone = bones[ i ];\n\n\t\t\tif ( bone.parent && bone.parent.isBone ) {\n\n\t\t\t\tvertices.push( 0, 0, 0 );\n\t\t\t\tvertices.push( 0, 0, 0 );\n\t\t\t\tcolors.push( color1.r, color1.g, color1.b );\n\t\t\t\tcolors.push( color2.r, color2.g, color2.b );\n\n\t\t\t}\n\n\t\t}\n\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tgeometry.setAttribute( 'color', new Float32BufferAttribute( colors, 3 ) );\n\n\t\tconst material = new LineBasicMaterial( { vertexColors: true, depthTest: false, depthWrite: false, toneMapped: false, transparent: true } );\n\n\t\tsuper( geometry, material );\n\n\t\tthis.isSkeletonHelper = true;\n\n\t\tthis.type = 'SkeletonHelper';\n\n\t\tthis.root = object;\n\t\tthis.bones = bones;\n\n\t\tthis.matrix = object.matrixWorld;\n\t\tthis.matrixAutoUpdate = false;\n\n\t}\n\n\tupdateMatrixWorld( force ) {\n\n\t\tconst bones = this.bones;\n\n\t\tconst geometry = this.geometry;\n\t\tconst position = geometry.getAttribute( 'position' );\n\n\t\t_matrixWorldInv.copy( this.root.matrixWorld ).invert();\n\n\t\tfor ( let i = 0, j = 0; i < bones.length; i ++ ) {\n\n\t\t\tconst bone = bones[ i ];\n\n\t\t\tif ( bone.parent && bone.parent.isBone ) {\n\n\t\t\t\t_boneMatrix.multiplyMatrices( _matrixWorldInv, bone.matrixWorld );\n\t\t\t\t_vector$2.setFromMatrixPosition( _boneMatrix );\n\t\t\t\tposition.setXYZ( j, _vector$2.x, _vector$2.y, _vector$2.z );\n\n\t\t\t\t_boneMatrix.multiplyMatrices( _matrixWorldInv, bone.parent.matrixWorld );\n\t\t\t\t_vector$2.setFromMatrixPosition( _boneMatrix );\n\t\t\t\tposition.setXYZ( j + 1, _vector$2.x, _vector$2.y, _vector$2.z );\n\n\t\t\t\tj += 2;\n\n\t\t\t}\n\n\t\t}\n\n\t\tgeometry.getAttribute( 'position' ).needsUpdate = true;\n\n\t\tsuper.updateMatrixWorld( force );\n\n\t}\n\n\tdispose() {\n\n\t\tthis.geometry.dispose();\n\t\tthis.material.dispose();\n\n\t}\n\n}\n\n\nfunction getBoneList( object ) {\n\n\tconst boneList = [];\n\n\tif ( object.isBone === true ) {\n\n\t\tboneList.push( object );\n\n\t}\n\n\tfor ( let i = 0; i < object.children.length; i ++ ) {\n\n\t\tboneList.push.apply( boneList, getBoneList( object.children[ i ] ) );\n\n\t}\n\n\treturn boneList;\n\n}\n\nclass PointLightHelper extends Mesh {\n\n\tconstructor( light, sphereSize, color ) {\n\n\t\tconst geometry = new SphereGeometry( sphereSize, 4, 2 );\n\t\tconst material = new MeshBasicMaterial( { wireframe: true, fog: false, toneMapped: false } );\n\n\t\tsuper( geometry, material );\n\n\t\tthis.light = light;\n\n\t\tthis.color = color;\n\n\t\tthis.type = 'PointLightHelper';\n\n\t\tthis.matrix = this.light.matrixWorld;\n\t\tthis.matrixAutoUpdate = false;\n\n\t\tthis.update();\n\n\n\t\t/*\n\t// TODO: delete this comment?\n\tconst distanceGeometry = new THREE.IcosahedronGeometry( 1, 2 );\n\tconst distanceMaterial = new THREE.MeshBasicMaterial( { color: hexColor, fog: false, wireframe: true, opacity: 0.1, transparent: true } );\n\n\tthis.lightSphere = new THREE.Mesh( bulbGeometry, bulbMaterial );\n\tthis.lightDistance = new THREE.Mesh( distanceGeometry, distanceMaterial );\n\n\tconst d = light.distance;\n\n\tif ( d === 0.0 ) {\n\n\t\tthis.lightDistance.visible = false;\n\n\t} else {\n\n\t\tthis.lightDistance.scale.set( d, d, d );\n\n\t}\n\n\tthis.add( this.lightDistance );\n\t*/\n\n\t}\n\n\tdispose() {\n\n\t\tthis.geometry.dispose();\n\t\tthis.material.dispose();\n\n\t}\n\n\tupdate() {\n\n\t\tthis.light.updateWorldMatrix( true, false );\n\n\t\tif ( this.color !== undefined ) {\n\n\t\t\tthis.material.color.set( this.color );\n\n\t\t} else {\n\n\t\t\tthis.material.color.copy( this.light.color );\n\n\t\t}\n\n\t\t/*\n\t\tconst d = this.light.distance;\n\n\t\tif ( d === 0.0 ) {\n\n\t\t\tthis.lightDistance.visible = false;\n\n\t\t} else {\n\n\t\t\tthis.lightDistance.visible = true;\n\t\t\tthis.lightDistance.scale.set( d, d, d );\n\n\t\t}\n\t\t*/\n\n\t}\n\n}\n\nconst _vector$1 = /*@__PURE__*/ new Vector3();\nconst _color1 = /*@__PURE__*/ new Color();\nconst _color2 = /*@__PURE__*/ new Color();\n\nclass HemisphereLightHelper extends Object3D {\n\n\tconstructor( light, size, color ) {\n\n\t\tsuper();\n\n\t\tthis.light = light;\n\n\t\tthis.matrix = light.matrixWorld;\n\t\tthis.matrixAutoUpdate = false;\n\n\t\tthis.color = color;\n\n\t\tthis.type = 'HemisphereLightHelper';\n\n\t\tconst geometry = new OctahedronGeometry( size );\n\t\tgeometry.rotateY( Math.PI * 0.5 );\n\n\t\tthis.material = new MeshBasicMaterial( { wireframe: true, fog: false, toneMapped: false } );\n\t\tif ( this.color === undefined ) this.material.vertexColors = true;\n\n\t\tconst position = geometry.getAttribute( 'position' );\n\t\tconst colors = new Float32Array( position.count * 3 );\n\n\t\tgeometry.setAttribute( 'color', new BufferAttribute( colors, 3 ) );\n\n\t\tthis.add( new Mesh( geometry, this.material ) );\n\n\t\tthis.update();\n\n\t}\n\n\tdispose() {\n\n\t\tthis.children[ 0 ].geometry.dispose();\n\t\tthis.children[ 0 ].material.dispose();\n\n\t}\n\n\tupdate() {\n\n\t\tconst mesh = this.children[ 0 ];\n\n\t\tif ( this.color !== undefined ) {\n\n\t\t\tthis.material.color.set( this.color );\n\n\t\t} else {\n\n\t\t\tconst colors = mesh.geometry.getAttribute( 'color' );\n\n\t\t\t_color1.copy( this.light.color );\n\t\t\t_color2.copy( this.light.groundColor );\n\n\t\t\tfor ( let i = 0, l = colors.count; i < l; i ++ ) {\n\n\t\t\t\tconst color = ( i < ( l / 2 ) ) ? _color1 : _color2;\n\n\t\t\t\tcolors.setXYZ( i, color.r, color.g, color.b );\n\n\t\t\t}\n\n\t\t\tcolors.needsUpdate = true;\n\n\t\t}\n\n\t\tthis.light.updateWorldMatrix( true, false );\n\n\t\tmesh.lookAt( _vector$1.setFromMatrixPosition( this.light.matrixWorld ).negate() );\n\n\t}\n\n}\n\nclass GridHelper extends LineSegments {\n\n\tconstructor( size = 10, divisions = 10, color1 = 0x444444, color2 = 0x888888 ) {\n\n\t\tcolor1 = new Color( color1 );\n\t\tcolor2 = new Color( color2 );\n\n\t\tconst center = divisions / 2;\n\t\tconst step = size / divisions;\n\t\tconst halfSize = size / 2;\n\n\t\tconst vertices = [], colors = [];\n\n\t\tfor ( let i = 0, j = 0, k = - halfSize; i <= divisions; i ++, k += step ) {\n\n\t\t\tvertices.push( - halfSize, 0, k, halfSize, 0, k );\n\t\t\tvertices.push( k, 0, - halfSize, k, 0, halfSize );\n\n\t\t\tconst color = i === center ? color1 : color2;\n\n\t\t\tcolor.toArray( colors, j ); j += 3;\n\t\t\tcolor.toArray( colors, j ); j += 3;\n\t\t\tcolor.toArray( colors, j ); j += 3;\n\t\t\tcolor.toArray( colors, j ); j += 3;\n\n\t\t}\n\n\t\tconst geometry = new BufferGeometry();\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tgeometry.setAttribute( 'color', new Float32BufferAttribute( colors, 3 ) );\n\n\t\tconst material = new LineBasicMaterial( { vertexColors: true, toneMapped: false } );\n\n\t\tsuper( geometry, material );\n\n\t\tthis.type = 'GridHelper';\n\n\t}\n\n\tdispose() {\n\n\t\tthis.geometry.dispose();\n\t\tthis.material.dispose();\n\n\t}\n\n}\n\nclass PolarGridHelper extends LineSegments {\n\n\tconstructor( radius = 10, sectors = 16, rings = 8, divisions = 64, color1 = 0x444444, color2 = 0x888888 ) {\n\n\t\tcolor1 = new Color( color1 );\n\t\tcolor2 = new Color( color2 );\n\n\t\tconst vertices = [];\n\t\tconst colors = [];\n\n\t\t// create the sectors\n\n\t\tif ( sectors > 1 ) {\n\n\t\t\tfor ( let i = 0; i < sectors; i ++ ) {\n\n\t\t\t\tconst v = ( i / sectors ) * ( Math.PI * 2 );\n\n\t\t\t\tconst x = Math.sin( v ) * radius;\n\t\t\t\tconst z = Math.cos( v ) * radius;\n\n\t\t\t\tvertices.push( 0, 0, 0 );\n\t\t\t\tvertices.push( x, 0, z );\n\n\t\t\t\tconst color = ( i & 1 ) ? color1 : color2;\n\n\t\t\t\tcolors.push( color.r, color.g, color.b );\n\t\t\t\tcolors.push( color.r, color.g, color.b );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// create the rings\n\n\t\tfor ( let i = 0; i < rings; i ++ ) {\n\n\t\t\tconst color = ( i & 1 ) ? color1 : color2;\n\n\t\t\tconst r = radius - ( radius / rings * i );\n\n\t\t\tfor ( let j = 0; j < divisions; j ++ ) {\n\n\t\t\t\t// first vertex\n\n\t\t\t\tlet v = ( j / divisions ) * ( Math.PI * 2 );\n\n\t\t\t\tlet x = Math.sin( v ) * r;\n\t\t\t\tlet z = Math.cos( v ) * r;\n\n\t\t\t\tvertices.push( x, 0, z );\n\t\t\t\tcolors.push( color.r, color.g, color.b );\n\n\t\t\t\t// second vertex\n\n\t\t\t\tv = ( ( j + 1 ) / divisions ) * ( Math.PI * 2 );\n\n\t\t\t\tx = Math.sin( v ) * r;\n\t\t\t\tz = Math.cos( v ) * r;\n\n\t\t\t\tvertices.push( x, 0, z );\n\t\t\t\tcolors.push( color.r, color.g, color.b );\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst geometry = new BufferGeometry();\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tgeometry.setAttribute( 'color', new Float32BufferAttribute( colors, 3 ) );\n\n\t\tconst material = new LineBasicMaterial( { vertexColors: true, toneMapped: false } );\n\n\t\tsuper( geometry, material );\n\n\t\tthis.type = 'PolarGridHelper';\n\n\t}\n\n\tdispose() {\n\n\t\tthis.geometry.dispose();\n\t\tthis.material.dispose();\n\n\t}\n\n}\n\nconst _v1 = /*@__PURE__*/ new Vector3();\nconst _v2 = /*@__PURE__*/ new Vector3();\nconst _v3 = /*@__PURE__*/ new Vector3();\n\nclass DirectionalLightHelper extends Object3D {\n\n\tconstructor( light, size, color ) {\n\n\t\tsuper();\n\n\t\tthis.light = light;\n\n\t\tthis.matrix = light.matrixWorld;\n\t\tthis.matrixAutoUpdate = false;\n\n\t\tthis.color = color;\n\n\t\tthis.type = 'DirectionalLightHelper';\n\n\t\tif ( size === undefined ) size = 1;\n\n\t\tlet geometry = new BufferGeometry();\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( [\n\t\t\t- size, size, 0,\n\t\t\tsize, size, 0,\n\t\t\tsize, - size, 0,\n\t\t\t- size, - size, 0,\n\t\t\t- size, size, 0\n\t\t], 3 ) );\n\n\t\tconst material = new LineBasicMaterial( { fog: false, toneMapped: false } );\n\n\t\tthis.lightPlane = new Line( geometry, material );\n\t\tthis.add( this.lightPlane );\n\n\t\tgeometry = new BufferGeometry();\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( [ 0, 0, 0, 0, 0, 1 ], 3 ) );\n\n\t\tthis.targetLine = new Line( geometry, material );\n\t\tthis.add( this.targetLine );\n\n\t\tthis.update();\n\n\t}\n\n\tdispose() {\n\n\t\tthis.lightPlane.geometry.dispose();\n\t\tthis.lightPlane.material.dispose();\n\t\tthis.targetLine.geometry.dispose();\n\t\tthis.targetLine.material.dispose();\n\n\t}\n\n\tupdate() {\n\n\t\tthis.light.updateWorldMatrix( true, false );\n\t\tthis.light.target.updateWorldMatrix( true, false );\n\n\t\t_v1.setFromMatrixPosition( this.light.matrixWorld );\n\t\t_v2.setFromMatrixPosition( this.light.target.matrixWorld );\n\t\t_v3.subVectors( _v2, _v1 );\n\n\t\tthis.lightPlane.lookAt( _v2 );\n\n\t\tif ( this.color !== undefined ) {\n\n\t\t\tthis.lightPlane.material.color.set( this.color );\n\t\t\tthis.targetLine.material.color.set( this.color );\n\n\t\t} else {\n\n\t\t\tthis.lightPlane.material.color.copy( this.light.color );\n\t\t\tthis.targetLine.material.color.copy( this.light.color );\n\n\t\t}\n\n\t\tthis.targetLine.lookAt( _v2 );\n\t\tthis.targetLine.scale.z = _v3.length();\n\n\t}\n\n}\n\nconst _vector = /*@__PURE__*/ new Vector3();\nconst _camera = /*@__PURE__*/ new Camera();\n\n/**\n *\t- shows frustum, line of sight and up of the camera\n *\t- suitable for fast updates\n * \t- based on frustum visualization in lightgl.js shadowmap example\n *\t\thttps://github.com/evanw/lightgl.js/blob/master/tests/shadowmap.html\n */\n\nclass CameraHelper extends LineSegments {\n\n\tconstructor( camera ) {\n\n\t\tconst geometry = new BufferGeometry();\n\t\tconst material = new LineBasicMaterial( { color: 0xffffff, vertexColors: true, toneMapped: false } );\n\n\t\tconst vertices = [];\n\t\tconst colors = [];\n\n\t\tconst pointMap = {};\n\n\t\t// near\n\n\t\taddLine( 'n1', 'n2' );\n\t\taddLine( 'n2', 'n4' );\n\t\taddLine( 'n4', 'n3' );\n\t\taddLine( 'n3', 'n1' );\n\n\t\t// far\n\n\t\taddLine( 'f1', 'f2' );\n\t\taddLine( 'f2', 'f4' );\n\t\taddLine( 'f4', 'f3' );\n\t\taddLine( 'f3', 'f1' );\n\n\t\t// sides\n\n\t\taddLine( 'n1', 'f1' );\n\t\taddLine( 'n2', 'f2' );\n\t\taddLine( 'n3', 'f3' );\n\t\taddLine( 'n4', 'f4' );\n\n\t\t// cone\n\n\t\taddLine( 'p', 'n1' );\n\t\taddLine( 'p', 'n2' );\n\t\taddLine( 'p', 'n3' );\n\t\taddLine( 'p', 'n4' );\n\n\t\t// up\n\n\t\taddLine( 'u1', 'u2' );\n\t\taddLine( 'u2', 'u3' );\n\t\taddLine( 'u3', 'u1' );\n\n\t\t// target\n\n\t\taddLine( 'c', 't' );\n\t\taddLine( 'p', 'c' );\n\n\t\t// cross\n\n\t\taddLine( 'cn1', 'cn2' );\n\t\taddLine( 'cn3', 'cn4' );\n\n\t\taddLine( 'cf1', 'cf2' );\n\t\taddLine( 'cf3', 'cf4' );\n\n\t\tfunction addLine( a, b ) {\n\n\t\t\taddPoint( a );\n\t\t\taddPoint( b );\n\n\t\t}\n\n\t\tfunction addPoint( id ) {\n\n\t\t\tvertices.push( 0, 0, 0 );\n\t\t\tcolors.push( 0, 0, 0 );\n\n\t\t\tif ( pointMap[ id ] === undefined ) {\n\n\t\t\t\tpointMap[ id ] = [];\n\n\t\t\t}\n\n\t\t\tpointMap[ id ].push( ( vertices.length / 3 ) - 1 );\n\n\t\t}\n\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tgeometry.setAttribute( 'color', new Float32BufferAttribute( colors, 3 ) );\n\n\t\tsuper( geometry, material );\n\n\t\tthis.type = 'CameraHelper';\n\n\t\tthis.camera = camera;\n\t\tif ( this.camera.updateProjectionMatrix ) this.camera.updateProjectionMatrix();\n\n\t\tthis.matrix = camera.matrixWorld;\n\t\tthis.matrixAutoUpdate = false;\n\n\t\tthis.pointMap = pointMap;\n\n\t\tthis.update();\n\n\t\t// colors\n\n\t\tconst colorFrustum = new Color( 0xffaa00 );\n\t\tconst colorCone = new Color( 0xff0000 );\n\t\tconst colorUp = new Color( 0x00aaff );\n\t\tconst colorTarget = new Color( 0xffffff );\n\t\tconst colorCross = new Color( 0x333333 );\n\n\t\tthis.setColors( colorFrustum, colorCone, colorUp, colorTarget, colorCross );\n\n\t}\n\n\tsetColors( frustum, cone, up, target, cross ) {\n\n\t\tconst geometry = this.geometry;\n\n\t\tconst colorAttribute = geometry.getAttribute( 'color' );\n\n\t\t// near\n\n\t\tcolorAttribute.setXYZ( 0, frustum.r, frustum.g, frustum.b ); colorAttribute.setXYZ( 1, frustum.r, frustum.g, frustum.b ); // n1, n2\n\t\tcolorAttribute.setXYZ( 2, frustum.r, frustum.g, frustum.b ); colorAttribute.setXYZ( 3, frustum.r, frustum.g, frustum.b ); // n2, n4\n\t\tcolorAttribute.setXYZ( 4, frustum.r, frustum.g, frustum.b ); colorAttribute.setXYZ( 5, frustum.r, frustum.g, frustum.b ); // n4, n3\n\t\tcolorAttribute.setXYZ( 6, frustum.r, frustum.g, frustum.b ); colorAttribute.setXYZ( 7, frustum.r, frustum.g, frustum.b ); // n3, n1\n\n\t\t// far\n\n\t\tcolorAttribute.setXYZ( 8, frustum.r, frustum.g, frustum.b ); colorAttribute.setXYZ( 9, frustum.r, frustum.g, frustum.b ); // f1, f2\n\t\tcolorAttribute.setXYZ( 10, frustum.r, frustum.g, frustum.b ); colorAttribute.setXYZ( 11, frustum.r, frustum.g, frustum.b ); // f2, f4\n\t\tcolorAttribute.setXYZ( 12, frustum.r, frustum.g, frustum.b ); colorAttribute.setXYZ( 13, frustum.r, frustum.g, frustum.b ); // f4, f3\n\t\tcolorAttribute.setXYZ( 14, frustum.r, frustum.g, frustum.b ); colorAttribute.setXYZ( 15, frustum.r, frustum.g, frustum.b ); // f3, f1\n\n\t\t// sides\n\n\t\tcolorAttribute.setXYZ( 16, frustum.r, frustum.g, frustum.b ); colorAttribute.setXYZ( 17, frustum.r, frustum.g, frustum.b ); // n1, f1\n\t\tcolorAttribute.setXYZ( 18, frustum.r, frustum.g, frustum.b ); colorAttribute.setXYZ( 19, frustum.r, frustum.g, frustum.b ); // n2, f2\n\t\tcolorAttribute.setXYZ( 20, frustum.r, frustum.g, frustum.b ); colorAttribute.setXYZ( 21, frustum.r, frustum.g, frustum.b ); // n3, f3\n\t\tcolorAttribute.setXYZ( 22, frustum.r, frustum.g, frustum.b ); colorAttribute.setXYZ( 23, frustum.r, frustum.g, frustum.b ); // n4, f4\n\n\t\t// cone\n\n\t\tcolorAttribute.setXYZ( 24, cone.r, cone.g, cone.b ); colorAttribute.setXYZ( 25, cone.r, cone.g, cone.b ); // p, n1\n\t\tcolorAttribute.setXYZ( 26, cone.r, cone.g, cone.b ); colorAttribute.setXYZ( 27, cone.r, cone.g, cone.b ); // p, n2\n\t\tcolorAttribute.setXYZ( 28, cone.r, cone.g, cone.b ); colorAttribute.setXYZ( 29, cone.r, cone.g, cone.b ); // p, n3\n\t\tcolorAttribute.setXYZ( 30, cone.r, cone.g, cone.b ); colorAttribute.setXYZ( 31, cone.r, cone.g, cone.b ); // p, n4\n\n\t\t// up\n\n\t\tcolorAttribute.setXYZ( 32, up.r, up.g, up.b ); colorAttribute.setXYZ( 33, up.r, up.g, up.b ); // u1, u2\n\t\tcolorAttribute.setXYZ( 34, up.r, up.g, up.b ); colorAttribute.setXYZ( 35, up.r, up.g, up.b ); // u2, u3\n\t\tcolorAttribute.setXYZ( 36, up.r, up.g, up.b ); colorAttribute.setXYZ( 37, up.r, up.g, up.b ); // u3, u1\n\n\t\t// target\n\n\t\tcolorAttribute.setXYZ( 38, target.r, target.g, target.b ); colorAttribute.setXYZ( 39, target.r, target.g, target.b ); // c, t\n\t\tcolorAttribute.setXYZ( 40, cross.r, cross.g, cross.b ); colorAttribute.setXYZ( 41, cross.r, cross.g, cross.b ); // p, c\n\n\t\t// cross\n\n\t\tcolorAttribute.setXYZ( 42, cross.r, cross.g, cross.b ); colorAttribute.setXYZ( 43, cross.r, cross.g, cross.b ); // cn1, cn2\n\t\tcolorAttribute.setXYZ( 44, cross.r, cross.g, cross.b ); colorAttribute.setXYZ( 45, cross.r, cross.g, cross.b ); // cn3, cn4\n\n\t\tcolorAttribute.setXYZ( 46, cross.r, cross.g, cross.b ); colorAttribute.setXYZ( 47, cross.r, cross.g, cross.b ); // cf1, cf2\n\t\tcolorAttribute.setXYZ( 48, cross.r, cross.g, cross.b ); colorAttribute.setXYZ( 49, cross.r, cross.g, cross.b ); // cf3, cf4\n\n\t\tcolorAttribute.needsUpdate = true;\n\n\t}\n\n\tupdate() {\n\n\t\tconst geometry = this.geometry;\n\t\tconst pointMap = this.pointMap;\n\n\t\tconst w = 1, h = 1;\n\n\t\t// we need just camera projection matrix inverse\n\t\t// world matrix must be identity\n\n\t\t_camera.projectionMatrixInverse.copy( this.camera.projectionMatrixInverse );\n\n\t\t// center / target\n\n\t\tsetPoint( 'c', pointMap, geometry, _camera, 0, 0, - 1 );\n\t\tsetPoint( 't', pointMap, geometry, _camera, 0, 0, 1 );\n\n\t\t// near\n\n\t\tsetPoint( 'n1', pointMap, geometry, _camera, - w, - h, - 1 );\n\t\tsetPoint( 'n2', pointMap, geometry, _camera, w, - h, - 1 );\n\t\tsetPoint( 'n3', pointMap, geometry, _camera, - w, h, - 1 );\n\t\tsetPoint( 'n4', pointMap, geometry, _camera, w, h, - 1 );\n\n\t\t// far\n\n\t\tsetPoint( 'f1', pointMap, geometry, _camera, - w, - h, 1 );\n\t\tsetPoint( 'f2', pointMap, geometry, _camera, w, - h, 1 );\n\t\tsetPoint( 'f3', pointMap, geometry, _camera, - w, h, 1 );\n\t\tsetPoint( 'f4', pointMap, geometry, _camera, w, h, 1 );\n\n\t\t// up\n\n\t\tsetPoint( 'u1', pointMap, geometry, _camera, w * 0.7, h * 1.1, - 1 );\n\t\tsetPoint( 'u2', pointMap, geometry, _camera, - w * 0.7, h * 1.1, - 1 );\n\t\tsetPoint( 'u3', pointMap, geometry, _camera, 0, h * 2, - 1 );\n\n\t\t// cross\n\n\t\tsetPoint( 'cf1', pointMap, geometry, _camera, - w, 0, 1 );\n\t\tsetPoint( 'cf2', pointMap, geometry, _camera, w, 0, 1 );\n\t\tsetPoint( 'cf3', pointMap, geometry, _camera, 0, - h, 1 );\n\t\tsetPoint( 'cf4', pointMap, geometry, _camera, 0, h, 1 );\n\n\t\tsetPoint( 'cn1', pointMap, geometry, _camera, - w, 0, - 1 );\n\t\tsetPoint( 'cn2', pointMap, geometry, _camera, w, 0, - 1 );\n\t\tsetPoint( 'cn3', pointMap, geometry, _camera, 0, - h, - 1 );\n\t\tsetPoint( 'cn4', pointMap, geometry, _camera, 0, h, - 1 );\n\n\t\tgeometry.getAttribute( 'position' ).needsUpdate = true;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.geometry.dispose();\n\t\tthis.material.dispose();\n\n\t}\n\n}\n\n\nfunction setPoint( point, pointMap, geometry, camera, x, y, z ) {\n\n\t_vector.set( x, y, z ).unproject( camera );\n\n\tconst points = pointMap[ point ];\n\n\tif ( points !== undefined ) {\n\n\t\tconst position = geometry.getAttribute( 'position' );\n\n\t\tfor ( let i = 0, l = points.length; i < l; i ++ ) {\n\n\t\t\tposition.setXYZ( points[ i ], _vector.x, _vector.y, _vector.z );\n\n\t\t}\n\n\t}\n\n}\n\nconst _box = /*@__PURE__*/ new Box3();\n\nclass BoxHelper extends LineSegments {\n\n\tconstructor( object, color = 0xffff00 ) {\n\n\t\tconst indices = new Uint16Array( [ 0, 1, 1, 2, 2, 3, 3, 0, 4, 5, 5, 6, 6, 7, 7, 4, 0, 4, 1, 5, 2, 6, 3, 7 ] );\n\t\tconst positions = new Float32Array( 8 * 3 );\n\n\t\tconst geometry = new BufferGeometry();\n\t\tgeometry.setIndex( new BufferAttribute( indices, 1 ) );\n\t\tgeometry.setAttribute( 'position', new BufferAttribute( positions, 3 ) );\n\n\t\tsuper( geometry, new LineBasicMaterial( { color: color, toneMapped: false } ) );\n\n\t\tthis.object = object;\n\t\tthis.type = 'BoxHelper';\n\n\t\tthis.matrixAutoUpdate = false;\n\n\t\tthis.update();\n\n\t}\n\n\tupdate( object ) {\n\n\t\tif ( object !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.BoxHelper: .update() has no longer arguments.' );\n\n\t\t}\n\n\t\tif ( this.object !== undefined ) {\n\n\t\t\t_box.setFromObject( this.object );\n\n\t\t}\n\n\t\tif ( _box.isEmpty() ) return;\n\n\t\tconst min = _box.min;\n\t\tconst max = _box.max;\n\n\t\t/*\n\t\t\t5____4\n\t\t1/___0/|\n\t\t| 6__|_7\n\t\t2/___3/\n\n\t\t0: max.x, max.y, max.z\n\t\t1: min.x, max.y, max.z\n\t\t2: min.x, min.y, max.z\n\t\t3: max.x, min.y, max.z\n\t\t4: max.x, max.y, min.z\n\t\t5: min.x, max.y, min.z\n\t\t6: min.x, min.y, min.z\n\t\t7: max.x, min.y, min.z\n\t\t*/\n\n\t\tconst position = this.geometry.attributes.position;\n\t\tconst array = position.array;\n\n\t\tarray[ 0 ] = max.x; array[ 1 ] = max.y; array[ 2 ] = max.z;\n\t\tarray[ 3 ] = min.x; array[ 4 ] = max.y; array[ 5 ] = max.z;\n\t\tarray[ 6 ] = min.x; array[ 7 ] = min.y; array[ 8 ] = max.z;\n\t\tarray[ 9 ] = max.x; array[ 10 ] = min.y; array[ 11 ] = max.z;\n\t\tarray[ 12 ] = max.x; array[ 13 ] = max.y; array[ 14 ] = min.z;\n\t\tarray[ 15 ] = min.x; array[ 16 ] = max.y; array[ 17 ] = min.z;\n\t\tarray[ 18 ] = min.x; array[ 19 ] = min.y; array[ 20 ] = min.z;\n\t\tarray[ 21 ] = max.x; array[ 22 ] = min.y; array[ 23 ] = min.z;\n\n\t\tposition.needsUpdate = true;\n\n\t\tthis.geometry.computeBoundingSphere();\n\n\t}\n\n\tsetFromObject( object ) {\n\n\t\tthis.object = object;\n\t\tthis.update();\n\n\t\treturn this;\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.object = source.object;\n\n\t\treturn this;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.geometry.dispose();\n\t\tthis.material.dispose();\n\n\t}\n\n}\n\nclass Box3Helper extends LineSegments {\n\n\tconstructor( box, color = 0xffff00 ) {\n\n\t\tconst indices = new Uint16Array( [ 0, 1, 1, 2, 2, 3, 3, 0, 4, 5, 5, 6, 6, 7, 7, 4, 0, 4, 1, 5, 2, 6, 3, 7 ] );\n\n\t\tconst positions = [ 1, 1, 1, - 1, 1, 1, - 1, - 1, 1, 1, - 1, 1, 1, 1, - 1, - 1, 1, - 1, - 1, - 1, - 1, 1, - 1, - 1 ];\n\n\t\tconst geometry = new BufferGeometry();\n\n\t\tgeometry.setIndex( new BufferAttribute( indices, 1 ) );\n\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( positions, 3 ) );\n\n\t\tsuper( geometry, new LineBasicMaterial( { color: color, toneMapped: false } ) );\n\n\t\tthis.box = box;\n\n\t\tthis.type = 'Box3Helper';\n\n\t\tthis.geometry.computeBoundingSphere();\n\n\t}\n\n\tupdateMatrixWorld( force ) {\n\n\t\tconst box = this.box;\n\n\t\tif ( box.isEmpty() ) return;\n\n\t\tbox.getCenter( this.position );\n\n\t\tbox.getSize( this.scale );\n\n\t\tthis.scale.multiplyScalar( 0.5 );\n\n\t\tsuper.updateMatrixWorld( force );\n\n\t}\n\n\tdispose() {\n\n\t\tthis.geometry.dispose();\n\t\tthis.material.dispose();\n\n\t}\n\n}\n\nclass PlaneHelper extends Line {\n\n\tconstructor( plane, size = 1, hex = 0xffff00 ) {\n\n\t\tconst color = hex;\n\n\t\tconst positions = [ 1, - 1, 0, - 1, 1, 0, - 1, - 1, 0, 1, 1, 0, - 1, 1, 0, - 1, - 1, 0, 1, - 1, 0, 1, 1, 0 ];\n\n\t\tconst geometry = new BufferGeometry();\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( positions, 3 ) );\n\t\tgeometry.computeBoundingSphere();\n\n\t\tsuper( geometry, new LineBasicMaterial( { color: color, toneMapped: false } ) );\n\n\t\tthis.type = 'PlaneHelper';\n\n\t\tthis.plane = plane;\n\n\t\tthis.size = size;\n\n\t\tconst positions2 = [ 1, 1, 0, - 1, 1, 0, - 1, - 1, 0, 1, 1, 0, - 1, - 1, 0, 1, - 1, 0 ];\n\n\t\tconst geometry2 = new BufferGeometry();\n\t\tgeometry2.setAttribute( 'position', new Float32BufferAttribute( positions2, 3 ) );\n\t\tgeometry2.computeBoundingSphere();\n\n\t\tthis.add( new Mesh( geometry2, new MeshBasicMaterial( { color: color, opacity: 0.2, transparent: true, depthWrite: false, toneMapped: false } ) ) );\n\n\t}\n\n\tupdateMatrixWorld( force ) {\n\n\t\tthis.position.set( 0, 0, 0 );\n\n\t\tthis.scale.set( 0.5 * this.size, 0.5 * this.size, 1 );\n\n\t\tthis.lookAt( this.plane.normal );\n\n\t\tthis.translateZ( - this.plane.constant );\n\n\t\tsuper.updateMatrixWorld( force );\n\n\t}\n\n\tdispose() {\n\n\t\tthis.geometry.dispose();\n\t\tthis.material.dispose();\n\t\tthis.children[ 0 ].geometry.dispose();\n\t\tthis.children[ 0 ].material.dispose();\n\n\t}\n\n}\n\nconst _axis = /*@__PURE__*/ new Vector3();\nlet _lineGeometry, _coneGeometry;\n\nclass ArrowHelper extends Object3D {\n\n\t// dir is assumed to be normalized\n\n\tconstructor( dir = new Vector3( 0, 0, 1 ), origin = new Vector3( 0, 0, 0 ), length = 1, color = 0xffff00, headLength = length * 0.2, headWidth = headLength * 0.2 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'ArrowHelper';\n\n\t\tif ( _lineGeometry === undefined ) {\n\n\t\t\t_lineGeometry = new BufferGeometry();\n\t\t\t_lineGeometry.setAttribute( 'position', new Float32BufferAttribute( [ 0, 0, 0, 0, 1, 0 ], 3 ) );\n\n\t\t\t_coneGeometry = new CylinderGeometry( 0, 0.5, 1, 5, 1 );\n\t\t\t_coneGeometry.translate( 0, - 0.5, 0 );\n\n\t\t}\n\n\t\tthis.position.copy( origin );\n\n\t\tthis.line = new Line( _lineGeometry, new LineBasicMaterial( { color: color, toneMapped: false } ) );\n\t\tthis.line.matrixAutoUpdate = false;\n\t\tthis.add( this.line );\n\n\t\tthis.cone = new Mesh( _coneGeometry, new MeshBasicMaterial( { color: color, toneMapped: false } ) );\n\t\tthis.cone.matrixAutoUpdate = false;\n\t\tthis.add( this.cone );\n\n\t\tthis.setDirection( dir );\n\t\tthis.setLength( length, headLength, headWidth );\n\n\t}\n\n\tsetDirection( dir ) {\n\n\t\t// dir is assumed to be normalized\n\n\t\tif ( dir.y > 0.99999 ) {\n\n\t\t\tthis.quaternion.set( 0, 0, 0, 1 );\n\n\t\t} else if ( dir.y < - 0.99999 ) {\n\n\t\t\tthis.quaternion.set( 1, 0, 0, 0 );\n\n\t\t} else {\n\n\t\t\t_axis.set( dir.z, 0, - dir.x ).normalize();\n\n\t\t\tconst radians = Math.acos( dir.y );\n\n\t\t\tthis.quaternion.setFromAxisAngle( _axis, radians );\n\n\t\t}\n\n\t}\n\n\tsetLength( length, headLength = length * 0.2, headWidth = headLength * 0.2 ) {\n\n\t\tthis.line.scale.set( 1, Math.max( 0.0001, length - headLength ), 1 ); // see #17458\n\t\tthis.line.updateMatrix();\n\n\t\tthis.cone.scale.set( headWidth, headLength, headWidth );\n\t\tthis.cone.position.y = length;\n\t\tthis.cone.updateMatrix();\n\n\t}\n\n\tsetColor( color ) {\n\n\t\tthis.line.material.color.set( color );\n\t\tthis.cone.material.color.set( color );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source, false );\n\n\t\tthis.line.copy( source.line );\n\t\tthis.cone.copy( source.cone );\n\n\t\treturn this;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.line.geometry.dispose();\n\t\tthis.line.material.dispose();\n\t\tthis.cone.geometry.dispose();\n\t\tthis.cone.material.dispose();\n\n\t}\n\n}\n\nclass AxesHelper extends LineSegments {\n\n\tconstructor( size = 1 ) {\n\n\t\tconst vertices = [\n\t\t\t0, 0, 0,\tsize, 0, 0,\n\t\t\t0, 0, 0,\t0, size, 0,\n\t\t\t0, 0, 0,\t0, 0, size\n\t\t];\n\n\t\tconst colors = [\n\t\t\t1, 0, 0,\t1, 0.6, 0,\n\t\t\t0, 1, 0,\t0.6, 1, 0,\n\t\t\t0, 0, 1,\t0, 0.6, 1\n\t\t];\n\n\t\tconst geometry = new BufferGeometry();\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tgeometry.setAttribute( 'color', new Float32BufferAttribute( colors, 3 ) );\n\n\t\tconst material = new LineBasicMaterial( { vertexColors: true, toneMapped: false } );\n\n\t\tsuper( geometry, material );\n\n\t\tthis.type = 'AxesHelper';\n\n\t}\n\n\tsetColors( xAxisColor, yAxisColor, zAxisColor ) {\n\n\t\tconst color = new Color();\n\t\tconst array = this.geometry.attributes.color.array;\n\n\t\tcolor.set( xAxisColor );\n\t\tcolor.toArray( array, 0 );\n\t\tcolor.toArray( array, 3 );\n\n\t\tcolor.set( yAxisColor );\n\t\tcolor.toArray( array, 6 );\n\t\tcolor.toArray( array, 9 );\n\n\t\tcolor.set( zAxisColor );\n\t\tcolor.toArray( array, 12 );\n\t\tcolor.toArray( array, 15 );\n\n\t\tthis.geometry.attributes.color.needsUpdate = true;\n\n\t\treturn this;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.geometry.dispose();\n\t\tthis.material.dispose();\n\n\t}\n\n}\n\nclass ShapePath {\n\n\tconstructor() {\n\n\t\tthis.type = 'ShapePath';\n\n\t\tthis.color = new Color();\n\n\t\tthis.subPaths = [];\n\t\tthis.currentPath = null;\n\n\t}\n\n\tmoveTo( x, y ) {\n\n\t\tthis.currentPath = new Path();\n\t\tthis.subPaths.push( this.currentPath );\n\t\tthis.currentPath.moveTo( x, y );\n\n\t\treturn this;\n\n\t}\n\n\tlineTo( x, y ) {\n\n\t\tthis.currentPath.lineTo( x, y );\n\n\t\treturn this;\n\n\t}\n\n\tquadraticCurveTo( aCPx, aCPy, aX, aY ) {\n\n\t\tthis.currentPath.quadraticCurveTo( aCPx, aCPy, aX, aY );\n\n\t\treturn this;\n\n\t}\n\n\tbezierCurveTo( aCP1x, aCP1y, aCP2x, aCP2y, aX, aY ) {\n\n\t\tthis.currentPath.bezierCurveTo( aCP1x, aCP1y, aCP2x, aCP2y, aX, aY );\n\n\t\treturn this;\n\n\t}\n\n\tsplineThru( pts ) {\n\n\t\tthis.currentPath.splineThru( pts );\n\n\t\treturn this;\n\n\t}\n\n\ttoShapes( isCCW ) {\n\n\t\tfunction toShapesNoHoles( inSubpaths ) {\n\n\t\t\tconst shapes = [];\n\n\t\t\tfor ( let i = 0, l = inSubpaths.length; i < l; i ++ ) {\n\n\t\t\t\tconst tmpPath = inSubpaths[ i ];\n\n\t\t\t\tconst tmpShape = new Shape();\n\t\t\t\ttmpShape.curves = tmpPath.curves;\n\n\t\t\t\tshapes.push( tmpShape );\n\n\t\t\t}\n\n\t\t\treturn shapes;\n\n\t\t}\n\n\t\tfunction isPointInsidePolygon( inPt, inPolygon ) {\n\n\t\t\tconst polyLen = inPolygon.length;\n\n\t\t\t// inPt on polygon contour => immediate success    or\n\t\t\t// toggling of inside/outside at every single! intersection point of an edge\n\t\t\t//  with the horizontal line through inPt, left of inPt\n\t\t\t//  not counting lowerY endpoints of edges and whole edges on that line\n\t\t\tlet inside = false;\n\t\t\tfor ( let p = polyLen - 1, q = 0; q < polyLen; p = q ++ ) {\n\n\t\t\t\tlet edgeLowPt = inPolygon[ p ];\n\t\t\t\tlet edgeHighPt = inPolygon[ q ];\n\n\t\t\t\tlet edgeDx = edgeHighPt.x - edgeLowPt.x;\n\t\t\t\tlet edgeDy = edgeHighPt.y - edgeLowPt.y;\n\n\t\t\t\tif ( Math.abs( edgeDy ) > Number.EPSILON ) {\n\n\t\t\t\t\t// not parallel\n\t\t\t\t\tif ( edgeDy < 0 ) {\n\n\t\t\t\t\t\tedgeLowPt = inPolygon[ q ]; edgeDx = - edgeDx;\n\t\t\t\t\t\tedgeHighPt = inPolygon[ p ]; edgeDy = - edgeDy;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( ( inPt.y < edgeLowPt.y ) || ( inPt.y > edgeHighPt.y ) ) \t\tcontinue;\n\n\t\t\t\t\tif ( inPt.y === edgeLowPt.y ) {\n\n\t\t\t\t\t\tif ( inPt.x === edgeLowPt.x )\t\treturn\ttrue;\t\t// inPt is on contour ?\n\t\t\t\t\t\t// continue;\t\t\t\t// no intersection or edgeLowPt => doesn't count !!!\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tconst perpEdge = edgeDy * ( inPt.x - edgeLowPt.x ) - edgeDx * ( inPt.y - edgeLowPt.y );\n\t\t\t\t\t\tif ( perpEdge === 0 )\t\t\t\treturn\ttrue;\t\t// inPt is on contour ?\n\t\t\t\t\t\tif ( perpEdge < 0 ) \t\t\t\tcontinue;\n\t\t\t\t\t\tinside = ! inside;\t\t// true intersection left of inPt\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// parallel or collinear\n\t\t\t\t\tif ( inPt.y !== edgeLowPt.y ) \t\tcontinue;\t\t\t// parallel\n\t\t\t\t\t// edge lies on the same horizontal line as inPt\n\t\t\t\t\tif ( ( ( edgeHighPt.x <= inPt.x ) && ( inPt.x <= edgeLowPt.x ) ) ||\n\t\t\t\t\t\t ( ( edgeLowPt.x <= inPt.x ) && ( inPt.x <= edgeHighPt.x ) ) )\t\treturn\ttrue;\t// inPt: Point on contour !\n\t\t\t\t\t// continue;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn\tinside;\n\n\t\t}\n\n\t\tconst isClockWise = ShapeUtils.isClockWise;\n\n\t\tconst subPaths = this.subPaths;\n\t\tif ( subPaths.length === 0 ) return [];\n\n\t\tlet solid, tmpPath, tmpShape;\n\t\tconst shapes = [];\n\n\t\tif ( subPaths.length === 1 ) {\n\n\t\t\ttmpPath = subPaths[ 0 ];\n\t\t\ttmpShape = new Shape();\n\t\t\ttmpShape.curves = tmpPath.curves;\n\t\t\tshapes.push( tmpShape );\n\t\t\treturn shapes;\n\n\t\t}\n\n\t\tlet holesFirst = ! isClockWise( subPaths[ 0 ].getPoints() );\n\t\tholesFirst = isCCW ? ! holesFirst : holesFirst;\n\n\t\t// console.log(\"Holes first\", holesFirst);\n\n\t\tconst betterShapeHoles = [];\n\t\tconst newShapes = [];\n\t\tlet newShapeHoles = [];\n\t\tlet mainIdx = 0;\n\t\tlet tmpPoints;\n\n\t\tnewShapes[ mainIdx ] = undefined;\n\t\tnewShapeHoles[ mainIdx ] = [];\n\n\t\tfor ( let i = 0, l = subPaths.length; i < l; i ++ ) {\n\n\t\t\ttmpPath = subPaths[ i ];\n\t\t\ttmpPoints = tmpPath.getPoints();\n\t\t\tsolid = isClockWise( tmpPoints );\n\t\t\tsolid = isCCW ? ! solid : solid;\n\n\t\t\tif ( solid ) {\n\n\t\t\t\tif ( ( ! holesFirst ) && ( newShapes[ mainIdx ] ) )\tmainIdx ++;\n\n\t\t\t\tnewShapes[ mainIdx ] = { s: new Shape(), p: tmpPoints };\n\t\t\t\tnewShapes[ mainIdx ].s.curves = tmpPath.curves;\n\n\t\t\t\tif ( holesFirst )\tmainIdx ++;\n\t\t\t\tnewShapeHoles[ mainIdx ] = [];\n\n\t\t\t\t//console.log('cw', i);\n\n\t\t\t} else {\n\n\t\t\t\tnewShapeHoles[ mainIdx ].push( { h: tmpPath, p: tmpPoints[ 0 ] } );\n\n\t\t\t\t//console.log('ccw', i);\n\n\t\t\t}\n\n\t\t}\n\n\t\t// only Holes? -> probably all Shapes with wrong orientation\n\t\tif ( ! newShapes[ 0 ] )\treturn\ttoShapesNoHoles( subPaths );\n\n\n\t\tif ( newShapes.length > 1 ) {\n\n\t\t\tlet ambiguous = false;\n\t\t\tlet toChange = 0;\n\n\t\t\tfor ( let sIdx = 0, sLen = newShapes.length; sIdx < sLen; sIdx ++ ) {\n\n\t\t\t\tbetterShapeHoles[ sIdx ] = [];\n\n\t\t\t}\n\n\t\t\tfor ( let sIdx = 0, sLen = newShapes.length; sIdx < sLen; sIdx ++ ) {\n\n\t\t\t\tconst sho = newShapeHoles[ sIdx ];\n\n\t\t\t\tfor ( let hIdx = 0; hIdx < sho.length; hIdx ++ ) {\n\n\t\t\t\t\tconst ho = sho[ hIdx ];\n\t\t\t\t\tlet hole_unassigned = true;\n\n\t\t\t\t\tfor ( let s2Idx = 0; s2Idx < newShapes.length; s2Idx ++ ) {\n\n\t\t\t\t\t\tif ( isPointInsidePolygon( ho.p, newShapes[ s2Idx ].p ) ) {\n\n\t\t\t\t\t\t\tif ( sIdx !== s2Idx )\ttoChange ++;\n\n\t\t\t\t\t\t\tif ( hole_unassigned ) {\n\n\t\t\t\t\t\t\t\thole_unassigned = false;\n\t\t\t\t\t\t\t\tbetterShapeHoles[ s2Idx ].push( ho );\n\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\tambiguous = true;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( hole_unassigned ) {\n\n\t\t\t\t\t\tbetterShapeHoles[ sIdx ].push( ho );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( toChange > 0 && ambiguous === false ) {\n\n\t\t\t\tnewShapeHoles = betterShapeHoles;\n\n\t\t\t}\n\n\t\t}\n\n\t\tlet tmpHoles;\n\n\t\tfor ( let i = 0, il = newShapes.length; i < il; i ++ ) {\n\n\t\t\ttmpShape = newShapes[ i ].s;\n\t\t\tshapes.push( tmpShape );\n\t\t\ttmpHoles = newShapeHoles[ i ];\n\n\t\t\tfor ( let j = 0, jl = tmpHoles.length; j < jl; j ++ ) {\n\n\t\t\t\ttmpShape.holes.push( tmpHoles[ j ].h );\n\n\t\t\t}\n\n\t\t}\n\n\t\t//console.log(\"shape\", shapes);\n\n\t\treturn shapes;\n\n\t}\n\n}\n\n// Fast Half Float Conversions, http://www.fox-toolkit.org/ftp/fasthalffloatconversion.pdf\n\nconst _tables = /*@__PURE__*/ _generateTables();\n\nfunction _generateTables() {\n\n\t// float32 to float16 helpers\n\n\tconst buffer = new ArrayBuffer( 4 );\n\tconst floatView = new Float32Array( buffer );\n\tconst uint32View = new Uint32Array( buffer );\n\n\tconst baseTable = new Uint32Array( 512 );\n\tconst shiftTable = new Uint32Array( 512 );\n\n\tfor ( let i = 0; i < 256; ++ i ) {\n\n\t\tconst e = i - 127;\n\n\t\t// very small number (0, -0)\n\n\t\tif ( e < - 27 ) {\n\n\t\t\tbaseTable[ i ] = 0x0000;\n\t\t\tbaseTable[ i | 0x100 ] = 0x8000;\n\t\t\tshiftTable[ i ] = 24;\n\t\t\tshiftTable[ i | 0x100 ] = 24;\n\n\t\t\t// small number (denorm)\n\n\t\t} else if ( e < - 14 ) {\n\n\t\t\tbaseTable[ i ] = 0x0400 >> ( - e - 14 );\n\t\t\tbaseTable[ i | 0x100 ] = ( 0x0400 >> ( - e - 14 ) ) | 0x8000;\n\t\t\tshiftTable[ i ] = - e - 1;\n\t\t\tshiftTable[ i | 0x100 ] = - e - 1;\n\n\t\t\t// normal number\n\n\t\t} else if ( e <= 15 ) {\n\n\t\t\tbaseTable[ i ] = ( e + 15 ) << 10;\n\t\t\tbaseTable[ i | 0x100 ] = ( ( e + 15 ) << 10 ) | 0x8000;\n\t\t\tshiftTable[ i ] = 13;\n\t\t\tshiftTable[ i | 0x100 ] = 13;\n\n\t\t\t// large number (Infinity, -Infinity)\n\n\t\t} else if ( e < 128 ) {\n\n\t\t\tbaseTable[ i ] = 0x7c00;\n\t\t\tbaseTable[ i | 0x100 ] = 0xfc00;\n\t\t\tshiftTable[ i ] = 24;\n\t\t\tshiftTable[ i | 0x100 ] = 24;\n\n\t\t\t// stay (NaN, Infinity, -Infinity)\n\n\t\t} else {\n\n\t\t\tbaseTable[ i ] = 0x7c00;\n\t\t\tbaseTable[ i | 0x100 ] = 0xfc00;\n\t\t\tshiftTable[ i ] = 13;\n\t\t\tshiftTable[ i | 0x100 ] = 13;\n\n\t\t}\n\n\t}\n\n\t// float16 to float32 helpers\n\n\tconst mantissaTable = new Uint32Array( 2048 );\n\tconst exponentTable = new Uint32Array( 64 );\n\tconst offsetTable = new Uint32Array( 64 );\n\n\tfor ( let i = 1; i < 1024; ++ i ) {\n\n\t\tlet m = i << 13; // zero pad mantissa bits\n\t\tlet e = 0; // zero exponent\n\n\t\t// normalized\n\t\twhile ( ( m & 0x00800000 ) === 0 ) {\n\n\t\t\tm <<= 1;\n\t\t\te -= 0x00800000; // decrement exponent\n\n\t\t}\n\n\t\tm &= ~ 0x00800000; // clear leading 1 bit\n\t\te += 0x38800000; // adjust bias\n\n\t\tmantissaTable[ i ] = m | e;\n\n\t}\n\n\tfor ( let i = 1024; i < 2048; ++ i ) {\n\n\t\tmantissaTable[ i ] = 0x38000000 + ( ( i - 1024 ) << 13 );\n\n\t}\n\n\tfor ( let i = 1; i < 31; ++ i ) {\n\n\t\texponentTable[ i ] = i << 23;\n\n\t}\n\n\texponentTable[ 31 ] = 0x47800000;\n\texponentTable[ 32 ] = 0x80000000;\n\n\tfor ( let i = 33; i < 63; ++ i ) {\n\n\t\texponentTable[ i ] = 0x80000000 + ( ( i - 32 ) << 23 );\n\n\t}\n\n\texponentTable[ 63 ] = 0xc7800000;\n\n\tfor ( let i = 1; i < 64; ++ i ) {\n\n\t\tif ( i !== 32 ) {\n\n\t\t\toffsetTable[ i ] = 1024;\n\n\t\t}\n\n\t}\n\n\treturn {\n\t\tfloatView: floatView,\n\t\tuint32View: uint32View,\n\t\tbaseTable: baseTable,\n\t\tshiftTable: shiftTable,\n\t\tmantissaTable: mantissaTable,\n\t\texponentTable: exponentTable,\n\t\toffsetTable: offsetTable\n\t};\n\n}\n\n// float32 to float16\n\nfunction toHalfFloat( val ) {\n\n\tif ( Math.abs( val ) > 65504 ) console.warn( 'THREE.DataUtils.toHalfFloat(): Value out of range.' );\n\n\tval = clamp( val, - 65504, 65504 );\n\n\t_tables.floatView[ 0 ] = val;\n\tconst f = _tables.uint32View[ 0 ];\n\tconst e = ( f >> 23 ) & 0x1ff;\n\treturn _tables.baseTable[ e ] + ( ( f & 0x007fffff ) >> _tables.shiftTable[ e ] );\n\n}\n\n// float16 to float32\n\nfunction fromHalfFloat( val ) {\n\n\tconst m = val >> 10;\n\t_tables.uint32View[ 0 ] = _tables.mantissaTable[ _tables.offsetTable[ m ] + ( val & 0x3ff ) ] + _tables.exponentTable[ m ];\n\treturn _tables.floatView[ 0 ];\n\n}\n\nvar DataUtils = /*#__PURE__*/Object.freeze({\n\t__proto__: null,\n\ttoHalfFloat: toHalfFloat,\n\tfromHalfFloat: fromHalfFloat\n});\n\n// r134, d65e0af06644fe5a84a6fc0e372f4318f95a04c0\n\nfunction ImmediateRenderObject() {\n\n\tconsole.error( 'THREE.ImmediateRenderObject has been removed.' );\n\n}\n\n// r138, 48b05d3500acc084df50be9b4c90781ad9b8cb17\n\nclass WebGLMultisampleRenderTarget extends WebGLRenderTarget {\n\n\tconstructor( width, height, options ) {\n\n\t\tconsole.error( 'THREE.WebGLMultisampleRenderTarget has been removed. Use a normal render target and set the \"samples\" property to greater 0 to enable multisampling.' );\n\t\tsuper( width, height, options );\n\t\tthis.samples = 4;\n\n\t}\n\n}\n\n// r138, f9cd9cab03b7b64244e304900a3a2eeaa3a588ce\n\nclass DataTexture2DArray extends DataArrayTexture {\n\n\tconstructor( data, width, height, depth ) {\n\n\t\tconsole.warn( 'THREE.DataTexture2DArray has been renamed to DataArrayTexture.' );\n\t\tsuper( data, width, height, depth );\n\n\t}\n\n}\n\n// r138, f9cd9cab03b7b64244e304900a3a2eeaa3a588ce\n\nclass DataTexture3D extends Data3DTexture {\n\n\tconstructor( data, width, height, depth ) {\n\n\t\tconsole.warn( 'THREE.DataTexture3D has been renamed to Data3DTexture.' );\n\t\tsuper( data, width, height, depth );\n\n\t}\n\n}\n\n// r144\n\nclass BoxBufferGeometry extends BoxGeometry {\n\n\tconstructor( width, height, depth, widthSegments, heightSegments, depthSegments ) {\n\n\t\tconsole.warn( 'THREE.BoxBufferGeometry has been renamed to THREE.BoxGeometry.' );\n\t\tsuper( width, height, depth, widthSegments, heightSegments, depthSegments );\n\n\n\t}\n\n}\n\n// r144\n\nclass CapsuleBufferGeometry extends CapsuleGeometry {\n\n\tconstructor( radius, length, capSegments, radialSegments ) {\n\n\t\tconsole.warn( 'THREE.CapsuleBufferGeometry has been renamed to THREE.CapsuleGeometry.' );\n\t\tsuper( radius, length, capSegments, radialSegments );\n\n\t}\n\n}\n\n// r144\n\nclass CircleBufferGeometry extends CircleGeometry {\n\n\tconstructor( radius, segments, thetaStart, thetaLength ) {\n\n\t\tconsole.warn( 'THREE.CircleBufferGeometry has been renamed to THREE.CircleGeometry.' );\n\t\tsuper( radius, segments, thetaStart, thetaLength );\n\n\t}\n\n}\n\n// r144\n\nclass ConeBufferGeometry extends ConeGeometry {\n\n\tconstructor( radius, height, radialSegments, heightSegments, openEnded, thetaStart, thetaLength ) {\n\n\t\tconsole.warn( 'THREE.ConeBufferGeometry has been renamed to THREE.ConeGeometry.' );\n\t\tsuper( radius, height, radialSegments, heightSegments, openEnded, thetaStart, thetaLength );\n\n\t}\n\n}\n\n// r144\n\nclass CylinderBufferGeometry extends CylinderGeometry {\n\n\tconstructor( radiusTop, radiusBottom, height, radialSegments, heightSegments, openEnded, thetaStart, thetaLength ) {\n\n\t\tconsole.warn( 'THREE.CylinderBufferGeometry has been renamed to THREE.CylinderGeometry.' );\n\t\tsuper( radiusTop, radiusBottom, height, radialSegments, heightSegments, openEnded, thetaStart, thetaLength );\n\n\t}\n\n}\n\n// r144\n\nclass DodecahedronBufferGeometry extends DodecahedronGeometry {\n\n\tconstructor( radius, detail ) {\n\n\t\tconsole.warn( 'THREE.DodecahedronBufferGeometry has been renamed to THREE.DodecahedronGeometry.' );\n\t\tsuper( radius, detail );\n\n\t}\n\n}\n\n// r144\n\nclass ExtrudeBufferGeometry extends ExtrudeGeometry {\n\n\tconstructor( shapes, options ) {\n\n\t\tconsole.warn( 'THREE.ExtrudeBufferGeometry has been renamed to THREE.ExtrudeGeometry.' );\n\t\tsuper( shapes, options );\n\n\t}\n\n}\n\n// r144\n\nclass IcosahedronBufferGeometry extends IcosahedronGeometry {\n\n\tconstructor( radius, detail ) {\n\n\t\tconsole.warn( 'THREE.IcosahedronBufferGeometry has been renamed to THREE.IcosahedronGeometry.' );\n\t\tsuper( radius, detail );\n\n\t}\n\n}\n\n// r144\n\nclass LatheBufferGeometry extends LatheGeometry {\n\n\tconstructor( points, segments, phiStart, phiLength ) {\n\n\t\tconsole.warn( 'THREE.LatheBufferGeometry has been renamed to THREE.LatheGeometry.' );\n\t\tsuper( points, segments, phiStart, phiLength );\n\n\t}\n\n}\n\n// r144\n\nclass OctahedronBufferGeometry extends OctahedronGeometry {\n\n\tconstructor( radius, detail ) {\n\n\t\tconsole.warn( 'THREE.OctahedronBufferGeometry has been renamed to THREE.OctahedronGeometry.' );\n\t\tsuper( radius, detail );\n\n\t}\n\n}\n\n// r144\n\nclass PlaneBufferGeometry extends PlaneGeometry {\n\n\tconstructor( width, height, widthSegments, heightSegments ) {\n\n\t\tconsole.warn( 'THREE.PlaneBufferGeometry has been renamed to THREE.PlaneGeometry.' );\n\t\tsuper( width, height, widthSegments, heightSegments );\n\n\t}\n\n}\n\n// r144\n\nclass PolyhedronBufferGeometry extends PolyhedronGeometry {\n\n\tconstructor( vertices, indices, radius, detail ) {\n\n\t\tconsole.warn( 'THREE.PolyhedronBufferGeometry has been renamed to THREE.PolyhedronGeometry.' );\n\t\tsuper( vertices, indices, radius, detail );\n\n\t}\n\n}\n\n// r144\n\nclass RingBufferGeometry extends RingGeometry {\n\n\tconstructor( innerRadius, outerRadius, thetaSegments, phiSegments, thetaStart, thetaLength ) {\n\n\t\tconsole.warn( 'THREE.RingBufferGeometry has been renamed to THREE.RingGeometry.' );\n\t\tsuper( innerRadius, outerRadius, thetaSegments, phiSegments, thetaStart, thetaLength );\n\n\t}\n\n}\n\n// r144\n\nclass ShapeBufferGeometry extends ShapeGeometry {\n\n\tconstructor( shapes, curveSegments ) {\n\n\t\tconsole.warn( 'THREE.ShapeBufferGeometry has been renamed to THREE.ShapeGeometry.' );\n\t\tsuper( shapes, curveSegments );\n\n\t}\n\n}\n\n// r144\n\nclass SphereBufferGeometry extends SphereGeometry {\n\n\tconstructor( radius, widthSegments, heightSegments, phiStart, phiLength, thetaStart, thetaLength ) {\n\n\t\tconsole.warn( 'THREE.SphereBufferGeometry has been renamed to THREE.SphereGeometry.' );\n\t\tsuper( radius, widthSegments, heightSegments, phiStart, phiLength, thetaStart, thetaLength );\n\n\t}\n\n}\n\n// r144\n\nclass TetrahedronBufferGeometry extends TetrahedronGeometry {\n\n\tconstructor( radius, detail ) {\n\n\t\tconsole.warn( 'THREE.TetrahedronBufferGeometry has been renamed to THREE.TetrahedronGeometry.' );\n\t\tsuper( radius, detail );\n\n\t}\n\n}\n\n// r144\n\nclass TorusBufferGeometry extends TorusGeometry {\n\n\tconstructor( radius, tube, radialSegments, tubularSegments, arc ) {\n\n\t\tconsole.warn( 'THREE.TorusBufferGeometry has been renamed to THREE.TorusGeometry.' );\n\t\tsuper( radius, tube, radialSegments, tubularSegments, arc );\n\n\t}\n\n}\n\n// r144\n\nclass TorusKnotBufferGeometry extends TorusKnotGeometry {\n\n\tconstructor( radius, tube, tubularSegments, radialSegments, p, q ) {\n\n\t\tconsole.warn( 'THREE.TorusKnotBufferGeometry has been renamed to THREE.TorusKnotGeometry.' );\n\t\tsuper( radius, tube, tubularSegments, radialSegments, p, q );\n\n\t}\n\n}\n\n// r144\n\nclass TubeBufferGeometry extends TubeGeometry {\n\n\tconstructor( path, tubularSegments, radius, radialSegments, closed ) {\n\n\t\tconsole.warn( 'THREE.TubeBufferGeometry has been renamed to THREE.TubeGeometry.' );\n\t\tsuper( path, tubularSegments, radius, radialSegments, closed );\n\n\t}\n\n}\n\nif ( typeof __THREE_DEVTOOLS__ !== 'undefined' ) {\n\n\t__THREE_DEVTOOLS__.dispatchEvent( new CustomEvent( 'register', { detail: {\n\t\trevision: REVISION,\n\t} } ) );\n\n}\n\nif ( typeof window !== 'undefined' ) {\n\n\tif ( window.__THREE__ ) {\n\n\t\tconsole.warn( 'WARNING: Multiple instances of Three.js being imported.' );\n\n\t} else {\n\n\t\twindow.__THREE__ = REVISION;\n\n\t}\n\n}\n\nexport { ACESFilmicToneMapping, AddEquation, AddOperation, AdditiveAnimationBlendMode, AdditiveBlending, AlphaFormat, AlwaysDepth, AlwaysStencilFunc, AmbientLight, AmbientLightProbe, AnimationClip, AnimationLoader, AnimationMixer, AnimationObjectGroup, AnimationUtils, ArcCurve, ArrayCamera, ArrowHelper, Audio, AudioAnalyser, AudioContext, AudioListener, AudioLoader, AxesHelper, BackSide, BasicDepthPacking, BasicShadowMap, Bone, BooleanKeyframeTrack, Box2, Box3, Box3Helper, BoxBufferGeometry, BoxGeometry, BoxHelper, BufferAttribute, BufferGeometry, BufferGeometryLoader, ByteType, Cache, Camera, CameraHelper, CanvasTexture, CapsuleBufferGeometry, CapsuleGeometry, CatmullRomCurve3, CineonToneMapping, CircleBufferGeometry, CircleGeometry, ClampToEdgeWrapping, Clock, Color, ColorKeyframeTrack, ColorManagement, CompressedArrayTexture, CompressedTexture, CompressedTextureLoader, ConeBufferGeometry, ConeGeometry, CubeCamera, CubeReflectionMapping, CubeRefractionMapping, CubeTexture, CubeTextureLoader, CubeUVReflectionMapping, CubicBezierCurve, CubicBezierCurve3, CubicInterpolant, CullFaceBack, CullFaceFront, CullFaceFrontBack, CullFaceNone, Curve, CurvePath, CustomBlending, CustomToneMapping, CylinderBufferGeometry, CylinderGeometry, Cylindrical, Data3DTexture, DataArrayTexture, DataTexture, DataTexture2DArray, DataTexture3D, DataTextureLoader, DataUtils, DecrementStencilOp, DecrementWrapStencilOp, DefaultLoadingManager, DepthFormat, DepthStencilFormat, DepthTexture, DirectionalLight, DirectionalLightHelper, DiscreteInterpolant, DodecahedronBufferGeometry, DodecahedronGeometry, DoubleSide, DstAlphaFactor, DstColorFactor, DynamicCopyUsage, DynamicDrawUsage, DynamicReadUsage, EdgesGeometry, EllipseCurve, EqualDepth, EqualStencilFunc, EquirectangularReflectionMapping, EquirectangularRefractionMapping, Euler, EventDispatcher, ExtrudeBufferGeometry, ExtrudeGeometry, FileLoader, Float16BufferAttribute, Float32BufferAttribute, Float64BufferAttribute, FloatType, Fog, FogExp2, FramebufferTexture, FrontSide, Frustum, GLBufferAttribute, GLSL1, GLSL3, GreaterDepth, GreaterEqualDepth, GreaterEqualStencilFunc, GreaterStencilFunc, GridHelper, Group, HalfFloatType, HemisphereLight, HemisphereLightHelper, HemisphereLightProbe, IcosahedronBufferGeometry, IcosahedronGeometry, ImageBitmapLoader, ImageLoader, ImageUtils, ImmediateRenderObject, IncrementStencilOp, IncrementWrapStencilOp, InstancedBufferAttribute, InstancedBufferGeometry, InstancedInterleavedBuffer, InstancedMesh, Int16BufferAttribute, Int32BufferAttribute, Int8BufferAttribute, IntType, InterleavedBuffer, InterleavedBufferAttribute, Interpolant, InterpolateDiscrete, InterpolateLinear, InterpolateSmooth, InvertStencilOp, KeepStencilOp, KeyframeTrack, LOD, LatheBufferGeometry, LatheGeometry, Layers, LessDepth, LessEqualDepth, LessEqualStencilFunc, LessStencilFunc, Light, LightProbe, Line, Line3, LineBasicMaterial, LineCurve, LineCurve3, LineDashedMaterial, LineLoop, LineSegments, LinearEncoding, LinearFilter, LinearInterpolant, LinearMipMapLinearFilter, LinearMipMapNearestFilter, LinearMipmapLinearFilter, LinearMipmapNearestFilter, LinearSRGBColorSpace, LinearToneMapping, Loader, LoaderUtils, LoadingManager, LoopOnce, LoopPingPong, LoopRepeat, LuminanceAlphaFormat, LuminanceFormat, MOUSE, Material, MaterialLoader, MathUtils, Matrix3, Matrix4, MaxEquation, Mesh, MeshBasicMaterial, MeshDepthMaterial, MeshDistanceMaterial, MeshLambertMaterial, MeshMatcapMaterial, MeshNormalMaterial, MeshPhongMaterial, MeshPhysicalMaterial, MeshStandardMaterial, MeshToonMaterial, MinEquation, MirroredRepeatWrapping, MixOperation, MultiplyBlending, MultiplyOperation, NearestFilter, NearestMipMapLinearFilter, NearestMipMapNearestFilter, NearestMipmapLinearFilter, NearestMipmapNearestFilter, NeverDepth, NeverStencilFunc, NoBlending, NoColorSpace, NoToneMapping, NormalAnimationBlendMode, NormalBlending, NotEqualDepth, NotEqualStencilFunc, NumberKeyframeTrack, Object3D, ObjectLoader, ObjectSpaceNormalMap, OctahedronBufferGeometry, OctahedronGeometry, OneFactor, OneMinusDstAlphaFactor, OneMinusDstColorFactor, OneMinusSrcAlphaFactor, OneMinusSrcColorFactor, OrthographicCamera, PCFShadowMap, PCFSoftShadowMap, PMREMGenerator, Path, PerspectiveCamera, Plane, PlaneBufferGeometry, PlaneGeometry, PlaneHelper, PointLight, PointLightHelper, Points, PointsMaterial, PolarGridHelper, PolyhedronBufferGeometry, PolyhedronGeometry, PositionalAudio, PropertyBinding, PropertyMixer, QuadraticBezierCurve, QuadraticBezierCurve3, Quaternion, QuaternionKeyframeTrack, QuaternionLinearInterpolant, REVISION, RGBADepthPacking, RGBAFormat, RGBAIntegerFormat, RGBA_ASTC_10x10_Format, RGBA_ASTC_10x5_Format, RGBA_ASTC_10x6_Format, RGBA_ASTC_10x8_Format, RGBA_ASTC_12x10_Format, RGBA_ASTC_12x12_Format, RGBA_ASTC_4x4_Format, RGBA_ASTC_5x4_Format, RGBA_ASTC_5x5_Format, RGBA_ASTC_6x5_Format, RGBA_ASTC_6x6_Format, RGBA_ASTC_8x5_Format, RGBA_ASTC_8x6_Format, RGBA_ASTC_8x8_Format, RGBA_BPTC_Format, RGBA_ETC2_EAC_Format, RGBA_PVRTC_2BPPV1_Format, RGBA_PVRTC_4BPPV1_Format, RGBA_S3TC_DXT1_Format, RGBA_S3TC_DXT3_Format, RGBA_S3TC_DXT5_Format, RGBFormat, RGB_ETC1_Format, RGB_ETC2_Format, RGB_PVRTC_2BPPV1_Format, RGB_PVRTC_4BPPV1_Format, RGB_S3TC_DXT1_Format, RGFormat, RGIntegerFormat, RawShaderMaterial, Ray, Raycaster, RectAreaLight, RedFormat, RedIntegerFormat, ReinhardToneMapping, RepeatWrapping, ReplaceStencilOp, ReverseSubtractEquation, RingBufferGeometry, RingGeometry, SRGBColorSpace, Scene, ShaderChunk, ShaderLib, ShaderMaterial, ShadowMaterial, Shape, ShapeBufferGeometry, ShapeGeometry, ShapePath, ShapeUtils, ShortType, Skeleton, SkeletonHelper, SkinnedMesh, Source, Sphere, SphereBufferGeometry, SphereGeometry, Spherical, SphericalHarmonics3, SplineCurve, SpotLight, SpotLightHelper, Sprite, SpriteMaterial, SrcAlphaFactor, SrcAlphaSaturateFactor, SrcColorFactor, StaticCopyUsage, StaticDrawUsage, StaticReadUsage, StereoCamera, StreamCopyUsage, StreamDrawUsage, StreamReadUsage, StringKeyframeTrack, SubtractEquation, SubtractiveBlending, TOUCH, TangentSpaceNormalMap, TetrahedronBufferGeometry, TetrahedronGeometry, Texture, TextureLoader, TorusBufferGeometry, TorusGeometry, TorusKnotBufferGeometry, TorusKnotGeometry, Triangle, TriangleFanDrawMode, TriangleStripDrawMode, TrianglesDrawMode, TubeBufferGeometry, TubeGeometry, TwoPassDoubleSide, UVMapping, Uint16BufferAttribute, Uint32BufferAttribute, Uint8BufferAttribute, Uint8ClampedBufferAttribute, Uniform, UniformsGroup, UniformsLib, UniformsUtils, UnsignedByteType, UnsignedInt248Type, UnsignedIntType, UnsignedShort4444Type, UnsignedShort5551Type, UnsignedShortType, VSMShadowMap, Vector2, Vector3, Vector4, VectorKeyframeTrack, VideoTexture, WebGL1Renderer, WebGL3DRenderTarget, WebGLArrayRenderTarget, WebGLCubeRenderTarget, WebGLMultipleRenderTargets, WebGLMultisampleRenderTarget, WebGLRenderTarget, WebGLRenderer, WebGLUtils, WireframeGeometry, WrapAroundEnding, ZeroCurvatureEnding, ZeroFactor, ZeroSlopeEnding, ZeroStencilOp, _SRGBAFormat, sRGBEncoding };\n","import {\n\tEventDispatcher,\n\tMOUSE,\n\tQuaternion,\n\tSpherical,\n\tTOUCH,\n\tVector2,\n\tVector3\n} from 'three';\n\n// This set of controls performs orbiting, dollying (zooming), and panning.\n// Unlike TrackballControls, it maintains the \"up\" direction object.up (+Y by default).\n//\n//    Orbit - left mouse / touch: one-finger move\n//    Zoom - middle mouse, or mousewheel / touch: two-finger spread or squish\n//    Pan - right mouse, or left mouse + ctrl/meta/shiftKey, or arrow keys / touch: two-finger move\n\nconst _changeEvent = { type: 'change' };\nconst _startEvent = { type: 'start' };\nconst _endEvent = { type: 'end' };\n\nclass OrbitControls extends EventDispatcher {\n\n\tconstructor( object, domElement ) {\n\n\t\tsuper();\n\n\t\tthis.object = object;\n\t\tthis.domElement = domElement;\n\t\tthis.domElement.style.touchAction = 'none'; // disable touch scroll\n\n\t\t// Set to false to disable this control\n\t\tthis.enabled = true;\n\n\t\t// \"target\" sets the location of focus, where the object orbits around\n\t\tthis.target = new Vector3();\n\n\t\t// How far you can dolly in and out ( PerspectiveCamera only )\n\t\tthis.minDistance = 0;\n\t\tthis.maxDistance = Infinity;\n\n\t\t// How far you can zoom in and out ( OrthographicCamera only )\n\t\tthis.minZoom = 0;\n\t\tthis.maxZoom = Infinity;\n\n\t\t// How far you can orbit vertically, upper and lower limits.\n\t\t// Range is 0 to Math.PI radians.\n\t\tthis.minPolarAngle = 0; // radians\n\t\tthis.maxPolarAngle = Math.PI; // radians\n\n\t\t// How far you can orbit horizontally, upper and lower limits.\n\t\t// If set, the interval [ min, max ] must be a sub-interval of [ - 2 PI, 2 PI ], with ( max - min < 2 PI )\n\t\tthis.minAzimuthAngle = - Infinity; // radians\n\t\tthis.maxAzimuthAngle = Infinity; // radians\n\n\t\t// Set to true to enable damping (inertia)\n\t\t// If damping is enabled, you must call controls.update() in your animation loop\n\t\tthis.enableDamping = false;\n\t\tthis.dampingFactor = 0.05;\n\n\t\t// This option actually enables dollying in and out; left as \"zoom\" for backwards compatibility.\n\t\t// Set to false to disable zooming\n\t\tthis.enableZoom = true;\n\t\tthis.zoomSpeed = 1.0;\n\n\t\t// Set to false to disable rotating\n\t\tthis.enableRotate = true;\n\t\tthis.rotateSpeed = 1.0;\n\n\t\t// Set to false to disable panning\n\t\tthis.enablePan = true;\n\t\tthis.panSpeed = 1.0;\n\t\tthis.screenSpacePanning = true; // if false, pan orthogonal to world-space direction camera.up\n\t\tthis.keyPanSpeed = 7.0;\t// pixels moved per arrow key push\n\n\t\t// Set to true to automatically rotate around the target\n\t\t// If auto-rotate is enabled, you must call controls.update() in your animation loop\n\t\tthis.autoRotate = false;\n\t\tthis.autoRotateSpeed = 2.0; // 30 seconds per orbit when fps is 60\n\n\t\t// The four arrow keys\n\t\tthis.keys = { LEFT: 'ArrowLeft', UP: 'ArrowUp', RIGHT: 'ArrowRight', BOTTOM: 'ArrowDown' };\n\n\t\t// Mouse buttons\n\t\tthis.mouseButtons = { LEFT: MOUSE.ROTATE, MIDDLE: MOUSE.DOLLY, RIGHT: MOUSE.PAN };\n\n\t\t// Touch fingers\n\t\tthis.touches = { ONE: TOUCH.ROTATE, TWO: TOUCH.DOLLY_PAN };\n\n\t\t// for reset\n\t\tthis.target0 = this.target.clone();\n\t\tthis.position0 = this.object.position.clone();\n\t\tthis.zoom0 = this.object.zoom;\n\n\t\t// the target DOM element for key events\n\t\tthis._domElementKeyEvents = null;\n\n\t\t//\n\t\t// public methods\n\t\t//\n\n\t\tthis.getPolarAngle = function () {\n\n\t\t\treturn spherical.phi;\n\n\t\t};\n\n\t\tthis.getAzimuthalAngle = function () {\n\n\t\t\treturn spherical.theta;\n\n\t\t};\n\n\t\tthis.getDistance = function () {\n\n\t\t\treturn this.object.position.distanceTo( this.target );\n\n\t\t};\n\n\t\tthis.listenToKeyEvents = function ( domElement ) {\n\n\t\t\tdomElement.addEventListener( 'keydown', onKeyDown );\n\t\t\tthis._domElementKeyEvents = domElement;\n\n\t\t};\n\n\t\tthis.saveState = function () {\n\n\t\t\tscope.target0.copy( scope.target );\n\t\t\tscope.position0.copy( scope.object.position );\n\t\t\tscope.zoom0 = scope.object.zoom;\n\n\t\t};\n\n\t\tthis.reset = function () {\n\n\t\t\tscope.target.copy( scope.target0 );\n\t\t\tscope.object.position.copy( scope.position0 );\n\t\t\tscope.object.zoom = scope.zoom0;\n\n\t\t\tscope.object.updateProjectionMatrix();\n\t\t\tscope.dispatchEvent( _changeEvent );\n\n\t\t\tscope.update();\n\n\t\t\tstate = STATE.NONE;\n\n\t\t};\n\n\t\t// this method is exposed, but perhaps it would be better if we can make it private...\n\t\tthis.update = function () {\n\n\t\t\tconst offset = new Vector3();\n\n\t\t\t// so camera.up is the orbit axis\n\t\t\tconst quat = new Quaternion().setFromUnitVectors( object.up, new Vector3( 0, 1, 0 ) );\n\t\t\tconst quatInverse = quat.clone().invert();\n\n\t\t\tconst lastPosition = new Vector3();\n\t\t\tconst lastQuaternion = new Quaternion();\n\n\t\t\tconst twoPI = 2 * Math.PI;\n\n\t\t\treturn function update() {\n\n\t\t\t\tconst position = scope.object.position;\n\n\t\t\t\toffset.copy( position ).sub( scope.target );\n\n\t\t\t\t// rotate offset to \"y-axis-is-up\" space\n\t\t\t\toffset.applyQuaternion( quat );\n\n\t\t\t\t// angle from z-axis around y-axis\n\t\t\t\tspherical.setFromVector3( offset );\n\n\t\t\t\tif ( scope.autoRotate && state === STATE.NONE ) {\n\n\t\t\t\t\trotateLeft( getAutoRotationAngle() );\n\n\t\t\t\t}\n\n\t\t\t\tif ( scope.enableDamping ) {\n\n\t\t\t\t\tspherical.theta += sphericalDelta.theta * scope.dampingFactor;\n\t\t\t\t\tspherical.phi += sphericalDelta.phi * scope.dampingFactor;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tspherical.theta += sphericalDelta.theta;\n\t\t\t\t\tspherical.phi += sphericalDelta.phi;\n\n\t\t\t\t}\n\n\t\t\t\t// restrict theta to be between desired limits\n\n\t\t\t\tlet min = scope.minAzimuthAngle;\n\t\t\t\tlet max = scope.maxAzimuthAngle;\n\n\t\t\t\tif ( isFinite( min ) && isFinite( max ) ) {\n\n\t\t\t\t\tif ( min < - Math.PI ) min += twoPI; else if ( min > Math.PI ) min -= twoPI;\n\n\t\t\t\t\tif ( max < - Math.PI ) max += twoPI; else if ( max > Math.PI ) max -= twoPI;\n\n\t\t\t\t\tif ( min <= max ) {\n\n\t\t\t\t\t\tspherical.theta = Math.max( min, Math.min( max, spherical.theta ) );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tspherical.theta = ( spherical.theta > ( min + max ) / 2 ) ?\n\t\t\t\t\t\t\tMath.max( min, spherical.theta ) :\n\t\t\t\t\t\t\tMath.min( max, spherical.theta );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t// restrict phi to be between desired limits\n\t\t\t\tspherical.phi = Math.max( scope.minPolarAngle, Math.min( scope.maxPolarAngle, spherical.phi ) );\n\n\t\t\t\tspherical.makeSafe();\n\n\n\t\t\t\tspherical.radius *= scale;\n\n\t\t\t\t// restrict radius to be between desired limits\n\t\t\t\tspherical.radius = Math.max( scope.minDistance, Math.min( scope.maxDistance, spherical.radius ) );\n\n\t\t\t\t// move target to panned location\n\n\t\t\t\tif ( scope.enableDamping === true ) {\n\n\t\t\t\t\tscope.target.addScaledVector( panOffset, scope.dampingFactor );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tscope.target.add( panOffset );\n\n\t\t\t\t}\n\n\t\t\t\toffset.setFromSpherical( spherical );\n\n\t\t\t\t// rotate offset back to \"camera-up-vector-is-up\" space\n\t\t\t\toffset.applyQuaternion( quatInverse );\n\n\t\t\t\tposition.copy( scope.target ).add( offset );\n\n\t\t\t\tscope.object.lookAt( scope.target );\n\n\t\t\t\tif ( scope.enableDamping === true ) {\n\n\t\t\t\t\tsphericalDelta.theta *= ( 1 - scope.dampingFactor );\n\t\t\t\t\tsphericalDelta.phi *= ( 1 - scope.dampingFactor );\n\n\t\t\t\t\tpanOffset.multiplyScalar( 1 - scope.dampingFactor );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tsphericalDelta.set( 0, 0, 0 );\n\n\t\t\t\t\tpanOffset.set( 0, 0, 0 );\n\n\t\t\t\t}\n\n\t\t\t\tscale = 1;\n\n\t\t\t\t// update condition is:\n\t\t\t\t// min(camera displacement, camera rotation in radians)^2 > EPS\n\t\t\t\t// using small-angle approximation cos(x/2) = 1 - x^2 / 8\n\n\t\t\t\tif ( zoomChanged ||\n\t\t\t\t\tlastPosition.distanceToSquared( scope.object.position ) > EPS ||\n\t\t\t\t\t8 * ( 1 - lastQuaternion.dot( scope.object.quaternion ) ) > EPS ) {\n\n\t\t\t\t\tscope.dispatchEvent( _changeEvent );\n\n\t\t\t\t\tlastPosition.copy( scope.object.position );\n\t\t\t\t\tlastQuaternion.copy( scope.object.quaternion );\n\t\t\t\t\tzoomChanged = false;\n\n\t\t\t\t\treturn true;\n\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\n\t\t\t};\n\n\t\t}();\n\n\t\tthis.dispose = function () {\n\n\t\t\tscope.domElement.removeEventListener( 'contextmenu', onContextMenu );\n\n\t\t\tscope.domElement.removeEventListener( 'pointerdown', onPointerDown );\n\t\t\tscope.domElement.removeEventListener( 'pointercancel', onPointerCancel );\n\t\t\tscope.domElement.removeEventListener( 'wheel', onMouseWheel );\n\n\t\t\tscope.domElement.removeEventListener( 'pointermove', onPointerMove );\n\t\t\tscope.domElement.removeEventListener( 'pointerup', onPointerUp );\n\n\n\t\t\tif ( scope._domElementKeyEvents !== null ) {\n\n\t\t\t\tscope._domElementKeyEvents.removeEventListener( 'keydown', onKeyDown );\n\n\t\t\t}\n\n\t\t\t//scope.dispatchEvent( { type: 'dispose' } ); // should this be added here?\n\n\t\t};\n\n\t\t//\n\t\t// internals\n\t\t//\n\n\t\tconst scope = this;\n\n\t\tconst STATE = {\n\t\t\tNONE: - 1,\n\t\t\tROTATE: 0,\n\t\t\tDOLLY: 1,\n\t\t\tPAN: 2,\n\t\t\tTOUCH_ROTATE: 3,\n\t\t\tTOUCH_PAN: 4,\n\t\t\tTOUCH_DOLLY_PAN: 5,\n\t\t\tTOUCH_DOLLY_ROTATE: 6\n\t\t};\n\n\t\tlet state = STATE.NONE;\n\n\t\tconst EPS = 0.000001;\n\n\t\t// current position in spherical coordinates\n\t\tconst spherical = new Spherical();\n\t\tconst sphericalDelta = new Spherical();\n\n\t\tlet scale = 1;\n\t\tconst panOffset = new Vector3();\n\t\tlet zoomChanged = false;\n\n\t\tconst rotateStart = new Vector2();\n\t\tconst rotateEnd = new Vector2();\n\t\tconst rotateDelta = new Vector2();\n\n\t\tconst panStart = new Vector2();\n\t\tconst panEnd = new Vector2();\n\t\tconst panDelta = new Vector2();\n\n\t\tconst dollyStart = new Vector2();\n\t\tconst dollyEnd = new Vector2();\n\t\tconst dollyDelta = new Vector2();\n\n\t\tconst pointers = [];\n\t\tconst pointerPositions = {};\n\n\t\tfunction getAutoRotationAngle() {\n\n\t\t\treturn 2 * Math.PI / 60 / 60 * scope.autoRotateSpeed;\n\n\t\t}\n\n\t\tfunction getZoomScale() {\n\n\t\t\treturn Math.pow( 0.95, scope.zoomSpeed );\n\n\t\t}\n\n\t\tfunction rotateLeft( angle ) {\n\n\t\t\tsphericalDelta.theta -= angle;\n\n\t\t}\n\n\t\tfunction rotateUp( angle ) {\n\n\t\t\tsphericalDelta.phi -= angle;\n\n\t\t}\n\n\t\tconst panLeft = function () {\n\n\t\t\tconst v = new Vector3();\n\n\t\t\treturn function panLeft( distance, objectMatrix ) {\n\n\t\t\t\tv.setFromMatrixColumn( objectMatrix, 0 ); // get X column of objectMatrix\n\t\t\t\tv.multiplyScalar( - distance );\n\n\t\t\t\tpanOffset.add( v );\n\n\t\t\t};\n\n\t\t}();\n\n\t\tconst panUp = function () {\n\n\t\t\tconst v = new Vector3();\n\n\t\t\treturn function panUp( distance, objectMatrix ) {\n\n\t\t\t\tif ( scope.screenSpacePanning === true ) {\n\n\t\t\t\t\tv.setFromMatrixColumn( objectMatrix, 1 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tv.setFromMatrixColumn( objectMatrix, 0 );\n\t\t\t\t\tv.crossVectors( scope.object.up, v );\n\n\t\t\t\t}\n\n\t\t\t\tv.multiplyScalar( distance );\n\n\t\t\t\tpanOffset.add( v );\n\n\t\t\t};\n\n\t\t}();\n\n\t\t// deltaX and deltaY are in pixels; right and down are positive\n\t\tconst pan = function () {\n\n\t\t\tconst offset = new Vector3();\n\n\t\t\treturn function pan( deltaX, deltaY ) {\n\n\t\t\t\tconst element = scope.domElement;\n\n\t\t\t\tif ( scope.object.isPerspectiveCamera ) {\n\n\t\t\t\t\t// perspective\n\t\t\t\t\tconst position = scope.object.position;\n\t\t\t\t\toffset.copy( position ).sub( scope.target );\n\t\t\t\t\tlet targetDistance = offset.length();\n\n\t\t\t\t\t// half of the fov is center to top of screen\n\t\t\t\t\ttargetDistance *= Math.tan( ( scope.object.fov / 2 ) * Math.PI / 180.0 );\n\n\t\t\t\t\t// we use only clientHeight here so aspect ratio does not distort speed\n\t\t\t\t\tpanLeft( 2 * deltaX * targetDistance / element.clientHeight, scope.object.matrix );\n\t\t\t\t\tpanUp( 2 * deltaY * targetDistance / element.clientHeight, scope.object.matrix );\n\n\t\t\t\t} else if ( scope.object.isOrthographicCamera ) {\n\n\t\t\t\t\t// orthographic\n\t\t\t\t\tpanLeft( deltaX * ( scope.object.right - scope.object.left ) / scope.object.zoom / element.clientWidth, scope.object.matrix );\n\t\t\t\t\tpanUp( deltaY * ( scope.object.top - scope.object.bottom ) / scope.object.zoom / element.clientHeight, scope.object.matrix );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// camera neither orthographic nor perspective\n\t\t\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.' );\n\t\t\t\t\tscope.enablePan = false;\n\n\t\t\t\t}\n\n\t\t\t};\n\n\t\t}();\n\n\t\tfunction dollyOut( dollyScale ) {\n\n\t\t\tif ( scope.object.isPerspectiveCamera ) {\n\n\t\t\t\tscale /= dollyScale;\n\n\t\t\t} else if ( scope.object.isOrthographicCamera ) {\n\n\t\t\t\tscope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom * dollyScale ) );\n\t\t\t\tscope.object.updateProjectionMatrix();\n\t\t\t\tzoomChanged = true;\n\n\t\t\t} else {\n\n\t\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.' );\n\t\t\t\tscope.enableZoom = false;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction dollyIn( dollyScale ) {\n\n\t\t\tif ( scope.object.isPerspectiveCamera ) {\n\n\t\t\t\tscale *= dollyScale;\n\n\t\t\t} else if ( scope.object.isOrthographicCamera ) {\n\n\t\t\t\tscope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom / dollyScale ) );\n\t\t\t\tscope.object.updateProjectionMatrix();\n\t\t\t\tzoomChanged = true;\n\n\t\t\t} else {\n\n\t\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.' );\n\t\t\t\tscope.enableZoom = false;\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\t\t// event callbacks - update the object state\n\t\t//\n\n\t\tfunction handleMouseDownRotate( event ) {\n\n\t\t\trotateStart.set( event.clientX, event.clientY );\n\n\t\t}\n\n\t\tfunction handleMouseDownDolly( event ) {\n\n\t\t\tdollyStart.set( event.clientX, event.clientY );\n\n\t\t}\n\n\t\tfunction handleMouseDownPan( event ) {\n\n\t\t\tpanStart.set( event.clientX, event.clientY );\n\n\t\t}\n\n\t\tfunction handleMouseMoveRotate( event ) {\n\n\t\t\trotateEnd.set( event.clientX, event.clientY );\n\n\t\t\trotateDelta.subVectors( rotateEnd, rotateStart ).multiplyScalar( scope.rotateSpeed );\n\n\t\t\tconst element = scope.domElement;\n\n\t\t\trotateLeft( 2 * Math.PI * rotateDelta.x / element.clientHeight ); // yes, height\n\n\t\t\trotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight );\n\n\t\t\trotateStart.copy( rotateEnd );\n\n\t\t\tscope.update();\n\n\t\t}\n\n\t\tfunction handleMouseMoveDolly( event ) {\n\n\t\t\tdollyEnd.set( event.clientX, event.clientY );\n\n\t\t\tdollyDelta.subVectors( dollyEnd, dollyStart );\n\n\t\t\tif ( dollyDelta.y > 0 ) {\n\n\t\t\t\tdollyOut( getZoomScale() );\n\n\t\t\t} else if ( dollyDelta.y < 0 ) {\n\n\t\t\t\tdollyIn( getZoomScale() );\n\n\t\t\t}\n\n\t\t\tdollyStart.copy( dollyEnd );\n\n\t\t\tscope.update();\n\n\t\t}\n\n\t\tfunction handleMouseMovePan( event ) {\n\n\t\t\tpanEnd.set( event.clientX, event.clientY );\n\n\t\t\tpanDelta.subVectors( panEnd, panStart ).multiplyScalar( scope.panSpeed );\n\n\t\t\tpan( panDelta.x, panDelta.y );\n\n\t\t\tpanStart.copy( panEnd );\n\n\t\t\tscope.update();\n\n\t\t}\n\n\t\tfunction handleMouseWheel( event ) {\n\n\t\t\tif ( event.deltaY < 0 ) {\n\n\t\t\t\tdollyIn( getZoomScale() );\n\n\t\t\t} else if ( event.deltaY > 0 ) {\n\n\t\t\t\tdollyOut( getZoomScale() );\n\n\t\t\t}\n\n\t\t\tscope.update();\n\n\t\t}\n\n\t\tfunction handleKeyDown( event ) {\n\n\t\t\tlet needsUpdate = false;\n\n\t\t\tswitch ( event.code ) {\n\n\t\t\t\tcase scope.keys.UP:\n\n\t\t\t\t\tif ( event.ctrlKey || event.metaKey || event.shiftKey ) {\n\n\t\t\t\t\t\trotateUp( 2 * Math.PI * scope.rotateSpeed / scope.domElement.clientHeight );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tpan( 0, scope.keyPanSpeed );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tneedsUpdate = true;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase scope.keys.BOTTOM:\n\n\t\t\t\t\tif ( event.ctrlKey || event.metaKey || event.shiftKey ) {\n\n\t\t\t\t\t\trotateUp( - 2 * Math.PI * scope.rotateSpeed / scope.domElement.clientHeight );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tpan( 0, - scope.keyPanSpeed );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tneedsUpdate = true;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase scope.keys.LEFT:\n\n\t\t\t\t\tif ( event.ctrlKey || event.metaKey || event.shiftKey ) {\n\n\t\t\t\t\t\trotateLeft( 2 * Math.PI * scope.rotateSpeed / scope.domElement.clientHeight );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tpan( scope.keyPanSpeed, 0 );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tneedsUpdate = true;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase scope.keys.RIGHT:\n\n\t\t\t\t\tif ( event.ctrlKey || event.metaKey || event.shiftKey ) {\n\n\t\t\t\t\t\trotateLeft( - 2 * Math.PI * scope.rotateSpeed / scope.domElement.clientHeight );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tpan( - scope.keyPanSpeed, 0 );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tneedsUpdate = true;\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tif ( needsUpdate ) {\n\n\t\t\t\t// prevent the browser from scrolling on cursor keys\n\t\t\t\tevent.preventDefault();\n\n\t\t\t\tscope.update();\n\n\t\t\t}\n\n\n\t\t}\n\n\t\tfunction handleTouchStartRotate() {\n\n\t\t\tif ( pointers.length === 1 ) {\n\n\t\t\t\trotateStart.set( pointers[ 0 ].pageX, pointers[ 0 ].pageY );\n\n\t\t\t} else {\n\n\t\t\t\tconst x = 0.5 * ( pointers[ 0 ].pageX + pointers[ 1 ].pageX );\n\t\t\t\tconst y = 0.5 * ( pointers[ 0 ].pageY + pointers[ 1 ].pageY );\n\n\t\t\t\trotateStart.set( x, y );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction handleTouchStartPan() {\n\n\t\t\tif ( pointers.length === 1 ) {\n\n\t\t\t\tpanStart.set( pointers[ 0 ].pageX, pointers[ 0 ].pageY );\n\n\t\t\t} else {\n\n\t\t\t\tconst x = 0.5 * ( pointers[ 0 ].pageX + pointers[ 1 ].pageX );\n\t\t\t\tconst y = 0.5 * ( pointers[ 0 ].pageY + pointers[ 1 ].pageY );\n\n\t\t\t\tpanStart.set( x, y );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction handleTouchStartDolly() {\n\n\t\t\tconst dx = pointers[ 0 ].pageX - pointers[ 1 ].pageX;\n\t\t\tconst dy = pointers[ 0 ].pageY - pointers[ 1 ].pageY;\n\n\t\t\tconst distance = Math.sqrt( dx * dx + dy * dy );\n\n\t\t\tdollyStart.set( 0, distance );\n\n\t\t}\n\n\t\tfunction handleTouchStartDollyPan() {\n\n\t\t\tif ( scope.enableZoom ) handleTouchStartDolly();\n\n\t\t\tif ( scope.enablePan ) handleTouchStartPan();\n\n\t\t}\n\n\t\tfunction handleTouchStartDollyRotate() {\n\n\t\t\tif ( scope.enableZoom ) handleTouchStartDolly();\n\n\t\t\tif ( scope.enableRotate ) handleTouchStartRotate();\n\n\t\t}\n\n\t\tfunction handleTouchMoveRotate( event ) {\n\n\t\t\tif ( pointers.length == 1 ) {\n\n\t\t\t\trotateEnd.set( event.pageX, event.pageY );\n\n\t\t\t} else {\n\n\t\t\t\tconst position = getSecondPointerPosition( event );\n\n\t\t\t\tconst x = 0.5 * ( event.pageX + position.x );\n\t\t\t\tconst y = 0.5 * ( event.pageY + position.y );\n\n\t\t\t\trotateEnd.set( x, y );\n\n\t\t\t}\n\n\t\t\trotateDelta.subVectors( rotateEnd, rotateStart ).multiplyScalar( scope.rotateSpeed );\n\n\t\t\tconst element = scope.domElement;\n\n\t\t\trotateLeft( 2 * Math.PI * rotateDelta.x / element.clientHeight ); // yes, height\n\n\t\t\trotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight );\n\n\t\t\trotateStart.copy( rotateEnd );\n\n\t\t}\n\n\t\tfunction handleTouchMovePan( event ) {\n\n\t\t\tif ( pointers.length === 1 ) {\n\n\t\t\t\tpanEnd.set( event.pageX, event.pageY );\n\n\t\t\t} else {\n\n\t\t\t\tconst position = getSecondPointerPosition( event );\n\n\t\t\t\tconst x = 0.5 * ( event.pageX + position.x );\n\t\t\t\tconst y = 0.5 * ( event.pageY + position.y );\n\n\t\t\t\tpanEnd.set( x, y );\n\n\t\t\t}\n\n\t\t\tpanDelta.subVectors( panEnd, panStart ).multiplyScalar( scope.panSpeed );\n\n\t\t\tpan( panDelta.x, panDelta.y );\n\n\t\t\tpanStart.copy( panEnd );\n\n\t\t}\n\n\t\tfunction handleTouchMoveDolly( event ) {\n\n\t\t\tconst position = getSecondPointerPosition( event );\n\n\t\t\tconst dx = event.pageX - position.x;\n\t\t\tconst dy = event.pageY - position.y;\n\n\t\t\tconst distance = Math.sqrt( dx * dx + dy * dy );\n\n\t\t\tdollyEnd.set( 0, distance );\n\n\t\t\tdollyDelta.set( 0, Math.pow( dollyEnd.y / dollyStart.y, scope.zoomSpeed ) );\n\n\t\t\tdollyOut( dollyDelta.y );\n\n\t\t\tdollyStart.copy( dollyEnd );\n\n\t\t}\n\n\t\tfunction handleTouchMoveDollyPan( event ) {\n\n\t\t\tif ( scope.enableZoom ) handleTouchMoveDolly( event );\n\n\t\t\tif ( scope.enablePan ) handleTouchMovePan( event );\n\n\t\t}\n\n\t\tfunction handleTouchMoveDollyRotate( event ) {\n\n\t\t\tif ( scope.enableZoom ) handleTouchMoveDolly( event );\n\n\t\t\tif ( scope.enableRotate ) handleTouchMoveRotate( event );\n\n\t\t}\n\n\t\t//\n\t\t// event handlers - FSM: listen for events and reset state\n\t\t//\n\n\t\tfunction onPointerDown( event ) {\n\n\t\t\tif ( scope.enabled === false ) return;\n\n\t\t\tif ( pointers.length === 0 ) {\n\n\t\t\t\tscope.domElement.setPointerCapture( event.pointerId );\n\n\t\t\t\tscope.domElement.addEventListener( 'pointermove', onPointerMove );\n\t\t\t\tscope.domElement.addEventListener( 'pointerup', onPointerUp );\n\n\t\t\t}\n\n\t\t\t//\n\n\t\t\taddPointer( event );\n\n\t\t\tif ( event.pointerType === 'touch' ) {\n\n\t\t\t\tonTouchStart( event );\n\n\t\t\t} else {\n\n\t\t\t\tonMouseDown( event );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onPointerMove( event ) {\n\n\t\t\tif ( scope.enabled === false ) return;\n\n\t\t\tif ( event.pointerType === 'touch' ) {\n\n\t\t\t\tonTouchMove( event );\n\n\t\t\t} else {\n\n\t\t\t\tonMouseMove( event );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onPointerUp( event ) {\n\n\t\t    removePointer( event );\n\n\t\t    if ( pointers.length === 0 ) {\n\n\t\t        scope.domElement.releasePointerCapture( event.pointerId );\n\n\t\t        scope.domElement.removeEventListener( 'pointermove', onPointerMove );\n\t\t        scope.domElement.removeEventListener( 'pointerup', onPointerUp );\n\n\t\t    }\n\n\t\t    scope.dispatchEvent( _endEvent );\n\n\t\t    state = STATE.NONE;\n\n\t\t}\n\n\t\tfunction onPointerCancel( event ) {\n\n\t\t\tremovePointer( event );\n\n\t\t}\n\n\t\tfunction onMouseDown( event ) {\n\n\t\t\tlet mouseAction;\n\n\t\t\tswitch ( event.button ) {\n\n\t\t\t\tcase 0:\n\n\t\t\t\t\tmouseAction = scope.mouseButtons.LEFT;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 1:\n\n\t\t\t\t\tmouseAction = scope.mouseButtons.MIDDLE;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 2:\n\n\t\t\t\t\tmouseAction = scope.mouseButtons.RIGHT;\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\n\t\t\t\t\tmouseAction = - 1;\n\n\t\t\t}\n\n\t\t\tswitch ( mouseAction ) {\n\n\t\t\t\tcase MOUSE.DOLLY:\n\n\t\t\t\t\tif ( scope.enableZoom === false ) return;\n\n\t\t\t\t\thandleMouseDownDolly( event );\n\n\t\t\t\t\tstate = STATE.DOLLY;\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MOUSE.ROTATE:\n\n\t\t\t\t\tif ( event.ctrlKey || event.metaKey || event.shiftKey ) {\n\n\t\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\t\thandleMouseDownPan( event );\n\n\t\t\t\t\t\tstate = STATE.PAN;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\t\thandleMouseDownRotate( event );\n\n\t\t\t\t\t\tstate = STATE.ROTATE;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MOUSE.PAN:\n\n\t\t\t\t\tif ( event.ctrlKey || event.metaKey || event.shiftKey ) {\n\n\t\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\t\thandleMouseDownRotate( event );\n\n\t\t\t\t\t\tstate = STATE.ROTATE;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\t\thandleMouseDownPan( event );\n\n\t\t\t\t\t\tstate = STATE.PAN;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\n\t\t\t\t\tstate = STATE.NONE;\n\n\t\t\t}\n\n\t\t\tif ( state !== STATE.NONE ) {\n\n\t\t\t\tscope.dispatchEvent( _startEvent );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onMouseMove( event ) {\n\n\t\t\tswitch ( state ) {\n\n\t\t\t\tcase STATE.ROTATE:\n\n\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\thandleMouseMoveRotate( event );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase STATE.DOLLY:\n\n\t\t\t\t\tif ( scope.enableZoom === false ) return;\n\n\t\t\t\t\thandleMouseMoveDolly( event );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase STATE.PAN:\n\n\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\thandleMouseMovePan( event );\n\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onMouseWheel( event ) {\n\n\t\t\tif ( scope.enabled === false || scope.enableZoom === false || state !== STATE.NONE ) return;\n\n\t\t\tevent.preventDefault();\n\n\t\t\tscope.dispatchEvent( _startEvent );\n\n\t\t\thandleMouseWheel( event );\n\n\t\t\tscope.dispatchEvent( _endEvent );\n\n\t\t}\n\n\t\tfunction onKeyDown( event ) {\n\n\t\t\tif ( scope.enabled === false || scope.enablePan === false ) return;\n\n\t\t\thandleKeyDown( event );\n\n\t\t}\n\n\t\tfunction onTouchStart( event ) {\n\n\t\t\ttrackPointer( event );\n\n\t\t\tswitch ( pointers.length ) {\n\n\t\t\t\tcase 1:\n\n\t\t\t\t\tswitch ( scope.touches.ONE ) {\n\n\t\t\t\t\t\tcase TOUCH.ROTATE:\n\n\t\t\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\t\t\thandleTouchStartRotate();\n\n\t\t\t\t\t\t\tstate = STATE.TOUCH_ROTATE;\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase TOUCH.PAN:\n\n\t\t\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\t\t\thandleTouchStartPan();\n\n\t\t\t\t\t\t\tstate = STATE.TOUCH_PAN;\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tdefault:\n\n\t\t\t\t\t\t\tstate = STATE.NONE;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 2:\n\n\t\t\t\t\tswitch ( scope.touches.TWO ) {\n\n\t\t\t\t\t\tcase TOUCH.DOLLY_PAN:\n\n\t\t\t\t\t\t\tif ( scope.enableZoom === false && scope.enablePan === false ) return;\n\n\t\t\t\t\t\t\thandleTouchStartDollyPan();\n\n\t\t\t\t\t\t\tstate = STATE.TOUCH_DOLLY_PAN;\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase TOUCH.DOLLY_ROTATE:\n\n\t\t\t\t\t\t\tif ( scope.enableZoom === false && scope.enableRotate === false ) return;\n\n\t\t\t\t\t\t\thandleTouchStartDollyRotate();\n\n\t\t\t\t\t\t\tstate = STATE.TOUCH_DOLLY_ROTATE;\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tdefault:\n\n\t\t\t\t\t\t\tstate = STATE.NONE;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\n\t\t\t\t\tstate = STATE.NONE;\n\n\t\t\t}\n\n\t\t\tif ( state !== STATE.NONE ) {\n\n\t\t\t\tscope.dispatchEvent( _startEvent );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onTouchMove( event ) {\n\n\t\t\ttrackPointer( event );\n\n\t\t\tswitch ( state ) {\n\n\t\t\t\tcase STATE.TOUCH_ROTATE:\n\n\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\thandleTouchMoveRotate( event );\n\n\t\t\t\t\tscope.update();\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase STATE.TOUCH_PAN:\n\n\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\thandleTouchMovePan( event );\n\n\t\t\t\t\tscope.update();\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase STATE.TOUCH_DOLLY_PAN:\n\n\t\t\t\t\tif ( scope.enableZoom === false && scope.enablePan === false ) return;\n\n\t\t\t\t\thandleTouchMoveDollyPan( event );\n\n\t\t\t\t\tscope.update();\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase STATE.TOUCH_DOLLY_ROTATE:\n\n\t\t\t\t\tif ( scope.enableZoom === false && scope.enableRotate === false ) return;\n\n\t\t\t\t\thandleTouchMoveDollyRotate( event );\n\n\t\t\t\t\tscope.update();\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\n\t\t\t\t\tstate = STATE.NONE;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onContextMenu( event ) {\n\n\t\t\tif ( scope.enabled === false ) return;\n\n\t\t\tevent.preventDefault();\n\n\t\t}\n\n\t\tfunction addPointer( event ) {\n\n\t\t\tpointers.push( event );\n\n\t\t}\n\n\t\tfunction removePointer( event ) {\n\n\t\t\tdelete pointerPositions[ event.pointerId ];\n\n\t\t\tfor ( let i = 0; i < pointers.length; i ++ ) {\n\n\t\t\t\tif ( pointers[ i ].pointerId == event.pointerId ) {\n\n\t\t\t\t\tpointers.splice( i, 1 );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction trackPointer( event ) {\n\n\t\t\tlet position = pointerPositions[ event.pointerId ];\n\n\t\t\tif ( position === undefined ) {\n\n\t\t\t\tposition = new Vector2();\n\t\t\t\tpointerPositions[ event.pointerId ] = position;\n\n\t\t\t}\n\n\t\t\tposition.set( event.pageX, event.pageY );\n\n\t\t}\n\n\t\tfunction getSecondPointerPosition( event ) {\n\n\t\t\tconst pointer = ( event.pointerId === pointers[ 0 ].pointerId ) ? pointers[ 1 ] : pointers[ 0 ];\n\n\t\t\treturn pointerPositions[ pointer.pointerId ];\n\n\t\t}\n\n\t\t//\n\n\t\tscope.domElement.addEventListener( 'contextmenu', onContextMenu );\n\n\t\tscope.domElement.addEventListener( 'pointerdown', onPointerDown );\n\t\tscope.domElement.addEventListener( 'pointercancel', onPointerCancel );\n\t\tscope.domElement.addEventListener( 'wheel', onMouseWheel, { passive: false } );\n\n\t\t// force an update at start\n\n\t\tthis.update();\n\n\t}\n\n}\n\n\n// This set of controls performs orbiting, dollying (zooming), and panning.\n// Unlike TrackballControls, it maintains the \"up\" direction object.up (+Y by default).\n// This is very similar to OrbitControls, another set of touch behavior\n//\n//    Orbit - right mouse, or left mouse + ctrl/meta/shiftKey / touch: two-finger rotate\n//    Zoom - middle mouse, or mousewheel / touch: two-finger spread or squish\n//    Pan - left mouse, or arrow keys / touch: one-finger move\n\nclass MapControls extends OrbitControls {\n\n\tconstructor( object, domElement ) {\n\n\t\tsuper( object, domElement );\n\n\t\tthis.screenSpacePanning = false; // pan orthogonal to world-space direction camera.up\n\n\t\tthis.mouseButtons.LEFT = MOUSE.PAN;\n\t\tthis.mouseButtons.RIGHT = MOUSE.ROTATE;\n\n\t\tthis.touches.ONE = TOUCH.PAN;\n\t\tthis.touches.TWO = TOUCH.DOLLY_ROTATE;\n\n\t}\n\n}\n\nexport { OrbitControls, MapControls };\n","import * as THREE from 'three'\r\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls.js'\r\nimport vertexShader from './shaders/vertex.glsl'\r\n//import testFragmentShader from './shaders/test/fragment.glsl'\r\n\r\nexport default class View {\r\n    constructor() {\r\n        this.start();\r\n    }\r\n\r\n    start() {\r\n        // Canvas\r\n        this.canvas = document.querySelector('canvas.webgl');\r\n        // Scene\r\n        this.scene = new THREE.Scene();\r\n        // Geometry\r\n        this.geometry = new THREE.PlaneGeometry(1, 1, 32, 32)\r\n        // Material\r\n        this.material = new THREE.ShaderMaterial({\r\n            vertexShader    : vertexShader,\r\n//            fragmentShader  : testFragmentShader,\r\n            side            : THREE.DoubleSide,\r\n            uniforms        : {\r\n                uTime       : { value : 0.0 },\r\n                uSpeed      : { value : 0.1 },\r\n                uStep       : { value : 0.1 },\r\n                uAmplitude  : { value : 10.0 },\r\n                uDepth      : { value : 20.0 }\r\n            }\r\n        })    \r\n\r\n        // Mesh\r\n        this.mesh = new THREE.Mesh(this.geometry, this.material);\r\n        this.scene.add(this.mesh);\r\n\r\n        // Size of the view\r\n        this.sizes = {\r\n            width: window.innerWidth / 2,\r\n            height: window.innerHeight\r\n        }\r\n\r\n        // Add a listener to the resize event to be able to update the view with a correct size\r\n        window.addEventListener('resize', () => {\r\n            // Update sizes\r\n            this.sizes.width = window.innerWidth / 2;\r\n            this.sizes.height = window.innerHeight;\r\n\r\n            // Update camera\r\n            this.camera.aspect = this.sizes.width / this.sizes.height;\r\n            this.camera.updateProjectionMatrix();\r\n\r\n            // Update renderer\r\n            this.renderer.setSize(this.sizes.width, this.sizes.height);\r\n            this.renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));\r\n        })\r\n\r\n        // Base camera\r\n        this.camera = new THREE.PerspectiveCamera(75, this.sizes.width / this.sizes.height, 0.1, 100);\r\n        this.camera.position.set(0.25, - 0.25, 1);\r\n        this.scene.add(this.camera);\r\n\r\n        // Orbit Controls\r\n        this.controls = new OrbitControls(this.camera, this.canvas);\r\n        this.controls.enableDamping = true;\r\n\r\n        // Renderer\r\n        this.renderer = new THREE.WebGLRenderer({\r\n            canvas: this.canvas,\r\n            antialias : true\r\n        })\r\n        this.renderer.setSize(this.sizes.width, this.sizes.height)\r\n        this.renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2))\r\n        this.renderer.setClearColor( 0x333333 );\r\n\r\n        // Create a clock for the animations\r\n        this.clock = new THREE.Clock();\r\n\r\n        // Run the first tick\r\n        this.tick();        \r\n    }\r\n    \r\n        \r\n    // Updates each frame\r\n    tick() {\r\n        const elapsedTime = this.clock.getElapsedTime();\r\n\r\n        // Update material time\r\n        this.material.uniforms.uTime.value = elapsedTime;\r\n\r\n        // Update Orbit controls\r\n        this.controls.update();\r\n    \r\n        // Render\r\n        this.renderer.render(this.scene, this.camera);\r\n    \r\n        // Call tick again on the next frame\r\n        window.requestAnimationFrame(()=> { this.tick(); });    \r\n    }\r\n}","//import * as dat from 'lil-gui'\n\nimport Editor from \"./Editor.js\"\nimport View from \"./View.js\"\n\nlet mainInstance = null;\n\nexport default class Main {\n    constructor() {\n        if (mainInstance) {\n            return mainInstance;\n        }\n        mainInstance = this;\n\n        this.view   = new View();        \n        this.editor = new Editor();\n    }\n}\n\n\n\n\n// Debug\n/*const gui = new dat.GUI( { width : 300, autoPlace : false })\ndocument.getElementById(\"lil-gui\").append(gui.domElement);\n\n\ngui.add(material.uniforms.uSpeed, 'value').min(0.01).max(1).step(0.01).name(\"uSpeed\")\ngui.add(material.uniforms.uStep, 'value').min(0.01).max(0.99).step(0.01).name(\"uStep\")\ngui.add(material.uniforms.uAmplitude, 'value').min(0.5).max(50).step(0.1).name(\"uAmplitude\")\ngui.add(material.uniforms.uDepth, 'value').min(1).max(100).step(0.1).name(\"uDepth\")\n*/\n","import Main from \"./Main.js\"\r\n\r\nconst main = new Main();"],"names":["Text","pos","n","from","to","text","parts","TextNode","other","start","end","a","RawTextCursor","b","skip","dir","PartialTextCursor","inner","LineCursor","lines","TextLeaf","length","textLength","target","isLine","line","offset","i","string","Line","open","sliceText","prev","joined","appendText","mid","newLen","lineSep","result","part","len","children","child","endLine","childOpen","updated","totalLines","copy","iA","iB","eA","eB","chA","chB","l","ch","flat","chunk","maxChunk","minChunk","chunked","currentLines","currentLen","currentChunk","add","last","node","flush","first","top","offsetValue","size","next","limit","value","done","lineBreak","number","extend","s","isExtendingChar","code","isRegionalIndicator","ZWJ","findClusterBreak","str","forward","includeExtending","nextClusterBreak","prevClusterBreak","surrogateLow","surrogateHigh","codePointAt","codePointSize","countBefore","found","code0","code1","DefaultSplit","MapMode","ChangeDesc","sections","ins","f","posA","posB","individual","iterChanges","composeSets","before","mapSet","assoc","mode","endA","json","ChangeSet","inserted","doc","fromA","toA","fromB","_toB","index","ranges","resultSections","resultInserted","filteredSections","iter","SectionIter","addSection","addInsert","changes","total","force","set","process","spec","sub","insert","insText","insLen","e","forceJoin","values","desc","endB","setA","setB","mkSet","piece","left","sectionLen","insB","SelectionRange","flags","level","change","EditorSelection","head","mainIndex","r","range","main","which","anchor","bidiLevel","goalColumn","checkSelection","selection","docLength","nextID","Facet","combine","compareInput","compare","isStatic","enables","config","sameArray","FacetProvider","deps","get","field","x","state","dependencies","facet","type","addresses","_a","getter","id","idx","multi","depDoc","depSel","depAddrs","dep","tr","ensureAll","newVal","compareArray","oldState","oldAddr","oldVal","getAddr","StateField","addrs","changed","addr","ensureAddr","dynamicFacetSlot","providers","providerAddrs","p","providerTypes","dynamic","val","depChanged","oldProviders","oldValue","initField","createF","updateF","compareF","init","create","Prec_","prec","ext","PrecExtension","Prec","Compartment","CompartmentInstance","content","compartment","Configuration","base","compartments","dynamicSlots","address","staticValues","facets","fields","newCompartments","flatten","oldFacets","extension","seen","known","status","languageData","allowMultipleSelections","v","lineSeparator","changeFilter","transactionFilter","transactionExtender","readOnly","Annotation","AnnotationType","StateEffectType","map","StateEffect","mapping","mapped","effects","effect","Transaction","startState","annotations","scrollIntoView","ann","event","joinRanges","mergeTransaction","sequential","mapForA","mapForB","resolveTransactionInner","docSize","sel","asArray","resolveTransaction","specs","filter","seq","extendTransaction","filterTransaction","back","filtered","filters","extenders","none","CharCategory","nonASCIISingleCaseWordChar","wordChar","hasWordChar","makeCategorizer","wordChars","char","EditorState","computeSlot","require","conf","key","startValues","slot","result1","newChanges","newMapped","j","mapBy","prop","fieldInit","configuration","phrase","m","name","side","provider","at","cat","kA","kB","k","combineConfig","configs","defaults","current","RangeValue","Range","Range$1","cmpRange","Chunk","maxPoint","startAt","arr","lo","hi","diff","newPos","curFrom","curTo","newFrom","newTo","RangeSet","chunkPos","nextLayer","updateSpec","sort","filterFrom","filterTo","cur","LayerCursor","spill","builder","RangeSetBuilder","chunks","touch","HeapCursor","sets","oldSets","newSets","textDiff","comparator","minPointSize","sharedChunks","findSharedChunks","sideA","SpanCursor","sideB","sameValues","iterator","cursor","openRanges","active","openCount","build","lazySort","newArrays","inA","shared","layer","minPoint","rank","rangeIndex","heap","heapBubble","childIndex","remove","findMinIndex","trackOpen","wasPoint","nextVal","startA","startB","dPos","clipEnd","array","foundPos","countColumn","tabSize","findColumn","col","strict","C","COUNT","SET","StyleModule","options","finish","splitSelector","selector","render","selectors","isKeyframes","local","isAt","keyframes","root","modules","StyleSet","adoptedSet","sheet","mod","shift","chrome","mac","ie","brokenModifierNames","keyName","ignoreKey","getSelection","contains","dom","deepActiveElement","elt","hasSelection","clientRectsFor","textRange","isEquivalentPosition","off","targetNode","targetOff","scanFor","domIndex","maxOffset","parent","Rect0","flattenRect","rect","windowRect","win","scrollRectIntoView","y","xMargin","yMargin","ltr","bounding","moveX","moveY","rectHeight","boundingHeight","movedX","movedY","scrollableParent","DOMSelectionState","domSel","anchorNode","anchorOffset","focusNode","focusOffset","preventScrollSupported","focusPreventScroll","stack","scratchRange","dispatchKey","down","up","getRoot","clearAttributes","atElementStart","DOMPos","precise","noChildren","ContentView","view","_pos","_side","track","contentView","rm$1","_dom","after","bias","fromI","fromStart","toI","toEnd","prevEnd","andParent","childList","_rec","_event","ChildCursor","source","hasStart","openStart","openEnd","replaceRange","fromOff","toOff","breakAtStart","breakAtEnd","mergeChildrenInto","dLen","nav","ie_edge","ie_upto10","ie_11up","gecko","webkit","safari","ios","browser","MaxJoinLen","TextView","textDOM","_from","_to","textCoords","MarkView","mark","_hasStart","detachFrom","inlineDOMAtPos","coordsInChildren","rects","WidgetView","widget","CompositionView","topView","scanCompositionTree","posFromDOMInCompositionTree","enterView","fromText","hasComp","WidgetBufferView","imgRect","siblingRect","inlineSiblingRect","nextRect","joinInlineInto","beforePos","afterPos","scan","fallbackRect","combineAttrs","attrsEq","keysA","keysB","updateAttrs","attrs","WidgetType","BlockType","Decoration","startSide","endSide","MarkDecoration","block","PointDecoration","getInclusive","LineDecoration","of","isReplace","widgetsEq","addRange","margin","LineView","deco","cls","hack","totalWidth","_other","docView","BlockWidgetView","_takeDeco","ContentBuilder","disallowBlockEffectsFor","wrapMarks","take","NullWidget","cursorBefore","cursorAfter","decorations","dynamicDecorationMap","tag","clickAddsSelectionRange","dragMovesSelection$1","mouseSelectionStyle","exceptionSink","updateListener","inputHandler","focusChangeEffect","perLineTextDirection","nativeSelectionHidden","ScrollTarget","t","logException","exception","context","handler","editable","nextPluginID","viewPlugin","ViewPlugin","domEventHandlers","buildExtensions","eventHandlers","provide","plugin","pluginInst","PluginInstance","update","editorAttributes","contentAttributes","atomicRanges","scrollMargins","styleModule","ChangedRange","toB","me","dI","rI","ViewUpdate","transactions","changedRanges","Direction","LTR","RTL","dec","LowTypes","ArabicTypes","Brackets","BracketStack","charType","BidiRE","BidiSpan","order","maybe","span","types","computeOrder","direction","outerType","oppositeType","trivialOrder","prevStrong","replace","sI","br","sJ","embed","beforeL","afterL","rtl","movedOver","moveVisually","startIndex","spanI","indexForward","nextIndex","nextSpan","LineBreakPlaceholder","DOMReader","points","nextView","isBlockElement","point","re","nextBreak","breakSize","fromView","maxLen","DOMPoint","DocView","computeCompositionDeco","prevDeco","decoDiff","findChangedDeco","oldLength","observer","gaps","BlockGapWidget","mustRead","fromPointer","betweenUneditable","dummy","inUneditable","rawSel","nextTo","nextToUneditable","nearbyTextNode","lineStart","newRange","domView","viewport","contentWidth","isWider","widest","childRect","width","measure","lineHeight","charWidth","vs","height","allDeco","d","mLeft","mRight","mTop","mBottom","margins","right","bottom","targetRect","compositionSurroundingNode","textNode","cView","topNode","surrounding","CompositionWidget","DecorationComparator$1","comp","inside","groupAt","categorize","linePos","getdx","getdy","yOverlap","upTop","upBot","domPosAtCoords","closest","closestRect","closestX","closestY","closestOverlap","above","below","aboveRect","belowRect","dx","dy","domPosInText","clipX","closestOffset","closestDY","generalSide","posAtCoords","coords","_b","docTop","docHeight","yOffset","halfLine","bounced","posAtCoordsImprecise","element","isSuspiciousSafariCaretResult","isSuspiciousChromeCaretResult","nearest","contentRect","into","moveToLineBoundary","includeWrap","editorRect","lineView","moveByChar","by","spans","check","byGroup","nextCat","moveVertically","distance","startPos","goal","startY","startCoords","resolvedGoal","dist","extra","curY","skipAtoms","oldPos","atoms","moved","InputState","handleEvent","handlers","eventBelongsToEditor","handlerOptions","origin","plugins","pending","PendingKeys","EmacsyPendingKeys","mouseSelection","modifierCodes","dragScrollSpeed","MouseSelection","startEvent","style","mustSelect","addsSelectionRange","dragMovesSelection","isInPrimarySelection","getClickType","sx","sy","brokenClipboardAPI","capturePaste","doPaste","input","byLine","lastLinewiseCopy","lastLine","makeStyle","basicMouseSelection","mustFocus","rangeForClick","visual","insideY","findPositionSide","queryPos","BadMouseDetail","lastMouseDown","lastMouseDownCount","lastMouseDownTime","lastTime","startSel","multiple","startRange","removeRange","dropText","direct","dropPos","del","files","read","finishFile","reader","data","captureCopy","copiedRange","linewise","upto","isFocusChange","focusChangeTransaction","focus","getEffect","updateForFocusChange","startViewHeight","wrappingWhiteSpace","HeightOracle","lineWrapping","whiteSpace","lineHeights","newHeight","h","lineLength","knownHeights","MeasuredHeights","heights","BlockInfo","detail","QueryType","Epsilon","HeightMap","oracle","nodes","oldDoc","NodeBuilder","HeightMapText","split","brk","HeightMapBranch","HeightMapBlock","_height","_oracle","_value","_type","_force","measured","HeightMapGap","firstLine","perLine","perChar","totalPerLine","guess","lineTop","linesAbove","singleHeight","rightTop","rightOffset","subQuery","rightStart","mergeGaps","rebalance","around","relevantWidgetHeight","gap","heightRelevantDecoChanges","DecorationComparator","visiblePixelRange","paddingTop","parentRect","fullPixelRange","LineGap","gA","gB","wrapping","LineGapWidget","vertical","ViewState","IdScaler","guessWrapping","viewports","Viewport","BigScaler","scaleBlock","scrollTarget","contentChanges","heightChanges","prevHeight","updateLines","refresh","domRect","measureContent","paddingBottom","pixelViewport","dTop","dBottom","inView","vp","viewportChange","marginTop","visibleTop","visibleBottom","viewHeight","topPos","mayMeasure","halfMargin","doubleMargin","addGap","structure","avoid","find","lineStructure","viewFrom","viewTo","marginHeight","bot","targetFrac","findFraction","spaceFrac","findPosition","marginWidth","fraction","stateDeco","ratio","counted","heightMap","vpHeight","domBase","obj","scaler","bTop","bBottom","theme","strs","darkTheme","baseThemeID","baseLightID","baseDarkID","lightDarkIDs","buildTheme","scopes","baseTheme$1","DOMChange","typeOver","iHead","iAnchor","selPoints","selectionPoints","selectionFromPoints","applyDOMChange","domChange","newSel","preferredPos","preferredSide","findDiff","mainSel","replaced","compositionRange","rangeChanges","selOff","userEvent","minLen","adjust","move","observeOptions","useCharData","DOMObserver","mutations","mut","entries","g","wasChanged","safariSelectionRangeHack","keyCode","records","record","readSelection","handled","rec","childBefore","findChild","childAfter","_c","_d","curView","curAnchor","EditorView","redrawn","attrsChanged","focusFlag","dispatchFocus","pendingKey","CachedOrder","listener","newState","hadFocus","prevSpecs","newPlugins","scrollHeight","scrollTop","clientHeight","refHeight","oldViewport","refBlock","measuring","BadMeasure","scrolled","editorAttrs","attrsFromFacet","contentAttrs","changedContent","changedEditor","trs","div","request","initial","MaxBidiLine","entry","prefix","cache","lastDir","sources","currentPlatform","normalizeKeyName","platform","alt","ctrl","meta","modifiers","handleKeyEvents","runHandlers","getKeymap","keymap","Keymaps","bindings","buildKeymap","storedPrefix","PrefixTimeout","bound","isPrefix","checkPrefix","is","scope","command","preventDefault","scopeObj","ourObj","full","binding","charCode","isChar","fallthrough","ran","runFor","cmd","baseName","shiftName","RectangleMarker","className","getBase","rectanglesForRange","wrappedLine","blockAt","lineElt","lineStyle","leftSide","rightSide","startBlock","endBlock","visualStart","visualEnd","pieces","drawForLine","drawForWidget","between","horizontal","addSpan","fromOpen","toOpen","fromCoords","toCoords","endPos","docLine","spanFrom","spanTo","sameMarker","LayerView","layerOrder","markers","old","oldI","marker","CanHidePrimary","selectionConfig","drawSelection","cursorLayer","selectionLayer","hideNativeSelection","configChanged","cursors","prim","confChange","setBlinkRate","themeSpec","GutterMarker","gutterLineClass","activeGutters","unfixGutters","gutters","gutterView","SingleGutterView","gutter","vpA","vpB","vpOverlap","detach","lineClasses","classSet","contexts","UpdateContext","advanceCursor","cx","collect","extraMarkers","localMarkers","forLine","newElt","GutterElement","prevMarkers","sameMarkers","domPos","iNew","iOld","skipTo","matched","lineNumberMarkers","lineNumberConfig","exists","NumberMarker","formatNumber","lineNumberGutter","others","maxLineNumber","spacer","max","lineNumbers","DefaultBufferLength","nextPropID","NodeProp","match","NodeType","noProps","props","src","group","groups","NodeSet","newTypes","newProps","CachedNode","CachedInnerNode","IterMode","Tree","positions","mounted","TreeCursor","TreeNode","resolveNode","enter","leave","c","entered","balanceRange","buildTree","FlatBufferCursor","buffer","TreeBuffer","endIndex","pick","checkSide","startI","endI","enterUnfinishedNodesBefore","overlays","_tree","_parent","BufferNode","BufferContext","hasChild","rPos","getChildren","matchNodeContext","parentStart","depth","mustLeave","tree","nodeSet","maxBufferLength","reused","minRepeatType","contextHash","lookAhead","takeNode","minPos","inRepeat","lookAheadAtStart","findBufferSize","copyToBuffer","localChildren","localPositions","localInRepeat","lastGroup","lastEnd","makeRepeatLeaf","make","makeBalanced","makeTree","lastI","lookAheadProp","pair","maxSize","fork","minStart","nodeSize","localSkipped","nodeStart","bufferStart","nodeSizeCache","balanceType","mkTop","mkTree","maxChild","divide","groupFrom","groupStart","groupSize","nextSize","only","TreeFragment","fragments","partial","minGap","fI","nextF","cI","nextC","nextPos","cut","fFrom","fTo","Parser","StringInput","parse","nextTagID","Tag","modified","Modifier","nextModifierID","mods","powerSet","styleTags","byName","tags","rest","rule","Rule","ruleNodeProp","tagHighlighter","all","tagClass","highlightTags","highlighters","highlighter","highlightTree","putStyle","HighlightBuilder","inheritedClass","getStyleTags","tagCls","innerHighlighters","rangeFrom","rangeTo","comment","typeName","propertyName","literal","heading","keyword","operator","punctuation","bracket","languageDataProp","defineLanguageFacet","baseData","sublanguageProp","Language","parser","extraExtensions","syntaxTree","language","topNodeAt","innerNode","sublang","lang","explore","mount","topLang","LRLanguage","DocInput","stringStart","currentContext","ParseContext","treeLen","skipped","scheduleOn","until","endTime","cutFragments","startLen","frags","LanguageState","newCx","vpTo","parseState","requestIdle","callback","timeout","idle","isInputPending","parseWorker","deadline","now","viewportFirst","err","languages","LanguageSupport","support","indentService","indentUnit","unit","getIndentUnit","indentString","cols","ts","getIndentation","IndentContext","service","syntaxIndentation","simulateBreak","simulateDoubleBreak","override","overriden","indentNodeProp","ast","indentFrom","ignoreClosed","indentStrategy","strategy","close","closed","delimitedStrategy","topIndent","TreeIndentContext","atBreak","isParent","bracketedAligned","openToken","sim","openLine","lineEnd","delimitedIndent","closing","align","units","closedAt","space","aligned","flatIndent","continuedIndent","except","matchExcept","foldNodeProp","foldInside","HighlightStyle","modSpec","def","scopeOpt","highlighterFacet","fallbackHighlighter","getHighlighters","syntaxHighlighting","treeHighlighter","themeType","TreeHighlighter","styleChange","defaultHighlightStyle","DefaultScanDist","DefaultBrackets","bracketMatchingHandle","matchingNodes","brackets","byProp","findHandle","hasHandle","matchBrackets","maxScanDistance","matches","handle","matchMarkedBrackets","matchPlainBrackets","_state","token","matching","firstToken","endHandle","tokenType","startCh","startToken","basePos","noTokens","typeArray","warned","defaultTable","legacyName","createTokenType","warnForPart","msg","tagStr","toggleComment","getConfig","toggleLineComment","toggleBlockCommentByLine","option","dispatch","changeLineComment","toggleBlockComment","changeBlockComment","o","selectedLineRanges","SearchMargin","findBlockComment","textBefore","textAfter","spaceBefore","spaceAfter","beforeOff","startText","endText","startSpace","endSpace","endOff","fromLine","toLine","tokens","comments","prevLine","minIndent","indent","empty","single","changeSet","fromHistory","isolateHistory","invertedEffects","historyConfig","_t","isAdjacent","adj","changeEnd","_","historyField_","HistoryState","fromHist","item","HistEvent","updateBranch","addSelection","isolate","time","history","undo","redo","historyState","undoSelection","redoSelection","startSelection","selectionsAfter","invert","selections","branch","newEvent","newBranch","_f","eqSelectionShape","conc","MaxSelectionsPerEvent","lastEvent","sels","popSelection","addMappingToBranch","mapEvent","extraSelections","mappedChanges","fullMapping","joinableUserEvent","undone","prevTime","prevUserEvent","newGroupDelay","historyKeymap","updateSel","setSel","moveSel","how","rangeEnd","cursorByChar","ltrAtCursor","cursorCharLeft","cursorCharRight","cursorByGroup","cursorGroupLeft","cursorGroupRight","interestingNode","bracketProp","moveBySyntax","cursorSyntaxLeft","cursorSyntaxRight","cursorByLine","cursorLineUp","cursorLineDown","pageInfo","selfScroll","marginBottom","cursorByPage","page","scrollRect","scrollBottom","cursorPageUp","cursorPageDown","moveByLineBoundary","cursorLineBoundaryForward","cursorLineBoundaryBackward","cursorLineBoundaryLeft","cursorLineBoundaryRight","cursorLineStart","cursorLineEnd","toMatchingBracket","cursorMatchingBracket","extendSel","selectByChar","selectCharLeft","selectCharRight","selectByGroup","selectGroupLeft","selectGroupRight","selectSyntaxLeft","selectSyntaxRight","selectByLine","selectLineUp","selectLineDown","selectByPage","selectPageUp","selectPageDown","selectLineBoundaryForward","selectLineBoundaryBackward","selectLineBoundaryLeft","selectLineBoundaryRight","selectLineStart","selectLineEnd","cursorDocStart","cursorDocEnd","selectDocStart","selectDocEnd","selectAll","selectLine","selectedLineBlocks","selectParentSyntax","simplifySelection","deleteBy","towards","skipAtomic","deleteByChar","targetPos","drop","deleteCharBackward","deleteCharForward","deleteByGroup","nextChar","deleteGroupBackward","deleteGroupForward","deleteToLineEnd","deleteToLineStart","splitLine","transposeChars","blocks","startLine","moveLine","nextLine","moveLineUp","moveLineDown","copyLine","copyLineUp","copyLineDown","deleteLine","isBetweenBrackets","closedBy","insertNewlineAndIndent","newlineAndIndent","insertBlankLine","atEof","explode","changeBySelectedLine","atLine","indentSelection","norm","indentMore","indentLess","keep","emacsStyleKeymap","standardKeymap","defaultKeymap","Stack","reducePos","score","bufferBase","curContext","StackContext","action","dPrec","count","baseStateID","term","isReduce","nextEnd","nextState","isNode","SimulatedStack","nextStates","best","reduce","dialectID","tracker","Recover","goto","StackBufferCursor","decodeArray","Type","out","stop","digit","CachedToken","nullToken","InputStream","resolved","endOffset","nextChunk","TokenGroup","readToken","ExternalTokenizer","precTable","precOffset","groupMask","dialect","accEnd","overrides","low","high","findOffset","tableData","tableOffset","iPrev","verbose","stackIDs","Safety","cutAt","FragmentCursor","fr","TokenCache","stream","actionIndex","tokenizers","mask","tokenizer","Rec","Parse","stacks","newStacks","stopped","stoppedTokens","tok","finished","findFinished","maxRemaining","outer","strictCx","cxHash","cached","defaultReduce","actions","localStack","pushStackDedup","restarted","tokenEnd","forceBase","Dialect","disabled","LRParser","nodeNames","topTerms","nodeProps","setProp","nodeID","propSpec","tokenArray","getSpecializer","w","loose","table","groupTag","terminal","flag","info","RawString","templateArgsEndFallback","MacroName","R","L","u","U","z","A","Z","Underscore","Zero","Quote","ParenL","ParenR","Space","GreaterThan","rawString","fallback","sawLetter","cppHighlighting","spec_identifier","spec_","spec_templateArgsEnd","spec_scopedIdentifier","cppLanguage","cpp","FragmentList","Main","Fragment01","Fragment02","innerHtml","Editor","REVISION","MOUSE","TOUCH","CullFaceNone","CullFaceBack","CullFaceFront","PCFShadowMap","PCFSoftShadowMap","VSMShadowMap","FrontSide","BackSide","DoubleSide","TwoPassDoubleSide","NoBlending","NormalBlending","AdditiveBlending","SubtractiveBlending","MultiplyBlending","CustomBlending","AddEquation","SubtractEquation","ReverseSubtractEquation","MinEquation","MaxEquation","ZeroFactor","OneFactor","SrcColorFactor","OneMinusSrcColorFactor","SrcAlphaFactor","OneMinusSrcAlphaFactor","DstAlphaFactor","OneMinusDstAlphaFactor","DstColorFactor","OneMinusDstColorFactor","SrcAlphaSaturateFactor","NeverDepth","AlwaysDepth","LessDepth","LessEqualDepth","EqualDepth","GreaterEqualDepth","GreaterDepth","NotEqualDepth","MultiplyOperation","MixOperation","AddOperation","NoToneMapping","LinearToneMapping","ReinhardToneMapping","CineonToneMapping","ACESFilmicToneMapping","CustomToneMapping","UVMapping","CubeReflectionMapping","CubeRefractionMapping","EquirectangularReflectionMapping","EquirectangularRefractionMapping","CubeUVReflectionMapping","RepeatWrapping","ClampToEdgeWrapping","MirroredRepeatWrapping","NearestFilter","NearestMipmapNearestFilter","NearestMipmapLinearFilter","LinearFilter","LinearMipmapNearestFilter","LinearMipmapLinearFilter","UnsignedByteType","ByteType","ShortType","UnsignedShortType","IntType","UnsignedIntType","FloatType","HalfFloatType","UnsignedShort4444Type","UnsignedShort5551Type","UnsignedInt248Type","AlphaFormat","RGBFormat","RGBAFormat","LuminanceFormat","LuminanceAlphaFormat","DepthFormat","DepthStencilFormat","RedFormat","RedIntegerFormat","RGFormat","RGIntegerFormat","RGBAIntegerFormat","RGB_S3TC_DXT1_Format","RGBA_S3TC_DXT1_Format","RGBA_S3TC_DXT3_Format","RGBA_S3TC_DXT5_Format","RGB_PVRTC_4BPPV1_Format","RGB_PVRTC_2BPPV1_Format","RGBA_PVRTC_4BPPV1_Format","RGBA_PVRTC_2BPPV1_Format","RGB_ETC1_Format","RGB_ETC2_Format","RGBA_ETC2_EAC_Format","RGBA_ASTC_4x4_Format","RGBA_ASTC_5x4_Format","RGBA_ASTC_5x5_Format","RGBA_ASTC_6x5_Format","RGBA_ASTC_6x6_Format","RGBA_ASTC_8x5_Format","RGBA_ASTC_8x6_Format","RGBA_ASTC_8x8_Format","RGBA_ASTC_10x5_Format","RGBA_ASTC_10x6_Format","RGBA_ASTC_10x8_Format","RGBA_ASTC_10x10_Format","RGBA_ASTC_12x10_Format","RGBA_ASTC_12x12_Format","RGBA_BPTC_Format","LinearEncoding","sRGBEncoding","BasicDepthPacking","RGBADepthPacking","TangentSpaceNormalMap","ObjectSpaceNormalMap","SRGBColorSpace","LinearSRGBColorSpace","KeepStencilOp","AlwaysStencilFunc","StaticDrawUsage","GLSL3","_SRGBAFormat","EventDispatcher","listeners","listenerArray","_lut","DEG2RAD","RAD2DEG","generateUUID","d0","d1","d2","d3","clamp","min","euclideanModulo","lerp","isPowerOfTwo","floorPowerOfTwo","denormalize","normalize","Vector2","scalar","minVal","maxVal","alpha","v1","v2","attribute","center","angle","Matrix3","n11","n12","n13","n21","n22","n23","n31","n32","n33","te","xAxis","yAxis","zAxis","ae","be","a11","a12","a13","a21","a22","a23","a31","a32","a33","b11","b12","b13","b21","b22","b23","b31","b32","b33","t11","t12","t13","det","detInv","tmp","matrix4","tx","ty","rotation","cy","_m3","theta","matrix","arrayNeedsUint32","createElementNS","SRGBToLinear","LinearToSRGB","FN","ColorManagement","colorSpace","color","sourceColorSpace","targetColorSpace","fn","_colorKeywords","_rgb$1","_hslA","_hslB","hue2rgb","q","toComponents","Color","hex","handleAlpha","components","hue","saturation","lightness","delta","color1","color2","_canvas","ImageUtils","image","canvas","imageData","Source","isRootObject","output","url","serializeImage","textureId","Texture","wrapS","wrapT","magFilter","minFilter","format","anisotropy","encoding","uv","Vector4","m11","m12","m13","m21","m22","m23","m31","m32","m33","xx","yy","zz","xy","xz","yz","WebGLRenderTarget","DataArrayTexture","Data3DTexture","Quaternion","dst","dstOffset","src0","srcOffset0","src1","srcOffset1","x0","y0","z0","w0","x1","y1","z1","w1","cos","sqrSin","sin","tDir","quaternion","euler","c1","c2","c3","s1","s2","s3","axis","halfAngle","trace","vFrom","vTo","step","qax","qay","qaz","qaw","qbx","qby","qbz","qbw","qb","cosHalfTheta","sqrSinHalfTheta","sinHalfTheta","halfTheta","ratioA","ratioB","qa","u1","sqrt1u1","sqrtu1","u2","u3","Vector3","_quaternion$4","qx","qy","qz","qw","ix","iy","iz","iw","camera","ax","ay","az","bx","bz","denominator","planeNormal","_vector$c","normal","dz","radius","phi","sinPhiRadius","sz","Box3","minX","minY","minZ","maxX","maxY","maxZ","il","halfSize","_vector$b","object","box","vector","geometry","position","_box$3","sphere","plane","triangle","_center","_extents","_v0$2","_v1$7","_v2$4","_f0","_f1","_f2","axes","satForAxes","_triangleNormal","_points","_testAxis","v0","extents","p0","p1","p2","_box$2","_v1$6","_v2$3","Sphere","optionalCenter","maxRadiusSq","radiusSum","deltaLengthSq","lengthSq","_vector$a","_segCenter","_segDir","_diff","_edge1","_edge2","_normal$1","Ray","ray","directionDistance","optionalPointOnRay","optionalPointOnSegment","segExtent","a01","b0","b1","s0","sqrDist","extDet","invDet","tca","radius2","thc","t0","t1","distToPoint","tmin","tmax","tymin","tymax","tzmin","tzmax","invdirx","invdiry","invdirz","backfaceCulling","DdN","sign","DdQxE2","DdE1xQ","QdN","Matrix4","n14","n24","n34","n41","n42","n43","n44","scaleX","_v1$5","scaleY","scaleZ","af","bf","ce","cf","de","df","ac","ad","bc","bd","_zero","_one","eye","_z","_x","_y","a14","a24","a34","a41","a42","a43","a44","b14","b24","b34","b41","b42","b43","b44","t14","scaleXSq","scaleYSq","scaleZSq","yx","zx","zy","scale","x2","y2","z2","wx","wy","wz","_m1$2","invSX","invSY","invSZ","near","far","_matrix$1","_quaternion$3","Euler","newOrder","Layers","channel","layers","_object3DId","_v1$4","_q1","_m1$1","_target","_position$3","_scale$2","_quaternion$2","_xAxis","_yAxis","_zAxis","_addedEvent","_removedEvent","Object3D","onRotationChange","onQuaternionChange","childResult","updateParents","updateChildren","serialize","library","parameters","shapes","shape","uuids","animation","geometries","extractFromCache","materials","textures","images","skeletons","animations","recursive","_v0$1","_v1$3","_v2$2","_v3$1","_vab","_vac","_vbc","_vap","_vbp","_vcp","Triangle","targetLengthSq","dot00","dot01","dot02","dot11","dot12","denom","invDenom","p3","uv1","uv2","uv3","i0","i1","i2","d4","vc","d5","d6","vb","va","materialId","Material","newValue","currentValue","srcPlanes","dstPlanes","MeshBasicMaterial","_vector$9","_vector2$1","BufferAttribute","itemSize","normalized","index1","index2","Uint16BufferAttribute","Uint32BufferAttribute","Float32BufferAttribute","_id$1","_m1","_obj","_offset","_box$1","_boxMorphTargets","_vector$8","BufferGeometry","materialIndex","normalMatrix","tangent","morphAttributesPosition","morphAttribute","morphTargetsRelative","jl","attributes","indices","normals","uvs","nVertices","tangents","tan1","tan2","vA","vB","vC","uvA","uvB","uvC","sdir","tdir","handleTriangle","tmp2","n2","handleVertex","positionAttribute","normalAttribute","pA","pB","pC","nA","nB","nC","cb","ab","convertBufferAttribute","array2","geometry2","newAttribute","morphAttributes","morphArray","hasMorphAttributes","attributeArray","boundingSphere","boundingBox","_inverseMatrix$2","_ray$2","_sphere$3","_vA$1","_vB$1","_vC$1","_tempA","_morphA","_uvA$1","_uvB$1","_uvC$1","_intersectionPoint","_intersectionPointWorld","Mesh","material","keys","ml","vert","morphPosition","morphInfluences","influence","raycaster","intersects","matrixWorld","intersection","drawRange","groupMaterial","checkBufferGeometryIntersection","checkIntersection","intersect","face","BoxGeometry","widthSegments","heightSegments","depthSegments","vertices","numberOfVertices","buildPlane","udir","vdir","gridX","gridY","segmentWidth","segmentHeight","widthHalf","heightHalf","depthHalf","gridX1","gridY1","vertexCounter","groupCount","cloneUniforms","property","mergeUniforms","uniforms","merged","cloneUniformsGroups","getUnlitUniformColorSpace","renderer","UniformsUtils","default_vertex","default_fragment","ShaderMaterial","extensions","Camera","PerspectiveCamera","fov","aspect","focalLength","vExtentSlope","fullWidth","fullHeight","skew","CubeCamera","renderTarget","cameraPX","cameraNX","cameraPY","cameraNY","cameraPZ","cameraNZ","scene","currentRenderTarget","currentToneMapping","currentXrEnabled","generateMipmaps","CubeTexture","WebGLCubeRenderTarget","texture","shader","mesh","currentMinFilter","stencil","_vector1","_vector2","_normalMatrix","Plane","constant","inverseNormalLength","startSign","endSign","optionalNormalMatrix","referencePoint","_sphere$2","_vector$7","Frustum","p4","p5","planes","frustum","me0","me1","me2","me3","me4","me5","me6","me7","me8","me9","me10","me11","me12","me13","me14","me15","sprite","negRadius","WebGLAnimation","isAnimating","animationLoop","requestId","onAnimationFrame","frame","WebGLAttributes","gl","capabilities","isWebGL2","buffers","createBuffer","bufferType","usage","updateBuffer","updateRange","PlaneGeometry","width_half","height_half","segment_width","segment_height","alphamap_fragment","alphamap_pars_fragment","alphatest_fragment","alphatest_pars_fragment","aomap_fragment","aomap_pars_fragment","begin_vertex","beginnormal_vertex","bsdfs","iridescence_fragment","bumpmap_pars_fragment","clipping_planes_fragment","clipping_planes_pars_fragment","clipping_planes_pars_vertex","clipping_planes_vertex","color_fragment","color_pars_fragment","color_pars_vertex","color_vertex","common","cube_uv_reflection_fragment","defaultnormal_vertex","displacementmap_pars_vertex","displacementmap_vertex","emissivemap_fragment","emissivemap_pars_fragment","encodings_fragment","encodings_pars_fragment","envmap_fragment","envmap_common_pars_fragment","envmap_pars_fragment","envmap_pars_vertex","envmap_vertex","fog_vertex","fog_pars_vertex","fog_fragment","fog_pars_fragment","gradientmap_pars_fragment","lightmap_fragment","lightmap_pars_fragment","lights_lambert_fragment","lights_lambert_pars_fragment","lights_pars_begin","envmap_physical_pars_fragment","lights_toon_fragment","lights_toon_pars_fragment","lights_phong_fragment","lights_phong_pars_fragment","lights_physical_fragment","lights_physical_pars_fragment","lights_fragment_begin","lights_fragment_maps","lights_fragment_end","logdepthbuf_fragment","logdepthbuf_pars_fragment","logdepthbuf_pars_vertex","logdepthbuf_vertex","map_fragment","map_pars_fragment","map_particle_fragment","map_particle_pars_fragment","metalnessmap_fragment","metalnessmap_pars_fragment","morphcolor_vertex","morphnormal_vertex","morphtarget_pars_vertex","morphtarget_vertex","normal_fragment_begin","normal_fragment_maps","normal_pars_fragment","normal_pars_vertex","normal_vertex","normalmap_pars_fragment","clearcoat_normal_fragment_begin","clearcoat_normal_fragment_maps","clearcoat_pars_fragment","iridescence_pars_fragment","output_fragment","packing","premultiplied_alpha_fragment","project_vertex","dithering_fragment","dithering_pars_fragment","roughnessmap_fragment","roughnessmap_pars_fragment","shadowmap_pars_fragment","shadowmap_pars_vertex","shadowmap_vertex","shadowmask_pars_fragment","skinbase_vertex","skinning_pars_vertex","skinning_vertex","skinnormal_vertex","specularmap_fragment","specularmap_pars_fragment","tonemapping_fragment","tonemapping_pars_fragment","transmission_fragment","transmission_pars_fragment","uv_pars_fragment","uv_pars_vertex","uv_vertex","uv2_pars_fragment","uv2_pars_vertex","uv2_vertex","worldpos_vertex","vertex$h","fragment$h","vertex$g","fragment$g","vertex$f","fragment$f","vertex$e","fragment$e","vertex$d","fragment$d","vertex$c","fragment$c","vertex$b","fragment$b","vertex$a","fragment$a","vertex$9","fragment$9","vertex$8","fragment$8","vertex$7","fragment$7","vertex$6","fragment$6","vertex$5","fragment$5","vertex$4","fragment$4","vertex$3","fragment$3","vertex$2","fragment$2","vertex$1","fragment$1","ShaderChunk","UniformsLib","ShaderLib","_rgb","WebGLBackground","cubemaps","cubeuvmaps","objects","premultipliedAlpha","clearColor","clearAlpha","planeMesh","boxMesh","currentBackground","currentBackgroundVersion","currentTonemapping","renderList","forceClear","background","xr","session","setClear","WebGLBindingStates","maxVertexAttributes","vaoAvailable","bindingStates","defaultState","createBindingState","currentState","forceUpdate","setup","program","updateBuffers","getBindingState","bindVertexArrayObject","needsUpdate","saveCache","wireframe","setupVertexAttributes","createVertexArrayObject","vao","deleteVertexArrayObject","programMap","stateMap","newAttributes","enabledAttributes","attributeDivisors","cachedAttributes","geometryAttributes","attributesNum","programAttributes","cachedAttribute","geometryAttribute","initAttributes","enableAttribute","enableAttributeAndDivisor","meshPerAttribute","disableUnusedAttributes","vertexAttribPointer","stride","materialDefaultAttributeValues","programAttribute","bytesPerElement","dispose","reset","geometryId","programId","releaseStatesOfGeometry","releaseStatesOfProgram","resetDefaultState","WebGLBufferRenderer","setMode","renderInstances","primcount","methodName","WebGLCapabilities","maxAnisotropy","getMaxAnisotropy","getMaxPrecision","precision","maxPrecision","drawBuffers","logarithmicDepthBuffer","maxTextures","maxVertexTextures","maxTextureSize","maxCubemapSize","maxAttributes","maxVertexUniforms","maxVaryings","maxFragmentUniforms","vertexTextures","floatFragmentTextures","floatVertexTextures","maxSamples","WebGLClipping","properties","globalState","numGlobalPlanes","localClippingEnabled","renderingShadows","viewNormalMatrix","uniform","enableLocalClipping","enabled","projectPlanes","resetGlobalState","useCache","clipIntersection","clipShadows","materialProperties","nGlobal","lGlobal","dstArray","skipTransform","nPlanes","flatSize","viewMatrix","i4","WebGLCubeMaps","mapTextureMapping","cubemap","onTextureDispose","OrthographicCamera","scaleW","scaleH","LOD_MIN","EXTRA_LOD_SIGMA","MAX_SAMPLES","_flatCamera","_clearColor","_oldTarget","PHI","INV_PHI","_axisDirections","PMREMGenerator","sigma","cubeUVRenderTarget","equirectangular","_getCubemapMaterial","_getEquirectMaterial","cubeSize","outputTarget","_setViewport","params","_createRenderTarget","_lodMax","_createPlanes","_getBlurShader","tmpMesh","cubeCamera","upSign","forwardSign","originalAutoClear","toneMapping","backgroundMaterial","backgroundBox","useSolidColor","isCubeTexture","autoClear","poleAxis","lodIn","lodOut","pingPongRenderTarget","targetIn","targetOut","sigmaRadians","blurMaterial","STANDARD_DEVIATIONS","blurMesh","blurUniforms","pixels","radiansPerPixel","sigmaPixels","samples","weights","sum","weight","outputSize","lodMax","lodPlanes","sizeLods","sigmas","lod","totalLods","sizeLod","texelSize","cubeFaces","positionSize","uvSize","faceIndexSize","faceIndex","coordinates","fill","_getCommonVertexShader","WebGLCubeUVMaps","cubeUVmaps","pmremGenerator","isEquirectMap","isCubeMap","isCubeTextureComplete","cubemapUV","WebGLExtensions","getExtension","WebGLGeometries","wireframeAttributes","onGeometryDispose","updateWireframeAttribute","geometryIndex","geometryPosition","version","previousAttribute","getWireframeAttribute","currentAttribute","WebGLIndexedBufferRenderer","setIndex","WebGLInfo","memory","instanceCount","numericalSort","absNumericalSort","WebGLMorphtargets","influencesList","morphTextures","morph","workInfluences","objectInfluences","morphTargetsCount","disposeTexture","hasMorphPosition","hasMorphNormals","hasMorphColors","morphTargets","morphNormals","morphColors","vertexDataCount","vertexDataStride","morphTarget","morphNormal","morphColor","morphInfluencesSum","morphBaseInfluence","influences","WebGLObjects","updateMap","buffergeometry","onInstancedMeshDispose","instancedMesh","emptyTexture","emptyArrayTexture","empty3dTexture","emptyCubeTexture","arrayCacheF32","arrayCacheI32","mat4array","mat3array","mat2array","nBlocks","blockSize","firstElem","arraysEqual","copyArray","allocTexUnits","setValueV1f","setValueV2f","setValueV3f","setValueV4f","setValueM2","elements","setValueM3","setValueM4","setValueV1i","setValueV2i","setValueV3i","setValueV4i","setValueV1ui","setValueV2ui","setValueV3ui","setValueV4ui","setValueT1","setValueT3D1","setValueT6","setValueT2DArray1","getSingularSetter","setValueV1fArray","setValueV2fArray","setValueV3fArray","setValueV4fArray","setValueM2Array","setValueM3Array","setValueM4Array","setValueV1iArray","setValueV2iArray","setValueV3iArray","setValueV4iArray","setValueV1uiArray","setValueV2uiArray","setValueV3uiArray","setValueV4uiArray","setValueT1Array","setValueT3DArray","setValueT6Array","setValueT2DArrayArray","getPureArraySetter","SingleUniform","activeInfo","PureArrayUniform","StructuredUniform","RePathPart","addUniform","container","uniformObject","parseUniform","path","pathLength","matchEnd","idIsIndex","subscript","WebGLUniforms","WebGLShader","programIdCount","handleSource","errorLine","lines2","getEncodingComponents","getShaderErrors","errors","errorMatches","getTexelEncodingFunction","functionName","getToneMappingFunction","toneMappingName","generateExtensions","filterEmptyLine","generateDefines","defines","fetchAttributeLocations","locationSize","replaceLightNums","numSpotLightCoords","replaceClippingPlaneNums","includePattern","resolveIncludes","includeReplacer","include","unrollLoopPattern","unrollLoops","loopReplacer","snippet","generatePrecision","precisionstring","generateShadowMapTypeDefine","shadowMapTypeDefine","generateEnvMapTypeDefine","envMapTypeDefine","generateEnvMapModeDefine","envMapModeDefine","generateEnvMapBlendingDefine","envMapBlendingDefine","generateCubeUVSize","imageHeight","maxMip","texelHeight","WebGLProgram","cacheKey","vertexShader","fragmentShader","envMapCubeUVSize","customExtensions","customDefines","prefixVertex","prefixFragment","versionString","vertexGlsl","fragmentGlsl","glVertexShader","glFragmentShader","programLog","vertexLog","fragmentLog","runnable","haveDiagnostics","vertexErrors","fragmentErrors","cachedUniforms","_id","WebGLShaderCache","vertexShaderStage","fragmentShaderStage","materialShaders","shaderStage","stage","WebGLShaderStage","WebGLPrograms","clipping","_programLayers","_customShaders","programs","shaderIDs","getParameters","lights","shadows","fog","environment","envMap","envMapCubeUVHeight","shaderID","morphTextureStride","customVertexShaderID","customFragmentShaderID","useAlphaTest","useClearcoat","useIridescence","getProgramCacheKey","getProgramCacheKeyParameters","getProgramCacheKeyBooleans","getUniforms","acquireProgram","pl","preexistingProgram","releaseProgram","releaseShaderCache","WebGLProperties","painterSortStable","reversePainterSortStable","WebGLRenderList","renderItems","renderItemsIndex","opaque","transmissive","transparent","getNextRenderItem","groupOrder","renderItem","push","unshift","customOpaqueSort","customTransparentSort","WebGLRenderLists","lists","renderCallDepth","listArray","list","UniformsCache","light","ShadowUniformsCache","nextVersion","shadowCastingAndTexturingLightsFirst","lightA","lightB","WebGLLights","shadowCache","vector3","matrix42","physicallyCorrectLights","directionalLength","pointLength","spotLength","rectAreaLength","hemiLength","numDirectionalShadows","numPointShadows","numSpotShadows","numSpotMaps","numSpotShadowsWithMaps","scaleFactor","intensity","shadowMap","shadow","shadowUniforms","hash","setupView","WebGLRenderState","lightsArray","shadowsArray","pushLight","pushShadow","shadowLight","setupLights","setupLightsView","WebGLRenderStates","renderStates","renderStateArray","renderState","MeshDepthMaterial","MeshDistanceMaterial","vertex","fragment","WebGLShadowMap","_renderer","_objects","_capabilities","_frustum","_shadowMapSize","_viewportSize","_viewport","_depthMaterial","_distanceMaterial","_materialCache","_maxTextureSize","shadowSide","shadowMaterialVertical","shadowMaterialHorizontal","fullScreenTri","fullScreenMesh","activeCubeFace","activeMipmapLevel","shadowFrameExtents","pars","viewportCount","renderObject","VSMPass","getDepthMaterial","shadowCameraNear","shadowCameraFar","customMaterial","keyA","keyB","materialsForVariant","cachedMaterial","shadowCamera","kl","depthMaterial","WebGLState","ColorBuffer","locked","currentColorMask","currentColorClear","colorMask","lock","DepthBuffer","currentDepthMask","currentDepthFunc","currentDepthClear","depthTest","enable","disable","depthMask","depthFunc","StencilBuffer","currentStencilMask","currentStencilFunc","currentStencilRef","currentStencilFuncMask","currentStencilFail","currentStencilZFail","currentStencilZPass","currentStencilClear","stencilTest","stencilMask","stencilFunc","stencilRef","stencilFail","stencilZFail","stencilZPass","colorBuffer","depthBuffer","stencilBuffer","uboBindings","uboProgramMap","enabledCapabilities","currentBoundFramebuffers","currentDrawbuffers","defaultDrawbuffers","currentProgram","currentBlendingEnabled","currentBlending","currentBlendEquation","currentBlendSrc","currentBlendDst","currentBlendEquationAlpha","currentBlendSrcAlpha","currentBlendDstAlpha","currentPremultipledAlpha","currentFlipSided","currentCullFace","currentLineWidth","currentPolygonOffsetFactor","currentPolygonOffsetUnits","lineWidthAvailable","glVersion","currentTextureSlot","currentBoundTextures","scissorParam","viewportParam","currentScissor","currentViewport","createTexture","emptyTextures","setFlipSided","setCullFace","setBlending","bindFramebuffer","framebuffer","useProgram","equationToGL","factorToGL","blending","blendEquation","blendSrc","blendDst","blendEquationAlpha","blendSrcAlpha","blendDstAlpha","setMaterial","frontFaceCW","flipSided","stencilWrite","setPolygonOffset","cullFace","setLineWidth","polygonOffset","factor","setScissorTest","scissorTest","activeTexture","webglSlot","bindTexture","webglType","webglTexture","boundTexture","unbindTexture","compressedTexImage2D","error","compressedTexImage3D","texSubImage2D","texSubImage3D","compressedTexSubImage2D","compressedTexSubImage3D","texStorage2D","texStorage3D","texImage2D","texImage3D","scissor","updateUBOMapping","uniformsGroup","blockIndex","uniformBlockBinding","WebGLTextures","_gl","utils","multisampledRTTExt","supportsInvalidateFramebuffer","_videoTextures","_sources","useOffscreenCanvas","createCanvas","resizeImage","needsPowerOfTwo","needsNewCanvas","floor","isPowerOfTwo$1","textureNeedsPowerOfTwo","textureNeedsGenerateMipmaps","supportsMips","generateMipmap","getInternalFormat","internalFormatName","glFormat","glType","forceLinearEncoding","internalFormat","getMipLevels","filterFallback","deallocateTexture","onRenderTargetDispose","deallocateRenderTarget","textureProperties","webglTextures","deleteTexture","renderTargetProperties","attachmentProperties","textureUnits","resetTextureUnits","allocateTextureUnit","textureUnit","getTextureCacheKey","setTexture2D","updateVideoTexture","uploadTexture","setTexture2DArray","setTexture3D","setTextureCube","uploadCubeTexture","wrappingToGL","filterToGL","setTextureParameters","textureType","initTexture","forceUpload","textureCacheKey","sourceProperties","verifyColorSpace","glInternalFormat","mipmap","mipmaps","useTexStorage","allocateMemory","levels","isCompressed","isDataTexture","cubeImage","mipmapImage","setupFrameBufferTexture","attachment","textureTarget","useMultisampledRTT","getRenderTargetSamples","setupRenderBufferStorage","renderbuffer","isMultisample","depthTexture","setupDepthTexture","webglDepthTexture","setupDepthRenderbuffer","isCube","rebindTextures","colorTexture","setupRenderTarget","isMultipleRenderTargets","glTextureType","updateRenderTargetMipmap","updateMultisampleRenderTarget","invalidationArray","depthStyle","ignoreDepthValues","WebGLUtils","convert","ArrayCamera","Group","_moveEvent","WebXRController","inputSource","hand","inputjoint","referenceSpace","inputPose","gripPose","handPose","targetRay","grip","jointPose","joint","indexTip","thumbTip","distanceToPinch","threshold","DepthTexture","WebXRManager","framebufferScaleFactor","referenceSpaceType","customReferenceSpace","pose","glBinding","glProjLayer","glBaseLayer","xrFrame","initialRenderTarget","newRenderTarget","controllers","controllerInputSources","planesLastChangedTimes","cameraL","cameraR","cameras","cameraVR","_currentDepthNear","_currentDepthFar","controller","onSessionEvent","controllerIndex","onSessionEnd","onInputSourcesChange","layerInit","depthFormat","depthType","glDepthFormat","projectionlayerInit","cameraLPos","cameraRPos","setProjectionFromUnion","ipd","projL","projR","topFov","bottomFov","leftFov","rightFov","zOffset","xOffset","near2","far2","left2","right2","top2","bottom2","updateCamera","foveation","onAnimationFrameCallback","views","cameraVRNeedsUpdate","glSubImage","planesToRemove","lastKnownTime","WebGLMaterials","refreshFogUniforms","refreshMaterialUniforms","pixelRatio","transmissionRenderTarget","refreshUniformsCommon","refreshUniformsToon","refreshUniformsPhong","refreshUniformsStandard","refreshUniformsPhysical","refreshUniformsMatcap","refreshUniformsDistance","refreshUniformsLine","refreshUniformsDash","refreshUniformsPoints","refreshUniformsSprites","uvScaleMap","uv2ScaleMap","WebGLUniformsGroups","updateList","allocatedBindingPoints","maxBindingPoints","bind","webglProgram","prepareUniformsGroup","onUniformsGroupsDispose","updateBufferData","bindingPointIndex","allocateBindingPointIndex","hasUniformChanged","arrayOffset","getUniformSize","tempValues","cachedObjects","cachedObject","chunkSize","chunkOffset","infos","remainingSizeInChunk","createCanvasElement","WebGLRenderer","_context","_depth","_stencil","_antialias","_premultipliedAlpha","_preserveDrawingBuffer","_powerPreference","_failIfMajorPerformanceCaveat","_alpha","currentRenderList","currentRenderState","renderListStack","renderStateStack","_this","_isContextLost","_currentActiveCubeFace","_currentActiveMipmapLevel","_currentRenderTarget","_currentMaterialId","_currentCamera","_currentViewport","_currentScissor","_currentScissorTest","_width","_pixelRatio","_opaqueSort","_transparentSort","_scissor","_scissorTest","_clippingEnabled","_localClippingEnabled","_transmissionRenderTarget","_projScreenMatrix","_vector3","_emptyScene","getTargetPixelRatio","getContext","contextNames","contextAttributes","contextName","onContextLost","onContextRestore","onContextCreationError","programCache","renderLists","morphtargets","bufferRenderer","indexedBufferRenderer","uniformsGroups","initGLContext","updateStyle","boolean","method","bits","onXRSessionStart","onXRSessionEnd","infoAutoReset","shadowMapEnabled","shadowMapAutoUpdate","shadowMapNeedsUpdate","shadowMapType","onMaterialDispose","deallocateMaterial","releaseMaterialProgramReferences","setProgram","rangeFactor","drawStart","drawEnd","drawCount","lineWidth","maxInstanceCount","prepare","getProgram","material2","projectObject","camera2","renderScene","sortObjects","opaqueObjects","transmissiveObjects","transparentObjects","renderTransmissionPass","renderObjects","overrideMaterial","lightsStateVersion","programCacheKey","updateCommonMaterialProperties","materialNeedsLights","progUniforms","uniformsList","vertexAlphas","vertexTangents","needsProgramChange","refreshProgram","refreshMaterial","refreshLights","p_uniforms","m_uniforms","uCamPos","skeleton","markUniformsLightsNeedsUpdate","defaultFramebuffer","useDefaultFramebuffer","isRenderTarget3D","__webglFramebuffer","activeCubeFaceIndex","textureFormat","halfFloatSupportedByExt","levelScale","srcTexture","dstTexture","sourceBox","glTarget","unpackRowLen","unpackImageHeight","unpackSkipPixels","unpackSkipRows","unpackSkipImages","WebGL1Renderer","Scene","Clock","autoStart","newTime","Spherical","_changeEvent","_startEvent","_endEvent","OrbitControls","domElement","spherical","onKeyDown","STATE","quat","quatInverse","lastPosition","lastQuaternion","twoPI","rotateLeft","getAutoRotationAngle","sphericalDelta","panOffset","zoomChanged","EPS","onContextMenu","onPointerDown","onPointerCancel","onMouseWheel","onPointerMove","onPointerUp","rotateStart","rotateEnd","rotateDelta","panStart","panEnd","panDelta","dollyStart","dollyEnd","dollyDelta","pointers","pointerPositions","getZoomScale","rotateUp","panLeft","objectMatrix","panUp","pan","deltaX","deltaY","targetDistance","dollyOut","dollyScale","dollyIn","handleMouseDownRotate","handleMouseDownDolly","handleMouseDownPan","handleMouseMoveRotate","handleMouseMoveDolly","handleMouseMovePan","handleMouseWheel","handleKeyDown","handleTouchStartRotate","handleTouchStartPan","handleTouchStartDolly","handleTouchStartDollyPan","handleTouchStartDollyRotate","handleTouchMoveRotate","getSecondPointerPosition","handleTouchMovePan","handleTouchMoveDolly","handleTouchMoveDollyPan","handleTouchMoveDollyRotate","addPointer","onTouchStart","onMouseDown","onTouchMove","onMouseMove","removePointer","mouseAction","trackPointer","pointer","View","THREE.Scene","THREE.PlaneGeometry","THREE.ShaderMaterial","THREE.DoubleSide","THREE.Mesh","THREE.PerspectiveCamera","THREE.WebGLRenderer","THREE.Clock","elapsedTime","mainInstance"],"mappings":"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A;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAEbC,GAAW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAEXC,GAAa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAEbC,GAAW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAEXC,GAAa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAEbC,GAAW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAEXC,GAAa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAEbC,GAAW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAEXC,GAAa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAEbC,GAAW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAEXC,GAAa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAEbC,GAAW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAEXC,GAAa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAEbC,GAAW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAEXC,GAAa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAEbC,GAAW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAEXC,GAAa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAEbC,GAAW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAEXC,GAAa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAEbC,GAAW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,13,14]}
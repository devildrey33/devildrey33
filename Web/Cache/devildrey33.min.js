function RandInt(Max,Min){return Math.floor(Rand(Max,Min));}
function Rand(Max,Min){var min=(typeof(Min)!=="undefined")?Min:0;var max=(typeof(Max)!=="undefined")?Max:1;return min+Math.random()*(max-min);}
function CInt(Decimal){return Math.floor(Decimal);}
$Base=new function(){this.SobreElAutor=null;this.CanvasError404=null;this.Entrada=[];this.Estado_Log=0;this.Ticks_Log=0;this.JSDinamico=[];this.CSSDinamico=[];this.PosPrevNext=-2;this.PosPrevNext_Tipo=0;this.PeticionAjax=0;this.Ancla;this.TemporizadorAncla=0;this.FuncionCargarCSS=function(){};this.FuncionCargarJS=function(){};this.FPL=function(){};this.Raiz="";this.RaizRelativa="";this.PosBanner=0;this.TimerTiempoSesion=0;this.ResetearTimerTiempoSesion=function(){};this.Iniciar=function(){$(".Lab_BotonVerModoCabecera").click(function(e){$Lab.AjustarVista("0");});$(".Lab_BotonVerFilas").click(function(e){$Lab.AjustarVista("1");});$(".Lab_BotonVerColumnas").click(function(e){$Lab.AjustarVista("2");});$(".Lab_BotonVerCodigo").click(function(e){$Lab.AjustarVista("3");});$(".Lab_BotonVerPreview").click(function(e){$Lab.AjustarVista("4");});$Lab.EnlazarEventosExplorador();$("#BarraPrincipal_Boton_Estado").click(this.ClickMenu.bind(this,0));$("#BarraPrincipal_BotonCSS_Estado").click(this.ClickMenu.bind(this,1));$("#BarraPrincipal_BotonCPP_Estado").click(this.ClickMenu.bind(this,2));$("#BarraPrincipal_BotonJS_Estado").click(this.ClickMenu.bind(this,3));$("#BarraPrincipal_BotonPHP_Estado").click(this.ClickMenu.bind(this,4));$("#BarraPrincipal_BotonBuscar_Estado").click(this.ClickMenu.bind(this,5));$("#BarraNavegacion_BotonVer_Estado").click(this.ClickMenu.bind(this,6));$("#BarraNavegacion_BotonExplorar_Estado").click(this.ClickMenu.bind(this,7));$("#BarraNavegacion_Indice_Estado").click(this.ClickMenu.bind(this,9));$("#BarraNavegacion_PrevNext_Estado").click(this.ClickMenu.bind(this,10));$("#BarraNavegacion_RedesSociales_Estado").click(this.ClickMenu.bind(this,11));$("#BarraNavegacion_Votacion_Estado").click(this.ClickMenu.bind(this,12));$("#BarraPrincipal_MarcoBuscar_BotonBuscar").click(this.Buscar.bind(this));$("#BarraPrincipal_MarcoBuscar_Edit").keyup(function(e){if(event.which===13){$Base.Buscar();}});$("#BarraNavegacion_MarcoNextPrev_Prev").click(function(e){$Base.BotonVerSiguiente();});$("#BarraNavegacion_MarcoNextPrev_Desc").click(function(e){$Base.CargarURL($("#BarraNavegacion_MarcoNextPrev_Desc").attr("Path"));});$("#BarraNavegacion_MarcoNextPrev_Next").click(function(e){$Base.BotonVerAnterior();});$("#BarraNavegacion_MarcoRedesSociales_Facebook").click(function(e){$Base.BotonFacebook();});$("#BarraNavegacion_MarcoRedesSociales_Twitter").click(function(e){$Base.BotonTwitter();});$("#BarraNavegacion_MarcoRedesSociales_GooglePlus").click(function(e){$Base.BotonGooglePlus();});this.Entrada=this.IdentificarEntrada(document.location.pathname,document.location.pathname);window.history.replaceState(this.Entrada,this.Entrada["Titulo"],document.location.pathname);$('#BarraNavegacion > a').click(function(e){e.preventDefault();e.stopImmediatePropagation();$Base.CargarURL($(this).attr("href"));return false;});$('#BarraPrincipal > #BarraPrincipal_Submenus a').click(function(e){console.log("Base.(#BarraPrincipal > #BarraPrincipal_Submenus a).Click");e.preventDefault();e.stopImmediatePropagation();$Base.ClickMenu(0);$Base.CargarURL($(this).attr("href"));return false;});$("#Logo > div:nth-child(5)").dblclick(function(e){if($Base.Estado_Log===0){$Base.Ticks_Log=$Base.GetTickCount();$Base.Estado_Log=1;setTimeout(function(){$Base.Estado_Log=0;},1500);}});$("#Logo > div:nth-child(11)").dblclick(function(e){if($Base.Estado_Log===1){console.log("Tiempo de los clicks : "+parseInt($Base.GetTickCount()-$Base.Ticks_Log)+" milisegundos.");$Base.MostrarLogin();}});$("#devildrey33_Usuario").keyup(function(e){switch(e.keyCode){case 27:$Base.MostrarLoginEsc();break;case 13:$("#devildrey33_Password").focus();break;}});$("#devildrey33_Password").keyup(function(e){switch(e.keyCode){case 27:$Base.MostrarLoginEsc();break;case 13:$Base.Loguear();break;}});$("#ErroresPHP_Cerrar").click(function(e){$("#ErroresPHP").attr({"mostrar":false});});this.RedireccionarLinks();if(typeof localStorage["Comentarios_Usuario"]!=='undefined'){$("#devildrey33_Usuario").val(localStorage["Comentarios_Usuario"]);}
window.addEventListener('offline',function(event){$Base.MostrarMensaje("Conexión con el servidor perdida...");});window.addEventListener('online',function(event){$Base.MostrarMensaje("Se ha restablecido la conexión con el servidor.");});};this.MostrarLoginEsc=function(){$("#VentanaLogin").attr({"Visible":"false"});document.getElementById('devildrey33_Password').setAttribute('type','text');};this.MostrarLogin=function(FuncionPostLogin){if(typeof(FuncionPostLogin)!=="undefined")this.FPL=FuncionPostLogin;document.getElementById('devildrey33_Password').setAttribute('type','password');$("#VentanaLogin").attr({"Visible":"true"});setTimeout(function(){if(typeof localStorage["Comentarios_Usuario"]==='undefined'){$("#devildrey33_Usuario").focus();}
else{$("#devildrey33_Password").focus();}},200);};this.Banner=function(Pos){if($Banner!==null){$Banner.Terminar();}
var Banner_Lista=[Banner_Espacio2D,Banner_MatrixLluviaHexadecimal,Banner_AdiestramientoCubos3D,Banner_WormHole,Banner_Sinusoidal,Banner_GeometriaBasica,Banner_ReunionDeCirculos,Banner_HexTunnel,Banner_MultiCubo,Banner_EsferaVShader,Banner_RectangularDimension];var fPos=0;if(typeof(Pos==="undefined")){fPos=RandInt(Banner_Lista.length-1);}
else{fPos=Pos}
if(Pos===-1){fPos=this.PosBanner-1;if(fPos<0){fPos=(Banner_Lista.length)-1;}}
else if(Pos===-2){fPos=this.PosBanner+1;if(fPos>=(Banner_Lista.length)){fPos=0;}}
console.log("Base.Banner(Pos = "+Pos+")",fPos);this.PosBanner=fPos;$Banner=new Banner_Lista[fPos];$Banner.OpcionesCanvas.MostrarFPS=($("#CH_MostrarFPS").attr("marcado")==="true")?true:false;document.getElementById("Cabecera_Stats").style.display=($Banner.OpcionesCanvas.MostrarFPS)?"block":"none";};this.MostrarErroresPHP=function(Texto){console.log("Base.MostrarErroresPHP");if(typeof Texto!=='undefined'){$("#ErroresPHP_Info").html(Texto);}
else{var EFP=$("#ErroresFinPlantilla").html();if(EFP!==""){$("#ErroresFinPlantilla").html("");$("#ErroresPHP_Info").html(EFP);}}
$("#ErroresPHP").attr({"mostrar":true});};this.BotonTwitter=function(){Texto=document.title;console.log("Base.BotonTwitter",Texto,window.location.href);window.open("https://twitter.com/home?status="+Texto+": "+window.location.href,"Twitter","toolbar=no,width=550,height=255");};this.BotonFacebook=function(){Texto=document.title;console.log("Base.BotonFacebook",Texto,window.location.href);window.open("https://www.facebook.com/share.php?u="+window.location.href+"&t="+Texto,"Facebook","toolbar=no,width=550,height=355");};this.BotonGooglePlus=function(){Texto=document.title;console.log("Base.BotonGooglePlus",Texto,window.location.href);window.open("https://plus.google.com/share?url="+window.location.href+"&t="+Texto,"Google Plus","toolbar=no,width=550,height=355");};this.BotonLinkEdin=function(){Texto=document.title;console.log("Base.BotonLinkEdin",Texto,window.location.href);};this.Debug=(function(){var Consola=console;return function(Valor,Limpiar){var nLimpiar=Limpiar||false;if(Valor===false){console={};console.log=function(){};if(nLimpiar){console.info=function(){};console.warn=function(){};console.error=function(){};}else{console.info=Consola.info;console.warn=Consola.warn;console.error=Consola.error;}}
else{console=Consola;}};})();this.ClickMenu=function(Menu){console.log("Base.ClickMenu",Menu);if(Menu!==1){$("#BarraPrincipal_BotonCSS_Estado").prop("checked",false);}
if(Menu!==2){$("#BarraPrincipal_BotonCPP_Estado").prop("checked",false);}
if(Menu!==3){$("#BarraPrincipal_BotonJS_Estado").prop("checked",false);}
if(Menu!==4){$("#BarraPrincipal_BotonPHP_Estado").prop("checked",false);}
if(Menu!==5){$("#BarraPrincipal_BotonBuscar_Estado").prop("checked",false);}
if(Menu===5){$("#BarraPrincipal_MarcoBuscar_Edit").focus().select();}
if(Menu!==6){$("#BarraNavegacion_BotonVer_Estado").prop("checked",false);}
if(Menu!==7){$("#BarraNavegacion_BotonExplorar_Estado").prop("checked",false);}
if(Menu===7){setTimeout(function(){$Lab.ResaltarArchivoActual($("#MarcoNavegacion > article").attr("pagina"),true);},400);}
if(Menu!==8){$("#BarraPrincipal_Boton33_Estado").prop("checked",false);}
if(Menu===8){$("#BarraPrincipal_Boton_Estado").prop("checked",false);}
if(Menu!==9){$("#BarraNavegacion_Indice_Estado").prop("checked",false);}
if(Menu!==10){$("#BarraNavegacion_PrevNext_Estado").prop("checked",false);}
if(Menu!==11){$("#BarraNavegacion_RedesSociales_Estado").prop("checked",false);}
if(Menu!==12){$("#BarraNavegacion_Votacion_Estado").prop("checked",false);}};this.GetTickCount=function(){var d=new Date();return d.getTime();};this.RedireccionarLinks=function(){console.log("Base.RedireccionarLinks");$("#MarcoNavegacion a[href]:not([target])").off("click").on("click",function(e){e.preventDefault();e.stopImmediatePropagation();$Base.CargarURL($(this).attr("href"));return false;});Pagina=$("#MarcoNavegacion > article").attr("pagina");$("#BarraNavegacion_Votacion").removeAttr("Mostrar");this.ComprobarScrollVotacion();$PintarCodigo.EnlazarEtiquetas();this.ActualizarBarraNavegacion();$Lab.MiniLab_Iniciar();this.LogoCargando("FALSE");};this.JSON_Parse=function(Datos){try{return JSON.parse(Datos);}
catch(e){$Base.MostrarErroresPHP(Datos);$Base.MostrarMensaje(e,"ErrorJSON");return false;}}
this.VotarWeb=function(Valor){Pagina=$("#MarcoNavegacion > article").attr("pagina");$("#BarraNavegacion_Votacion_Estado").removeAttr("checked");console.log("Base.VotarWeb",Valor,Pagina);if(typeof localStorage["Voto_"+Pagina]==="undefined"){localStorage["Voto_"+Pagina]=Valor;$.post(this.Raiz+"cmd/VotarPagina.cmd",{"Pagina":Pagina,"Valor":Valor,"URL":window.location.href}).done(function(data){Datos=$Base.JSON_Parse(data);if(Datos===false)return;if(Datos["HTML"]!=="false"){$(".Cabecera_Datos > .FechaEntrada > span").html(Datos["HTML"]);$("#BarraNavegacion_Votacion").removeAttr("Mostrar");if($("html").attr("lang")==="es"){$Base.MostrarMensaje("La votación se ha realizado correctamente, muchas gracias!");}
else{$Base.MostrarMensaje("Your vote is annotated, thank you!");}}
$("#ErroresPHP_Info").html(Datos["ErroresPHP"]);if(Datos["ErroresPHP"]!==""){$Base.MostrarErroresPHP();}}).fail(function(jqXHR,textStatus,tError){console.log("Base.VotarWeb Error ajax",jqXHR,textStatus,tError);$Base.MostrarErrorAjax(jqXHR.status,false,tError);});}
else{if($("html").attr("lang")==="es"){$Base.MostrarMensaje("Solo puedes votar una vez por página.");}
else{$Base.MostrarMensaje("Only you can vote one time per page.");}}};this.MostrarMensaje=function(Mensaje,Titulo,Alerta,Funcion){console.log("Base.MostrarMensaje("+Mensaje+")");if(typeof(Alerta)==="undefined"){Alerta="false";}
else{if(typeof(Titulo)==="undefined"){Titulo="Mensaje de alerta";}}
if(typeof(Titulo)==="undefined"){Titulo="Mensaje";}
if(typeof(Funcion)==="undefined"){Funcion=function(){};}
Ventana=$("<div class='VentanaMensaje MarcoVentana-350' visible='false' alerta='"+Alerta+"' titulo='"+Titulo+"'>"+"<p>"+Mensaje+"</p>"+"<div class='Centrado'>"+"<button class='BotonVentana'>Aceptar</button>"+"</div>"+"</div>");Ventana.find(".Centrado > button").on("click",{"Funcion":Funcion},function(event){$(this).parent().parent().attr({"visible":"false"});event.data.Funcion();setTimeout(function(Ventana){Ventana.remove();},500,$(this).parent().parent());});Ventana.appendTo('body').attr({"visible":"false"});setTimeout(function(Ventana){Ventana.attr({"visible":"true"}).find("button").focus();},100,Ventana);};this.MostrarErrorAjax=function(Error,VolverIndice,Excepcion){console.log("Base.MostrarErrorAjax("+Error+", "+VolverIndice+")");this.LogoCargando("FALSE");this.Cargando("FALSE");switch(Error){case 403:Mensaje="Error 403 en la petición ajax.<br />No se permite el acceso al archivo solicitado.";break;case 404:Mensaje="Error 404 en la petición ajax.<br />El archivo solicitado no existe.";break;case 1404:Mensaje="Error 404 en la petición ajax.<br />No se puede cargar el ejemplo del lab.";break;default:Mensaje="Error 500 en la petición ajax.<br />Es posible que el servidor no esté disponible en estos momentos. ("+Excepcion+")";break;}
Funcion=function(){};if(VolverIndice===true){this.Entrada["TipoPagina"]="Error404";Mensaje=Mensaje+" Pulsa aceptar para ser re-dirigido al indice.";Funcion=function(){$Base.CargarURL("/");};}
this.MostrarMensaje(Mensaje,"true",Funcion);};this.IdentificarEntrada=function(iURL,URLReal){var Ret={"Titulo":"devildrey33","URL":iURL,"URLReal":URLReal,"Imagen":"","TipoPagina":"Desconocido","Pos":-2,"Idioma":"es"};if(URLReal.indexOf("Categorias/")>-1||iURL==="/"+this.RaizRelativa||iURL===this.Raiz){Ret["TipoPagina"]="Indice";$("body").attr({"Tipo":Ret["TipoPagina"]});console.log("Base.IdentificarEntrada : "+Ret["TipoPagina"],Ret);return Ret;}
nURL="";cURL=iURL.toLowerCase();if(cURL.indexOf("blog/")>-1){Ret["TipoPagina"]="Blog";nURL=iURL.substr(6);}
if(cURL.indexOf("doc/css")>-1||cURL.indexOf("documentacion/css")>-1){Ret["TipoPagina"]="DocCSS";nURL=iURL.substr(8);}
if(cURL.indexOf("lab/")>-1){Ret["TipoPagina"]="Lab";nURL="";}
if(cURL.indexOf("web/")>-1||cURL.indexOf("sobre-el-autor")>-1||cURL.indexOf("faqbarba")>-1){Ret["TipoPagina"]="Simple";nURL="";}
if(document.getElementById('Error404')!==null){Ret["TipoPagina"]="Error404";nURL="";}
$("body").attr({"Tipo":Ret["TipoPagina"]});var p=this.BuscarEntrada(iURL);if(p!==-1){Ret["Titulo"]=EntradasBlog[p]["Titulo"];}
this.RenovarMeta();console.log("Base.IdentificarEntrada : "+Ret["TipoPagina"],Ret);return Ret;};this.BuscarEntrada=function(nURL){for(i=0;i<EntradasBlog.length;i++){if(nURL.indexOf(EntradasBlog[i]["URL"])!==-1){return i;}}
return-1;};this.BuscarEntradaActual=function(nURL,nTitulo){for(i=0;i<EntradasBlog.length;i++){if(EntradasBlog[i]["Titulo"]===nTitulo){if(nURL.indexOf(EntradasBlog[i]["URL"])!==-1){console.log("Base.BuscarEntradaActual : "+i,EntradasBlog[i]);this.Entrada["Titulo"]=EntradasBlog[i]["Titulo"];this.Entrada["Imagen"]=EntradasBlog[i]["Imagen"];this.Entrada["Idioma"]=EntradasBlog[i]["Idioma"];this.PosPrevNext_Tipo=EntradasBlog[i]["Tipo"];return i;}}}
console.log("Base.BuscarEntradaActual : -1");return-1;};this.ActualizarBarraNavegacion=function(){console.log("Base.ActualizarBarraNavegacion",this.Entrada);this.EscanearAnclas();switch(this.Entrada["TipoPagina"]){case"Lab":$Lab.Iniciar();this.MostrarBarraNavegacion();break;case"Indice":$("#MarcoIndice").attr({"visible":true});$("#Categorias").attr({"visible":true});$Indice.Iniciar();this.OcultarBarraNavegacion();break;case"Blog":case"DocCSS":this.Banner();$Comentarios.Iniciar();this.MostrarBarraNavegacion();break;case"Buscar":$("#BarraNavegacion_Prev").hide();$("#BarraNavegacion_Next").hide();break;case"Simple":default:this.MostrarBarraNavegacion(true);break;}};this.CrearPrevNext=function(Pos){console.log("Base.CrearPrevNext",Pos);if(Pos>EntradasBlog.length||Pos<0)return false;$("#BarraNavegacion_MarcoNextPrev_Next").removeAttr("disabled");$("#BarraNavegacion_MarcoNextPrev_Prev").removeAttr("disabled");this.PosPrevNext=Pos;if(this.Entradas_BuscarSiguienteMismoTipo(Pos)===-1){$("#BarraNavegacion_MarcoNextPrev_Next").attr({"disabled":"disabled"});}
if(this.Entradas_BuscarAnteriorMismoTipo(Pos)===-1){$("#BarraNavegacion_MarcoNextPrev_Prev").attr({"disabled":"disabled"});}
Imagen="CSS3.png";if(EntradasBlog[this.PosPrevNext]["Tipo"].indexOf("DocCSS")===-1){Imagen=EntradasBlog[this.PosPrevNext]["Imagen"];}
$("#BarraNavegacion_MarcoNextPrev_Desc").html("<img src='"+this.Raiz+"Web/Graficos/155x125_"+Imagen+"' alt=''/>"+"<h3>"+EntradasBlog[this.PosPrevNext]["Titulo"]+"</h3>");$("#BarraNavegacion_MarcoNextPrev_Desc").attr({"Path":EntradasBlog[this.PosPrevNext]["URL"]});return true;};this.BotonVerSiguiente=function(){if(this.CrearPrevNext(this.Entradas_BuscarAnteriorMismoTipo(this.PosPrevNext))===false){$("#BarraNavegacion_MarcoNextPrev_Next").attr({"disabled":"disabled"});}};this.BotonVerAnterior=function(){if(this.CrearPrevNext(this.Entradas_BuscarSiguienteMismoTipo(this.PosPrevNext))===false){$("#BarraNavegacion_MarcoNextPrev_Next").attr({"disabled":"disabled"});}};this.Entradas_BuscarSiguienteMismoTipo=function(Cont){while(--Cont>-1){if(this.PosPrevNext_Tipo===EntradasBlog[Cont]["Tipo"]){if(Cont!==this.Entrada["Pos"]){return Cont;}}}
return-1;}
this.Entradas_BuscarAnteriorMismoTipo=function(Cont){while(++Cont<EntradasBlog.length-1){if(this.PosPrevNext_Tipo===EntradasBlog[Cont]["Tipo"]){if(Cont!==this.Entrada["Pos"]){return Cont;}}}
return-1;}
this.MostrarBarraNavegacion=function(nSimple){var Simple=(typeof nSimple==='undefined')?false:true;console.log("Base.MostrarBarraNavegacion(Simple)",Simple);$("#BarraNavegacion_RedesSociales").attr('mostrar',!Simple);$("html").attr({"lang":this.Entrada["Idioma"]});$("#BarraNavegacion").attr({"Visible":true});if(Simple===false){this.Entrada["Pos"]=this.BuscarEntradaActual(this.Entrada["URL"],$("#Cabecera > .Cabecera_Datos > h1").html());this.PosPrevNext=this.Entradas_BuscarSiguienteMismoTipo(this.Entrada["Pos"]);if(this.PosPrevNext==-1){this.PosPrevNext=this.Entradas_BuscarAnteriorMismoTipo(this.Entrada["Pos"]);}
$("#BarraNavegacion_NextPrev").attr({"mostrar":(this.Entrada["Pos"]!==-1)?"true":"false"});this.CrearPrevNext(this.PosPrevNext);}
else{$("#BarraNavegacion_NextPrev").attr({"mostrar":"false"});}};this.OcultarBarraNavegacion=function(){$("#BarraNavegacion").attr({"Visible":false});};this.BuscarAncla=function(Pos){this.Ancla=$("#MarcoNavegacion h2").eq(Pos);var PosAncla=this.Ancla.offset().top;var PosScroll=$(document).scrollTop();var AltoVentana=$(window).height();console.log("Base.BuscarAncla("+Pos+")",PosAncla,AltoVentana,PosScroll);if(!(PosAncla>PosScroll-AltoVentana&&PosAncla<PosScroll+AltoVentana)){$("body, html").stop().animate({scrollTop:PosAncla-25});}
this.Ancla.attr({"resaltado":"true"});if(this.TemporizadorAncla!==0){clearTimeout(this.TemporizadorAncla);}
this.TemporizadorAncla=setTimeout(function(){$Base.Ancla.removeAttr("resaltado");$Base.TemporizadorAncla=0;},1000);};this.EscanearAnclas=function(){console.log("Base.EscanearAnclas");var Codigo="";var ContadorAnclas=0;$("#MarcoNavegacion h2").each(function(index){var Texto=$(this).html();if(Texto===""){Texto=window.getComputedStyle(this,':after').getPropertyValue('content');Texto=Texto.replace('"','').replace('"','');}
Codigo=Codigo+"<div onclick='$Base.BuscarAncla("+(ContadorAnclas++)+")' title='"+Texto+"'>"+Texto+"</div>";});var Columnas=0;while(ContadorAnclas>0){ContadorAnclas-=12;Columnas++;}
$("#BarraNavegacion_SubIndice").attr({"class":"Menu_Marco SubIndice_Columas_"+Columnas});if(Codigo!==""){$("#BarraNavegacion_Indice").show();$("#BarraNavegacion_SubIndice").html(Codigo);}
else{$("#BarraNavegacion_Indice").hide();}};this.LogoCargando=function(Valor){this.Cargando(Valor);if(Valor==="TRUE"){if(this.PeticionAjax!==0){this.PeticionAjax.abort();}
$(".VentanaMensaje").attr("Visible",false).each(function(){setTimeout(function(Ventana){Ventana.remove();},500,$(this));});$("#MarcoIndice").attr({"Visible":false});$("#Categorias").attr({"Visible":false});document.getElementById("Logo").className="AnimarLogo SinSeleccion";this.OcultarBarraNavegacion();}
else{this.PeticionAjax=0;document.getElementById("Logo").className="SinSeleccion";$("#MarcoIndice").attr({"Visible":true});$("#Categorias").attr({"Visible":true});}};this.Cargando=function(Valor){if(Valor==="TRUE"||Valor===true){$("#BarraNavegacion_Inferior").attr({"mostrar":true});}
else{$("#BarraNavegacion_Inferior").removeAttr("mostrar");}};this.Buscar=function(){if($("#BarraPrincipal_MarcoBuscar_Edit").val()===""){$("#BarraPrincipal_MarcoBuscar_Edit").focus();this.MostrarMensaje("Debes especificar una o mas palabras a buscar.")
return;}
console.log("Base.Buscar "+$("#BarraPrincipal_MarcoBuscar_Edit").val());this.Cargando("TRUE");$.post(this.Raiz+"cmd/Buscar",{"Palabras":$("#BarraPrincipal_MarcoBuscar_Edit").val()}).done(function(data){Datos=$Base.JSON_Parse(data);if(Datos===false)return;$("#BarraPrincipal_MarcoBuscar_Resultado").html(Datos["HTML"]);$("#ErroresPHP_Info").html(Datos["ErroresPHP"]);if(Datos["ErroresPHP"]!==""){$Base.MostrarErroresPHP();}
$Base.Cargando("FALSE");$("#BarraPrincipal_MarcoBuscar a[href]:not([target])").off("click").on("click",function(e){e.preventDefault();e.stopImmediatePropagation();$Base.CargarURL($(this).attr("href"));$Base.ClickMenu(0);return false;});}).fail(function(jqXHR,textStatus,tError){console.log("Base.Buscar Error ajax",jqXHR,textStatus,tError);$Base.MostrarErrorAjax(jqXHR.status,false,tError);});};this.TerminarCanvas=function(){if($Banner!==null){$Banner.Terminar();$Banner=null;}
if(this.SobreElAutor!==null){this.SobreElAutor.Terminar();this.SobreElAutor=null;}
if(this.CanvasError404!==null){this.CanvasError404.Terminar();this.CanvasError404=null;}},this.CargarURL=function(cURL){this.ResetearTimerTiempoSesion();if($Lab.Modificado()===true){setTimeout(function(nURL){$Base.CargarURL(nURL);},200,cURL);return;}
$("#BarraNavegacion > .Menu > input[type=checkbox]").removeAttr("checked");this.LogoCargando("TRUE");if(cURL.indexOf("/")===-1){Path=window.location.href.split('/');Path.pop();Path=Path.join('/');cURL=Path+"/"+cURL;nURL=Path+"/"+cURL;}
if(cURL==="/"+this.Raiz)nURL="/"+this.RaizRelativa+"index.php";else nURL=cURL;if(cURL.charAt(0)==='/'){nURL="/"+this.RaizRelativa+cURL.substr(1);cURL=nURL;}
console.log("Base.CargarURL "+nURL);this.cURL=cURL;this.nURL=nURL;this.PeticionAjax=$.post(nURL,{"Regenerar":"todo","Categoria":"Todo","SinPlantilla":"true"}).done(function(data){Datos=$Base.JSON_Parse(data);if(Datos===false)return;if(Datos["HTML"].indexOf("<script>$Base.MostrarErrorAjax(404, false);</script>")===0){$Base.MostrarErrorAjax(404,false,'No se ha encontrado');}
else{$Base.TerminarCanvas();$("#MarcoNavegacion").html(Datos["HTML"]);$Base.Entrada=$Base.IdentificarEntrada($Base.cURL,$Base.nURL);window.history.pushState($Base.Entrada,document.title,$Base.cURL);$(window).scrollTop(0);if($Base.Entrada["TipoPagina"]!=="Lab"){document.title=$Base.Entrada["Titulo"];}
$Base.RedireccionarLinks();$("#ErroresPHP_Info").html(Datos["ErroresPHP"]);if(Datos["ErroresPHP"]!==""){$Base.MostrarErroresPHP();}}}).fail(function(jqXHR,textStatus,tError){console.log("Base.CargarURL Error ajax",jqXHR,textStatus,tError);$Base.MostrarErrorAjax(jqXHR.status,false,tError);});$("#VentanaError").attr({"visible":"false"});};this.RenovarMeta=function(){var p=$(".Blog").attr('pagina')||$("#MarcoNavegacionLab").attr('pagina');for(var i=0;i<EntradasBlog.length;i++){if(EntradasBlog[i].URL===p||EntradasBlog[i].URL+".php"===p){$("meta[name='twitter:title']").attr({"content":EntradasBlog[i].Titulo});$("meta[name='twitter:image']").attr({"content":$Base.Raiz+"Web/Graficos/250x200_"+EntradasBlog[i].Imagen});$("meta[property='og:title']").attr({"content":EntradasBlog[i].Titulo});$("meta[property='og:image']").attr({"content":$Base.Raiz+"Web/Graficos/250x200_"+EntradasBlog[i].Imagen});var URL=$Base.Raiz+EntradasBlog[i].URL;if(EntradasBlog[i]["Tipo"]==="Blog"){URL=$Base.Raiz+"Blog/"+EntradasBlog[i].URL;}
else if(EntradasBlog[i]["Tipo"]==="Lab"){URL=$Base.Raiz+"Lab/"+EntradasBlog[i].URL;}
$("meta[property='og:url']").attr({"content":URL});return;}}
$("meta[name='twitter:title']").attr({"content":"devildrey33.es"});$("meta[name='twitter:image']").attr({"content":"https://devildrey33.es/Web/Graficos/logo400.png"});$("meta[property='og:title']").attr({"content":"devildrey33.es"});$("meta[property='og:image']").attr({"content":"https://devildrey33.es/Web/Graficos/logo400.png"});$("meta[property='og:url']").attr({"content":"https://devildrey33.es"});},this.Loguear=function(){var l=$("#devildrey33_Usuario").val();var p=$("#devildrey33_Password").val().split("").reverse().join("");var v;var r=parseInt(Math.random()*(9+1));var pass=r.toString();for(var i=0;i<p.length;i++){v=p.charCodeAt(i)+r;if(v>255)v-=255;rv=v.toString();if(v<10)rv="00"+rv;if(v<100&&v>10)rv="0"+rv;pass=pass+rv;}
console.log("Base.Loguear("+pass+")");this.Cargando("TRUE");$.post($Base.Raiz+"cmd/Loguear.cmd",{"l":l,"p":pass}).done(function(data,textStatus,jqXHR){Datos=$Base.JSON_Parse(data);if(Datos===false)return;if(Datos.Estado===0){localStorage["Comentarios_Usuario"]=$("#devildrey33_Usuario").val();$("#VentanaLogin").attr({visible:false});$("#Marco33").html(Datos.HTMLAdmin);$Base.CargarJS("devildrey33.admin.min.js",function(){$Admin.Iniciar();},true);$("#BarraNavegacion_Explorador").html(Datos.ExplorarLab);$Lab.EnlazarEventosExplorador();$Base.FPL();}
else{if(Datos.Estado===1){$("#VentanaLogin").removeClass("VentanaError_AnimacionError");setTimeout(function(){$("#VentanaLogin").addClass("VentanaError_AnimacionError");},50);}
else if(Datos.Estado===2){$Base.MostrarMensaje("Error interno del servidor...","Error grave","true");}
$Base.Cargando("FALSE");}
$("#ErroresPHP_Info").html(Datos["ErroresPHP"]);if(Datos["ErroresPHP"]!==""){$Base.MostrarErroresPHP();}
$Base.FPL=function(){};}).fail(function(jqXHR,textStatus,tError){console.log("Base.Loguear Error ajax",jqXHR,textStatus,tError);$Base.MostrarErrorAjax(jqXHR.status,false,tError);$Base.FPL=function(){};});};this.cmd=function(Comando){this.Cargando("TRUE");this.ResetearTimerTiempoSesion();$.post(this.Raiz+"cmd/"+Comando+".cmd").done(function(data){Datos=$Base.JSON_Parse(data);if(Datos===false)return;console.log("Base.cmd("+Comando+")",Datos);$("#ErroresPHP_Info").html(Datos["ErroresPHP"]);if(Datos["ErroresPHP"]!==""){$Base.MostrarErroresPHP();}
if(Datos["Estado"]===0&&"Mensaje"in Datos){if(Datos["Mensaje"]!==""){$Base.MostrarMensaje(Datos["Mensaje"]);}}
if(Datos["Estado"]===1){$("#BarraNavegacion_Explorador").html(Datos["HTML"]);$Lab.EnlazarEventosExplorador();$('body').attr({'administrador33':false});$Base.ClickMenu(0);setTimeout(function(){$('#Marco33').html('');},500);$Base.MostrarMensaje("Error!, no eres administrador.");}
$Base.Cargando("FALSE");}).fail(function(jqXHR,textStatus,tError){console.log("Base.cmd Error ajax",jqXHR,textStatus,tError);$Base.MostrarErrorAjax(jqXHR.status,false,tError);this.Cargando("FALSE");});};this.CargarJS=function(Nombre,Funcion,Cache){if(typeof(Funcion)!=="undefined"){this.FuncionCargarJS=Funcion;}
else{this.FuncionCargarJS=function(){};}
if(typeof(Cache)==="undefined"){Cache=false;}
for(var i=0;i<this.JSDinamico.length;i++){if(this.JSDinamico[i]===Nombre){console.log("Base.CargarJS("+Nombre+") ya se había cargado...");this.FuncionCargarJS();return;}}
$.getScript("/"+this.RaizRelativa+((Cache===false)?"Web/JS/":"Web/Cache/")+Nombre,function(data,textStatus,jqxhr){console.log("Base.CargarJS("+Nombre+")");$Base.FuncionCargarJS();}).fail(function(jqxhr,settings,exception){console.log("Base.CargarJS Error Ajax",jqxhr,settings,exception);$Base.MostrarErrorAjax(jqxhr.status,false,exception);});};this.CargarCSS=function(Nombre,Cache){if(typeof(Cache)==="undefined"){Cache=false;}
for(var i=0;i<this.CSSDinamico.length;i++){if(this.CSSDinamico[i]===Nombre){console.log("Base.CargarCSS("+Nombre+") ya se había cargado...");return;}}
this.CSSDinamico.push(Nombre);var Script=document.createElement("link");Script.setAttribute("rel","stylesheet");Script.setAttribute("type","text/css");Script.setAttribute("href","/"+this.RaizRelativa+((Cache===false)?"Web/CSS/":"Web/Cache/")+Nombre);if(typeof Script!=="undefined")document.getElementsByTagName("head")[0].appendChild(Script);console.log("Base.CargarCSS("+Nombre+")");};this.CALLBACK_Histroial=function(event){this.ResetearTimerTiempoSesion();if($Lab.Modificado()===true){setTimeout(function(nURL){$Base.CALLBACK_Histroial(event);},200,event);return;}
this.LogoCargando("TRUE");console.log("Base.CALLBACK_Histroial",event.state);if(event.state){cURL=event.state["URL"];}
else{cURL=window.location.href;}
cURL.replace("..","");if(cURL.indexOf("/")===-1){Path=window.location.href.split('/');Path.pop();Path=Path.join('/');cURL=Path+"/"+cURL;nURL=Path+"/"+cURL;}
if(cURL==="/")nURL="/index.php";else nURL=cURL;this.PeticionAjax=$.post(nURL,{"Regenerar":"todo","Categoria":"Todo","SinPlantilla":"true"}).done(function(data){Datos=$Base.JSON_Parse(data);if(Datos===false)return;if(Datos["HTML"].indexOf("<script>$Base.MostrarErrorAjax(404, false);</script>")===0){$Base.MostrarErrorAjax(404,"false");}
else{$Base.TerminarCanvas();$("#MarcoNavegacion").html(Datos["HTML"]);$Base.Entrada=$Base.IdentificarEntrada(cURL,nURL);$Base.RedireccionarLinks();document.title=$Base.Entrada["Titulo"];}
$("#ErroresPHP_Info").html(Datos["ErroresPHP"]);if(Datos["ErroresPHP"]!==""){$Base.MostrarErroresPHP();}}).fail(function(jqXHR,textStatus,tError){console.log("Base.CALLBACK_Histroial Error ajax",jqXHR,textStatus,tError);$Base.MostrarErrorAjax(jqXHR.status,false,tError);});$("#VentanaError").attr({"visible":"false"});};this.ErrorJS=function(e){var ErrorStr="%cTipo     : %c"+e.type+"\n%cError    : %c"+e.error+"\n%cArchivo  : %c"+e.filename.substring(e.filename.lastIndexOf('/')+1)+"\n%cPath     : %c"+e.filename+":"+e.lineno+"\n%cLínea    : %c"+e.lineno+"\n%cCaracter : %c"+e.colno+"\n%cFecha    : %c"+new Date();console.log(ErrorStr,"font-weight: bold;","color: #e74c3c;","font-weight: bold;","font-weight: normal; color: #e74c3c;","font-weight: bold;","font-weight: normal;","font-weight: bold;","font-weight: normal; color: #3498db;","font-weight: bold;","font-weight: normal;","font-weight: bold;","font-weight: normal;","font-weight: bold;","font-weight: normal;");};this.ComprobarScrollVotacion=function(){if(typeof localStorage["Voto_"+$("#MarcoNavegacion > article").attr("pagina")]==="undefined"){if(typeof($("#Comentarios_Datos").offset())!=="undefined"){FinalPagina=$("#Comentarios_Datos").offset().top;}
else{FinalPagina=$(document).height();}
if($(window).scrollTop()>FinalPagina-($(window).height()*2)){console.log("Base.ComprobarScrollVotacion");Pagina=$("#MarcoNavegacion > article").attr("pagina");if(typeof localStorage["Voto_"+Pagina]==="undefined"){$("#BarraNavegacion_Votacion").attr({"mostrar":"true"});$("#BarraNavegacion_Votacion .VotarDocumento_Estrellas > button").off("click").on("click",function(e){$Base.VotarWeb($(this).html());});}}}};};Date.prototype.toDateInputValue=(function(){var local=new Date(this);local.setMinutes(this.getMinutes()-this.getTimezoneOffset());return local.toJSON().slice(0,10);});window.addEventListener('popstate',function(event){$Base.CALLBACK_Histroial(event);},false);window.addEventListener('error',function(e){$Base.ErrorJS(e);});$(window).on("load",function(){$Base.Iniciar();});$(window).on("scroll",function(){$Base.ComprobarScrollVotacion();});var $Banner=null;
$Indice=new function(){this.Cargando=false;this.TotalArticulosCargados=0;this.Iniciar=function(){console.log("Indice.Iniciar");$("#Categorias > div > div").off("click").on("click",function(e){$Base.CargarURL($(this).attr("path"));});};this.ComprobarScroll=function(){if($("#MarcoIndice > div[finscrollinfinito]").length===0&&this.Cargando===false&&$("#MarcoIndice").length!==0){if($(window).scrollTop()>($(document).height()-($(window).height()*2))){console.log("Indice.ComprobarScroll",$("#MarcoIndice > div[finscrollinfinito]").length);this.Cargando=true;$Base.Cargando("TRUE");this.TotalArticulosCargados=$("#MarcoIndice > .Articulo_Portada").length;nAjax=$.post($Base.Raiz+"cmd/IndiceObtener15Mas.cmd",{"Categoria":$("#Categorias").attr("categoria"),"Inicio":this.TotalArticulosCargados});nAjax.done(function(data){Datos=$Base.JSON_Parse(data);if(Datos===false)return;$("div[puntoscroll=true]").removeAttr("puntoscroll");$("#MarcoIndice").html($("#MarcoIndice").html()+Datos["HTML"]);$Base.Cargando("FALSE");$Indice.Cargando=false;$("#ErroresPHP_Info").html(Datos["ErroresPHP"]);if(Datos["ErroresPHP"]!==""){$Base.MostrarErroresPHP();}});nAjax.fail(function(jqXHR,textStatus,tError){console.log("Indice.ComprobarScroll Error ajax",jqXHR,textStatus,tError);$Indice.Cargando=false;$Base.MostrarMensaje("Error cargando los 10 siguientes articulos");$Base.Cargando("FALSE");});}}};};$(window).scroll(function(){$Indice.ComprobarScroll();});
$Comentarios=new function(){this.NumComentario=0;this.Obteniendo=false;this.MostrarComentarioTimer=0;this.Enviando=false;this.Iniciar=function(){console.log("Comentarios.Iniciar");$("#Comentarios_Datos span[comentario]").off("click").on("click",function(){$Comentarios.MostrarComentario($(this).attr("comentario"));});$("#Comentarios_Comentario").on('blur keyup paste copy cut mouseup',function(){$Comentarios.AsignarEstadosBotones();});$('#Comentarios_Comentario').on('paste',function(e){e.preventDefault();var Ret=$("<div></div>").append((e.originalEvent||e).clipboardData.getData('text/html'));Ret.find('*').each(function(){if($(this).get(0).tagName==='SCRIPT'||$(this).get(0).tagName==='BUTTON'){$(this).remove();}
if($(this).get(0).tagName==='A'){$(this).attr({"target":"_blank"})}});$Comentarios.ComandoEdicion("insertHTML",Ret.html());});$("#Comentarios_BarraControles > .BotonEdicion:nth-child(1)").off("click").on("click",function(){$Comentarios.ComandoEdicion("bold");});$("#Comentarios_BarraControles > .BotonEdicion:nth-child(2)").off("click").on("click",function(){$Comentarios.ComandoEdicion("underline");});$("#Comentarios_BarraControles > .BotonEdicion:nth-child(3)").off("click").on("click",function(){$Comentarios.ComandoEdicion("italic");});$("#Comentarios_BarraControles > .BotonEdicion:nth-child(4)").off("click").on("click",function(){$Comentarios.ComandoEdicion("strikethrough");});$("#Comentarios_BarraControles > .BotonEdicion:nth-child(5)").off("click").on("click",function(){$Comentarios.ComandoEdicion("undo");});$("#Comentarios_BarraControles > .BotonEdicion:nth-child(6)").off("click").on("click",function(){$Comentarios.ComandoEdicion("redo");});$("#Comentarios_BarraControles > .BotonEdicion:nth-child(7)").off("click").on("click",function(){$Comentarios.ComandoEdicion("insertunorderedlist");});$("#Comentarios_BarraControles > .BotonEdicion:nth-child(8)").off("click").on("click",function(){$Comentarios.ComandoEdicion("insertorderedlist");});$("#Comentarios_BarraControles > .BotonEdicion:nth-child(9)").off("click").on("click",function(){$Comentarios.ComandoEdicion("removeFormat");});$("#Comentarios_BarraControles > .BotonEdicion:nth-child(10)").off("click").on("click",function(){$Comentarios.ComandoEdicion("justifyLeft");});$("#Comentarios_BarraControles > .BotonEdicion:nth-child(11)").off("click").on("click",function(){$Comentarios.ComandoEdicion("justifyCenter");});$("#Comentarios_BarraControles > .BotonEdicion:nth-child(12)").off("click").on("click",function(){$Comentarios.ComandoEdicion("justifyRight");});$("#Comentarios > .Centrado > button").off("click").on("click",function(){$Comentarios.BotonEnviarComentario();});$("#Comentarios_Datos > div[comentario]").off("click").on("click",function(evento){$Comentarios.SeleccionarComentario($(this));});if(typeof localStorage["Comentarios_Usuario"]!=="undefined"){$("#Comentarios_Nombre").val(localStorage["Comentarios_Usuario"]);}
if(typeof localStorage["Comentarios_Correo"]!=="undefined"){$("#Comentarios_Correo").val(localStorage["Comentarios_Correo"]);}
if(typeof localStorage["Comentarios_Web"]!=="undefined"){$("#Comentarios_Web").val(localStorage["Comentarios_Web"]);}
this.EnlazarBotonesMensajes();$("#Comentarios_Comentario").html("");this.Obteniendo=false;if($("html").attr("lang")==="es"){$("#Comentarios > #Comentarios_Comentario + button").html("Enviar comentario");}
else{$("#Comentarios > #Comentarios_Comentario + button").html("Send comment");}};this.EnlazarBotonesMensajes=function(){$("div[comentario] > .Comentarios_ControlesMensaje > button:nth-child(1)").off("click").on("click",function(evento){$Comentarios.BotonResponder(this);});$("div[comentario] > .Comentarios_ControlesMensaje > button:nth-child(2)").off("click").on("click",function(evento){$Comentarios.VotarComentario(this,1);});$("div[comentario] > .Comentarios_ControlesMensaje > button:nth-child(3)").off("click").on("click",function(evento){$Comentarios.VotarComentario(this,0);});$("div[comentario] > .Comentarios_ControlesMensaje > button:nth-child(4)").off("click").on("click",function(evento){$Admin.Comentarios.BotonEditarComentario(this);});$("div[comentario] > .Comentarios_ControlesMensaje > button:nth-child(5)").off("click").on("click",function(evento){$Admin.Comentarios.BotonEliminarComentario(this);});$("div[comentario] > .Comentarios_ControlesMensaje > button:nth-child(6)").off("click").on("click",function(evento){$Admin.Comentarios.VerEmail(this);});};this.BotonResponder=function(Boton){NumC=$(Boton).parent().parent().attr("comentario");this.InsertarHTML("<span comentario='"+NumC+"' contenteditable='false'>"+NumC+"</span>&nbsp;");};this.VotarComentario=function(Boton,Valor){Pagina=$("#MarcoNavegacion > article.Blog").attr("pagina");NumC=$(Boton).parent().parent().attr("comentario");LCSTR="Votaciones_"+Pagina+"_"+NumC;if(typeof localStorage[LCSTR]!=="undefined"){console.log("Comentarios.VotarComentario (ya has votado)");$Base.MostrarMensaje("No puedes votar el mismo mensaje 2 veces.");return;}
else{localStorage[LCSTR]=true;}
$Base.Cargando("TRUE");console.log("Comentarios.BotonMasUno");nAjax=$.post($Base.Raiz+"cmd/VotarComentario.cmd",{"Pagina":Pagina,"NumComentario":NumC,"Valor":Valor}).done(function(data){Datos=$Base.JSON_Parse(data);if(Datos===false)return;if(Datos.Mensaje==="Correcto"){nValor=$("#Comentarios_Datos > div[comentario="+Datos.NumComentario+"] > div:nth-child(2) > span > b:nth-child(1)");nTotal=$("#Comentarios_Datos > div[comentario="+Datos.NumComentario+"] > div:nth-child(2) > span > b:nth-child(2)");nValor.html(parseInt(nValor.html())+Datos.Valor);nTotal.html(parseInt(nTotal.html())+1);}
else{$Base.MostrarMensaje(data.Mensaje);}
$Base.Cargando("FALSE");$("#ErroresPHP_Info").html(Datos["ErroresPHP"]);if(Datos["ErroresPHP"]!==""){$Base.MostrarErroresPHP();}}).fail(function(jqXHR,textStatus,tError){console.log("Comentarios.VotarComentario Error ajax",jqXHR,textStatus,tError);$Base.MostrarMensaje("Error al tramitar la votación.");$Base.Cargando("FALSE");});};this.SeleccionarComentario=function(Comentario){console.log("Comentarios.SeleccionarComentario");$("#Comentarios_Datos > div[comentario][seleccionado=true]").removeAttr("seleccionado");Comentario.attr({"seleccionado":true});};this.BotonEnviarComentario=function(){if(this.Enviando===true)return;console.log("Comentarios.EnviarComentario",$("#Comentarios_Correo").css("border-color"));if($("#Comentarios_Nombre").css("border-color")==="rgb(176, 53, 53)"){$Base.MostrarMensaje("Debes introducir un nombre válido.");return false;}
if($("#Comentarios_Correo").css("border-color")==="rgb(176, 53, 53)"){$Base.MostrarMensaje("La dirección de correo introducida no es válida.");return false;}
if($("#Comentarios_Comentario").html()===""){$Base.MostrarMensaje("El mensaje está vacio!");return false;}
this.Enviando=true;$Base.ResetearTimerTiempoSesion();$Base.Cargando("TRUE");localStorage["Comentarios_Usuario"]=$("#Comentarios_Nombre").val();localStorage["Comentarios_Correo"]=$("#Comentarios_Correo").val();if($("#Comentarios_Web").val()!==""){localStorage["Comentarios_Web"]=$("#Comentarios_Web").val();}
nAjax=$.post($Base.Raiz+"cmd/EnviarComentario",{"URL":window.location.href,"Nombre":$("#Comentarios_Nombre").val(),"Email":$("#Comentarios_Correo").val(),"Web":$("#Comentarios_Web").val(),"Comentario":$("#Comentarios_Comentario").html(),"Pagina":$("#MarcoNavegacion > article.Blog").attr("pagina"),"Autor":$(".Cabecera_Datos > .FechaEntrada > .Autor").html()});console.log("Comentarios.BotonEnviarComentario");nAjax.done(function(data){Datos=$Base.JSON_Parse(data);if(Datos===false)return;if(Datos["HTML"].substr(0,5)==="Error"){$Base.MostrarMensaje(Datos["HTML"]);}
else{$("#Comentarios_Datos").html(Datos["HTML"]+$("#Comentarios_Datos").html());$Comentarios.Iniciar();$("body, html").stop().animate({scrollTop:$("#Comentarios_Datos").offset().top-200},200);$Base.MostrarMensaje("Comentario enviado correctamente.");}
$Base.Cargando("FALSE");$Comentarios.Enviando=false;$("#ErroresPHP_Info").html(Datos["ErroresPHP"]);if(Datos["ErroresPHP"]!==""){$Base.MostrarErroresPHP();}});nAjax.fail(function(jqXHR,textStatus,tError){console.log("Comentarios.BotonEnviarComentario Error ajax",jqXHR,textStatus,tError);$Base.MostrarMensaje("Error enviando el comentario.");$Base.Cargando("FALSE");$Comentarios.Enviando=false;});return true;};this.Obtener20=function(){if($("div[fincomentarios=true]").offset())return;if(this.Obteniendo===true)return;$Base.ResetearTimerTiempoSesion();$Base.Cargando("TRUE");Pagina=$("#MarcoNavegacion > article.Blog").attr("pagina")
Desde=$("#Comentarios_Datos div[comentario]:last-child").attr("comentario");console.log("Comentarios.Obtener20",Pagina,Desde);this.Obteniendo=true;nAjax=$.post($Base.Raiz+"cmd/ObtenerComentarios",{"Pagina":Pagina,"Desde":Desde-1,"Hasta":Desde-21});nAjax.done(function(data){Datos=$Base.JSON_Parse(data);if(Datos===false)return;$("div[puntoscroll=true]").removeAttr("puntoscroll");$("#Comentarios_Datos").html($("#Comentarios_Datos").html()+Datos["HTML"]);$Base.Cargando("FALSE");$Comentarios.Iniciar();$("#ErroresPHP_Info").html(Datos["ErroresPHP"]);if(Datos["ErroresPHP"]!==""){$Base.MostrarErroresPHP();}});nAjax.fail(function(jqXHR,textStatus,tError){console.log("Comentarios.Obtener20 Error ajax",jqXHR,textStatus,tError);$Base.MostrarMensaje("Error cargando los 20 siguientes comentarios");$Base.Cargando("FALSE");$Comentarios.Obteniendo=false;});};this.ObtenerHastaNum=function(Num){if($("div[fincomentarios=true]").offset())return;if(this.Obteniendo===true)return;$Base.ResetearTimerTiempoSesion();$Base.Cargando("TRUE");Pagina=$("#MarcoNavegacion > article.Blog").attr("pagina");Desde=$("#Comentarios_Datos div[comentario]:last-child").attr("comentario");console.log("Comentarios.ObtenerHastaNum",Pagina,Desde);this.Obteniendo=true;nAjax=$.post($Base.Raiz+"cmd/ObtenerComentarios",{"Pagina":Pagina,"Desde":Desde-1,"Hasta":Num});nAjax.done(function(data){Datos=$Base.JSON_Parse(data);if(Datos===false)return;$("div[puntoscroll=true]").removeAttr("puntoscroll");$("#Comentarios_Datos").html($("#Comentarios_Datos").html()+Datos["HTML"]);$Comentarios.Obteniendo=false;$Comentarios.Iniciar();$Base.Cargando("FALSE");$Comentarios.MostrarComentario($Comentarios.NumComentario);$("#ErroresPHP_Info").html(Datos["ErroresPHP"]);if(Datos["ErroresPHP"]!==""){$Base.MostrarErroresPHP();}});nAjax.fail(function(jqXHR,textStatus,tError){console.log("Comentarios.ObtenerHastaNum Error ajax",jqXHR,textStatus,tError);$Base.MostrarMensaje("Error cargando el comentario [#"+$Comentarios.NumComentario+"].");$Base.Cargando("FALSE");$Comentarios.Obteniendo=false;});};this.MostrarComentario=function(Num){setTimeout(function(){$Comentarios.SeleccionarComentario($("#Comentarios_Datos div[comentario="+Num+"]"));},10);if($("#Comentarios_Datos div[comentario="+Num+"]").offset()){console.log("Comentarios.MostrarComentario",Num);Pos=$("#Comentarios_Datos div[comentario="+Num+"]").offset().top;Tam=$("#Comentarios_Datos div[comentario="+Num+"]").height()+40;PosScroll=$("body").scrollTop()||$("html").scrollTop();if(!(Pos>PosScroll&&Pos<PosScroll+($(window).height()-Tam))){$("body, html").stop().animate({scrollTop:Pos-($(window).height()-Tam)},200);}
if(this.MostrarComentarioTimer!==0&&Num!==this.NumComentario){$("#Comentarios_Datos div[resaltado=true]").removeAttr("resaltado");console.log("Comentarios.MostrarComentario (CancelarTimerAni)",this.MostrarComentarioTimer);clearTimeout(this.MostrarComentarioTimer);this.MostrarComentarioTimer=0;}
if(Num!==this.NumComentario){$("#Comentarios_Datos div[comentario="+Num+"]").attr("resaltado","true");this.MostrarComentarioTimer=setTimeout(function(){$("#Comentarios_Datos div[resaltado=true]").removeAttr("resaltado");console.log("Comentarios.MostrarComentario (FinTimerAni)",$Comentarios.MostrarComentarioTimer);$Comentarios.MostrarComentarioTimer=0;$Comentarios.NumComentario=0;},5000);}}
else{if($("div[fincomentarios=true]").offset()){$Base.MostrarMensaje("El mensaje #"+Num+" no existe o ha sido eliminado.");}
else{this.ObtenerHastaNum(Num-20);}}
this.NumComentario=Num;};this.PuntoScroll=function(){Comentario=$("div[puntoscroll=true]");if(Comentario.offset()){if(($(window).scrollTop()+$(window).height())>Comentario.offset().top){$Comentarios.Obtener20();}}};this.ComandoEdicion=function(Comando,Param){if(typeof Param==='undefined')Param=null;console.log("Comentarios.ComandoEdicion",Comando);this.AsignarEstadosBotones();$("#Comentarios_Comentario").focus();document.execCommand(Comando,false,Param);};this.AsignarEstadosBotones=function(){console.log("Comentarios.AsignarEstadosBotones");$("#Comentarios_BarraControles > .BotonEdicion:nth-child(1)").attr({"marcado":(document.queryCommandState("bold"))?true:false});$("#Comentarios_BarraControles > .BotonEdicion:nth-child(2)").attr({"marcado":(document.queryCommandState("underline"))?true:false});$("#Comentarios_BarraControles > .BotonEdicion:nth-child(3)").attr({"marcado":(document.queryCommandState("italic"))?true:false});$("#Comentarios_BarraControles > .BotonEdicion:nth-child(4)").attr({"marcado":(document.queryCommandState("strikethrough"))?true:false});$("#Comentarios_BarraControles > .BotonEdicion:nth-child(7)").attr({"marcado":(document.queryCommandState("insertunorderedlist"))?true:false});$("#Comentarios_BarraControles > .BotonEdicion:nth-child(8)").attr({"marcado":(document.queryCommandState("insertorderedlist"))?true:false});$("#Comentarios_BarraControles > .BotonEdicion:nth-child(10)").attr({"marcado":(document.queryCommandState("justifyLeft"))?true:false});$("#Comentarios_BarraControles > .BotonEdicion:nth-child(11)").attr({"marcado":(document.queryCommandState("justifyCenter"))?true:false});$("#Comentarios_BarraControles > .BotonEdicion:nth-child(12)").attr({"marcado":(document.queryCommandState("justifyRight"))?true:false});};this.InsertarHTML=function(HTML){document.getElementById("Comentarios_Comentario").focus();this.CursorAlFinal();var Seleccion=window.getSelection();if(Seleccion.getRangeAt&&Seleccion.rangeCount){var Rango=Seleccion.getRangeAt(0);var Elemento=document.createElement("div");Elemento.innerHTML=HTML;var Fragmento=document.createDocumentFragment();var Nodo,UltimoNodo;while((Nodo=Elemento.firstChild)){UltimoNodo=Fragmento.appendChild(Nodo);}
Rango.insertNode(Fragmento);this.CursorAlFinal();}};this.CursorAlFinal=function(){Elemento=document.getElementById("Comentarios_Comentario");var Rango=document.createRange();Rango.selectNodeContents(Elemento);Rango.collapse(false);var Seleccion=window.getSelection();Seleccion.removeAllRanges();Seleccion.addRange(Rango);};};$(window).scroll(function(){$Comentarios.PuntoScroll();});
$PintarCodigo=new function(){this.CodigoTemporizador=0;this.EnlazarEtiquetas=function(){console.log("PintarCodigo.Iniciar");$("linea").off("click").on("click",function(e){$PintarCodigo.MostrarLineaCodigo($(this).attr("cid"),$(this).attr("l"));});$("linea, a[cid][l]").off("mouseover").on("mouseover",function(e){Lineas=$(this).attr("l").split(",");console.log("$PintarCodigo.EnlazarEtiquetas > linea:mousehover",Lineas);for(var i=0;i<Lineas.length;i++){$("#"+$(this).attr("cid")+" > .Codigo_PRECodigo > div[l="+Lineas[i]+"]").attr({"hover":"true"});}});$("linea, a[cid][l]").off("mouseout").on("mouseout",function(e){Lineas=$(this).attr("l").split(",");console.log("$PintarCodigo.EnlazarEtiquetas > linea:mouseout",Lineas);for(var i=0;i<Lineas.length;i++){$("#"+$(this).attr("cid")+" > .Codigo_PRECodigo > div[l="+Lineas[i]+"]").removeAttr("hover");}});};this.MostrarLineaCodigo=function(ID,Lineas){console.log("PintarCodigo.MostrarLineaCodigo",ID,Lineas);Linea=Lineas.split(',');if(this.CodigoTemporizador!=0){clearTimeout(this.CodigoTemporizador);$(".Codigo_PRECodigo > div[l]").removeAttr("click");this.CodigoTemporizador=0;}
for(var i=0;i<Lineas.length;i++){$("#"+ID+" > .Codigo_PRECodigo > div[l="+Linea[i]+"]").attr({"click":"true"});}
this.CodigoTemporizador=setTimeout(function(){$(".Codigo_PRECodigo > div[l]").removeAttr("click");$PintarCodigo.CodigoTemporizador=0;},900);var CodigoDivC=$("#"+ID+" > .Codigo_PRECodigo > div[l="+Linea[0]+"]");if(CodigoDivC.offset()){Pos=CodigoDivC.offset().top-10;Tam=CodigoDivC.height()+20;PosScroll=$("body").scrollTop()||$("html").scrollTop();WindowHeight=$(window).height();console.log("PintarCodigo.MostrarLineaCodigo (reposicionando)",Pos,PosScroll,Tam,WindowHeight);if(!(Pos>PosScroll&&Pos<PosScroll+(WindowHeight-Tam))){if(Pos>PosScroll){$("body, html").stop().animate({scrollTop:Pos-(WindowHeight-Tam)},200);}
else{$("body, html").stop().animate({scrollTop:Pos},200);}}}};};
$Lab=new function(){this.Lab_Temporizador=0;this.Lab_TemporizadorS=0;this.Lab_SegundosActualizar=0;this.Editor=new Object;this.Archivo="";this.Original="";this.ForzarVista="-1";this.Modo="text/html";this.Guardando=false;this.Iniciar=function(){console.log("Lab.Iniciar",this.Archivo);this.EnlazarEventosExplorador();this.Editor=CodeMirror.fromTextArea(document.getElementById('Lab_Codigo'),{mode:this.Modo,indentUnit:4,fixedGutter:false,lineNumbers:true,autoCloseTags:true,autoCloseBrackets:true,scrollbarStyle:"simple",matchTags:{bothTags:true},extraKeys:{"Ctrl-S":function(instance){if(typeof $Admin!=="undefined"){$Admin.Lab.Guardar();}
else{$Base.MostrarMensaje("No tienes permiso para guardar archivos.");}}}});this.Editor.on("change",function(CM,Evento){$Lab.TemporizadorActualizarResultado_Iniciar();});this.Editor.on("keyup",function(CM,Evento){if(Evento.altKey&&(Evento.keyCode===65||Evento.keyCode===97)){$Lab.ActualizarResultado();}
if(Evento.keyCode===27){$Lab.TemporizadorActualizarResultado_Cancelar();}});this.Original=$("#Lab_Codigo").val();switch(this.ForzarVista){case"0":$(".Lab_BotonVerModoCabecera").trigger("click");break;case"1":$(".Lab_BotonVerFilas").trigger("click");break;case"2":$(".Lab_BotonVerColumnas").trigger("click");break;case"3":$(".Lab_BotonVerCodigo").trigger("click");break;case"4":$(".Lab_BotonVerPreview").trigger("click");break;}
this.ActualizarResultado();$Lab.Editor.setSize(parseInt($(".Codemirror").attr("width")),parseInt($(".Codemirror").attr("height")));};this.IniciarEjemplo=function(Archivo){this.ResaltarArchivoActual(Archivo,true);var DatosEntrada=$Base.BuscarEntrada(Archivo);if(DatosEntrada!==-1){document.title=EntradasBlog[DatosEntrada]["Titulo"];}
else{document.title="Lab : "+Archivo;}};this.TemporizadorActualizarResultado_Iniciar=function(){this.TemporizadorActualizarResultado_Cancelar();this.Lab_SegundosActualizar=3;$("#Lab_Actualizar").attr({"visible":true});$("#Lab_Actualizar_Tiempo").html(this.Lab_SegundosActualizar);this.Lab_Temporizador=setTimeout(function(){$Lab.ActualizarResultado();},this.Lab_SegundosActualizar*1000);this.Lab_TemporizadorS=setInterval(function(){$Lab.Lab_SegundosActualizar--;$("#Lab_Actualizar_Tiempo").html($Lab.Lab_SegundosActualizar);if($Lab.Lab_SegundosActualizar<0){clearInterval(this.Lab_TemporizadorS);}},1000);};this.TemporizadorActualizarResultado_Cancelar=function(){$("#Lab_Actualizar").attr({"visible":false});if($Lab.Lab_Temporizador!==0){clearTimeout($Lab.Lab_Temporizador);clearInterval(this.Lab_TemporizadorS);}
$Lab.Lab_Temporizador=0;$Lab.Lab_TemporizadorS=0;};this.EnlazarEventosExplorador=function(){console.log("Lab.EnlazarEventosExplorador");$(".Lab_Explorador .Lab_Archivo").off("click").on("click",function(){$Lab.ClickArchivo($(this));});$(".Lab_Explorador .Lab_Directorio").off("click").on("click",function(){$Lab.ClickDirectorio($(this));});$(".Lab_Explorador .Lab_Archivo > a").off("click").on("click",function(e){$Lab.ClickArchivo($(this).parent());e.preventDefault();e.stopImmediatePropagation();return false;});};this.ClickDirectorio=function(Objeto,SoloAbrir){console.log("Lab.ClickDirectorio",Objeto);Animacion=Objeto.next();Directorio=Animacion.find(".Lab_Lista");var Altura=Animacion.css("height");var AltoPadre=0;if(typeof(SoloAbrir)==="undefined"){if(parseInt(Altura)===0){Animacion.css({"height":Directorio.height()});AltoPadre=Directorio.height();}
else{Animacion.css({"height":0});AltoPadre=-Directorio.height();}}
else{if(SoloAbrir===true){Animacion.css({"height":Directorio.height()});AltoPadre=Directorio.height();}
else{Animacion.css({"height":0});AltoPadre=-Directorio.height();}}
console.log(Altura,AltoPadre);Padre=Objeto.parent().parent().parent();while(Padre!==null){if(Padre.attr("class")!=="Lab_Directorio_Animacion")break;Padre.css({"height":Padre.height()+AltoPadre});Padre=Padre.parent().parent().parent();}};this.ClickArchivo=function(Objeto){console.log("Lab_ClickArchivo",Objeto);var Rec=Objeto;var Ret=Rec.find("a").html();while(Rec!==null){Rec=Rec.parent().parent().parent().prev();if(Rec.attr("class")!=="Lab_Directorio")break;Ret=Rec.find("span").html()+"/"+Ret;}
Ret="Ejemplos/"+Ret;this.CargarArchivo(Ret);};this.ResaltarArchivoActual=function(Archivo){var UActual=$(".Lab_Explorador .Lab_Archivo[actual]");if(UActual.length>0){UActual.removeAttr("actual");}
ItemActual=$(".Lab_Explorador .Lab_Archivo[path='/Lab/"+Archivo+"']");ItemActual.attr("actual","true");Padre=ItemActual.parent().parent().parent().prev();while(Padre.length!==0){if(Padre[0].className==="Lab_Directorio"){$Lab.ClickDirectorio(Padre,true);}
Padre=Padre.parent().parent().parent().prev();}};this.CargarArchivo=function(Archivo,ID){$Base.ResetearTimerTiempoSesion();$Base.Cargando("TRUE");$Base.CargarArchivo_nopush=false;console.log("Lab.CargarArchivo",Archivo);if(Archivo===null){Archivo=$Base.Archivo;$Base.CargarArchivo_nopush=true;}
if(ID===undefined){ID=-1;}
this.PeticionAjax=$.post($Base.Raiz+"cmd/LabAbrirEjemplo.cmd",{"Archivo":Archivo,"ID":ID},function(data){Datos=$Base.JSON_Parse(data);if(Datos===false)return;if(Datos["Ret"]===404){$Base.MostrarErrorAjax(404,false);}
else if(Datos["Ret"]===403){$Base.MostrarErrorAjax(403,false);}
else{if(Datos["ID"]===-1){$Lab.IniciarEjemplo(Datos['Archivo']);$Lab.Editor.setOption("mode",Datos["Modo"]);$Lab.Editor.setValue(Datos["Datos"]);$Lab.Original=$Lab.Editor.getValue();switch(Datos["Vista"]){case"0":$(".Lab_BotonVerModoCabecera").trigger("click");break;case"1":$(".Lab_BotonVerFilas").trigger("click");break;case"2":$(".Lab_BotonVerColumnas").trigger("click");break;case"3":$(".Lab_BotonVerCodigo").trigger("click");break;case"4":$(".Lab_BotonVerPreview").trigger("click");break;}
URL="/"+$Base.RaizRelativa+"Lab/"+Datos["Archivo"];$("#MarcoNavegacionLab").attr({"pagina":Datos["Archivo"]});if($Base.CargarArchivo_nopush===false){$Base.Entrada=$Base.IdentificarEntrada(URL,URL);$Base.Entrada["Titulo"]="Lab : "+Datos["Archivo"];window.history.pushState($Base.Entrada,document.title,URL);$(window).scrollTop(0);}
$("body").attr({"modificado":"false"});$Base.ComprobarScrollVotacion();$Lab.ActualizarResultado();$("#ErroresPHP_Info").html(Datos["ErroresPHP"]);if(Datos["ErroresPHP"]!==""){$Base.MostrarErroresPHP();}}
else{$Lab.MiniLab_Editores[Datos["ID"]].setValue(Datos["Datos"]);$Lab.MiniLab_ActualizarResultado(Datos["ID"]);}
$Base.Cargando("FALSE");}}).fail(function(jqXHR,textStatus,tError){console.log("Lab.CargarArchivo Error ajax",jqXHR,textStatus,tError);$Base.MostrarErrorAjax((jqXHR.status===404)?1404:jqXHR.status,false,tError);});};this.AjustarVista=function(NuevaVista,Guardar){if(document.getElementById("Lab_Barra1")===null){return;}
if(NuevaVista==="-1"){NuevaVista=(typeof(localStorage["Lab_Vista"])==="undefined")?"0":localStorage["Lab_Vista"];}
else{if(typeof(Guardar)==="undefined"){localStorage["Lab_Vista"]=NuevaVista;}
else{if(Guardar===true){localStorage["Lab_Vista"]=NuevaVista;}}}
if(typeof $("#BarraPrincipal").css("zoom")==="undefined"){Zoom=1;}
else{Zoom=$("#BarraPrincipal").css("zoom");}
if(Zoom==="normal")Zoom=1;console.log("$Lab.AjustarVista",NuevaVista,Zoom);AnchoMenu=$("#BarraPrincipal").outerWidth()*Zoom;Ancho=window.innerWidth-(AnchoMenu*2);Alto=window.innerHeight;AnchoBarra1=parseInt($("#Lab_Barra1").outerWidth());switch(NuevaVista){case"0":$("#BarraNavegacion_Lab_IconoVer").attr({"ver":"modocabecera"});break;case"1":$("#BarraNavegacion_Lab_IconoVer").attr({"ver":"filas"});break;case"2":$("#BarraNavegacion_Lab_IconoVer").attr({"ver":"columnas"});break;case"3":$("#BarraNavegacion_Lab_IconoVer").attr({"ver":"codigo"});break;case"4":$("#BarraNavegacion_Lab_IconoVer").attr({"ver":"preview"});break;}
switch(NuevaVista){case"0":$(".CodeMirror").css({"display":"block"});PosBarra=Alto-240;$("#Lab_Barra1").css({top:PosBarra,left:AnchoMenu,height:4,width:Ancho,display:"block",cursor:"ns-resize"});$("#Lab_Barra1").draggable({axis:"y",cursor:"ns-resize",containment:"#MarcoNavegacion",start:function(event,ui){$("#Lab_ParcheIframe").css({"display":"block"});$Lab.DragFilas(false);},drag:function(event,ui){$Lab.DragFilas(false);},stop:function(event,ui){$("#Lab_ParcheIframe").css({"display":"none"});$Lab.DragFilas(true);}});$("#Lab_Preview").css({left:AnchoMenu,width:Ancho+1,display:"block"});this.DragFilas(false);$("#Lab_Preview").focus();break;case"1":$(".CodeMirror").css({"display":"block"});PosBarra=Math.round((Alto-6)/2);$("#Lab_Barra1").css({top:PosBarra,left:AnchoMenu,height:4,width:Ancho,display:"block",cursor:"ns-resize"});$("#Lab_Barra1").draggable({axis:"y",cursor:"ns-resize",containment:"#MarcoNavegacion",start:function(event,ui){$("#Lab_ParcheIframe").css({"display":"block"});$Lab.DragFilas(false);},drag:function(event,ui){$Lab.DragFilas(false);},stop:function(event,ui){$("#Lab_ParcheIframe").css({"display":"none"});$Lab.DragFilas(true);}});$("#Lab_Preview").css({left:AnchoMenu,width:Ancho+1,display:"block"});this.DragFilas(false);$("#Lab_Preview").focus();break;case"2":$(".CodeMirror").css({"display":"block"});PosBarra=Math.round((Ancho-6)/2);$("#Lab_Barra1").css({top:0,left:PosBarra+AnchoMenu,height:Alto,width:4,display:"block",cursor:"ew-resize"});$("#Lab_Barra1").draggable({axis:"x",cursor:"ew-resize",containment:"#MarcoNavegacionLab",start:function(event,ui){$("#Lab_ParcheIframe").css({"display":"block"});$Lab.DragColumnas(false);},drag:function(event,ui){$Lab.DragColumnas(false);},stop:function(event,ui){$("#Lab_ParcheIframe").css({"display":"none"});$Lab.DragColumnas(true);}});$("#Lab_Preview").css({height:Alto+1,left:PosBarra+AnchoMenu+4,top:0,display:"block"});this.DragColumnas(false);$("#Lab_Preview").focus();break;case"3":$("#Lab_Barra1").css({display:"none"});$("#Lab_Preview").css({display:"none"});this.Editor.setSize(Ancho,Alto);$(".CodeMirror").css({"display":"block"});break;case"4":$("#Lab_Barra1").css({display:"none"});$("#Lab_Preview").css({display:"block",top:0,left:AnchoMenu,height:Alto,width:Ancho});$(".CodeMirror").css({"display":"none"});$("#Lab_Preview").focus();break;}
$Base.RenovarMeta();};this.DragFilas=function(GuardarDatos){if(document.getElementById("Lab_Barra1")===null){return;}
if(typeof $("#BarraPrincipal").css("zoom")==="undefined"){Zoom=1;}
else{Zoom=$("#BarraPrincipal").css("zoom");}
AltoBarra=$("#Lab_Barra1").outerHeight();AnchoMenu=$("#BarraPrincipal").outerWidth()*Zoom;Ancho=window.innerWidth-(AnchoMenu*2);Alto=$(window).outerHeight();PosBarra=$("#Lab_Barra1").offset().top;this.Editor.setSize(Ancho,PosBarra);$("#Lab_Preview").css({"top":PosBarra+AltoBarra,"height":(Alto-(PosBarra+AltoBarra))});};this.DragColumnas=function(GuardarDatos){if(document.getElementById("Lab_Barra1")===null){return;}
if(typeof $("#BarraPrincipal").css("zoom")==="undefined"){Zoom=1;}
else{Zoom=$("#BarraPrincipal").css("zoom");}
AnchoMenu=$("#BarraPrincipal").outerWidth()*Zoom;AnchoBarra=$("#Lab_Barra1").outerWidth();Alto=$(window).outerHeight();Ancho=window.innerWidth-(AnchoMenu);PosBarra=$("#Lab_Barra1").offset().left;this.Editor.setSize(((PosBarra-AnchoMenu)>0)?PosBarra-AnchoMenu:0,Alto);$("#Lab_Preview").css({"left":PosBarra+AnchoBarra,"width":(Ancho-(PosBarra+AnchoBarra))});};this.ActualizarResultado=function(){this.TemporizadorActualizarResultado_Cancelar();var Estilos=$("#Lab_Preview").attr("style");$("#Lab_Preview").remove();$("<iframe id='Lab_Preview' allowfullscreen=true style='"+Estilos+"'></iframe>").insertBefore($("#Lab_Barra1"));var previewFrame=document.getElementById('Lab_Preview');var preview=previewFrame.contentDocument||previewFrame.contentWindow.document;preview.open();var Codigo=this.Editor.getValue();preview.write(Codigo);preview.close();if($Lab.Original!==$Lab.Editor.getValue()){$("body").attr({"modificado":"true"});}
else{$("body").attr({"modificado":"false"});}};this.Modificado=function(){return false;};this.MiniLab_Editores=[];this.MiniLab_Iniciar=function(){console.log("Lab.MiniLab_Iniciar");this.MiniLab_Editores=[];MiniLabs=document.getElementsByClassName("MiniLab_Codigo");for(var i=0;i<MiniLabs.length;i++){Archivo=MiniLabs[i].parentNode.getAttribute("archivo");this.MiniLab_Editores[i]=CodeMirror.fromTextArea(MiniLabs[i],{mode:'text/html',indentUnit:4,fixedGutter:false,lineNumbers:true,autoCloseTags:true,autoCloseBrackets:true,matchTags:{bothTags:true}});this.MiniLab_Editores[i].PosObjeto=i;this.MiniLab_Editores[i].on("change",function(cm,change){$Lab.MiniLab_ActualizarResultado(cm.PosObjeto);});this.CargarArchivo(Archivo,i);}
$(".MiniLab_VerCodigo").off("click").on("click",function(event){this.parentNode.parentNode.setAttribute("ver","codigo");ID=this.parentNode.parentNode.getAttribute("id").replace("MiniLab_","");$Lab.MiniLab_Editores[ID].refresh();});$(".MiniLab_VerPreview").off("click").on("click",function(event){this.parentNode.parentNode.setAttribute("ver","preview");});$(".MiniLab_VerMixto").off("click").on("click",function(event){this.parentNode.parentNode.setAttribute("ver","mixto");ID=this.parentNode.parentNode.getAttribute("id").replace("MiniLab_","");$Lab.MiniLab_Editores[ID].refresh();});$(".MiniLab_ContenedorBotones > label").off("click").on("click",function(event){Raiz=$(this).parent().parent();Raiz.find(".MiniLab[oculto='false']").attr({"oculto":"true"});Actual=Raiz.find(".MiniLab:nth-child("+$(this).html()+")");Actual.attr({"oculto":"false"});$Lab.MiniLab_Editores[Actual.attr("id").replace("MiniLab_","")].refresh();});};this.MiniLab_ActualizarResultado=function(ID){console.log("Lab.MiniLab_ActualizarResultado",ID);var previewFrame=document.getElementById('MiniLab_'+ID).getElementsByClassName("MiniLab_Preview")[0];var preview=previewFrame.contentDocument||previewFrame.contentWindow.document;preview.open();var Codigo=this.MiniLab_Editores[ID].getValue();preview.write(Codigo);preview.close();};};$(window).resize(function(){$Lab.AjustarVista("-1",false);});
var ObjetoCanvas=function(Opciones){this.Constantes={Radiant:Math.PI/180,TAU:Math.PI*2};this.OpcionesCanvas={Tipo:'2d',Ancho:'Auto',Alto:'Auto',Entorno:'Normal',Idioma:'es',MostrarFPS:true,BotonesPosicion:"derecha",BotonPantallaCompleta:true,BotonLogo:true,BotonExtraHTML:"",ElementoRaiz:document.body,Pausar:true,ColorFondo:0x312E35,CapturaEjemplo:"",ForzarLandscape:false};if(typeof Opciones==='object'){for(var Indice in Opciones){this.OpcionesCanvas[Indice]=Opciones[Indice];}}
if(this.OpcionesCanvas['Entorno']==='Normal'){if(!document.getElementById("ObjetoCanvas")){var PreCabecera=document.createElement('div');PreCabecera.id="ObjetoCanvas";this.OpcionesCanvas['ElementoRaiz'].appendChild(PreCabecera);}
this.Cabecera=document.getElementById("ObjetoCanvas");this.Textos={en:["Loading...","Paused","Start","Frames per second","Full Screen","Restore Screen","devildrey33 home page","Error loading WebGL"],es:["Cargando...","En Pausa","Iniciar","Frames por segundo","Pantalla Completa","Restaurar Pantalla","Página de devildrey33","Error iniciando WebGL"]};var StrHtml='<div id="Cabecera_Cargando" class="MarcoCanvas"><span>'+this.Textos[this.OpcionesCanvas.Idioma][0]+'</span></div>'+"<canvas id='Cabecera_Canvas'></canvas>"+'<div id="Cabecera_PausaAni" class="MarcoCanvas">'+this.Textos[this.OpcionesCanvas.Idioma][1]+'</div>'+'<div id="Cabecera_Iniciar" class="MarcoCanvas">'+this.Textos[this.OpcionesCanvas.Idioma][2]+'</div>'+'<div id="Cabecera_Error" class="MarcoCanvas" visible="false">Error :</div>';StrHtml+="<div id='ObjetoCanvas_Controles' alinear='"+this.OpcionesCanvas.BotonesPosicion+"'>";if(this.OpcionesCanvas.MostrarFPS===true){StrHtml+="<div class='ObjetoCanvas_Marco' title='"+this.Textos[this.OpcionesCanvas.Idioma][3]+"'>"+"<span id='ObjetoCanvas_FPS'>60</span>"+"<span id='ObjetoCanvas_TxtFPS'>fps</span>"+"</div>";}
if(this.OpcionesCanvas.BotonExtraHTML!==""){StrHtml+=this.OpcionesCanvas.BotonExtraHTML;}
if(this.OpcionesCanvas.BotonPantallaCompleta===true){StrHtml+="<div class='ObjetoCanvas_Boton' id='ObjetoCanvas_PantallaCompleta' title='"+this.Textos[this.OpcionesCanvas.Idioma][4]+"'>"+"<img src='https://devildrey33.es/Web/SVG/Iconos50x50.svg#svg-pantalla-completa' />"+"</div>"+"<div class='ObjetoCanvas_Boton' id='ObjetoCanvas_RestaurarPantalla' title='"+this.Textos[this.OpcionesCanvas.Idioma][5]+"'>"+"<img src='https://devildrey33.es/Web/SVG/Iconos50x50.svg#svg-restaurar-pantalla' />"+"</div>";}
if(this.OpcionesCanvas.BotonLogo===true){StrHtml+="<a href='https://devildrey33.es' class='ObjetoCanvas_Boton' target='_blank' title='"+this.Textos[this.OpcionesCanvas.Idioma][6]+"' id='ObjetoCavas_Logo'>"+"<img src='https://devildrey33.es/Web/SVG/Iconos50x50.svg#svg-logo' />"+"<div id='ObjetoCavas_TextoLogo'>"+"<span>D</span>"+"<span>E</span>"+"<span>V</span>"+"<span>I</span>"+"<span>L</span>"+"<span>D</span>"+"<span>R</span>"+"<span>E</span>"+"<span>Y</span>"+"<span>&nbsp;</span>"+"<span>3</span>"+"<span>3</span>"+"</div>"+"</a>";}
StrHtml+="</div>";this.Cabecera.innerHTML=this.Cabecera.innerHTML+StrHtml;if(this.OpcionesCanvas.BotonPantallaCompleta===true){var bPantallaCompleta=document.getElementById("ObjetoCanvas_PantallaCompleta");var bRestaurarPantalla=document.getElementById("ObjetoCanvas_RestaurarPantalla");bRestaurarPantalla.style.display="none";bPantallaCompleta.addEventListener("click",function(){this.PantallaCompleta();}.bind(this));bRestaurarPantalla.addEventListener("click",function(){this.RestaurarPantalla();}.bind(this));document.addEventListener('webkitfullscreenchange',this.EventoPantallaCompleta.bind(this),false);document.addEventListener('mozfullscreenchange',this.EventoPantallaCompleta.bind(this),false);document.addEventListener('msfullscreenchange',this.EventoPantallaCompleta.bind(this),false);document.addEventListener('fullscreenchange',this.EventoPantallaCompleta.bind(this),false);}}
else if(this.OpcionesCanvas['Entorno']==='Banner'){this.Cabecera=document.getElementById("Cabecera");if(document.getElementById('Cabecera_Canvas')){this.Cabecera.removeChild(document.getElementById('Cabecera_Canvas'));}
this.Cabecera.innerHTML=this.Cabecera.innerHTML+"<canvas id='Cabecera_Canvas'></canvas>";document.getElementById("CabeceraAutorAni_HTML").innerHTML="<div>"+this.Nombre+"</div>"+"<div><span style='color:#AAA;'>Concepto original : </span><b>"+this.IdeaOriginal+"</b></div>"+"<a href='"+this.URL+"' target='_blank'>"+this.NombreURL+"</a>";}
this.Cabecera.setAttribute("cargando",true);this.Cabecera.setAttribute("animar",true);this.Canvas=document.getElementById("Cabecera_Canvas");this._EsMovil=-1;this.Ancho=0;this.Alto=0;if(this.OpcionesCanvas.Ancho!=="Auto"){this.Ancho=this.OpcionesCanvas.Ancho;}
if(this.OpcionesCanvas.Alto!=="Auto"){this.Alto=this.OpcionesCanvas.Alto;}
if(this.OpcionesCanvas.Ancho!=="Auto"){this.Canvas.style.width=this.Ancho+"px";this.Canvas.style.left="calc(50% - ("+this.Ancho+"px / 2))";}
if(this.OpcionesCanvas.Alto!=="Auto"){this.Canvas.style.height=this.Alto+"px";this.Canvas.style.top="calc(50% - ("+this.Ancho+"px / 2))";}
if(this.OpcionesCanvas.ForzarLandscape===true){this.Cabecera.setAttribute("forzarlandscape",true);}
try{if(this.OpcionesCanvas.Tipo.toLowerCase()==='2d'){this.Context=this.Canvas.getContext("2d");console.log("ObjetoCanvas iniciado en modo 2d");}
else if(this.OpcionesCanvas.Tipo.toLowerCase()==='three'){if(this.EsMovil()===true){this.Context=new THREE.WebGLRenderer({canvas:this.Canvas});console.log("ObjetoCanvas iniciado en modo THREE sin antialias");}
else{this.Context=new THREE.WebGLRenderer({canvas:this.Canvas,antialias:true});console.log("ObjetoCanvas iniciado en modo THREE con antialias");}
this.Context.setClearColor(this.OpcionesCanvas.ColorFondo,1);}}
catch(error){this.MostrarErrorIniciarWebGL(error);return false;}
this.RAFID=0;this.FPS_UltimoTick=Date.now()+1000;this.FPS_Contador=0;this.FocoWeb=true;this.Tick=0;this.EventoRedimensionar();this.EnlazarEventos();this.Cargando(true);this.RAFID=window.requestAnimationFrame(this.Actualizar.bind(this));return true;};ObjetoCanvas.prototype.MostrarErrorIniciarWebGL=function(error){document.getElementById("ObjetoCanvas_Controles").style.display="none";var VentanaError=document.getElementById("Cabecera_Error");VentanaError.setAttribute("visible","true");var Captura=(this.OpcionesCanvas["CapturaEjemplo"]==="")?"":"<br />"+"<img src='https://devildrey33.es/Web/Graficos/250x200_"+this.OpcionesCanvas["CapturaEjemplo"]+"'>";VentanaError.innerHTML="<span>"+this.Textos[this.OpcionesCanvas.Idioma][7]+" : "+error+"</span>"+Captura;this.Cargando(false);};ObjetoCanvas.prototype.Terminar=function(){if(this.RAFID!==0){window.cancelAnimationFrame(this.RAFID);}
if(this.OpcionesCanvas.Entorno==="Normal"){if(this._EsMovil===true){this.Cabecera.removeEventListener('touchstart',this.hEventoTouchStart);this.Cabecera.removeEventListener('touchmove',this.hEventoTouchMove);this.Cabecera.removeEventListener('touchend',this.hEventoTouchEnd);}
else{this.Cabecera.removeEventListener('mousedown',this.hEventoMousePresionado);this.Cabecera.removeEventListener('mouseup',this.hEventoMouseSoltado);}
window.removeEventListener('keydown',this.hEventoTeclaPresionada);window.removeEventListener('keyup',this.hEventoTeclaSoltada);}
if(this._EsMovil===false){this.Cabecera.removeEventListener('mousemove',this.hEventoMouseMove);}
this.Cabecera.removeEventListener('mouseenter',this.hEventoMouseEnter);this.Cabecera.removeEventListener('mouseleave',this.hEventoMouseLeave);window.removeEventListener('resize',this.hEventoRedimensionar);window.removeEventListener('scroll',this.hEventoScroll);window.removeEventListener('blur',this.hEventoFocoPerdido);window.removeEventListener('focus',this.hEventoFocoRecibido);console.log("ObjetoCanvas.Terminar");};ObjetoCanvas.prototype.EnlazarEventos=function(){if(this.OpcionesCanvas.Entorno==="Normal"){if(this.EsMovil()===true){this.hEventoTouchStart=this.EventoTouchStart.bind(this);this.hEventoTouchMove=this.EventoTouchMove.bind(this);this.hEventoTouchEnd=this.EventoTouchEnd.bind(this);this.Cabecera.addEventListener('touchstart',this.hEventoTouchStart);this.Cabecera.addEventListener('touchmove',this.hEventoTouchMove);this.Cabecera.addEventListener('touchend',this.hEventoTouchEnd);}
else{this.hEventoMousePresionado=this.EventoMousePresionado.bind(this);this.hEventoMouseSoltado=this.EventoMouseSoltado.bind(this);this.Cabecera.addEventListener('mousedown',this.hEventoMousePresionado);this.Cabecera.addEventListener('mouseup',this.hEventoMouseSoltado);}
this.hEventoTeclaPresionada=this.EventoTeclaPresionada.bind(this);this.hEventoTeclaSoltada=this.EventoTeclaSoltada.bind(this);window.addEventListener('keydown',this.hEventoTeclaPresionada);window.addEventListener('keyup',this.hEventoTeclaSoltada);}
this.hEventoMouseEnter=this.EventoMouseEnter.bind(this);this.hEventoMouseLeave=this.EventoMouseLeave.bind(this);this.hEventoRedimensionar=this.EventoRedimensionar.bind(this);this.hEventoScroll=this.EventoScroll.bind(this);this.hEventoFocoPerdido=this.EventoFocoPerdido.bind(this);this.hEventoFocoRecibido=this.EventoFocoRecibido.bind(this);if(this.EsMovil()===false){this.hEventoMouseMove=this.EventoMouseMove.bind(this);this.Cabecera.addEventListener('mousemove',this.hEventoMouseMove);}
this.Cabecera.addEventListener('mouseenter',this.hEventoMouseEnter);this.Cabecera.addEventListener('mouseleave',this.hEventoMouseLeave);window.addEventListener('resize',this.hEventoRedimensionar);window.addEventListener('scroll',this.hEventoScroll);window.addEventListener('blur',this.hEventoFocoPerdido);window.addEventListener('focus',this.hEventoFocoRecibido);};ObjetoCanvas.prototype.EventoFocoRecibido=function(){this.FocoWeb=true;if(this.OpcionesCanvas.Entorno==="Normal"){this.EventoReanudar();}
else if(this.OpcionesCanvas.Entorno==="Banner"&&window.scrollX<190){this.EventoReanudar();}};ObjetoCanvas.prototype.EventoFocoPerdido=function(){this.FocoWeb=false;this.EventoPausa();};ObjetoCanvas.prototype.EsMovil=function(){this._EsMovil=ObjetoNavegador.EsMovil();return this._EsMovil;};ObjetoCanvas.prototype.Cargando=function(carga){this.Cabecera.setAttribute("cargando",carga);};ObjetoCanvas.prototype.EstaCargando=function(){var Ret=this.Cabecera.getAttribute("cargando");return(Ret==="true"||Ret===true);};ObjetoCanvas.prototype.Actualizar=function(){this.Tick=Date.now();if(this.OpcionesCanvas.MostrarFPS===true){this.FPS();}
this.RAFID=window.requestAnimationFrame(this.Actualizar.bind(this));this.Pintar.apply(this);};ObjetoCanvas.prototype.EventoTeclaPresionada=function(event){if(typeof(this.TeclaPresionada)!=="undefined"){this.TeclaPresionada.apply(this,[event]);}};ObjetoCanvas.prototype.EventoTeclaSoltada=function(event){if(typeof(this.TeclaSoltada)!=="undefined"){this.TeclaSoltada.apply(this,[event]);}};ObjetoCanvas.prototype.EventoMouseMove=function(event){if(typeof(this.MouseMove)!=="undefined"){this.MouseMove.apply(this,[event]);}};ObjetoCanvas.prototype.EventoMousePresionado=function(event){if(typeof(this.MousePresionado)!=="undefined"){this.MousePresionado.apply(this,[event]);}};ObjetoCanvas.prototype.EventoMouseSoltado=function(event){if(typeof(this.MouseSoltado)!=="undefined"){this.MouseSoltado.apply(this,[event]);}};ObjetoCanvas.prototype.EventoMouseEnter=function(event){if(typeof(this.MouseEnter)!=="undefined"){this.MouseEnter.apply(this,[event]);}};ObjetoCanvas.prototype.EventoMouseLeave=function(event){if(typeof(this.MouseLeave)!=="undefined"){this.MouseLeave.apply(this,[event]);}};ObjetoCanvas.prototype.EventoTouchStart=function(event){if(typeof(this.TouchStart)!=="undefined"){this.TouchStart.apply(this,[event]);}};ObjetoCanvas.prototype.EventoTouchMove=function(event){if(typeof(this.TouchMove)!=="undefined"){this.TouchMove.apply(this,[event]);}};ObjetoCanvas.prototype.EventoTouchEnd=function(event){if(typeof(this.TouchEnd)!=="undefined"){this.TouchEnd.apply(this,[event]);}};ObjetoCanvas.prototype.EventoRedimensionar=function(){if(this.OpcionesCanvas.ForzarLandscape===true&&ObjetoNavegador.EsMovil()===true&&window.innerWidth<window.innerHeight){if(this.OpcionesCanvas.Ancho==="Auto"){this.Ancho=window.innerHeight;}
if(this.OpcionesCanvas.Alto==="Auto"){this.Alto=window.innerWidth;}
this.Cabecera.style.left=-(this.Ancho-this.Alto)/2+"px";this.Cabecera.style.top=(this.Ancho-this.Alto)/2+"px";this.Cabecera.style.width=this.Ancho+"px";this.Cabecera.style.height=this.Alto+"px";}
else{if(this.OpcionesCanvas['Entorno']==='normal'){this.Cabecera.style.width="100%";this.Cabecera.style.height="100%";this.Cabecera.style.left="0px";this.Cabecera.style.top="0px";}
if(this.OpcionesCanvas.Ancho==="Auto"){this.Ancho=this.Cabecera.offsetWidth;}
if(this.OpcionesCanvas.Alto==="Auto"){this.Alto=this.Cabecera.offsetHeight;}}
this.Canvas.setAttribute("width",this.Ancho);this.Canvas.setAttribute("height",this.Alto);if(this.OpcionesCanvas.Tipo.toLowerCase()==="three"){this.Context.setSize(this.Ancho,this.Alto);if(this.Camara!==null&&typeof(this.Camara)!=='undefined'){this.Camara.aspect=this.Ancho/this.Alto;this.Camara.updateProjectionMatrix();}}
if(typeof(this.Redimensionar)!=="undefined"){this.Redimensionar.apply(this);}};ObjetoCanvas.prototype.EventoPausa=function(){if(this.RAFID!==0&&this.OpcionesCanvas.Pausar===true){this.Cabecera.setAttribute("animar",false);console.log("ObjetoCanvas.Pausa");window.cancelAnimationFrame(this.RAFID);this.RAFID=0;if(typeof this.Pausa!=='undefined'){this.Pausa();}}};ObjetoCanvas.prototype.EventoReanudar=function(){if(this.RAFID===0&&this.FocoWeb===true){this.Cabecera.setAttribute("animar",true);this.RAFID=window.requestAnimationFrame(this.Actualizar.bind(this));console.log("ObjetoCanvas.Reanudar RAFID = "+this.RAFID);if(typeof this.Pausa!=='undefined'){this.Reanudar();}}};ObjetoCanvas.prototype.EventoScroll=function(){if(this.OpcionesCanvas.Entorno==="Banner"){var PS=$(window).scrollTop();var Altura=this.Cabecera.offsetHeight;if(PS>Altura){this.EventoPausa();}
else if(PS<Altura){this.EventoReanudar();}}
if(typeof(this.Scroll)!=="undefined"){this.Scroll.apply(this);}};ObjetoCanvas.prototype.FPS=function(){if(this.Tick>this.FPS_UltimoTick){this.FPS_UltimoTick=this.Tick+1000;var SpanFPS=document.getElementById("ObjetoCanvas_FPS");SpanFPS.innerHTML=this.FPS_Contador;var Parte=256/60;SpanFPS.style.color="rgb("+Math.round(255-(this.FPS_Contador*Parte))+","+Math.round(this.FPS_Contador*Parte)+", 0)";this.FPS_Contador=0;}
else{this.FPS_Contador++;}};ObjetoCanvas.prototype.PantallaCompleta=function(){var RFS=document.body.requestFullscreen||document.body.msRequestFullscreen||document.body.mozRequestFullScreen||document.body.webkitRequestFullscreen;RFS.call(document.body);};ObjetoCanvas.prototype.RestaurarPantalla=function(){var EFS=document.exitFullscreen||document.msExitFullscreen||document.mozCancelFullScreen||document.webkitExitFullscreen;EFS.call(document);};ObjetoCanvas.prototype.EventoPantallaCompleta=function(Evento){var PantallaCompleta=(document.fullscreenElement||document.msFullscreenElement||document.mozFullscreenElement||document.webkitFullscreenElement);if(!PantallaCompleta){PantallaCompleta=(Math.abs(screen.height-window.innerHeight)===0);}
console.log("ObjetoCanvas.EventoPantallaCompleta "+PantallaCompleta);document.getElementById("ObjetoCanvas_PantallaCompleta").style.display=(!PantallaCompleta)?"block":"none";document.getElementById("ObjetoCanvas_RestaurarPantalla").style.display=(!PantallaCompleta)?"none":"block";};var BufferCanvas=function(Ancho,Alto){this.Canvas=document.createElement("canvas");this.Canvas.setAttribute("width",Ancho);this.Canvas.setAttribute("height",Alto);this.Context=this.Canvas.getContext("2d");this.Ancho=Ancho;this.Alto=Alto;};var ObjetoNavegador=new function(){this._EsMovil=-1;this.EsMovil=function(){if(this._EsMovil===-1){if(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)){this._EsMovil=true;return true;}
else{this._EsMovil=false;return false;}}
return this._EsMovil;};this._EsFirefox=-1;this.EsFirefox=function(){if(this._EsFirefox===-1){(navigator.userAgent.toLowerCase().indexOf('firefox')===-1)?this._EsFirefox=false:this._EsFirefox=true;}
return this._EsFirefox;};};
var FuncionesTiempo={Linear:function(Tiempo){return Tiempo;},SinIn:function(Tiempo){return 1-Math.cos(Tiempo*Math.PI/2);},SinOut:function(Tiempo){return Math.sin(Tiempo*Math.PI/2);},SinInOut:function(Tiempo){return-0.5*(Math.cos(Math.PI*Tiempo)-1);},CubicInOut:function(Tiempo){return(Tiempo<0.5)?4.0*Tiempo*Tiempo*Tiempo:0.5*Math.pow(2.0*Tiempo-2.0,3.0)+1.0;},CircularInOut:function(Tiempo){return(Tiempo<0.5)?0.5*(1.0-Math.sqrt(1.0-4.0*Tiempo*Tiempo)):0.5*(Math.sqrt((3.0-2.0*Tiempo)*(2.0*Tiempo-1.0))+1.0);}};var ObjetoAnimacion=function(){this.Animaciones=[];this.EnPausa=false;this.Tick=0;this.Actualizar=function(nTick){if(this.EnPausa===true){return;}
if(typeof(nTick)==='undefined'){this.Tick=Date.now();}
else{this.Tick=nTick;}
for(var i=this.Animaciones.length-1;i>-1;i--){if(this.Animaciones[i].Actualizar(this.Tick)===true){this.Animaciones.splice(i,1);}}};this.Pausa=function(){console.log("ObjetoAnimacion::Pausa");this.EnPausa=true;};this.Reanudar=function(){console.log("ObjetoAnimacion::Reanudar");this.Tick=Date.now();for(var i=this.Animaciones.length-1;i>-1;i--){this.Animaciones[i]._UltimoTick=this.Tick-1;}
this.EnPausa=false;};this.Limpiar=function(){for(var i=this.Animaciones.length-1;i>-1;i--){this.Animaciones[i].Terminar();}
this.Animaciones=[];};this.CrearAnimacion=function(Pasos,Opciones){return new ObjetoAnimacion_Animacion(Pasos,Opciones,this,false);};this.CrearTransicion=function(Pasos,Opciones){return new ObjetoAnimacion_Animacion(Pasos,Opciones,this,true);};};var ObjetoAnimacion_Animacion=function(ArrayPasos,Opciones,Padre,nTransicion){this._Padre=Padre;this._UltimoTick=0;this._PasosIniciales=ArrayPasos;this.Pasos=[];this._PosPasos=1;this._Avance=0;this._Invertido=nTransicion;this._Terminado=false;this._Opciones={Repetir:0,Invertir:false,FuncionActualizar:function(Valores){},FuncionIniciado:function(){},FuncionTerminado:function(){}};if(typeof(Opciones)!=='undefined'){if(typeof Opciones.Repetir!=="undefined"){this._Opciones.Repetir=Opciones.Repetir;}
if(typeof Opciones.Invertir!=="undefined"){this._Opciones.Invertir=Opciones.Invertir;}
if(typeof Opciones.FuncionActualizar!=="undefined"){this._Opciones.FuncionActualizar=Opciones.FuncionActualizar;}
if(typeof Opciones.FuncionIniciado!=="undefined"){this._Opciones.FuncionIniciado=Opciones.FuncionIniciado;}
if(typeof Opciones.FuncionTerminado!=="undefined"){this._Opciones.FuncionTerminado=Opciones.FuncionTerminado;}
if(typeof Opciones.Const!=="undefined"){this.Const=Opciones.Const;}}
for(var i=0;i<this._PasosIniciales.length;i++){var nPaso={};for(var Indice in this._PasosIniciales[i]){nPaso[Indice]={};for(var Indice2 in this._PasosIniciales[i][Indice]){if(this._PasosIniciales[i][Indice][Indice2]instanceof ObjetoAnimacion_Rand){nPaso[Indice][Indice2]=this._PasosIniciales[i][Indice][Indice2].Iniciar();}
else{nPaso[Indice][Indice2]=this._PasosIniciales[i][Indice][Indice2];}}}
if(typeof this._PasosIniciales[i].Retraso!=="undefined"){nPaso.Retraso=this._PasosIniciales[i].Retraso;}
else{nPaso.Retraso=0;}
if(typeof this._PasosIniciales[i].Tiempo!=="undefined"){nPaso.Tiempo=this._PasosIniciales[i].Tiempo;}
else{nPaso.Tiempo=1;}
if(typeof this._PasosIniciales[i].FuncionTiempo!=="undefined"){nPaso.FuncionTiempo=this._PasosIniciales[i].FuncionTiempo;}
else{nPaso.FuncionTiempo=FuncionesTiempo.Linear;}
this.Pasos.push(nPaso);}
this._PasoOrig=this.Pasos[this._PosPasos-1];this._PasoDest=this.Pasos[this._PosPasos];this._Retraso=this._PasoDest.Retraso;for(var Indice in this._PasoOrig.Paso){this[Indice]=this._PasoOrig.Paso[Indice];}
this.Iniciar=function(){var AniCreada=false;for(var i=0;i<this._Padre.Animaciones.length;i++){if(this._Padre.Animaciones[i]===this){AniCreada=true;break;}}
if(AniCreada===false){this._Padre.Animaciones.push(this);this._PosPasos=1;this._PasoOrig=this.Pasos[this._PosPasos-1];this._PasoDest=this.Pasos[this._PosPasos];this._Retraso=this._PasoDest.Retraso;this._UltimoTick=0;this._Avance=0;for(var i=0;i<this._PasosIniciales.length;i++){for(var Valor in this._PasosIniciales[i].Paso){if(this._PasosIniciales[i].Paso[Valor]instanceof ObjetoAnimacion_Rand){this.Pasos[i].Paso[Valor]=this._PasosIniciales[i].Paso[Valor].Iniciar();}}}
this._Opciones.FuncionIniciado();}
this._Terminado=false;};this.AsignarValoresIniciales=function(){this._Opciones.FuncionActualizar(this);};this.Transicion=function(){this._Invertido=!this._Invertido;var AniCreada=false;for(var i=0;i<this._Padre.Animaciones.length;i++){if(this._Padre.Animaciones[i]===this){AniCreada=true;break;}}
if(AniCreada===false){this._Padre.Animaciones.push(this);if(this._Invertido===false){this._PosPasos=1;this._PasoOrig=this.Pasos[this._PosPasos-1];this._PasoDest=this.Pasos[this._PosPasos];this._Retraso=this._PasoDest.Retraso;}
else{this._PosPasos=this.Pasos.length-1;this._PasoOrig=this.Pasos[this._PosPasos];this._PasoDest=this.Pasos[this._PosPasos-1];this._Retraso=this._PasoOrig.Retraso;}
this._Avance=0;this._UltimoTick=0;}
else{var PasoD=this._PasoDest;var PasoO=this._PasoOrig;this._PasoDest=PasoO;this._PasoOrig=PasoD;var Avance=Math.abs(this._Avance-1);this._Avance=Avance;var FuncionTiempo=this._PasoDest.FuncionTiempo(this._Avance);for(var Indice in this._PasoOrig.Paso){this[Indice]=PasoO[Indice]-(PasoO[Indice]-PasoD[Indice])*FuncionTiempo;}}
this._Terminado=false;};this.Cancelar=function(){this._Opciones.FuncionIniciado();this._Opciones.FuncionTerminado();this._Terminado=true;};this.Terminar=function(){for(var i=0;i<this.Pasos.length;i++){this.Pasos.forEach(function(Valor,Indice,Array){if(Valor instanceof ObjetoAnimacion_Rand){this.Pasos[Indice]=Valor.Max;}});}
this._Opciones.FuncionIniciado();this._Opciones.FuncionTerminado();this._Terminado=true;for(var Indice in this.Pasos[this.Pasos.length-1].Paso){this[Indice]=this.Pasos[this.Pasos.length-1].Paso[Indice];}
this._Opciones.FuncionActualizar(this);};this.Actualizar=function(t){if(this._Terminado===true){return true;}
var Ret=0;if(this._UltimoTick!==0){(this._Invertido===false)?Ret=this.ActualizarNormal(t):Ret=this.ActualizarInvertido(t);}
this._UltimoTick=t;return Ret;};this.ActualizarNormal=function(t){var TiempoFrame=t-this._UltimoTick;if(this._Retraso>0){this._Retraso=this._Retraso-TiempoFrame;}
else{this._Avance+=(TiempoFrame/this._PasoDest.Tiempo);var FuncionTiempo=this._PasoDest.FuncionTiempo(this._Avance);if(this._Avance<1&&this._Avance>-1){for(var Indice in this._PasoDest.Paso){this[Indice]=this._PasoOrig.Paso[Indice]-(this._PasoOrig.Paso[Indice]-this._PasoDest.Paso[Indice])*FuncionTiempo;}
this._Opciones.FuncionActualizar(this);}
else{for(var Indice in this._PasoDest.Paso){this[Indice]=this._PasoDest.Paso[Indice];}
this._Opciones.FuncionActualizar(this);this._PosPasos++;if(this._PosPasos<this.Pasos.length){this._PasoOrig=this.Pasos[this._PosPasos-1];this._PasoDest=this.Pasos[this._PosPasos];this._Retraso=this._PasoDest.Retraso;this._Avance=0;}
else{if(this._Opciones.Invertir===false){if(this._Opciones.Repetir<=0){this._Opciones.FuncionTerminado();this._Terminado=true;}
else{this._Opciones.Repetir--;this._PosPasos=1;this._PasoOrig=this.Pasos[this._PosPasos-1];this._PasoDest=this.Pasos[this._PosPasos];this._Retraso=this._PasoDest.Retraso;this._Avance=0;}}
else{this._PosPasos=this.Pasos.length-1;this._PasoOrig=this.Pasos[this._PosPasos];this._PasoDest=this.Pasos[this._PosPasos-1];this._Retraso=this._PasoOrig.Retraso;this._Avance=0;this._Invertido=true;}}}}
return this._Terminado;};this.ActualizarInvertido=function(t){var TiempoFrame=t-this._UltimoTick;this._Avance+=(TiempoFrame/this._PasoOrig.Tiempo);var FuncionTiempo=this._PasoDest.FuncionTiempo(this._Avance);if(this._Avance<1&&this._Avance>-1){for(var Indice in this._PasoDest.Paso){this[Indice]=this._PasoOrig.Paso[Indice]-(this._PasoOrig.Paso[Indice]-this._PasoDest.Paso[Indice])*FuncionTiempo;}
this._Opciones.FuncionActualizar(this);}
else{if(this._Retraso>0){this._Retraso=this._Retraso-TiempoFrame;}
else{for(var Indice in this._PasoDest.Paso){this[Indice]=this._PasoDest.Paso[Indice];}
this._Opciones.FuncionActualizar(this);this._PosPasos--;if(this._PosPasos>0){this._PasoOrig=this.Pasos[this._PosPasos];this._PasoDest=this.Pasos[this._PosPasos-1];this._Retraso=this._PasoOrig.Retraso;this._Avance=0;}
else{if(this._Opciones.Invertir===true){this._Invertido=false;}
if(this._Opciones.Repetir===0){this._Opciones.FuncionTerminado();this._Terminado=true;}
else{this._Opciones.Repetir--;this._PosPasos=1;this._PasoOrig=this.Pasos[this._PosPasos-1];this._PasoDest=this.Pasos[this._PosPasos];this._Avance=0;this._Retraso=this._PasoOrig.Retraso;}}}}
this._UltimoTick=t;return this._Terminado;};};var ObjetoAnimacion_Rand=function(Max,Min){this.Min=Min;this.Max=Max;this.Iniciar=function(){this.Valor=Rand(Max,Min);return this.Valor;};};
var Banner_Espacio2D=function(){if(ObjetoCanvas.call(this,{'Tipo':'2d','Ancho':'Auto','Alto':'Auto','Entorno':'Banner','MostrarFPS':true,'ElementoRaiz':document.body,'CapturaEjemplo':"Canvas2D_1.png"})===false){return false;}
this.Iniciar();this.Cargando(false);};Banner_Espacio2D.prototype=Object.assign(Object.create(ObjetoCanvas.prototype),{constructor:Banner_Espacio2D,Nombre:"Espacio 2D",IdeaOriginal:"devildrey33",URL:"https://devildrey33.es/Blog/Canvas2D_1",NombreURL:"Tutorial HTML5 Canvas2D parte 1",Iniciar:function(){this.Estrellas=[];this.TotalEstrellas=((this.Ancho*this.Alto)/250);for(var i=0;i<this.TotalEstrellas;i++){var Vel=Rand(5)+0.5;var Col=199+Math.floor(Vel*10);this.Estrellas[i]=new this.Estrella(RandInt(this.Ancho),RandInt(this.Alto),Vel,"rgb("+Col+","+Col+","+Col+")");}},Redimensionar:function(){},Scroll:function(){},Pintar:function(){this.Context.fillStyle='rgba(49, 46, 53, 0.4)';this.Context.fillRect(0,0,this.Ancho,this.Alto);for(i=0;i<this.TotalEstrellas;i++){this.Estrellas[i].X-=this.Estrellas[i].Velocidad;if(this.Estrellas[i].X<0){var Vel=Rand(5)+0.5;var Col=199+Math.floor(Vel*10);this.Estrellas[i]=new this.Estrella(this.Ancho,RandInt(this.Alto),Vel,"rgb("+Col+","+Col+","+Col+")");}
this.Context.fillStyle=this.Estrellas[i].Color;this.Context.fillRect(this.Estrellas[i].X,this.Estrellas[i].Y,1,1);}},Estrella:function(X,Y,Velocidad,Color){this.X=X;this.Y=Y;this.Velocidad=Velocidad;this.Color=Color;}});
var Banner_MatrixLluviaHexadecimal=function(){if(ObjetoCanvas.call(this,{'Tipo':'2d','Ancho':'Auto','Alto':'Auto','Entorno':'Banner','MostrarFPS':true,'ElementoRaiz':document.body})===false){return false;}
this.Iniciar();this.Cargando(false);};Banner_MatrixLluviaHexadecimal.prototype=Object.assign(Object.create(ObjetoCanvas.prototype),{constructor:Banner_MatrixLluviaHexadecimal,Nombre:"Matrix lluvia hexadecimal",IdeaOriginal:"thecodeplayer",URL:"https://thecodeplayer.com/walkthrough/matrix-rain-animation-html5-canvas-javascript",NombreURL:"Matrix rain animation",Iniciar:function(){this.Caracteres=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"];this.Columnas=[];this.TamFuente=10;this.NoPintar=false;this.Columnas=[];var Cols=this.Ancho/this.TamFuente;for(var i=0;i<Cols;i++){this.Columnas[i]=1;}},Redimensionar:function(){},Scroll:function(){},Pintar:function(){this.NoPintar=!this.NoPintar;if(this.NoPintar===true)return;this.Context.fillStyle="rgba(49, 46, 53, 0.05)";this.Context.fillRect(0,0,this.Ancho,this.Alto);this.Context.fillStyle="#00FF00";this.Context.font=this.TamFuente+"px arial";for(var i=0;i<this.Columnas.length;i++){var Char=this.Caracteres[RandInt(this.Caracteres.length)];this.Context.fillText(Char,i*this.TamFuente,this.Columnas[i]*this.TamFuente);if(this.Columnas[i]*this.TamFuente>this.Alto&&Rand()>0.975){this.Columnas[i]=0;}
this.Columnas[i]+=1;}}});
var Banner_AdiestramientoCubos3D=function(){if(ObjetoCanvas.call(this,{'Tipo':'THREE','Ancho':'Auto','Alto':'Auto','Entorno':'Banner','MostrarFPS':true,'ElementoRaiz':document.body})===false){return false;}
this.Iniciar();this.Cargando(false);};Banner_AdiestramientoCubos3D.prototype=Object.assign(Object.create(ObjetoCanvas.prototype),{constructor:Banner_AdiestramientoCubos3D,Nombre:"Adiestramiento de cubos",IdeaOriginal:"devildrey33",URL:"/Lab/Ejemplos/BannerTest/AdiestramientoCubos.html",NombreURL:"Lab : Adiestramiento de cubos",AnimacionCamara:{Rad:0,RadAvance:0,MinRadAvance:-0.005,MaxRadAvance:0.005,RadAvancePositivo:true,Distancia:1900,MinDistancia:1600,MaxDistancia:3100,DistanciaAvance:0.1,MinDistanciaAvance:-3,MaxDistanciaAvance:3,DistanciaAvancePositivo:true},Iniciar:function(){this.TamCubo=0;this.Escena=new THREE.Scene();this.Camara=new THREE.PerspectiveCamera(45,this.Ancho/this.Alto,0.5,10000);this.Camara.position.set(0,2000,2000);this.Escena.add(this.Camara);this.TipoAni=0;this.CharAni=0;var Divisiones=7;var Tam=1000;this.TamCubo=(Tam/(Divisiones/2));this.YBase=(this.TamCubo/2)+this.TamCubo;this.Parrilla=new THREE.GridHelper(Tam*2,Divisiones,new THREE.Color(0xcccccc),new THREE.Color(0x999999));this.Parrilla.position.y=this.TamCubo;this.GrupoCubos=new THREE.Object3D();this.GrupoCubos.add(this.Parrilla);t=this.TamCubo*0.7;var geometry=new THREE.BoxGeometry(t,t,t);for(var z=-(Divisiones/2);z<(Divisiones/2);z++){for(var x=-(Divisiones/2);x<(Divisiones/2);x++){var Grupo=new THREE.Object3D();var Cubo=new THREE.Mesh(geometry,new THREE.MeshBasicMaterial({color:"rgb(0,50,0)",}));Grupo.Ani=new this.AniColumna(1,1,0);Grupo.add(Cubo);Grupo.position.set((x*this.TamCubo)+(this.TamCubo/2),this.YBase,(z*this.TamCubo)+(this.TamCubo/2));this.CrearMarcoCubo(Grupo,t);this.GrupoCubos.add(Grupo);}}
this.RandAni();this.Escena.add(this.GrupoCubos);var pointLight=new THREE.PointLight(0xFF0000);pointLight.position.set(0,10,0);this.Escena.add(pointLight);},AvanceCamara:function(){if(Rand()<0.01){if(Rand()>0.5){this.AnimacionCamara.RadAvancePositivo=!this.AnimacionCamara.RadAvancePositivo;}
else{this.AnimacionCamara.DistanciaAvancePositivo=!this.AnimacionCamara.DistanciaAvancePositivo;}}
if(this.AnimacionCamara.RadAvancePositivo===true){if(this.AnimacionCamara.RadAvance<this.AnimacionCamara.MaxRadAvance){this.AnimacionCamara.RadAvance+=0.0001;}}
else{if(this.AnimacionCamara.RadAvance>this.AnimacionCamara.MinRadAvance){this.AnimacionCamara.RadAvance-=0.0001;}}
this.AnimacionCamara.Rad+=this.AnimacionCamara.RadAvance;if(this.AnimacionCamara.DistanciaAvancePositivo===true){if(this.AnimacionCamara.DistanciaAvance<this.AnimacionCamara.MaxDistanciaAvance){this.AnimacionCamara.DistanciaAvance+=0.1;}}
else{if(this.AnimacionCamara.DistanciaAvance>this.AnimacionCamara.MinDistanciaAvance){this.AnimacionCamara.DistanciaAvance-=0.1;}}
this.AnimacionCamara.Distancia+=this.AnimacionCamara.DistanciaAvance;if(this.AnimacionCamara.Distancia>this.AnimacionCamara.MaxDistancia){this.AnimacionCamara.Distancia=this.AnimacionCamara.MaxDistancia;}
if(this.AnimacionCamara.Distancia<this.AnimacionCamara.MinDistancia){this.AnimacionCamara.Distancia=this.AnimacionCamara.MinDistancia;}
this.Camara.position.x=this.AnimacionCamara.Distancia*Math.cos(this.AnimacionCamara.Rad);this.Camara.position.z=this.AnimacionCamara.Distancia*Math.sin(this.AnimacionCamara.Rad);this.Camara.lookAt(this.GrupoCubos.position);},Pintar:function(){this.AvanceCamara();var AniTerminada=true;for(var c=1;c<this.GrupoCubos.children.length;c++){var Cubo=this.GrupoCubos.children[c];if(Cubo.Ani.FaseAni===0){if(Cubo.Ani.Retardo<0){Cubo.Ani.Retardo+=16;}
else{if(Cubo.position.y<this.YBase+Cubo.Ani.MaxEscalaY){Cubo.position.y+=Cubo.Ani.Vel;}
else{Cubo.Ani.FaseAni=1;}}}
else if(Cubo.Ani.FaseAni===1){if(Cubo.position.y>this.YBase){Cubo.position.y-=Cubo.Ani.Vel;}
else{Cubo.Ani.FaseAni=2;}}
var col=Math.floor(50+((Cubo.position.y-this.YBase)*0.5));Cubo.children[0].material.color.setStyle("rgb(180, "+col+",0)");if(Cubo.Ani.FaseAni!==2){AniTerminada=false;}}
if(this.TipoAni===4&&AniTerminada===true){var texto="devildrey33";if(this.CharAni<texto.length-1){this.CharAni+=1;this.IniciarAni_Caracter(texto.substr(this.CharAni,1));AniTerminada=false;}
else{this.CharAni=0;}}
this.Context.render(this.Escena,this.Camara);if(AniTerminada===true){this.RandAni();}},CrearMarcoCubo:function(Objeto,Tam){var Grupo=new THREE.Object3D();var Med=Tam/2;var PuX=[];var PuY=[];var PuZ=[];PuX.push(new THREE.Vector3(-Med,0,0));PuX.push(new THREE.Vector3(Med,0,0));PuY.push(new THREE.Vector3(0,-Med,0));PuY.push(new THREE.Vector3(0,Med,0));PuZ.push(new THREE.Vector3(0,0,-Med));PuZ.push(new THREE.Vector3(0,0,Med));GeoX=new THREE.BufferGeometry().setFromPoints(PuX);GeoY=new THREE.BufferGeometry().setFromPoints(PuY);GeoZ=new THREE.BufferGeometry().setFromPoints(PuZ);Grupo.Material=new THREE.LineBasicMaterial({color:0x333333,opacity:.2,linewidth:.1});var Linea1=new THREE.Line(GeoX,Grupo.Material);var Linea2=new THREE.Line(GeoX,Grupo.Material);var Linea3=new THREE.Line(GeoY,Grupo.Material);var Linea4=new THREE.Line(GeoY,Grupo.Material);Linea1.position.set(0,-Med,Med);Linea2.position.set(0,Med,Med);Linea3.position.set(Med,0,Med);Linea4.position.set(-Med,0,Med);Grupo.add(Linea1);Grupo.add(Linea2);Grupo.add(Linea3);Grupo.add(Linea4);var Linea5=new THREE.Line(GeoX,Grupo.Material);var Linea6=new THREE.Line(GeoX,Grupo.Material);var Linea7=new THREE.Line(GeoY,Grupo.Material);var Linea8=new THREE.Line(GeoY,Grupo.Material);Linea5.position.set(0,-Med,-Med);Linea6.position.set(0,Med,-Med);Linea7.position.set(Med,0,-Med);Linea8.position.set(-Med,0,-Med);Grupo.add(Linea5);Grupo.add(Linea6);Grupo.add(Linea7);Grupo.add(Linea8);var Linea9=new THREE.Line(GeoZ,Grupo.Material);var Linea10=new THREE.Line(GeoZ,Grupo.Material);Linea9.position.set(-Med,Med,0);Linea10.position.set(Med,Med,0);Grupo.add(Linea9);Grupo.add(Linea10);var Linea11=new THREE.Line(GeoZ,Grupo.Material);var Linea12=new THREE.Line(GeoZ,Grupo.Material);Linea11.position.set(-Med,-Med,0);Linea12.position.set(Med,-Med,0);Grupo.add(Linea9);Grupo.add(Linea10);Objeto.add(Grupo);},IniciarAni_Caracter:function(Char){var ColumnasLado=Math.sqrt(this.GrupoCubos.children.length-1);var Inicio=Math.floor((ColumnasLado-5)/2);var cc=0;for(var z=Inicio;z<ColumnasLado-Inicio;z++){for(var x=Inicio;x<ColumnasLado-Inicio;x++){var PosMarcador=1+((z*ColumnasLado)+x);var PosLetra=((z-Inicio)*(ColumnasLado-(Inicio*2)))+(x-Inicio);if(this.Letras5x5[Char][PosLetra]==="x"){this.GrupoCubos.children[PosMarcador].Ani=new this.AniColumna(300,20,0);}
else{this.GrupoCubos.children[PosMarcador].Ani=new this.AniColumna(1,1,0);}}}},IniciarAni_Texto:function(){this.CharAni=0;this.IniciarAni_Caracter('d');},IniciarAni_Filas:function(){var ColumnasLado=Math.sqrt(this.GrupoCubos.children.length-1);var Invertir=false;var rnd=Rand();for(var z=0;z<ColumnasLado;z++){Invertir=!Invertir;for(var x=0;x<ColumnasLado;x++){var Pos=1+((rnd>0.5)?((z*ColumnasLado)+x):((x*ColumnasLado)+z));this.GrupoCubos.children[Pos].Ani=new this.AniColumna(300,15,((Invertir===true)?x*80:(ColumnasLado-x)*80));}}},IniciarAni_Rand:function(){for(var c=1;c<this.GrupoCubos.children.length;c++){this.GrupoCubos.children[c].Ani=new this.AniColumna(Rand(300,100),Rand(15,20),RandInt(500));}},IniciarAni_Ola:function(){var rnd=Rand();var rnd2=Rand();var ColumnasLado=Math.sqrt(this.GrupoCubos.children.length-1);var pos=0;for(var z=0;z<ColumnasLado;z++){for(var x=0;x<ColumnasLado;x++,pos++){var Pos=1+((rnd2>0.5)?((z*ColumnasLado)+x):((x*ColumnasLado)+z));this.GrupoCubos.children[Pos].Ani=new this.AniColumna(Rand(300,250),15,((rnd>0.5)?pos*20:(this.GrupoCubos.children.length-pos)*20));}}},IniciarAni_OlaCentrada:function(){var rnd=Rand();var ColumnasLado=Math.sqrt(this.GrupoCubos.children.length-1);var Max=Math.floor((this.GrupoCubos.children.length-1)/2);this.GrupoCubos.children[this.GrupoCubos.children.length-1].Ani=new this.AniColumna(Rand(300,250),15,Max*20);for(var c=0;c<Max+1;c++){this.GrupoCubos.children[(Max+c)].Ani=new this.AniColumna(Rand(300,250),15,c*20);this.GrupoCubos.children[(Max-c)+1].Ani=new this.AniColumna(Rand(300,250),15,c*20);}},RandAni:function(){if(this.TipoAni!==4){this.TipoAni=RandInt(5);}
else{this.TipoAni=RandInt(4);}
if(this.TipoAni===0){this.IniciarAni_Rand();}
else if(this.TipoAni===1){this.IniciarAni_Ola();}
else if(this.TipoAni===2){this.IniciarAni_OlaCentrada();}
else if(this.TipoAni===3){this.IniciarAni_Filas();}
else if(this.TipoAni===4){(Rand()>0.3)?this.RandAni():this.IniciarAni_Texto();}},AniColumna:function(nMaxEscalaY,nVel,nRetardo){this.MaxEscalaY=nMaxEscalaY;this.Vel=nVel;this.Retardo=-nRetardo;this.FaseAni=0;},Letras5x5:{"d":[" ","x","x"," "," "," ","x"," ","x"," "," ","x"," ","x"," "," ","x"," ","x"," "," ","x","x"," "," "],"e":[" ","x","x","x"," "," ","x"," "," "," "," ","x","x"," "," "," ","x"," "," "," "," ","x","x","x"," "],"v":["x"," "," "," ","x","x"," "," "," ","x"," ","x"," ","x"," "," ","x"," ","x"," "," "," ","x"," "," "],"i":[" ","x","x","x"," "," "," ","x"," "," "," "," ","x"," "," "," "," ","x"," "," "," ","x","x","x"," "],"l":[" ","x"," "," "," "," ","x"," "," "," "," ","x"," "," "," "," ","x"," "," "," "," ","x","x","x"," "],"r":[" ","x","x"," "," "," ","x"," ","x"," "," ","x","x"," "," "," ","x"," ","x"," "," ","x"," ","x"," "],"y":[" ","x"," ","x"," "," ","x"," ","x"," "," "," ","x"," "," "," "," ","x"," "," "," "," ","x"," "," "],"3":[" ","x","x","x"," "," "," "," ","x"," "," "," ","x","x"," "," "," "," ","x"," "," ","x","x","x"," "]}});
var Banner_WormHole=function(){if(ObjetoCanvas.call(this,{'Tipo':'THREE','Ancho':'Auto','Alto':'Auto','Entorno':'Banner','MostrarFPS':true,'ElementoRaiz':document.body})===false){return false;}
this.Iniciar();};Banner_WormHole.prototype=Object.assign(Object.create(ObjetoCanvas.prototype),{constructor:Banner_WormHole,Nombre:"WormHole",IdeaOriginal:"devildrey33",URL:"/Lab/Ejemplos/BannerTest/WormHole.html",NombreURL:"Lab : WormHole",Iniciar:function(){this.Escena=new THREE.Scene();this.Camara=new THREE.PerspectiveCamera(75,this.Ancho/this.Alto,0.5,1000);this.Camara.position.set(0,(((this.Alto/2)-240)*0.20),500);this.Escena.add(this.Camara);this.H=0;this.H2=0.05;this.TexturasCargadas=0;this.TotalTexturas=2;this.Tunel=[];this.Textura=[];var T1=new THREE.TextureLoader().load('/Web/Graficos/Banner_WormHole11.jpg',this.TexturaCargada.bind(this,0));var T2=new THREE.TextureLoader().load('/Web/Graficos/Banner_WormHole1.2.jpg',this.TexturaCargada.bind(this,1));this.Camara.lookAt(this.Escena.position);},TexturaCargada:function(Num,Textura){Textura.wrapT=Textura.wrapS=THREE.RepeatWrapping;Textura.repeat.set(1,2);this.Tunel[Num]=new THREE.Mesh(new THREE.CylinderGeometry((Num*10)+50,(Num*10)+50,1000,16,32,true),new THREE.MeshBasicMaterial({color:0x666666,transparent:true,alphaMap:Textura,side:THREE.BackSide,opacity:(Num===0)?0.3:1}));this.Tunel[Num].rotation.x=90*(Math.PI/180);this.Tunel[Num].position.z=128-Num;this.Escena.add(this.Tunel[Num]);this.Textura[Num]=Textura;this.TexturasCargadas++;if(this.TexturasCargadas===this.TotalTexturas){this.Cargando(false);}},MouseMove:function(X,Y){},Pintar:function(){if(typeof(this.Tunel[0])!=='undefined'){this.H+=0.001;if(this.H>1){this.H=0;}
this.Tunel[0].material.color.setHSL(this.H,0.7,0.7);this.Tunel[0].rotation.y+=0.02;this.Textura[0].offset.y-=0.014;}
if(typeof(this.Tunel[1])!=='undefined'){this.H2+=0.001;if(this.H2>1){this.H2=0;}
this.Tunel[1].material.color.setHSL(this.H2,0.7,0.7);this.Tunel[1].rotation.y-=0.017;this.Textura[1].offset.y-=0.019;}
this.Context.render(this.Escena,this.Camara);}});
var Banner_Sinusoidal=function(){if(ObjetoCanvas.call(this,{'Tipo':'2d','Ancho':'Auto','Alto':'Auto','Entorno':'Banner','MostrarFPS':true,'ElementoRaiz':document.body})===false){return false;}
this.Reiniciar();this.Cargando(false);};Banner_Sinusoidal.prototype=Object.assign(Object.create(ObjetoCanvas.prototype),{constructor:Banner_Sinusoidal,Nombre:"Onda Sinusoidal",IdeaOriginal:"devildrey33",URL:"/Lab/Ejemplos/BannerTest/Sinusoidal.html",NombreURL:"Lab : Sinusoidal",Avance2:0,Redimensionar:function(){this.Reiniciar();},Scroll:function(){},MouseMove:function(Evento){},MouseEnter:function(Evento){},MouseLeave:function(Evento){},Circulos:[],CrearCirculos:function(ArrayCirculos){var TotalCirculos=RandInt(7,4);this.Circulos=[];if(typeof(ArrayCirculos)==="undefined"){var cAlpha=1-(TotalCirculos/10);for(var i=0;i<TotalCirculos;i++){this.Circulos.push(new this.Circulo(RandInt((this.Alto/TotalCirculos)-2,15),"rgb("+Math.floor(234*cAlpha)+","+Math.floor(80*cAlpha)+","+Math.floor(78*cAlpha)+")","rgb(180, 180, 180)"));cAlpha+=0.1;}}
else{var cAlpha=1-(ArrayCirculos.length/10);for(var i=0;i<ArrayCirculos.length;i++){this.Circulos.push(new this.Circulo(ArrayCirculos[i],"rgb("+Math.floor(234*cAlpha)+","+Math.floor(80*cAlpha)+","+Math.floor(78*cAlpha)+")","rgb(180, 180, 180)"));cAlpha+=0.1;}}
this.Circulos[0].X=this.PosXCirculoCentral;this.Circulos[0].Y=this.Alto/2;this.Circulos[this.Circulos.length-1].Color="rgb(234, 80, 78)";},Circulo:function(Tam,Color,ColorPunto){this.Tam=Tam;this.X=0;this.Y=0;this.Color=Color;this.ColorPunto=ColorPunto;this.Avance=function(Avance,CirculoPadre){this.X=CirculoPadre.X+(Math.cos(Avance)*(CirculoPadre.Tam));this.Y=CirculoPadre.Y+(Math.sin(Avance)*(CirculoPadre.Tam));};},Reiniciar:function(){this.DegradadoTranslucido_Ancho=this.Ancho/8;this.AnchoGrafico=this.Ancho-400;this.PosXCirculoCentral=this.Ancho-200;this.Color="rgb(234, 80, 78)";this.ColorPuntos="rgb(255, 155, 155)";this.DegradadoTranslucido=this.Context.createLinearGradient(0,0,this.DegradadoTranslucido_Ancho,0);this.DegradadoTranslucido.addColorStop(0,"rgba(49, 46, 53, 1)");this.DegradadoTranslucido.addColorStop(1,"rgba(49, 46, 53, 0)");if(Rand()>0.5){this.Velocidad=(Math.PI*2)/180;}
else{this.Velocidad=-((Math.PI*2)/180);}
this.CrearCirculos();this.ImgOnda=new BufferCanvas((this.AnchoGrafico)+360,this.Alto);this.ImgOnda.Context.strokeStyle=this.Color;this.DiametroCirculo=this.ImgOnda.Alto/5;this.ImgOnda.Context.lineWidth=2;this.ImgOnda.Context.beginPath();this.ImgOnda.Context.moveTo(0,this.ImgOnda.Alto/2);var Avance=0;for(var x=0;x<=(this.AnchoGrafico)+360;x++){Avance+=this.Velocidad;for(var i=1;i<this.Circulos.length;i++){this.Circulos[i].Avance(Avance*i,this.Circulos[i-1]);}
this.ImgOnda.Context.lineTo(x,this.Circulos[this.Circulos.length-1].Y);}
this.ImgOnda.Context.stroke();this.Avance=-Math.floor(this.AnchoGrafico);this.Avance2=0;},Pintar:function(){this.Context.fillStyle="rgba(49, 46, 53, 0.95)";this.Context.fillRect(0,0,this.Ancho,this.Alto);this.Context.strokeStyle="rgb(80, 80, 80)";this.Context.setLineDash([2.5]);this.Context.beginPath();this.Context.moveTo(115,this.Alto/2);this.Context.lineTo(this.PosXCirculoCentral+115,this.Alto/2);this.Context.stroke();this.Context.beginPath();this.Context.moveTo(this.PosXCirculoCentral,(this.Alto/2)-115);this.Context.lineTo(this.PosXCirculoCentral,(this.Alto/2)+115);this.Context.stroke();this.Context.setLineDash([1,0]);this.Avance+=1;if(this.Avance>=360)this.Avance=0;this.Context.drawImage(this.ImgOnda.Canvas,this.Avance,0,this.AnchoGrafico,this.Alto,0,0,this.AnchoGrafico,this.Alto);this.Avance2+=this.Velocidad;this.Context.lineWidth=3;this.Context.fillStyle=this.ColorPunto;for(var i=0;i<this.Circulos.length;i++){this.Context.strokeStyle=this.Circulos[i].Color;this.Context.fillStyle=this.Circulos[i].ColorPunto;if(i!==0){this.Circulos[i].Avance(this.Avance2*i,this.Circulos[i-1]);this.Context.beginPath();this.Context.arc(this.Circulos[i].X,this.Circulos[i].Y,2,0,2*Math.PI);this.Context.fill();}
if(i!==this.Circulos.length-1){this.Context.beginPath();this.Context.arc(this.Circulos[i].X,this.Circulos[i].Y,this.Circulos[i].Tam,0,2*Math.PI);this.Context.stroke();}}
this.Context.lineWidth=2;this.Context.strokeStyle="rgba(225,125,125, 0.5)";this.Context.beginPath();this.Context.moveTo(this.Circulos[i-1].X,this.Circulos[i-1].Y);this.Context.lineTo(this.AnchoGrafico,this.Circulos[i-1].Y);this.Context.stroke();this.Context.fillStyle="white";this.Context.beginPath();this.Context.arc(this.AnchoGrafico,this.Circulos[i-1].Y,2.5,0,2*Math.PI);this.Context.fill();this.Context.fillStyle=this.DegradadoTranslucido;this.Context.fillRect(0,0,this.DegradadoTranslucido_Ancho,this.Alto);}});
var Banner_GeometriaBasica=function(){if(ObjetoCanvas.call(this,{'Tipo':'2d','Ancho':'Auto','Alto':'Auto','Entorno':'Banner','MostrarFPS':true,'ElementoRaiz':document.body,'CapturaEjemplo':"GeometriaBasica.png"})===false){return false;}
this.Iniciar();this.Cargando(false);};Banner_GeometriaBasica.prototype=Object.assign(Object.create(ObjetoCanvas.prototype),{constructor:Banner_GeometriaBasica,Nombre:"Geometría básica",IdeaOriginal:"devildrey33",URL:"/Lab/Ejemplos/BannerTest/GeometriaBasica.html",NombreURL:"Lab : GeometriaBasica",Redimensionar:function(){},Scroll:function(){},MouseMove:function(Evento){this.Mouse={X:Evento.clientX,Y:Evento.clientY};},MousePresionado:function(Evento){},MouseSoltado:function(Evento){},MouseEnter:function(Evento){},MouseLeave:function(Evento){},TeclaPresionada:function(Evento){},TeclaSoltada:function(Evento){},TotalFiguras:150,Figuras:[],Figura:function(Ancho,Alto){this.X=Rand(Ancho,0);this.Y=Alto+50;this.Tam=Rand(15,35);this.Velocidad=Rand(2,0.02);this.Tipo=RandInt(3,0);this.Opacidad=1;this.VelocidadOpacidad=Rand(0.007,0.0009);this.Rotacion=0;this.VelocidadRotacion=Rand(0.05,-0.05);this.Angulo=Rand(Math.PI*2,0);this.Avance=function(MouseX,MouseY,Ancho){this.Rotacion+=this.VelocidadRotacion;this.Opacidad-=this.VelocidadOpacidad;this.X+=Math.cos(this.Angulo)*this.Velocidad;this.Y+=Math.sin(this.Angulo)*this.Velocidad;if(this.Opacidad<0||this.Y<-this.Tam||this.X>Ancho+this.Tam||this.X<-this.Tam){return false;}
return true;};},Iniciar:function(){this.Mouse={X:this.Ancho/2,Y:this.Alto/2};for(var i=0;i<this.TotalFiguras;i++){this.Figuras[i]=new this.Figura(this.Ancho,this.Alto);}},PintarCuadrado:function(X,Y,Tam,Rotacion){this.Context.save();this.Context.translate(X,Y);this.Context.rotate(Rotacion);this.Context.fillRect(-Tam/2,-Tam/2,Tam,Tam);this.Context.restore();},PintarTriangulo:function(X,Y,Tam,Rotacion){this.Context.save();this.Context.translate(X,Y);this.Context.rotate(Rotacion);this.Context.moveTo(0,(Tam)*0.66);this.Context.lineTo(Tam,-Tam);this.Context.lineTo(-Tam,-Tam);this.Context.closePath();this.Context.fill();this.Context.restore();},Pintar:function(){this.Context.fillStyle='rgb(49, 46, 53)';this.Context.fillRect(0,0,this.Ancho,this.Alto);for(var i=this.Figuras.length-1;i>0;i--){if(this.Figuras[i].Avance(this.Mouse.X,this.Mouse.Y,this.Ancho)===false){this.Figuras[i]=new this.Figura(this.Ancho,this.Alto);}
this.Context.fillStyle='rgba(255, 46, 53, '+this.Figuras[i].Opacidad+' )';this.Context.beginPath();if(this.Figuras[i].Tipo===0){this.PintarCuadrado(this.Figuras[i].X,this.Figuras[i].Y,this.Figuras[i].Tam,this.Figuras[i].Rotacion);}
else if(this.Figuras[i].Tipo===1){this.Context.arc(this.Figuras[i].X,this.Figuras[i].Y,this.Figuras[i].Tam,0,Math.PI*2);}
else if(this.Figuras[i].Tipo===2){this.PintarTriangulo(this.Figuras[i].X,this.Figuras[i].Y,this.Figuras[i].Tam,this.Figuras[i].Rotacion);}
this.Context.fill();}}});
var Banner_EsferaVShader=function(){if(ObjetoCanvas.call(this,{'Tipo':'THREE','Ancho':'Auto','Alto':'Auto','Entorno':'Banner','MostrarFPS':true,'ElementoRaiz':document.body})===false){return false;}
this.Iniciar();this.Cargando(false);};Banner_EsferaVShader.prototype=Object.assign(Object.create(ObjetoCanvas.prototype),{constructor:Banner_EsferaVShader,Nombre:"Esfera (Vertex Shader)",IdeaOriginal:"devildrey33",URL:"/Lab/Ejemplos/BannerTest/EsferaVShader.html",NombreURL:"Lab : EsferaVShader",Redimensionar:function(){},Scroll:function(){},MouseMove:function(Evento){},MousePresionado:function(Evento){},MouseSoltado:function(Evento){},MouseEnter:function(Evento){this.Uniforms.MouseDentro.value=true;},MouseLeave:function(Evento){this.Uniforms.MouseDentro.value=false;},TeclaPresionada:function(Evento){},TeclaSoltada:function(Evento){},Iniciar:function(){this.Tiempo=Date.now();this.Escena=new THREE.Scene();this.Camara=new THREE.PerspectiveCamera(75,this.Ancho/this.Alto,0.5,10000);this.Camara.position.set(0,0,6);this.Escena.add(this.Camara);var geo=new THREE.SphereBufferGeometry(3,64,64);this.Uniforms={MouseDentro:{type:'bool',value:false},Color:{type:'vec3',value:new THREE.Color(0xFF4040)},Tiempo:{type:'1f',value:0}};var shaderMaterial=new THREE.ShaderMaterial({uniforms:this.Uniforms,vertexShader:this.Shaders.Vertex,fragmentShader:this.Shaders.Fragment,transparent:true,wireframe:true});var Esfera=new THREE.Mesh(geo,shaderMaterial);this.Escena.add(Esfera);this.Rotacion_Grados=0;this.Rotacion_Avance=0.005;this.Rotacion_Distancia=6;this.Camara.position.set(0,0,this.Rotacion_Distancia);},Pintar:function(){if(this.Uniforms.MouseDentro.value===false){if(this.Rotacion_Distancia<6){this.Rotacion_Distancia+=0.33;}}
else{if(this.Rotacion_Distancia>0){this.Rotacion_Distancia-=0.33;}}
var tiempo=Date.now();var delta=tiempo-this.Tiempo;this.Tiempo=tiempo;this.Uniforms.Tiempo.value+=delta/1000;this.Rotacion_Grados+=this.Rotacion_Avance;this.Camara.position.x=this.Rotacion_Distancia*Math.cos(this.Rotacion_Grados);this.Camara.position.z=this.Rotacion_Distancia*Math.sin(this.Rotacion_Grados);this.Camara.lookAt(this.Escena.position);this.Context.render(this.Escena,this.Camara);},Shaders:{'Vertex':["precision highp float;","uniform bool   MouseDentro;","uniform float  Tiempo;","//","vec3 mod289(vec3 x)        { return x - floor(x * (1.0 / 289.0)) * 289.0; }","vec4 mod289(vec4 x)        { return x - floor(x * (1.0 / 289.0)) * 289.0; }","vec4 permute(vec4 x)       { return mod289(((x*34.0)+1.0)*x); }","vec4 taylorInvSqrt(vec4 r) { return 1.79284291400159 - 0.85373472095314 * r; }","vec3 fade(vec3 t)          { return t*t*t*(t*(t*6.0-15.0)+10.0); }","// Classic Perlin noise","float cnoise(vec3 P) {","vec3 Pi0 = floor(P);","vec3 Pi1 = Pi0 + vec3(1.0);","Pi0 = mod289(Pi0);","Pi1 = mod289(Pi1);","vec3 Pf0 = fract(P);","vec3 Pf1 = Pf0 - vec3(1.0);","vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);","vec4 iy = vec4(Pi0.yy, Pi1.yy);","vec4 iz0 = Pi0.zzzz;","vec4 iz1 = Pi1.zzzz;","vec4 ixy = permute(permute(ix) + iy);","vec4 ixy0 = permute(ixy + iz0);","vec4 ixy1 = permute(ixy + iz1);","vec4 gx0 = ixy0 * (1.0 / 7.0);","vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;","gx0 = fract(gx0);","vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);","vec4 sz0 = step(gz0, vec4(0.0));","gx0 -= sz0 * (step(0.0, gx0) - 0.5);","gy0 -= sz0 * (step(0.0, gy0) - 0.5);","vec4 gx1 = ixy1 * (1.0 / 7.0);","vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;","gx1 = fract(gx1);","vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);","vec4 sz1 = step(gz1, vec4(0.0));","gx1 -= sz1 * (step(0.0, gx1) - 0.5);","gy1 -= sz1 * (step(0.0, gy1) - 0.5);","vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);","vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);","vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);","vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);","vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);","vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);","vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);","vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);","vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));","g000 *= norm0.x;","g010 *= norm0.y;","g100 *= norm0.z;","g110 *= norm0.w;","vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));","g001 *= norm1.x;","g011 *= norm1.y;","g101 *= norm1.z;","g111 *= norm1.w;","float n000 = dot(g000, Pf0);","float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));","float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));","float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));","float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));","float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));","float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));","float n111 = dot(g111, Pf1);","vec3 fade_xyz = fade(Pf0);","vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);","vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);","float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x);","return 2.2 * n_xyz;","}","void main() {","float Amplitud = (MouseDentro == false) ? 0.75 : 2.0;","float Frequencia = (MouseDentro == false) ? 0.43 : 1.0;","float Desplazamiento = Amplitud * cnoise(Frequencia * position + Tiempo);","vec3 newPosition = position + normal * Desplazamiento;","gl_Position = projectionMatrix * modelViewMatrix * vec4(newPosition, 1.0);","}"].join("\n"),'Fragment':["precision highp float;","uniform vec3    Color;","void main() {","gl_FragColor = vec4(Color, 1.0);","}"].join("\n")}});
var Banner_ReunionDeCirculos=function(){if(ObjetoCanvas.call(this,{'Tipo':'2d','Ancho':'Auto','Alto':'Auto','Entorno':'Banner','MostrarFPS':true,'ElementoRaiz':document.body})===false){return false;}
this.Iniciar();this.Cargando(false);};Banner_ReunionDeCirculos.prototype=Object.assign(Object.create(ObjetoCanvas.prototype),{constructor:Banner_ReunionDeCirculos,Redimensionar:function(){},Scroll:function(){},MouseMove:function(Evento){},MousePresionado:function(Evento){},MouseSoltado:function(Evento){},MouseEnter:function(Evento){},MouseLeave:function(Evento){},TeclaPresionada:function(Evento){},TeclaSoltada:function(Evento){},Nombre:"Reunión de circulos",IdeaOriginal:"devildrey33",URL:"/Lab/Ejemplos/BannerTest/ReunionDeCirculos.html",NombreURL:"Lab : Reunion de circulos",TotalCirculos:75,Circulos:[],Iniciar:function(){this.Circulos=[];this.Mouse={"X":this.Ancho/2,"Y":this.Alto/2,"Radio":10};},Circulo:function(Padre){this.Padre=Padre;this.Iniciar=function(){if(Rand()>0.5){this.X=Rand(this.Padre.Ancho);this.Y=(Rand()>0.5)?-10:this.Padre.Alto+10;}
else{this.X=(Rand()>0.5)?-10:this.Padre.Ancho+10;this.Y=Rand(this.Padre.Alto);}
this.Velocidad=Rand(8.0,4);this.Radio=Rand(2,5);this.ColorH=Math.abs(Math.sin(this.Padre.Tick/20000))*255;this.ColorA=0.6;this.Explotado=false;};this.Actualizar=function(){if(this.Explotado===false){var Angulo=Math.atan2(this.Y-this.Padre.Mouse.Y,this.X-this.Padre.Mouse.X)*180/Math.PI;this.X-=Math.cos(Angulo*(Math.PI/180))*this.Velocidad;this.Y-=Math.sin(Angulo*(Math.PI/180))*this.Velocidad;var dx=this.X-this.Padre.Mouse.X;var dy=this.Y-this.Padre.Mouse.Y;var Distancia=Math.sqrt(dx*dx+dy*dy);if(Distancia<this.Radio+this.Padre.Mouse.Radio){this.Explotar();}}
else{if(this.Radio<this.RadioExplosion&&this.ColorA>0){this.Radio+=0.66;this.ColorA-=0.01;}
else{this.Iniciar();}}
var Color='hsla('+this.ColorH+", 70%, 50%, "+this.ColorA+")";this.Padre.Context.beginPath();this.Padre.Context.strokeStyle=Color;this.Padre.Context.arc(this.X,this.Y,this.Radio,0,2*Math.PI,false);this.Padre.Context.stroke();};this.Explotar=function(){this.RadioExplosion=this.Radio*Rand(15,5);this.Explotado=true;};this.Iniciar();},Pintar:function(){if(this.Circulos.length<this.TotalCirculos){for(var i=0;i<10;i++){this.Circulos.push(new this.Circulo(this));}}
this.Context.fillStyle='rgba(49, 46, 53, 0.25)';this.Context.fillRect(0,0,this.Ancho,this.Alto);this.Context.globalCompositeOperation="lighter";for(var i=0;i<this.Circulos.length;i++){this.Circulos[i].Actualizar();}
this.Context.globalCompositeOperation="source-over";}});
var Banner_MultiCubo=function(){if(ObjetoCanvas.call(this,{'Tipo':'THREE','Ancho':'Auto','Alto':'Auto','Entorno':'Banner','MostrarFPS':true,'ElementoRaiz':document.body,'ColorFondo':0x888888})===false){return false;}
this.Iniciar();this.Cargando(false);};Banner_MultiCubo.prototype=Object.assign(Object.create(ObjetoCanvas.prototype),{constructor:Banner_MultiCubo,Nombre:"Multi Cubo",IdeaOriginal:"devildrey33",URL:"/Lab/Ejemplos/BannerTest/MultiCubo.html",NombreURL:"Lab : MultiCubo",Redimensionar:function(){},Scroll:function(){},MouseMove:function(Evento){},MousePresionado:function(Evento){},MouseSoltado:function(Evento){},MouseEnter:function(Evento){},MouseLeave:function(Evento){},TeclaPresionada:function(Evento){},TeclaSoltada:function(Evento){},Pausa:function(){this.Animaciones.Pausa();},Reanudar:function(){this.Animaciones.Reanudar();},Cubos:[],uAniRGC:0,Iniciar:function(){this.Animaciones=new ObjetoAnimacion;this.Context.shadowMap.enabled=true;this.Escena=new THREE.Scene();this.Camara=new THREE.PerspectiveCamera(75,this.Ancho/this.Alto,0.5,1000);this.Camara.Rotacion={Grados:45*(Math.PI/180),Avance:(Math.PI/180)/3,Distancia:50};this.Camara.position.set(0,0,this.Camara.Rotacion.Distancia);this.Camara.Rotar=function(Escena){this.Rotacion.Grados+=this.Rotacion.Avance;this.position.x=this.Rotacion.Distancia*Math.cos(this.Rotacion.Grados);this.position.z=this.Rotacion.Distancia*Math.sin(this.Rotacion.Grados);this.lookAt(Escena.position);};this.Escena.add(this.Camara);this.Camara.AniAvanceCamara=this.Animaciones.CrearAnimacion([{'Paso':{z:500,y:150}},{'Paso':{z:50,y:0},'Tiempo':1250,'FuncionTiempo':FuncionesTiempo.SinInOut}],{"Repetir":0,FuncionActualizar:function(Valores){this.Camara.position.y=Valores.y;this.Camara.Rotacion.Distancia=Valores.z;}.bind(this)}).Iniciar();this.Suelo=new THREE.Mesh(new THREE.PlaneGeometry(1000,1000),new THREE.MeshPhongMaterial({color:0x444444,specular:0xffffff}));this.Suelo.rotation.x=-Math.PI/2;this.Suelo.position.y=-20;this.Suelo.castShadow=false;this.Suelo.receiveShadow=true;this.Escena.add(this.Suelo);this.CrearLuces();this.CrearCubos();this.AnimarCubos();},CrearCubos:function(){for(var i=0;i<27;i++){var Cubo=new THREE.Mesh(new THREE.BoxGeometry(6.5,6.5,6.5),new THREE.MeshPhongMaterial({color:0x4e50ea,specular:0x3333AA,transparent:true,opacity:0.9,shininess:200}));Cubo.castShadow=true;Cubo.receiveShadow=true;Cubo.Numero=i;this.Cubos[i]=Cubo;this.Escena.add(this.Cubos[i]);}
var Contador=0;for(var z=10;z>=-10;z-=10){for(var y=10;y>=-10;y-=10){for(var x=-10;x<=10;x+=10){this.Cubos[Contador++].position.set(x,y,z);}}}},AnimarCubos:function(){if(Rand()>0.5){this.AnimacionRotarGrupoCubos();}
else{this.AnimacionRotarCubo();}},Aprox:function(Valor){if(Valor>5){return 10;}
else if(Valor<-5){return-10;}
else{return 0;}},AnimacionRotarGrupoCubos:function(){var Pos=RandInt(9,0);while(Pos===this.uAniRGC){Pos=RandInt(9,0);}
this.uAniRGC=Pos;if(this.GrupoCubos){for(var i=0;i<this.GrupoCubos.children.length;i++){var vector=new THREE.Vector3();vector.setFromMatrixPosition(this.GrupoCubos.children[i].matrixWorld);this.Cubos[this.GrupoCubos.children[i].Numero].position.set(this.Aprox(vector.x),this.Aprox(vector.y),this.Aprox(vector.z));}
for(var i=0;i<this.Cubos.length;i++){this.Escena.add(this.Cubos[i]);}}
else{this.GrupoCubos=new THREE.Group();}
var RotarCaraX=0;var RotarCaraY=0;var RotarCaraZ=0;for(var i=0;i<this.Cubos.length;i++){switch(Pos){case 0:if(this.Cubos[i].position.x>5){this.GrupoCubos.add(this.Cubos[i]);}
RotarCaraX=RandInt(3,1);break;case 1:if(this.Cubos[i].position.x<-5){this.GrupoCubos.add(this.Cubos[i]);}
RotarCaraX=RandInt(3,1);break;case 2:if(this.Cubos[i].position.y>5){this.GrupoCubos.add(this.Cubos[i]);}
RotarCaraY=RandInt(3,1);break;case 3:if(this.Cubos[i].position.y<-5){this.GrupoCubos.add(this.Cubos[i]);}
RotarCaraY=RandInt(3,1);break;case 4:if(this.Cubos[i].position.z>5){this.GrupoCubos.add(this.Cubos[i]);}
RotarCaraZ=RandInt(3,1);break;case 5:if(this.Cubos[i].position.z<-5){this.GrupoCubos.add(this.Cubos[i]);}
RotarCaraZ=RandInt(3,1);break;case 6:if(this.Cubos[i].position.x<5&&this.Cubos[i].position.x>-5){this.GrupoCubos.add(this.Cubos[i]);}
RotarCaraX=RandInt(3,1);break;case 7:if(this.Cubos[i].position.y<5&&this.Cubos[i].position.y>-5){this.GrupoCubos.add(this.Cubos[i]);}
RotarCaraY=RandInt(3,1);break;case 8:if(this.Cubos[i].position.z<5&&this.Cubos[i].position.z>-5){this.GrupoCubos.add(this.Cubos[i]);}
RotarCaraZ=RandInt(3,1);break;}}
this.Escena.add(this.GrupoCubos);this.AniRotarGrupoCubos=this.Animaciones.CrearAnimacion([{'Paso':{x:0,y:0,z:0}},{'Paso':{x:RotarCaraX*(Math.PI/2),y:RotarCaraY*(Math.PI/2),z:RotarCaraZ*(Math.PI/2)},Tiempo:500*(RotarCaraX+RotarCaraY+RotarCaraZ),FuncionTiempo:FuncionesTiempo.SinOut}],{FuncionActualizar:function(Valores){this.GrupoCubos.rotation.x=Valores.x;this.GrupoCubos.rotation.y=Valores.y;this.GrupoCubos.rotation.z=Valores.z;}.bind(this),FuncionTerminado:this.AnimarCubos.bind(this),Retraso:200});this.AniRotarGrupoCubos.AsignarValoresIniciales();this.AniRotarGrupoCubos.Iniciar();},AnimacionRotarCubo:function(){var Eje=RandInt(3);this.CuboAnimado=RandInt(26,0);var RotarCara=RandInt(3,1);if(Eje===0){this.AniRotarCubo=this.Animaciones.CrearAnimacion([{'Paso':{x:0}},{'Paso':{x:RotarCara*(Math.PI/2)},Tiempo:350*RotarCara,FuncionTiempo:FuncionesTiempo.SinOut}],{FuncionActualizar:function(Valores){this.Cubos[this.CuboAnimado].rotation.x=Valores.x;}.bind(this),FuncionTerminado:this.AnimarCubos.bind(this),"Retraso":200});this.AniRotarCubo.AsignarValoresIniciales();this.AniRotarCubo.Iniciar();}
else if(Eje===1){this.AniRotarCubo=this.Animaciones.CrearAnimacion([{'Paso':{y:0}},{'Paso':{y:RotarCara*(Math.PI/2)},Tiempo:350*RotarCara,FuncionTiempo:FuncionesTiempo.SinOut}],{FuncionActualizar:function(Valores){this.Cubos[this.CuboAnimado].rotation.y=Valores.y;}.bind(this),FuncionTerminado:this.AnimarCubos.bind(this),"Retraso":200});this.AniRotarCubo.AsignarValoresIniciales();this.AniRotarCubo.Iniciar();}
else{this.AniRotarCubo=this.Animaciones.CrearAnimacion([{'Paso':{z:0}},{'Paso':{z:RotarCara*(Math.PI/2)},Tiempo:350*RotarCara,FuncionTiempo:FuncionesTiempo.SinOut}],{FuncionActualizar:function(Valores){this.Cubos[this.CuboAnimado].rotation.z=Valores.z;}.bind(this),FuncionTerminado:this.AnimarCubos.bind(this),"Retraso":200});this.AniRotarCubo.AsignarValoresIniciales();this.AniRotarCubo.Iniciar();}},CrearLuces:function(){this.dirLight=new THREE.DirectionalLight(0xffffff,0.7);this.dirLight.color.setHSL(0.1,1,0.95);this.dirLight.position.set(20,35,50).normalize();this.dirLight.position.multiplyScalar(50);this.Escena.add(this.dirLight);this.dirLight.castShadow=true;this.dirLight.shadow.mapSize.width=2048;this.dirLight.shadow.mapSize.height=2048;var d=80;this.dirLight.shadow.camera.left=-d;this.dirLight.shadow.camera.right=d;this.dirLight.shadow.camera.top=d;this.dirLight.shadow.camera.bottom=-d;this.dirLight.shadow.camera.far=3500;this.SpotLight=new THREE.SpotLight(0xCCFFFF,0);this.SpotLight.position.set(5,150,750);this.SpotLight.shadow.camera.near=0.01;this.SpotLight.shadow.camera.far=1000;this.SpotLight.shadow.camera.visible=true;this.SpotLight.castShadow=true;this.SpotLight.target=this.Suelo;this.Escena.add(this.SpotLight);this.AniEncenderLuz=this.Animaciones.CrearAnimacion([{'Paso':{Intensidad:0}},{'Paso':{Intensidad:0.7,},'Tiempo':60,'FuncionTiempo':FuncionesTiempo.SinInOut,'Retraso':0},{'Paso':{Intensidad:0,},'Tiempo':60,'FuncionTiempo':FuncionesTiempo.SinInOut},{'Paso':{Intensidad:0.6,},'Tiempo':60,'FuncionTiempo':FuncionesTiempo.SinInOut,},{'Paso':{Intensidad:0.1,},'Tiempo':50,'FuncionTiempo':FuncionesTiempo.SinInOut},{'Paso':{Intensidad:0.7},'Tiempo':850,'FuncionTiempo':FuncionesTiempo.SinInOut},{'Paso':{Intensidad:1},'Tiempo':2500,'FuncionTiempo':FuncionesTiempo.SinInOut}],{FuncionActualizar:function(Valores){this.SpotLight.intensity=Valores.Intensidad;this.dirLight.intensity=Valores.Intensidad*0.6;}.bind(this)});this.AniEncenderLuz.AsignarValoresIniciales();this.AniEncenderLuz.Iniciar();this.HemiLight=new THREE.HemisphereLight(0xeeeeee,0xffffff,0.8);this.HemiLight.color.setHSL(0.6,0.6,0.6);this.HemiLight.groundColor.setHSL(0.095,1,0.75);this.HemiLight.position.set(0,0,0);this.Escena.add(this.HemiLight);},Pintar:function(){this.Animaciones.Actualizar(this.Tick);this.Camara.Rotar(this.Escena);this.Context.render(this.Escena,this.Camara);}});
var Banner_HexTunnel=function(){if(ObjetoCanvas.call(this,{'Tipo':'THREE','Ancho':'Auto','Alto':'Auto','Entorno':'Banner','MostrarFPS':false,'ElementoRaiz':document.body})===false){return false;}
this.Iniciar();this.Cargando(false);return true;};var RandHex=function(){return'0x'+Math.random().toString(16).slice(2,8).toUpperCase();};var Constantes={Texturas:8,Filas:48,TamFuente:30,Lineas:26,CaracteresPorLinea:28,MaxAnimaciones:25};Banner_HexTunnel.prototype=Object.assign(Object.create(ObjetoCanvas.prototype),{constructor:Banner_HexTunnel,Nombre:"HexTunnel",IdeaOriginal:"devildrey33",URL:"/Lab/Ejemplos/BannerTest/HexTunnel.html",NombreURL:"Lab : HexTunnel",Invertir:false,Redimensionar:function(){},Scroll:function(){},MouseMove:function(Evento){},MousePresionado:function(Evento){},MouseSoltado:function(Evento){},MouseEnter:function(Evento){},MouseLeave:function(Evento){},TeclaPresionada:function(Evento){},TeclaSoltada:function(Evento){},TouchStart:function(Evento){},TouchEnd:function(Evento){},Pausa:function(){},Reanudar:function(){},Iniciar:function(){this.Context.shadowMap.enabled=true;this.Escena=new THREE.Scene();window.scene=this.Escena;this.Camara=new THREE.PerspectiveCamera(75,this.Ancho/this.Alto,0.5,2000);this.Camara.position.set(0,0,10);this.Camara.name="Camara";this.Escena.add(this.Camara);this.Suelo=new THREE.Mesh(new THREE.PlaneGeometry(2000,2000),new THREE.MeshPhongMaterial({color:0x555555,specular:0x777777}));this.Suelo.name="Suelo";this.Suelo.rotation.x=-Math.PI/2;this.Suelo.position.y=-20;this.Suelo.castShadow=false;this.Suelo.receiveShadow=true;this.Escena.add(this.Suelo);this.Avance=0;this.CrearBloques();this.CrearLuces();this.CrearAnimaciones();},Bloques:[],Texturas:[],Animaciones:[],CrearBloques:function(){this.Texturas=[];for(var t=0;t<Constantes.Texturas;t++){this.Texturas[t]=new this.TexturaBloque();}
this.Bloques=[];var TA=0;for(var i=0;i<Constantes.Filas;i++){this.Bloques.push(new this.Bloque(this.Escena,-24,i*-20,this.Texturas[TA++]));this.Bloques.push(new this.Bloque(this.Escena,24,i*-20,this.Texturas[TA++]));if(TA>Constantes.Texturas-1){TA=0;}}},TexturaBloque:function(){this.Buffer=new BufferCanvas(512,1024);this.Textura=new THREE.Texture(this.Buffer.Canvas);this.Buffer.Context.font=Constantes.TamFuente+"px nova mono";this.Buffer.Context.fillStyle="rgb(0, 0, 120)";this.Buffer.Context.fillRect(0,0,this.Buffer.Ancho,this.Buffer.Alto);this.Buffer.Context.fillStyle="rgb(95, 95, 95)";for(var l=1;l<Constantes.Lineas;l++){var HexStr=RandHex()+'  '+RandHex()+'  '+RandHex();this.Buffer.Context.fillText(HexStr,20,l*40);}
this.Textura.needsUpdate=true;},Bloque:function(Escena,X,Z,Textura){this.Buffer=Textura.Buffer;this.Textura=Textura.Textura;this.Figura=new THREE.Mesh(new THREE.BoxGeometry(20,40,10),new THREE.MeshStandardMaterial({map:this.Textura,transparent:true,roughness:0.5,opacity:0.75}));Escena.add(this.Figura);this.Figura.position.set(X,0,Z);this.Figura.castShadow=true;this.Figura.name="Bloque";},CrearLuces:function(){this.DirLight=new THREE.DirectionalLight(0xffffff,0.5);this.DirLight.name="DirLight1";this.DirLight.position.set(18,60,-230);this.DirLight.position.multiplyScalar(20);this.DirLight.target=this.Suelo;this.DirLight.castShadow=true;this.DirLight.shadow.mapSize.width=2048;this.DirLight.shadow.mapSize.height=2048;var d=40;this.DirLight.shadow.camera.left=-d;this.DirLight.shadow.camera.right=d;this.DirLight.shadow.camera.top=d;this.DirLight.shadow.camera.bottom=-d;this.DirLight.shadow.camera.far=4500;this.Escena.add(this.DirLight);this.DirLight2=new THREE.DirectionalLight(0xffffff,1.4);this.DirLight2.name="DirLight2";this.DirLight2.position.set(3,1,50);this.DirLight2.position.multiplyScalar(20);this.DirLight2.target=this.Suelo;this.DirLight2.castShadow=true;this.DirLight2.shadow.mapSize.width=2048;this.DirLight2.shadow.mapSize.height=2048;this.DirLight2.shadow.camera.left=-d;this.DirLight2.shadow.camera.right=d;this.DirLight2.shadow.camera.top=d;this.DirLight2.shadow.camera.bottom=-d;this.DirLight2.shadow.camera.far=2500;this.Escena.add(this.DirLight2);this.HemiLight=new THREE.HemisphereLight(0xeeeeee,0xffffff,1.2);this.HemiLight.color.setHSL(0.6,0.6,0.6);this.HemiLight.groundColor.setHSL(0.095,1,0.75);this.HemiLight.position.set(0,0,0);this.Escena.add(this.HemiLight);},CrearAnimaciones:function(){this.Animaciones=[];for(var i=0;i<Constantes.MaxAnimaciones;i++){this.Animaciones.push(new this.Animacion(this.Tick));}},Animacion:function(Tick){this.Textura=RandInt(Constantes.Texturas-1,0);this.Linea=RandInt(Constantes.Lineas,1);this.Columna=RandInt(3,0);this.Retraso=RandInt(900,0);this.Tiempo=RandInt(2000,450);this.TickInicio=Tick+this.Retraso;this.R=95;this.B=95;this.Texto=RandHex();this.Terminado=false;this.Porcentaje=0;this.Tipo=Rand(1,0);this.Calcular=function(Tick,Buffer){if(this.TickInicio<Tick){var ta=Tick-this.TickInicio;if(ta<this.Tiempo){this.Porcentaje=((ta*100)/this.Tiempo)/100;}
else{this.Porcentaje=1;this.Terminado=true;}
this.R=255-Math.floor(this.Porcentaje*160);this.B=Math.floor(this.Porcentaje*95);this.PintarHex(Buffer);}},this.PintarHex=function(Buffer){var x2=16.8*10;var x1=20+(this.Columna*x2);var y1=this.Linea*40;var y2=y1-Constantes.TamFuente;Buffer.Context.fillStyle="rgb(0, 0, 120)";Buffer.Context.fillRect(x1,y2,x2,40);if(this.Tipo<0.05){Buffer.Context.fillStyle="rgb("+this.R+","+this.B+","+this.B+")";}
else if(this.Tipo>0.05&&this.Tipo<0.15){Buffer.Context.fillStyle="rgb("+this.B+","+this.R+","+this.B+")";}
else{Buffer.Context.fillStyle="rgb("+this.R+","+this.R+","+this.B+")";}
Buffer.Context.fillText(this.Texto,x1,y1);};},AnimarHex:function(){for(var i=0;i<Constantes.MaxAnimaciones;i++){this.Animaciones[i].Calcular(this.Tick,this.Texturas[this.Animaciones[i].Textura].Buffer);if(this.Animaciones[i].Terminado===true){this.Animaciones[i]=new this.Animacion(this.Tick);}}
for(var i=0;i<Constantes.Texturas;i++){this.Texturas[i].Textura.needsUpdate=true;}},AvanzarBloques:function(){for(var i=0;i<Constantes.Filas*2;i++){if(this.Bloques[i].Figura.position.z>this.Camara.position.z+100){this.Bloques[i].Figura.position.z=this.Bloques[i].Figura.position.z-(20*Constantes.Filas);}
else{this.Bloques[i].Figura.position.z+=0.07;}}},Pintar:function(){this.AvanzarBloques();this.AnimarHex();this.Context.render(this.Escena,this.Camara);}});
var Banner_RectangularDimension=function(){if(ObjetoCanvas.call(this,{'Tipo':'THREE','Ancho':'Auto','Alto':'Auto','Entorno':'Banner','MostrarFPS':true,'ColorFondo':0x000000,'ElementoRaiz':document.body})===false){return false;}
this.Iniciar();this.Cargando(false);return true;};Banner_RectangularDimension.prototype=Object.assign(Object.create(ObjetoCanvas.prototype),{constructor:Banner_RectangularDimension,Nombre:"RectangularDimension",IdeaOriginal:"devildrey33",URL:"/Lab/Ejemplos/BannerTest/RectangularDimension.html",NombreURL:"Lab : Rectangular Dimension",Rectangulos:[],Iniciar:function(){this.Escena=new THREE.Scene();this.Camara=new THREE.PerspectiveCamera(75,this.Ancho/this.Alto,0.5,1000);this.Camara.Rotacion={Grados:0,Avance:(Math.PI/180)/3,Distancia:20,MirarHacia:new THREE.Vector3(0,0,0),Animacion:true};this.Camara.position.set(0,0,this.Camara.Rotacion.Distancia);this.Camara.Rotar=function(){this.Rotacion.Grados+=this.Rotacion.Avance;this.position.x=this.Rotacion.Distancia*Math.cos(this.Rotacion.Grados);this.position.z=this.Rotacion.Distancia*Math.sin(this.Rotacion.Grados);this.lookAt(this.Rotacion.MirarHacia);};this.Escena.add(this.Camara);if(ObjetoNavegador.EsMovil()===false){this.TotalRectangulos=1500;}
else{this.TotalRectangulos=850;}
for(var i=0;i<this.TotalRectangulos;i++){this.CrearRectangulo();}
this.CrearLuces();},RndAvance:function(){return Rand(1.4,0.6);},RndPos:function(){return Rand(50.0,-50.0);},RndZ:function(){return Rand(-100.0,-75.0);},CrearRectangulo:function(){var Tam=Rand(0.9,0.2);var TamLargo=Rand(4.0,0.2)+Tam;var RectanguloGeo=new THREE.BoxBufferGeometry(Tam,Tam,TamLargo);var Color="rgb("+(RandInt(60,-60)+82)+","+(RandInt(60,-60)+116)+", "+RandInt(255,120)+")";var Rectangulo=new THREE.Mesh(RectanguloGeo,new THREE.MeshPhongMaterial({color:new THREE.Color(Color),specular:0x3333AA,transparent:true,opacity:Rand(0.9,0.75),shininess:200}));this.Escena.add(Rectangulo);Rectangulo.position.set(this.RndPos(),this.RndPos(),Rand(-100.0,100.0));Rectangulo.Avance=this.RndAvance();Rectangulo.TamLargo=TamLargo;this.Rectangulos.push(Rectangulo);},Avance:function(){for(var i=0;i<this.TotalRectangulos;i++){this.Rectangulos[i].position.set(this.Rectangulos[i].position.x,this.Rectangulos[i].position.y,this.Rectangulos[i].position.z+this.Rectangulos[i].Avance);if(this.Rectangulos[i].position.z>100+this.Rectangulos[i].TamLargo){this.Rectangulos[i].position.set(this.RndPos(),this.RndPos(),this.RndZ());this.Rectangulos[i].Avance=this.RndAvance();}}},CrearRectanguloShader:function(){var Tam=Rand(0.9,0.2);var TamLargo=Rand(4.0,0.2)+Tam;var RectanguloGeo=new THREE.BoxBufferGeometry(Tam,Tam,TamLargo);var Uniforms={Velocidad:{"type":"1f",value:Rand(2.0,0.3)},PosicionZ:{"type":"1f",value:Rand(50.0,1.0)},Transparencia:{"type":"1f",value:Rand(0.1,0.9)},Largo:{"type":"1f",value:TamLargo}}
var MaterialShader=new THREE.ShaderMaterial({uniforms:Uniforms,vertexShader:document.getElementById('VertexShader').innerHTML,fragmentShader:document.getElementById('FragmentShader').innerHTML,transparent:true});var Rectangulo=new THREE.Mesh(RectanguloGeo,MaterialShader);this.Rectangulos.push(Rectangulo);this.Escena.add(Rectangulo);Rectangulo.position.set(Rand(15.0,-15.0),Rand(15.0,-15.0),Uniforms.PosicionZ);},CrearLuces:function(){this.DirLight=new THREE.DirectionalLight(0xffffff,0.41);this.DirLight.position.set(30,60,20);this.DirLight.position.multiplyScalar(20);this.DirLight.castShadow=true;this.DirLight.shadow.mapSize.width=2048;this.DirLight.shadow.mapSize.height=2048;var d=40;this.DirLight.shadow.camera.left=-d;this.DirLight.shadow.camera.right=d;this.DirLight.shadow.camera.top=d;this.DirLight.shadow.camera.bottom=-d;this.DirLight.shadow.camera.far=3500;this.Escena.add(this.DirLight);this.HemiLight=new THREE.HemisphereLight(0xeeeeee,0xffffff,0.4);this.HemiLight.color.setHSL(0.6,0.6,0.6);this.HemiLight.groundColor.setHSL(0.095,1,0.75);this.HemiLight.position.set(0,0,0);this.Escena.add(this.HemiLight);},Pintar:function(){this.Camara.Rotar();this.Avance();this.Context.render(this.Escena,this.Camara);}});
var SobreDevildrey33=function(){if(ObjetoCanvas.call(this,{'Tipo':'THREE','Ancho':'Auto','Alto':'Auto','Entorno':'Normal','MostrarFPS':true,'ElementoRaiz':document.getElementById('MarcoNavegacion'),'Pausar':false})===false){return false;}
this.Iniciar();this.Cargando(false);return true;};SobreDevildrey33.prototype=Object.assign(Object.create(ObjetoCanvas.prototype),{constructor:SobreDevildrey33,Redimensionar:function(){},Scroll:function(){},MouseMove:function(Evento){this.Mouse.x=(Evento.clientX/this.Ancho)*2-1;this.Mouse.y=(Evento.clientY/this.Alto)*2-1;},MousePresionado:function(Evento){},MouseSoltado:function(Evento){},MouseEnter:function(Evento){},MouseLeave:function(Evento){},TeclaPresionada:function(Evento){},TeclaSoltada:function(Evento){},Pausa:function(){this.Animaciones.Pausa();},Reanudar:function(){this.Animaciones.Reanudar();},Animaciones:new ObjetoAnimacion(),Iniciar:function(){this.Test=new ObjetoTest({css:{"bottom":"10px","right":"10px"}});this.Context.shadowMap.enabled=true;this.RayCaster=new THREE.Raycaster();this.Mouse=new THREE.Vector2();this.Escena=new THREE.Scene();this.Camara=new THREE.PerspectiveCamera(75,this.Ancho/this.Alto,0.5,1000);this.Camara.position.set(0,0,1000);this.Escena.add(this.Camara);this.AnimacionAvanceCamara=function(){if(typeof this.AniAvanceCamara!=='undefined')this.AniAvanceCamara.Terminar();this.AniAvanceCamara=this.Animaciones.Crear([{'Paso':{z:500,y:150}},{'Paso':{z:70,y:35},'Tiempo':2250,'FuncionTiempo':FuncionesTiempo.SinInOut}],{"Repetir":0,FuncionActualizar:function(Valores){this.Camara.position.y=Valores.y;this.Camara.position.z=Valores.z;}.bind(this)});}
var tcam=this.Test.AgregarLista("Cámara");tcam.Agregar({"Padre":this.Camara.position,"Variable":"x","Min":-200,"Max":200,"Nombre":"position.x"});tcam.Agregar({"Padre":this.Camara.position,"Variable":"y","Min":-200,"Max":200,"Nombre":"position.y"});tcam.Agregar({"Padre":this.Camara.position,"Variable":"z","Min":-200,"Max":500,"Nombre":"position.z"});tcam.Agregar({"Padre":this.Camara.rotation,"Variable":"x","Min":0,"Max":Math.PI*2,"Nombre":"rotation.x"});tcam.Agregar({"Padre":this.Camara.rotation,"Variable":"y","Min":0,"Max":Math.PI*2,"Nombre":"rotation.y"});tcam.Agregar({"Padre":this.Camara.rotation,"Variable":"z","Min":0,"Max":Math.PI*2,"Nombre":"rotation.z"});tcam.Agregar({"Padre":this,"Variable":"AnimacionAvanceCamara","Nombre":"Animación avance"});this.MaterialSuelo=new THREE.MeshPhongMaterial({color:0x444477,specular:0x33AA33,});this.MaterialPared=new THREE.MeshPhongMaterial({color:0x444477,specular:0x33AA33,});this.MaterialCubo1=new THREE.MeshPhongMaterial({color:0x0000AA,specular:0x33AA33,transparent:true,opacity:0.7});this.MaterialCubo2=new THREE.MeshPhongMaterial({color:0x0000AA,specular:0x33AA33,transparent:true,opacity:0.7});var tluces=this.Test.AgregarLista("Luces");this.dirLight=new THREE.DirectionalLight(0xffffff,1);this.dirLight.color.setHSL(0.1,1,0.95);this.dirLight.position.set(-1,1.75,1);this.dirLight.position.multiplyScalar(50);this.Escena.add(this.dirLight);this.dirLight.castShadow=true;this.dirLight.shadow.mapSize.width=2048;this.dirLight.shadow.mapSize.height=2048;var d=50;this.dirLight.shadow.camera.left=-d;this.dirLight.shadow.camera.right=d;this.dirLight.shadow.camera.top=d;this.dirLight.shadow.camera.bottom=-d;this.dirLight.shadow.camera.far=3500;this.dirLight.shadow.bias=-0.0001;this.dlhelper=new THREE.CameraHelper(this.dirLight.shadow.camera);this.Escena.add(this.dlhelper);this.dlhelper.visible=false;var tdl=tluces.AgregarLista("DirectionalLight");tdl.Agregar({"Padre":this.dirLight.position,"Variable":"x","Min":-100,"Max":100});tdl.Agregar({"Padre":this.dirLight.position,"Variable":"y","Min":-100,"Max":100});tdl.Agregar({"Padre":this.dirLight.position,"Variable":"z","Min":-200,"Max":200});tdl.Agregar({"Padre":this.dirLight,"Variable":"intensity","Min":0.0,"Max":1.0});tdl.Agregar({"Padre":this.dlhelper,"Variable":"visible","Nombre":"helper"});this.HemiLight=new THREE.HemisphereLight(0xffffff,0xffffff,0.6);this.HemiLight.color.setHSL(0.6,1,0.6);this.HemiLight.groundColor.setHSL(0.095,1,0.75);this.HemiLight.position.set(0,500,0);this.Escena.add(this.HemiLight);var thl=tluces.AgregarLista("HemisphereLight");thl.Agregar({"Padre":this.HemiLight.position,"Variable":"x","Min":-100,"Max":100});thl.Agregar({"Padre":this.HemiLight.position,"Variable":"y","Min":0,"Max":500});thl.Agregar({"Padre":this.HemiLight.position,"Variable":"z","Min":-200,"Max":200});thl.Agregar({"Padre":this.HemiLight,"Variable":"intensity","Min":0.0,"Max":1.0});this.SpotLight=new THREE.SpotLight(0xFFAADD,0);this.SpotLight.position.set(0,50,100);this.SpotLight.shadow.camera.near=0.01;this.SpotLight.castShadow=true;this.SpotLight.target=new THREE.Object3D(100,0,0);this.SpotLight.castShadow=true;this.Escena.add(this.SpotLight);this.splhelper=new THREE.CameraHelper(this.SpotLight.shadow.camera);this.Escena.add(this.splhelper);this.splhelper.visible=false;this.AnimacionEncenderLuz=function(){if(typeof this.AniEncenderLuz!=='undefined')this.AniEncenderLuz.Terminar();this.AniEncenderLuz=this.Animaciones.Crear([{'Paso':{Intensidad:0}},{'Paso':{Intensidad:0.7,},'Tiempo':60,'FuncionTiempo':FuncionesTiempo.SinInOut,'Retraso':2000},{'Paso':{Intensidad:0,},'Tiempo':60,'FuncionTiempo':FuncionesTiempo.SinInOut},{'Paso':{Intensidad:0.6,},'Tiempo':60,'FuncionTiempo':FuncionesTiempo.SinInOut,},{'Paso':{Intensidad:0.1,},'Tiempo':50,'FuncionTiempo':FuncionesTiempo.SinInOut},{'Paso':{Intensidad:0.7},'Tiempo':3850,'FuncionTiempo':FuncionesTiempo.SinInOut},{'Paso':{Intensidad:1},'Tiempo':2500,'FuncionTiempo':FuncionesTiempo.SinInOut}],{"Repetir":0,FuncionActualizar:function(Valores){this.SpotLight.intensity=Valores.Intensidad;}.bind(this)});};var tspl=tluces.AgregarLista("SpotLight");tspl.Agregar({"Padre":this.SpotLight.position,"Variable":"x","Min":-100,"Max":100});tspl.Agregar({"Padre":this.SpotLight.position,"Variable":"y","Min":-100,"Max":100});tspl.Agregar({"Padre":this.SpotLight.position,"Variable":"z","Min":-200,"Max":200});tspl.Agregar({"Padre":this.SpotLight,"Variable":"intensity","Min":0.0,"Max":1.0});tspl.Agregar({"Padre":this.splhelper,"Variable":"visible","Nombre":"helper"});tspl.Agregar({"Padre":this,"Variable":"AnimacionEncenderLuz","Nombre":"Ani Encender luz"});this.Suelo=new THREE.Mesh(new THREE.PlaneGeometry(10000,10000),this.MaterialSuelo);this.Suelo.rotation.x=-Math.PI/2;this.Suelo.castShadow=false;this.Suelo.receiveShadow=true;this.Escena.add(this.Suelo);this.ParedI=new THREE.Mesh(new THREE.BoxGeometry(1,150,300),this.MaterialPared);this.ParedI.position.x=-150;this.ParedI.position.y=75;this.ParedI.castShadow=false;this.ParedI.receiveShadow=true;this.Escena.add(this.ParedI);this.ParedD=new THREE.Mesh(new THREE.BoxGeometry(1,150,300),this.MaterialPared);this.ParedD.position.x=150;this.ParedD.position.y=75;this.ParedD.castShadow=false;this.ParedD.receiveShadow=true;this.Escena.add(this.ParedD);this.ParedC=new THREE.Mesh(new THREE.BoxGeometry(300,150,1),this.MaterialPared);this.ParedC.position.z=-150;this.ParedC.position.y=75;this.ParedC.castShadow=false;this.ParedC.receiveShadow=true;this.Escena.add(this.ParedC);var tParedes=this.Test.AgregarLista("Paredes");tParedes.Agregar({"Padre":this.MaterialPared,"Variable":"shininess","Min":0,"Max":4000});tParedes.Agregar({"Padre":this.ParedI,"Variable":"visible","Nombre":"ParedI visible"});tParedes.Agregar({"Padre":this.ParedC,"Variable":"visible","Nombre":"ParedC visible"});tParedes.Agregar({"Padre":this.ParedD,"Variable":"visible","Nombre":"ParedD visible"});this.Cubo=new THREE.Mesh(new THREE.BoxGeometry(12,12,12),this.MaterialCubo1);this.Cubo.castShadow=true;this.Cubo.receiveShadow=false;this.Cubo.position.set(-12,20,20);this.Escena.add(this.Cubo);this.Cubo2=new THREE.Mesh(new THREE.BoxGeometry(12,12,12),this.MaterialCubo2);this.Cubo2.castShadow=true;this.Cubo2.receiveShadow=false;this.Cubo2.position.set(12,20,20);this.Escena.add(this.Cubo2);this.AnimacionRotarCubo=function(Cubo){if(typeof this.AniRotarCubo!=='undefined')this.AniRotarCubo.Cancelar();var CaraX=RandInt(5);var CaraY=RandInt(5);var CaraZ=RandInt(5);this.AniRotarCubo=this.Animaciones.Crear([{'Paso':{x:this.Cubo.rotation.x,y:this.Cubo.rotation.y,z:this.Cubo.rotation.z}},{'Paso':{x:CaraX*(Math.PI/2),y:CaraY*(Math.PI/2),z:CaraZ*(Math.PI/2)},Tiempo:1750,FuncionTiempo:FuncionesTiempo.SinOut},],{"Repetir":0,FuncionActualizar:function(Valores){this.Cubo.rotation.x=Valores.x;this.Cubo.rotation.x=Valores.y;this.Cubo.rotation.x=Valores.z;}.bind(this)});};this.AnimacionRotarCubo2=function(Cubo){if(typeof this.AniRotarCubo2!=='undefined')this.AniRotarCubo2.Cancelar();var CaraX=RandInt(5);var CaraY=RandInt(5);var CaraZ=RandInt(5);this.AniRotarCubo2=this.Animaciones.Crear([{'Paso':{x:this.Cubo2.rotation.x,y:this.Cubo2.rotation.y,z:this.Cubo2.rotation.z}},{'Paso':{x:CaraX*(Math.PI/2),y:CaraY*(Math.PI/2),z:CaraZ*(Math.PI/2)},Tiempo:1750,FuncionTiempo:FuncionesTiempo.SinOut},],{"Repetir":0,FuncionActualizar:function(Valores){this.Cubo2.rotation.x=Valores.x;this.Cubo2.rotation.x=Valores.y;this.Cubo2.rotation.x=Valores.z;}.bind(this)});};var tCubo1=this.Test.AgregarLista("Cubo1");tCubo1.Agregar({"Padre":this.MaterialCubo1,"Variable":"opacity","Min":0,"Max":1});tCubo1.Agregar({"Padre":this.MaterialCubo1,"Variable":"shininess","Min":0,"Max":100});tCubo1.Agregar({"Padre":this.Cubo,"Variable":"castShadow","Nombre":"C1.castShadow"});tCubo1.Agregar({"Padre":this.Cubo.position,"Variable":"x","Min":-50,"Max":50,"Nombre":"position.x"});tCubo1.Agregar({"Padre":this.Cubo.position,"Variable":"y","Min":-50,"Max":50,"Nombre":"position.y"});tCubo1.Agregar({"Padre":this.Cubo.position,"Variable":"z","Min":-50,"Max":50,"Nombre":"position.z"});tCubo1.Agregar({"Padre":this.Cubo.rotation,"Variable":"x","Min":0,"Max":Math.PI*2,"Nombre":"rotation.x"});tCubo1.Agregar({"Padre":this.Cubo.rotation,"Variable":"y","Min":0,"Max":Math.PI*2,"Nombre":"rotation.y"});tCubo1.Agregar({"Padre":this.Cubo.rotation,"Variable":"z","Min":0,"Max":Math.PI*2,"Nombre":"rotation.z"});tCubo1.Agregar({"Padre":this,"Variable":"AnimacionRotarCubo","Nombre":"Ani rotación"});var tCubo2=this.Test.AgregarLista("Cubo2");tCubo2.Agregar({"Padre":this.MaterialCubo2,"Variable":"opacity","Min":0,"Max":1});tCubo2.Agregar({"Padre":this.MaterialCubo2,"Variable":"shininess","Min":0,"Max":100});tCubo2.Agregar({"Padre":this.Cubo2,"Variable":"castShadow"});tCubo2.Agregar({"Padre":this.Cubo2.position,"Variable":"x","Min":-50,"Max":50,"Nombre":"position.x"});tCubo2.Agregar({"Padre":this.Cubo2.position,"Variable":"y","Min":-50,"Max":50,"Nombre":"position.y"});tCubo2.Agregar({"Padre":this.Cubo2.position,"Variable":"z","Min":-50,"Max":50,"Nombre":"position.z"});tCubo2.Agregar({"Padre":this.Cubo2.rotation,"Variable":"x","Min":0,"Max":Math.PI*2,"Nombre":"rotation.x"});tCubo2.Agregar({"Padre":this.Cubo2.rotation,"Variable":"y","Min":0,"Max":Math.PI*2,"Nombre":"rotation.y"});tCubo2.Agregar({"Padre":this.Cubo2.rotation,"Variable":"z","Min":0,"Max":Math.PI*2,"Nombre":"rotation.z"});tCubo2.Agregar({"Padre":this,"Variable":"AnimacionRotarCubo2","Nombre":"Ani rotación"});this.AnimacionAvanceCamara();this.AniCuboY1=this.Animaciones.Crear([{'Paso':{y:35}},{'Paso':{y:40},Tiempo:750,FuncionTiempo:FuncionesTiempo.SinOut},{'Paso':{y:35},Tiempo:750,FuncionTiempo:FuncionesTiempo.SinIn},],{"Repetir":-1,FuncionActualizar:function(Valores){this.Cubo.position.y=Valores.y;}.bind(this)});this.AniCuboY2=this.Animaciones.Crear([{'Paso':{y:35}},{'Paso':{y:40},Tiempo:750,FuncionTiempo:FuncionesTiempo.SinOut,Retraso:375},{'Paso':{y:35},Tiempo:750,FuncionTiempo:FuncionesTiempo.SinIn},],{"Repetir":-1,FuncionActualizar:function(Valores){this.Cubo2.position.y=Valores.y;}.bind(this)});this.AniPosLuz=this.Animaciones.Crear([{'Paso':{x:-60,y:120,z:70}},{'Paso':{x:60,y:110,z:60},Tiempo:12000,FuncionTiempo:FuncionesTiempo.SinInOut},{'Paso':{x:-60,y:120,z:70},Tiempo:12000,FuncionTiempo:FuncionesTiempo.SinInOut},],{Repetir:-1,FuncionActualizar:function(Valores){this.dirLight.position.x=Valores.x;this.dirLight.position.y=Valores.y;this.dirLight.position.z=Valores.z;}.bind(this)});this.AnimacionEncenderLuz();this.Tiempo=Date.now();this.Avance=0;},Pintar:function(){this.Animaciones.Actualizar(this.Tick);this.Test.ActualizarValores();this.RayCaster.setFromCamera(this.Mouse,this.Camara);var intersects=this.RayCaster.intersectObjects(this.Escena.children);if(intersects[0]){if(intersects[0].object===this.Cubo){console.log("cubo");}
if(intersects[0].object===this.Cubo2){console.log("cubo2");}}
this.Context.render(this.Escena,this.Camara);},Shaders:{'Vertex':["precision highp float;","uniform bool   MouseHover;","uniform float  Tiempo;","//","// https://github.com/hughsk/glsl-noise/blob/master/classic/3d.glsl","//",'// GLSL textureless classic 3D noise "cnoise",','// with an RSL-style periodic variant "pnoise".',"// Author:  Stefan Gustavson (stefan.gustavson@liu.se)","// Version: 2011-10-11","//","// Many thanks to Ian McEwan of Ashima Arts for the","// ideas for permutation and gradient selection.","//","// Copyright (c) 2011 Stefan Gustavson. All rights reserved.","// Distributed under the MIT license. See LICENSE file.","// https://github.com/ashima/webgl-noise","//","vec3 mod289(vec3 x)        { return x - floor(x * (1.0 / 289.0)) * 289.0; }","vec4 mod289(vec4 x)        { return x - floor(x * (1.0 / 289.0)) * 289.0; }","vec4 permute(vec4 x)       { return mod289(((x*34.0)+1.0)*x); }","vec4 taylorInvSqrt(vec4 r) { return 1.79284291400159 - 0.85373472095314 * r; }","vec3 fade(vec3 t)          { return t*t*t*(t*(t*6.0-15.0)+10.0); }","// Classic Perlin noise","float cnoise(vec3 P) {","vec3 Pi0 = floor(P);","vec3 Pi1 = Pi0 + vec3(1.0);","Pi0 = mod289(Pi0);","Pi1 = mod289(Pi1);","vec3 Pf0 = fract(P);","vec3 Pf1 = Pf0 - vec3(1.0);","vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);","vec4 iy = vec4(Pi0.yy, Pi1.yy);","vec4 iz0 = Pi0.zzzz;","vec4 iz1 = Pi1.zzzz;","vec4 ixy = permute(permute(ix) + iy);","vec4 ixy0 = permute(ixy + iz0);","vec4 ixy1 = permute(ixy + iz1);","vec4 gx0 = ixy0 * (1.0 / 7.0);","vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;","gx0 = fract(gx0);","vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);","vec4 sz0 = step(gz0, vec4(0.0));","gx0 -= sz0 * (step(0.0, gx0) - 0.5);","gy0 -= sz0 * (step(0.0, gy0) - 0.5);","vec4 gx1 = ixy1 * (1.0 / 7.0);","vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;","gx1 = fract(gx1);","vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);","vec4 sz1 = step(gz1, vec4(0.0));","gx1 -= sz1 * (step(0.0, gx1) - 0.5);","gy1 -= sz1 * (step(0.0, gy1) - 0.5);","vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);","vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);","vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);","vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);","vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);","vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);","vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);","vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);","vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));","g000 *= norm0.x;","g010 *= norm0.y;","g100 *= norm0.z;","g110 *= norm0.w;","vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));","g001 *= norm1.x;","g011 *= norm1.y;","g101 *= norm1.z;","g111 *= norm1.w;","float n000 = dot(g000, Pf0);","float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));","float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));","float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));","float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));","float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));","float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));","float n111 = dot(g111, Pf1);","vec3 fade_xyz = fade(Pf0);","vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);","vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);","float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x);","return 2.2 * n_xyz;","}","void main() {","float Amplitud = (MouseHover == false) ? 0.75 : 2.5;","float Frequencia = (MouseHover == false) ? 0.43 : 1.0;","float Desplazamiento = Amplitud * cnoise(Frequencia * position + Tiempo);","vec3 newPosition = position + normal * Desplazamiento;","gl_Position = projectionMatrix * modelViewMatrix * vec4(newPosition, 1.0);","}"].join("\n"),}});
